/* This file has been generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2014 Hex-Rays <info@hex-rays.com>

   Detected compiler: GNU C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

signed __int64 AppleUSBUHCI::UIMCreateInterruptTransfer();
signed __int64 AppleUSBUHCI::UIMCreateBulkTransfer();
signed __int64 __fastcall AppleUSBUHCI::UIMCreateControlTransfer(AppleUSBUHCI *this, __int64 a2, __int64 a3, IOUSBCommand *a4, void *a5);
signed __int64 AppleUSBUHCI::UIMCreateControlTransfer();
signed __int64 AppleUSBUHCI::UIMCreateControlTransfer();
int __fastcall AppleUSBUHCI::CheckSleepCapability(AppleUSBUHCI *this);
int __fastcall AppleUSBUHCI::callPlatformFunction(__int64 a1, __int64 a2, unsigned __int8 a3, __int64 a4, __int64 a5, __int64 a6);
void __fastcall AppleUSBUHCI::ResumeController(AppleUSBUHCI *this);
int __fastcall AppleUSBUHCI::SuspendController(AppleUSBUHCI *this);
__int64 __fastcall AppleUSBUHCI::SaveControllerStateForSleep(AppleUSBUHCI *__hidden this); // idb
__int64 __fastcall AppleUSBUHCI::RestoreControllerStateFromSleep(AppleUSBUHCI *this); // idb
__int64 __fastcall AppleUSBUHCI::ResetControllerState(AppleUSBUHCI *this); // idb
__int64 __fastcall AppleUSBUHCI::RestartControllerFromReset(AppleUSBUHCI *this); // idb
__int64 __fastcall AppleUSBUHCI::EnableInterruptsFromController(AppleUSBUHCI *this, unsigned __int8 a2);
__int64 __fastcall AppleUSBUHCI::DozeController(AppleUSBUHCI *this); // idb
__int64 __fastcall AppleUSBUHCI::WakeControllerFromDoze(AppleUSBUHCI *this); // idb
int __fastcall AppleUSBUHCI::powerStateWillChangeTo(AppleUSBUHCI *this, __int64 a2, uintptr_t a3, IOService *a4);
int __fastcall AppleUSBUHCI::powerStateDidChangeTo(AppleUSBUHCI *this, __int64 a2, uintptr_t a3, IOService *a4);
int __fastcall AppleUSBUHCI::powerChangeDone(AppleUSBUHCI *this, uintptr_t arg2);
signed __int64 __fastcall AppleUSBUHCI::GetRootHubDeviceDescriptor(__int64 a1, void *a2);
__int64 __fastcall AppleUSBUHCI::GetRootHubDescriptor(__int64 a1, void *a2);
__int64 AppleUSBUHCI::SetRootHubDescriptor();
__int64 __fastcall AppleUSBUHCI::GetRootHubConfDescriptor(__int64 a1, __int64 a2);
__int64 __fastcall AppleUSBUHCI::SetRootHubFeature(AppleUSBUHCI *this);
__int64 __fastcall AppleUSBUHCI::ClearRootHubFeature(AppleUSBUHCI *this);
__int64 __fastcall AppleUSBUHCI::GetRootHubStatus(__int64 a1, __int64 a2);
__int64 __fastcall AppleUSBUHCI::GetRootHubPortStatus(AppleUSBUHCI *this, __int64 a2, int a3);
__int64 __fastcall AppleUSBUHCI::RHDumpPortStatus(AppleUSBUHCI *this, __int16 a2);
__int64 __fastcall AppleUSBUHCI::RHDumpHubPortStatus(__int64 a1, unsigned __int16 *a2);
__int64 __fastcall AppleUSBUHCI::SetRootHubPortFeature(AppleUSBUHCI *this, int a2, unsigned __int16 a3);
__int64 __fastcall AppleUSBUHCI::RHSuspendPort(AppleUSBUHCI *this, __int64 a2, char a3);
__int64 __fastcall AppleUSBUHCI::RHResetPort(AppleUSBUHCI *this, int); // idb
unsigned __int16 __fastcall AppleUSBUHCI::RHEnablePort(AppleUSBUHCI *this, __int16 a2, char a3);
__int64 __fastcall AppleUSBUHCI::ClearRootHubPortFeature(AppleUSBUHCI *this, signed int a2, unsigned __int16 a3);
__int64 __fastcall AppleUSBUHCI::GetRootHubPortState(AppleUSBUHCI *this, unsigned __int8 *a2);
__int64 __fastcall AppleUSBUHCI::SetHubAddress(AppleUSBUHCI *this, __int16 a2);
void __fastcall AppleUSBUHCI::UIMRootHubStatusChange(AppleUSBUHCI *this);
void __fastcall AppleUSBUHCI::UIMRootHubStatusChange(AppleUSBUHCI *this);
int __fastcall AppleUSBUHCI::RHCheckStatus(AppleUSBUHCI *this);
__int64 __fastcall AppleUSBUHCI::GetRootHubStringDescriptor(__int64 a1, char a2, __int64 a3);
__int64 __fastcall AppleUSBUHCI::RootHubAbortInterruptRead(AppleUSBUHCI *__hidden this); // idb
__int64 __fastcall AppleUSBUHCI::RHLastPortStatusChanged(AppleUSBUHCI *__hidden this); // idb
bool __fastcall AppleUSBUHCI::RHAreAllPortsDisconnectedOrSuspended(AppleUSBUHCI *this);
__int64 __fastcall AppleUSBUHCI::RHDeleteEndpoint(AppleUSBUHCI *__hidden this, __int16, __int16); // idb
__int64 __fastcall AppleUSBUHCI::RHAbortEndpoint(AppleUSBUHCI *__hidden this, __int16, __int16); // idb
__int64 __fastcall AppleUSBUHCI::RHHoldPortReset(AppleUSBUHCI *this, int); // idb
int __fastcall AppleUSBUHCI::RHResumePortTimerEntry(AppleUSBUHCI *this, OSObject *a2, void *a3);
int __fastcall AppleUSBUHCI::RHResumePortTimer(AppleUSBUHCI *this, unsigned int a2);
__int64 __fastcall AppleUSBUHCI::RHResumePortCompletionEntry(AppleUSBUHCI *__hidden this, OSObject *, void *, void *, void *, void *); // idb
__int64 __fastcall AppleUSBUHCI::RHResumePortCompletion(AppleUSBUHCI *this, int a2);
// int __usercall AppleUSBUHCI::UIMCreateControlEndpoint@<eax>(AppleUSBUHCI *this@<rdi>, int a2);
__int64 __fastcall AppleUSBUHCI::UIMCreateControlEndpoint(AppleUSBUHCI *this, int a2, unsigned __int8 a3, __int16 a4, unsigned __int8 a5);
// __int64 __usercall AppleUSBUHCI::UIMCreateControlTransfer@<rax>(AppleUSBUHCI *this@<rdi>, __int16 a2@<dx>, IOUSBCommand *a3@<rcx>, __int16 a4@<si>, uintptr_t a5@<r8>, unsigned int a6, unsigned __int16 a7);
__int64 __fastcall AppleUSBUHCI::FindQueueHead(AppleUSBUHCI *this, __int16 a2, __int16 a3, char a4, unsigned __int8 a5, AppleUHCIQueueHead **a6);
__int64 __fastcall AppleUSBUHCI::AllocTDChain(AppleUSBUHCI *this, AppleUHCIQueueHead *a2, IOUSBCommand *a3, uintptr_t a4, unsigned int a5, unsigned __int16 a6, char a7);
int __fastcall AppleUSBUHCI::UIMCreateBulkEndpoint(AppleUSBUHCI *this, __int64 a2, __int64 a3, __int64 a4, __int64 a5, unsigned __int8 a6, unsigned __int16 a7, int a8);
__int64 __fastcall AppleUSBUHCI::UIMCreateBulkEndpoint(AppleUSBUHCI *this, unsigned __int8, unsigned __int8, unsigned __int8, unsigned __int8, unsigned __int8); // idb
__int64 __fastcall AppleUSBUHCI::UIMCreateBulkTransfer(AppleUSBUHCI *this, IOUSBCommand *); // idb
// int __usercall AppleUSBUHCI::UIMCreateInterruptEndpoint@<eax>(AppleUSBUHCI *this@<rdi>, __int16 a2, unsigned __int16 a3, int a4);
int __fastcall AppleUSBUHCI::UIMCreateInterruptEndpoint(AppleUSBUHCI *this, int a2, unsigned __int16 a3, char a4, __int16 a5, __int16 a6, __int16 a7);
__int64 __fastcall AppleUSBUHCI::UIMCreateInterruptTransfer(AppleUSBUHCI *this, IOUSBCommand *); // idb
// int __usercall AppleUSBUHCI::UIMCreateIsochEndpoint@<eax>(AppleUSBUHCI *this@<rdi>, int a2);
__int64 __fastcall AppleUSBUHCI::UIMCreateIsochEndpoint(AppleUSBUHCI *this, __int64 a2, __int64 a3, unsigned int a4, unsigned int a5);
__int64 __fastcall AppleUSBUHCI::DeleteIsochEP(AppleUSBUHCI *this, uintptr_t arg2); // idb
__int64 __fastcall AppleUSBUHCI::AbortIsochEP(AppleUSBUHCI *this, uintptr_t arg2); // idb
__int64 __fastcall AppleUSBUHCI::CreateIsochTransfer(AppleUSBUHCI *this, IOUSBControllerIsochEndpoint *a2, __int64 a3);
void __fastcall AppleUSBUHCI::AddIsochFramesToSchedule(uintptr_t arg1, IOUSBControllerIsochEndpoint *a2);
signed __int64 AppleUSBUHCI::UIMCreateIsochTransfer();
signed __int64 AppleUSBUHCI::UIMCreateIsochTransfer();
__int64 __fastcall AppleUSBUHCI::UIMCreateIsochTransfer(uintptr_t arg1, __int64 a2);
__int64 __fastcall AppleUSBUHCI::HandleEndpointAbort(AppleUSBUHCI *this, int a2, unsigned __int16 a3, __int16 a4, char a5);
__int64 __fastcall AppleUSBUHCI::UIMAbortEndpoint(AppleUSBUHCI *this, int a2, unsigned __int16 a3, __int16 a4);
__int64 __fastcall AppleUSBUHCI::UIMClearEndpointStall(AppleUSBUHCI *this, int a2, unsigned __int16 a3, __int16 a4);
__int64 __fastcall AppleUSBUHCI::UIMDeleteEndpoint(AppleUSBUHCI *this, int a2, uintptr_t a3, uintptr_t a4);
__int64 __fastcall AppleUSBUHCI::UnlinkQueueHead(uintptr_t arg1, uintptr_t arg2, uintptr_t arg3); // idb
void __fastcall AppleUSBUHCI::UIMCheckForTimeouts(AppleUSBUHCI *this);
__int64 __fastcall AppleUSBUHCI::ReturnOneTransaction(AppleUSBUHCI *this, AppleUHCITransferDescriptor *a2, AppleUHCIQueueHead *a3, AppleUHCIQueueHead *a4, int a5);
__int64 __fastcall AppleUSBUHCI::findBufferRemaining(AppleUSBUHCI *__hidden this, AppleUHCIQueueHead *); // idb
__int64 __fastcall AppleUSBUHCI::TDToUSBError(AppleUSBUHCI *this, int a2);
__int64 __fastcall AppleUSBUHCI::UIMEnableAddressEndpoints(AppleUSBUHCI *this, unsigned __int16 a2, char a3);
__int64 __fastcall AppleUSBUHCI::UIMEnableAllEndpoints(AppleUSBUHCI *this, char a2);
__int64 __fastcall AppleUSBUHCI::MetaClass::MetaClass(AppleUSBUHCI::MetaClass *__hidden this); // idb
__int64 __fastcall AppleUSBUHCI::MetaClass::~MetaClass(AppleUSBUHCI::MetaClass *__hidden this); // idb
__int64 __fastcall AppleUSBUHCI::AppleUSBUHCI(IOUSBControllerV3 *a1, const OSMetaClass *a2);
__int64 __fastcall AppleUSBUHCI::AppleUSBUHCI(IOUSBControllerV3 *a1, const OSMetaClass *a2);
__int64 __fastcall AppleUSBUHCI::~AppleUSBUHCI(AppleUSBUHCI *__hidden this); // idb
__int64 __fastcall AppleUSBUHCI::~AppleUSBUHCI(AppleUSBUHCI *__hidden this); // idb
void __fastcall AppleUSBUHCI::~AppleUSBUHCI(AppleUSBUHCI *this);
__int64 __fastcall AppleUSBUHCI::getMetaClass(AppleUSBUHCI *__hidden this); // idb
__int64 __fastcall AppleUSBUHCI::MetaClass::MetaClass(AppleUSBUHCI::MetaClass *__hidden this); // idb
IOUSBControllerV3 *__fastcall AppleUSBUHCI::MetaClass::alloc(AppleUSBUHCI::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall AppleUSBUHCI::AppleUSBUHCI(IOUSBControllerV3 *a1);
__int64 __fastcall AppleUSBUHCI::AppleUSBUHCI(IOUSBControllerV3 *a1);
char __fastcall AppleUSBUHCI::init(__int64 a1);
int __fastcall AppleUSBUHCI::start(AppleUSBUHCI *this, IOService *a2);
int __fastcall AppleUSBUHCI::finalize(AppleUSBUHCI *this);
__int64 __fastcall AppleUSBUHCI::EnableUSBInterrupt(AppleUSBUHCI *this, unsigned __int8 a2);
__int64 __fastcall AppleUSBUHCI::HardwareInit(AppleUSBUHCI *this); // idb
unsigned __int16 __fastcall AppleUSBUHCI::ioWrite16(AppleUSBUHCI *this, __int16 a2, unsigned __int16 a3);
__int64 __fastcall AppleUSBUHCI::GlobalReset(AppleUSBUHCI *__hidden this); // idb
__int64 __fastcall AppleUSBUHCI::Reset(AppleUSBUHCI *this, char a2);
__int64 __fastcall AppleUSBUHCI::InitializeBufferMemory(AppleUSBUHCI *__hidden this); // idb
__int64 __fastcall AppleUSBUHCI::ioWrite32(AppleUSBUHCI *this, __int16 a2, unsigned int a3);
__int64 __fastcall AppleUSBUHCI::AllocateQH(uintptr_t arg1, unsigned __int64 a2, unsigned __int16 a3, unsigned __int8 a4, __int16 a5, __int16 a6, unsigned __int8 a7);
__int64 __fastcall AppleUSBUHCI::AllocateTD(AppleUSBUHCI *__hidden this, AppleUHCIQueueHead *); // idb
__int64 __fastcall AppleUSBUHCI::UIMInitialize(AppleUSBUHCI *this, IOService *); // idb
__int64 __fastcall AppleUSBUHCI::SetVendorInfo(AppleUSBUHCI *__hidden this); // idb
// int __usercall AppleUSBUHCI::SetDeviceName@<eax>(AppleUSBUHCI *this@<rdi>, __int64 a2@<rax>);
__int64 __fastcall AppleUSBUHCI::UIMFinalize(AppleUSBUHCI *this); // idb
void __fastcall AppleUSBUHCI::FreeBufferMemory(AppleUSBUHCI *this);
int __fastcall AppleUSBUHCI::message(uintptr_t arg1, const char *a2, IOService *a3, void *a4);
__int64 __fastcall AppleUSBUHCI::GetBandwidthAvailable(AppleUSBUHCI *__hidden this); // idb
__int64 __fastcall AppleUSBUHCI::ioRead16(AppleUSBUHCI *this, __int16 a2);
__int64 __fastcall AppleUSBUHCI::Run(AppleUSBUHCI *this, char a2);
unsigned __int64 __fastcall AppleUSBUHCI::GetFrameNumber(uintptr_t arg1);
int __fastcall AppleUSBUHCI::GetFrameNumber32(AppleUSBUHCI *this);
int __fastcall AppleUSBUHCI::GetFrameNumberWithTime(AppleUSBUHCI *this, unsigned __int64 *a2, unsigned __int64 *a3);
__int64 __fastcall AppleUSBUHCI::GatedGetFrameNumberWithTime(AppleUSBUHCI *__hidden this, OSObject *, void *, void *, void *, void *); // idb
unsigned __int8 __fastcall AppleUSBUHCI::ioWrite8(AppleUSBUHCI *this, __int16 a2, unsigned __int8 a3);
__int64 __fastcall AppleUSBUHCI::ioRead8(AppleUSBUHCI *this, __int16 a2);
unsigned __int32 __fastcall AppleUSBUHCI::ioRead32(AppleUSBUHCI *this, __int16 a2);
void __fastcall AppleUSBUHCI::showRegisters(AppleUSBUHCI *this, __int64 a2, const char *a3);
__int64 __fastcall AppleUSBUHCI::ProcessCompletedTransactions(AppleUSBUHCI *__hidden this); // idb
__int64 __fastcall AppleUSBUHCI::scavengeIsochTransactions(AppleUSBUHCI *this); // idb
__int64 __fastcall AppleUSBUHCI::scavengeQueueHeads(AppleUSBUHCI *__hidden this, IOUSBControllerListElement *); // idb
__int64 __fastcall AppleUSBUHCI::scavengeAnIsochTD(AppleUSBUHCI *__hidden this, AppleUHCIIsochTransferDescriptor *); // idb
int __fastcall AppleUSBUHCI::PutTDonDoneQueue(AppleUSBUHCI *this, IOUSBControllerIsochEndpoint *a2, IOUSBControllerIsochListElement *a3, unsigned __int8 a4);
char *__fastcall AppleUSBUHCI::ReleaseIsochAlignmentBuffer(AppleUSBUHCI *this, UHCIAlignmentBuffer *a2);
char *__fastcall AppleUSBUHCI::ReleaseCBIAlignmentBuffer(AppleUSBUHCI *this, UHCIAlignmentBuffer *a2);
__int64 __fastcall AppleUSBUHCI::UHCIUIMDoDoneQueueProcessing(AppleUSBUHCI *this, AppleUHCITransferDescriptor *a2, unsigned int a3, AppleUHCITransferDescriptor *a4);
__int64 __fastcall AppleUSBUHCI::DeallocateTD(AppleUSBUHCI *this, AppleUHCITransferDescriptor *a2);
__int64 __fastcall AppleUSBUHCI::ReturnIsochDoneQueue(AppleUSBUHCI *this, IOUSBControllerIsochEndpoint *a2);
__int64 __fastcall AppleUSBUHCI::AllocateITD(AppleUSBUHCI *this, unsigned __int64 a2);
__int64 __fastcall AppleUSBUHCI::DeallocateITD(AppleUSBUHCI *this, AppleUHCIIsochTransferDescriptor *a2);
__int64 __fastcall AppleUSBUHCI::DeallocateQH(AppleUSBUHCI *this, AppleUHCIQueueHead *a2);
IOUSBControllerIsochEndpoint *__fastcall AppleUSBUHCI::AllocateIsochEP(AppleUSBUHCI *this, unsigned __int64 a2);
__int64 __fastcall AppleUSBUHCI::GetLowLatencyOptionsAndPhysicalMask(AppleUSBUHCI *__hidden this, unsigned int *, unsigned __int64 *); // idb
__int64 __fastcall UHCIAlignmentBuffer::UHCIAlignmentBuffer(__int64 a1);
__int64 __fastcall AppleUSBUHCI::GetCBIAlignmentBuffer(AppleUSBUHCI *__hidden this); // idb
__int64 __fastcall AppleUSBUHCI::GetIsochAlignmentBuffer(AppleUSBUHCI *__hidden this); // idb
__int64 __fastcall UHCIAlignmentBuffer::MetaClass::MetaClass(UHCIAlignmentBuffer::MetaClass *__hidden this); // idb
__int64 __fastcall UHCIAlignmentBuffer::MetaClass::~MetaClass(UHCIAlignmentBuffer::MetaClass *__hidden this); // idb
__int64 __fastcall UHCIAlignmentBuffer::UHCIAlignmentBuffer(__int64 a1, __int64 a2);
__int64 __fastcall UHCIAlignmentBuffer::UHCIAlignmentBuffer(__int64 a1, __int64 a2);
__int64 __fastcall UHCIAlignmentBuffer::~UHCIAlignmentBuffer(UHCIAlignmentBuffer *__hidden this); // idb
__int64 __fastcall UHCIAlignmentBuffer::~UHCIAlignmentBuffer(UHCIAlignmentBuffer *__hidden this); // idb
void __fastcall UHCIAlignmentBuffer::~UHCIAlignmentBuffer(UHCIAlignmentBuffer *this);
__int64 __fastcall UHCIAlignmentBuffer::getMetaClass(UHCIAlignmentBuffer *__hidden this); // idb
__int64 __fastcall UHCIAlignmentBuffer::MetaClass::MetaClass(UHCIAlignmentBuffer::MetaClass *__hidden this); // idb
__int64 __fastcall UHCIAlignmentBuffer::MetaClass::alloc(UHCIAlignmentBuffer::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall UHCIAlignmentBuffer::UHCIAlignmentBuffer(__int64 a1);
__int64 __fastcall AppleUSBUHCIDMACommand::MetaClass::MetaClass(AppleUSBUHCIDMACommand::MetaClass *__hidden this); // idb
__int64 __fastcall AppleUSBUHCIDMACommand::MetaClass::~MetaClass(AppleUSBUHCIDMACommand::MetaClass *__hidden this); // idb
__int64 __fastcall AppleUSBUHCIDMACommand::AppleUSBUHCIDMACommand(IODMACommand *a1, const OSMetaClass *a2);
__int64 __fastcall AppleUSBUHCIDMACommand::AppleUSBUHCIDMACommand(IODMACommand *a1, const OSMetaClass *a2);
__int64 __fastcall AppleUSBUHCIDMACommand::~AppleUSBUHCIDMACommand(AppleUSBUHCIDMACommand *__hidden this); // idb
__int64 __fastcall AppleUSBUHCIDMACommand::~AppleUSBUHCIDMACommand(AppleUSBUHCIDMACommand *__hidden this); // idb
void __fastcall AppleUSBUHCIDMACommand::~AppleUSBUHCIDMACommand(AppleUSBUHCIDMACommand *this);
__int64 __fastcall AppleUSBUHCIDMACommand::getMetaClass(AppleUSBUHCIDMACommand *__hidden this); // idb
__int64 __fastcall AppleUSBUHCIDMACommand::MetaClass::MetaClass(AppleUSBUHCIDMACommand::MetaClass *__hidden this); // idb
IODMACommand *__fastcall AppleUSBUHCIDMACommand::MetaClass::alloc(AppleUSBUHCIDMACommand::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall AppleUSBUHCIDMACommand::AppleUSBUHCIDMACommand(IODMACommand *a1);
__int64 __fastcall AppleUSBUHCIDMACommand::AppleUSBUHCIDMACommand(IODMACommand *a1);
__int64 __fastcall AppleUSBUHCIDMACommand::withSpecification(__int64 a1, unsigned __int64 a2, __int64 a3, unsigned int a4, __int64 a5);
__int64 __fastcall AppleUSBUHCIDMACommand::clearMemoryDescriptor(AppleUSBUHCIDMACommand *this, unsigned __int8 a2);
__int64 __fastcall AppleUSBUHCI::GetNewDMACommand(AppleUSBUHCI *__hidden this); // idb
int __fastcall AppleUSBUHCI::PrintFrameList(AppleUSBUHCI *this, unsigned int a2, unsigned int a3);
__int64 __fastcall AppleUSBUHCI::MetaClass::~MetaClass(AppleUSBUHCI::MetaClass *__hidden this); // idb
__int64 __fastcall UHCIAlignmentBuffer::MetaClass::~MetaClass(UHCIAlignmentBuffer::MetaClass *__hidden this); // idb
__int64 __fastcall AppleUSBUHCIDMACommand::MetaClass::~MetaClass(AppleUSBUHCIDMACommand::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a();
__int64 `global destructor keyed to'_a();
__int64 __fastcall AppleUHCItdMemoryBlock::MetaClass::MetaClass(AppleUHCItdMemoryBlock::MetaClass *__hidden this); // idb
__int64 __fastcall AppleUHCItdMemoryBlock::MetaClass::~MetaClass(AppleUHCItdMemoryBlock::MetaClass *__hidden this); // idb
__int64 __fastcall AppleUHCItdMemoryBlock::AppleUHCItdMemoryBlock(__int64 a1, __int64 a2);
__int64 __fastcall AppleUHCItdMemoryBlock::AppleUHCItdMemoryBlock(__int64 a1, __int64 a2);
__int64 __fastcall AppleUHCItdMemoryBlock::~AppleUHCItdMemoryBlock(AppleUHCItdMemoryBlock *__hidden this); // idb
__int64 __fastcall AppleUHCItdMemoryBlock::~AppleUHCItdMemoryBlock(AppleUHCItdMemoryBlock *__hidden this); // idb
void __fastcall AppleUHCItdMemoryBlock::~AppleUHCItdMemoryBlock(AppleUHCItdMemoryBlock *this);
__int64 __fastcall AppleUHCItdMemoryBlock::getMetaClass(AppleUHCItdMemoryBlock *__hidden this); // idb
__int64 __fastcall AppleUHCItdMemoryBlock::MetaClass::MetaClass(AppleUHCItdMemoryBlock::MetaClass *__hidden this); // idb
__int64 __fastcall AppleUHCItdMemoryBlock::MetaClass::alloc(AppleUHCItdMemoryBlock::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall AppleUHCItdMemoryBlock::AppleUHCItdMemoryBlock(__int64 a1);
__int64 __fastcall AppleUHCItdMemoryBlock::AppleUHCItdMemoryBlock(__int64 a1);
__int64 __fastcall AppleUHCItdMemoryBlock::NewMemoryBlock(AppleUHCItdMemoryBlock *this, unsigned __int64 a2);
__int64 __fastcall AppleUHCItdMemoryBlock::NumTDs(AppleUHCItdMemoryBlock *__hidden this); // idb
__int64 __fastcall AppleUHCItdMemoryBlock::GetPhysicalPtr(AppleUHCItdMemoryBlock *__hidden this, unsigned int); // idb
__int64 __fastcall AppleUHCItdMemoryBlock::GetLogicalPtr(AppleUHCItdMemoryBlock *__hidden this, unsigned int); // idb
__int64 __fastcall AppleUHCItdMemoryBlock::GetNextBlock(AppleUHCItdMemoryBlock *__hidden this); // idb
void __fastcall AppleUHCItdMemoryBlock::SetNextBlock(AppleUHCItdMemoryBlock *this, AppleUHCItdMemoryBlock *a2);
__int64 __fastcall AppleUHCItdMemoryBlock::MetaClass::~MetaClass(AppleUHCItdMemoryBlock::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_0();
__int64 `global destructor keyed to'_a_0();
__int64 __fastcall AppleUHCIqhMemoryBlock::MetaClass::MetaClass(AppleUHCIqhMemoryBlock::MetaClass *__hidden this); // idb
__int64 __fastcall AppleUHCIqhMemoryBlock::MetaClass::~MetaClass(AppleUHCIqhMemoryBlock::MetaClass *__hidden this); // idb
__int64 __fastcall AppleUHCIqhMemoryBlock::AppleUHCIqhMemoryBlock(__int64 a1, __int64 a2);
__int64 __fastcall AppleUHCIqhMemoryBlock::AppleUHCIqhMemoryBlock(__int64 a1, __int64 a2);
__int64 __fastcall AppleUHCIqhMemoryBlock::~AppleUHCIqhMemoryBlock(AppleUHCIqhMemoryBlock *__hidden this); // idb
__int64 __fastcall AppleUHCIqhMemoryBlock::~AppleUHCIqhMemoryBlock(AppleUHCIqhMemoryBlock *__hidden this); // idb
void __fastcall AppleUHCIqhMemoryBlock::~AppleUHCIqhMemoryBlock(AppleUHCIqhMemoryBlock *this);
__int64 __fastcall AppleUHCIqhMemoryBlock::getMetaClass(AppleUHCIqhMemoryBlock *__hidden this); // idb
__int64 __fastcall AppleUHCIqhMemoryBlock::MetaClass::MetaClass(AppleUHCIqhMemoryBlock::MetaClass *__hidden this); // idb
__int64 __fastcall AppleUHCIqhMemoryBlock::MetaClass::alloc(AppleUHCIqhMemoryBlock::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall AppleUHCIqhMemoryBlock::AppleUHCIqhMemoryBlock(__int64 a1);
__int64 __fastcall AppleUHCIqhMemoryBlock::AppleUHCIqhMemoryBlock(__int64 a1);
__int64 __fastcall AppleUHCIqhMemoryBlock::NewMemoryBlock(AppleUHCIqhMemoryBlock *this, unsigned __int64 a2);
__int64 __fastcall AppleUHCIqhMemoryBlock::NumQHs(AppleUHCIqhMemoryBlock *__hidden this); // idb
__int64 __fastcall AppleUHCIqhMemoryBlock::GetPhysicalPtr(AppleUHCIqhMemoryBlock *__hidden this, unsigned int); // idb
__int64 __fastcall AppleUHCIqhMemoryBlock::GetLogicalPtr(AppleUHCIqhMemoryBlock *__hidden this, unsigned int); // idb
__int64 __fastcall AppleUHCIqhMemoryBlock::GetNextBlock(AppleUHCIqhMemoryBlock *__hidden this); // idb
void __fastcall AppleUHCIqhMemoryBlock::SetNextBlock(AppleUHCIqhMemoryBlock *this, AppleUHCIqhMemoryBlock *a2);
__int64 __fastcall AppleUHCIqhMemoryBlock::MetaClass::~MetaClass(AppleUHCIqhMemoryBlock::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_1();
__int64 `global destructor keyed to'_a_1();
__int64 __fastcall AppleUHCIQueueHead::MetaClass::MetaClass(AppleUHCIQueueHead::MetaClass *__hidden this); // idb
__int64 __fastcall AppleUHCIQueueHead::MetaClass::~MetaClass(AppleUHCIQueueHead::MetaClass *__hidden this); // idb
__int64 __fastcall AppleUHCIQueueHead::AppleUHCIQueueHead(IOUSBControllerListElement *a1, const OSMetaClass *a2);
__int64 __fastcall AppleUHCIQueueHead::AppleUHCIQueueHead(IOUSBControllerListElement *a1, const OSMetaClass *a2);
__int64 __fastcall AppleUHCIQueueHead::~AppleUHCIQueueHead(AppleUHCIQueueHead *__hidden this); // idb
__int64 __fastcall AppleUHCIQueueHead::~AppleUHCIQueueHead(AppleUHCIQueueHead *__hidden this); // idb
void __fastcall AppleUHCIQueueHead::~AppleUHCIQueueHead(AppleUHCIQueueHead *this);
__int64 __fastcall AppleUHCIQueueHead::getMetaClass(AppleUHCIQueueHead *__hidden this); // idb
__int64 __fastcall AppleUHCIQueueHead::MetaClass::MetaClass(AppleUHCIQueueHead::MetaClass *__hidden this); // idb
IOUSBControllerListElement *__fastcall AppleUHCIQueueHead::MetaClass::alloc(AppleUHCIQueueHead::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall AppleUHCIQueueHead::AppleUHCIQueueHead(IOUSBControllerListElement *a1);
__int64 __fastcall AppleUHCIQueueHead::AppleUHCIQueueHead(IOUSBControllerListElement *a1);
__int64 __fastcall AppleUHCIQueueHead::WithSharedMemory(__int64 a1, unsigned __int64 a2);
__int64 __fastcall AppleUHCIQueueHead::GetSharedLogical(AppleUHCIQueueHead *__hidden this); // idb
__int64 __fastcall AppleUHCIQueueHead::SetPhysicalLink(AppleUHCIQueueHead *this, int a2);
__int64 __fastcall AppleUHCIQueueHead::GetPhysicalLink(AppleUHCIQueueHead *__hidden this); // idb
__int64 __fastcall AppleUHCIQueueHead::GetPhysicalAddrWithType(AppleUHCIQueueHead *__hidden this); // idb
int __fastcall AppleUHCIQueueHead::print(AppleUHCIQueueHead *this);
__int64 __fastcall AppleUHCITransferDescriptor::MetaClass::MetaClass(AppleUHCITransferDescriptor::MetaClass *__hidden this); // idb
__int64 __fastcall AppleUHCITransferDescriptor::MetaClass::~MetaClass(AppleUHCITransferDescriptor::MetaClass *__hidden this); // idb
__int64 __fastcall AppleUHCITransferDescriptor::AppleUHCITransferDescriptor(IOUSBControllerListElement *a1, const OSMetaClass *a2);
__int64 __fastcall AppleUHCITransferDescriptor::AppleUHCITransferDescriptor(IOUSBControllerListElement *a1, const OSMetaClass *a2);
__int64 __fastcall AppleUHCITransferDescriptor::~AppleUHCITransferDescriptor(AppleUHCITransferDescriptor *__hidden this); // idb
__int64 __fastcall AppleUHCITransferDescriptor::~AppleUHCITransferDescriptor(AppleUHCITransferDescriptor *__hidden this); // idb
void __fastcall AppleUHCITransferDescriptor::~AppleUHCITransferDescriptor(AppleUHCITransferDescriptor *this);
__int64 __fastcall AppleUHCITransferDescriptor::getMetaClass(AppleUHCITransferDescriptor *__hidden this); // idb
__int64 __fastcall AppleUHCITransferDescriptor::MetaClass::MetaClass(AppleUHCITransferDescriptor::MetaClass *__hidden this); // idb
IOUSBControllerListElement *__fastcall AppleUHCITransferDescriptor::MetaClass::alloc(AppleUHCITransferDescriptor::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall AppleUHCITransferDescriptor::AppleUHCITransferDescriptor(IOUSBControllerListElement *a1);
__int64 __fastcall AppleUHCITransferDescriptor::AppleUHCITransferDescriptor(IOUSBControllerListElement *a1);
__int64 __fastcall AppleUHCITransferDescriptor::WithSharedMemory(__int64 a1, unsigned __int64 a2);
__int64 __fastcall AppleUHCITransferDescriptor::GetSharedLogical(AppleUHCITransferDescriptor *__hidden this); // idb
__int64 __fastcall AppleUHCITransferDescriptor::SetPhysicalLink(AppleUHCITransferDescriptor *this, int a2);
__int64 __fastcall AppleUHCITransferDescriptor::GetPhysicalLink(AppleUHCITransferDescriptor *__hidden this); // idb
__int64 __fastcall AppleUHCITransferDescriptor::GetPhysicalAddrWithType(AppleUHCITransferDescriptor *__hidden this); // idb
__int64 __fastcall AppleUHCITransferDescriptor::print(AppleUHCITransferDescriptor *this);
__int64 __fastcall AppleUHCIIsochTransferDescriptor::MetaClass::MetaClass(AppleUHCIIsochTransferDescriptor::MetaClass *__hidden this); // idb
__int64 __fastcall AppleUHCIIsochTransferDescriptor::MetaClass::~MetaClass(AppleUHCIIsochTransferDescriptor::MetaClass *__hidden this); // idb
__int64 __fastcall AppleUHCIIsochTransferDescriptor::AppleUHCIIsochTransferDescriptor(IOUSBControllerIsochListElement *a1, const OSMetaClass *a2);
__int64 __fastcall AppleUHCIIsochTransferDescriptor::AppleUHCIIsochTransferDescriptor(IOUSBControllerIsochListElement *a1, const OSMetaClass *a2);
__int64 __fastcall AppleUHCIIsochTransferDescriptor::~AppleUHCIIsochTransferDescriptor(AppleUHCIIsochTransferDescriptor *__hidden this); // idb
__int64 __fastcall AppleUHCIIsochTransferDescriptor::~AppleUHCIIsochTransferDescriptor(AppleUHCIIsochTransferDescriptor *__hidden this); // idb
void __fastcall AppleUHCIIsochTransferDescriptor::~AppleUHCIIsochTransferDescriptor(AppleUHCIIsochTransferDescriptor *this);
__int64 __fastcall AppleUHCIIsochTransferDescriptor::getMetaClass(AppleUHCIIsochTransferDescriptor *__hidden this); // idb
__int64 __fastcall AppleUHCIIsochTransferDescriptor::MetaClass::MetaClass(AppleUHCIIsochTransferDescriptor::MetaClass *__hidden this); // idb
IOUSBControllerIsochListElement *__fastcall AppleUHCIIsochTransferDescriptor::MetaClass::alloc(AppleUHCIIsochTransferDescriptor::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall AppleUHCIIsochTransferDescriptor::AppleUHCIIsochTransferDescriptor(IOUSBControllerIsochListElement *a1);
__int64 __fastcall AppleUHCIIsochTransferDescriptor::AppleUHCIIsochTransferDescriptor(IOUSBControllerIsochListElement *a1);
__int64 __fastcall AppleUHCIIsochTransferDescriptor::WithSharedMemory(__int64 a1, unsigned __int64 a2);
__int64 __fastcall AppleUHCIIsochTransferDescriptor::GetSharedLogical(AppleUHCIIsochTransferDescriptor *__hidden this); // idb
__int64 __fastcall AppleUHCIIsochTransferDescriptor::SetPhysicalLink(AppleUHCIIsochTransferDescriptor *this, int a2);
__int64 __fastcall AppleUHCIIsochTransferDescriptor::GetPhysicalLink(AppleUHCIIsochTransferDescriptor *__hidden this); // idb
__int64 __fastcall AppleUHCIIsochTransferDescriptor::GetPhysicalAddrWithType(AppleUHCIIsochTransferDescriptor *__hidden this); // idb
__int64 __fastcall AppleUHCIIsochTransferDescriptor::Deallocate(AppleUHCIIsochTransferDescriptor *a1, AppleUSBUHCI *this);
__int64 __fastcall AppleUHCIIsochTransferDescriptor::UpdateFrameList(AppleUHCIIsochTransferDescriptor *__hidden this, unsigned __int64); // idb
__int64 __fastcall AppleUHCIIsochTransferDescriptor::print(AppleUHCIIsochTransferDescriptor *this);
__int64 __fastcall AppleUHCIQueueHead::MetaClass::~MetaClass(AppleUHCIQueueHead::MetaClass *__hidden this); // idb
__int64 __fastcall AppleUHCITransferDescriptor::MetaClass::~MetaClass(AppleUHCITransferDescriptor::MetaClass *__hidden this); // idb
__int64 __fastcall AppleUHCIIsochTransferDescriptor::MetaClass::~MetaClass(AppleUHCIIsochTransferDescriptor::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_2();
__int64 `global destructor keyed to'_a_2();
void __fastcall AppleUSBUHCI::PollInterrupts(AppleUSBUHCI *this, void (__cdecl *a2)(void *, void *, int, unsigned int));
__int64 __fastcall AppleUSBUHCI::UpdateFrameNumberWithTime(AppleUSBUHCI *__hidden this); // idb
__int64 __fastcall AppleUSBUHCI::PrimaryInterruptFilter(AppleUSBUHCI *this); // idb
__int64 __fastcall AppleUSBUHCI::FilterInterrupt(AppleUSBUHCI *this); // idb
void __fastcall AppleUSBUHCI::InterruptHandler(IOService *this);
void __fastcall AppleUSBUHCI::HandleInterrupt(AppleUSBUHCI *this);
__int64 __fastcall AppleUSBUHCI::GetFrameNumberInternal(AppleUSBUHCI *this); // idb
int _start();
__int64 *OSKextGetCurrentIdentifier();
__int64 *OSKextGetCurrentVersionString();
__int64 OSKextGetCurrentLoadTag();
int _stop();
// int __fastcall IODelay(_QWORD); weak
// int __fastcall IOFree(_QWORD); weak
// int __cdecl IOLockAlloc(_QWORD); weak
// int __fastcall IOLockFree(_QWORD); weak
// int __fastcall IOLockLock(_QWORD); weak
// int __fastcall IOLockUnlock(_QWORD); weak
// int __fastcall IOLog(_QWORD, _QWORD, _QWORD); weak
// int __fastcall IOMalloc(_QWORD); weak
// int __cdecl IOSimpleLockAlloc(_QWORD); weak
// int __cdecl IOSimpleLockFree(_QWORD); weak
// int __fastcall IOSimpleLockLock(_QWORD); weak
// int __fastcall IOSimpleLockTryLock(_QWORD); weak
// int __fastcall IOSimpleLockUnlock(_QWORD); weak
// int __fastcall IOSleep(_QWORD); weak
// int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD); weak
// int __fastcall OSCompareAndSwap(_QWORD, _QWORD, _QWORD); weak
// int __fastcall OSDecrementAtomic(_QWORD); weak
// int __fastcall OSIncrementAtomic(_QWORD); weak
// _QWORD IOMemoryMap::getPhysicalAddress(IOMemoryMap *__hidden this); idb
// _QWORD __cdecl IOPCIDevice::extendedConfigRead16(IOPCIDevice *__hidden this, unsigned __int64); idb
// _QWORD __cdecl IOPCIDevice::extendedConfigWrite8(IOPCIDevice *__hidden this, unsigned __int64, unsigned __int8); idb
// _QWORD __cdecl IOPCIDevice::extendedConfigWrite16(IOPCIDevice *__hidden this, unsigned __int64, unsigned __int16); idb
// int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD); weak
// _QWORD __cdecl OSMetaClass::~OSMetaClass(OSMetaClass *__hidden this); idb
// int __fastcall IODMACommand::withSpecification(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD); weak
// _QWORD __cdecl IODMACommand::IODMACommand(IODMACommand *__hidden this, const OSMetaClass *); idb
// _QWORD __cdecl IODMACommand::~IODMACommand(IODMACommand *__hidden this); idb
// _QWORD IOUSBCommand::GetAddress(IOUSBCommand *__hidden this); idb
// _QWORD IOUSBCommand::GetEndpoint(IOUSBCommand *__hidden this); idb
// _QWORD IOUSBCommand::GetReqCount(IOUSBCommand *__hidden this); idb
// _QWORD IOUSBCommand::GetDirection(IOUSBCommand *__hidden this); idb
// _QWORD __cdecl IOUSBCommand::GetUIMScratch(IOUSBCommand *__hidden this, unsigned int); idb
// _QWORD __cdecl IOUSBCommand::SetUIMScratch(IOUSBCommand *__hidden this, unsigned int, unsigned int); idb
// _QWORD IOUSBCommand::GetNoDataTimeout(IOUSBCommand *__hidden this); idb
// _QWORD IOUSBCommand::GetUSLCompletion(IOUSBCommand *__hidden this); idb
// _QWORD IOUSBCommand::GetCompletionTimeout(IOUSBCommand *__hidden this); idb
// _QWORD IOUSBCommand::GetMultiTransferTransaction(IOUSBCommand *__hidden this); idb
// _QWORD IOUSBCommand::GetFinalTransferInTransaction(IOUSBCommand *__hidden this); idb
// _QWORD IOUSBCommand::GetBuffer(IOUSBCommand *__hidden this); idb
// _QWORD __cdecl IORegistryEntry::getPlane(IORegistryEntry *__hidden this, const char *); idb
// _QWORD __cdecl IOUSBController::ExpressCardPort(IOUSBController *__hidden this, IORegistryEntry *); idb
// int __fastcall IOUSBController::Complete(_QWORD, _QWORD, _QWORD); weak
// int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD); weak
// _QWORD __cdecl IOUSBControllerV3::IOUSBControllerV3(IOUSBControllerV3 *__hidden this, const OSMetaClass *); idb
// _QWORD __cdecl IOUSBControllerV3::~IOUSBControllerV3(IOUSBControllerV3 *__hidden this); idb
// _QWORD __cdecl IOBufferMemoryDescriptor::inTaskWithPhysicalMask(IOBufferMemoryDescriptor *__hidden this, task *, unsigned int, unsigned __int64, unsigned __int64); idb
// _QWORD __cdecl IOUSBControllerListElement::IOUSBControllerListElement(IOUSBControllerListElement *__hidden this, const OSMetaClass *); idb
// _QWORD __cdecl IOUSBControllerListElement::~IOUSBControllerListElement(IOUSBControllerListElement *__hidden this); idb
// int __fastcall IOFilterInterruptEventSource::filterInterruptEventSource(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD); weak
// _QWORD IOUSBControllerIsochEndpoint::IOUSBControllerIsochEndpoint(IOUSBControllerIsochEndpoint *__hidden this); idb
// _QWORD __cdecl IOUSBControllerIsochListElement::IOUSBControllerIsochListElement(IOUSBControllerIsochListElement *__hidden this, const OSMetaClass *); idb
// _QWORD __cdecl IOUSBControllerIsochListElement::~IOUSBControllerIsochListElement(IOUSBControllerIsochListElement *__hidden this); idb
// int __fastcall OSObject::OSObject(_QWORD, _QWORD); weak
// _QWORD __cdecl OSObject::~OSObject(OSObject *__hidden this); idb
// void __cdecl OSObject::operator delete(void *); idb
// _QWORD __cdecl OSObject::operator new(OSObject *__hidden this, unsigned __int64); idb
// _QWORD IOService::getPowerState(IOService *__hidden this); idb
// _QWORD OSMetaClass::instanceConstructed(OSMetaClass *__hidden this); idb
// _QWORD IOService::isInactive(IOService *__hidden this); idb
// int __fastcall absolutetime_to_nanoseconds(_QWORD, _QWORD); weak
// void __cdecl bcopy(const void *, void *, size_t);
// void __cdecl bzero(void *, size_t);
// void __cdecl kernel_debug(uint32_t debugid, uintptr_t arg1, uintptr_t arg2, uintptr_t arg3, uintptr_t arg4, uintptr_t arg5);
// uint64_t mach_absolute_time(void);
// int __fastcall ml_set_interrupts_enabled(_QWORD); weak
// int snprintf(char *, size_t, const char *, ...);
// size_t __cdecl strlcat(char *, const char *, size_t);
// size_t __cdecl strlen(const char *);
// int __cdecl strncmp(const char *, const char *, size_t);
// int __fastcall thread_call_allocate(_QWORD, _QWORD); weak
// int __fastcall thread_call_enter1(_QWORD, _QWORD); weak

//-------------------------------------------------------------------------
// Data declarations

int dword_0 = 4277009103; // weak
segment_command_64 stru_20 = { 25u, 312u, "__TEXT", 0uLL, 53248uLL, 0uLL, 53248uLL, 7, 5, 3u, 0u }; // weak
section_64 stru_68 =
{
  {
    '_',
    '_',
    't',
    'e',
    'x',
    't',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0'
  },
  "__TEXT",
  4768uLL,
  42293uLL,
  4768u,
  4u,
  0u,
  0u,
  2147484672u,
  0u,
  0u,
  0u
}; // weak
section_64 stru_B8 =
{
  {
    '_',
    '_',
    'c',
    's',
    't',
    'r',
    'i',
    'n',
    'g',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0'
  },
  "__TEXT",
  47061uLL,
  6038uLL,
  47061u,
  0u,
  0u,
  0u,
  2u,
  0u,
  0u,
  0u
}; // weak
_UNKNOWN loc_24F7; // weak
_QWORD off_D000[20] =
{
  134640LL,
  134728LL,
  134744LL,
  134752LL,
  135848LL,
  136480LL,
  136496LL,
  136536LL,
  136544LL,
  136568LL,
  136576LL,
  136584LL,
  138232LL,
  138240LL,
  138248LL,
  138264LL,
  138296LL,
  138304LL,
  138312LL,
  138328LL
}; // weak
_QWORD off_D008[19] =
{
  134728LL,
  134744LL,
  134752LL,
  135848LL,
  136480LL,
  136496LL,
  136536LL,
  136544LL,
  136568LL,
  136576LL,
  136584LL,
  138232LL,
  138240LL,
  138248LL,
  138264LL,
  138296LL,
  138304LL,
  138312LL,
  138328LL
}; // weak
__int64 off_D010[18] =
{
  134744LL,
  134752LL,
  135848LL,
  136480LL,
  136496LL,
  136536LL,
  136544LL,
  136568LL,
  136576LL,
  136584LL,
  138232LL,
  138240LL,
  138248LL,
  138264LL,
  138296LL,
  138304LL,
  138312LL,
  138328LL
}; // weak
__int64 off_D018[17] =
{
  134752LL,
  135848LL,
  136480LL,
  136496LL,
  136536LL,
  136544LL,
  136568LL,
  136576LL,
  136584LL,
  138232LL,
  138240LL,
  138248LL,
  138264LL,
  138296LL,
  138304LL,
  138312LL,
  138328LL
}; // weak
_QWORD off_D020[16] =
{
  135848LL,
  136480LL,
  136496LL,
  136536LL,
  136544LL,
  136568LL,
  136576LL,
  136584LL,
  138232LL,
  138240LL,
  138248LL,
  138264LL,
  138296LL,
  138304LL,
  138312LL,
  138328LL
}; // weak
_QWORD off_D028[15] =
{
  136480LL,
  136496LL,
  136536LL,
  136544LL,
  136568LL,
  136576LL,
  136584LL,
  138232LL,
  138240LL,
  138248LL,
  138264LL,
  138296LL,
  138304LL,
  138312LL,
  138328LL
}; // weak
_QWORD off_D030[14] =
{
  136496LL,
  136536LL,
  136544LL,
  136568LL,
  136576LL,
  136584LL,
  138232LL,
  138240LL,
  138248LL,
  138264LL,
  138296LL,
  138304LL,
  138312LL,
  138328LL
}; // weak
_QWORD off_D038[13] =
{
  136536LL,
  136544LL,
  136568LL,
  136576LL,
  136584LL,
  138232LL,
  138240LL,
  138248LL,
  138264LL,
  138296LL,
  138304LL,
  138312LL,
  138328LL
}; // weak
_QWORD off_D040[12] =
{
  136544LL,
  136568LL,
  136576LL,
  136584LL,
  138232LL,
  138240LL,
  138248LL,
  138264LL,
  138296LL,
  138304LL,
  138312LL,
  138328LL
}; // weak
_QWORD off_D048[11] =
{
  136568LL,
  136576LL,
  136584LL,
  138232LL,
  138240LL,
  138248LL,
  138264LL,
  138296LL,
  138304LL,
  138312LL,
  138328LL
}; // weak
_QWORD off_D050[10] =
{
  136576LL,
  136584LL,
  138232LL,
  138240LL,
  138248LL,
  138264LL,
  138296LL,
  138304LL,
  138312LL,
  138328LL
}; // weak
_QWORD off_D058[9] =
{
  136584LL,
  138232LL,
  138240LL,
  138248LL,
  138264LL,
  138296LL,
  138304LL,
  138312LL,
  138328LL
}; // weak
__int64 off_D060[8] =
{
  138232LL,
  138240LL,
  138248LL,
  138264LL,
  138296LL,
  138304LL,
  138312LL,
  138328LL
}; // weak
__int64 off_D068[7] = { 138240LL, 138248LL, 138264LL, 138296LL, 138304LL, 138312LL, 138328LL }; // weak
__int64 off_D070[6] = { 138248LL, 138264LL, 138296LL, 138304LL, 138312LL, 138328LL }; // weak
__int64 off_D078[5] = { 138264LL, 138296LL, 138304LL, 138312LL, 138328LL }; // weak
__int64 off_D080[4] = { 138296LL, 138304LL, 138312LL, 138328LL }; // weak
__int64 off_D088[3] = { 138304LL, 138312LL, 138328LL }; // weak
__int64 off_D090[2] = { 138312LL, 138328LL }; // weak
__int64 off_D098 = 138328LL; // weak
__int64 AppleUSBUHCI::RHDumpPortStatus(int)::strings[] = { 4096LL }; // weak
__int64 AppleUSBUHCI::RHDumpHubPortStatus(IOUSBHubStatus *)::strings[] = { 1LL }; // weak
_QWORD AppleUSBUHCI::metaClass = 62408LL; // weak
__int64 (__fastcall *off_D260[2])(AppleUSBUHCI *__hidden this) = { &AppleUSBUHCI::~AppleUSBUHCI, &AppleUSBUHCI::~AppleUSBUHCI }; // weak
__int64 (__fastcall *off_DFD0[2])(AppleUSBUHCI::MetaClass *__hidden this) = { &AppleUSBUHCI::MetaClass::~MetaClass, &AppleUSBUHCI::MetaClass::~MetaClass }; // weak
_QWORD UHCIVendorInfo = 32902LL; // weak
char *off_E0B8[2] = { "Intel", &UHCI_Intel_devices }; // weak
_QWORD AppleUSBUHCIDMACommand::metaClass = 62488LL; // weak
__int64 (__fastcall *off_E120[2])(UHCIAlignmentBuffer *__hidden this) =
{
  &UHCIAlignmentBuffer::~UHCIAlignmentBuffer,
  &UHCIAlignmentBuffer::~UHCIAlignmentBuffer
}; // weak
__int64 (__fastcall *off_E250[2])(UHCIAlignmentBuffer::MetaClass *__hidden this) =
{
  &UHCIAlignmentBuffer::MetaClass::~MetaClass,
  &UHCIAlignmentBuffer::MetaClass::~MetaClass
}; // weak
__int64 (__fastcall *off_E340[2])(AppleUSBUHCIDMACommand *__hidden this) =
{
  &AppleUSBUHCIDMACommand::~AppleUSBUHCIDMACommand,
  &AppleUSBUHCIDMACommand::~AppleUSBUHCIDMACommand
}; // weak
__int64 (__fastcall *off_E540[2])(AppleUSBUHCIDMACommand::MetaClass *__hidden this) =
{
  &AppleUSBUHCIDMACommand::MetaClass::~MetaClass,
  &AppleUSBUHCIDMACommand::MetaClass::~MetaClass
}; // weak
__int64 (__fastcall *off_E640[2])(AppleUHCItdMemoryBlock *__hidden this) =
{
  &AppleUHCItdMemoryBlock::~AppleUHCItdMemoryBlock,
  &AppleUHCItdMemoryBlock::~AppleUHCItdMemoryBlock
}; // weak
__int64 (__fastcall *off_E770[2])(AppleUHCItdMemoryBlock::MetaClass *__hidden this) =
{
  &AppleUHCItdMemoryBlock::MetaClass::~MetaClass,
  &AppleUHCItdMemoryBlock::MetaClass::~MetaClass
}; // weak
__int64 (__fastcall *off_E870[2])(AppleUHCIqhMemoryBlock *__hidden this) =
{
  &AppleUHCIqhMemoryBlock::~AppleUHCIqhMemoryBlock,
  &AppleUHCIqhMemoryBlock::~AppleUHCIqhMemoryBlock
}; // weak
__int64 (__fastcall *off_E9A0[2])(AppleUHCIqhMemoryBlock::MetaClass *__hidden this) =
{
  &AppleUHCIqhMemoryBlock::MetaClass::~MetaClass,
  &AppleUHCIqhMemoryBlock::MetaClass::~MetaClass
}; // weak
_QWORD AppleUHCIQueueHead::metaClass = 62608LL; // weak
__int64 (__fastcall *off_EAA0[2])(AppleUHCIQueueHead *__hidden this) =
{
  &AppleUHCIQueueHead::~AppleUHCIQueueHead,
  &AppleUHCIQueueHead::~AppleUHCIQueueHead
}; // weak
__int64 (__fastcall *off_EBF0[2])(AppleUHCIQueueHead::MetaClass *__hidden this) =
{
  &AppleUHCIQueueHead::MetaClass::~MetaClass,
  &AppleUHCIQueueHead::MetaClass::~MetaClass
}; // weak
_QWORD AppleUHCITransferDescriptor::metaClass = 62648LL; // weak
__int64 (__fastcall *off_ECF0[2])(AppleUHCITransferDescriptor *__hidden this) =
{
  &AppleUHCITransferDescriptor::~AppleUHCITransferDescriptor,
  &AppleUHCITransferDescriptor::~AppleUHCITransferDescriptor
}; // weak
__int64 (__fastcall *off_EE40[2])(AppleUHCITransferDescriptor::MetaClass *__hidden this) =
{
  &AppleUHCITransferDescriptor::MetaClass::~MetaClass,
  &AppleUHCITransferDescriptor::MetaClass::~MetaClass
}; // weak
_QWORD AppleUHCIIsochTransferDescriptor::metaClass = 62688LL; // weak
__int64 (__fastcall *off_EF40[2])(AppleUHCIIsochTransferDescriptor *__hidden this) =
{
  &AppleUHCIIsochTransferDescriptor::~AppleUHCIIsochTransferDescriptor,
  &AppleUHCIIsochTransferDescriptor::~AppleUHCIIsochTransferDescriptor
}; // weak
__int64 (__fastcall *off_F0A0[2])(AppleUHCIIsochTransferDescriptor::MetaClass *__hidden this) =
{
  &AppleUHCIIsochTransferDescriptor::MetaClass::~MetaClass,
  &AppleUHCIIsochTransferDescriptor::MetaClass::~MetaClass
}; // weak
__int64 kmod_info = 0LL; // weak
_QWORD AppleUSBUHCI::gMetaClass; // weak
_QWORD UHCIAlignmentBuffer::gMetaClass; // weak
_QWORD AppleUSBUHCIDMACommand::gMetaClass; // weak
_QWORD AppleUHCItdMemoryBlock::gMetaClass; // weak
_QWORD AppleUHCIqhMemoryBlock::gMetaClass; // weak
_QWORD AppleUHCIQueueHead::gMetaClass; // weak
_QWORD AppleUHCITransferDescriptor::gMetaClass; // weak
_QWORD AppleUHCIIsochTransferDescriptor::gMetaClass; // weak
int (*_realmain)(void); // weak
int (*_antimain)(void); // weak


//----- (00000000000012A0) ----------------------------------------------------
signed __int64 AppleUSBUHCI::UIMCreateInterruptTransfer()
{
  return 3758097090LL;
}

//----- (00000000000012AC) ----------------------------------------------------
signed __int64 AppleUSBUHCI::UIMCreateBulkTransfer()
{
  return 3758097090LL;
}

//----- (00000000000012B8) ----------------------------------------------------
signed __int64 __fastcall AppleUSBUHCI::UIMCreateControlTransfer(AppleUSBUHCI *this, __int64 a2, __int64 a3, IOUSBCommand *a4, void *a5)
{
  return 3758097090LL;
}

//----- (00000000000012C4) ----------------------------------------------------
signed __int64 AppleUSBUHCI::UIMCreateControlTransfer()
{
  return 3758097090LL;
}

//----- (00000000000012D0) ----------------------------------------------------
signed __int64 AppleUSBUHCI::UIMCreateControlTransfer()
{
  return 3758097087LL;
}

//----- (00000000000012DC) ----------------------------------------------------
int __fastcall AppleUSBUHCI::CheckSleepCapability(AppleUSBUHCI *this)
{
  __int64 v1; // rax@1
  int v2; // eax@5

  LODWORD(v1) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 61) + 696LL))(
                  *((_QWORD *)this + 61),
                  "built-in");
  if ( v1 && *(_BYTE *)(*((_QWORD *)this + 84) + 209LL) & 8 )
  {
    (*(void (__fastcall **)(AppleUSBUHCI *, _QWORD, _QWORD))(*(_QWORD *)this + 624LL))(this, "Card Type", "Built-in");
    *(_BYTE *)(*((_QWORD *)this + 21) + 200LL) = 1;
  }
  else
  {
    (*(void (__fastcall **)(AppleUSBUHCI *, _QWORD, _QWORD))(*(_QWORD *)this + 624LL))(this, "Card Type", "PCI");
    *(_BYTE *)(*((_QWORD *)this + 21) + 200LL) = 0;
  }
  v2 = IOUSBController::ExpressCardPort(this, *((IORegistryEntry **)this + 61));
  *((_DWORD *)this + 2364) = v2;
  if ( v2 )
    (*(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, AppleUSBUHCI *, _QWORD))(**((_QWORD **)this + 61) + 1728LL))(
      *((_QWORD *)this + 61),
      "RegisterDebugDriver",
      0LL,
      *((_QWORD *)this + 61),
      this,
      0LL);
  *((_BYTE *)this + 9460) = 0;
  return (*(int (__fastcall **)(AppleUSBUHCI *, _QWORD))(*(_QWORD *)this + 1456LL))(this, 0LL);
}

//----- (00000000000013C4) ----------------------------------------------------
int __fastcall AppleUSBUHCI::callPlatformFunction(__int64 a1, __int64 a2, unsigned __int8 a3, __int64 a4, __int64 a5, __int64 a6)
{
  __int64 v6; // r15@1
  __int64 v7; // r12@1
  unsigned __int8 v8; // r13@1
  const char *v9; // rax@1
  int v10; // ecx@4
  __int64 v12; // [sp+0h] [bp-30h]@1

  v12 = a6;
  v6 = a5;
  v7 = a4;
  v8 = a3;
  LODWORD(v9) = (*(int (__fastcall **)(__int64))(*(_QWORD *)a2 + 328LL))(a2);
  if ( !strncmp(v9, "SetDebugDriverPowerState", 0x18uLL) && !v7 )
  {
    if ( *(_BYTE *)(a1 + 9460) )
    {
      v10 = *(_DWORD *)(a1 + 9456);
      if ( v10 )
      {
        if ( *(_BYTE *)(*(_QWORD *)(a1 + 672) + 209LL) & 0x80 )
          IOPCIDevice::extendedConfigWrite8(
            *(IOPCIDevice **)(a1 + 488),
            0xC4uLL,
            ~(unsigned __int8)(1 << (v10 - 1)) & 3);
      }
    }
  }
  return (*(int (__fastcall **)(__int64, __int64, _QWORD, __int64, __int64, __int64))(off_D068[0] + 1736))(
           a1,
           a2,
           v8,
           v7,
           v6,
           v12);
}
// D068: using guessed type __int64 off_D068[7];

//----- (0000000000001482) ----------------------------------------------------
void __fastcall AppleUSBUHCI::ResumeController(AppleUSBUHCI *this)
{
  __int16 v1; // bx@4
  __int64 v2; // rcx@5
  __int64 v3; // rdx@5
  __int64 v4; // rdx@13
  __int64 v5; // rax@15
  __int64 v6; // rcx@15

  if ( *(_BYTE *)off_D080[0] & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D2C2Cu, (uintptr_t)this, 0LL, 0LL, 0LL, 0LL);
  AppleUSBUHCI::showRegisters(this, 7LL, "+ResumeController");
  v1 = AppleUSBUHCI::ioRead16(this, 0);
  if ( !(v1 & 1) )
  {
    v2 = *((_QWORD *)this + 1134);
    v3 = 0LL;
    do
      *(_BYTE *)(v2 + 4 * v3++) |= 1u;
    while ( v3 != 1024 );
    if ( v1 & 8 )
    {
      AppleUSBUHCI::ioWrite16(this, 0, v1 | 0x10);
      v1 = AppleUSBUHCI::ioRead16(this, 0);
    }
    if ( v1 & 0x10 )
    {
      IOSleep(20LL);
      AppleUSBUHCI::ioWrite16(this, 0, v1 & 0xFFE7);
      v1 &= 0xFFE7u;
    }
    if ( (unsigned __int8)(v1 & 0xC0) != 192 )
      AppleUSBUHCI::ioWrite16(this, 0, v1 | 0xC0);
    v4 = *((_QWORD *)this + 109);
    if ( v4 )
      AppleUSBUHCI::ioWrite32(this, 8, v4);
    AppleUSBUHCI::Run(this, 1);
    IOSleep(10LL);
    v5 = *((_QWORD *)this + 1134);
    v6 = 0LL;
    do
      *(_BYTE *)(v5 + 4 * v6++) &= 0xFEu;
    while ( v6 != 1024 );
    AppleUSBUHCI::showRegisters(this, 7LL, "-ResumeController");
  }
}
// D080: using guessed type __int64 off_D080[4];
// D090: using guessed type __int64 off_D090[2];
// 20DA8: using guessed type int __fastcall IOSleep(_QWORD);

//----- (00000000000015E2) ----------------------------------------------------
int __fastcall AppleUSBUHCI::SuspendController(AppleUSBUHCI *this)
{
  __int64 v1; // r12@1
  uintptr_t v2; // r13@4
  __int16 v3; // bx@4
  __int16 v4; // ax@5
  __int16 v5; // ax@12

  v1 = off_D080[0];
  if ( *(_BYTE *)off_D080[0] & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D2C28u, (uintptr_t)this, 0LL, 0LL, 1uLL, 0LL);
  v2 = 0LL;
  AppleUSBUHCI::Run(this, 0);
  v3 = 16;
  do
  {
    v4 = AppleUSBUHCI::ioRead16(this, v3);
    if ( *(_BYTE *)(*((_QWORD *)this + 84) + 209LL) & 0x20 && v4 & 0x800 )
    {
      if ( *(_BYTE *)v1 & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D2C28u, (uintptr_t)this, v2, 0LL, 2uLL, 0LL);
      AppleUSBUHCI::ioWrite16(this, v3, 0x800u);
    }
    ++v2;
    v3 += 2;
  }
  while ( v2 != 2 );
  v5 = AppleUSBUHCI::ioRead16(this, 0);
  AppleUSBUHCI::ioWrite16(this, 0, (v5 | 8) & 0xFFEF);
  *((_BYTE *)this + 440) = 1;
  return IOSleep(3LL);
}
// D080: using guessed type __int64 off_D080[4];
// D090: using guessed type __int64 off_D090[2];
// 20DA8: using guessed type int __fastcall IOSleep(_QWORD);

//----- (00000000000016F0) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::SaveControllerStateForSleep(AppleUSBUHCI *this)
{
  AppleUSBUHCI::SuspendController(this);
  return 0LL;
}

//----- (00000000000016FE) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::RestoreControllerStateFromSleep(AppleUSBUHCI *this)
{
  AppleUSBUHCI *v1; // r15@1
  __int16 v2; // r12@1
  __int64 v3; // rbx@1
  __int64 v4; // rdi@3
  __int64 v5; // rax@4
  __int64 v6; // rax@5

  v1 = this;
  v2 = 16;
  v3 = 0LL;
  do
  {
    if ( (AppleUSBUHCI::ioRead16(v1, v2) & 0x42) == 64 )
    {
      v4 = *((_QWORD *)v1 + 19);
      if ( v4
        && (LODWORD(v5) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v4 + 2608LL))(v4, (unsigned __int16)v2), v5) )
      {
        LODWORD(v6) = (*(int (**)(void))(**((_QWORD **)v1 + 19) + 2608LL))();
        (*(void (__fastcall **)(__int64, signed __int64, AppleUSBUHCI *, __int64))(*(_QWORD *)v6 + 1840LL))(
          v6,
          3758112790LL,
          v1,
          v3);
      }
      else
      {
        IOLog(
          "USB (UHCI):Port %d on bus 0x%x has remote wakeup from some device\n",
          (unsigned int)(v3 + 1),
          *(_DWORD *)(*((_QWORD *)v1 + 21) + 28LL));
      }
    }
    ++v3;
    v2 += 2;
  }
  while ( v3 != 2 );
  AppleUSBUHCI::ResumeController(v1);
  return 0LL;
}
// 20D70: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD);

//----- (00000000000017AA) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::ResetControllerState(AppleUSBUHCI *this)
{
  signed int v1; // ebx@4
  unsigned int v2; // er14@9
  __int64 v3; // rdx@10
  signed __int64 v4; // rax@10

  if ( *(_BYTE *)off_D080[0] & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D2C30u, (uintptr_t)this, 0LL, 0LL, 0LL, 0LL);
  v1 = 0;
  AppleUSBUHCI::ioWrite16(this, 0, 2u);
  while ( AppleUSBUHCI::ioRead16(this, 0) & 2 )
  {
    IOSleep(1LL);
    ++v1;
    if ( v1 >= 100 )
      goto LABEL_9;
  }
  if ( v1 >= 100 )
  {
LABEL_9:
    KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBUHCI::ResetControllerStatecontroller - reset failed");
    return -536870186;
  }
  v3 = *((_QWORD *)this + 109);
  v4 = 4649LL;
  if ( v3 )
  {
    AppleUSBUHCI::ioWrite32(this, 8, v3);
    v4 = 4649LL;
  }
  do
    *((_WORD *)this + v4++) = 0;
  while ( v4 != 4651 );
  v2 = 0;
  AppleUSBUHCI::ioWrite16(this, 0, 0xC0u);
  return v2;
}
// D080: using guessed type __int64 off_D080[4];
// D090: using guessed type __int64 off_D090[2];
// 20DA8: using guessed type int __fastcall IOSleep(_QWORD);
// 20DB0: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (0000000000001896) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::RestartControllerFromReset(AppleUSBUHCI *this)
{
  if ( *(_BYTE *)off_D080[0] & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D2C34u, (uintptr_t)this, 0LL, 0LL, 0LL, 0LL);
  AppleUSBUHCI::Run(this, 1);
  *((_WORD *)this + 4723) = 15;
  return 0LL;
}
// D080: using guessed type __int64 off_D080[4];
// D090: using guessed type __int64 off_D090[2];

//----- (00000000000018F0) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::EnableInterruptsFromController(AppleUSBUHCI *this, unsigned __int8 a2)
{
  unsigned __int8 v2; // si@5

  if ( *(_BYTE *)off_D080[0] & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D2C38u, (uintptr_t)this, a2, 0LL, 0LL, 0LL);
  if ( a2 )
  {
    AppleUSBUHCI::ioWrite16(this, 4, *((_WORD *)this + 4723));
    *((_WORD *)this + 4723) = 0;
    v2 = 1;
  }
  else
  {
    *((_WORD *)this + 4723) = AppleUSBUHCI::ioRead16(this, 4);
    AppleUSBUHCI::ioWrite16(this, 4, 0);
    v2 = 0;
  }
  AppleUSBUHCI::EnableUSBInterrupt(this, v2);
  return 0LL;
}
// D080: using guessed type __int64 off_D080[4];
// D090: using guessed type __int64 off_D090[2];

//----- (000000000000198E) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::DozeController(AppleUSBUHCI *this)
{
  signed __int64 v1; // rax@1
  char v2; // r14@3
  __int16 v3; // ax@9

  v1 = 9344LL;
  if ( *(_BYTE *)off_D080[0] & 2 && (v1 = 9344LL, *(_DWORD *)off_D090[0] & 0xFFFFFFF7) )
  {
    v2 = 0;
    kernel_debug(0x52D2C3Cu, (uintptr_t)this, 0LL, 0LL, 0LL, 0LL);
    v1 = 9344LL;
  }
  else
  {
    v2 = 0;
  }
  do
  {
    if ( *((_BYTE *)this + v1) )
      v2 = 1;
    ++v1;
  }
  while ( v1 != 9346 );
  if ( !(v2 & 1) )
  {
    AppleUSBUHCI::showRegisters(this, 7LL, "+DozeController -  stopping controller");
    AppleUSBUHCI::Run(this, 0);
    v3 = AppleUSBUHCI::ioRead16(this, 0);
    AppleUSBUHCI::ioWrite16(this, 0, (v3 | 8) & 0xFFEF);
    *((_BYTE *)this + 440) = 1;
    IOSleep(3LL);
  }
  return 0LL;
}
// D080: using guessed type __int64 off_D080[4];
// D090: using guessed type __int64 off_D090[2];
// 20DA8: using guessed type int __fastcall IOSleep(_QWORD);

//----- (0000000000001A50) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::WakeControllerFromDoze(AppleUSBUHCI *this)
{
  char *v1; // r14@1
  signed __int64 v2; // rbx@1
  __int16 v3; // ax@5
  __int16 v4; // r14@6
  char *v5; // rbx@6
  signed __int64 v6; // r12@6
  __int16 v7; // ax@8
  char v9; // [sp+Eh] [bp-22h]@1

  v1 = &v9;
  v2 = -4LL;
  if ( *(_BYTE *)off_D080[0] & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D2C40u, (uintptr_t)this, 0LL, 0LL, 0LL, 0LL);
  do
  {
    *v1++ = ((unsigned __int8)AppleUSBUHCI::ioRead16(this, (unsigned __int16)v2 + 20) >> 6) & 1;
    v2 += 2LL;
  }
  while ( v2 );
  v3 = AppleUSBUHCI::ioRead16(this, 0);
  if ( v3 & 8 )
  {
    AppleUSBUHCI::ioWrite16(this, 0, v3 | 0x10);
    v4 = AppleUSBUHCI::ioRead16(this, 0);
    IOSleep(20LL);
    AppleUSBUHCI::ioWrite16(this, 0, v4 & 0xFFE7);
    v5 = &v9;
    v6 = -4LL;
    do
    {
      if ( *v5 )
      {
        v7 = AppleUSBUHCI::ioRead16(this, (unsigned __int16)v6 + 20);
        AppleUSBUHCI::ioWrite16(this, v6 + 20, v7 & 0xEFB5);
        _mm_mfence();
        IOSleep(2LL);
      }
      ++v5;
      v6 += 2LL;
    }
    while ( v6 );
  }
  AppleUSBUHCI::Run(this, 1);
  *((_BYTE *)this + 440) = 2;
  AppleUSBUHCI::showRegisters(this, 7LL, "-WakeControllerFromDoze");
  return 0LL;
}
// D080: using guessed type __int64 off_D080[4];
// D090: using guessed type __int64 off_D090[2];
// 20DA8: using guessed type int __fastcall IOSleep(_QWORD);

//----- (0000000000001B90) ----------------------------------------------------
int __fastcall AppleUSBUHCI::powerStateWillChangeTo(AppleUSBUHCI *this, __int64 a2, uintptr_t a3, IOService *a4)
{
  IOService *v4; // r14@1
  uintptr_t v5; // r12@1

  v4 = a4;
  v5 = a3;
  if ( *(_BYTE *)off_D080[0] & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D2C44u, (uintptr_t)this, a3, 0LL, 1uLL, 0LL);
  AppleUSBUHCI::showRegisters(this, 7LL, "powerStateWillChangeTo");
  return (*(int (__fastcall **)(AppleUSBUHCI *, __int64, uintptr_t, IOService *))(off_D068[0] + 2072))(this, a2, v5, v4);
}
// D068: using guessed type __int64 off_D068[7];
// D080: using guessed type __int64 off_D080[4];
// D090: using guessed type __int64 off_D090[2];

//----- (0000000000001C12) ----------------------------------------------------
int __fastcall AppleUSBUHCI::powerStateDidChangeTo(AppleUSBUHCI *this, __int64 a2, uintptr_t a3, IOService *a4)
{
  IOService *v4; // r14@1
  uintptr_t v5; // r12@1

  v4 = a4;
  v5 = a3;
  if ( *(_BYTE *)off_D080[0] & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D2C44u, (uintptr_t)this, a3, 0LL, 2uLL, 0LL);
  AppleUSBUHCI::showRegisters(this, 7LL, "powerStateDidChangeTo");
  return (*(int (__fastcall **)(AppleUSBUHCI *, __int64, uintptr_t, IOService *))(off_D068[0] + 2080))(this, a2, v5, v4);
}
// D068: using guessed type __int64 off_D068[7];
// D080: using guessed type __int64 off_D080[4];
// D090: using guessed type __int64 off_D090[2];

//----- (0000000000001C94) ----------------------------------------------------
int __fastcall AppleUSBUHCI::powerChangeDone(AppleUSBUHCI *this, uintptr_t arg2)
{
  unsigned int v2; // eax@1

  v2 = IOService::getPowerState(this);
  if ( *(_BYTE *)off_D080[0] & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D2C44u, (uintptr_t)this, arg2, v2, 3uLL, 0LL);
  if ( *((_BYTE *)this + 444) )
    AppleUSBUHCI::showRegisters(this, 7LL, "powerChangeDone");
  return (*(int (__fastcall **)(AppleUSBUHCI *, uintptr_t))(off_D068[0] + 2136))(this, arg2);
}
// D068: using guessed type __int64 off_D068[7];
// D080: using guessed type __int64 off_D080[4];
// D090: using guessed type __int64 off_D090[2];

//----- (0000000000001D10) ----------------------------------------------------
signed __int64 __fastcall AppleUSBUHCI::GetRootHubDeviceDescriptor(__int64 a1, void *a2)
{
  signed __int64 result; // rax@1
  __int64 v3; // [sp+8h] [bp-18h]@1
  __int64 v4; // [sp+10h] [bp-10h]@1
  __int16 v5; // [sp+18h] [bp-8h]@1

  v5 = 256;
  v4 = 72621714370266540LL;
  v3 = 576460790974906642LL;
  result = 3758097085LL;
  if ( a2 )
  {
    bcopy(&v3, a2, 0x12uLL);
    result = 0LL;
  }
  return result;
}

//----- (0000000000001D5A) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::GetRootHubDescriptor(__int64 a1, void *a2)
{
  __int64 v2; // r15@1
  signed int v3; // ebx@1
  __int64 v4; // rax@2
  __int64 v5; // rax@2
  char v6; // al@3
  char v7; // cl@3
  __int64 result; // rax@6
  char v9; // [sp+0h] [bp-40h]@2
  char v10; // [sp+1h] [bp-3Fh]@2
  char v11; // [sp+2h] [bp-3Eh]@2
  __int16 v12; // [sp+3h] [bp-3Dh]@2
  char v13; // [sp+5h] [bp-3Bh]@2
  char v14; // [sp+6h] [bp-3Ah]@2
  char v15; // [sp+7h] [bp-39h]@5
  char v16; // [sp+8h] [bp-38h]@5
  __int64 v17; // [sp+20h] [bp-20h]@1

  v2 = off_D078[0];
  v17 = *(_QWORD *)off_D078[0];
  v3 = -536870211;
  if ( a2 )
  {
    v9 = 25;
    v10 = 41;
    v11 = 2;
    *(_BYTE *)(a1 + 505) = 2;
    v13 = 50;
    v14 = 0;
    v12 = 18;
    LODWORD(v4) = (*(int (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(a1 + 488) + 696LL))(
                    *(_QWORD *)(a1 + 488),
                    "AAPL,device-internal");
    LODWORD(v5) = OSMetaClassBase::safeMetaCast(v4, *(_QWORD *)off_D050[0]);
    v3 = 0;
    if ( v5 )
    {
      v6 = (*(int (__fastcall **)(__int64))(*(_QWORD *)v5 + 328LL))(v5);
      v7 = v9 - 16;
    }
    else
    {
      v7 = 9;
      v6 = 0;
    }
    v15 = v6;
    v16 = -1;
    v9 = v7;
    bcopy(&v9, a2, (unsigned __int8)v7);
  }
  result = *(_QWORD *)v2;
  if ( *(_QWORD *)v2 == v17 )
    result = (unsigned int)v3;
  return result;
}
// D050: using guessed type _QWORD off_D050[10];
// D078: using guessed type __int64 off_D078[5];
// 211C8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000001E24) ----------------------------------------------------
__int64 AppleUSBUHCI::SetRootHubDescriptor()
{
  return 0LL;
}

//----- (0000000000001E2C) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::GetRootHubConfDescriptor(__int64 a1, __int64 a2)
{
  signed int v2; // er14@1
  __int64 v4; // [sp+8h] [bp-38h]@1
  __int64 v5; // [sp+10h] [bp-30h]@1
  char v6; // [sp+18h] [bp-28h]@1
  __int64 v7; // [sp+20h] [bp-20h]@1
  __int16 v8; // [sp+28h] [bp-18h]@1

  v8 = 0;
  v7 = 6917530131449446922LL;
  v6 = 0;
  v5 = 9899899618313LL;
  v4 = 9007233673266440LL;
  v2 = -536870211;
  if ( a2 )
  {
    if ( (unsigned __int8)(*(int (__fastcall **)(_QWORD, __int64 *, signed __int64))(*(_QWORD *)a2 + 360LL))(
                            a2,
                            &v7,
                            10LL) )
    {
      if ( (unsigned __int8)(*(int (__fastcall **)(__int64, __int64 *, signed __int64))(*(_QWORD *)a2 + 360LL))(
                              a2,
                              &v5,
                              9LL) )
      {
        v2 = -536870211;
        if ( (unsigned __int8)(*(int (__fastcall **)(__int64, __int64 *, signed __int64))(*(_QWORD *)a2 + 360LL))(
                                a2,
                                &v4,
                                8LL) )
          v2 = 0;
      }
    }
  }
  return (unsigned int)v2;
}

//----- (0000000000001EDE) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::SetRootHubFeature(AppleUSBUHCI *this)
{
  return 0LL;
}

//----- (0000000000001EE6) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::ClearRootHubFeature(AppleUSBUHCI *this)
{
  return 0LL;
}

//----- (0000000000001EEE) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::GetRootHubStatus(__int64 a1, __int64 a2)
{
  *(_DWORD *)a2 = 0;
  return 0LL;
}

//----- (0000000000001EFC) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::GetRootHubPortStatus(AppleUSBUHCI *this, __int64 a2, int a3)
{
  int v3; // ebx@1
  __int64 v4; // r14@1
  AppleUSBUHCI *v5; // r15@1
  int v6; // ebx@1
  __int64 v7; // r13@1
  __int64 result; // rax@1
  __int16 v9; // r12@2
  __int16 v10; // ax@2
  char v11; // dl@4
  int v12; // eax@4
  int v13; // ebx@4
  int v14; // esi@4
  int v15; // ecx@4
  __int64 v16; // rdi@6
  __int16 v17; // cx@6
  bool v18; // al@10
  __int16 v19; // dx@12
  __int16 v20; // cx@12
  __int16 v21; // ax@14

  v3 = a3;
  v4 = a2;
  v5 = this;
  AppleUSBUHCI::RHDumpPortStatus(this, a3);
  v6 = v3 - 1;
  v7 = (unsigned __int16)v6;
  result = 3758097090LL;
  if ( (unsigned __int16)v6 <= 1u )
  {
    v9 = 2 * v6 + 16;
    v10 = AppleUSBUHCI::ioRead16(this, v9);
    LOWORD(v6) = v10;
    if ( (v10 & 0x1001) == 4096 )
    {
      v6 = v10 & 0xEFF5;
      AppleUSBUHCI::ioWrite16(this, v9, v6);
      LOWORD(v6) = AppleUSBUHCI::ioRead16(this, v9);
    }
    v11 = v6;
    v12 = ((unsigned int)v6 >> 10) & 4;
    v13 = ((unsigned int)v6 >> 1) & 2 | 2 * (_WORD)v6 & 0x200 | v12 | ((unsigned int)v6 >> 5) & 0x10 | v6 & 1 | 0x100;
    *(_WORD *)a2 = v13;
    v14 = *((_WORD *)this + v7 + 4649);
    v15 = (v14 ^ v13) & 0xFFFD;
    if ( v11 & 8 )
      LOWORD(v15) = v14 ^ v13 | 2;
    v16 = v15 | 1u;
    v17 = v15 & 0xFFFE;
    if ( v11 & 2 )
      v17 = v16;
    if ( !(v14 & 4) || (_WORD)v12 )
    {
      v18 = *((_BYTE *)v5 + v7 + 9304) == 0;
    }
    else
    {
      *((_BYTE *)v5 + v7 + 9304) = 1;
      v18 = 0;
    }
    v19 = v17 | 4;
    v20 = v17 & 0xFFFB;
    if ( !v18 )
      v20 = v19;
    v21 = v20 | 0x10;
    if ( !*((_BYTE *)v5 + v7 + 9302) )
      v21 = v20;
    *(_WORD *)(v4 + 2) = v21;
    if ( v21 )
      AppleUSBUHCI::RHDumpHubPortStatus(v16, (unsigned __int16 *)v4);
    *((_WORD *)v5 + v7 + 4649) = v13;
    result = 0LL;
  }
  return result;
}

//----- (0000000000002050) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::RHDumpPortStatus(AppleUSBUHCI *this, __int16 a2)
{
  __int64 v2; // r15@1
  unsigned __int16 v3; // r12@1
  const char *v4; // rsi@1
  __int64 v5; // rbx@1
  char v7; // [sp+0h] [bp-70h]@1
  __int64 v8; // [sp+40h] [bp-30h]@1

  v2 = off_D078[0];
  v8 = *(_QWORD *)off_D078[0];
  v7 = 0;
  v3 = AppleUSBUHCI::ioRead16(this, 2 * a2 + 14);
  v4 = "SUSPEND ";
  v5 = 0LL;
  do
  {
    if ( v3 & AppleUSBUHCI::RHDumpPortStatus(int)::strings[v5] )
      strlcat(&v7, v4, 0x40uLL);
    v4 = (const char *)AppleUSBUHCI::RHDumpPortStatus(int)::strings[v5 + 3];
    v5 += 2LL;
  }
  while ( v5 != 20 );
  return *(_QWORD *)v2;
}
// D078: using guessed type __int64 off_D078[5];
// D0E0: using guessed type __int64 AppleUSBUHCI::RHDumpPortStatus(int)::strings[];

//----- (00000000000020DA) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::RHDumpHubPortStatus(__int64 a1, unsigned __int16 *a2)
{
  unsigned __int16 *v2; // rbx@1
  unsigned __int16 v3; // r13@1
  const char *v4; // rsi@1
  __int64 v5; // r15@1
  unsigned __int16 v6; // r12@5
  const char *v7; // rsi@5
  __int64 v8; // rbx@5
  char v10; // [sp+0h] [bp-B0h]@1
  __int64 v11; // [sp+80h] [bp-30h]@1

  v2 = a2;
  v11 = *(_QWORD *)off_D078[0];
  v10 = 0;
  v3 = *a2;
  v4 = "kHubPortConnection ";
  v5 = 0LL;
  do
  {
    if ( v3 & AppleUSBUHCI::RHDumpHubPortStatus(IOUSBHubStatus *)::strings[v5] )
      strlcat(&v10, v4, 0x80uLL);
    v4 = (const char *)AppleUSBUHCI::RHDumpHubPortStatus(IOUSBHubStatus *)::strings[v5 + 3];
    v5 += 2LL;
  }
  while ( v5 != 20 );
  v10 = 0;
  v6 = v2[1];
  v7 = "kHubPortConnection ";
  v8 = 0LL;
  do
  {
    if ( v6 & AppleUSBUHCI::RHDumpHubPortStatus(IOUSBHubStatus *)::strings[v8] )
      strlcat(&v10, v7, 0x80uLL);
    v7 = (const char *)AppleUSBUHCI::RHDumpHubPortStatus(IOUSBHubStatus *)::strings[v8 + 3];
    v8 += 2LL;
  }
  while ( v8 != 20 );
  return *(_QWORD *)off_D078[0];
}
// D078: using guessed type __int64 off_D078[5];
// D190: using guessed type __int64 AppleUSBUHCI::RHDumpHubPortStatus(IOUSBHubStatus *)::strings[];

//----- (00000000000021B2) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::SetRootHubPortFeature(AppleUSBUHCI *this, int a2, unsigned __int16 a3)
{
  __int16 v4; // r14@4
  __int16 v5; // ax@4

  if ( a2 == 1 )
  {
    v4 = 2 * a3 + 14;
    v5 = AppleUSBUHCI::ioRead16(this, v4);
    AppleUSBUHCI::ioWrite16(this, v4, (v5 | 4) & 0xFFF5);
  }
  else
  {
    if ( a2 == 4 )
      return AppleUSBUHCI::RHResetPort(this, a3);
    if ( a2 == 2 )
      return AppleUSBUHCI::RHSuspendPort(this, a3, 1);
  }
  return 0LL;
}

//----- (0000000000002220) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::RHSuspendPort(AppleUSBUHCI *this, __int64 a2, char a3)
{
  char v3; // r15@1
  __int64 result; // rax@2
  __int16 v5; // bx@6
  __int16 v6; // ax@6
  int v7; // [sp+0h] [bp-2Ch]@6

  v3 = a3;
  AppleUSBUHCI::showRegisters(this, 7LL, "RHSuspendPort");
  if ( *((_BYTE *)this + (signed int)a2 + 9343) )
  {
    result = 0LL;
    if ( !v3 )
      return result;
    if ( *(_BYTE *)off_D080[0] & 2 )
    {
      if ( *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D2C1Cu, (uintptr_t)this, (signed int)a2, 0LL, 0LL, 0LL);
    }
  }
  v5 = a2 - 1;
  v7 = AppleUSBUHCI::ioRead16(this, 0);
  v6 = AppleUSBUHCI::ioRead16(this, 2 * ((unsigned __int16)a2 - 1) + 16) & 0xEFB5;
  if ( v3 )
  {
    a2 = (unsigned __int16)(2 * v5 + 16);
    AppleUSBUHCI::ioWrite16(this, a2, v6 | 0x1004);
    IOSleep(3LL);
  }
  else
  {
    if ( v7 & 8 )
    {
      KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBUHCI::RHSuspendPort attempt to resume during global suspend");
      return 3758097084LL;
    }
    AppleUSBUHCI::ioWrite16(this, 2 * v5 + 16, v6 | 0x1044);
    *((_BYTE *)this + (signed int)a2 + 9343) = 1;
    a2 = (signed int)a2;
    thread_call_enter1(*((_QWORD *)this + (signed int)a2 + 1168), (signed int)a2);
  }
  (*(void (__fastcall **)(AppleUSBUHCI *, __int64))(*(_QWORD *)this + 2248LL))(this, a2);
  return 0LL;
}
// D080: using guessed type __int64 off_D080[4];
// D090: using guessed type __int64 off_D090[2];
// 20DA8: using guessed type int __fastcall IOSleep(_QWORD);
// 20DB0: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);
// 21C98: using guessed type int __fastcall thread_call_enter1(_QWORD, _QWORD);

//----- (0000000000002352) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::RHResetPort(AppleUSBUHCI *this, int a2)
{
  signed __int64 v2; // r12@1
  __int16 v3; // ax@1
  __int16 v4; // ax@1
  signed int v5; // ebx@1
  __int16 v6; // ax@1
  signed int v7; // er13@1
  __int16 v8; // dx@2

  v2 = a2 - 1LL;
  v3 = AppleUSBUHCI::ioRead16(this, 2 * (unsigned __int16)v2 + 16);
  AppleUSBUHCI::ioWrite16(this, 2 * v2 + 16, (v3 | 0x200) & 0xFFF5);
  IOSleep(50LL);
  v4 = AppleUSBUHCI::ioRead16(this, 2 * (unsigned __int16)v2 + 16);
  AppleUSBUHCI::ioWrite16(this, 2 * v2 + 16, v4 & 0xFDF5);
  v5 = 10;
  IODelay(10LL);
  v6 = AppleUSBUHCI::ioRead16(this, 2 * (unsigned __int16)v2 + 16);
  AppleUSBUHCI::ioWrite16(this, 2 * v2 + 16, (v6 | 4) & 0xFFF5);
  v7 = -536870163;
  while ( 1 )
  {
    IOSleep(10LL);
    v8 = AppleUSBUHCI::ioRead16(this, 2 * (unsigned __int16)v2 + 16);
    if ( !(v8 & 1) )
      return (unsigned int)v7;
    if ( v8 & 0xA )
    {
      AppleUSBUHCI::ioWrite16(this, 2 * v2 + 16, v8 | 0xA);
    }
    else if ( v8 & 4 )
    {
      goto LABEL_7;
    }
    --v5;
    if ( v5 <= 0 )
    {
LABEL_7:
      if ( v5 )
      {
        *((_BYTE *)this + v2 + 9302) = 1;
        v7 = 0;
      }
      return (unsigned int)v7;
    }
  }
}
// 20D40: using guessed type int __fastcall IODelay(_QWORD);
// 20DA8: using guessed type int __fastcall IOSleep(_QWORD);

//----- (000000000000244C) ----------------------------------------------------
unsigned __int16 __fastcall AppleUSBUHCI::RHEnablePort(AppleUSBUHCI *this, __int16 a2, char a3)
{
  char v3; // r14@1
  int v4; // eax@1
  unsigned __int16 v5; // cx@1

  v3 = a3;
  v4 = AppleUSBUHCI::ioRead16(this, 2 * a2 + 14) & 0xFFFFFFF1;
  v5 = v4 | 4;
  if ( !v3 )
    v5 = v4;
  return AppleUSBUHCI::ioWrite16(this, 2 * a2 + 14, v5);
}

//----- (0000000000002490) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::ClearRootHubPortFeature(AppleUSBUHCI *this, signed int a2, unsigned __int16 a3)
{
  __int16 v3; // bx@3
  unsigned __int16 v4; // ax@3

  if ( a2 > 15 )
  {
    switch ( a2 )
    {
      case 16:
        v3 = 2 * a3 + 14;
        v4 = ((unsigned __int64)AppleUSBUHCI::ioRead16(this, v3) | 2) & 0xFFF7;
        goto LABEL_9;
      case 17:
        v3 = 2 * a3 + 14;
        v4 = ((unsigned __int64)AppleUSBUHCI::ioRead16(this, v3) | 8) & 0xFFFD;
        goto LABEL_9;
      default:
        return 0LL;
      case 18:
        *((_BYTE *)this + a3 + 9303) = 0;
        break;
      case 20:
        *((_BYTE *)this + a3 + 9301) = 0;
        break;
    }
  }
  else if ( a2 == 1 )
  {
    v3 = 2 * a3 + 14;
    v4 = AppleUSBUHCI::ioRead16(this, v3) & 0xFFF1;
LABEL_9:
    AppleUSBUHCI::ioWrite16(this, v3, v4);
  }
  else if ( a2 == 2 )
  {
    AppleUSBUHCI::RHSuspendPort(this, a3, 0);
  }
  return 0LL;
}

//----- (0000000000002560) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::GetRootHubPortState(AppleUSBUHCI *this, unsigned __int8 *a2)
{
  return 0LL;
}

//----- (0000000000002568) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::SetHubAddress(AppleUSBUHCI *this, __int16 a2)
{
  *((_WORD *)this + 4648) = a2;
  return 0LL;
}

//----- (0000000000002578) ----------------------------------------------------
void __fastcall AppleUSBUHCI::UIMRootHubStatusChange(AppleUSBUHCI *this)
{
  ;
}

//----- (000000000000257E) ----------------------------------------------------
void __fastcall AppleUSBUHCI::UIMRootHubStatusChange(AppleUSBUHCI *this)
{
  char v1; // r12@3
  uintptr_t v2; // rbx@3
  uintptr_t v3; // r14@4
  __int64 v4; // rax@5
  uint64_t v5; // rax@5
  unsigned __int64 v6; // rcx@5
  char v7; // al@5
  uint64_t v8; // rax@16
  AppleUSBUHCI *v9; // r8@16
  AppleUSBUHCI *v10; // r14@19
  __int16 v11; // ax@19
  __int64 v12; // rax@19
  __int16 v13; // [sp+Ch] [bp-44h]@3
  __int64 v14; // [sp+10h] [bp-40h]@3
  unsigned __int64 v15; // [sp+18h] [bp-38h]@5
  unsigned __int16 v16; // [sp+20h] [bp-30h]@4
  unsigned __int16 v17; // [sp+22h] [bp-2Eh]@4

  if ( *((_BYTE *)this + 444) && !*((_BYTE *)this + 441) )
  {
    AppleUSBUHCI::RHCheckStatus(this);
    v1 = 2;
    v13 = 16;
    v2 = 0LL;
    v14 = 0LL;
    while ( 1 )
    {
      v3 = v2++;
      (*(void (__fastcall **)(AppleUSBUHCI *, __int16 *, _QWORD))(*(_QWORD *)this + 2312LL))(
        this,
        &v16,
        (unsigned __int16)v2);
      if ( v17 )
      {
        AppleUSBUHCI::RHDumpHubPortStatus((__int64)this, &v16);
        v4 = v14;
        LOBYTE(v4) = v1 | v14;
        v14 = v4;
        v5 = mach_absolute_time();
        absolutetime_to_nanoseconds(v5 - *((_QWORD *)this + v3 + 1166), &v15);
        v6 = v15;
        v15 = 19342813113834067LL * (v15 >> 9) >> 64 >> 11;
        v7 = *((_BYTE *)this + v3 + 9320);
        if ( v7 && v6 >= 0x77359400 )
        {
          *((_BYTE *)this + v3 + 9320) = 0;
        }
        else if ( v7 )
        {
          if ( !(v17 & 2) || (v16 & 0x103) != 259 )
            *((_BYTE *)this + v3 + 9320) = 0;
          goto LABEL_20;
        }
        if ( !(v16 & 2) && HIBYTE(v16) & 1 && !(((v17 & 2) == 0 || (v16 & 1) == 0) | v17 & 1) )
        {
          *((_BYTE *)this + v3 + 9320) = 1;
          v8 = mach_absolute_time();
          v9 = this;
          *((_QWORD *)this + v3 + 1166) = v8;
          if ( *(_BYTE *)off_D080[0] & 2 )
          {
            if ( *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
            {
              kernel_debug(0x52D2C18u, (uintptr_t)this, v16, v17, v2, 0LL);
              v9 = this;
            }
          }
          v10 = v9;
          v11 = AppleUSBUHCI::ioRead16(v9, v13);
          AppleUSBUHCI::ioWrite16(v10, v13, (v11 | 4) & 0xFFF5);
          this = v10;
          v12 = v14;
          LOBYTE(v12) = v1 ^ v14;
          v14 = v12;
        }
      }
LABEL_20:
      v1 *= 2;
      v13 += 2;
      if ( v2 == 2 )
      {
        *((_WORD *)this + 253) = (unsigned __int8)v14;
        return;
      }
    }
  }
}
// D080: using guessed type __int64 off_D080[4];
// D090: using guessed type __int64 off_D090[2];
// 21C20: using guessed type int __fastcall absolutetime_to_nanoseconds(_QWORD, _QWORD);

//----- (0000000000002788) ----------------------------------------------------
int __fastcall AppleUSBUHCI::RHCheckStatus(AppleUSBUHCI *this)
{
  __int16 v1; // r15@1
  __int64 v2; // rbx@1
  int result; // eax@3

  v1 = 16;
  v2 = 0LL;
  do
  {
    if ( !*((_BYTE *)this + v2 + 9344) )
    {
      result = AppleUSBUHCI::ioRead16(this, v1);
      if ( result & 0x40 )
      {
        if ( *((_QWORD *)this + 57) >= 3uLL )
        {
          if ( *((_QWORD *)this + 57) == 3LL )
            (*(void (__fastcall **)(AppleUSBUHCI *, _QWORD))(*(_QWORD *)this + 2976LL))(this, (unsigned __int16)v1);
          *((_BYTE *)this + v2 + 9344) = 1;
          result = thread_call_enter1(*((_QWORD *)this + v2 + 1169), v2 + 1);
        }
      }
    }
    ++v2;
    v1 += 2;
  }
  while ( v2 != 2 );
  return result;
}
// 21C98: using guessed type int __fastcall thread_call_enter1(_QWORD, _QWORD);

//----- (0000000000002802) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::GetRootHubStringDescriptor(__int64 a1, char a2, __int64 a3)
{
  __int64 v3; // rax@1
  __int64 v4; // r14@1
  signed int v5; // ebx@1
  __int64 v6; // rcx@4
  signed __int64 v7; // rdx@4
  __int64 *v8; // rsi@4
  __int64 result; // rax@10
  __int64 v10; // [sp+0h] [bp-70h]@1
  __int64 v11; // [sp+8h] [bp-68h]@1
  int v12; // [sp+10h] [bp-60h]@1
  __int16 v13; // [sp+14h] [bp-5Ch]@1
  __int64 v14; // [sp+20h] [bp-50h]@1
  __int64 v15; // [sp+28h] [bp-48h]@1
  __int64 v16; // [sp+30h] [bp-40h]@1
  __int64 v17; // [sp+38h] [bp-38h]@1
  __int64 v18; // [sp+40h] [bp-30h]@1
  __int64 v19; // [sp+48h] [bp-28h]@1
  __int16 v20; // [sp+50h] [bp-20h]@1
  __int64 v21; // [sp+58h] [bp-18h]@1

  v3 = a3;
  v4 = off_D078[0];
  v21 = *(_QWORD *)off_D078[0];
  v19 = 31244173394051169LL;
  v18 = 30399800003068009LL;
  v17 = 23362560512360565LL;
  v16 = 20266335769722991LL;
  v15 = 31244074604298313LL;
  v14 = 18859132682830592LL;
  v20 = 110;
  v11 = 20547810745450604LL;
  v10 = 31525678432191232LL;
  v13 = 46;
  v12 = 6488174;
  v5 = -536870206;
  if ( (unsigned __int8)(a2 - 1) > 1u )
    goto LABEL_10;
  LOBYTE(v10) = 22;
  LOBYTE(v14) = 50;
  if ( a2 == 2 )
  {
    v5 = -536870211;
    if ( !a3 )
      goto LABEL_10;
    v6 = *(_QWORD *)a3;
    v7 = (unsigned __int8)v10;
    v8 = &v10;
    goto LABEL_8;
  }
  if ( a2 == 1 )
  {
    v5 = -536870211;
    if ( !a3 )
      goto LABEL_10;
    v6 = *(_QWORD *)a3;
    v8 = &v14;
    v7 = 50LL;
LABEL_8:
    if ( !(unsigned __int8)(*(int (__fastcall **)(__int64, __int64 *, signed __int64))(v6 + 360))(v3, v8, v7) )
      goto LABEL_10;
  }
  v5 = 0;
LABEL_10:
  result = *(_QWORD *)v4;
  if ( *(_QWORD *)v4 == v21 )
    result = (unsigned int)v5;
  return result;
}
// D078: using guessed type __int64 off_D078[5];

//----- (000000000000291E) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::RootHubAbortInterruptRead(AppleUSBUHCI *this)
{
  AppleUSBUHCI *v1; // rbx@1
  int v2; // er14@2
  __int64 v3; // r8@4
  __int64 v4; // rsi@4
  __int64 v5; // rdx@4
  __int64 v6; // rdi@4

  v1 = this;
  if ( *(_BYTE *)(*((_QWORD *)this + 84) + 210LL) & 0x20 )
  {
    v2 = (*(int (**)(void))(off_D068[0] + 3016))();
  }
  else
  {
    (*(void (**)(void))(*(_QWORD *)this + 3016LL))();
    (*(void (__fastcall **)(AppleUSBUHCI *, _QWORD))(*(_QWORD *)this + 3176LL))(
      this,
      (unsigned int)(30 * **((_DWORD **)this + 84)));
    v2 = 0;
    if ( *((_QWORD *)this + 67) )
    {
      v3 = *((_QWORD *)this + 68);
      v4 = *((_QWORD *)this + 66);
      v5 = *((_DWORD *)this + 130);
      *((_QWORD *)this + 68) = *((_QWORD *)this + 73);
      *((_QWORD *)this + 67) = *((_QWORD *)this + 72);
      *((_QWORD *)this + 66) = *((_QWORD *)this + 71);
      v6 = *((_QWORD *)this + 69);
      *((_QWORD *)v1 + 65) = *((_QWORD *)v1 + 70);
      *((_QWORD *)v1 + 64) = v6;
      *((_QWORD *)v1 + 72) = 0LL;
      IOUSBController::Complete(v1, 3758097131LL, v5);
    }
  }
  return (unsigned int)v2;
}
// D068: using guessed type __int64 off_D068[7];
// 211C0: using guessed type int __fastcall IOUSBController::Complete(_QWORD, _QWORD, _QWORD);

//----- (0000000000002A2E) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::RHLastPortStatusChanged(AppleUSBUHCI *this)
{
  return *((_QWORD *)this + 1164);
}

//----- (0000000000002A3C) ----------------------------------------------------
bool __fastcall AppleUSBUHCI::RHAreAllPortsDisconnectedOrSuspended(AppleUSBUHCI *this)
{
  signed int v1; // er15@1
  __int16 v2; // bx@1

  v1 = 0;
  v2 = 16;
  while ( (AppleUSBUHCI::ioRead16(this, v2) & 0x1001) != 1 )
  {
    ++v1;
    v2 += 2;
    if ( v1 > 1 )
      return *((_DWORD *)this + 2323) == 0;
  }
  return 0;
}

//----- (0000000000002A8C) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::RHDeleteEndpoint(AppleUSBUHCI *this, __int16 a2, __int16 a3)
{
  __int64 result; // rax@1

  result = 0LL;
  if ( a2 == 1 )
  {
    result = 3758097090LL;
    if ( a3 == 1 )
    {
      (*(void (**)(void))(*(_QWORD *)this + 3000LL))();
      result = 0LL;
    }
  }
  return result;
}

//----- (0000000000002AB4) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::RHAbortEndpoint(AppleUSBUHCI *this, __int16 a2, __int16 a3)
{
  __int64 result; // rax@1

  result = 0LL;
  if ( a2 == 1 )
  {
    result = 3758097090LL;
    if ( a3 == 1 )
    {
      (*(void (**)(void))(*(_QWORD *)this + 3000LL))();
      result = 0LL;
    }
  }
  return result;
}

//----- (0000000000002ADC) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::RHHoldPortReset(AppleUSBUHCI *this, int a2)
{
  __int16 v2; // ax@4

  if ( *(_BYTE *)off_D080[0] & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D2C20u, (uintptr_t)this, a2, 0LL, 0LL, 0LL);
  v2 = AppleUSBUHCI::ioRead16(this, 2 * (unsigned __int16)a2 + 14);
  AppleUSBUHCI::ioWrite16(this, 2 * a2 + 14, (v2 | 0x200) & 0xFFF5);
  return 0LL;
}
// D080: using guessed type __int64 off_D080[4];
// D090: using guessed type __int64 off_D090[2];

//----- (0000000000002B54) ----------------------------------------------------
int __fastcall AppleUSBUHCI::RHResumePortTimerEntry(AppleUSBUHCI *this, OSObject *a2, void *a3)
{
  AppleUSBUHCI *v3; // rax@1

  LODWORD(v3) = OSMetaClassBase::safeMetaCast(this, AppleUSBUHCI::metaClass);
  if ( v3 )
    LODWORD(v3) = AppleUSBUHCI::RHResumePortTimer(v3, (unsigned int)a2);
  return (signed int)v3;
}
// D240: using guessed type _QWORD AppleUSBUHCI::metaClass;
// 211C8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000002B88) ----------------------------------------------------
int __fastcall AppleUSBUHCI::RHResumePortTimer(AppleUSBUHCI *this, unsigned int a2)
{
  int result; // eax@2

  if ( *((_QWORD *)this + 18) )
  {
    IOSleep(20LL);
    (*(void (__fastcall **)(AppleUSBUHCI *))(*(_QWORD *)this + 2976LL))(this);
    result = (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(**((_QWORD **)this + 18) + 456LL))(
               *((_QWORD *)this + 18),
               AppleUSBUHCI::RHResumePortCompletionEntry,
               a2,
               0LL,
               0LL,
               0LL);
  }
  return result;
}
// 20DA8: using guessed type int __fastcall IOSleep(_QWORD);

//----- (0000000000002BE4) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::RHResumePortCompletionEntry(AppleUSBUHCI *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  AppleUSBUHCI *v6; // rax@1
  __int64 result; // rax@2

  LODWORD(v6) = OSMetaClassBase::safeMetaCast(this, AppleUSBUHCI::metaClass);
  if ( v6 )
    result = AppleUSBUHCI::RHResumePortCompletion(v6, (int)a2);
  else
    result = 3758097097LL;
  return result;
}
// D240: using guessed type _QWORD AppleUSBUHCI::metaClass;
// 211C8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000002C1E) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::RHResumePortCompletion(AppleUSBUHCI *this, int a2)
{
  __int64 v2; // r15@1
  __int16 v3; // ax@3
  signed int v4; // er14@3

  v2 = (unsigned int)(a2 - 1);
  if ( *((_BYTE *)this + v2 + 9344) )
  {
    if ( *((_BYTE *)this + 444) )
    {
      v3 = AppleUSBUHCI::ioRead16(this, 2 * ((unsigned __int16)a2 - 1) + 16);
      AppleUSBUHCI::ioWrite16(this, 2 * (a2 - 1) + 16, v3 & 0xEFB5);
      _mm_mfence();
      IOSleep(2LL);
      *((_BYTE *)this + v2 + 9344) = 0;
      *((_BYTE *)this + v2 + 9304) = 1;
      (*(void (__fastcall **)(AppleUSBUHCI *))(*(_QWORD *)this + 2976LL))(this);
      v4 = 0;
    }
    else
    {
      *((_BYTE *)this + v2 + 9344) = 0;
      v4 = -536870199;
    }
  }
  else
  {
    v4 = -536870199;
    if ( *(_BYTE *)off_D080[0] & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D2C24u, (uintptr_t)this, a2, 0LL, 0xFFFFFFFFE00002C9LL, 0LL);
  }
  return (unsigned int)v4;
}
// D080: using guessed type __int64 off_D080[4];
// D090: using guessed type __int64 off_D090[2];
// 20DA8: using guessed type int __fastcall IOSleep(_QWORD);

//----- (0000000000002CFA) ----------------------------------------------------
int __usercall AppleUSBUHCI::UIMCreateControlEndpoint@<eax>(AppleUSBUHCI *this@<rdi>, int a2)
{
  return (*(int (**)(void))(*(_QWORD *)this + 2152LL))();
}

//----- (0000000000002D0C) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::UIMCreateControlEndpoint(AppleUSBUHCI *this, int a2, unsigned __int8 a3, __int16 a4, unsigned __int8 a5)
{
  unsigned __int8 v5; // r14@1
  signed int v6; // ebx@1
  __int64 v7; // rax@3
  __int64 v8; // r15@3
  __int64 v9; // rsi@4
  AppleUHCITransferDescriptor *v10; // rax@4
  int v11; // ebx@5
  char *v12; // rax@5
  __int64 v13; // rbx@7
  void (__fastcall *v14)(_QWORD, _QWORD); // r13@7
  __int64 v15; // rax@7
  void (__fastcall *v16)(_QWORD, _QWORD); // r13@7
  __int64 v17; // rax@7

  v5 = a5;
  v6 = 0;
  if ( a2 != *((_WORD *)this + 4648) )
  {
    if ( a4 )
    {
      v7 = AppleUSBUHCI::AllocateQH((uintptr_t)this, (unsigned __int8)a2, a3, 2u, a5, a4, 0);
      v8 = v7;
      v6 = -536870211;
      if ( v7 )
      {
        v9 = v7;
        v10 = (AppleUHCITransferDescriptor *)AppleUSBUHCI::AllocateTD(this, (AppleUHCIQueueHead *)v7);
        if ( v10 )
        {
          *(_DWORD *)(AppleUHCITransferDescriptor::GetSharedLogical(v10) + 4) = 0;
          *(_QWORD *)(v8 + 56) = v10;
          *(_QWORD *)(v8 + 64) = v10;
          v11 = (*(int (__fastcall **)(AppleUHCITransferDescriptor *, __int64))(*(_QWORD *)v10 + 296LL))(v10, v9);
          *(_DWORD *)(AppleUHCIQueueHead::GetSharedLogical((AppleUHCIQueueHead *)v8) + 4) = v11;
          v12 = (char *)this + 9128;
          if ( !v5 )
            v12 = (char *)this + 9144;
          v13 = *(_QWORD *)v12;
          *(_QWORD *)(v8 + 32) = *(_QWORD *)(*(_QWORD *)v12 + 32LL);
          v14 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v8 + 280LL);
          LODWORD(v15) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v13 + 288LL))(v13);
          v14(v8, v15);
          _mm_mfence();
          *(_QWORD *)(v13 + 32) = v8;
          v16 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v13 + 280LL);
          LODWORD(v17) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v8 + 296LL))(v8);
          v16(v13, v17);
          _mm_mfence();
          if ( v5 )
            *((_QWORD *)this + 1141) = v8;
          else
            *((_QWORD *)this + 1143) = v8;
          v6 = 0;
        }
        else
        {
          AppleUSBUHCI::DeallocateQH(this, (AppleUHCIQueueHead *)v8);
        }
      }
    }
    else
    {
      v6 = -536870206;
      if ( *(_BYTE *)off_D080[0] & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D3004u, (unsigned __int8)a2, a3, a5, 0xFFFFFFFFE00002C2LL, 0LL);
    }
  }
  return (unsigned int)v6;
}
// D080: using guessed type __int64 off_D080[4];
// D090: using guessed type __int64 off_D090[2];

//----- (0000000000002EA0) ----------------------------------------------------
__int64 __usercall AppleUSBUHCI::UIMCreateControlTransfer@<rax>(AppleUSBUHCI *this@<rdi>, __int16 a2@<dx>, IOUSBCommand *a3@<rcx>, __int16 a4@<si>, uintptr_t a5@<r8>, unsigned int a6, unsigned __int16 a7)
{
  IOUSBCommand *v7; // r15@1
  __int16 v8; // r14@1
  __int64 v9; // rbx@1
  __int64 result; // rax@1
  uintptr_t v11; // [sp+10h] [bp-30h]@1

  v11 = a5;
  v7 = a3;
  v8 = a2;
  v9 = AppleUSBUHCI::FindQueueHead(this, a4, a2, 3, 0, 0LL);
  result = 3758112855LL;
  if ( v9 )
  {
    if ( *(_BYTE *)(v9 + 53) )
    {
      result = 3758112847LL;
      if ( v8 )
        return result;
      KernelDebugLogInternal(
        1LL,
        1431519814LL,
        "AppleUSBUHCI::UIMCreateControlTransfer - address %d endpoint 0 is incorrectly marked as stalled!");
    }
    result = AppleUSBUHCI::AllocTDChain(this, (AppleUHCIQueueHead *)v9, v7, v11, a6, a7, 1);
  }
  return result;
}
// 20DB0: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (0000000000002F40) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::FindQueueHead(AppleUSBUHCI *this, __int16 a2, __int16 a3, char a4, unsigned __int8 a5, AppleUHCIQueueHead **a6)
{
  unsigned __int8 v6; // r12@1
  __int64 v7; // rax@1
  AppleUHCIQueueHead *v8; // r15@1
  char *v9; // rax@11
  char *v10; // rcx@11
  __int64 v11; // rbx@15
  __int64 v12; // r12@16
  __int64 v13; // rax@23
  AppleUHCIQueueHead **v15; // [sp+0h] [bp-50h]@1
  _BYTE v16[12]; // [sp+14h] [bp-3Ch]@2
  int v17; // [sp+20h] [bp-30h]@1
  int v18; // [sp+24h] [bp-2Ch]@1

  v15 = a6;
  v6 = a5;
  LOBYTE(v18) = a4;
  LOWORD(v17) = a3;
  v7 = *((_QWORD *)this + 1144);
  v8 = 0LL;
  if ( v7 )
  {
    *(_QWORD *)&v16[4] = 0LL;
    while ( 1 )
    {
      v8 = (AppleUHCIQueueHead *)v7;
      if ( *(_WORD *)(v7 + 40) == a2
        && *(_WORD *)(v7 + 42) == (signed __int16)v17
        && ((unsigned __int8)v18 == 3 || *(_BYTE *)(v7 + 50) == (unsigned __int8)v18)
        && *(_BYTE *)(v7 + 51) == v6 )
        break;
      LODWORD(v7) = OSMetaClassBase::safeMetaCast(*(_QWORD *)(v7 + 32), AppleUHCIQueueHead::metaClass);
      if ( !v7 )
        goto LABEL_9;
    }
  }
  else
  {
LABEL_9:
    if ( v6 )
    {
      if ( v6 == 2 )
      {
        *(_DWORD *)v16 = 2;
        v9 = (char *)this + 9104;
        v10 = (char *)this + 9096;
      }
      else
      {
        *(_DWORD *)&v16[8] = 0;
        *(_QWORD *)v16 = v6;
        if ( v6 != 3 )
          return *(_QWORD *)&v16[4];
        v9 = (char *)this + 9200;
        v10 = (char *)this + 9136;
      }
    }
    else
    {
      *(_DWORD *)v16 = 0;
      v9 = (char *)this + 9136;
      v10 = (char *)this + 9104;
    }
    v11 = *(_QWORD *)v9;
    *(_QWORD *)&v16[4] = 0LL;
    if ( *(_QWORD *)v9 )
    {
      v12 = *(_QWORD *)v10;
      if ( v11 != *(_QWORD *)v10 )
      {
        v17 = (signed __int16)v17;
        v18 = (unsigned __int8)v18;
        *(_QWORD *)&v16[4] = 0LL;
        while ( *(_WORD *)(v11 + 40) != a2
             || *(_WORD *)(v11 + 42) != v17
             || v18 != 3 && *(_BYTE *)(v11 + 50) != v18
             || *(_BYTE *)(v11 + 51) != *(_DWORD *)v16 )
        {
          LODWORD(v13) = OSMetaClassBase::safeMetaCast(*(_QWORD *)(v11 + 32), AppleUHCIQueueHead::metaClass);
          if ( v13 )
          {
            v8 = (AppleUHCIQueueHead *)v11;
            v11 = v13;
            if ( v13 != v12 )
              continue;
          }
          return *(_QWORD *)&v16[4];
        }
        if ( v15 )
          *v15 = v8;
        *(_QWORD *)&v16[4] = v11;
      }
    }
  }
  return *(_QWORD *)&v16[4];
}
// EA80: using guessed type _QWORD AppleUHCIQueueHead::metaClass;
// 211C8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (00000000000030EC) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::AllocTDChain(AppleUSBUHCI *this, AppleUHCIQueueHead *a2, IOUSBCommand *a3, uintptr_t a4, unsigned int a5, unsigned __int16 a6, char a7)
{
  unsigned __int16 v7; // bx@1
  unsigned int v8; // er12@1
  AppleUHCIQueueHead *v9; // r13@1
  int v10; // er15@2
  signed int v11; // er14@10
  __int64 v12; // rdx@11
  unsigned int v13; // ebx@12
  signed int v14; // ecx@12
  int v15; // eax@14
  __int64 v16; // rdi@16
  __int64 v17; // r12@18
  __int64 v18; // rax@19
  AppleUSBUHCI *v19; // rdi@20
  AppleUHCITransferDescriptor *v20; // rsi@20
  __int64 v21; // rbx@22
  uintptr_t v22; // r12@26
  int v23; // ebx@28
  uintptr_t v24; // rbx@30
  uintptr_t v25; // r13@30
  int v26; // er12@30
  unsigned int v27; // er14@32
  uintptr_t v28; // r15@35
  int v29; // eax@36
  __int64 v30; // r12@45
  __int16 v31; // ax@49
  __int16 v32; // bx@49
  __int64 v33; // rbx@50
  void (__fastcall *v34)(_QWORD, _QWORD); // r14@52
  __int64 v35; // rax@52
  __int64 v36; // r12@53
  __int16 v37; // ax@53
  __int16 v38; // cx@53
  uintptr_t v39; // r15@53
  uintptr_t v40; // r14@53
  uintptr_t v41; // r12@59
  void (__fastcall *v42)(_QWORD, _QWORD); // rbx@59
  __int64 v43; // rax@59
  void (__fastcall *v44)(_QWORD, _QWORD); // rbx@59
  __int64 v45; // rax@59
  __int64 v46; // rcx@59
  uintptr_t v47; // rbx@59
  void (__fastcall *v48)(_QWORD, _QWORD); // r14@64
  __int64 v49; // rax@64
  __int64 i; // rbx@64
  int v51; // eax@68
  int v52; // eax@69
  __int64 v54; // [sp+18h] [bp-B8h]@19
  __int64 v55; // [sp+18h] [bp-B8h]@26
  int v56; // [sp+24h] [bp-ACh]@16
  __int64 v57; // [sp+28h] [bp-A8h]@25
  unsigned __int16 v58; // [sp+34h] [bp-9Ch]@11
  uintptr_t arg1; // [sp+38h] [bp-98h]@11
  uintptr_t arg2; // [sp+40h] [bp-90h]@26
  uintptr_t arg3; // [sp+50h] [bp-80h]@1
  unsigned __int64 v62; // [sp+58h] [bp-78h]@26
  IOUSBCommand *v63; // [sp+60h] [bp-70h]@1
  int v64; // [sp+68h] [bp-68h]@4
  int v65; // [sp+6Ch] [bp-64h]@30
  int v66; // [sp+6Ch] [bp-64h]@53
  uintptr_t arg4; // [sp+70h] [bp-60h]@8
  signed int v68; // [sp+7Ch] [bp-54h]@4
  __int64 v69; // [sp+80h] [bp-50h]@26
  int v70; // [sp+80h] [bp-50h]@59
  int v71; // [sp+8Ch] [bp-44h]@28
  uintptr_t v72; // [sp+90h] [bp-40h]@28
  unsigned __int64 v73; // [sp+98h] [bp-38h]@30
  __int64 v74; // [sp+A0h] [bp-30h]@28

  v7 = a6;
  v8 = a5;
  arg3 = a4;
  v63 = a3;
  v9 = a2;
  if ( a7 )
    v10 = (a6 != 2) << 19;
  else
    v10 = *(_DWORD *)(AppleUHCITransferDescriptor::GetSharedLogical(*((AppleUHCITransferDescriptor **)a2 + 8)) + 8) & 0x80000;
  v64 = v7;
  v68 = 105;
  if ( v7 != 1 )
  {
    if ( v7 )
      v68 = 45;
    else
      v68 = 225;
  }
  arg4 = *((_WORD *)a2 + 23);
  if ( v8 && !*((_WORD *)a2 + 23) )
  {
    KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBUHCI::AllocTDChain - buffserSize %d with maxPacket %d");
    v11 = -536870210;
    return (unsigned int)v11;
  }
  v58 = v7;
  arg1 = (uintptr_t)this;
  v12 = AppleUSBUHCI::AllocateTD(this, a2);
  if ( !v12 )
  {
    KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBUHCI::AllocTDChain - can't allocate 1st new TD");
    v11 = -536870211;
    return (unsigned int)v11;
  }
  v13 = v8;
  v14 = 411043839;
  if ( v64 == 1 )
    v14 = 947914751;
  v15 = v14 | 0x4000000;
  if ( *((_WORD *)a2 + 22) )
    v15 = v14;
  v56 = v15;
  v16 = 0LL;
  if ( arg3 && v8 )
  {
    v17 = *(_QWORD *)(*((_QWORD *)v63 + 27) + 48LL);
    if ( !v17 )
    {
      v21 = v12;
      KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBUHCI::AllocTDChain - no dmaCommand");
      v19 = (AppleUSBUHCI *)arg1;
      v20 = (AppleUHCITransferDescriptor *)v21;
      goto LABEL_23;
    }
    v54 = v12;
    LODWORD(v18) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v17 + 312LL))(v17);
    if ( v18 != arg3 )
    {
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v17 + 312LL))(v17);
      KernelDebugLogInternal(
        1LL,
        1431519814LL,
        "AppleUSBUHCI::AllocTDChain - mismatched CBP (%p) and dmaCommand memory descriptor (%p)");
      v19 = (AppleUSBUHCI *)arg1;
      v20 = (AppleUHCITransferDescriptor *)v54;
LABEL_23:
      AppleUSBUHCI::DeallocateTD(v19, v20);
      v11 = -536870199;
      return (unsigned int)v11;
    }
    v12 = v54;
    v16 = v17;
  }
  v57 = v16;
  if ( v13 )
  {
    v62 = v13;
    arg2 = v12;
    v55 = v12;
    v69 = 0LL;
    v22 = arg1;
    while ( 1 )
    {
      v74 = v69;
      v71 = 1;
      v23 = (*(int (__fastcall **)(__int64, __int64 *, uintptr_t *, int *))(*(_QWORD *)v16 + 344LL))(
              v16,
              &v74,
              &v72,
              &v71);
      if ( v23 || v71 != 1 )
        break;
      v65 = v10;
      v24 = v22;
      v25 = v72;
      v26 = v73;
      if ( v72 > 0xFFFFFFFF || v73 > 0xFFFFFFFF )
      {
        KernelDebugLogInternal(
          1LL,
          1431519814LL,
          "AppleUSBUHCI::AllocTDChain - generated segment not 32 bit -  offset (0x%qx) length (0x%qx) ");
        v11 = -536870199;
        return (unsigned int)v11;
      }
      v27 = v62 - v69;
      if ( v62 - v69 > arg4 )
        v27 = arg4;
      if ( (unsigned int)v73 >= v27 )
      {
        v30 = v69;
      }
      else
      {
        v28 = AppleUSBUHCI::GetCBIAlignmentBuffer((AppleUSBUHCI *)v24);
        if ( !v28 )
        {
          KernelDebugLogInternal(
            1LL,
            1431519814LL,
            "AppleUSBUHCI::AllocTDChain - could not get the alignment buffer I needed");
          v11 = -536870210;
          return (unsigned int)v11;
        }
        v29 = *(_DWORD *)off_D080[0];
        if ( *(_DWORD *)off_D080[0] & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
        {
          kernel_debug(0x52D3028u, v24, arg2, v28, 1uLL, 0LL);
          v29 = *(_DWORD *)off_D080[0];
        }
        if ( v29 & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
        {
          kernel_debug(0x52D3028u, v24, *(_QWORD *)(v28 + 16), arg3, 2uLL, 0LL);
          v29 = *(_DWORD *)off_D080[0];
        }
        if ( v29 & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
          kernel_debug(0x52D3028u, v24, v25, v26 & 0xFFFFFFFF, v27, 0LL);
        *(_QWORD *)(arg2 + 40) = v28;
        v25 = *(_QWORD *)(v28 + 16);
        v30 = v69;
        if ( v64 != 1 )
          (*(void (__fastcall **)(uintptr_t, __int64, _QWORD, _QWORD))(*(_QWORD *)arg3 + 480LL))(
            arg3,
            v69,
            *(_QWORD *)(v28 + 24),
            v27);
        *(_QWORD *)(v28 + 32) = arg3;
        *(_QWORD *)(v28 + 40) = v69;
        *(_QWORD *)(v28 + 48) = 0LL;
      }
      v69 = v27 + v30;
      *(_WORD *)(arg2 + 84) = v58;
      *(_DWORD *)(AppleUHCITransferDescriptor::GetSharedLogical((AppleUHCITransferDescriptor *)arg2) + 12) = v25;
      v9 = a2;
      v31 = *((_WORD *)a2 + 21);
      v32 = *((_WORD *)a2 + 20);
      *(_DWORD *)(AppleUHCITransferDescriptor::GetSharedLogical((AppleUHCITransferDescriptor *)arg2) + 8) = v68 | v65 | ((v27 << 21) - 0x200000) | ((v31 & 0xF) << 15) | ((v32 & 0x7F) << 8);
      v10 = (v65 == 0) << 19;
      *(_QWORD *)(arg2 + 48) = v63;
      if ( v69 >= v62 )
      {
        v66 = (v65 == 0) << 19;
        *(_BYTE *)(arg2 + 72) = 1;
        *(_QWORD *)(arg2 + 56) = arg3;
        *(_DWORD *)(AppleUHCITransferDescriptor::GetSharedLogical((AppleUHCITransferDescriptor *)arg2) + 4) = v56 & 0x1C8007FF | 0x1000000;
        *(_BYTE *)(arg2 + 73) = IOUSBCommand::GetMultiTransferTransaction(v63);
        *(_BYTE *)(arg2 + 74) = IOUSBCommand::GetFinalTransferInTransaction(v63);
        v39 = arg2;
        v40 = v55;
        goto LABEL_59;
      }
      *(_BYTE *)(arg2 + 72) = 0;
      v22 = arg1;
      v33 = AppleUSBUHCI::AllocateTD((AppleUSBUHCI *)arg1, a2);
      if ( v33 )
      {
        v34 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)arg2 + 280LL);
        LODWORD(v35) = (*(int (__fastcall **)(__int64, AppleUHCIQueueHead *))(*(_QWORD *)v33 + 296LL))(v33, a2);
        v34(arg2, v35);
        *(_QWORD *)(arg2 + 32) = v33;
        *(_DWORD *)(AppleUHCITransferDescriptor::GetSharedLogical((AppleUHCITransferDescriptor *)arg2) + 4) = v56;
        arg2 = v33;
      }
      else
      {
        KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBUHCI::AllocTDChain can't allocate new TD");
      }
      v16 = v57;
    }
    (*(void (**)(void))(*(_QWORD *)v57 + 312LL))();
    KernelDebugLogInternal(
      1LL,
      1431519814LL,
      "AppleUSBUHCI::AllocTDChain - could not generate segments err (0x%x) offset (%d) transferOffset (%d) bufferSize (%d) getMemoryDescriptor (%p)");
    v11 = -536870199;
    if ( v23 )
      v11 = v23;
  }
  else
  {
    *(_QWORD *)(v12 + 48) = v63;
    *(_BYTE *)(v12 + 72) = 1;
    v36 = v12;
    *(_BYTE *)(v12 + 73) = IOUSBCommand::GetMultiTransferTransaction(v63);
    *(_BYTE *)(v36 + 74) = IOUSBCommand::GetFinalTransferInTransaction(v63);
    *(_QWORD *)(v36 + 56) = arg3;
    v37 = *((_WORD *)a2 + 21);
    v38 = *((_WORD *)a2 + 20);
    *(_DWORD *)(AppleUHCITransferDescriptor::GetSharedLogical((AppleUHCITransferDescriptor *)v36) + 8) = ((v38 & 0x7F) << 8) | ((v37 & 0xF) << 15) | v10 | v68 | 0xFFE00000;
    *(_DWORD *)(AppleUHCITransferDescriptor::GetSharedLogical((AppleUHCITransferDescriptor *)v36) + 4) = v56 | 0x1000000;
    v66 = (v10 == 0) << 19;
    v39 = v36;
    v40 = v36;
LABEL_59:
    v41 = *((_QWORD *)v9 + 8);
    v42 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v39 + 280LL);
    LODWORD(v43) = (*(int (__fastcall **)(uintptr_t))(*(_QWORD *)v40 + 296LL))(v40);
    v42(v39, v43);
    *(_QWORD *)(v39 + 32) = v40;
    v70 = *(_DWORD *)(AppleUHCITransferDescriptor::GetSharedLogical((AppleUHCITransferDescriptor *)v40) + 4);
    *(_DWORD *)(AppleUHCITransferDescriptor::GetSharedLogical((AppleUHCITransferDescriptor *)v40) + 4) = 0;
    v44 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v41 + 280LL);
    LODWORD(v45) = (*(int (__fastcall **)(uintptr_t))(*(_QWORD *)v40 + 288LL))(v40);
    v44(v41, v45);
    LODWORD(v44) = *(_DWORD *)(AppleUHCITransferDescriptor::GetSharedLogical((AppleUHCITransferDescriptor *)v40) + 4);
    *(_DWORD *)(AppleUHCITransferDescriptor::GetSharedLogical((AppleUHCITransferDescriptor *)v41) + 4) = (_DWORD)v44;
    LODWORD(v44) = *(_DWORD *)(AppleUHCITransferDescriptor::GetSharedLogical((AppleUHCITransferDescriptor *)v40) + 8);
    *(_DWORD *)(AppleUHCITransferDescriptor::GetSharedLogical((AppleUHCITransferDescriptor *)v41) + 8) = (_DWORD)v44;
    LODWORD(v44) = *(_DWORD *)(AppleUHCITransferDescriptor::GetSharedLogical((AppleUHCITransferDescriptor *)v40) + 12);
    *(_DWORD *)(AppleUHCITransferDescriptor::GetSharedLogical((AppleUHCITransferDescriptor *)v41) + 12) = (_DWORD)v44;
    *(_QWORD *)(v41 + 48) = *(_QWORD *)(v40 + 48);
    *(_BYTE *)(v41 + 72) = *(_BYTE *)(v40 + 72);
    *(_BYTE *)(v41 + 73) = *(_BYTE *)(v40 + 73);
    *(_BYTE *)(v41 + 74) = *(_BYTE *)(v40 + 74);
    *(_QWORD *)(v41 + 32) = *(_QWORD *)(v40 + 32);
    *(_QWORD *)(v41 + 56) = *(_QWORD *)(v40 + 56);
    v46 = 0LL;
    v47 = v40;
    if ( *(_QWORD *)(v40 + 40) )
    {
      if ( *(_BYTE *)off_D080[0] & 2 )
      {
        v46 = *(_QWORD *)(v40 + 40);
        if ( *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
        {
          kernel_debug(0x52D3028u, arg1, v40, v41, 3uLL, 0LL);
          v46 = *(_QWORD *)(v40 + 40);
        }
      }
      else
      {
        v46 = *(_QWORD *)(v40 + 40);
      }
    }
    *(_QWORD *)(v41 + 40) = v46;
    v48 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v39 + 280LL);
    LODWORD(v49) = (*(int (__fastcall **)(uintptr_t))(*(_QWORD *)v47 + 296LL))(v47);
    v48(v39, v49);
    *(_QWORD *)(v39 + 32) = v47;
    (*(void (__fastcall **)(uintptr_t, signed __int64))(*(_QWORD *)v47 + 280LL))(v47, 1LL);
    *(_DWORD *)(AppleUHCITransferDescriptor::GetSharedLogical((AppleUHCITransferDescriptor *)v47) + 8) = v66;
    *(_DWORD *)(AppleUHCITransferDescriptor::GetSharedLogical((AppleUHCITransferDescriptor *)v47) + 12) = 0;
    *(_QWORD *)(v47 + 32) = 0LL;
    *(_QWORD *)(v47 + 40) = 0LL;
    *(_QWORD *)(v47 + 48) = 0LL;
    *((_QWORD *)v9 + 8) = v47;
    *(_DWORD *)(AppleUHCITransferDescriptor::GetSharedLogical((AppleUHCITransferDescriptor *)v41) + 4) = v70;
    for ( i = *((_QWORD *)v9 + 7); i; i = *(_QWORD *)(i + 32) )
      (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)i + 304LL))(i, 7LL);
    v11 = 0;
    if ( (unsigned __int8)(*((_BYTE *)v9 + 51) | 2) == 2 )
    {
      v51 = *(_DWORD *)(arg1 + 9292);
      if ( !v51 )
      {
        v52 = (*(int (**)(void))(**(_QWORD **)(arg1 + 9096) + 288LL))();
        (*(void (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(arg1 + 9096) + 280LL))(
          *(_QWORD *)(arg1 + 9096),
          v52 & 0xFFFFFFFE);
        v51 = *(_DWORD *)(arg1 + 9292);
      }
      *(_DWORD *)(arg1 + 9292) = v51 + 1;
    }
  }
  return (unsigned int)v11;
}
// D080: using guessed type __int64 off_D080[4];
// D090: using guessed type __int64 off_D090[2];
// 20DB0: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (0000000000003992) ----------------------------------------------------
int __fastcall AppleUSBUHCI::UIMCreateBulkEndpoint(AppleUSBUHCI *this, __int64 a2, __int64 a3, __int64 a4, __int64 a5, unsigned __int8 a6, unsigned __int16 a7, int a8)
{
  return (*(int (__fastcall **)(AppleUSBUHCI *, __int64, __int64, __int64, __int64, _QWORD))(*(_QWORD *)this + 2176LL))(
           this,
           a2,
           a3,
           a4,
           a5,
           a6);
}

//----- (00000000000039A8) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::UIMCreateBulkEndpoint(AppleUSBUHCI *this, unsigned __int8 a2, unsigned __int8 a3, unsigned __int8 a4, unsigned __int8 a5, unsigned __int8 a6)
{
  __int64 v6; // rax@2
  __int64 v7; // r12@2
  signed int v8; // er15@2
  __int64 v9; // rsi@3
  AppleUHCITransferDescriptor *v10; // rax@3
  int v11; // ebx@4
  __int64 v12; // rbx@4
  void (__fastcall *v13)(_QWORD, _QWORD); // r15@4
  __int64 v14; // rax@4
  void (__fastcall *v15)(_QWORD, _QWORD); // r15@4
  __int64 v16; // rax@4

  if ( a6 )
  {
    v6 = AppleUSBUHCI::AllocateQH((uintptr_t)this, a2, a3, a4, a5, a6, 2u);
    v7 = v6;
    v8 = -536870211;
    if ( v6 )
    {
      v9 = v6;
      v10 = (AppleUHCITransferDescriptor *)AppleUSBUHCI::AllocateTD(this, (AppleUHCIQueueHead *)v6);
      if ( v10 )
      {
        *(_DWORD *)(AppleUHCITransferDescriptor::GetSharedLogical(v10) + 4) = 0;
        *(_QWORD *)(v7 + 56) = v10;
        *(_QWORD *)(v7 + 64) = v10;
        v11 = (*(int (__fastcall **)(AppleUHCITransferDescriptor *, __int64))(*(_QWORD *)v10 + 296LL))(v10, v9);
        *(_DWORD *)(AppleUHCIQueueHead::GetSharedLogical((AppleUHCIQueueHead *)v7) + 4) = v11;
        v12 = *((_QWORD *)this + 1139);
        *(_QWORD *)(v7 + 32) = *(_QWORD *)(v12 + 32);
        v13 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v7 + 280LL);
        LODWORD(v14) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v12 + 288LL))(v12);
        v13(v7, v14);
        _mm_mfence();
        *(_QWORD *)(v12 + 32) = v7;
        v15 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v12 + 280LL);
        LODWORD(v16) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v7 + 296LL))(v7);
        v15(v12, v16);
        _mm_mfence();
        *((_QWORD *)this + 1139) = v7;
        v8 = 0;
      }
      else
      {
        AppleUSBUHCI::DeallocateQH(this, (AppleUHCIQueueHead *)v7);
      }
    }
  }
  else
  {
    v8 = -536870206;
    if ( *(_BYTE *)off_D080[0] & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D3008u, a2, a3, a4, 0xFFFFFFFFE00002C2LL, 0LL);
  }
  return (unsigned int)v8;
}
// D080: using guessed type __int64 off_D080[4];
// D090: using guessed type __int64 off_D090[2];

//----- (0000000000003B02) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::UIMCreateBulkTransfer(AppleUSBUHCI *this, IOUSBCommand *a2)
{
  __int16 v2; // r15@1
  unsigned __int8 v3; // bl@1
  char v4; // al@1
  __int64 v5; // r15@1
  __int64 result; // rax@1
  uintptr_t v7; // r13@3
  unsigned int v8; // ebx@3
  unsigned __int8 v9; // al@3

  v2 = IOUSBCommand::GetAddress(a2);
  v3 = IOUSBCommand::GetEndpoint(a2);
  v4 = IOUSBCommand::GetDirection(a2);
  v5 = AppleUSBUHCI::FindQueueHead(this, v2, v3, v4, 2u, 0LL);
  result = 3758112855LL;
  if ( v5 )
  {
    result = 3758112847LL;
    if ( !*(_BYTE *)(v5 + 53) )
    {
      v7 = IOUSBCommand::GetBuffer(a2);
      v8 = IOUSBCommand::GetReqCount(a2);
      v9 = IOUSBCommand::GetDirection(a2);
      result = AppleUSBUHCI::AllocTDChain(this, (AppleUHCIQueueHead *)v5, a2, v7, v8, v9, 0);
    }
  }
  return result;
}

//----- (0000000000003BB4) ----------------------------------------------------
int __usercall AppleUSBUHCI::UIMCreateInterruptEndpoint@<eax>(AppleUSBUHCI *this@<rdi>, __int16 a2, unsigned __int16 a3, int a4)
{
  return (*(int (**)(void))(*(_QWORD *)this + 2192LL))();
}

//----- (0000000000003BC6) ----------------------------------------------------
int __fastcall AppleUSBUHCI::UIMCreateInterruptEndpoint(AppleUSBUHCI *this, int a2, unsigned __int16 a3, char a4, __int16 a5, __int16 a6, __int16 a7)
{
  unsigned int v8; // er13@4
  int v9; // er15@4
  __int64 v10; // rax@4
  int v11; // er15@5
  int v12; // er13@5
  signed int v13; // eax@13
  int v14; // ecx@14
  unsigned __int8 v15; // r15@17
  __int64 v16; // rax@19
  __int64 v17; // r14@19
  __int64 v18; // rsi@20
  AppleUHCITransferDescriptor *v19; // rax@20
  AppleUHCITransferDescriptor *v20; // rbx@20
  __int64 v21; // rax@21
  int v22; // ebx@21
  __int64 v23; // rbx@21
  void (__fastcall *v24)(_QWORD, _QWORD); // r15@21
  __int64 v25; // rax@21
  void (__fastcall *v26)(_QWORD, _QWORD); // r15@21
  __int64 v27; // rax@21
  int v28; // [sp+8h] [bp-48h]@13
  __int16 v29; // [sp+10h] [bp-40h]@4
  __int16 v30; // [sp+14h] [bp-3Ch]@4
  unsigned __int16 v31; // [sp+1Ch] [bp-34h]@4
  uintptr_t arg3; // [sp+20h] [bp-30h]@4

  if ( a2 != *((_WORD *)this + 4648) )
  {
    v29 = a5;
    v30 = a6;
    v8 = (signed __int16)a3;
    v31 = a3;
    arg3 = (unsigned __int8)a4;
    v9 = 0;
    v10 = AppleUSBUHCI::FindQueueHead(this, a2, a3, a4, 3u, 0LL);
    if ( v10 )
    {
      v11 = *(_DWORD *)(AppleUHCITransferDescriptor::GetSharedLogical(*(AppleUHCITransferDescriptor **)(v10 + 56)) + 8);
      v12 = (*(int (__fastcall **)(AppleUSBUHCI *, _QWORD, _QWORD, uintptr_t))(*(_QWORD *)this + 2232LL))(
              this,
              (unsigned int)(signed __int16)a2,
              v8,
              arg3);
      if ( v12 )
      {
        if ( *(_BYTE *)off_D080[0] & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
          kernel_debug(0x52D300Cu, (signed __int16)a2, (signed __int16)v31, arg3, v12, 0LL);
        return v12;
      }
      v9 = v11 & 0x80000;
    }
    v28 = v9;
    v13 = 6;
    while ( 1 )
    {
      v14 = v13 - 1;
      if ( 1 << (v13 - 1) <= a7 )
        break;
      --v13;
      if ( v13 <= 0 )
      {
        v14 = v13 - 1;
        break;
      }
    }
    v15 = 0;
    if ( v14 >= 0 )
      v15 = v14;
    v16 = AppleUSBUHCI::AllocateQH((uintptr_t)this, (unsigned __int16)a2, v31, arg3, v29, v30, 3u);
    v17 = v16;
    v12 = -536870211;
    if ( v16 )
    {
      v18 = v16;
      v19 = (AppleUHCITransferDescriptor *)AppleUSBUHCI::AllocateTD(this, (AppleUHCIQueueHead *)v16);
      v20 = v19;
      if ( v19 )
      {
        *(_DWORD *)(AppleUHCITransferDescriptor::GetSharedLogical(v19) + 4) = 0;
        v21 = AppleUHCITransferDescriptor::GetSharedLogical(v19);
        *(_DWORD *)(v21 + 8) |= v28;
        *(_QWORD *)(v17 + 56) = v20;
        *(_QWORD *)(v17 + 64) = v20;
        v22 = (*(int (__fastcall **)(AppleUHCITransferDescriptor *, __int64))(*(_QWORD *)v20 + 296LL))(v20, v18);
        *(_DWORD *)(AppleUHCIQueueHead::GetSharedLogical((AppleUHCIQueueHead *)v17) + 4) = v22;
        *(_BYTE *)(v17 + 52) = v15;
        v23 = *((_QWORD *)this + v15 + 1145);
        *(_QWORD *)(v17 + 32) = *(_QWORD *)(v23 + 32);
        v24 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v17 + 280LL);
        LODWORD(v25) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v23 + 288LL))(v23);
        v24(v17, v25);
        _mm_mfence();
        *(_QWORD *)(v23 + 32) = v17;
        v26 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v23 + 280LL);
        LODWORD(v27) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v17 + 296LL))(v17);
        v26(v23, v27);
        v12 = 0;
      }
      else
      {
        AppleUSBUHCI::DeallocateQH(this, (AppleUHCIQueueHead *)v17);
      }
    }
    return v12;
  }
  if ( a3 < 2u )
    return (*(int (__fastcall **)(AppleUSBUHCI *, _QWORD))(*(_QWORD *)this + 3176LL))(this, (unsigned int)a7);
  v12 = -536870206;
  if ( *(_BYTE *)off_D080[0] & 2 )
  {
    if ( *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D300Cu, (signed __int16)a2, (signed __int16)a3, (unsigned __int8)a4, 0xFFFFFFFFE00002C2LL, 0LL);
  }
  return v12;
}
// D080: using guessed type __int64 off_D080[4];
// D090: using guessed type __int64 off_D090[2];

//----- (0000000000003E68) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::UIMCreateInterruptTransfer(AppleUSBUHCI *this, IOUSBCommand *a2)
{
  __int64 v2; // rbx@2
  __int64 v3; // rax@3
  int (__fastcall *v4)(_QWORD, _QWORD, _QWORD); // r12@6
  __int64 v5; // r15@6
  unsigned int v6; // ebx@6
  int v7; // eax@6
  __int16 v8; // r15@7
  unsigned __int8 v9; // bl@7
  char v10; // al@7
  __int64 v11; // rax@7
  AppleUHCIQueueHead *v12; // r12@7
  signed int v13; // er15@9
  unsigned __int16 v14; // r14@10
  unsigned __int8 v15; // bl@10
  unsigned __int8 v16; // al@10
  uintptr_t v17; // rcx@11
  uintptr_t v18; // rdx@11
  uintptr_t v19; // rsi@11
  uintptr_t v20; // r8@11
  unsigned int v21; // eax@12
  unsigned __int16 v22; // r14@14
  unsigned __int8 v23; // bl@14
  unsigned __int8 v24; // al@14
  uintptr_t v25; // r15@18
  unsigned int v26; // ebx@18
  unsigned __int8 v27; // al@18
  __int64 v29; // [sp+18h] [bp-58h]@12
  __int64 v30; // [sp+30h] [bp-40h]@6

  if ( (unsigned __int16)IOUSBCommand::GetAddress(a2) == *((_WORD *)this + 4648) )
  {
    v2 = *(_QWORD *)(*((_QWORD *)a2 + 27) + 48LL);
    if ( v2 )
    {
      LODWORD(v3) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v2 + 312LL))(v2);
      if ( v3 )
        (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v2 + 304LL))(v2, 1LL);
    }
    if ( (unsigned __int8)IOUSBCommand::GetEndpoint(a2) == 1 )
    {
      v4 = *(int (__fastcall **)(_QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 2992LL);
      v5 = IOUSBCommand::GetBuffer(a2);
      v6 = IOUSBCommand::GetReqCount(a2);
      IOUSBCommand::GetUSLCompletion((IOUSBCommand *)&v30);
      v7 = v4(this, v5, v6);
LABEL_19:
      v13 = v7;
      return (unsigned int)v13;
    }
    IOUSBCommand::GetUSLCompletion((IOUSBCommand *)&v29);
    v21 = IOUSBCommand::GetReqCount(a2);
    v13 = -536854441;
    IOUSBController::Complete(this, 3758112855LL, v21);
    return (unsigned int)v13;
  }
  v8 = IOUSBCommand::GetAddress(a2);
  v9 = IOUSBCommand::GetEndpoint(a2);
  v10 = IOUSBCommand::GetDirection(a2);
  v11 = AppleUSBUHCI::FindQueueHead(this, v8, v9, v10, 3u, 0LL);
  v12 = (AppleUHCIQueueHead *)v11;
  if ( !v11 )
  {
    v13 = -536854441;
    if ( !(*(_BYTE *)off_D080[0] & 2) )
      return (unsigned int)v13;
    v22 = IOUSBCommand::GetAddress(a2);
    v23 = IOUSBCommand::GetEndpoint(a2);
    v24 = IOUSBCommand::GetDirection(a2);
    if ( !(*(_DWORD *)off_D090[0] & 0xFFFFFFF7) )
      return (unsigned int)v13;
    v17 = v24;
    v18 = v23;
    v19 = v22;
    v20 = -536854441LL;
LABEL_16:
    kernel_debug(0x52D3034u, v19, v18, v17, v20, 0LL);
    return (unsigned int)v13;
  }
  if ( *(_BYTE *)(v11 + 53) )
  {
    v13 = -536854449;
    if ( !(*(_BYTE *)off_D080[0] & 2) )
      return (unsigned int)v13;
    v14 = IOUSBCommand::GetAddress(a2);
    v15 = IOUSBCommand::GetEndpoint(a2);
    v16 = IOUSBCommand::GetDirection(a2);
    if ( !(*(_DWORD *)off_D090[0] & 0xFFFFFFF7) )
      return (unsigned int)v13;
    v17 = v16;
    v18 = v15;
    v19 = v14;
    v20 = -536854449LL;
    goto LABEL_16;
  }
  v13 = -536870164;
  if ( *(_WORD *)(v11 + 46) )
  {
    v25 = IOUSBCommand::GetBuffer(a2);
    v26 = IOUSBCommand::GetReqCount(a2);
    v27 = IOUSBCommand::GetDirection(a2);
    v7 = AppleUSBUHCI::AllocTDChain(this, v12, a2, v25, v26, v27, 0);
    goto LABEL_19;
  }
  return (unsigned int)v13;
}
// D080: using guessed type __int64 off_D080[4];
// D090: using guessed type __int64 off_D090[2];
// 211C0: using guessed type int __fastcall IOUSBController::Complete(_QWORD, _QWORD, _QWORD);

//----- (00000000000040F6) ----------------------------------------------------
int __usercall AppleUSBUHCI::UIMCreateIsochEndpoint@<eax>(AppleUSBUHCI *this@<rdi>, int a2)
{
  return (*(int (**)(void))(*(_QWORD *)this + 2208LL))();
}

//----- (0000000000004108) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::UIMCreateIsochEndpoint(AppleUSBUHCI *this, __int64 a2, __int64 a3, unsigned int a4, unsigned int a5)
{
  unsigned __int16 v5; // r12@1
  unsigned int v6; // er15@1
  __int16 v7; // r13@1
  __int64 v8; // rax@1
  unsigned int v9; // ecx@2
  bool v10; // cf@2
  int v11; // ecx@2
  int v12; // ecx@4
  uintptr_t v13; // rdx@4
  signed int v14; // er14@5
  uintptr_t v15; // rsi@7
  uintptr_t v16; // r8@7
  __int64 v17; // rax@13

  v5 = a5;
  v6 = a4;
  v7 = a3;
  LODWORD(v8) = (*(int (__fastcall **)(AppleUSBUHCI *, __int64, __int64, _QWORD, _QWORD))(*(_QWORD *)this + 2776LL))(
                  this,
                  a2,
                  a3,
                  a5,
                  0LL);
  if ( v8 )
  {
    v9 = *(_DWORD *)(v8 + 80);
    v10 = v9 < v6;
    v11 = v9 - v6;
    if ( v11 )
    {
      if ( v10 )
      {
        v12 = v6 - *(_DWORD *)(v8 + 80);
        v13 = *((_DWORD *)this + 216);
        if ( (unsigned int)v13 < v12 )
        {
          v14 = -536870164;
          if ( *(_BYTE *)off_D080[0] & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
          {
            v15 = (unsigned int)v12;
            v16 = 1LL;
LABEL_12:
            kernel_debug(0x52D3010u, v15, v13, 0xFFFFFFFFE00002ECLL, v16, 0LL);
            return (unsigned int)v14;
          }
          return (unsigned int)v14;
        }
        *((_DWORD *)this + 216) = v13 - v12;
      }
      else
      {
        *((_DWORD *)this + 216) += v11;
      }
      *(_DWORD *)(v8 + 80) = v6;
    }
LABEL_18:
    v14 = 0;
    return (unsigned int)v14;
  }
  v13 = *((_DWORD *)this + 216);
  if ( (unsigned int)v13 >= v6 )
  {
    LODWORD(v17) = (*(int (__fastcall **)(AppleUSBUHCI *, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 2784LL))(
                     this,
                     (unsigned int)(signed __int16)a2,
                     (unsigned int)v7,
                     v5);
    v14 = -536870211;
    if ( !v17 )
      return (unsigned int)v14;
    *(_DWORD *)(v17 + 80) = v6;
    *(_WORD *)(v17 + 112) = 1025;
    *((_DWORD *)this + 216) -= v6;
    goto LABEL_18;
  }
  v14 = -536870164;
  if ( *(_BYTE *)off_D080[0] & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
  {
    v15 = v6;
    v16 = 2LL;
    goto LABEL_12;
  }
  return (unsigned int)v14;
}
// D080: using guessed type __int64 off_D080[4];
// D090: using guessed type __int64 off_D090[2];

//----- (000000000000424A) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::DeleteIsochEP(AppleUSBUHCI *this, uintptr_t arg2)
{
  uintptr_t v2; // rbx@1
  __int64 v3; // rax@4
  __int64 v4; // rdx@4
  __int64 v5; // rcx@4
  __int64 v6; // rsi@5

  v2 = arg2;
  if ( *(_DWORD *)(arg2 + 84) )
  {
    AppleUSBUHCI::AbortIsochEP(this, arg2);
    if ( *(_DWORD *)(arg2 + 84) )
      KernelDebugLogInternal(
        1LL,
        1431519814LL,
        "AppleUSBUHCI::DeleteIsochEP- after abort there are STILL %d active TDs");
  }
  v3 = *((_QWORD *)this + 54);
  v4 = *(_QWORD *)(v3 + 136);
  v5 = 0LL;
  if ( v4 )
  {
    while ( 1 )
    {
      v6 = v4;
      if ( v4 == v2 )
        break;
      v4 = *(_QWORD *)(v4 + 16);
      v5 = v6;
      if ( !v4 )
        goto LABEL_11;
    }
    v4 = *(_QWORD *)(v2 + 16);
    if ( v5 )
      *(_QWORD *)(v5 + 16) = v4;
    else
      *(_QWORD *)(v3 + 136) = v4;
  }
LABEL_11:
  *((_DWORD *)this + 216) += *(_DWORD *)(v2 + 80);
  (*(void (__fastcall **)(AppleUSBUHCI *, uintptr_t, __int64, __int64))(*(_QWORD *)this + 2768LL))(this, v2, v4, v5);
  return 0LL;
}
// 20DB0: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (00000000000042E8) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::AbortIsochEP(AppleUSBUHCI *this, uintptr_t arg2)
{
  uintptr_t v2; // r15@1
  __int64 v3; // rax@5
  uintptr_t v4; // rbx@7
  uint64_t v5; // r12@7
  int v6; // eax@9
  uintptr_t v7; // rdx@13
  __int64 v8; // rax@17
  __int64 v9; // rsi@18
  unsigned int v10; // eax@19
  uintptr_t v11; // rdi@21
  int v12; // ecx@22
  __int64 v13; // r12@22
  __int64 v14; // r14@26
  __int64 v15; // r13@27
  uintptr_t v16; // r14@27
  uintptr_t v17; // rbx@28
  uintptr_t v18; // rax@29
  uintptr_t v19; // r15@29
  __int64 v20; // rax@30
  void (__fastcall *v21)(_QWORD, _QWORD); // rbx@38
  __int64 v22; // rax@38
  __int64 v23; // r14@38
  __int64 v24; // rax@39
  __int64 v25; // rdi@39
  uintptr_t v26; // r14@54
  uintptr_t v27; // rbx@55
  __int64 v28; // rax@55
  uintptr_t i; // r14@55
  __int64 v30; // rbx@57
  uintptr_t v31; // rbx@58
  __int64 v32; // r14@69
  int v33; // eax@69
  uint64_t v35; // [sp+8h] [bp-78h]@21
  signed __int64 v36; // [sp+10h] [bp-70h]@21
  unsigned __int16 v37; // [sp+18h] [bp-68h]@37
  __int64 v38; // [sp+20h] [bp-60h]@26
  char v39; // [sp+28h] [bp-58h]@21
  uintptr_t arg2a; // [sp+30h] [bp-50h]@1
  int v41; // [sp+3Ch] [bp-44h]@25
  uintptr_t v42; // [sp+40h] [bp-40h]@28
  uintptr_t arg1; // [sp+48h] [bp-38h]@1
  __int64 v44; // [sp+50h] [bp-30h]@21

  arg2a = arg2;
  v2 = (uintptr_t)this;
  arg1 = (uintptr_t)this;
  if ( !*(_QWORD *)(arg2 + 56)
    && !*(_QWORD *)(arg2 + 24)
    && !*(_QWORD *)(arg2 + 40)
    && !__PAIR__(*(_DWORD *)(arg2 + 88), *(_DWORD *)(arg2 + 84)) )
    v3 = *(_DWORD *)(arg2 + 96);
  if ( !*(_BYTE *)(arg2 + 129) )
  {
    *((_BYTE *)this + 9385) = 1;
    *(_BYTE *)(arg2 + 129) = 1;
    v4 = arg2;
    v5 = mach_absolute_time();
    while ( *((_BYTE *)this + 9384) )
      ;
    v6 = AppleUSBUHCI::scavengeIsochTransactions(this);
    if ( v6 && *(_BYTE *)off_D080[0] & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D3030u, (uintptr_t)this, v6, 0LL, 1uLL, 0LL);
    v7 = arg2;
    if ( !*(_QWORD *)(arg2 + 56)
      && !*(_QWORD *)(arg2 + 24)
      && !*(_QWORD *)(arg2 + 40)
      && !__PAIR__(*(_DWORD *)(arg2 + 88), *(_DWORD *)(arg2 + 84)) )
      v8 = *(_DWORD *)(arg2 + 96);
    LODWORD(v9) = *((_WORD *)this + 4644);
    if ( (unsigned int)v9 <= 0x3FF )
    {
      v10 = *(_WORD *)(v4 + 112);
      if ( v10 <= 0x3FF && (unsigned __int16)v9 != (unsigned __int16)v10 )
      {
        v35 = v5;
        v44 = *(_QWORD *)off_D040[0];
        v36 = v4 + 96;
        v11 = 0LL;
        v39 = 0;
        while ( 1 )
        {
          v9 = (unsigned int)v9;
          v12 = ((_WORD)v9 + 1) & 0x3FF;
          v13 = *(_QWORD *)(v2 + 8LL * (unsigned int)v9 + 880);
          if ( !v13 && v12 != v10 )
            *(_WORD *)(v2 + 9288) = v12;
          v41 = ((_WORD)v9 + 1) & 0x3FF;
          if ( !v13 )
            goto LABEL_52;
          v38 = v9;
          v14 = 0LL;
          while ( 2 )
          {
            v15 = v14;
            v16 = v11;
LABEL_28:
            v42 = v16;
            v17 = arg2a;
            while ( 1 )
            {
              v14 = v13;
              v13 = *(_QWORD *)(v13 + 32);
              LODWORD(v18) = OSMetaClassBase::safeMetaCast(v14, v44);
              v19 = v18;
              if ( !v18 )
              {
LABEL_51:
                v2 = arg1;
                v7 = v17;
                v11 = v42;
                goto LABEL_52;
              }
              v20 = *(_QWORD *)(v18 + 40);
              v7 = v17;
              if ( v20 == v17 )
              {
                v37 = AppleUSBUHCI::ioRead16((AppleUSBUHCI *)arg1, 6) & 0x3FF;
                if ( v15 )
                {
                  *(_QWORD *)(v15 + 32) = *(_QWORD *)(v14 + 32);
                  v21 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v15 + 280LL);
                  LODWORD(v22) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v14 + 288LL))(v14, 6LL);
                  v21(v15, v22);
                  v23 = v38;
                  goto LABEL_43;
                }
                *(_QWORD *)(arg1 + 8 * v38 + 880) = v13;
                v24 = *(_QWORD *)v14;
                v25 = v14;
                v23 = v38;
                *(_DWORD *)(*(_QWORD *)(arg1 + 9072) + 4 * v38) = (*(int (__fastcall **)(__int64, signed __int64))(v24 + 288))(
                                                                    v25,
                                                                    6LL);
                if ( v13 )
                {
LABEL_42:
                  v15 = 0LL;
                }
                else
                {
                  v15 = 0LL;
                  if ( !(v39 & 1) )
                  {
                    *(_WORD *)(arg1 + 9288) = v41;
                    goto LABEL_42;
                  }
                }
LABEL_43:
                v38 = v23;
                if ( v37 == (_DWORD)v23 )
                {
                  v16 = v19;
                  if ( v42 )
                  {
                    (*(void (__fastcall **)(uintptr_t, uint64_t))(*(_QWORD *)v42 + 312LL))(v42, v35);
                    v16 = v19;
                  }
                }
                else
                {
                  (*(void (__fastcall **)(uintptr_t, uint64_t))(*(_QWORD *)v19 + 312LL))(v19, v35);
                  v16 = v42;
                }
                OSDecrementAtomic(v36);
                (*(void (__fastcall **)(uintptr_t, uintptr_t, uintptr_t, signed __int64))(*(_QWORD *)arg1 + 2824LL))(
                  arg1,
                  arg2a,
                  v19,
                  1LL);
                if ( !v13 )
                {
                  v11 = v16;
                  v7 = arg2a;
                  v2 = arg1;
                  goto LABEL_52;
                }
                goto LABEL_28;
              }
              if ( v20 )
                break;
              if ( *(_BYTE *)off_D080[0] & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
              {
                kernel_debug(0x52D3030u, arg1, v17, v19, 2uLL, 0LL);
                v7 = v17;
              }
              v17 = v7;
              v15 = v14;
              if ( !v13 )
                goto LABEL_51;
            }
            v39 = 1;
            v2 = arg1;
            v11 = v42;
            if ( v13 )
              continue;
            break;
          }
LABEL_52:
          v10 = *(_WORD *)(v7 + 112);
          LODWORD(v9) = ((_WORD)v9 + 1) & 0x3FF;
          if ( v41 == v10 )
          {
            v5 = v35;
            if ( v11 )
            {
              v26 = v7;
              IODelay(1000LL);
              (*(void (__fastcall **)(uintptr_t, uint64_t))(*(_QWORD *)v11 + 312LL))(v11, v35);
              v7 = v26;
            }
            break;
          }
        }
      }
    }
    v27 = v7;
    LODWORD(v28) = (*(int (__fastcall **)(uintptr_t, uintptr_t))(*(_QWORD *)v2 + 2800LL))(v2, v7);
    for ( i = v27; ; LODWORD(v28) = (*(int (__fastcall **)(uintptr_t, uintptr_t))(*(_QWORD *)v2 + 2800LL))(v2, i) )
    {
      v30 = v28;
      if ( !v28 )
        break;
      (*(void (__fastcall **)(__int64, uint64_t))(*(_QWORD *)v28 + 312LL))(v28, v5);
      (*(void (__fastcall **)(uintptr_t, uintptr_t, __int64, signed __int64))(*(_QWORD *)v2 + 2824LL))(v2, i, v30, 1LL);
    }
    v31 = i;
    if ( !*(_DWORD *)(i + 96) )
    {
      *(_QWORD *)(i + 72) = 0LL;
      *(_WORD *)(i + 112) = 1025;
    }
    *(_BYTE *)(v2 + 9385) = 0;
    *(_DWORD *)(i + 120) = -536870165;
    (*(void (__fastcall **)(uintptr_t, uintptr_t))(*(_QWORD *)v2 + 2840LL))(v2, i);
    *(_DWORD *)(i + 120) = 0;
    if ( *(_QWORD *)(i + 56)
      || *(_QWORD *)(i + 24)
      || *(_QWORD *)(i + 40)
      || *(_DWORD *)(i + 84)
      || *(_DWORD *)(i + 88)
      || *(_DWORD *)(i + 96)
      || *(_DWORD *)(i + 100)
      || *(_DWORD *)(i + 108)
      || *(_DWORD *)(i + 92) )
    {
      v32 = off_D080[0];
      v33 = *(_DWORD *)off_D080[0];
      if ( *(_DWORD *)off_D080[0] & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
      {
        kernel_debug(0x52D3030u, v2, v31, *(_WORD *)(v2 + 9288), 3uLL, 0LL);
        v33 = *(_DWORD *)v32;
      }
      if ( v33 & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
      {
        kernel_debug(0x52D3030u, *(_WORD *)(v31 + 112), *(_DWORD *)(v31 + 84), *(_DWORD *)(v31 + 88), 4uLL, 0LL);
        v33 = *(_DWORD *)v32;
      }
      if ( v33 & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
      {
        kernel_debug(0x52D3030u, *(_QWORD *)(v31 + 24), *(_DWORD *)(v31 + 100), *(_QWORD *)(v31 + 56), 5uLL, 0LL);
        v33 = *(_DWORD *)v32;
      }
      if ( v33 & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D3030u, *(_DWORD *)(v31 + 96), *(_DWORD *)(v31 + 104), *(_DWORD *)(v2 + 9380), 6uLL, 0LL);
      if ( *(_BYTE *)v32 & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
        kernel_debug(
          0x52D3030u,
          *(_DWORD *)(v2 + 9376),
          *(_DWORD *)(v31 + 108),
          *(_DWORD *)(v31 + 92),
          *(_QWORD *)(v31 + 40),
          0LL);
    }
    *(_BYTE *)(v31 + 129) = 0;
  }
  return 0LL;
}
// D040: using guessed type _QWORD off_D040[12];
// D080: using guessed type __int64 off_D080[4];
// D090: using guessed type __int64 off_D090[2];
// 20D40: using guessed type int __fastcall IODelay(_QWORD);
// 20DC0: using guessed type int __fastcall OSDecrementAtomic(_QWORD);
// 211C8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (000000000000484C) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::CreateIsochTransfer(AppleUSBUHCI *this, IOUSBControllerIsochEndpoint *a2, __int64 a3)
{
  __int64 v3; // rbx@1
  IOUSBControllerIsochEndpoint *v4; // r12@1
  AppleUSBUHCI *v5; // r14@1
  unsigned __int64 v6; // rax@1
  unsigned __int64 v7; // rdx@2
  signed int v8; // er13@2
  __int64 v9; // r10@3
  char v10; // r8@3
  unsigned int v11; // er9@3
  __int64 v12; // rdi@3
  unsigned int v13; // er11@3
  __int64 v14; // rsi@3
  uintptr_t v16; // rsi@14
  signed __int64 v17; // rax@14
  uintptr_t v18; // rdx@16
  uintptr_t v19; // rcx@16
  signed int v20; // ecx@17
  char v21; // r15@22
  signed __int64 v22; // rcx@23
  signed __int64 v23; // rbx@24
  __int64 v24; // r13@24
  signed __int64 v25; // rax@24
  uintptr_t v26; // r12@26
  int v27; // eax@27
  int v28; // ebx@27
  uintptr_t v29; // rax@31
  __int64 v30; // rax@36
  __int64 v31; // rbx@36
  __int64 v32; // rax@39
  __int64 v33; // rax@41
  __int64 v34; // ST98_8@41
  __int64 v35; // ST90_8@41
  int v36; // er14@41
  bool v37; // zf@44
  __int16 v38; // ax@47
  int v39; // eax@47
  __int16 v40; // bx@47
  uintptr_t v41; // r8@51
  __int64 v42; // rcx@62
  __int64 v43; // r8@62
  unsigned int v44; // [sp+1Ch] [bp-D4h]@13
  int v45; // [sp+20h] [bp-D0h]@23
  __int64 v46; // [sp+28h] [bp-C8h]@13
  unsigned __int64 v47; // [sp+30h] [bp-C0h]@13
  char v48; // [sp+3Fh] [bp-B1h]@22
  __int64 v49; // [sp+48h] [bp-A8h]@37
  AppleUSBUHCI *v50; // [sp+48h] [bp-A8h]@40
  signed __int64 v51; // [sp+50h] [bp-A0h]@27
  unsigned int v52; // [sp+58h] [bp-98h]@3
  signed int v53; // [sp+64h] [bp-8Ch]@3
  __int64 v54; // [sp+68h] [bp-88h]@24
  __int64 v55; // [sp+70h] [bp-80h]@3
  __int64 v56; // [sp+78h] [bp-78h]@23
  uintptr_t v57; // [sp+80h] [bp-70h]@24
  __int64 v58; // [sp+88h] [bp-68h]@23
  int v59; // [sp+ACh] [bp-44h]@27
  unsigned __int64 v60; // [sp+B0h] [bp-40h]@27
  unsigned __int64 v61; // [sp+B8h] [bp-38h]@30
  __int64 v62; // [sp+C0h] [bp-30h]@27

  v3 = a3;
  v4 = a2;
  v5 = this;
  LODWORD(v6) = (*(int (**)(void))(*(_QWORD *)this + 2456LL))();
  if ( !a2 )
  {
    KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBUHCI::CreateIsochTransfer - no endpoint");
    goto LABEL_10;
  }
  v7 = *(_QWORD *)(v3 + 72);
  v8 = -536870162;
  if ( v7 < *((_QWORD *)a2 + 9) )
    return (unsigned int)v8;
  v9 = *(_QWORD *)(v3 + 104);
  v10 = *(_BYTE *)(v9 + 56);
  v11 = *(_DWORD *)v9;
  v12 = *(_QWORD *)(v3 + 88);
  v13 = *(_DWORD *)(v3 + 80);
  v52 = *(_DWORD *)(v3 + 80);
  v14 = *(_QWORD *)(v3 + 40);
  v55 = *(_QWORD *)(v9 + 24);
  *((_QWORD *)v4 + 9) = v7;
  v53 = 105;
  if ( *((_BYTE *)v4 + 128) != 1 )
  {
    if ( *((_BYTE *)v4 + 128) )
      goto LABEL_10;
    v53 = 225;
  }
  if ( v7 <= v6 )
  {
    if ( v7 < v6 - 1024 )
      return (unsigned int)v8;
  }
  else
  {
    v8 = -536870161;
    if ( v7 > v6 + 1024 )
      return (unsigned int)v8;
  }
  v46 = v14;
  v44 = v11;
  v47 = v7;
  if ( !v13 )
  {
LABEL_63:
    AppleUSBUHCI::AddIsochFramesToSchedule((uintptr_t)v5, v4);
    v8 = 0;
    return (unsigned int)v8;
  }
  v16 = 1LL;
  v17 = 4LL;
  do
  {
    if ( !v10 )
    {
      v18 = *(_WORD *)(v12 + 8 * v16 - 4);
      v19 = *((_DWORD *)v4 + 20);
      if ( (unsigned int)v18 <= (unsigned int)v19 )
        goto LABEL_21;
      if ( *(_BYTE *)off_D080[0] & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
      {
        v41 = 1LL;
        goto LABEL_55;
      }
LABEL_10:
      v8 = -536870206;
      return (unsigned int)v8;
    }
    v18 = *(_WORD *)(v12 + v17);
    v19 = *((_DWORD *)v4 + 20);
    if ( (unsigned int)v18 > (unsigned int)v19 )
    {
      if ( *(_BYTE *)off_D080[0] & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
      {
        v41 = 2LL;
LABEL_55:
        kernel_debug(0x52D3014u, v16, v18, v19, v41, 0LL);
        goto LABEL_10;
      }
      goto LABEL_10;
    }
    v20 = 1819044212;
    if ( *(_BYTE *)(v9 + 17) )
      v20 = 1953066092;
    *(_DWORD *)(v12 + v17 - 4) = v20;
LABEL_21:
    ++v16;
    v17 += 16LL;
  }
  while ( (signed int)v16 - 1 < v13 );
  v21 = v10;
  v48 = v10;
  if ( !v13 )
    goto LABEL_63;
  v22 = v12 + 4;
  v45 = v13 - 1;
  v58 = 0LL;
  v56 = 0LL;
  while ( 1 )
  {
    v57 = (uintptr_t)v4;
    v54 = v3;
    v23 = v22;
    v24 = AppleUSBUHCI::AllocateITD(v5, v16);
    v25 = v23;
    if ( v21 )
      v25 = v12 + 16 * v58 + 4;
    v26 = *(_WORD *)v25;
    if ( !v24 )
      break;
    v51 = v23;
    ++*(_QWORD *)(v57 + 72);
    *(_BYTE *)(v24 + 80) = v21;
    v62 = v56;
    v59 = 1;
    v27 = (*(int (__fastcall **)(__int64, __int64 *, __int64 *, int *))(*(_QWORD *)v55 + 344LL))(v55, &v62, &v60, &v59);
    v28 = v60;
    if ( v27 || v59 != 1 || v60 > 0xFFFFFFFF || v61 > 0xFFFFFFFF )
    {
      KernelDebugLogInternal(
        1LL,
        1431519814LL,
        "AppleUSBUHCI::CreateIsochTransfer - could not generate segments err (0x%x) numSegments (%d) fIOVMAddr (0x%qx) fLength (0x%qx)");
      v29 = 0LL;
      v28 = 0;
    }
    else
    {
      v29 = (unsigned int)v61 & 0xFFFFFFFF;
    }
    if ( v29 > v26 )
      v29 = v26;
    if ( v29 < v26 )
    {
      v30 = AppleUSBUHCI::GetIsochAlignmentBuffer(v5);
      v31 = v30;
      if ( !v30 )
      {
        if ( *(_BYTE *)off_D080[0] & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
          kernel_debug(0x52D3014u, (uintptr_t)v5, *(_WORD *)(v54 + 36), *(_BYTE *)(v54 + 38), 4uLL, 0LL);
        v42 = *(_WORD *)(v54 + 36);
        v43 = *(_BYTE *)(v54 + 38);
        KernelDebugLogInternal(
          1LL,
          1431519814LL,
          "The USB UHCI driver could not get the resources it needed.  Transfers will be affected (%d:%d)");
        v4 = (IOUSBControllerIsochEndpoint *)v57;
        goto LABEL_63;
      }
      *(_QWORD *)(v24 + 112) = v30;
      v49 = *(_QWORD *)(v30 + 16);
      if ( !*(_BYTE *)(v57 + 128) )
        (*(void (__fastcall **)(__int64, __int64, _QWORD, uintptr_t))(*(_QWORD *)v46 + 480LL))(
          v46,
          v56,
          *(_QWORD *)(v30 + 24),
          v26);
      *(_QWORD *)(v31 + 32) = v46;
      *(_QWORD *)(v31 + 40) = v56;
      LODWORD(v32) = OSMetaClassBase::safeMetaCast(v55, AppleUSBUHCIDMACommand::metaClass);
      *(_QWORD *)(v31 + 64) = v32;
      *(_QWORD *)(v31 + 48) = 0LL;
      v28 = v49;
    }
    v50 = v5;
    v56 += v26;
    *(_QWORD *)(v24 + 48) = v12;
    *(_QWORD *)(v24 + 88) = v47 + v58;
    *(_DWORD *)(v24 + 96) = v58;
    if ( v45 == (_DWORD)v58 )
    {
      v33 = *(_QWORD *)(v54 + 104);
      v34 = *(_QWORD *)(v33 + 40);
      v35 = *(_QWORD *)(v33 + 32);
      *(_QWORD *)(v24 + 72) = *(_QWORD *)(v33 + 48);
      *(_QWORD *)(v24 + 64) = v34;
      *(_QWORD *)(v24 + 56) = v35;
      v36 = 0x1000000;
    }
    else
    {
      v36 = 0;
      if ( v48 )
      {
        if ( v44 )
          v37 = ((signed int)v58 + 1) % v44 == 0;
        else
          v37 = (((_BYTE)v58 + 1) & 7) == 0;
        v36 = v37 << 24;
      }
    }
    *(_DWORD *)(AppleUHCIIsochTransferDescriptor::GetSharedLogical((AppleUHCIIsochTransferDescriptor *)v24) + 12) = v28;
    (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v24 + 280LL))(v24, 1LL);
    v21 = v48;
    *(_BYTE *)(v24 + 80) = v48;
    v38 = *(_WORD *)(v57 + 116);
    v39 = (v53 + ((_DWORD)v26 << 21) - 0x200000) | ((v38 & 0xF) << 15);
    v4 = (IOUSBControllerIsochEndpoint *)v57;
    v40 = *(_WORD *)(v57 + 114);
    *(_DWORD *)(AppleUHCIIsochTransferDescriptor::GetSharedLogical((AppleUHCIIsochTransferDescriptor *)v24) + 8) = v39 | ((v40 & 0x7F) << 8);
    *(_DWORD *)(AppleUHCIIsochTransferDescriptor::GetSharedLogical((AppleUHCIIsochTransferDescriptor *)v24) + 4) = v36 | 0x28007FF;
    *(_QWORD *)(v24 + 40) = v57;
    v3 = v54;
    *(_BYTE *)(v24 + 81) = *(_BYTE *)(*(_QWORD *)(v54 + 104) + 17LL);
    v5 = v50;
    v16 = v57;
    (*(void (__fastcall **)(AppleUSBUHCI *, uintptr_t, __int64))(*(_QWORD *)v50 + 2792LL))(v50, v57, v24);
    ++v58;
    v22 = v51 + 8;
    if ( (unsigned int)v58 >= v52 )
      goto LABEL_63;
  }
  v8 = -536870211;
  if ( *(_BYTE *)off_D080[0] & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D3014u, (uintptr_t)v5, 0LL, v26, 3uLL, 0LL);
  return (unsigned int)v8;
}
// D080: using guessed type __int64 off_D080[4];
// D090: using guessed type __int64 off_D090[2];
// E0F8: using guessed type _QWORD AppleUSBUHCIDMACommand::metaClass;
// 20DB0: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);
// 211C8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000004E22) ----------------------------------------------------
void __fastcall AppleUSBUHCI::AddIsochFramesToSchedule(uintptr_t arg1, IOUSBControllerIsochEndpoint *a2)
{
  IOUSBControllerIsochEndpoint *v2; // r14@1
  uintptr_t v3; // rax@7
  uintptr_t v4; // rbx@7
  uintptr_t v5; // r15@9
  unsigned __int64 v6; // r13@10
  __int64 v7; // rax@11
  __int64 v8; // rbx@11
  uintptr_t v9; // rax@15
  unsigned __int16 v10; // bx@19
  int v11; // eax@20
  __int64 v12; // rax@22
  __int64 v13; // r15@22
  __int64 v14; // rax@25
  __int64 v15; // rax@27
  __int64 v16; // rbx@27
  uintptr_t v17; // [sp+8h] [bp-48h]@7
  char *v18; // [sp+10h] [bp-40h]@7
  uint64_t v19; // [sp+18h] [bp-38h]@7
  signed __int64 v20; // [sp+20h] [bp-30h]@9
  __int16 v21; // [sp+20h] [bp-30h]@19

  v2 = a2;
  if ( *((_QWORD *)a2 + 3) )
  {
    if ( *((_BYTE *)a2 + 129) )
    {
      if ( *(_BYTE *)off_D080[0] & 2 )
      {
        if ( *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
          kernel_debug(0x52D302Cu, arg1, *((_WORD *)a2 + 57), *((_WORD *)a2 + 58), 1uLL, 0LL);
      }
    }
    else if ( IOSimpleLockTryLock(*(_QWORD *)(arg1 + 9272)) )
    {
      LODWORD(v3) = (*(int (__fastcall **)(uintptr_t))(*(_QWORD *)arg1 + 2456LL))(arg1);
      v4 = v3;
      v17 = v3;
      v19 = mach_absolute_time();
      v18 = (char *)a2 + 96;
LABEL_9:
      v5 = v4;
      v20 = v4 + 1;
      while ( 1 )
      {
        v6 = *(_QWORD *)(*((_QWORD *)v2 + 3) + 88LL);
        if ( v6 > v20 )
          break;
        LODWORD(v7) = (*(int (__fastcall **)(uintptr_t, IOUSBControllerIsochEndpoint *))(*(_QWORD *)arg1 + 2800LL))(
                        arg1,
                        v2);
        v8 = v7;
        (*(void (__fastcall **)(__int64, uint64_t))(*(_QWORD *)v7 + 312LL))(v7, v19);
        if ( *((_DWORD *)v2 + 24) <= 0 )
        {
          a2 = v2;
          (*(void (__fastcall **)(uintptr_t, IOUSBControllerIsochEndpoint *, __int64, signed __int64))(*(_QWORD *)arg1 + 2824LL))(
            arg1,
            v2,
            v8,
            1LL);
        }
        else
        {
          a2 = v2;
          (*(void (__fastcall **)(uintptr_t, IOUSBControllerIsochEndpoint *, __int64))(*(_QWORD *)arg1 + 2808LL))(
            arg1,
            v2,
            v8);
        }
        if ( !*((_QWORD *)v2 + 3) )
        {
          IOSimpleLockUnlock(*(_QWORD *)(arg1 + 9272));
          (*(void (__fastcall **)(uintptr_t))(*(_QWORD *)arg1 + 32LL))(arg1);
          if ( thread_call_enter1(*(_QWORD *)(*(_QWORD *)(arg1 + 432) + 152LL), v2) )
            (*(void (__fastcall **)(uintptr_t))(*(_QWORD *)arg1 + 40LL))(arg1);
          return;
        }
        LODWORD(v9) = (*(int (__fastcall **)(uintptr_t))(*(_QWORD *)arg1 + 2456LL))(arg1);
        v4 = v9;
        if ( v9 > v5 )
        {
          if ( *(_BYTE *)off_D080[0] & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
          {
            a2 = (IOUSBControllerIsochEndpoint *)arg1;
            kernel_debug(0x52D302Cu, arg1, v5, v9, 2uLL, 0LL);
          }
          goto LABEL_9;
        }
      }
      v21 = v20 & 0x3FF;
      v10 = v6 & 0x3FF;
      *((_WORD *)v2 + 56) = v6 & 0x3FF;
      do
      {
        v11 = *(_WORD *)(arg1 + 9288);
        if ( v10 == v11 )
          break;
        v10 = (v10 + 1) & 0x3FF;
        if ( v10 == (unsigned __int16)v11 )
          break;
        a2 = v2;
        LODWORD(v12) = (*(int (__fastcall **)(uintptr_t, IOUSBControllerIsochEndpoint *))(*(_QWORD *)arg1 + 2800LL))(
                         arg1,
                         v2);
        v13 = v12;
        if ( v6 == *(_QWORD *)(v12 + 88) )
        {
          if ( (unsigned int)*(_WORD *)(arg1 + 9288) >= 0x401 )
            *(_WORD *)(arg1 + 9288) = v21;
          a2 = (IOUSBControllerIsochEndpoint *)*(_DWORD *)(*(_QWORD *)(arg1 + 9072) + 4LL * *((_WORD *)v2 + 56));
          (*(void (__fastcall **)(__int64, IOUSBControllerIsochEndpoint *))(*(_QWORD *)v12 + 280LL))(v12, a2);
          v14 = *((_WORD *)v2 + 56);
          *(_QWORD *)(v13 + 32) = *(_QWORD *)(arg1 + 8 * v14 + 880);
          *(_QWORD *)(arg1 + 8 * v14 + 880) = v13;
          *(_DWORD *)(*(_QWORD *)(arg1 + 9072) + 4LL * *((_WORD *)v2 + 56)) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v13 + 296LL))(v13);
          OSIncrementAtomic(v18);
        }
        ++v6;
        *((_WORD *)v2 + 56) = v10;
      }
      while ( *((_QWORD *)v2 + 3) );
      LODWORD(v15) = (*(int (__fastcall **)(uintptr_t, IOUSBControllerIsochEndpoint *))(*(_QWORD *)arg1 + 2456LL))(
                       arg1,
                       a2);
      v16 = v15;
      IOSimpleLockUnlock(*(_QWORD *)(arg1 + 9272));
      if ( v16 - v17 >= 2 )
        KernelDebugLogInternal(
          1LL,
          1431519814LL,
          "AppleUSBUHCI::AddIsochFramesToSchedule - end -  startFrame(0x%qd) finFrame(0x%qd)");
    }
    else
    {
      KernelDebugLogInternal(
        1LL,
        1431519814LL,
        "AppleUSBUHCI::AddIsochFramesToSchedule - could not obtain scheduling lock");
    }
  }
}
// D080: using guessed type __int64 off_D080[4];
// D090: using guessed type __int64 off_D090[2];
// 20D98: using guessed type int __fastcall IOSimpleLockTryLock(_QWORD);
// 20DA0: using guessed type int __fastcall IOSimpleLockUnlock(_QWORD);
// 20DB0: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);
// 20DC8: using guessed type int __fastcall OSIncrementAtomic(_QWORD);
// 21C98: using guessed type int __fastcall thread_call_enter1(_QWORD, _QWORD);

//----- (0000000000005172) ----------------------------------------------------
signed __int64 AppleUSBUHCI::UIMCreateIsochTransfer()
{
  KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBUHCI::UIMCreateIsochTransfer(LL) - old method");
  return 3758097087LL;
}
// 20DB0: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (0000000000005196) ----------------------------------------------------
signed __int64 AppleUSBUHCI::UIMCreateIsochTransfer()
{
  KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBUHCI::UIMCreateIsochTransfer(LL) - old method");
  return 3758097087LL;
}
// 20DB0: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (00000000000051BA) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::UIMCreateIsochTransfer(uintptr_t arg1, __int64 a2)
{
  signed int v2; // er15@1
  IOUSBControllerIsochEndpoint *v3; // rax@2

  (*(void (__cdecl **)(uintptr_t))(*(_QWORD *)arg1 + 2456LL))(arg1);
  v2 = -536870206;
  if ( (unsigned int)(*(_DWORD *)(a2 + 80) - 1) <= 0x3E7 )
  {
    LODWORD(v3) = (*(int (__fastcall **)(uintptr_t, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)arg1 + 2776LL))(
                    arg1,
                    *(_WORD *)(a2 + 36),
                    *(_BYTE *)(a2 + 38),
                    *(_BYTE *)(a2 + 39),
                    0LL);
    if ( v3 )
      return AppleUSBUHCI::CreateIsochTransfer((AppleUSBUHCI *)arg1, v3, a2);
    v2 = -536854441;
    if ( *(_BYTE *)off_D080[0] & 2 )
    {
      if ( *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D3014u, arg1, *(_WORD *)(a2 + 36), *(_BYTE *)(a2 + 38), 5uLL, 0LL);
    }
  }
  return (unsigned int)v2;
}
// D080: using guessed type __int64 off_D080[4];
// D090: using guessed type __int64 off_D090[2];

//----- (000000000000526A) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::HandleEndpointAbort(AppleUSBUHCI *this, int a2, unsigned __int16 a3, __int16 a4, char a5)
{
  __int16 v5; // r13@1
  unsigned __int16 v6; // r14@1
  signed int v7; // er15@3
  __int64 v8; // rsi@4
  __int16 v9; // r12@4
  uintptr_t v10; // rax@4
  __int64 v11; // rax@9
  AppleUHCITransferDescriptor *v12; // r15@13
  AppleUHCITransferDescriptor *v13; // r13@13
  __int64 v14; // rbx@13
  int v15; // er12@14
  __int64 v16; // rax@14
  AppleUHCIQueueHead *v17; // r14@14
  int v18; // er13@15
  AppleUHCIQueueHead *v19; // rbx@15
  void (__fastcall *v20)(_QWORD, _QWORD); // r15@15
  __int64 v21; // rax@15
  __int64 v22; // rbx@16
  AppleUHCITransferDescriptor *v23; // rdi@16
  int v24; // eax@18
  int v25; // et1@21
  int v26; // er14@23
  char v28; // [sp+4h] [bp-3Ch]@4
  AppleUSBUHCI *v29; // [sp+8h] [bp-38h]@12
  AppleUHCIQueueHead *v30; // [sp+10h] [bp-30h]@9

  v5 = a4;
  v6 = a3;
  if ( a2 == *((_WORD *)this + 4648) )
  {
    if ( a3 >= 2u )
    {
      v7 = -536870206;
      if ( *(_BYTE *)off_D080[0] & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D3038u, (uintptr_t)this, (signed __int16)a3, a4, 0xFFFFFFFFE00002C2LL, 0LL);
    }
    else
    {
      v7 = AppleUSBUHCI::RHAbortEndpoint(this, a3, a4);
    }
  }
  else
  {
    v28 = a5;
    v8 = (unsigned int)(signed __int16)a2;
    v9 = a3;
    v7 = 0;
    LODWORD(v10) = (*(int (__fastcall **)(AppleUSBUHCI *, __int64, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 2776LL))(
                     this,
                     v8,
                     (unsigned int)(signed __int16)a3,
                     (unsigned int)a4,
                     0LL);
    if ( v10 )
    {
      AppleUSBUHCI::AbortIsochEP(this, v10);
    }
    else
    {
      v8 = (unsigned int)v8;
      v11 = AppleUSBUHCI::FindQueueHead(this, v8, v9, v5, 0, &v30);
      if ( v11
        || (v8 = (unsigned int)v8, (v11 = AppleUSBUHCI::FindQueueHead(this, v8, v9, v5, 3u, &v30)) != 0)
        || (v8 = (unsigned int)v8, (v11 = AppleUSBUHCI::FindQueueHead(this, v8, v9, v5, 2u, &v30)) != 0) )
      {
        v29 = this;
        v7 = -536854456;
        if ( !*(_BYTE *)(v11 + 54) )
        {
          *(_BYTE *)(v11 + 54) = 1;
          v12 = *(AppleUHCITransferDescriptor **)(v11 + 56);
          v13 = *(AppleUHCITransferDescriptor **)(v11 + 64);
          v14 = v11;
          if ( v12 == v13 )
          {
            v25 = *(_DWORD *)(AppleUHCITransferDescriptor::GetSharedLogical(*(AppleUHCITransferDescriptor **)(v11 + 56))
                            + 8);
            if ( v28 )
              *(_DWORD *)(AppleUHCITransferDescriptor::GetSharedLogical(*(AppleUHCITransferDescriptor **)(v14 + 56)) + 8) = 0;
            v26 = (*(int (__fastcall **)(_QWORD, __int64))(**(_QWORD **)(v14 + 56) + 296LL))(*(_QWORD *)(v14 + 56), v8);
            *(_DWORD *)(AppleUHCIQueueHead::GetSharedLogical((AppleUHCIQueueHead *)v14) + 4) = v26;
            _mm_mfence();
            v12 = 0LL;
            v13 = 0LL;
          }
          else
          {
            v15 = 0;
            v16 = 0LL;
            v17 = (AppleUHCIQueueHead *)v14;
            if ( v30 )
            {
              v18 = (*(int (__fastcall **)(AppleUHCIQueueHead *, __int64))(*(_QWORD *)v30 + 288LL))(v30, v8);
              v19 = v30;
              v20 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v30 + 280LL);
              LODWORD(v21) = (*(int (__fastcall **)(AppleUHCIQueueHead *))(*(_QWORD *)v17 + 288LL))(v17);
              v8 = v21;
              v20(v19, v21);
              IOSleep(1LL);
              v16 = (unsigned int)v18;
              v12 = (AppleUHCITransferDescriptor *)*((_QWORD *)v17 + 7);
              v13 = (AppleUHCITransferDescriptor *)*((_QWORD *)v17 + 8);
            }
            v22 = v16;
            *((_QWORD *)v17 + 7) = v13;
            v23 = v13;
            if ( !v28 )
            {
              v15 = *(_DWORD *)(AppleUHCITransferDescriptor::GetSharedLogical(v12) + 8) & 0x80000;
              v23 = (AppleUHCITransferDescriptor *)*((_QWORD *)v17 + 7);
            }
            *(_DWORD *)(AppleUHCITransferDescriptor::GetSharedLogical(v23) + 8) = v15;
            v24 = (*(int (__fastcall **)(_QWORD, __int64))(**((_QWORD **)v17 + 7) + 296LL))(*((_QWORD *)v17 + 7), v8);
            *(_DWORD *)(AppleUHCIQueueHead::GetSharedLogical(v17) + 4) = v24;
            _mm_mfence();
            if ( v30 )
              (*(void (__fastcall **)(AppleUHCIQueueHead *, __int64))(*(_QWORD *)v30 + 280LL))(v30, v22);
            this = v29;
            v14 = (__int64)v17;
          }
          *(_BYTE *)(v14 + 53) = 0;
          AppleUSBUHCI::UHCIUIMDoDoneQueueProcessing(this, v12, 0xE0004050, v13);
          *(_BYTE *)(v14 + 54) = 0;
          v7 = 0;
        }
      }
      else
      {
        v7 = -536854441;
        if ( *(_BYTE *)off_D080[0] & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
          kernel_debug(0x52D3038u, (uintptr_t)this, (signed __int16)v6, v5, 0xFFFFFFFFE0004057LL, 0LL);
      }
    }
  }
  return (unsigned int)v7;
}
// D080: using guessed type __int64 off_D080[4];
// D090: using guessed type __int64 off_D090[2];
// 20DA8: using guessed type int __fastcall IOSleep(_QWORD);

//----- (000000000000554C) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::UIMAbortEndpoint(AppleUSBUHCI *this, int a2, unsigned __int16 a3, __int16 a4)
{
  return AppleUSBUHCI::HandleEndpointAbort(this, a2, a3, a4, 0);
}

//----- (000000000000555A) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::UIMClearEndpointStall(AppleUSBUHCI *this, int a2, unsigned __int16 a3, __int16 a4)
{
  return AppleUSBUHCI::HandleEndpointAbort(this, a2, a3, a4, 1);
}

//----- (000000000000556A) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::UIMDeleteEndpoint(AppleUSBUHCI *this, int a2, uintptr_t a3, uintptr_t a4)
{
  __int16 v4; // r15@1
  __int16 v5; // r14@1
  signed int v6; // er12@3
  __int64 v7; // rsi@4
  __int16 v8; // r13@4
  uintptr_t v9; // rax@4
  uintptr_t v10; // r8@8
  __int64 v11; // r12@10
  int v12; // eax@13
  AppleUHCITransferDescriptor *v13; // rsi@17
  AppleUHCITransferDescriptor *v14; // rcx@17
  uintptr_t arg3; // [sp+10h] [bp-30h]@1

  v4 = a4;
  v5 = a3;
  arg3 = 0LL;
  if ( a2 == *((_WORD *)this + 4648) )
  {
    if ( (unsigned __int16)a3 < 2u )
    {
      v6 = AppleUSBUHCI::RHDeleteEndpoint(this, a3, a4);
      return (unsigned int)v6;
    }
    v6 = -536870206;
    if ( *(_BYTE *)off_D080[0] & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
    {
      a4 = (signed __int16)a4;
      a3 = (signed __int16)a3;
      v10 = -536870206LL;
LABEL_9:
      kernel_debug(0x52D3018u, (uintptr_t)this, a3, a4, v10, 0LL);
      return (unsigned int)v6;
    }
  }
  else
  {
    v7 = (unsigned int)(signed __int16)a2;
    v8 = a3;
    v6 = 0;
    LODWORD(v9) = (*(int (__fastcall **)(AppleUSBUHCI *, __int64, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 2776LL))(
                    this,
                    v7,
                    (unsigned int)(signed __int16)a3,
                    (unsigned int)(signed __int16)a4,
                    0LL);
    if ( v9 )
    {
      AppleUSBUHCI::DeleteIsochEP(this, v9);
      return (unsigned int)v6;
    }
    v11 = AppleUSBUHCI::FindQueueHead(this, v7, v8, v4, 0, (AppleUHCIQueueHead **)&arg3);
    if ( v11
      || (v11 = AppleUSBUHCI::FindQueueHead(this, v7, v8, v4, 3u, (AppleUHCIQueueHead **)&arg3)) != 0
      || (v11 = AppleUSBUHCI::FindQueueHead(this, v7, v8, v4, 2u, (AppleUHCIQueueHead **)&arg3)) != 0 )
    {
      v12 = AppleUSBUHCI::UnlinkQueueHead((uintptr_t)this, v11, arg3);
      if ( v12 && *(_BYTE *)off_D080[0] & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D3018u, (uintptr_t)this, v12, 0LL, 0LL, 0LL);
      v13 = *(AppleUHCITransferDescriptor **)(v11 + 56);
      v14 = *(AppleUHCITransferDescriptor **)(v11 + 64);
      if ( v13 != v14 )
      {
        AppleUSBUHCI::UHCIUIMDoDoneQueueProcessing(this, v13, 0xE0004050, v14);
        v13 = *(AppleUHCITransferDescriptor **)(v11 + 64);
        *(_QWORD *)(v11 + 56) = v13;
      }
      if ( v13 )
      {
        AppleUSBUHCI::DeallocateTD(this, v13);
        *(_QWORD *)(v11 + 56) = 0LL;
      }
      AppleUSBUHCI::DeallocateQH(this, (AppleUHCIQueueHead *)v11);
      v6 = 0;
    }
    else
    {
      v6 = -536854441;
      if ( *(_BYTE *)off_D080[0] & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
      {
        a4 = v4;
        a3 = v5;
        v10 = -536854441LL;
        goto LABEL_9;
      }
    }
  }
  return (unsigned int)v6;
}
// D080: using guessed type __int64 off_D080[4];
// D090: using guessed type __int64 off_D090[2];

//----- (0000000000005788) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::UnlinkQueueHead(uintptr_t arg1, uintptr_t arg2, uintptr_t arg3)
{
  uintptr_t v3; // r14@1
  signed int v4; // er15@7
  void (__fastcall *v5)(_QWORD, _QWORD); // r15@12
  __int64 v6; // rax@12

  v3 = arg3;
  if ( arg2 && arg3 )
  {
    if ( *(_QWORD *)(arg1 + 9144) == arg2 )
    {
      *(_QWORD *)(arg1 + 9144) = arg3;
    }
    else if ( *(_QWORD *)(arg1 + 9128) == arg2 )
    {
      *(_QWORD *)(arg1 + 9128) = arg3;
    }
    else if ( *(_QWORD *)(arg1 + 9112) == arg2 )
    {
      *(_QWORD *)(arg1 + 9112) = arg3;
    }
    v5 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)arg3 + 280LL);
    LODWORD(v6) = (*(int (__fastcall **)(uintptr_t))(*(_QWORD *)arg2 + 288LL))(arg2);
    v5(v3, v6);
    *(_QWORD *)(v3 + 32) = *(_QWORD *)(arg2 + 32);
    IOSleep(1LL);
    v4 = 0;
  }
  else
  {
    v4 = -536870206;
    if ( *(_BYTE *)off_D080[0] & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D301Cu, arg1, arg2, arg3, 0xFFFFFFFFE00002C2LL, 0LL);
  }
  return (unsigned int)v4;
}
// D080: using guessed type __int64 off_D080[4];
// D090: using guessed type __int64 off_D090[2];
// 20DA8: using guessed type int __fastcall IOSleep(_QWORD);

//----- (000000000000585C) ----------------------------------------------------
void __fastcall AppleUSBUHCI::UIMCheckForTimeouts(AppleUSBUHCI *this)
{
  AppleUSBUHCI *v1; // r14@1
  uint64_t v2; // r15@4
  __int16 v3; // bx@4
  signed __int64 v4; // rsi@4
  __int64 v5; // rax@6
  uintptr_t v6; // rax@6
  signed __int64 v7; // rcx@7
  uintptr_t v8; // r13@7
  AppleUHCIQueueHead *v9; // r12@8
  signed __int64 v10; // rbx@8
  __int64 v11; // rax@12
  uintptr_t v12; // r15@12
  __int64 v13; // rax@19
  IOUSBCommand *v14; // rdi@20
  int v15; // eax@20
  unsigned int v16; // edx@20
  int v17; // eax@21
  int v18; // eax@25
  __int64 v19; // rcx@27
  __int64 v20; // r8@27
  __int64 v21; // r9@27
  __int64 v22; // rax@27
  uintptr_t v23; // rdi@27
  __int64 v24; // rcx@30
  __int64 v25; // r8@30
  __int64 v26; // r9@30
  unsigned int v27; // [sp+0h] [bp-40h]@21
  unsigned int v28; // [sp+0h] [bp-40h]@25
  unsigned int v29; // [sp+4h] [bp-3Ch]@20
  __int64 v30; // [sp+8h] [bp-38h]@14
  unsigned int v31; // [sp+8h] [bp-38h]@20

  v1 = this;
  if ( !(unsigned __int8)IOService::isInactive(this) && *((_BYTE *)this + 440) == 2 && !*((_BYTE *)this + 441) )
  {
    AppleUSBUHCI::ProcessCompletedTransactions(this);
    v2 = mach_absolute_time();
    v3 = AppleUSBUHCI::ioRead16(this, 2);
    AppleUSBUHCI::ioRead16(this, 0);
    v4 = 4LL;
    AppleUSBUHCI::ioRead16(this, 4);
    if ( v3 & 0x20 )
    {
      AppleUSBUHCI::ioWrite16(this, 2, 0x20u);
      KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBUHCI::UIMCheckForTimeouts - Host controller halted, resetting");
      AppleUSBUHCI::Reset(this, 1);
      v4 = 1LL;
      AppleUSBUHCI::Run(this, 1);
    }
    LODWORD(v5) = (*(int (__fastcall **)(AppleUSBUHCI *, signed __int64))(*(_QWORD *)this + 2456LL))(this, v4);
    *((_QWORD *)this + 105) = v5;
    *((_QWORD *)this + 104) = v2;
    v6 = *((_QWORD *)this + 1142);
    if ( v6 )
    {
      v7 = 0LL;
      v8 = 0LL;
      while ( 1 )
      {
        v9 = (AppleUHCIQueueHead *)v8;
        v8 = v6;
        v10 = v7;
        if ( (signed int)v7 > 99 )
        {
LABEL_35:
          if ( (signed int)v10 >= 99 && *(_BYTE *)off_D080[0] & 2 )
          {
            if ( *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
              kernel_debug(0x52D3020u, (uintptr_t)v1, v10 + 1, 0LL, 2uLL, 0LL);
          }
          return;
        }
        if ( v6 == *(_QWORD *)(v6 + 32) )
          KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBUHCI::UIMCheckForTimeouts  pQH (%p) linked to itself");
        if ( *(_BYTE *)(v8 + 51) != 221 )
        {
          (*(void (__fastcall **)(uintptr_t, signed __int64))(*(_QWORD *)v8 + 304LL))(v8, 7LL);
          v11 = *(_DWORD *)(AppleUHCIQueueHead::GetSharedLogical((AppleUHCIQueueHead *)v8) + 4);
          v12 = *(_QWORD *)(v8 + 56);
          if ( v12 )
          {
            if ( *(_QWORD *)(v12 + 48) )
            {
              v30 = v11;
              if ( v12 == *(_QWORD *)(v8 + 64) )
              {
                if ( *(_BYTE *)off_D080[0] & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
                  kernel_debug(0x52D3020u, (uintptr_t)v1, v8, v12, 1uLL, 0LL);
                (*(void (__fastcall **)(uintptr_t, signed __int64))(*(_QWORD *)v8 + 304LL))(v8, 1LL);
              }
              LODWORD(v13) = (*(int (__fastcall **)(uintptr_t))(*(_QWORD *)v12 + 296LL))(v12);
              if ( v30 == v13 )
              {
                v29 = IOUSBCommand::GetNoDataTimeout(*(IOUSBCommand **)(v12 + 48));
                v31 = IOUSBCommand::GetCompletionTimeout(*(IOUSBCommand **)(v12 + 48));
                v14 = v1;
                v15 = (*(int (__fastcall **)(AppleUSBUHCI *))(*(_QWORD *)v1 + 2464LL))(v1);
                v16 = v15;
                if ( v31 )
                {
                  v27 = v15;
                  v14 = *(IOUSBCommand **)(v12 + 48);
                  v17 = IOUSBCommand::GetUIMScratch(v14, 0);
                  if ( !v17 )
                  {
                    IOUSBCommand::SetUIMScratch(*(IOUSBCommand **)(v12 + 48), 0, v27);
                    goto LABEL_34;
                  }
                  v16 = v27;
                  if ( v27 - v17 >= v31 )
                  {
                    v24 = *(_DWORD *)(*((_QWORD *)v1 + 21) + 28LL);
                    v25 = *(_WORD *)(v8 + 40);
                    v26 = *(_WORD *)(v8 + 42);
                    KernelDebugLogInternal(
                      1LL,
                      1431519814LL,
                      "AppleUSBUHCI::Found a transaction past the completion deadline on bus 0x%x, timing out! (Addr: %d, EP: %d)");
                    v22 = *(_QWORD *)v8;
                    v23 = v8;
                    goto LABEL_31;
                  }
                }
                if ( v29 )
                {
                  if ( *(_DWORD *)(v12 + 76) - 1 >= v16 )
                  {
                    *(_DWORD *)(v12 + 76) = v16;
                    v18 = AppleUSBUHCI::findBufferRemaining(v14, (AppleUHCIQueueHead *)v8);
LABEL_33:
                    *(_DWORD *)(v12 + 80) = v18;
                    goto LABEL_34;
                  }
                  v28 = v16;
                  v18 = AppleUSBUHCI::findBufferRemaining(v14, (AppleUHCIQueueHead *)v8);
                  if ( *(_DWORD *)(v12 + 80) != v18 )
                    goto LABEL_33;
                  if ( v28 - *(_DWORD *)(v12 + 76) >= v29 )
                  {
                    v19 = *(_DWORD *)(*((_QWORD *)v1 + 21) + 28LL);
                    v20 = *(_WORD *)(v8 + 40);
                    v21 = *(_WORD *)(v8 + 42);
                    KernelDebugLogInternal(
                      1LL,
                      1431519814LL,
                      "AppleUSBUHCI::Found a transaction which hasn't moved in 5 seconds on bus 0x%x, timing out! (Addr: %d, EP: %d)");
                    (*(void (__fastcall **)(uintptr_t, signed __int64))(*(_QWORD *)v8 + 304LL))(v8, 2LL);
                    v22 = *(_QWORD *)v12;
                    v23 = v12;
LABEL_31:
                    (*(void (__fastcall **)(uintptr_t, signed __int64))(v22 + 304))(v23, 2LL);
                    AppleUSBUHCI::ReturnOneTransaction(
                      v1,
                      (AppleUHCITransferDescriptor *)v12,
                      (AppleUHCIQueueHead *)v8,
                      v9,
                      -536854447);
                    goto LABEL_34;
                  }
                }
              }
              else
              {
                (*(void (__fastcall **)(uintptr_t, signed __int64))(*(_QWORD *)v8 + 304LL))(v8, 7LL);
                (*(void (__fastcall **)(uintptr_t, signed __int64))(*(_QWORD *)v12 + 304LL))(v12, 7LL);
              }
            }
          }
        }
LABEL_34:
        LODWORD(v6) = OSMetaClassBase::safeMetaCast(*(_QWORD *)(v8 + 32), AppleUHCIQueueHead::metaClass);
        v7 = v10 + 1;
        if ( !v6 )
          goto LABEL_35;
      }
    }
  }
}
// D080: using guessed type __int64 off_D080[4];
// D090: using guessed type __int64 off_D090[2];
// EA80: using guessed type _QWORD AppleUHCIQueueHead::metaClass;
// 20DB0: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);
// 211C8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000005C26) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::ReturnOneTransaction(AppleUSBUHCI *this, AppleUHCITransferDescriptor *a2, AppleUHCIQueueHead *a3, AppleUHCIQueueHead *a4, int a5)
{
  AppleUHCIQueueHead *v5; // rbx@1
  AppleUHCIQueueHead *v6; // r12@1
  void (__fastcall *v7)(_QWORD, _QWORD); // r14@1
  __int64 v8; // rax@1
  AppleUHCITransferDescriptor *v9; // r14@1
  uintptr_t v10; // rax@1
  AppleUHCITransferDescriptor *v11; // rax@9
  int v12; // er15@9
  void (__fastcall *v13)(_QWORD, _QWORD); // r15@9
  __int64 v14; // rax@9
  AppleUSBUHCI *v15; // rbx@11
  int v17; // [sp+Ch] [bp-34h]@1

  v17 = a5;
  v5 = a4;
  v6 = a3;
  v7 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)a4 + 280LL);
  LODWORD(v8) = (*(int (__fastcall **)(AppleUHCIQueueHead *))(*(_QWORD *)a3 + 288LL))(a3);
  v7(v5, v8);
  IOSleep(1LL);
  v9 = 0LL;
  v10 = (uintptr_t)a2;
  if ( a2 )
  {
    v10 = (uintptr_t)a2;
    while ( !*(_BYTE *)(v10 + 72) || *(_BYTE *)(v10 + 73) && !*(_BYTE *)(v10 + 74) )
    {
      LODWORD(v10) = OSMetaClassBase::safeMetaCast(*(_QWORD *)(v10 + 32), AppleUHCITransferDescriptor::metaClass);
      v9 = (AppleUHCITransferDescriptor *)v10;
      if ( !v10 )
        goto LABEL_10;
    }
    v9 = 0LL;
    if ( v10 )
    {
      LODWORD(v11) = OSMetaClassBase::safeMetaCast(*(_QWORD *)(v10 + 32), AppleUHCITransferDescriptor::metaClass);
      v9 = v11;
      v12 = (*(int (__fastcall **)(AppleUHCITransferDescriptor *, _QWORD))(*(_QWORD *)v11 + 296LL))(
              v11,
              AppleUHCITransferDescriptor::metaClass);
      *(_DWORD *)(AppleUHCIQueueHead::GetSharedLogical(v6) + 4) = v12;
      _mm_mfence();
      *((_QWORD *)v6 + 7) = v9;
      v13 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v5 + 280LL);
      LODWORD(v14) = (*(int (__fastcall **)(AppleUHCIQueueHead *))(*(_QWORD *)v6 + 296LL))(v6);
      v13(v5, v14);
LABEL_13:
      v15 = this;
      return AppleUSBUHCI::UHCIUIMDoDoneQueueProcessing(v15, a2, v17, v9);
    }
  }
LABEL_10:
  if ( !(*(_BYTE *)off_D080[0] & 2) )
    goto LABEL_13;
  v15 = this;
  if ( *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D3024u, (uintptr_t)this, v10, 0LL, 0LL, 0LL);
  return AppleUSBUHCI::UHCIUIMDoDoneQueueProcessing(v15, a2, v17, v9);
}
// D080: using guessed type __int64 off_D080[4];
// D090: using guessed type __int64 off_D090[2];
// ECC8: using guessed type _QWORD AppleUHCITransferDescriptor::metaClass;
// 20DA8: using guessed type int __fastcall IOSleep(_QWORD);
// 211C8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000005D6E) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::findBufferRemaining(AppleUSBUHCI *this, AppleUHCIQueueHead *a2)
{
  __int64 v2; // r13@1
  unsigned int v3; // er15@1
  int v4; // ebx@4
  __int64 v5; // rax@5

  v2 = *((_QWORD *)a2 + 7);
  v3 = 0;
  if ( v2 )
  {
    v3 = 0;
    do
    {
      if ( v2 == *((_QWORD *)a2 + 8) )
        break;
      v4 = *(_DWORD *)(AppleUHCITransferDescriptor::GetSharedLogical((AppleUHCITransferDescriptor *)v2) + 4);
      v3 += (((unsigned __int16)(*(_DWORD *)(AppleUHCITransferDescriptor::GetSharedLogical((AppleUHCITransferDescriptor *)v2)
                                           + 8) >> 21)
            + 1) & 0x7FF)
          - (((_WORD)v4 + 1) & 0x7FF);
      if ( *(_BYTE *)(v2 + 72) )
        break;
      LODWORD(v5) = OSMetaClassBase::safeMetaCast(*(_QWORD *)(v2 + 32), AppleUHCITransferDescriptor::metaClass);
      v2 = v5;
    }
    while ( v5 );
  }
  return v3;
}
// ECC8: using guessed type _QWORD AppleUHCITransferDescriptor::metaClass;
// 211C8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000005DF8) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::TDToUSBError(AppleUSBUHCI *this, int a2)
{
  __int64 result; // rax@1

  result = 0LL;
  if ( a2 & 0x760000 )
  {
    result = 3758097133LL;
    if ( !(a2 & 0x40000) )
    {
      result = 3758097128LL;
      if ( !(a2 & 0x100000) )
      {
        result = 3758112847LL;
        if ( !(a2 & 0x400000) )
        {
          result = 3758112769LL;
          if ( (a2 & 0x200000u) >> 21 )
            result = 3758097128LL;
          if ( !(a2 & 0x240000) )
          {
            result = 3758112770LL;
            if ( !(a2 & 0x20000) )
              result = 3758112848LL;
          }
        }
      }
    }
  }
  return result;
}

//----- (0000000000005E62) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::UIMEnableAddressEndpoints(AppleUSBUHCI *this, unsigned __int16 a2, char a3)
{
  AppleUSBUHCI *v3; // r15@1
  __int64 v4; // rax@2
  __int64 v5; // r13@3
  __int64 v6; // rbx@4
  __int64 v7; // rdi@6
  __int64 v8; // rax@8
  int v9; // eax@9
  AppleUSBUHCI *v10; // r14@11
  __int64 v11; // r15@11
  void (__fastcall *v12)(_QWORD, _QWORD); // r12@11
  __int64 v13; // rax@11
  void (__fastcall *v14)(_QWORD, _QWORD); // r12@11
  __int64 v15; // rax@11
  __int64 v16; // rdi@11
  AppleUSBUHCI *v17; // r14@12
  __int64 v18; // r15@12
  void (__fastcall *v19)(_QWORD, _QWORD); // r12@12
  __int64 v20; // rax@12
  void (__fastcall *v21)(_QWORD, _QWORD); // r12@12
  __int64 v22; // rax@12
  __int64 v23; // rdi@12
  char *v24; // rax@14
  __int64 v25; // r15@16
  void (__fastcall *v26)(_QWORD, _QWORD); // r12@16
  __int64 v27; // rax@16
  void (__fastcall *v28)(_QWORD, _QWORD); // r12@16
  __int64 v29; // rax@16
  __int64 v30; // rax@20
  signed __int64 v31; // rax@26
  __int64 v32; // rbx@27
  __int64 i; // r12@27
  AppleUHCIIsochTransferDescriptor *v34; // rax@28
  AppleUHCIIsochTransferDescriptor *v35; // r15@28
  uintptr_t v36; // rax@28
  uintptr_t v37; // r14@28
  uintptr_t v38; // rax@31
  int v39; // eax@35
  char *v41; // [sp+0h] [bp-50h]@3
  char *v42; // [sp+8h] [bp-48h]@3
  signed __int64 v43; // [sp+8h] [bp-48h]@27
  uintptr_t arg1; // [sp+10h] [bp-40h]@1

  v3 = this;
  arg1 = (uintptr_t)this;
  if ( a3 )
  {
    v4 = *((_QWORD *)this + 1144);
    if ( v4 )
    {
      v42 = (char *)this + 9144;
      v41 = (char *)this + 9128;
      v5 = 0LL;
      do
      {
        v6 = v4;
        while ( 1 )
        {
          if ( *(_WORD *)(v6 + 40) != a2 )
          {
            LODWORD(v4) = OSMetaClassBase::safeMetaCast(*(_QWORD *)(v6 + 32), AppleUHCIQueueHead::metaClass);
            goto LABEL_24;
          }
          v7 = *(_QWORD *)(v6 + 32);
          if ( v5 )
          {
            *(_QWORD *)(v5 + 32) = v7;
          }
          else
          {
            LODWORD(v8) = OSMetaClassBase::safeMetaCast(v7, AppleUHCIQueueHead::metaClass);
            *((_QWORD *)v3 + 1144) = v8;
          }
          *(_QWORD *)(v6 + 32) = 0LL;
          v9 = *(_BYTE *)(v6 + 51);
          if ( v9 == 3 )
          {
            v17 = v3;
            v18 = *((_QWORD *)v3 + *(_BYTE *)(v6 + 52) + 1145);
            *(_QWORD *)(v6 + 32) = *(_QWORD *)(v18 + 32);
            v19 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v6 + 280LL);
            LODWORD(v20) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v18 + 288LL))(v18);
            v19(v6, v20);
            _mm_mfence();
            *(_QWORD *)(v18 + 32) = v6;
            v21 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v18 + 280LL);
            LODWORD(v22) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v6 + 296LL))(v6);
            v23 = v18;
            v3 = v17;
            v21(v23, v22);
          }
          else if ( v9 == 2 )
          {
            v10 = v3;
            v11 = *((_QWORD *)v3 + 1139);
            *(_QWORD *)(v6 + 32) = *(_QWORD *)(v11 + 32);
            v12 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v6 + 280LL);
            LODWORD(v13) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v11 + 288LL))(v11);
            v12(v6, v13);
            _mm_mfence();
            *(_QWORD *)(v11 + 32) = v6;
            v14 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v11 + 280LL);
            LODWORD(v15) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v6 + 296LL))(v6);
            v16 = v11;
            v3 = v10;
            v14(v16, v15);
            _mm_mfence();
            *((_QWORD *)v10 + 1139) = v6;
          }
          else if ( !*(_BYTE *)(v6 + 51) )
          {
            v24 = v41;
            if ( !*(_WORD *)(v6 + 44) )
              v24 = v42;
            v25 = *(_QWORD *)v24;
            *(_QWORD *)(v6 + 32) = *(_QWORD *)(*(_QWORD *)v24 + 32LL);
            v26 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v6 + 280LL);
            LODWORD(v27) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v25 + 288LL))(v25);
            v26(v6, v27);
            _mm_mfence();
            *(_QWORD *)(v25 + 32) = v6;
            v28 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v25 + 280LL);
            LODWORD(v29) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v6 + 296LL))(v6);
            v28(v25, v29);
            _mm_mfence();
            if ( *(_WORD *)(v6 + 44) )
            {
              *(_QWORD *)v41 = v6;
              v3 = (AppleUSBUHCI *)arg1;
            }
            else
            {
              *(_QWORD *)v42 = v6;
              v3 = (AppleUSBUHCI *)arg1;
            }
          }
          if ( !v5 )
            break;
          LODWORD(v30) = OSMetaClassBase::safeMetaCast(*(_QWORD *)(v5 + 32), AppleUHCIQueueHead::metaClass);
          v6 = v30;
          if ( !v30 )
            return 0LL;
        }
        v4 = *((_QWORD *)v3 + 1144);
        v6 = 0LL;
LABEL_24:
        v5 = v6;
      }
      while ( v4 );
    }
  }
  else
  {
    v31 = 0LL;
    do
    {
      v43 = v31;
      v32 = *((_QWORD *)v3 + v31 + 110);
      for ( i = 0LL; v32; v32 = *(_QWORD *)(v32 + 32) )
      {
        LODWORD(v34) = OSMetaClassBase::safeMetaCast(v32, AppleUHCIIsochTransferDescriptor::metaClass);
        v35 = v34;
        LODWORD(v36) = OSMetaClassBase::safeMetaCast(v32, AppleUHCIQueueHead::metaClass);
        v37 = v36;
        if ( v36 )
        {
          if ( *(_BYTE *)(v36 + 51) != 221 && *(_WORD *)(v36 + 40) == a2 )
          {
            LODWORD(v38) = OSMetaClassBase::safeMetaCast(i, AppleUHCIQueueHead::metaClass);
            if ( v38 )
            {
              if ( !(unsigned int)AppleUSBUHCI::UnlinkQueueHead((uintptr_t)this, v37, v38) )
              {
                *(_QWORD *)(v37 + 32) = *((_QWORD *)this + 1144);
                *((_QWORD *)this + 1144) = v37;
                v32 = i;
              }
            }
          }
        }
        if ( v35 )
          v39 = *(_DWORD *)(AppleUHCIIsochTransferDescriptor::GetSharedLogical(v35) + 8);
        if ( !v32 )
          break;
        i = v32;
      }
      v31 = v43 + 1;
      v3 = this;
    }
    while ( v43 != 1023 );
  }
  return 0LL;
}
// EA80: using guessed type _QWORD AppleUHCIQueueHead::metaClass;
// EF18: using guessed type _QWORD AppleUHCIIsochTransferDescriptor::metaClass;
// 211C8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (00000000000061A6) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::UIMEnableAllEndpoints(AppleUSBUHCI *this, char a2)
{
  AppleUSBUHCI *v2; // rbx@1
  __int64 v3; // r13@2
  char *v4; // r15@3
  char *v5; // r12@3
  __int64 v6; // rax@4
  int v7; // eax@4
  char *v8; // r14@5
  __int64 v9; // r15@6
  void (__fastcall *v10)(_QWORD, _QWORD); // ST10_8@6
  __int64 v11; // rax@6
  void (__fastcall *v12)(_QWORD, _QWORD); // ST10_8@6
  __int64 v13; // rax@6
  char *v14; // rax@7
  __int64 v15; // r15@9
  char *v16; // r14@9
  void (__fastcall *v17)(_QWORD, _QWORD); // r12@9
  __int64 v18; // rax@9
  void (__fastcall *v19)(_QWORD, _QWORD); // r12@9
  __int64 v20; // rax@9
  __int64 v21; // r15@12
  char *v22; // r14@12
  void (__fastcall *v23)(_QWORD, _QWORD); // r12@12
  __int64 v24; // rax@12
  void (__fastcall *v25)(_QWORD, _QWORD); // r12@12
  __int64 v26; // rax@12
  __int64 v27; // rdi@12
  signed __int64 v28; // rax@16
  __int64 v29; // rbx@17
  __int64 i; // r15@17
  AppleUHCIIsochTransferDescriptor *v31; // rax@18
  AppleUHCIIsochTransferDescriptor *v32; // r13@18
  uintptr_t v33; // rax@18
  uintptr_t v34; // r14@18
  uintptr_t v35; // rax@20
  int v36; // eax@24
  char *v38; // [sp+8h] [bp-48h]@3
  signed __int64 v39; // [sp+10h] [bp-40h]@17

  v2 = this;
  if ( a2 )
  {
    v3 = *((_QWORD *)this + 1144);
    if ( v3 )
    {
      v4 = (char *)this + 9144;
      v38 = (char *)this + 9144;
      v5 = (char *)this + 9128;
      do
      {
        LODWORD(v6) = OSMetaClassBase::safeMetaCast(*(_QWORD *)(v3 + 32), AppleUHCIQueueHead::metaClass);
        *((_QWORD *)v2 + 1144) = v6;
        *(_QWORD *)(v3 + 32) = 0LL;
        v7 = *(_BYTE *)(v3 + 51);
        if ( *(_BYTE *)(v3 + 51) )
        {
          v8 = v4;
          if ( v7 == 2 )
          {
            v9 = *((_QWORD *)v2 + 1139);
            *(_QWORD *)(v3 + 32) = *(_QWORD *)(v9 + 32);
            v10 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v3 + 280LL);
            LODWORD(v11) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v9 + 288LL))(
                             v9,
                             AppleUHCIQueueHead::metaClass);
            v10(v3, v11);
            _mm_mfence();
            *(_QWORD *)(v9 + 32) = v3;
            v12 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v9 + 280LL);
            LODWORD(v13) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v3 + 296LL))(v3);
            v12(v9, v13);
            _mm_mfence();
            *((_QWORD *)v2 + 1139) = v3;
            v4 = v8;
          }
          else if ( v7 == 3 )
          {
            v21 = *((_QWORD *)v2 + *(_BYTE *)(v3 + 52) + 1145);
            *(_QWORD *)(v3 + 32) = *(_QWORD *)(v21 + 32);
            v22 = v5;
            v23 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v3 + 280LL);
            LODWORD(v24) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v21 + 288LL))(
                             v21,
                             AppleUHCIQueueHead::metaClass);
            v23(v3, v24);
            _mm_mfence();
            *(_QWORD *)(v21 + 32) = v3;
            v25 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v21 + 280LL);
            LODWORD(v26) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v3 + 296LL))(v3);
            v27 = v21;
            v4 = v38;
            v25(v27, v26);
            v5 = v22;
          }
        }
        else
        {
          v14 = v5;
          if ( !*(_WORD *)(v3 + 44) )
            v14 = v4;
          v15 = *(_QWORD *)v14;
          *(_QWORD *)(v3 + 32) = *(_QWORD *)(*(_QWORD *)v14 + 32LL);
          v16 = v5;
          v17 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v3 + 280LL);
          LODWORD(v18) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v15 + 288LL))(
                           v15,
                           AppleUHCIQueueHead::metaClass);
          v17(v3, v18);
          _mm_mfence();
          *(_QWORD *)(v15 + 32) = v3;
          v19 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v15 + 280LL);
          LODWORD(v20) = (*(int (__fastcall **)(_QWORD))(*(_QWORD *)v3 + 296LL))(v3);
          v19(v15, v20);
          _mm_mfence();
          if ( *(_WORD *)(v3 + 44) )
          {
            *(_QWORD *)v16 = v3;
            v4 = v38;
            v5 = v16;
          }
          else
          {
            *(_QWORD *)v38 = v3;
            v4 = v38;
            v5 = v16;
          }
        }
        v3 = *((_QWORD *)v2 + 1144);
      }
      while ( v3 );
    }
  }
  else
  {
    v28 = 0LL;
    do
    {
      v39 = v28;
      v29 = *((_QWORD *)v2 + v28 + 110);
      for ( i = 0LL; v29; v29 = *(_QWORD *)(v29 + 32) )
      {
        LODWORD(v31) = OSMetaClassBase::safeMetaCast(v29, AppleUHCIIsochTransferDescriptor::metaClass);
        v32 = v31;
        LODWORD(v33) = OSMetaClassBase::safeMetaCast(v29, AppleUHCIQueueHead::metaClass);
        v34 = v33;
        if ( v33 )
        {
          if ( *(_BYTE *)(v33 + 51) != 221 )
          {
            LODWORD(v35) = OSMetaClassBase::safeMetaCast(i, AppleUHCIQueueHead::metaClass);
            if ( v35 )
            {
              if ( !(unsigned int)AppleUSBUHCI::UnlinkQueueHead((uintptr_t)this, v34, v35) )
              {
                *(_QWORD *)(v34 + 32) = *((_QWORD *)this + 1144);
                *((_QWORD *)this + 1144) = v34;
                v29 = i;
              }
            }
          }
        }
        if ( v32 )
          v36 = *(_DWORD *)(AppleUHCIIsochTransferDescriptor::GetSharedLogical(v32) + 8);
        if ( !v29 )
          break;
        i = v29;
      }
      v28 = v39 + 1;
      v2 = this;
    }
    while ( v39 != 1023 );
  }
  return 0LL;
}
// EA80: using guessed type _QWORD AppleUHCIQueueHead::metaClass;
// EF18: using guessed type _QWORD AppleUHCIIsochTransferDescriptor::metaClass;
// 211C8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000006490) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::MetaClass::MetaClass(AppleUSBUHCI::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "AppleUSBUHCI", off_D020[0], 9464LL);
  result = (__int64)off_DFD0;
  *(_QWORD *)this = off_DFD0;
  return result;
}
// D020: using guessed type _QWORD off_D020[16];
// DFD0: using guessed type __int64 (__fastcall *off_DFD0[2])(AppleUSBUHCI::MetaClass *__hidden this);
// 20E38: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000064C2) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::MetaClass::~MetaClass(AppleUSBUHCI::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (00000000000064CC) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::AppleUSBUHCI(IOUSBControllerV3 *a1, const OSMetaClass *a2)
{
  __int64 result; // rax@1

  IOUSBControllerV3::IOUSBControllerV3(a1, a2);
  result = (__int64)off_D260;
  *(_QWORD *)a1 = off_D260;
  return result;
}
// D260: using guessed type __int64 (__fastcall *off_D260[2])(AppleUSBUHCI *__hidden this);

//----- (00000000000064EC) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::AppleUSBUHCI(IOUSBControllerV3 *a1, const OSMetaClass *a2)
{
  __int64 result; // rax@1

  IOUSBControllerV3::IOUSBControllerV3(a1, a2);
  result = (__int64)off_D260;
  *(_QWORD *)a1 = off_D260;
  return result;
}
// D260: using guessed type __int64 (__fastcall *off_D260[2])(AppleUSBUHCI *__hidden this);

//----- (000000000000650C) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::~AppleUSBUHCI(AppleUSBUHCI *this)
{
  return IOUSBControllerV3::~IOUSBControllerV3(this);
}

//----- (0000000000006516) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::~AppleUSBUHCI(AppleUSBUHCI *this)
{
  return IOUSBControllerV3::~IOUSBControllerV3(this);
}

//----- (0000000000006520) ----------------------------------------------------
void __fastcall AppleUSBUHCI::~AppleUSBUHCI(AppleUSBUHCI *this)
{
  IOUSBControllerV3::~IOUSBControllerV3(this);
  OSObject::operator delete((void *)this);
}

//----- (0000000000006542) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::getMetaClass(AppleUSBUHCI *this)
{
  return (__int64)&AppleUSBUHCI::gMetaClass;
}
// F3C8: using guessed type _QWORD AppleUSBUHCI::gMetaClass;

//----- (0000000000006550) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::MetaClass::MetaClass(AppleUSBUHCI::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "AppleUSBUHCI", off_D020[0], 9464LL);
  result = (__int64)off_DFD0;
  *(_QWORD *)this = off_DFD0;
  return result;
}
// D020: using guessed type _QWORD off_D020[16];
// DFD0: using guessed type __int64 (__fastcall *off_DFD0[2])(AppleUSBUHCI::MetaClass *__hidden this);
// 20E38: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000006582) ----------------------------------------------------
IOUSBControllerV3 *__fastcall AppleUSBUHCI::MetaClass::alloc(AppleUSBUHCI::MetaClass *this, unsigned __int64 a2)
{
  IOUSBControllerV3 *v2; // rbx@1

  v2 = (IOUSBControllerV3 *)OSObject::operator new((OSObject *)((char *)&loc_24F7 + 1), a2);
  IOUSBControllerV3::IOUSBControllerV3(v2, (const OSMetaClass *)&AppleUSBUHCI::gMetaClass);
  *(_QWORD *)v2 = off_D260;
  OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUSBUHCI::gMetaClass);
  return v2;
}
// D260: using guessed type __int64 (__fastcall *off_D260[2])(AppleUSBUHCI *__hidden this);
// F3C8: using guessed type _QWORD AppleUSBUHCI::gMetaClass;

//----- (00000000000065C2) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::AppleUSBUHCI(IOUSBControllerV3 *a1)
{
  IOUSBControllerV3::IOUSBControllerV3(a1, (const OSMetaClass *)&AppleUSBUHCI::gMetaClass);
  *(_QWORD *)a1 = off_D260;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUSBUHCI::gMetaClass);
}
// D260: using guessed type __int64 (__fastcall *off_D260[2])(AppleUSBUHCI *__hidden this);
// F3C8: using guessed type _QWORD AppleUSBUHCI::gMetaClass;

//----- (00000000000065F2) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::AppleUSBUHCI(IOUSBControllerV3 *a1)
{
  IOUSBControllerV3::IOUSBControllerV3(a1, (const OSMetaClass *)&AppleUSBUHCI::gMetaClass);
  *(_QWORD *)a1 = off_D260;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUSBUHCI::gMetaClass);
}
// D260: using guessed type __int64 (__fastcall *off_D260[2])(AppleUSBUHCI *__hidden this);
// F3C8: using guessed type _QWORD AppleUSBUHCI::gMetaClass;

//----- (0000000000006622) ----------------------------------------------------
char __fastcall AppleUSBUHCI::init(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rax@2
  __int64 v3; // rax@3
  signed __int64 v5; // rbx@5
  __int64 v6; // rdi@6

  v1 = a1;
  if ( (unsigned __int8)(*(int (__cdecl **)(__int64))(off_D068[0] + 600))(a1) )
  {
    LODWORD(v2) = IOSimpleLockAlloc(a1);
    *(_QWORD *)(a1 + 9280) = v2;
    if ( v2 )
    {
      LODWORD(v3) = IOSimpleLockAlloc(a1);
      *(_QWORD *)(a1 + 9272) = v3;
      if ( v3 )
      {
        *(_BYTE *)(a1 + 760) = 0;
        *(_BYTE *)(a1 + 440) = 0;
        *(_BYTE *)(*(_QWORD *)(a1 + 168) + 40LL) = 1;
        *(_DWORD *)(a1 + 9376) = 1;
        *(_DWORD *)(a1 + 9380) = 1;
        return 1;
      }
      v6 = *(_QWORD *)(a1 + 9280);
      v5 = v1 + 9272;
      if ( v6 )
        IOSimpleLockFree(v6);
    }
    else
    {
      v5 = a1 + 9272;
    }
    if ( *(_QWORD *)v5 )
      IOSimpleLockFree(*(_QWORD *)v5);
  }
  return 0;
}
// D068: using guessed type __int64 off_D068[7];
// 20D80: using guessed type int __cdecl IOSimpleLockAlloc(_QWORD);
// 20D88: using guessed type int __cdecl IOSimpleLockFree(_QWORD);

//----- (00000000000066CA) ----------------------------------------------------
int __fastcall AppleUSBUHCI::start(AppleUSBUHCI *this, IOService *a2)
{
  (*(void (__fastcall **)(AppleUSBUHCI *, _QWORD, _QWORD))(*(_QWORD *)this + 616LL))(
    this,
    "Need contiguous memory for isoch",
    **(_QWORD **)off_D088[0]);
  return (*(int (__fastcall **)(AppleUSBUHCI *, IOService *))(off_D068[0] + 1488))(this, a2);
}
// D068: using guessed type __int64 off_D068[7];
// D088: using guessed type __int64 off_D088[3];

//----- (000000000000670C) ----------------------------------------------------
int __fastcall AppleUSBUHCI::finalize(AppleUSBUHCI *this)
{
  return (*(int (__fastcall **)(AppleUSBUHCI *))(off_D068[0] + 1560))(this);
}
// D068: using guessed type __int64 off_D068[7];

//----- (000000000000671E) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::EnableUSBInterrupt(AppleUSBUHCI *this, unsigned __int8 a2)
{
  return IOPCIDevice::extendedConfigWrite16(*((IOPCIDevice **)this + 61), 0xC0uLL, (unsigned __int16)a2 << 13);
}

//----- (000000000000673C) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::HardwareInit(AppleUSBUHCI *this)
{
  signed int v1; // ebx@1
  __int64 v2; // rax@4
  __int64 v3; // r12@4
  __int64 v4; // rax@5
  __int64 v5; // r14@5
  void (__fastcall *v6)(_QWORD, _QWORD); // r15@6
  __int64 v7; // rax@6
  __int64 v8; // rax@6
  __int64 v9; // r12@6
  void (__fastcall *v10)(_QWORD, _QWORD); // r15@7
  __int64 v11; // rax@7
  __int64 v12; // rax@7
  __int64 v13; // r14@7
  void (__fastcall *v14)(_QWORD, _QWORD); // rbx@8
  __int64 v15; // rax@8
  __int64 v16; // r12@8
  __int64 v17; // rax@8
  bool v18; // cl@8
  __int64 v19; // r15@9
  void (__fastcall *v20)(_QWORD, _QWORD); // rbx@10
  __int64 v21; // rax@10
  signed int v22; // eax@10
  __int64 v23; // rbx@11
  __int64 v24; // r14@11
  __int64 v25; // rsi@15
  __int64 v26; // r12@15
  AppleUHCITransferDescriptor *v27; // rax@15
  AppleUHCITransferDescriptor *v28; // r15@15
  __int64 v29; // rax@16
  int v30; // er14@16
  __int64 v31; // rbx@16
  void (__fastcall *v32)(_QWORD, _QWORD); // r14@16
  __int64 v33; // rax@16
  __int64 v35; // [sp+10h] [bp-30h]@8

  __outword(*((_DWORD *)this + 172) + 4, 0);
  __outword(*((_WORD *)this + 344), 4u);
  IOSleep(100LL);
  __outword(*((_WORD *)this + 344), 0);
  v1 = AppleUSBUHCI::Reset(this, 0);
  if ( !v1 )
  {
    v1 = AppleUSBUHCI::InitializeBufferMemory(this);
    if ( v1 )
    {
      KernelDebugLogInternal(
        1LL,
        1431519814LL,
        "AppleUSBUHCI::HardwareInit - InitializeBufferMemory failed with status(0x%x)");
    }
    else
    {
      __outword(*((_DWORD *)this + 172) + 6, 0);
      __outdword(*((_DWORD *)this + 172) + 8, *((_DWORD *)this + 218));
      v2 = AppleUSBUHCI::AllocateQH((uintptr_t)this, 0LL, 0, 0, 0, 0, 0xDDu);
      v3 = v2;
      v1 = -536870211;
      if ( v2 )
      {
        *(_QWORD *)(v2 + 32) = 0LL;
        (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v2 + 280LL))(v2, 1LL);
        *(_QWORD *)(v3 + 56) = 0LL;
        *(_DWORD *)(AppleUHCIQueueHead::GetSharedLogical((AppleUHCIQueueHead *)v3) + 4) = 1;
        *((_QWORD *)this + 1137) = v3;
        v4 = AppleUSBUHCI::AllocateQH((uintptr_t)this, 0LL, 0, 0, 0, 0, 0xDDu);
        v5 = v4;
        if ( v4 )
        {
          *(_QWORD *)(v4 + 32) = v3;
          v6 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v4 + 280LL);
          LODWORD(v7) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v3 + 296LL))(v3, 0LL);
          v6(v5, v7);
          *(_QWORD *)(v5 + 56) = 0LL;
          *(_DWORD *)(AppleUHCIQueueHead::GetSharedLogical((AppleUHCIQueueHead *)v5) + 4) = 1;
          *((_QWORD *)this + 1139) = v5;
          *((_QWORD *)this + 1138) = v5;
          v8 = AppleUSBUHCI::AllocateQH((uintptr_t)this, 0LL, 0, 0, 0, 0, 0xDDu);
          v9 = v8;
          if ( v8 )
          {
            *(_QWORD *)(v8 + 32) = v5;
            v10 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v8 + 280LL);
            LODWORD(v11) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v5 + 296LL))(v5, 0LL);
            v10(v9, v11);
            *(_QWORD *)(v9 + 56) = 0LL;
            *(_DWORD *)(AppleUHCIQueueHead::GetSharedLogical((AppleUHCIQueueHead *)v9) + 4) = 1;
            *((_QWORD *)this + 1141) = v9;
            *((_QWORD *)this + 1140) = v9;
            v12 = AppleUSBUHCI::AllocateQH((uintptr_t)this, 0LL, 0, 0, 0, 0, 0xDDu);
            v13 = v12;
            if ( v12 )
            {
              *(_QWORD *)(v12 + 32) = v9;
              v14 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v12 + 280LL);
              v35 = v9;
              LODWORD(v15) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v9 + 296LL))(v9, 0LL);
              v14(v13, v15);
              *(_QWORD *)(v13 + 56) = 0LL;
              *(_DWORD *)(AppleUHCIQueueHead::GetSharedLogical((AppleUHCIQueueHead *)v13) + 4) = 1;
              *((_QWORD *)this + 1143) = v13;
              *((_QWORD *)this + 1142) = v13;
              v16 = 0LL;
              v17 = AppleUSBUHCI::AllocateQH((uintptr_t)this, 0LL, 0, 0, 0, 0, 0xDDu);
              v18 = v17 == 0;
              do
              {
                v19 = v17;
                if ( v18 )
                {
                  v1 = -536870211;
                  return (unsigned int)v1;
                }
                *((_QWORD *)this + v16 + 1145) = v17;
                *(_QWORD *)(v17 + 56) = 0LL;
                *(_DWORD *)(AppleUHCIQueueHead::GetSharedLogical((AppleUHCIQueueHead *)v17) + 4) = 1;
                *(_QWORD *)(v17 + 32) = v13;
                v20 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v17 + 280LL);
                LODWORD(v21) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v13 + 296LL))(v13, 0LL);
                v20(v19, v21);
                v22 = 1 << v16;
                if ( 1 << v16 <= 1024 )
                {
                  v23 = v22 - 1;
                  v24 = v22;
                  do
                  {
                    *(_DWORD *)(*((_QWORD *)this + 1134) + 4 * v23) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v19 + 296LL))(v19);
                    *((_QWORD *)this + v23 + 110) = v19;
                    v23 += v24;
                  }
                  while ( (signed int)v23 < 1024 );
                }
                ++v16;
                v17 = AppleUSBUHCI::AllocateQH((uintptr_t)this, 0LL, 0, 0, 0, 0, 0xDDu);
                v18 = v17 == 0;
                v13 = v19;
              }
              while ( (signed int)v16 < 6 );
              v1 = -536870211;
              if ( v17 )
              {
                v25 = v17;
                v26 = v17;
                v27 = (AppleUHCITransferDescriptor *)AppleUSBUHCI::AllocateTD(this, (AppleUHCIQueueHead *)v17);
                v28 = v27;
                if ( v27 )
                {
                  v29 = AppleUHCITransferDescriptor::GetSharedLogical(v27);
                  *(_DWORD *)(v29 + 4) |= 0x1000000u;
                  *(_DWORD *)(AppleUHCITransferDescriptor::GetSharedLogical(v28) + 12) = -559038737;
                  v30 = (*(int (__fastcall **)(_QWORD, __int64))(**((_QWORD **)this + 1133) + 296LL))(
                          *((_QWORD *)this + 1133),
                          v25);
                  *(_DWORD *)AppleUHCITransferDescriptor::GetSharedLogical(v28) = v30;
                  *(_DWORD *)(*((_QWORD *)this + 1134) + 4092LL) = (*(int (__fastcall **)(AppleUHCITransferDescriptor *))(*(_QWORD *)v28 + 296LL))(v28);
                  *((_QWORD *)this + 1133) = v28;
                  *((_QWORD *)this + 1135) = v26;
                  *((_QWORD *)this + 1136) = v28;
                  v31 = *((_QWORD *)this + 1137);
                  v32 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v31 + 280LL);
                  LODWORD(v33) = (*(int (**)(void))(*(_QWORD *)v35 + 296LL))();
                  v32(v31, v33 | 1);
                  __outword(*((_WORD *)this + 344), 0xC0u);
                  v1 = 0;
                }
              }
            }
          }
        }
      }
    }
  }
  return (unsigned int)v1;
}
// 20DA8: using guessed type int __fastcall IOSleep(_QWORD);
// 20DB0: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (0000000000006B68) ----------------------------------------------------
unsigned __int16 __fastcall AppleUSBUHCI::ioWrite16(AppleUSBUHCI *this, __int16 a2, unsigned __int16 a3)
{
  unsigned __int16 result; // ax@1

  result = a3;
  __outword(*((_WORD *)this + 344) + a2, a3);
  return result;
}

//----- (0000000000006B7C) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::GlobalReset(AppleUSBUHCI *this)
{
  __int64 result; // rax@1

  __outword(*((_WORD *)this + 344), 4u);
  IOSleep(100LL);
  result = 0LL;
  __outword(*((_WORD *)this + 344), 0);
  return result;
}
// 20DA8: using guessed type int __fastcall IOSleep(_QWORD);

//----- (0000000000006BAE) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::Reset(AppleUSBUHCI *this, char a2)
{
  signed int v2; // ebx@1
  unsigned __int16 v3; // ax@2
  unsigned int v4; // ecx@6
  __int64 v6; // rax@8

  __outword(*((_WORD *)this + 344), 2u);
  v2 = 0;
  while ( 1 )
  {
    v3 = __inword(*((_WORD *)this + 344));
    if ( !(v3 & 2) )
      break;
    IOSleep(1LL);
    ++v2;
    if ( v2 >= 100 )
      goto LABEL_6;
  }
  if ( v2 >= 100 )
  {
LABEL_6:
    (*(void (__fastcall **)(AppleUSBUHCI *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
    KernelDebugLogInternal(1LL, 1431519814LL, "%s: controller reset failed");
    return -536870186;
  }
  v6 = *((_QWORD *)this + 109);
  v4 = 0;
  if ( v6 )
  {
    __outdword(*((_DWORD *)this + 172) + 8, v6);
    __outword(*((_DWORD *)this + 172) + 6, *((_WORD *)this + 412) & 0x7FF);
    __outword(*((_WORD *)this + 344), 0xC0u);
    if ( a2 )
      __outword(*((_DWORD *)this + 172) + 4, 0xFu);
  }
  return v4;
}
// 20DA8: using guessed type int __fastcall IOSleep(_QWORD);
// 20DB0: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (0000000000006C86) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::InitializeBufferMemory(AppleUSBUHCI *this)
{
  AppleUSBUHCI *v1; // r12@1
  char *v2; // rbx@1
  char *v3; // r13@1
  __int64 v4; // rax@1
  unsigned __int64 v5; // r8@1
  __int64 v6; // r14@1
  IOBufferMemoryDescriptor **v7; // r15@2
  __int64 v8; // rax@2
  int v9; // eax@3
  char v10; // r15@4
  signed __int64 v11; // rsi@4
  char v12; // r13@4
  signed int v13; // ebx@5
  int v14; // ecx@7
  __int64 v15; // rdx@8
  int v16; // er10@10
  __int64 v17; // rax@12
  unsigned __int64 v18; // r8@12
  __int64 v19; // rax@12
  int v20; // ebx@15
  signed int v21; // eax@15
  __int64 v22; // rsi@19
  int v23; // ecx@19
  __int64 v24; // rax@20
  unsigned __int64 v25; // rsi@20
  int v26; // er15@20
  signed __int64 v27; // rdx@22
  int v28; // eax@22
  __int64 v29; // r15@23
  __int64 v30; // rax@24
  signed int v31; // eax@29
  unsigned __int64 v32; // r8@33
  __int64 v33; // rax@33
  __int64 v34; // rdx@35
  __int64 v35; // rsi@37
  __int64 v36; // rdi@41
  __int64 v37; // rdi@45
  __int64 v38; // rdi@49
  __int64 v39; // rax@53
  signed __int64 v41; // rax@57
  signed __int64 v42; // rax@57
  unsigned __int64 v43; // rsi@58
  int v44; // edx@58
  signed __int64 v45; // rcx@60
  int v46; // eax@60
  signed __int64 v47; // rdx@60
  __int64 v48; // rbx@61
  __int64 v49; // rax@62
  signed int v50; // er15@70
  signed __int64 v51; // [sp+10h] [bp-70h]@57
  signed __int64 v52; // [sp+18h] [bp-68h]@58
  int v53; // [sp+20h] [bp-60h]@61
  int v54; // [sp+28h] [bp-58h]@23
  signed __int64 v55; // [sp+28h] [bp-58h]@61
  signed __int64 v56; // [sp+30h] [bp-50h]@23
  signed __int64 v57; // [sp+30h] [bp-50h]@61
  signed int v58[3]; // [sp+38h] [bp-48h]@4
  __int64 v59; // [sp+38h] [bp-48h]@20
  int v60; // [sp+44h] [bp-3Ch]@1
  unsigned int v61; // [sp+48h] [bp-38h]@10
  int v62; // [sp+4Ch] [bp-34h]@10
  unsigned __int64 v63; // [sp+50h] [bp-30h]@1

  v1 = this;
  v63 = 0LL;
  v60 = 1;
  *((_QWORD *)this + 89) = 0LL;
  *((_QWORD *)this + 90) = 0LL;
  v2 = (char *)this + 768;
  *(_QWORD *)v2 = v2;
  *((_QWORD *)this + 97) = (char *)this + 768;
  v3 = (char *)this + 784;
  *(_QWORD *)v3 = v3;
  *((_QWORD *)this + 99) = (char *)this + 784;
  LODWORD(v4) = IODMACommand::withSpecification(off_D010[0], 32LL, 4096LL, 64LL, 0LL, 1LL);
  v6 = v4;
  if ( !v4 )
  {
    KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBUHCI::InitializeBufferMemory - could not create IODMACommand");
    v13 = -536870199;
    return (unsigned int)v13;
  }
  v7 = (IOBufferMemoryDescriptor **)off_D098;
  v8 = IOBufferMemoryDescriptor::inTaskWithPhysicalMask(
         *(IOBufferMemoryDescriptor **)off_D098,
         (task *)((char *)&dword_0 + 3),
         0x1000u,
         0xFFFFF000uLL,
         v5);
  *((_QWORD *)this + 88) = v8;
  if ( !v8 )
  {
    v10 = 0;
    v11 = 1431519814LL;
    KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBUHCI::InitializeBufferMemory - could not get frame list buffer");
    v58[0] = -536870211;
    v12 = 0;
    goto LABEL_41;
  }
  v9 = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v8 + 496LL))(v8, 0LL);
  if ( !v9 )
  {
    v14 = (*(int (__fastcall **)(__int64, _QWORD, signed __int64))(*(_QWORD *)v6 + 296LL))(
            v6,
            *((_QWORD *)this + 88),
            1LL);
    if ( v14 )
    {
      v15 = (__int64)"AppleUSBUHCI::InitializeBufferMemory - setMemoryDescriptor returned err (0x%x)";
LABEL_9:
      v12 = 0;
      v11 = 1431519814LL;
      v58[0] = v14;
      KernelDebugLogInternal(1LL, 1431519814LL, v15);
      v10 = 1;
      goto LABEL_41;
    }
    v63 = 0LL;
    v61 = 0;
    v62 = 0;
    v60 = 1;
    v16 = (*(int (__fastcall **)(__int64, unsigned __int64 *, int *, int *))(*(_QWORD *)v6 + 344LL))(
            v6,
            &v63,
            &v61,
            &v60);
    if ( v62 != 4096 || v60 != 1 || v16 != 0 )
    {
      v12 = 0;
      v20 = v16;
      KernelDebugLogInternal(
        1LL,
        1431519814LL,
        "AppleUSBUHCI::InitializeBufferMemory - could not generate segments err (0x%x) numSegments (%d) fLength (%d)");
      v11 = 1LL;
      (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v6 + 304LL))(v6, 1LL);
      v21 = -536870199;
      if ( v20 )
        v21 = v20;
      v58[0] = v21;
      v10 = 1;
      goto LABEL_41;
    }
    LODWORD(v17) = (*(int (__cdecl **)(_QWORD, unsigned __int64 *))(**((_QWORD **)this + 88) + 736LL))(
                     *((_QWORD *)this + 88),
                     &v63);
    *((_QWORD *)this + 1134) = v17;
    *((_QWORD *)this + 109) = v61;
    (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v6 + 304LL))(v6, 1LL);
    v19 = IOBufferMemoryDescriptor::inTaskWithPhysicalMask(
            *v7,
            (task *)((char *)&dword_0 + 3),
            0x1000u,
            0xFFFFF000uLL,
            v18);
    *((_QWORD *)this + 89) = v19;
    if ( !v19 )
    {
      v12 = 0;
      v11 = 1431519814LL;
      KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBUHCI::InitializeBufferMemory - could not get alignment buffer");
      v10 = 1;
      v58[0] = -536870211;
      goto LABEL_41;
    }
    v14 = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v19 + 496LL))(v19, 0LL);
    if ( v14 )
    {
      v15 = (__int64)"AppleUSBUHCI::InitializeBufferMemory - _alignBuffer->prepare failed with status(0x%x)";
      goto LABEL_9;
    }
    v22 = *((_QWORD *)this + 89);
    v23 = (*(int (__fastcall **)(__int64, __int64, signed __int64))(*(_QWORD *)v6 + 296LL))(v6, v22, 1LL);
    if ( !v23 )
    {
      LODWORD(v24) = (*(int (__cdecl **)(_QWORD, __int64))(**((_QWORD **)this + 89) + 736LL))(
                       *((_QWORD *)this + 89),
                       v22);
      v59 = v24;
      v63 = 0LL;
      v61 = 0;
      v62 = 0;
      v60 = 1;
      v25 = (unsigned __int64)&v63;
      v26 = (*(int (__fastcall **)(__int64, unsigned __int64 *, unsigned int *, int *))(*(_QWORD *)v6 + 344LL))(
              v6,
              &v63,
              &v61,
              &v60);
      if ( v62 != 4096 || v60 != 1 || v26 != 0 )
      {
        KernelDebugLogInternal(
          1LL,
          1431519814LL,
          "AppleUSBUHCI::InitializeBufferMemory - could not generate segments err (0x%x) numSegments (%d) fLength (%d)");
        v11 = 1LL;
        (*(void (__fastcall **)(_QWORD, signed __int64))(*(_QWORD *)v6 + 304LL))(v6, 1LL);
        v31 = -536870199;
        if ( v26 )
          v31 = v26;
        v58[0] = v31;
        goto LABEL_40;
      }
      v27 = v61;
      v28 = 0;
      while ( 1 )
      {
        v54 = v28;
        v56 = v27;
        v29 = OSObject::operator new((OSObject *)&stru_20.nsects, v25);
        v25 = (unsigned __int64)&UHCIAlignmentBuffer::gMetaClass;
        OSObject::OSObject(v29, &UHCIAlignmentBuffer::gMetaClass);
        *(_QWORD *)v29 = off_E120;
        OSMetaClass::instanceConstructed((OSMetaClass *)&UHCIAlignmentBuffer::gMetaClass);
        if ( !v29 )
          break;
        *(_QWORD *)(v29 + 16) = v56;
        *(_QWORD *)(v29 + 24) = v59;
        *(_QWORD *)(v29 + 32) = 0LL;
        *(_QWORD *)(v29 + 40) = 0LL;
        *(_DWORD *)(v29 + 72) = 0;
        v30 = *((_QWORD *)this + 97);
        if ( v2 == (char *)v30 )
          *(_QWORD *)v2 = v29;
        else
          *(_QWORD *)(v30 + 80) = v29;
        *(_QWORD *)(v29 + 88) = v30;
        *(_QWORD *)(v29 + 80) = v2;
        *((_QWORD *)this + 97) = v29;
        v59 += 64LL;
        v27 = v56 + 64;
        v28 = v54 + 1;
        if ( v54 + 1 >= 64 )
          goto LABEL_33;
      }
      KernelDebugLogInternal(
        1LL,
        1431519814LL,
        "AppleUSBUHCI::InitializeBufferMemory - unable to allocate expected UHCIAlignmentBuffer");
LABEL_33:
      (*(void (__fastcall **)(__int64, signed __int64, signed __int64))(*(_QWORD *)v6 + 304LL))(v6, 1LL, v27);
      v33 = IOBufferMemoryDescriptor::inTaskWithPhysicalMask(
              *(IOBufferMemoryDescriptor **)off_D098,
              (task *)((char *)&dword_0 + 3),
              0x6000u,
              0xFFFFF000uLL,
              v32);
      *((_QWORD *)this + 90) = v33;
      if ( !v33 )
      {
        v11 = 1431519814LL;
        KernelDebugLogInternal(
          1LL,
          1431519814LL,
          "AppleUSBUHCI::InitializeBufferMemory - could not get isoch alignment buffer");
        v10 = 1;
        v58[0] = -536870211;
        v12 = 1;
        goto LABEL_41;
      }
      v23 = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v33 + 496LL))(v33, 0LL);
      if ( v23 )
      {
        v34 = (__int64)"AppleUSBUHCI::InitializeBufferMemory - _alignBuffer->prepare failed with status(0x%x)";
LABEL_39:
        v11 = 1431519814LL;
        v58[0] = v23;
        KernelDebugLogInternal(1LL, 1431519814LL, v34);
LABEL_40:
        v10 = 1;
        v12 = 1;
        goto LABEL_41;
      }
      v35 = *((_QWORD *)this + 90);
      v23 = (*(int (__fastcall **)(_QWORD, __int64, signed __int64))(*(_QWORD *)v6 + 296LL))(v6, v35, 1LL);
      if ( !v23 )
      {
        LODWORD(v41) = (*(int (__cdecl **)(_QWORD, __int64))(**((_QWORD **)this + 90) + 736LL))(
                         *((_QWORD *)this + 90),
                         v35);
        v51 = v41;
        v42 = 0LL;
        while ( 1 )
        {
          v52 = v42;
          v63 = v42 << 12;
          v61 = 0;
          v62 = 0;
          v60 = 1;
          v43 = (unsigned __int64)&v63;
          v44 = (*(int (__fastcall **)(__int64, unsigned __int64 *, unsigned int *, int *))(*(_QWORD *)v6 + 344LL))(
                  v6,
                  &v63,
                  &v61,
                  &v60);
          if ( v62 != 4096 || v60 != 1 || v44 != 0 )
            break;
          v58[0] = v44;
          v45 = v61;
          v46 = 0;
          v47 = v51;
          while ( 1 )
          {
            v55 = v47;
            v53 = v46;
            v57 = v45;
            v48 = OSObject::operator new((OSObject *)&stru_20.nsects, v43);
            v43 = (unsigned __int64)&UHCIAlignmentBuffer::gMetaClass;
            OSObject::OSObject(v48, &UHCIAlignmentBuffer::gMetaClass);
            *(_QWORD *)v48 = off_E120;
            OSMetaClass::instanceConstructed((OSMetaClass *)&UHCIAlignmentBuffer::gMetaClass);
            if ( !v48 )
              break;
            *(_QWORD *)(v48 + 16) = v57;
            *(_QWORD *)(v48 + 24) = v55;
            *(_QWORD *)(v48 + 32) = 0LL;
            *(_QWORD *)(v48 + 40) = 0LL;
            *(_DWORD *)(v48 + 72) = 1;
            v49 = *((_QWORD *)this + 99);
            if ( v3 == (char *)v49 )
              *(_QWORD *)v3 = v48;
            else
              *(_QWORD *)(v49 + 80) = v48;
            *(_QWORD *)(v48 + 88) = v49;
            *(_QWORD *)(v48 + 80) = v3;
            *((_QWORD *)this + 99) = v48;
            v45 = v57 + 1024;
            v47 = v55 + 1024;
            v46 = v53 + 1;
            if ( v53 + 1 >= 4 )
              goto LABEL_68;
          }
          KernelDebugLogInternal(
            1LL,
            1431519814LL,
            "AppleUSBUHCI::InitializeBufferMemory - unable to allocate expected UHCIAlignmentBuffer");
LABEL_68:
          v42 = v52 + 1;
          v51 += 4096LL;
          if ( (signed int)v52 + 1 >= 6 )
            goto LABEL_73;
        }
        v50 = v44;
        KernelDebugLogInternal(
          1LL,
          1431519814LL,
          "AppleUSBUHCI::InitializeBufferMemory - could not generate segments err (0x%x) numSegments (%d) fLength (%d)");
        (*(void (__fastcall **)(_QWORD, signed __int64))(*(_QWORD *)v6 + 304LL))(v6, 1LL);
        if ( !v50 )
          v50 = -536870199;
        v58[0] = v50;
LABEL_73:
        v11 = 1LL;
        (*(void (__fastcall **)(__int64, signed __int64, signed __int64, signed __int64))(*(_QWORD *)v6 + 304LL))(
          v6,
          1LL,
          v47,
          v45);
        v10 = 1;
        v13 = 0;
        v12 = 1;
        if ( !v58[0] )
          goto LABEL_53;
        goto LABEL_41;
      }
    }
    v34 = (__int64)"AppleUSBUHCI::InitializeBufferMemory - setMemoryDescriptor (_alignBuffer) returned err (0x%x)";
    goto LABEL_39;
  }
  v58[0] = v9;
  v10 = 0;
  v11 = 1431519814LL;
  KernelDebugLogInternal(
    1LL,
    1431519814LL,
    "AppleUSBUHCI::InitializeBufferMemory - _frameListBuffer->prepare failed with status(0x%x)");
  v12 = 0;
LABEL_41:
  v36 = *((_QWORD *)this + 88);
  if ( v36 )
  {
    if ( v10 )
    {
      v11 = 0LL;
      (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v36 + 504LL))(v36, 0LL);
      v36 = *((_QWORD *)v1 + 88);
    }
    (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v36 + 40LL))(v36, v11);
    *((_QWORD *)v1 + 88) = 0LL;
  }
  v37 = *((_QWORD *)v1 + 89);
  v13 = v58[0];
  if ( v37 )
  {
    if ( v12 )
    {
      v11 = 0LL;
      (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v37 + 504LL))(v37, 0LL);
      v37 = *((_QWORD *)v1 + 89);
    }
    (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v37 + 40LL))(v37, v11);
    *((_QWORD *)v1 + 89) = 0LL;
  }
  v38 = *((_QWORD *)v1 + 90);
  if ( v38 )
  {
    if ( v12 )
    {
      v11 = 0LL;
      (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v38 + 504LL))(v38, 0LL);
      v38 = *((_QWORD *)v1 + 90);
    }
    (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v38 + 40LL))(v38, v11);
    *((_QWORD *)v1 + 90) = 0LL;
  }
LABEL_53:
  LODWORD(v39) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v6 + 312LL))(v6, v11);
  if ( v39 )
  {
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v6 + 312LL))(v6);
    KernelDebugLogInternal(
      1LL,
      1431519814LL,
      "AppleUSBUHCI::InitializeBufferMemory - dmaCommand still has memory descriptor (%p)");
    (*(void (__fastcall **)(_QWORD, signed __int64))(*(_QWORD *)v6 + 304LL))(v6, 1LL);
  }
  (*(void (__fastcall **)(__int64))(*(_QWORD *)v6 + 40LL))(v6);
  return (unsigned int)v13;
}
// 0: using guessed type int;
// 20: using guessed type segment_command_64;
// D010: using guessed type __int64 off_D010[18];
// D098: using guessed type __int64 off_D098;
// E120: using guessed type __int64 (__fastcall *off_E120[2])(UHCIAlignmentBuffer *__hidden this);
// F3F0: using guessed type _QWORD UHCIAlignmentBuffer::gMetaClass;
// 20DB0: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);
// 20E78: using guessed type int __fastcall IODMACommand::withSpecification(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 21620: using guessed type int __fastcall OSObject::OSObject(_QWORD, _QWORD);

//----- (00000000000074AE) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::ioWrite32(AppleUSBUHCI *this, __int16 a2, unsigned int a3)
{
  __int64 result; // rax@1

  result = a3;
  __outdword(*((_WORD *)this + 344) + a2, a3);
  return result;
}

//----- (00000000000074C0) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::AllocateQH(uintptr_t arg1, unsigned __int64 a2, unsigned __int16 a3, unsigned __int8 a4, __int16 a5, __int16 a6, unsigned __int8 a7)
{
  __int64 v7; // r12@1
  __int64 v8; // rax@2
  AppleUHCIqhMemoryBlock *v9; // r15@2
  __int64 v10; // rbx@3
  __int64 v11; // r12@3
  unsigned __int64 v12; // rax@3
  __int64 v13; // rax@3
  signed __int64 v14; // r13@3
  __int64 v15; // rbx@4
  unsigned __int64 v16; // rax@4
  __int64 v17; // rax@14
  __int16 v19; // [sp+0h] [bp-40h]@1
  __int16 v20; // [sp+4h] [bp-3Ch]@1
  unsigned __int8 v21; // [sp+8h] [bp-38h]@1
  unsigned __int16 v22; // [sp+Ch] [bp-34h]@1
  unsigned int arg3; // [sp+14h] [bp-2Ch]@3

  v20 = a6;
  v19 = a5;
  v21 = a4;
  v22 = a3;
  v7 = *(_QWORD *)(arg1 + 9256);
  if ( v7 )
  {
LABEL_14:
    LODWORD(v17) = OSMetaClassBase::safeMetaCast(*(_QWORD *)(v7 + 32), AppleUHCIQueueHead::metaClass);
    *(_QWORD *)(arg1 + 9256) = v17;
    if ( !v17 )
      *(_QWORD *)(arg1 + 9264) = 0LL;
    *(_QWORD *)(v7 + 32) = 0LL;
    *(_WORD *)(v7 + 40) = a2;
    *(_WORD *)(v7 + 42) = v22;
    *(_BYTE *)(v7 + 50) = v21;
    *(_WORD *)(v7 + 44) = v19;
    *(_WORD *)(v7 + 46) = v20;
    *(_BYTE *)(v7 + 51) = a7;
    *(_BYTE *)(v7 + 53) = 0;
    return v7;
  }
  v8 = AppleUHCIqhMemoryBlock::NewMemoryBlock((AppleUHCIqhMemoryBlock *)arg1, a2);
  v9 = (AppleUHCIqhMemoryBlock *)v8;
  if ( v8 )
  {
    AppleUHCIqhMemoryBlock::SetNextBlock((AppleUHCIqhMemoryBlock *)v8, *(AppleUHCIqhMemoryBlock **)(arg1 + 9240));
    *(_QWORD *)(arg1 + 9240) = v9;
    arg3 = AppleUHCIqhMemoryBlock::NumQHs(v9);
    v10 = 0LL;
    v11 = AppleUHCIqhMemoryBlock::GetLogicalPtr(v9, 0);
    v12 = AppleUHCIqhMemoryBlock::GetPhysicalPtr(v9, 0);
    v13 = AppleUHCIQueueHead::WithSharedMemory(v11, v12);
    *(_QWORD *)(arg1 + 9264) = v13;
    *(_QWORD *)(arg1 + 9256) = v13;
    v14 = 1LL;
    if ( arg3 >= 2 )
    {
      while ( 1 )
      {
        v15 = AppleUHCIqhMemoryBlock::GetLogicalPtr(v9, v14);
        v16 = AppleUHCIqhMemoryBlock::GetPhysicalPtr(v9, v14);
        v7 = AppleUHCIQueueHead::WithSharedMemory(v15, v16);
        if ( !v7 )
          break;
        *(_QWORD *)(v7 + 32) = *(_QWORD *)(arg1 + 9256);
        *(_QWORD *)(arg1 + 9256) = v7;
        ++v14;
        if ( (unsigned int)v14 >= arg3 )
          goto LABEL_14;
      }
      if ( *(_BYTE *)off_D080[0] & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D2C14u, arg1, v14, arg3, 1uLL, 0LL);
      v7 = *(_QWORD *)(arg1 + 9256);
      v10 = 0LL;
      if ( v7 )
        goto LABEL_14;
    }
  }
  else
  {
    v10 = 0LL;
    if ( *(_BYTE *)off_D080[0] & 2 )
    {
      v10 = 0LL;
      if ( *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
      {
        v10 = 0LL;
        kernel_debug(0x52D2C14u, (unsigned __int16)a2, v22, v21, a7, 0LL);
      }
    }
  }
  return v10;
}
// D080: using guessed type __int64 off_D080[4];
// D090: using guessed type __int64 off_D090[2];
// EA80: using guessed type _QWORD AppleUHCIQueueHead::metaClass;
// 211C8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (00000000000076D0) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::AllocateTD(AppleUSBUHCI *this, AppleUHCIQueueHead *a2)
{
  __int64 v2; // r13@1
  __int64 v3; // rax@2
  AppleUHCItdMemoryBlock *v4; // r12@2
  __int64 v5; // r14@3
  __int64 v6; // r13@3
  unsigned __int64 v7; // rax@3
  __int64 v8; // rax@3
  unsigned int v9; // ebx@4
  __int64 v10; // r14@5
  unsigned __int64 v11; // rax@5
  __int64 v12; // rax@10
  unsigned int v14; // [sp+14h] [bp-2Ch]@3

  v2 = *((_QWORD *)this + 1151);
  if ( v2 )
    goto LABEL_10;
  v3 = AppleUHCItdMemoryBlock::NewMemoryBlock(this, (unsigned __int64)a2);
  v4 = (AppleUHCItdMemoryBlock *)v3;
  if ( !v3 )
  {
    v5 = 0LL;
    KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBUHCI::AllocateTD - unable to allocate a new memory block!");
    return v5;
  }
  AppleUHCItdMemoryBlock::SetNextBlock((AppleUHCItdMemoryBlock *)v3, *((AppleUHCItdMemoryBlock **)this + 1156));
  *((_QWORD *)this + 1156) = v4;
  v14 = AppleUHCItdMemoryBlock::NumTDs(v4);
  v5 = 0LL;
  v6 = AppleUHCItdMemoryBlock::GetLogicalPtr(v4, 0);
  v7 = AppleUHCItdMemoryBlock::GetPhysicalPtr(v4, 0);
  v8 = AppleUHCITransferDescriptor::WithSharedMemory(v6, v7);
  *((_QWORD *)this + 1152) = v8;
  *((_QWORD *)this + 1151) = v8;
  if ( v14 >= 2 )
  {
    v9 = 1;
    while ( 1 )
    {
      v10 = AppleUHCItdMemoryBlock::GetLogicalPtr(v4, v9);
      v11 = AppleUHCItdMemoryBlock::GetPhysicalPtr(v4, v9);
      v2 = AppleUHCITransferDescriptor::WithSharedMemory(v10, v11);
      if ( !v2 )
        break;
      *(_QWORD *)(v2 + 32) = *((_QWORD *)this + 1151);
      *((_QWORD *)this + 1151) = v2;
      ++v9;
      if ( v9 >= v14 )
        goto LABEL_10;
    }
    v5 = 0LL;
    KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBUHCI::AllocateTD - hmm. ran out of TDs in a memory block");
    v2 = *((_QWORD *)this + 1151);
    if ( v2 )
    {
LABEL_10:
      LODWORD(v12) = OSMetaClassBase::safeMetaCast(*(_QWORD *)(v2 + 32), AppleUHCITransferDescriptor::metaClass);
      *((_QWORD *)this + 1151) = v12;
      if ( !v12 )
        *((_QWORD *)this + 1152) = 0LL;
      *(_QWORD *)(v2 + 32) = 0LL;
      *(_QWORD *)(v2 + 40) = 0LL;
      *(_DWORD *)(v2 + 76) = 0;
      *(_DWORD *)(v2 + 80) = 0;
      *(_QWORD *)(v2 + 48) = 0LL;
      *(_DWORD *)(AppleUHCITransferDescriptor::GetSharedLogical((AppleUHCITransferDescriptor *)v2) + 4) = 0;
      (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v2 + 280LL))(v2, 0LL);
      *(_DWORD *)(AppleUHCITransferDescriptor::GetSharedLogical((AppleUHCITransferDescriptor *)v2) + 8) = 0;
      *(_DWORD *)(AppleUHCITransferDescriptor::GetSharedLogical((AppleUHCITransferDescriptor *)v2) + 12) = 0;
      *(_QWORD *)(v2 + 64) = a2;
      v5 = v2;
    }
  }
  return v5;
}
// ECC8: using guessed type _QWORD AppleUHCITransferDescriptor::metaClass;
// 20DB0: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);
// 211C8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (00000000000078A8) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::UIMInitialize(AppleUSBUHCI *this, IOService *a2)
{
  AppleUSBUHCI *v2; // r15@1
  __int64 result; // rax@1
  IOPCIDevice *v4; // rax@2
  __int64 v5; // rax@3
  __int64 v6; // rax@3
  __int64 v7; // rcx@3
  __int64 v8; // rax@3
  __int64 v9; // rcx@3
  IOMemoryMap *v10; // rax@5
  __int64 v11; // rdi@6
  __int64 v12; // rax@6
  __int64 v13; // rax@6
  __int64 v14; // rcx@6
  __int64 v15; // rax@7
  bool v16; // zf@8
  __int64 v17; // rbx@9
  __int64 v18; // rax@10

  v2 = this;
  result = 0LL;
  if ( !*((_BYTE *)this + 760) )
  {
    LODWORD(v4) = OSMetaClassBase::safeMetaCast(a2, *(_QWORD *)off_D000[0]);
    *((_QWORD *)this + 61) = v4;
    if ( !v4 )
      return 3758097090LL;
    IOPCIDevice::extendedConfigWrite16(v4, 0xC0uLL, 0);
    v5 = AppleUSBUHCI::SetVendorInfo(this);
    AppleUSBUHCI::SetDeviceName(this, v5);
    LODWORD(v6) = (*(int (__fastcall **)(AppleUSBUHCI *, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 3344LL))(
                    this,
                    *((_WORD *)this + 365),
                    *((_WORD *)this + 366),
                    *((_WORD *)this + 367));
    v7 = v6;
    v8 = *((_QWORD *)this + 84);
    v9 = *(_QWORD *)(v8 + 208) | v7;
    *(_QWORD *)(v8 + 208) = v9;
    result = 3758097095LL;
    if ( *(_BYTE *)(*((_QWORD *)this + 21) + 244LL) || v9 & 0x400000 )
      return result;
    LODWORD(v10) = (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD))(**((_QWORD **)this + 61) + 1760LL))(
                     *((_QWORD *)this + 61),
                     0LL,
                     0LL);
    *((_QWORD *)this + 85) = v10;
    if ( !v10 )
    {
      KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBUHCI::UIMInitialize - ioMap is NULL");
      return 3758097085LL;
    }
    *((_QWORD *)this + 86) = IOMemoryMap::getPhysicalAddress(v10);
    v11 = *((_QWORD *)this + 85);
    LODWORD(v12) = (*(int (__cdecl **)(__int64))(*(_QWORD *)v11 + 280LL))(v11);
    *((_QWORD *)v2 + 87) = v12;
    LODWORD(v13) = IOLockAlloc(v11);
    v14 = v13;
    *((_QWORD *)v2 + 102) = v13;
    result = 3758097085LL;
    if ( !v14 )
      return result;
    *((_DWORD *)v2 + 216) = 1023;
    *(_DWORD *)(*((_QWORD *)v2 + 21) + 204LL) = 10000;
    *((_QWORD *)v2 + 101) = mach_absolute_time();
    LODWORD(v15) = IOFilterInterruptEventSource::filterInterruptEventSource(
                     v2,
                     AppleUSBUHCI::InterruptHandler,
                     AppleUSBUHCI::PrimaryInterruptFilter,
                     *((_QWORD *)v2 + 61),
                     0LL);
    *((_QWORD *)v2 + 94) = v15;
    if ( !v15 )
      return 3758097090LL;
    v16 = (*(int (__fastcall **)(_QWORD, __int64))(**((_QWORD **)v2 + 17) + 320LL))(*((_QWORD *)v2 + 17), v15) == 0;
    result = 3758097090LL;
    if ( v16 )
    {
      IOPCIDevice::extendedConfigWrite16(*((IOPCIDevice **)v2 + 61), 4uLL, 3u);
      AppleUSBUHCI::HardwareInit(v2);
      AppleUSBUHCI::CheckSleepCapability(v2);
      v17 = 0LL;
      do
      {
        LODWORD(v18) = thread_call_allocate(AppleUSBUHCI::RHResumePortTimerEntry, v2);
        *((_QWORD *)v2 + v17++ + 1169) = v18;
      }
      while ( v17 != 2 );
      *((_BYTE *)v2 + 760) = 1;
      *((_BYTE *)v2 + 440) = 0;
      result = 0LL;
    }
  }
  return result;
}
// D000: using guessed type _QWORD off_D000[20];
// 20D50: using guessed type int __cdecl IOLockAlloc(_QWORD);
// 20DB0: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);
// 211C8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);
// 21548: using guessed type int __fastcall IOFilterInterruptEventSource::filterInterruptEventSource(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 21C90: using guessed type int __fastcall thread_call_allocate(_QWORD, _QWORD);

//----- (0000000000007AD4) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::SetVendorInfo(AppleUSBUHCI *this)
{
  __int64 v1; // rax@1
  __int64 v2; // r14@1
  __int64 v3; // rsi@1
  __int64 v4; // rax@1
  __int64 v5; // rax@2
  __int64 v6; // rax@3
  __int64 v7; // rax@3
  __int64 v8; // rax@4
  __int64 v9; // rax@5
  __int64 v10; // rax@5
  __int64 v11; // rax@6
  __int64 result; // rax@7

  LODWORD(v1) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 61) + 696LL))(
                  *((_QWORD *)this + 61),
                  "vendor-id");
  v2 = *(_QWORD *)off_D048[0];
  v3 = *(_QWORD *)off_D048[0];
  LODWORD(v4) = OSMetaClassBase::safeMetaCast(v1, *(_QWORD *)off_D048[0]);
  if ( v4 )
  {
    LODWORD(v5) = (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v4 + 376LL))(v4, v3);
    *((_WORD *)this + 365) = *(_WORD *)v5;
  }
  LODWORD(v6) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 61) + 696LL))(
                  *((_QWORD *)this + 61),
                  "device-id");
  LODWORD(v7) = OSMetaClassBase::safeMetaCast(v6, v2);
  if ( v7 )
  {
    LODWORD(v8) = (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v7 + 376LL))(v7, v2);
    *((_WORD *)this + 366) = *(_WORD *)v8;
  }
  LODWORD(v9) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 61) + 696LL))(
                  *((_QWORD *)this + 61),
                  "revision-id");
  LODWORD(v10) = OSMetaClassBase::safeMetaCast(v9, v2);
  if ( v10 )
  {
    LODWORD(v11) = (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v10 + 376LL))(v10, v2);
    *((_WORD *)this + 367) = *(_WORD *)v11;
  }
  result = *((_WORD *)this + 365);
  if ( (_DWORD)result == 4358 )
  {
    result = *((_QWORD *)this + 84);
    *(_QWORD *)(result + 208) |= 0x40000000uLL;
  }
  return result;
}
// D048: using guessed type _QWORD off_D048[11];
// 211C8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000007BC4) ----------------------------------------------------
int __usercall AppleUSBUHCI::SetDeviceName@<eax>(AppleUSBUHCI *this@<rdi>, __int64 a2@<rax>)
{
  _QWORD *v2; // rax@1
  const char **v3; // r13@1
  __int64 v4; // rbx@3
  bool v5; // zf@5
  __int64 v6; // rax@9
  size_t v7; // r14@11
  size_t v8; // r15@11
  size_t v9; // rax@11
  char *v10; // rax@11
  char *v11; // r14@11
  __int64 v13; // [sp-8h] [bp-30h]@1

  v13 = a2;
  v2 = &UHCIVendorInfo;
  v3 = (const char **)off_E0B8;
  while ( 1 )
  {
    if ( *(_WORD *)v2 == *((_WORD *)this + 365) )
    {
      v4 = v2[2];
      if ( *(_QWORD *)(v4 + 8) )
      {
        while ( *(_WORD *)v4 != *((_WORD *)this + 366) )
        {
          v5 = *(_QWORD *)(v4 + 24) == 0LL;
          v4 += 16LL;
          if ( v5 )
            goto LABEL_8;
        }
        if ( v4 )
          break;
      }
    }
LABEL_8:
    v5 = v2[4] == 0LL;
    v3 = (const char **)(v2 + 4);
    v2 += 3;
    if ( v5 )
    {
      *((_DWORD *)this + 184) = 0;
      v6 = (__int64)"Generic UHCI USB Controller";
      *((_QWORD *)this + 93) = "Generic UHCI USB Controller";
      return v6;
    }
  }
  v7 = strlen(*v3);
  v8 = strlen(*(const char **)(v4 + 8));
  v9 = strlen("UHCI USB Controller") + v7 + v8 + 4;
  *((_DWORD *)this + 184) = v9;
  LODWORD(v10) = IOMalloc((signed int)v9);
  v11 = v10;
  LODWORD(v6) = snprintf(v10, *((_DWORD *)this + 184), "%s %s UHCI USB Controller", *v3, *(_QWORD *)(v4 + 8), v13);
  *((_QWORD *)this + 93) = v11;
  return v6;
}
// E0B0: using guessed type _QWORD UHCIVendorInfo;
// E0B8: using guessed type char *off_E0B8[2];
// 20D78: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (0000000000007CCA) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::UIMFinalize(AppleUSBUHCI *this)
{
  AppleUSBUHCI *v1; // rbx@1
  __int64 v2; // rdi@2
  __int64 v3; // rdi@4

  v1 = this;
  AppleUSBUHCI::RHEnablePort(this, 1, 0);
  AppleUSBUHCI::RHEnablePort(this, 2, 0);
  AppleUSBUHCI::SuspendController(this);
  if ( !(unsigned __int8)IOService::isInactive(this) )
  {
    v2 = *((_QWORD *)this + 85);
    if ( v2 )
    {
      (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v2 + 40LL))(v2, 2LL);
      *((_QWORD *)v1 + 85) = 0LL;
    }
  }
  v3 = *((_QWORD *)v1 + 1181);
  if ( v3 )
  {
    (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v3 + 280LL))(v3, 2LL);
    *((_QWORD *)v1 + 1181) = 0LL;
  }
  AppleUSBUHCI::FreeBufferMemory(v1);
  if ( *((_QWORD *)v1 + 94) )
  {
    (*(void (__cdecl **)(_QWORD))(**((_QWORD **)v1 + 17) + 328LL))(*((_QWORD *)v1 + 17));
    (*(void (__cdecl **)(_QWORD))(**((_QWORD **)v1 + 94) + 40LL))(*((_QWORD *)v1 + 94));
    *((_QWORD *)v1 + 94) = 0LL;
  }
  IOLockFree(*((_QWORD *)v1 + 102));
  *((_QWORD *)v1 + 102) = 0LL;
  if ( *((_DWORD *)v1 + 184) )
  {
    IOFree(*((_QWORD *)v1 + 93));
    *((_QWORD *)v1 + 93) = 0LL;
    *((_DWORD *)v1 + 184) = 0;
  }
  *((_BYTE *)v1 + 760) = 0;
  return 0LL;
}
// 20D48: using guessed type int __fastcall IOFree(_QWORD);
// 20D58: using guessed type int __fastcall IOLockFree(_QWORD);

//----- (0000000000007DD0) ----------------------------------------------------
void __fastcall AppleUSBUHCI::FreeBufferMemory(AppleUSBUHCI *this)
{
  AppleUSBUHCI *v1; // r14@1
  char *v2; // rbx@1
  char *i; // rdi@1
  __int64 v4; // rax@4
  signed __int64 v5; // rbx@7
  __int64 j; // rdi@7
  __int64 v7; // rax@10
  __int64 v8; // rdi@13
  __int64 v9; // rdi@15
  __int64 v10; // rdi@17

  v1 = this;
  v2 = (char *)this + 768;
  for ( i = (char *)*((_QWORD *)this + 96); v2 != i; i = *(char **)v2 )
  {
    v4 = *((_QWORD *)i + 10);
    if ( v2 == (char *)v4 )
      *((_QWORD *)v1 + 97) = v2;
    else
      *(_QWORD *)(v4 + 88) = v2;
    *(_QWORD *)v2 = v4;
    *((_QWORD *)i + 10) = 0LL;
    *((_QWORD *)i + 11) = 0LL;
    (*(void (**)(void))(*(_QWORD *)i + 40LL))();
  }
  v5 = (signed __int64)((char *)v1 + 784);
  for ( j = *((_QWORD *)v1 + 98); v5 != j; j = *(_QWORD *)v5 )
  {
    v7 = *(_QWORD *)(j + 80);
    if ( v5 == v7 )
      *((_QWORD *)v1 + 99) = v5;
    else
      *(_QWORD *)(v7 + 88) = v5;
    *(_QWORD *)v5 = v7;
    *(_QWORD *)(j + 80) = 0LL;
    *(_QWORD *)(j + 88) = 0LL;
    (*(void (**)(void))(*(_QWORD *)j + 40LL))();
  }
  v8 = *((_QWORD *)v1 + 88);
  if ( v8 )
  {
    (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v8 + 504LL))(v8, 0LL);
    (*(void (**)(void))(**((_QWORD **)v1 + 88) + 40LL))();
    *((_QWORD *)v1 + 88) = 0LL;
  }
  v9 = *((_QWORD *)v1 + 89);
  if ( v9 )
  {
    (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v9 + 504LL))(v9, 0LL);
    (*(void (**)(void))(**((_QWORD **)v1 + 89) + 40LL))();
    *((_QWORD *)v1 + 89) = 0LL;
  }
  v10 = *((_QWORD *)v1 + 90);
  if ( v10 )
  {
    (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v10 + 504LL))(v10, 0LL);
    (*(void (**)(void))(**((_QWORD **)v1 + 90) + 40LL))();
    *((_QWORD *)v1 + 90) = 0LL;
  }
}

//----- (0000000000007EFE) ----------------------------------------------------
int __fastcall AppleUSBUHCI::message(uintptr_t arg1, const char *a2, IOService *a3, void *a4)
{
  uintptr_t v4; // rbx@1
  uintptr_t v5; // r15@1
  __int64 v6; // rax@2
  __int64 v7; // rax@2
  uintptr_t v8; // rsi@2
  __int64 v9; // rax@2
  __int64 v10; // r12@2
  __int64 v11; // r13@2
  int result; // eax@10

  v4 = (uintptr_t)a4;
  v5 = (uintptr_t)a3;
  if ( (_DWORD)a2 == -536854512 )
  {
    v6 = IORegistryEntry::getPlane("IOUSB", a2);
    LODWORD(v7) = (*(int (__fastcall **)(uintptr_t, __int64))(*(_QWORD *)v4 + 792LL))(v4, v6);
    v8 = *(_QWORD *)off_D028[0];
    LODWORD(v9) = OSMetaClassBase::safeMetaCast(v7, *(_QWORD *)off_D028[0]);
    v10 = v9;
    (*(void (__fastcall **)(uintptr_t, uintptr_t))(*(_QWORD *)v4 + 32LL))(v4, v8);
    v11 = off_D080[0];
    if ( *(_BYTE *)off_D080[0] & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
    {
      v8 = arg1;
      kernel_debug(0x52D2C04u, arg1, v5, v4, 1uLL, 0LL);
    }
    if ( v10 == *(_QWORD *)(arg1 + 152) )
    {
      if ( *(_BYTE *)v11 & 2 )
      {
        if ( *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
        {
          v8 = arg1;
          kernel_debug(0x52D2C04u, arg1, *(_DWORD *)(arg1 + 9456), 0LL, 2uLL, 0LL);
        }
      }
      *(_BYTE *)(arg1 + 9460) = 1;
    }
    (*(void (__fastcall **)(uintptr_t, uintptr_t))(*(_QWORD *)v4 + 40LL))(v4, v8);
    result = 0;
  }
  else
  {
    result = (*(int (**)(void))(off_D068[0] + 1856))();
  }
  return result;
}
// D028: using guessed type _QWORD off_D028[15];
// D068: using guessed type __int64 off_D068[7];
// D080: using guessed type __int64 off_D080[4];
// D090: using guessed type __int64 off_D090[2];
// 211C8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000008018) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::GetBandwidthAvailable(AppleUSBUHCI *this)
{
  return *((_DWORD *)this + 216);
}

//----- (0000000000008024) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::ioRead16(AppleUSBUHCI *this, __int16 a2)
{
  __int64 result; // rax@1

  LOWORD(result) = __inword(*((_WORD *)this + 344) + a2);
  return (unsigned __int16)result;
}

//----- (0000000000008038) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::Run(AppleUSBUHCI *this, char a2)
{
  __int16 v2; // cx@1
  __int64 result; // rax@1
  signed int v4; // ebx@3

  LOWORD(result) = __inword(*((_WORD *)this + 344));
  v2 = result | 1;
  LODWORD(result) = result & 0xFFFE;
  if ( a2 )
    LOWORD(result) = v2;
  __outword(*((_WORD *)this + 344), result);
  v4 = 0;
  while ( 1 )
  {
    LOWORD(result) = __inword(*((_WORD *)this + 344) + 2);
    if ( a2 == (~(unsigned __int8)((unsigned int)result >> 5) & 1) )
      break;
    IOSleep(1LL);
    ++v4;
    result = 3758097110LL;
    if ( v4 >= 20 )
      return result;
  }
  *((_BYTE *)this + 440) = 2;
  return 0LL;
}
// 20DA8: using guessed type int __fastcall IOSleep(_QWORD);

//----- (00000000000080B6) ----------------------------------------------------
unsigned __int64 __fastcall AppleUSBUHCI::GetFrameNumber(uintptr_t arg1)
{
  uintptr_t v1; // r14@1
  unsigned __int16 v2; // ax@1
  uintptr_t v3; // rdx@2
  unsigned __int64 v4; // rbx@2
  __int64 v5; // rdi@6
  unsigned int v6; // ecx@7
  unsigned __int16 v7; // ax@7
  int v8; // ebx@7
  int v9; // ebx@8
  unsigned __int16 v10; // ax@11
  int v11; // eax@11

  v1 = arg1;
  v2 = __inword(*(_WORD *)(arg1 + 688) + 2);
  if ( v2 & 0x20 )
  {
    v3 = *(_QWORD *)(arg1 + 456);
    v4 = 0LL;
    if ( v3 <= 3 )
    {
      v4 = 0LL;
      if ( *(_BYTE *)off_D080[0] & 2 )
      {
        v4 = 0LL;
        if ( *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
        {
          v4 = 0LL;
          kernel_debug(0x52D2C08u, arg1, v3, 4uLL, 0LL, 0LL);
        }
      }
    }
  }
  else
  {
    v5 = *(_DWORD *)(arg1 + 824);
    if ( (unsigned int)v5 < 0xFFFFF800 )
    {
      while ( 1 )
      {
        v10 = __inword(*(_WORD *)(v1 + 688) + 6);
        v11 = v10 & 0x7FF;
        v9 = (v11 | v5 & 0xFFFFF800) + 2048;
        if ( ((unsigned __int16)v5 & 0x7FFu) <= v11 )
          v9 = v11 | v5 & 0xFFFFF800;
        if ( (unsigned __int8)OSCompareAndSwap(v5, (unsigned int)v9, v1 + 824) )
          break;
        v5 = *(_DWORD *)(v1 + 824);
      }
    }
    else
    {
      IOLockLock(*(_QWORD *)(v1 + 816));
      v6 = *(_DWORD *)(v1 + 824) & 0xFFFFF800;
      v7 = __inword(*(_WORD *)(v1 + 688) + 6);
      v8 = v7 & 0x7FF;
      if ( (*(_DWORD *)(v1 + 824) & 0x7FFu) <= v8 )
      {
        v9 = v6 | v8;
      }
      else
      {
        ++*(_DWORD *)(v1 + 828);
        v9 = (v6 | v8) + 2048;
      }
      *(_DWORD *)(v1 + 824) = v9;
      IOLockUnlock(*(_QWORD *)(v1 + 816));
    }
    v4 = (unsigned int)v9 | ((unsigned __int64)*(_DWORD *)(v1 + 828) << 32);
  }
  return v4;
}
// D080: using guessed type __int64 off_D080[4];
// D090: using guessed type __int64 off_D090[2];
// 20D60: using guessed type int __fastcall IOLockLock(_QWORD);
// 20D68: using guessed type int __fastcall IOLockUnlock(_QWORD);
// 20DB8: using guessed type int __fastcall OSCompareAndSwap(_QWORD, _QWORD, _QWORD);

//----- (0000000000008204) ----------------------------------------------------
int __fastcall AppleUSBUHCI::GetFrameNumber32(AppleUSBUHCI *this)
{
  return (*(int (**)(void))(*(_QWORD *)this + 2456LL))();
}

//----- (0000000000008212) ----------------------------------------------------
int __fastcall AppleUSBUHCI::GetFrameNumberWithTime(AppleUSBUHCI *this, unsigned __int64 *a2, unsigned __int64 *a3)
{
  __int64 v3; // rdi@1
  int result; // eax@2

  v3 = *((_QWORD *)this + 18);
  if ( v3 )
    result = (*(int (__fastcall **)(__int64, __int64 (__fastcall *)(AppleUSBUHCI *__hidden, OSObject *, void *, void *, void *, void *), unsigned __int64 *, unsigned __int64 *, _QWORD, _QWORD))(*(_QWORD *)v3 + 456LL))(
               v3,
               AppleUSBUHCI::GatedGetFrameNumberWithTime,
               a2,
               a3,
               0LL,
               0LL);
  else
    result = -536870201;
  return result;
}

//----- (0000000000008250) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::GatedGetFrameNumberWithTime(AppleUSBUHCI *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  *(_QWORD *)a2 = *((_QWORD *)this + 1179);
  *(_QWORD *)a3 = *((_QWORD *)this + 1175);
  return 0LL;
}

//----- (000000000000826C) ----------------------------------------------------
unsigned __int8 __fastcall AppleUSBUHCI::ioWrite8(AppleUSBUHCI *this, __int16 a2, unsigned __int8 a3)
{
  unsigned __int8 result; // al@1

  result = a3;
  __outbyte(*((_WORD *)this + 344) + a2, a3);
  return result;
}

//----- (000000000000827E) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::ioRead8(AppleUSBUHCI *this, __int16 a2)
{
  __int64 result; // rax@1

  LOBYTE(result) = __inbyte(*((_WORD *)this + 344) + a2);
  return (unsigned __int8)result;
}

//----- (0000000000008292) ----------------------------------------------------
unsigned __int32 __fastcall AppleUSBUHCI::ioRead32(AppleUSBUHCI *this, __int16 a2)
{
  return __indword(*((_WORD *)this + 344) + a2);
}

//----- (00000000000082A2) ----------------------------------------------------
void __fastcall AppleUSBUHCI::showRegisters(AppleUSBUHCI *this, __int64 a2, const char *a3)
{
  ;
}

//----- (00000000000082A8) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::ProcessCompletedTransactions(AppleUSBUHCI *this)
{
  AppleUSBUHCI::scavengeIsochTransactions(this);
  return AppleUSBUHCI::scavengeQueueHeads(this, *((IOUSBControllerListElement **)this + 1150));
}

//----- (00000000000082CC) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::scavengeIsochTransactions(AppleUSBUHCI *this)
{
  __int64 v1; // rbx@1
  int v2; // er15@1
  __int64 v3; // rbx@1
  int v4; // er12@1
  int v5; // er13@1
  __int64 v6; // rcx@3
  __int64 v7; // rax@4
  __int64 v8; // rax@5
  __int64 v9; // rax@9
  __int64 v10; // r12@9
  __int64 v11; // rax@9
  uintptr_t v12; // rbx@12
  __int64 v13; // r15@13
  __int64 v14; // r12@13

  v1 = *((_QWORD *)this + 1160);
  v2 = ml_set_interrupts_enabled(0LL);
  IOSimpleLockLock(v1);
  v3 = *((_QWORD *)this + 1171);
  v4 = *((_DWORD *)this + 2344);
  IOSimpleLockUnlock(*((_QWORD *)this + 1160));
  ml_set_interrupts_enabled((unsigned int)v2);
  v5 = *((_DWORD *)this + 2345);
  if ( v3 && v5 != v4 )
  {
    v6 = 0LL;
    while ( 1 )
    {
      *(_QWORD *)(v3 + 32) = v6;
      ++v5;
      v8 = *(_QWORD *)(v3 + 40);
      if ( v8 )
      {
        --*(_DWORD *)(v8 + 104);
        ++*(_DWORD *)(v8 + 108);
      }
      if ( v4 == v5 )
        break;
      LODWORD(v7) = OSMetaClassBase::safeMetaCast(*(_QWORD *)(v3 + 104), AppleUHCIIsochTransferDescriptor::metaClass);
      v6 = v3;
      v3 = v7;
    }
    *((_DWORD *)this + 2345) = v4;
    if ( v3 )
    {
      do
      {
        LODWORD(v9) = OSMetaClassBase::safeMetaCast(*(_QWORD *)(v3 + 32), AppleUHCIIsochTransferDescriptor::metaClass);
        v10 = v9;
        *(_QWORD *)(v3 + 32) = 0LL;
        v11 = *(_QWORD *)(v3 + 40);
        if ( v11 )
          --*(_DWORD *)(v11 + 108);
        AppleUSBUHCI::scavengeAnIsochTD(this, (AppleUHCIIsochTransferDescriptor *)v3);
        v3 = v10;
      }
      while ( v10 );
    }
  }
  v12 = *(_QWORD *)(*((_QWORD *)this + 54) + 136LL);
  if ( v12 )
  {
    v13 = off_D080[0];
    v14 = off_D090[0];
    do
    {
      if ( *(_DWORD *)(v12 + 108) && *(_BYTE *)v13 & 2 && *(_DWORD *)v14 & 0xFFFFFFF7 )
        kernel_debug(0x52D2C0Cu, (uintptr_t)this, v12, *(_DWORD *)(v12 + 108), 0LL, 0LL);
      (*(void (__fastcall **)(AppleUSBUHCI *, uintptr_t))(*(_QWORD *)this + 2840LL))(this, v12);
      AppleUSBUHCI::AddIsochFramesToSchedule((uintptr_t)this, (IOUSBControllerIsochEndpoint *)v12);
      v12 = *(_QWORD *)(v12 + 16);
    }
    while ( v12 );
  }
  return 0LL;
}
// D080: using guessed type __int64 off_D080[4];
// D090: using guessed type __int64 off_D090[2];
// EF18: using guessed type _QWORD AppleUHCIIsochTransferDescriptor::metaClass;
// 20D90: using guessed type int __fastcall IOSimpleLockLock(_QWORD);
// 20DA0: using guessed type int __fastcall IOSimpleLockUnlock(_QWORD);
// 211C8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);
// 21C68: using guessed type int __fastcall ml_set_interrupts_enabled(_QWORD);

//----- (000000000000842E) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::scavengeQueueHeads(AppleUSBUHCI *this, IOUSBControllerListElement *a2)
{
  IOUSBControllerListElement *v2; // r15@1
  AppleUHCITransferDescriptor *v3; // r12@2
  __int64 v4; // rbx@2
  __int64 v5; // r13@2
  __int64 v6; // rax@3
  AppleUHCIQueueHead *v7; // rdx@3
  AppleUHCITransferDescriptor *v8; // rcx@6
  AppleUHCITransferDescriptor *v9; // r8@6
  AppleUHCITransferDescriptor *v10; // rax@6
  AppleUHCIQueueHead *v11; // ST28_8@8
  AppleUHCITransferDescriptor *v12; // r14@8
  AppleUHCITransferDescriptor *v13; // ST10_8@8
  int v14; // er14@11
  int v15; // er14@12
  unsigned int v16; // er14@14
  unsigned __int16 v17; // r13@14
  char v18; // al@15
  int v19; // er14@23
  uintptr_t v20; // rsi@23
  __int64 v21; // r14@26
  uintptr_t v22; // rax@27
  uintptr_t v23; // rbx@27
  __int64 v24; // rax@28
  __int64 v25; // rax@32
  signed __int64 v26; // rcx@32
  __int64 v27; // rdx@32
  __int64 v28; // rax@37
  __int64 v29; // r9@39
  AppleUHCITransferDescriptor *v30; // rax@47
  AppleUHCITransferDescriptor *v31; // rax@53
  AppleUHCITransferDescriptor *v32; // r14@57
  int v33; // ebx@58
  AppleUHCITransferDescriptor *v34; // rax@58
  AppleUHCITransferDescriptor *v35; // r14@60
  __int64 v36; // rax@61
  AppleUHCITransferDescriptor *v37; // rax@62
  int v38; // ST68_4@64
  __int64 v39; // rax@64
  bool v40; // zf@65
  bool v41; // cf@75
  AppleUHCITransferDescriptor *v43; // [sp+0h] [bp-A0h]@12
  AppleUHCITransferDescriptor *v44; // [sp+8h] [bp-98h]@2
  AppleUHCITransferDescriptor *v45; // [sp+10h] [bp-90h]@12
  AppleUHCITransferDescriptor *v46; // [sp+10h] [bp-90h]@57
  char *v47; // [sp+18h] [bp-88h]@2
  char v48; // [sp+24h] [bp-7Ch]@11
  AppleUHCIQueueHead *v49; // [sp+28h] [bp-78h]@12
  AppleUHCITransferDescriptor *v50; // [sp+38h] [bp-68h]@6
  char v51; // [sp+44h] [bp-5Ch]@12
  unsigned __int8 v52; // [sp+54h] [bp-4Ch]@12
  __int64 v53; // [sp+60h] [bp-40h]@14
  __int64 v54; // [sp+68h] [bp-38h]@14
  int v55; // [sp+70h] [bp-30h]@14
  int v56; // [sp+70h] [bp-30h]@57

  v2 = a2;
  if ( !a2 )
    return 0LL;
  v47 = (char *)this + 768;
  v44 = 0LL;
  v3 = 0LL;
  LODWORD(v4) = 0;
  v5 = 0LL;
  do
  {
    v41 = (unsigned int)v4 < 0x249EF;
    v40 = (_DWORD)v4 == 149999;
    v4 = (unsigned int)(v4 + 1);
    if ( !v41 && !v40 )
      break;
    LODWORD(v6) = OSMetaClassBase::safeMetaCast(v2, AppleUHCIQueueHead::metaClass);
    v7 = (AppleUHCIQueueHead *)v6;
    if ( !v6 || *(_BYTE *)(v6 + 51) == 221 || *(_BYTE *)(v6 + 53) )
      goto LABEL_69;
    v9 = *(AppleUHCITransferDescriptor **)(v6 + 64);
    v50 = v9;
    v10 = *(AppleUHCITransferDescriptor **)(v6 + 56);
    v8 = v10;
    if ( (v9 == 0LL || v10 == 0LL) && v10 != v9 )
    {
      v11 = v7;
      v12 = v9;
      v13 = v10;
      KernelDebugLogInternal(
        1LL,
        1431519814LL,
        "The UHCI driver found a device queue with invalid head (%p) or tail (%p)");
      v8 = v13;
      v9 = v12;
      v7 = v11;
      v10 = (AppleUHCITransferDescriptor *)*((_QWORD *)v11 + 7);
    }
    if ( !v10 || v10 == v9 )
      goto LABEL_69;
    v48 = 0;
    v14 = 0;
    do
    {
      v45 = v8;
      v49 = v7;
      v43 = v3;
      v15 = v14 + 1;
      v51 = 0;
      v3 = v10;
      v52 = 0;
      while ( 1 )
      {
        if ( (unsigned int)(v15 - 1) > 0x249EF )
          goto LABEL_68;
        v55 = v15;
        v54 = v5;
        v53 = v4;
        v16 = *(_DWORD *)(AppleUHCITransferDescriptor::GetSharedLogical(v3) + 4);
        v17 = (v16 + 1) & 0x7FF;
        if ( !((v52 | (unsigned __int8)v51) & 1) )
        {
          v18 = v48 & 1;
          if ( v16 & 0x800000 )
          {
            if ( v18 )
              (*(void (__fastcall **)(AppleUHCITransferDescriptor *, signed __int64))(*(_QWORD *)v3 + 304LL))(v3, 7LL);
            v3 = v43;
            v5 = v54;
            goto LABEL_69;
          }
          if ( !v18 )
          {
            (*(void (__fastcall **)(AppleUHCIQueueHead *, signed __int64))(*(_QWORD *)v49 + 304LL))(v49, 7LL);
            (*(void (__fastcall **)(AppleUHCITransferDescriptor *, signed __int64))(*(_QWORD *)v3 + 304LL))(v3, 7LL);
            v48 = 1;
          }
          v52 = (v16 >> 22) & 1;
          if ( _bittest(&v16, 0x16u) )
          {
            *((_BYTE *)v49 + 53) = 1;
          }
          else if ( v16 & 0x20000000
                 && v17 < (((unsigned __int16)(*(_DWORD *)(AppleUHCITransferDescriptor::GetSharedLogical(v3) + 8) >> 21)
                          + 1) & 0x7FFu) )
          {
            v54 = *(_DWORD *)(AppleUHCITransferDescriptor::GetSharedLogical(v3) + 8) & 0x80000;
            v51 = 1;
          }
        }
        v19 = v55;
        v20 = *((_QWORD *)v3 + 5);
        if ( v20 )
        {
          if ( *((_WORD *)v3 + 42) && v17 )
          {
            v21 = *((_QWORD *)v3 + 6);
            if ( !v21 )
            {
              KernelDebugLogInternal(
                1LL,
                1431519814LL,
                "AppleUSBUHCI::scavengeQueueHeads - ERROR - missing usbcommand!!");
              goto LABEL_41;
            }
            LODWORD(v22) = OSMetaClassBase::safeMetaCast(
                             *(_QWORD *)(*(_QWORD *)(v21 + 216) + 48LL),
                             &AppleUSBUHCIDMACommand::gMetaClass);
            v23 = v22;
            if ( !v22
              || (LODWORD(v24) = (*(int (__fastcall **)(uintptr_t, _QWORD *))(*(_QWORD *)v22 + 312LL))(
                                   v22,
                                   &AppleUSBUHCIDMACommand::gMetaClass),
                  !v24) )
            {
              v29 = *(_QWORD *)(*(_QWORD *)(v21 + 216) + 48LL);
              KernelDebugLogInternal(
                1LL,
                1431519814LL,
                "AppleUSBUHCI::scavengeQueueHeads - ERROR - TD (%p) missing or empty dmaCommand (%p) or (%p)");
LABEL_41:
              v19 = v55;
              goto LABEL_46;
            }
            v19 = v55;
            if ( *(_BYTE *)off_D080[0] & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
              kernel_debug(0x52D2C10u, *((_QWORD *)v3 + 5), v23, v17, 2uLL, 0LL);
            v25 = *((_QWORD *)v3 + 5);
            *(_QWORD *)(v25 + 48) = v17;
            v26 = v23 + 120;
            v27 = *(_QWORD *)(v23 + 128);
            if ( v23 + 120 == v27 )
              *(_QWORD *)v26 = v25;
            else
              *(_QWORD *)(v27 + 80) = v25;
            *(_QWORD *)(v25 + 88) = v27;
            *(_QWORD *)(v25 + 80) = v26;
            *(_QWORD *)(v23 + 128) = v25;
            *((_QWORD *)v3 + 5) = 0LL;
          }
          else
          {
            if ( *(_BYTE *)off_D080[0] & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
            {
              kernel_debug(0x52D2C10u, v20, *((_WORD *)v3 + 42), v17, 1uLL, 0LL);
              v20 = *((_QWORD *)v3 + 5);
            }
            v28 = *((_QWORD *)this + 97);
            if ( v47 == (char *)v28 )
              *(_QWORD *)v47 = v20;
            else
              *(_QWORD *)(v28 + 80) = v20;
            *(_QWORD *)(v20 + 88) = v28;
            *(_QWORD *)(v20 + 80) = v47;
            *((_QWORD *)this + 97) = v20;
            *((_QWORD *)v3 + 5) = 0LL;
          }
        }
LABEL_46:
        if ( *((_BYTE *)v3 + 72) )
          break;
        LODWORD(v30) = OSMetaClassBase::safeMetaCast(*((_QWORD *)v3 + 4), AppleUHCITransferDescriptor::metaClass);
        v3 = v30;
        v4 = v53;
        v5 = v54;
        if ( !v30 )
        {
          KernelDebugLogInternal(1LL, 1431519814LL, "The UHCI driver found a NULL Transfer Descriptor");
LABEL_68:
          v3 = v43;
          goto LABEL_69;
        }
        v15 = v19 + 1;
        (*(void (__fastcall **)(AppleUHCITransferDescriptor *, signed __int64))(*(_QWORD *)v30 + 304LL))(v30, 7LL);
        if ( v3 == v50 )
          goto LABEL_68;
      }
      (*(void (__fastcall **)(AppleUHCITransferDescriptor *, signed __int64))(*(_QWORD *)v3 + 304LL))(v3, 7LL);
      v4 = v53;
      v5 = v54;
      if ( v44 )
        *((_QWORD *)v43 + 4) = v45;
      else
        v44 = v45;
      LODWORD(v31) = OSMetaClassBase::safeMetaCast(*((_QWORD *)v3 + 4), AppleUHCITransferDescriptor::metaClass);
      *((_QWORD *)v3 + 4) = 0LL;
      if ( !v31 )
      {
        KernelDebugLogInternal(1LL, 1431519814LL, "The UHCI driver found a NULL Transfer Descriptor");
        break;
      }
      if ( v52 & 1 || !(v51 & 1) )
      {
        v56 = v19;
        v35 = v31;
        v7 = v49;
        if ( v52 & 1 )
        {
          v36 = AppleUHCIQueueHead::GetSharedLogical(v49);
          v7 = v49;
          *(_DWORD *)(v36 + 4) = 1;
        }
        v37 = v50;
        v8 = v35;
      }
      else
      {
        if ( *((_BYTE *)v49 + 51) )
        {
          v56 = v19;
          v46 = v31;
          v32 = v31;
          if ( (*(_DWORD *)(AppleUHCITransferDescriptor::GetSharedLogical(v31) + 8) & 0x80000) == (_DWORD)v54 )
          {
            do
            {
              v5 = (unsigned int)((_DWORD)v5 == 0) << 19;
              v33 = v5 | *(_DWORD *)(AppleUHCITransferDescriptor::GetSharedLogical(v32) + 8) & 0xFFF7FFFF;
              *(_DWORD *)(AppleUHCITransferDescriptor::GetSharedLogical(v32) + 8) = v33;
              LODWORD(v34) = OSMetaClassBase::safeMetaCast(*((_QWORD *)v32 + 4), AppleUHCITransferDescriptor::metaClass);
              v32 = v34;
            }
            while ( v34 );
          }
        }
        else
        {
          v56 = v19;
          v46 = v31;
        }
        v38 = (*(int (__fastcall **)(AppleUHCITransferDescriptor *))(*(_QWORD *)v46 + 296LL))(v46);
        v39 = AppleUHCIQueueHead::GetSharedLogical(v49);
        v8 = v46;
        v7 = v49;
        *(_DWORD *)(v39 + 4) = v38;
        v4 = v53;
        v37 = v50;
      }
      *((_QWORD *)v7 + 7) = v8;
      v40 = v8 == v37;
      v10 = v8;
      v14 = v56;
    }
    while ( !v40 );
LABEL_69:
    v2 = (IOUSBControllerListElement *)*((_QWORD *)v2 + 4);
  }
  while ( v2 );
  if ( v44 )
    AppleUSBUHCI::UHCIUIMDoDoneQueueProcessing(this, v44, 0, 0LL);
  if ( (unsigned int)v4 >= 0x3E9 && *(_BYTE *)off_D080[0] & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D2C10u, (uintptr_t)this, (unsigned int)v4, 0LL, 0LL, 0LL);
  return 0LL;
}
// D080: using guessed type __int64 off_D080[4];
// D090: using guessed type __int64 off_D090[2];
// EA80: using guessed type _QWORD AppleUHCIQueueHead::metaClass;
// ECC8: using guessed type _QWORD AppleUHCITransferDescriptor::metaClass;
// F418: using guessed type _QWORD AppleUSBUHCIDMACommand::gMetaClass;
// 20DB0: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);
// 211C8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000008AAE) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::scavengeAnIsochTD(AppleUSBUHCI *this, AppleUHCIIsochTransferDescriptor *a2)
{
  __int64 v2; // r15@1
  uint64_t v3; // rax@1
  __int64 v4; // rcx@5

  v2 = *((_QWORD *)a2 + 5);
  v3 = mach_absolute_time();
  if ( v2 )
  {
    if ( !*((_BYTE *)a2 + 80) )
      (*(void (__fastcall **)(AppleUHCIIsochTransferDescriptor *, uint64_t))(*(_QWORD *)a2 + 312LL))(a2, v3);
    (*(void (__fastcall **)(AppleUSBUHCI *, __int64, AppleUHCIIsochTransferDescriptor *, signed __int64))(*(_QWORD *)this + 2824LL))(
      this,
      v2,
      a2,
      1LL);
  }
  else
  {
    v4 = *((_QWORD *)a2 + 5);
    KernelDebugLogInternal(
      1LL,
      1431519814LL,
      "AppleUSBUHCI::scavengeAnIsochTD - could not find endpoint associated with iTD (%p)");
  }
  return 0LL;
}
// 20DB0: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (0000000000008B24) ----------------------------------------------------
int __fastcall AppleUSBUHCI::PutTDonDoneQueue(AppleUSBUHCI *this, IOUSBControllerIsochEndpoint *a2, IOUSBControllerIsochListElement *a3, unsigned __int8 a4)
{
  unsigned __int8 v4; // r15@1
  IOUSBControllerIsochListElement *v5; // rbx@1
  IOUSBControllerIsochEndpoint *v6; // r14@1
  AppleUSBUHCI *v7; // r12@1
  __int64 v8; // rax@1
  __int64 v9; // rcx@2
  __int64 v10; // rdx@4
  signed __int64 v11; // rsi@5
  __int64 v12; // rdi@5
  char *v13; // rdx@7
  __int64 v14; // rsi@7

  v4 = a4;
  v5 = a3;
  v6 = a2;
  v7 = this;
  LODWORD(v8) = OSMetaClassBase::safeMetaCast(a3, AppleUHCIIsochTransferDescriptor::metaClass);
  if ( v8 )
  {
    v9 = *(_QWORD *)(v8 + 112);
    if ( v9 )
    {
      if ( *((_BYTE *)a2 + 128) )
      {
        v10 = *(_QWORD *)(v9 + 64);
        if ( v10 )
        {
          v11 = v10 + 120;
          v12 = *(_QWORD *)(v10 + 128);
          if ( v10 + 120 == v12 )
            *(_QWORD *)v11 = v9;
          else
            *(_QWORD *)(v12 + 80) = v9;
          *(_QWORD *)(v9 + 88) = v12;
          *(_QWORD *)(v9 + 80) = v11;
          *(_QWORD *)(v10 + 128) = v9;
        }
      }
      else
      {
        v13 = (char *)this + 784;
        v14 = *((_QWORD *)this + 99);
        if ( (AppleUSBUHCI *)((char *)this + 784) == (AppleUSBUHCI *)v14 )
          *(_QWORD *)v13 = v9;
        else
          *(_QWORD *)(v14 + 80) = v9;
        *(_QWORD *)(v9 + 88) = v14;
        *(_QWORD *)(v9 + 80) = v13;
        *((_QWORD *)this + 99) = v9;
        --*((_DWORD *)this + 201);
      }
      *(_QWORD *)(v8 + 112) = 0LL;
    }
  }
  return (*(int (__fastcall **)(AppleUSBUHCI *, IOUSBControllerIsochEndpoint *, IOUSBControllerIsochListElement *, _QWORD))(off_D068[0] + 2840))(
           v7,
           v6,
           v5,
           v4);
}
// D068: using guessed type __int64 off_D068[7];
// EF18: using guessed type _QWORD AppleUHCIIsochTransferDescriptor::metaClass;
// 211C8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000008BFC) ----------------------------------------------------
char *__fastcall AppleUSBUHCI::ReleaseIsochAlignmentBuffer(AppleUSBUHCI *this, UHCIAlignmentBuffer *a2)
{
  char *result; // rax@1
  __int64 v3; // rcx@1

  result = (char *)this + 784;
  v3 = *((_QWORD *)this + 99);
  if ( (AppleUSBUHCI *)((char *)this + 784) == (AppleUSBUHCI *)v3 )
    *(_QWORD *)result = a2;
  else
    *(_QWORD *)(v3 + 80) = a2;
  *((_QWORD *)a2 + 11) = v3;
  *((_QWORD *)a2 + 10) = result;
  *((_QWORD *)this + 99) = a2;
  --*((_DWORD *)this + 201);
  return result;
}

//----- (0000000000008C34) ----------------------------------------------------
char *__fastcall AppleUSBUHCI::ReleaseCBIAlignmentBuffer(AppleUSBUHCI *this, UHCIAlignmentBuffer *a2)
{
  char *result; // rax@1
  __int64 v3; // rcx@1

  result = (char *)this + 768;
  v3 = *((_QWORD *)this + 97);
  if ( (AppleUSBUHCI *)((char *)this + 768) == (AppleUSBUHCI *)v3 )
    *(_QWORD *)result = a2;
  else
    *(_QWORD *)(v3 + 80) = a2;
  *((_QWORD *)a2 + 11) = v3;
  *((_QWORD *)a2 + 10) = result;
  *((_QWORD *)this + 97) = a2;
  return result;
}

//----- (0000000000008C66) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::UHCIUIMDoDoneQueueProcessing(AppleUSBUHCI *this, AppleUHCITransferDescriptor *a2, unsigned int a3, AppleUHCITransferDescriptor *a4)
{
  unsigned int v4; // er12@1
  AppleUHCITransferDescriptor *v5; // rbx@1
  AppleUSBUHCI *v6; // r14@1
  int v7; // er15@3
  AppleUSBUHCI *v8; // r13@4
  AppleUHCITransferDescriptor *v9; // rax@4
  int v10; // er15@4
  unsigned int v11; // er14@4
  unsigned int v12; // eax@6
  __int64 v13; // rdx@7
  __int64 v14; // rsi@13
  int v15; // eax@14
  int v16; // eax@15
  int v17; // eax@16
  unsigned int v19; // [sp+1Ch] [bp-84h]@3
  unsigned int v20; // [sp+2Ch] [bp-74h]@1
  AppleUHCITransferDescriptor *v21; // [sp+30h] [bp-70h]@1
  AppleUHCITransferDescriptor *v22; // [sp+38h] [bp-68h]@4
  int v23; // [sp+44h] [bp-5Ch]@4
  __int64 v24; // [sp+60h] [bp-40h]@12
  __int64 v25; // [sp+68h] [bp-38h]@12

  v21 = a4;
  v4 = a3;
  v20 = a3;
  v5 = a2;
  v6 = this;
  if ( a2 && a2 != a4 )
  {
    v7 = 0;
    v19 = 0;
    while ( 1 )
    {
      v23 = v7;
      v8 = v6;
      LODWORD(v9) = OSMetaClassBase::safeMetaCast(*((_QWORD *)v5 + 4), AppleUHCITransferDescriptor::metaClass);
      v22 = v9;
      v10 = *(_DWORD *)(AppleUHCITransferDescriptor::GetSharedLogical(v5) + 4);
      v11 = *(_DWORD *)(AppleUHCITransferDescriptor::GetSharedLogical(v5) + 8);
      if ( !v4 )
      {
        v4 = v19;
        if ( !v19 )
        {
          v12 = AppleUSBUHCI::TDToUSBError(v8, v10);
          v19 = 0;
          v4 = 0;
          if ( v12 )
          {
            v4 = v12;
            (*(void (__fastcall **)(AppleUHCITransferDescriptor *, signed __int64))(*(_QWORD *)v5 + 304LL))(v5, 4LL);
            if ( *(_DWORD *)(AppleUHCITransferDescriptor::GetSharedLogical(v5) + 4) & 0x100000 )
              (*(void (__cdecl **)(AppleUSBUHCI *, signed __int64, __int64))(*(_QWORD *)v8 + 2248LL))(v8, 4LL, v13);
            v19 = v4;
          }
        }
      }
      v7 = (((v11 >> 21) + 1) & 0x7FF) - (((_WORD)v10 + 1) & 0x7FF) + v23;
      if ( *((_BYTE *)v5 + 72) )
      {
        v6 = v8;
        if ( *((_QWORD *)v5 + 6) )
        {
          IOUSBCommand::GetUSLCompletion((IOUSBCommand *)&v24);
          if ( v25 )
          {
            *((_BYTE *)v5 + 72) = 0;
            v14 = v4;
            IOUSBController::Complete(v8, v4, (unsigned int)v7);
            v19 = 0;
            if ( (unsigned __int8)(*(_BYTE *)(*((_QWORD *)v5 + 8) + 51LL) | 2) == 2 )
            {
              v15 = *((_DWORD *)v8 + 2323);
              v4 = v20;
              if ( v15 )
              {
                v16 = v15 - 1;
                *((_DWORD *)v8 + 2323) = v16;
                if ( !v16 )
                {
                  v17 = (*(int (__fastcall **)(_QWORD, __int64))(**((_QWORD **)v8 + 1137) + 288LL))(
                          *((_QWORD *)v8 + 1137),
                          v14);
                  (*(void (__fastcall **)(_QWORD, signed __int64))(**((_QWORD **)v8 + 1137) + 280LL))(
                    *((_QWORD *)v8 + 1137),
                    (v17 & 0xFFFFFFFE) + 1LL);
                }
              }
              else
              {
                v19 = 0;
                KernelDebugLogInternal(
                  1LL,
                  1431519814LL,
                  "AppleUSBUHCI::UHCIUIMDoDoneQueueProcessing - _controlBulkTransactionsOut underrun!");
              }
              v7 = 0;
              goto LABEL_24;
            }
            v7 = 0;
          }
          else
          {
            KernelDebugLogInternal(
              1LL,
              1431519814LL,
              "The UHCI driver has detected an error [completion.action == NULL]");
          }
        }
        else
        {
          KernelDebugLogInternal(
            1LL,
            1431519814LL,
            "AppleUSBUHCI::UHCIUIMDoDoneQueueProcessing pHCDoneTD->command is NULL (%p)");
        }
        v4 = v20;
      }
      else
      {
        v4 = v20;
        v6 = v8;
      }
LABEL_24:
      *((_QWORD *)v5 + 7) = 0LL;
      AppleUSBUHCI::DeallocateTD(v6, v5);
      if ( v22 )
      {
        v5 = v22;
        if ( v22 != v21 )
          continue;
      }
      return 0LL;
    }
  }
  return 0LL;
}
// ECC8: using guessed type _QWORD AppleUHCITransferDescriptor::metaClass;
// 20DB0: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);
// 211C0: using guessed type int __fastcall IOUSBController::Complete(_QWORD, _QWORD, _QWORD);
// 211C8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000008EF6) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::DeallocateTD(AppleUSBUHCI *this, AppleUHCITransferDescriptor *a2)
{
  __int64 v2; // rax@1

  OSMetaClassBase::safeMetaCast(*((_QWORD *)a2 + 8), AppleUHCIQueueHead::metaClass);
  *(_DWORD *)(AppleUHCITransferDescriptor::GetSharedLogical(a2) + 4) = 0;
  *((_QWORD *)a2 + 4) = 0LL;
  v2 = *((_QWORD *)this + 1152);
  if ( v2 )
  {
    *(_QWORD *)(v2 + 32) = a2;
    *((_QWORD *)this + 1152) = a2;
  }
  else
  {
    *((_QWORD *)this + 1152) = a2;
    *((_QWORD *)this + 1151) = a2;
  }
  return 0LL;
}
// EA80: using guessed type _QWORD AppleUHCIQueueHead::metaClass;
// 211C8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000008F5C) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::ReturnIsochDoneQueue(AppleUSBUHCI *this, IOUSBControllerIsochEndpoint *a2)
{
  __int64 result; // rax@1

  (*(void (__fastcall **)(AppleUSBUHCI *, IOUSBControllerIsochEndpoint *))(off_D068[0] + 2856))(this, a2);
  result = *((_QWORD *)this + 21);
  if ( !*(_DWORD *)(result + 188) )
    *((_WORD *)this + 4644) = 1025;
  return result;
}
// D068: using guessed type __int64 off_D068[7];

//----- (0000000000008F92) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::AllocateITD(AppleUSBUHCI *this, unsigned __int64 a2)
{
  __int64 v2; // r12@1
  __int64 v3; // rax@2
  AppleUHCItdMemoryBlock *v4; // r15@2
  unsigned int v5; // er13@3
  __int64 v6; // rbx@3
  __int64 v7; // r12@3
  unsigned __int64 v8; // rax@3
  __int64 v9; // rax@3
  unsigned int v10; // ebx@4
  __int64 v11; // r12@5
  unsigned __int64 v12; // rax@5
  __int64 v13; // rax@10

  v2 = *((_QWORD *)this + 1153);
  if ( v2 )
    goto LABEL_10;
  v3 = AppleUHCItdMemoryBlock::NewMemoryBlock(this, a2);
  v4 = (AppleUHCItdMemoryBlock *)v3;
  if ( !v3 )
  {
    v6 = 0LL;
    KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBUHCI::AllocateITD - unable to allocate a new memory block!");
    return v6;
  }
  AppleUHCItdMemoryBlock::SetNextBlock((AppleUHCItdMemoryBlock *)v3, *((AppleUHCItdMemoryBlock **)this + 1156));
  *((_QWORD *)this + 1156) = v4;
  v5 = AppleUHCItdMemoryBlock::NumTDs(v4);
  v6 = 0LL;
  v7 = AppleUHCItdMemoryBlock::GetLogicalPtr(v4, 0);
  v8 = AppleUHCItdMemoryBlock::GetPhysicalPtr(v4, 0);
  v9 = AppleUHCIIsochTransferDescriptor::WithSharedMemory(v7, v8);
  *((_QWORD *)this + 1154) = v9;
  *((_QWORD *)this + 1153) = v9;
  if ( v5 >= 2 )
  {
    v10 = 1;
    while ( 1 )
    {
      v11 = AppleUHCItdMemoryBlock::GetLogicalPtr(v4, v10);
      v12 = AppleUHCItdMemoryBlock::GetPhysicalPtr(v4, v10);
      v2 = AppleUHCIIsochTransferDescriptor::WithSharedMemory(v11, v12);
      if ( !v2 )
        break;
      *(_QWORD *)(v2 + 32) = *((_QWORD *)this + 1153);
      *((_QWORD *)this + 1153) = v2;
      ++v10;
      if ( v10 >= v5 )
        goto LABEL_10;
    }
    v6 = 0LL;
    KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBUHCI::AllocateITD - hmm. ran out of TDs in a memory block");
    v2 = *((_QWORD *)this + 1153);
    if ( v2 )
    {
LABEL_10:
      LODWORD(v13) = OSMetaClassBase::safeMetaCast(*(_QWORD *)(v2 + 32), AppleUHCIIsochTransferDescriptor::metaClass);
      *((_QWORD *)this + 1153) = v13;
      if ( !v13 )
        *((_QWORD *)this + 1154) = 0LL;
      *(_QWORD *)(v2 + 32) = 0LL;
      *(_QWORD *)(v2 + 112) = 0LL;
      *(_DWORD *)(AppleUHCIIsochTransferDescriptor::GetSharedLogical((AppleUHCIIsochTransferDescriptor *)v2) + 4) = 0;
      (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v2 + 280LL))(v2, 0LL);
      *(_DWORD *)(AppleUHCIIsochTransferDescriptor::GetSharedLogical((AppleUHCIIsochTransferDescriptor *)v2) + 8) = 0;
      *(_DWORD *)(AppleUHCIIsochTransferDescriptor::GetSharedLogical((AppleUHCIIsochTransferDescriptor *)v2) + 12) = 0;
      v6 = v2;
    }
  }
  return v6;
}
// EF18: using guessed type _QWORD AppleUHCIIsochTransferDescriptor::metaClass;
// 20DB0: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);
// 211C8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000009140) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::DeallocateITD(AppleUSBUHCI *this, AppleUHCIIsochTransferDescriptor *a2)
{
  __int64 v2; // rax@2
  char *v3; // rcx@2
  __int64 v4; // rdx@2
  __int64 v5; // rax@6

  *(_DWORD *)(AppleUHCIIsochTransferDescriptor::GetSharedLogical(a2) + 4) = 0;
  *((_QWORD *)a2 + 4) = 0LL;
  if ( *((_QWORD *)a2 + 14) )
  {
    KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBUHCI::DeallocateITD - UNEXPECTED alignment buffer %p");
    v2 = *((_QWORD *)a2 + 14);
    v3 = (char *)this + 784;
    v4 = *((_QWORD *)this + 99);
    if ( (AppleUSBUHCI *)((char *)this + 784) == (AppleUSBUHCI *)v4 )
      *(_QWORD *)v3 = v2;
    else
      *(_QWORD *)(v4 + 80) = v2;
    *(_QWORD *)(v2 + 88) = v4;
    *(_QWORD *)(v2 + 80) = v3;
    *((_QWORD *)this + 99) = v2;
    --*((_DWORD *)this + 201);
    *((_QWORD *)a2 + 14) = 0LL;
  }
  v5 = *((_QWORD *)this + 1154);
  if ( v5 )
  {
    *(_QWORD *)(v5 + 32) = a2;
    *((_QWORD *)this + 1154) = a2;
  }
  else
  {
    *((_QWORD *)this + 1154) = a2;
    *((_QWORD *)this + 1153) = a2;
  }
  return 0LL;
}
// 20DB0: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (00000000000091F2) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::DeallocateQH(AppleUSBUHCI *this, AppleUHCIQueueHead *a2)
{
  __int64 result; // rax@2

  *((_QWORD *)a2 + 4) = 0LL;
  if ( *((_QWORD *)this + 1157) )
  {
    result = *((_QWORD *)this + 1158);
    *(_QWORD *)(result + 32) = a2;
    *((_QWORD *)this + 1158) = a2;
  }
  else
  {
    *((_QWORD *)this + 1158) = a2;
    *((_QWORD *)this + 1157) = a2;
  }
  return result;
}

//----- (000000000000922C) ----------------------------------------------------
IOUSBControllerIsochEndpoint *__fastcall AppleUSBUHCI::AllocateIsochEP(AppleUSBUHCI *this, unsigned __int64 a2)
{
  IOUSBControllerIsochEndpoint *v2; // rbx@1

  v2 = (IOUSBControllerIsochEndpoint *)OSObject::operator new((OSObject *)&stru_68.addr, a2);
  IOUSBControllerIsochEndpoint::IOUSBControllerIsochEndpoint(v2);
  if ( v2 && !(unsigned __int8)(*(int (__fastcall **)(IOUSBControllerIsochEndpoint *))(*(_QWORD *)v2 + 136LL))(v2) )
  {
    (*(void (__fastcall **)(IOUSBControllerIsochEndpoint *))(*(_QWORD *)v2 + 40LL))(v2);
    v2 = 0LL;
  }
  return v2;
}
// 68: using guessed type section_64;

//----- (0000000000009272) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::GetLowLatencyOptionsAndPhysicalMask(AppleUSBUHCI *this, unsigned int *a2, unsigned __int64 *a3)
{
  (*(void (__fastcall **)(AppleUSBUHCI *, unsigned int *, unsigned __int64 *))(off_D068[0] + 2872))(this, a2, a3);
  *a2 = 16;
  return 0LL;
}
// D068: using guessed type __int64 off_D068[7];

//----- (0000000000009298) ----------------------------------------------------
__int64 __fastcall UHCIAlignmentBuffer::UHCIAlignmentBuffer(__int64 a1)
{
  OSObject::OSObject(a1, &UHCIAlignmentBuffer::gMetaClass);
  *(_QWORD *)a1 = off_E120;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&UHCIAlignmentBuffer::gMetaClass);
}
// E120: using guessed type __int64 (__fastcall *off_E120[2])(UHCIAlignmentBuffer *__hidden this);
// F3F0: using guessed type _QWORD UHCIAlignmentBuffer::gMetaClass;
// 21620: using guessed type int __fastcall OSObject::OSObject(_QWORD, _QWORD);

//----- (00000000000092C8) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::GetCBIAlignmentBuffer(AppleUSBUHCI *this)
{
  char *v1; // rax@1
  __int64 v2; // rbx@1
  __int64 v3; // rcx@2

  v1 = (char *)this + 768;
  v2 = *((_QWORD *)this + 96);
  if ( (AppleUSBUHCI *)((char *)this + 768) == (AppleUSBUHCI *)v2 )
  {
    v2 = 0LL;
    KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBUHCI::GetCBIAlignmentBuffer - ran out of alignment buffers");
  }
  else
  {
    v3 = *(_QWORD *)(v2 + 80);
    if ( v1 == (char *)v3 )
      *((_QWORD *)this + 97) = v1;
    else
      *(_QWORD *)(v3 + 88) = v1;
    *((_QWORD *)this + 96) = v3;
    *(_QWORD *)(v2 + 80) = 0LL;
    *(_QWORD *)(v2 + 88) = 0LL;
    *(_QWORD *)(v2 + 32) = 0LL;
    *(_QWORD *)(v2 + 40) = 0LL;
    *(_QWORD *)(v2 + 56) = this;
  }
  return v2;
}
// 20DB0: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (0000000000009348) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::GetIsochAlignmentBuffer(AppleUSBUHCI *this)
{
  char *v1; // rax@1
  __int64 v2; // rbx@1
  __int64 v3; // rcx@2
  int v4; // ecx@6
  int v5; // eax@6
  int v6; // eax@7

  v1 = (char *)this + 784;
  v2 = *((_QWORD *)this + 98);
  if ( (AppleUSBUHCI *)((char *)this + 784) == (AppleUSBUHCI *)v2 )
  {
    v2 = 0LL;
    KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBUHCI::GetIsochAlignmentBuffer - ran out of alignment buffers");
  }
  else
  {
    v3 = *(_QWORD *)(v2 + 80);
    if ( v1 == (char *)v3 )
      *((_QWORD *)this + 99) = v1;
    else
      *(_QWORD *)(v3 + 88) = v1;
    *((_QWORD *)this + 98) = v3;
    *(_QWORD *)(v2 + 80) = 0LL;
    *(_QWORD *)(v2 + 88) = 0LL;
    *(_QWORD *)(v2 + 32) = 0LL;
    *(_QWORD *)(v2 + 40) = 0LL;
    *(_QWORD *)(v2 + 56) = this;
    v4 = *((_DWORD *)this + 201);
    *((_DWORD *)this + 201) = v4 + 1;
    v5 = *((_DWORD *)this + 200);
    if ( v4 >= v5 )
    {
      v6 = v5 + 1;
      *((_DWORD *)this + 200) = v6;
      (*(void (__fastcall **)(AppleUSBUHCI *, _QWORD, _QWORD, signed __int64))(*(_QWORD *)this + 640LL))(
        this,
        "AlignmentBuffersHighWaterMark",
        v6,
        32LL);
    }
  }
  return v2;
}
// 20DB0: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (0000000000009402) ----------------------------------------------------
__int64 __fastcall UHCIAlignmentBuffer::MetaClass::MetaClass(UHCIAlignmentBuffer::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "UHCIAlignmentBuffer", off_D058[0], 96LL);
  result = (__int64)off_E250;
  *(_QWORD *)this = off_E250;
  return result;
}
// D058: using guessed type _QWORD off_D058[9];
// E250: using guessed type __int64 (__fastcall *off_E250[2])(UHCIAlignmentBuffer::MetaClass *__hidden this);
// 20E38: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000009434) ----------------------------------------------------
__int64 __fastcall UHCIAlignmentBuffer::MetaClass::~MetaClass(UHCIAlignmentBuffer::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000000943E) ----------------------------------------------------
__int64 __fastcall UHCIAlignmentBuffer::UHCIAlignmentBuffer(__int64 a1, __int64 a2)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1, a2);
  result = (__int64)off_E120;
  *(_QWORD *)a1 = off_E120;
  return result;
}
// E120: using guessed type __int64 (__fastcall *off_E120[2])(UHCIAlignmentBuffer *__hidden this);
// 21620: using guessed type int __fastcall OSObject::OSObject(_QWORD, _QWORD);

//----- (000000000000945E) ----------------------------------------------------
__int64 __fastcall UHCIAlignmentBuffer::UHCIAlignmentBuffer(__int64 a1, __int64 a2)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1, a2);
  result = (__int64)off_E120;
  *(_QWORD *)a1 = off_E120;
  return result;
}
// E120: using guessed type __int64 (__fastcall *off_E120[2])(UHCIAlignmentBuffer *__hidden this);
// 21620: using guessed type int __fastcall OSObject::OSObject(_QWORD, _QWORD);

//----- (000000000000947E) ----------------------------------------------------
__int64 __fastcall UHCIAlignmentBuffer::~UHCIAlignmentBuffer(UHCIAlignmentBuffer *this)
{
  return OSObject::~OSObject(this);
}

//----- (0000000000009488) ----------------------------------------------------
__int64 __fastcall UHCIAlignmentBuffer::~UHCIAlignmentBuffer(UHCIAlignmentBuffer *this)
{
  return OSObject::~OSObject(this);
}

//----- (0000000000009492) ----------------------------------------------------
void __fastcall UHCIAlignmentBuffer::~UHCIAlignmentBuffer(UHCIAlignmentBuffer *this)
{
  OSObject::~OSObject(this);
  OSObject::operator delete((void *)this);
}

//----- (00000000000094B4) ----------------------------------------------------
__int64 __fastcall UHCIAlignmentBuffer::getMetaClass(UHCIAlignmentBuffer *this)
{
  return (__int64)&UHCIAlignmentBuffer::gMetaClass;
}
// F3F0: using guessed type _QWORD UHCIAlignmentBuffer::gMetaClass;

//----- (00000000000094C2) ----------------------------------------------------
__int64 __fastcall UHCIAlignmentBuffer::MetaClass::MetaClass(UHCIAlignmentBuffer::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "UHCIAlignmentBuffer", off_D058[0], 96LL);
  result = (__int64)off_E250;
  *(_QWORD *)this = off_E250;
  return result;
}
// D058: using guessed type _QWORD off_D058[9];
// E250: using guessed type __int64 (__fastcall *off_E250[2])(UHCIAlignmentBuffer::MetaClass *__hidden this);
// 20E38: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000094F4) ----------------------------------------------------
__int64 __fastcall UHCIAlignmentBuffer::MetaClass::alloc(UHCIAlignmentBuffer::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&stru_20.nsects, a2);
  OSObject::OSObject(v2, &UHCIAlignmentBuffer::gMetaClass);
  *(_QWORD *)v2 = off_E120;
  OSMetaClass::instanceConstructed((OSMetaClass *)&UHCIAlignmentBuffer::gMetaClass);
  return v2;
}
// 20: using guessed type segment_command_64 stru_20;
// E120: using guessed type __int64 (__fastcall *off_E120[2])(UHCIAlignmentBuffer *__hidden this);
// F3F0: using guessed type _QWORD UHCIAlignmentBuffer::gMetaClass;
// 21620: using guessed type int __fastcall OSObject::OSObject(_QWORD, _QWORD);

//----- (0000000000009534) ----------------------------------------------------
__int64 __fastcall UHCIAlignmentBuffer::UHCIAlignmentBuffer(__int64 a1)
{
  OSObject::OSObject(a1, &UHCIAlignmentBuffer::gMetaClass);
  *(_QWORD *)a1 = off_E120;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&UHCIAlignmentBuffer::gMetaClass);
}
// E120: using guessed type __int64 (__fastcall *off_E120[2])(UHCIAlignmentBuffer *__hidden this);
// F3F0: using guessed type _QWORD UHCIAlignmentBuffer::gMetaClass;
// 21620: using guessed type int __fastcall OSObject::OSObject(_QWORD, _QWORD);

//----- (0000000000009564) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCIDMACommand::MetaClass::MetaClass(AppleUSBUHCIDMACommand::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "AppleUSBUHCIDMACommand", off_D008[0], 136LL);
  result = (__int64)off_E540;
  *(_QWORD *)this = off_E540;
  return result;
}
// D008: using guessed type _QWORD off_D008[19];
// E540: using guessed type __int64 (__fastcall *off_E540[2])(AppleUSBUHCIDMACommand::MetaClass *__hidden this);
// 20E38: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000009596) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCIDMACommand::MetaClass::~MetaClass(AppleUSBUHCIDMACommand::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (00000000000095A0) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCIDMACommand::AppleUSBUHCIDMACommand(IODMACommand *a1, const OSMetaClass *a2)
{
  __int64 result; // rax@1

  IODMACommand::IODMACommand(a1, a2);
  result = (__int64)off_E340;
  *(_QWORD *)a1 = off_E340;
  return result;
}
// E340: using guessed type __int64 (__fastcall *off_E340[2])(AppleUSBUHCIDMACommand *__hidden this);

//----- (00000000000095C0) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCIDMACommand::AppleUSBUHCIDMACommand(IODMACommand *a1, const OSMetaClass *a2)
{
  __int64 result; // rax@1

  IODMACommand::IODMACommand(a1, a2);
  result = (__int64)off_E340;
  *(_QWORD *)a1 = off_E340;
  return result;
}
// E340: using guessed type __int64 (__fastcall *off_E340[2])(AppleUSBUHCIDMACommand *__hidden this);

//----- (00000000000095E0) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCIDMACommand::~AppleUSBUHCIDMACommand(AppleUSBUHCIDMACommand *this)
{
  return IODMACommand::~IODMACommand(this);
}

//----- (00000000000095EA) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCIDMACommand::~AppleUSBUHCIDMACommand(AppleUSBUHCIDMACommand *this)
{
  return IODMACommand::~IODMACommand(this);
}

//----- (00000000000095F4) ----------------------------------------------------
void __fastcall AppleUSBUHCIDMACommand::~AppleUSBUHCIDMACommand(AppleUSBUHCIDMACommand *this)
{
  IODMACommand::~IODMACommand(this);
  OSObject::operator delete((void *)this);
}

//----- (0000000000009616) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCIDMACommand::getMetaClass(AppleUSBUHCIDMACommand *this)
{
  return (__int64)&AppleUSBUHCIDMACommand::gMetaClass;
}
// F418: using guessed type _QWORD AppleUSBUHCIDMACommand::gMetaClass;

//----- (0000000000009624) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCIDMACommand::MetaClass::MetaClass(AppleUSBUHCIDMACommand::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "AppleUSBUHCIDMACommand", off_D008[0], 136LL);
  result = (__int64)off_E540;
  *(_QWORD *)this = off_E540;
  return result;
}
// D008: using guessed type _QWORD off_D008[19];
// E540: using guessed type __int64 (__fastcall *off_E540[2])(AppleUSBUHCIDMACommand::MetaClass *__hidden this);
// 20E38: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000009656) ----------------------------------------------------
IODMACommand *__fastcall AppleUSBUHCIDMACommand::MetaClass::alloc(AppleUSBUHCIDMACommand::MetaClass *this, unsigned __int64 a2)
{
  IODMACommand *v2; // rbx@1

  v2 = (IODMACommand *)OSObject::operator new((OSObject *)&stru_68.addr, a2);
  IODMACommand::IODMACommand(v2, (const OSMetaClass *)&AppleUSBUHCIDMACommand::gMetaClass);
  *(_QWORD *)v2 = off_E340;
  OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUSBUHCIDMACommand::gMetaClass);
  return v2;
}
// 68: using guessed type section_64 stru_68;
// E340: using guessed type __int64 (__fastcall *off_E340[2])(AppleUSBUHCIDMACommand *__hidden this);
// F418: using guessed type _QWORD AppleUSBUHCIDMACommand::gMetaClass;

//----- (0000000000009696) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCIDMACommand::AppleUSBUHCIDMACommand(IODMACommand *a1)
{
  IODMACommand::IODMACommand(a1, (const OSMetaClass *)&AppleUSBUHCIDMACommand::gMetaClass);
  *(_QWORD *)a1 = off_E340;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUSBUHCIDMACommand::gMetaClass);
}
// E340: using guessed type __int64 (__fastcall *off_E340[2])(AppleUSBUHCIDMACommand *__hidden this);
// F418: using guessed type _QWORD AppleUSBUHCIDMACommand::gMetaClass;

//----- (00000000000096C6) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCIDMACommand::AppleUSBUHCIDMACommand(IODMACommand *a1)
{
  IODMACommand::IODMACommand(a1, (const OSMetaClass *)&AppleUSBUHCIDMACommand::gMetaClass);
  *(_QWORD *)a1 = off_E340;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUSBUHCIDMACommand::gMetaClass);
}
// E340: using guessed type __int64 (__fastcall *off_E340[2])(AppleUSBUHCIDMACommand *__hidden this);
// F418: using guessed type _QWORD AppleUSBUHCIDMACommand::gMetaClass;

//----- (00000000000096F6) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCIDMACommand::withSpecification(__int64 a1, unsigned __int64 a2, __int64 a3, unsigned int a4, __int64 a5)
{
  __int64 v5; // rbx@1
  __int64 v7; // [sp+20h] [bp-40h]@1
  unsigned int v8; // [sp+2Ch] [bp-34h]@1
  __int64 v9; // [sp+30h] [bp-30h]@1

  v9 = a5;
  v8 = a4;
  v7 = a3;
  v5 = OSObject::operator new((OSObject *)&stru_68.addr, a2);
  IODMACommand::IODMACommand((IODMACommand *)v5, (const OSMetaClass *)&AppleUSBUHCIDMACommand::gMetaClass);
  *(_QWORD *)v5 = off_E340;
  OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUSBUHCIDMACommand::gMetaClass);
  if ( v5 )
  {
    if ( (unsigned __int8)(*(int (__fastcall **)(__int64, __int64, _QWORD, __int64, _QWORD, __int64))(*(_QWORD *)v5 + 288LL))(
                            v5,
                            a1,
                            (unsigned __int8)a2,
                            v7,
                            v8,
                            v9) )
    {
      *(_QWORD *)(v5 + 120) = v5 + 120;
      *(_QWORD *)(v5 + 128) = v5 + 120;
    }
    else
    {
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v5 + 40LL))(v5);
      v5 = 0LL;
    }
  }
  return v5;
}
// 68: using guessed type section_64 stru_68;
// E340: using guessed type __int64 (__fastcall *off_E340[2])(AppleUSBUHCIDMACommand *__hidden this);
// F418: using guessed type _QWORD AppleUSBUHCIDMACommand::gMetaClass;

//----- (00000000000097B8) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCIDMACommand::clearMemoryDescriptor(AppleUSBUHCIDMACommand *this, unsigned __int8 a2)
{
  int v2; // er14@1
  char *v3; // r12@1
  __int64 i; // rbx@1
  __int64 v5; // rax@4
  __int64 v6; // rax@9
  signed __int64 v7; // rcx@10
  __int64 v8; // rdx@10
  signed __int64 v9; // rcx@12
  __int64 v10; // rdx@12

  v2 = (*(int (__fastcall **)(AppleUSBUHCIDMACommand *, _QWORD))(off_D060[0] + 320))(this, a2);
  v3 = (char *)this + 120;
  for ( i = *((_QWORD *)this + 15); v3 != (char *)i; i = *(_QWORD *)v3 )
  {
    v5 = *(_QWORD *)(i + 80);
    if ( v3 == (char *)v5 )
      *((_QWORD *)this + 16) = v3;
    else
      *(_QWORD *)(v5 + 88) = v3;
    *(_QWORD *)v3 = v5;
    *(_QWORD *)(i + 80) = 0LL;
    *(_QWORD *)(i + 88) = 0LL;
    if ( *(_QWORD *)(i + 48) )
      (*(void (__fastcall **)(_QWORD, _QWORD, _QWORD))(**(_QWORD **)(i + 32) + 488LL))(
        *(_QWORD *)(i + 32),
        *(_QWORD *)(i + 40),
        *(_QWORD *)(i + 24));
    v6 = *(_QWORD *)(i + 56);
    if ( *(_DWORD *)(i + 72) )
    {
      v7 = v6 + 784;
      v8 = *(_QWORD *)(v6 + 792);
      if ( v6 + 784 == v8 )
        *(_QWORD *)v7 = i;
      else
        *(_QWORD *)(v8 + 80) = i;
      *(_QWORD *)(i + 88) = v8;
      *(_QWORD *)(i + 80) = v7;
      *(_QWORD *)(v6 + 792) = i;
      --*(_DWORD *)(v6 + 804);
    }
    else
    {
      v9 = v6 + 768;
      v10 = *(_QWORD *)(v6 + 776);
      if ( v6 + 768 == v10 )
        *(_QWORD *)v9 = i;
      else
        *(_QWORD *)(v10 + 80) = i;
      *(_QWORD *)(i + 88) = v10;
      *(_QWORD *)(i + 80) = v9;
      *(_QWORD *)(v6 + 776) = i;
    }
  }
  return (unsigned int)v2;
}
// D060: using guessed type __int64 off_D060[8];

//----- (00000000000098B6) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::GetNewDMACommand(AppleUSBUHCI *this)
{
  return AppleUSBUHCIDMACommand::withSpecification(off_D018[0], 0x20uLL, 0LL, 0, 0LL);
}
// D018: using guessed type __int64 off_D018[17];

//----- (00000000000098F4) ----------------------------------------------------
int __fastcall AppleUSBUHCI::PrintFrameList(AppleUSBUHCI *this, unsigned int a2, unsigned int a3)
{
  unsigned int v3; // er14@1
  signed int v4; // ebx@1
  __int64 v5; // rax@3
  __int64 i; // r13@3
  __int64 v7; // rbx@4
  __int64 j; // r15@5

  v3 = a3;
  v4 = 1024;
  do
  {
    IOSleep(1LL);
    --v4;
  }
  while ( v4 );
  LODWORD(v5) = a2;
  for ( i = *((_QWORD *)this + a2 + 110); i; i = *(_QWORD *)(i + 32) )
  {
    (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)i + 304LL))(i, v3);
    LODWORD(v5) = OSMetaClassBase::safeMetaCast(i, AppleUHCIQueueHead::metaClass);
    v7 = v5;
    if ( v5 )
    {
      for ( j = *(_QWORD *)(v5 + 56); j && j != *(_QWORD *)(v7 + 64); j = v5 )
      {
        (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)j + 304LL))(j, v3);
        LODWORD(v5) = OSMetaClassBase::safeMetaCast(*(_QWORD *)(j + 32), AppleUHCITransferDescriptor::metaClass);
      }
    }
  }
  return v5;
}
// EA80: using guessed type _QWORD AppleUHCIQueueHead::metaClass;
// ECC8: using guessed type _QWORD AppleUHCITransferDescriptor::metaClass;
// 20DA8: using guessed type int __fastcall IOSleep(_QWORD);
// 211C8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (00000000000099B2) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::MetaClass::~MetaClass(AppleUSBUHCI::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (00000000000099BC) ----------------------------------------------------
__int64 __fastcall UHCIAlignmentBuffer::MetaClass::~MetaClass(UHCIAlignmentBuffer::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (00000000000099C6) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCIDMACommand::MetaClass::~MetaClass(AppleUSBUHCIDMACommand::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (00000000000099D0) ----------------------------------------------------
__int64 `global constructor keyed to'_a()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(&AppleUSBUHCI::gMetaClass, "AppleUSBUHCI", off_D020[0], 9464LL);
  AppleUSBUHCI::gMetaClass = off_DFD0;
  OSMetaClass::OSMetaClass(&UHCIAlignmentBuffer::gMetaClass, "UHCIAlignmentBuffer", off_D058[0], 96LL);
  UHCIAlignmentBuffer::gMetaClass = off_E250;
  OSMetaClass::OSMetaClass(&AppleUSBUHCIDMACommand::gMetaClass, "AppleUSBUHCIDMACommand", off_D008[0], 136LL);
  result = (__int64)off_E540;
  AppleUSBUHCIDMACommand::gMetaClass = off_E540;
  return result;
}
// D008: using guessed type _QWORD off_D008[19];
// D020: using guessed type _QWORD off_D020[16];
// D058: using guessed type _QWORD off_D058[9];
// DFD0: using guessed type __int64 (__fastcall *off_DFD0[2])(AppleUSBUHCI::MetaClass *__hidden this);
// E250: using guessed type __int64 (__fastcall *off_E250[2])(UHCIAlignmentBuffer::MetaClass *__hidden this);
// E540: using guessed type __int64 (__fastcall *off_E540[2])(AppleUSBUHCIDMACommand::MetaClass *__hidden this);
// F3C8: using guessed type _QWORD AppleUSBUHCI::gMetaClass;
// F3F0: using guessed type _QWORD UHCIAlignmentBuffer::gMetaClass;
// F418: using guessed type _QWORD AppleUSBUHCIDMACommand::gMetaClass;
// 20E38: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000009A60) ----------------------------------------------------
__int64 `global destructor keyed to'_a()
{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&AppleUSBUHCIDMACommand::gMetaClass);
  OSMetaClass::~OSMetaClass((OSMetaClass *)&UHCIAlignmentBuffer::gMetaClass);
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&AppleUSBUHCI::gMetaClass);
}
// F3C8: using guessed type _QWORD AppleUSBUHCI::gMetaClass;
// F3F0: using guessed type _QWORD UHCIAlignmentBuffer::gMetaClass;
// F418: using guessed type _QWORD AppleUSBUHCIDMACommand::gMetaClass;

//----- (0000000000009A90) ----------------------------------------------------
__int64 __fastcall AppleUHCItdMemoryBlock::MetaClass::MetaClass(AppleUHCItdMemoryBlock::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "AppleUHCItdMemoryBlock", off_D058[0], 48LL);
  result = (__int64)off_E770;
  *(_QWORD *)this = off_E770;
  return result;
}
// D058: using guessed type _QWORD off_D058[9];
// E770: using guessed type __int64 (__fastcall *off_E770[2])(AppleUHCItdMemoryBlock::MetaClass *__hidden this);
// 20E38: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000009AC2) ----------------------------------------------------
__int64 __fastcall AppleUHCItdMemoryBlock::MetaClass::~MetaClass(AppleUHCItdMemoryBlock::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000009ACC) ----------------------------------------------------
__int64 __fastcall AppleUHCItdMemoryBlock::AppleUHCItdMemoryBlock(__int64 a1, __int64 a2)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1, a2);
  result = (__int64)off_E640;
  *(_QWORD *)a1 = off_E640;
  return result;
}
// E640: using guessed type __int64 (__fastcall *off_E640[2])(AppleUHCItdMemoryBlock *__hidden this);
// 21620: using guessed type int __fastcall OSObject::OSObject(_QWORD, _QWORD);

//----- (0000000000009AEC) ----------------------------------------------------
__int64 __fastcall AppleUHCItdMemoryBlock::AppleUHCItdMemoryBlock(__int64 a1, __int64 a2)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1, a2);
  result = (__int64)off_E640;
  *(_QWORD *)a1 = off_E640;
  return result;
}
// E640: using guessed type __int64 (__fastcall *off_E640[2])(AppleUHCItdMemoryBlock *__hidden this);
// 21620: using guessed type int __fastcall OSObject::OSObject(_QWORD, _QWORD);

//----- (0000000000009B0C) ----------------------------------------------------
__int64 __fastcall AppleUHCItdMemoryBlock::~AppleUHCItdMemoryBlock(AppleUHCItdMemoryBlock *this)
{
  return OSObject::~OSObject(this);
}

//----- (0000000000009B16) ----------------------------------------------------
__int64 __fastcall AppleUHCItdMemoryBlock::~AppleUHCItdMemoryBlock(AppleUHCItdMemoryBlock *this)
{
  return OSObject::~OSObject(this);
}

//----- (0000000000009B20) ----------------------------------------------------
void __fastcall AppleUHCItdMemoryBlock::~AppleUHCItdMemoryBlock(AppleUHCItdMemoryBlock *this)
{
  OSObject::~OSObject(this);
  OSObject::operator delete((void *)this);
}

//----- (0000000000009B42) ----------------------------------------------------
__int64 __fastcall AppleUHCItdMemoryBlock::getMetaClass(AppleUHCItdMemoryBlock *this)
{
  return (__int64)&AppleUHCItdMemoryBlock::gMetaClass;
}
// F440: using guessed type _QWORD AppleUHCItdMemoryBlock::gMetaClass;

//----- (0000000000009B50) ----------------------------------------------------
__int64 __fastcall AppleUHCItdMemoryBlock::MetaClass::MetaClass(AppleUHCItdMemoryBlock::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "AppleUHCItdMemoryBlock", off_D058[0], 48LL);
  result = (__int64)off_E770;
  *(_QWORD *)this = off_E770;
  return result;
}
// D058: using guessed type _QWORD off_D058[9];
// E770: using guessed type __int64 (__fastcall *off_E770[2])(AppleUHCItdMemoryBlock::MetaClass *__hidden this);
// 20E38: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000009B82) ----------------------------------------------------
__int64 __fastcall AppleUHCItdMemoryBlock::MetaClass::alloc(AppleUHCItdMemoryBlock::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&stru_20.segname[8], a2);
  OSObject::OSObject(v2, &AppleUHCItdMemoryBlock::gMetaClass);
  *(_QWORD *)v2 = off_E640;
  OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUHCItdMemoryBlock::gMetaClass);
  return v2;
}
// 20: using guessed type segment_command_64 stru_20;
// E640: using guessed type __int64 (__fastcall *off_E640[2])(AppleUHCItdMemoryBlock *__hidden this);
// F440: using guessed type _QWORD AppleUHCItdMemoryBlock::gMetaClass;
// 21620: using guessed type int __fastcall OSObject::OSObject(_QWORD, _QWORD);

//----- (0000000000009BC2) ----------------------------------------------------
__int64 __fastcall AppleUHCItdMemoryBlock::AppleUHCItdMemoryBlock(__int64 a1)
{
  OSObject::OSObject(a1, &AppleUHCItdMemoryBlock::gMetaClass);
  *(_QWORD *)a1 = off_E640;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUHCItdMemoryBlock::gMetaClass);
}
// E640: using guessed type __int64 (__fastcall *off_E640[2])(AppleUHCItdMemoryBlock *__hidden this);
// F440: using guessed type _QWORD AppleUHCItdMemoryBlock::gMetaClass;
// 21620: using guessed type int __fastcall OSObject::OSObject(_QWORD, _QWORD);

//----- (0000000000009BF2) ----------------------------------------------------
__int64 __fastcall AppleUHCItdMemoryBlock::AppleUHCItdMemoryBlock(__int64 a1)
{
  OSObject::OSObject(a1, &AppleUHCItdMemoryBlock::gMetaClass);
  *(_QWORD *)a1 = off_E640;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUHCItdMemoryBlock::gMetaClass);
}
// E640: using guessed type __int64 (__fastcall *off_E640[2])(AppleUHCItdMemoryBlock *__hidden this);
// F440: using guessed type _QWORD AppleUHCItdMemoryBlock::gMetaClass;
// 21620: using guessed type int __fastcall OSObject::OSObject(_QWORD, _QWORD);

//----- (0000000000009C22) ----------------------------------------------------
__int64 __fastcall AppleUHCItdMemoryBlock::NewMemoryBlock(AppleUHCItdMemoryBlock *this, unsigned __int64 a2)
{
  __int64 v2; // r12@1
  __int64 v3; // rax@2
  unsigned __int64 v4; // r8@2
  __int64 v5; // r14@2
  __int64 v6; // rax@3
  __int64 v7; // r15@5
  signed __int64 v8; // rsi@5
  signed __int64 v9; // rsi@9
  void *v10; // rax@11
  int v12; // ebx@15
  int v13; // [sp+1Ch] [bp-34h]@1
  unsigned int v14; // [sp+20h] [bp-30h]@15
  int v15; // [sp+24h] [bp-2Ch]@17
  __int64 v16; // [sp+28h] [bp-28h]@1

  v2 = OSObject::operator new((OSObject *)&stru_20.segname[8], a2);
  OSObject::OSObject(v2, &AppleUHCItdMemoryBlock::gMetaClass);
  *(_QWORD *)v2 = off_E640;
  OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUHCItdMemoryBlock::gMetaClass);
  v16 = 0LL;
  v13 = 1;
  if ( v2 )
  {
    LODWORD(v3) = IODMACommand::withSpecification(off_D010[0], 32LL, 4096LL, 64LL, 0LL, 1LL);
    v5 = v3;
    if ( !v3 )
    {
      v7 = 0LL;
      KernelDebugLogInternal(
        1LL,
        1431519814LL,
        "AppleUHCItdMemoryBlock::NewMemoryBlock - could not create IODMACommand");
      return v7;
    }
    v6 = IOBufferMemoryDescriptor::inTaskWithPhysicalMask(
           *(IOBufferMemoryDescriptor **)off_D098,
           (task *)((char *)&dword_0 + 3),
           0x1000u,
           0xFFFFF000uLL,
           v4);
    *(_QWORD *)(v2 + 40) = v6;
    if ( v6 )
    {
      if ( (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v6 + 496LL))(v6, 0LL) )
      {
        v7 = 0LL;
        v8 = 1431519814LL;
        KernelDebugLogInternal(1LL, 1431519814LL, "AppleUHCItdMemoryBlock::NewMemoryBlock - could not prepare buffer");
LABEL_13:
        (*(void (__fastcall **)(_QWORD, signed __int64))(**(_QWORD **)(v2 + 40) + 40LL))(*(_QWORD *)(v2 + 40), v8);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 40LL))(v2);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v5 + 40LL))(v5);
        return v7;
      }
      LODWORD(v10) = (*(int (__cdecl **)(_QWORD, _QWORD))(**(_QWORD **)(v2 + 40) + 736LL))(*(_QWORD *)(v2 + 40), 0LL);
      *(_QWORD *)(v2 + 24) = v10;
      bzero(v10, 0x1000uLL);
      if ( (*(int (__fastcall **)(__int64, _QWORD, signed __int64))(*(_QWORD *)v5 + 296LL))(
             v5,
             *(_QWORD *)(v2 + 40),
             1LL) )
      {
        v7 = 0LL;
        KernelDebugLogInternal(
          1LL,
          1431519814LL,
          "AppleUHCItdMemoryBlock::NewMemoryBlock - could not set memory descriptor");
        v8 = 0LL;
        (*(void (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(v2 + 40) + 504LL))(*(_QWORD *)(v2 + 40), 0LL);
        goto LABEL_13;
      }
      v12 = (*(int (__fastcall **)(__int64, __int64 *, int *, int *))(*(_QWORD *)v5 + 344LL))(v5, &v16, &v14, &v13);
      (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v5 + 304LL))(v5, 1LL);
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v5 + 40LL))(v5);
      if ( !v12 && v13 == 1 && v15 == 4096 )
      {
        *(_QWORD *)(v2 + 16) = v14;
        return v2;
      }
      v7 = 0LL;
      KernelDebugLogInternal(
        1LL,
        1431519814LL,
        "AppleUHCItdMemoryBlock::NewMemoryBlock - could not get physical segment");
      v9 = 0LL;
      (*(void (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(v2 + 40) + 504LL))(*(_QWORD *)(v2 + 40), 0LL);
      (*(void (__cdecl **)(_QWORD, _QWORD))(**(_QWORD **)(v2 + 40) + 40LL))(*(_QWORD *)(v2 + 40), 0LL);
    }
    else
    {
      v7 = 0LL;
      v9 = 1431519814LL;
      KernelDebugLogInternal(1LL, 1431519814LL, "AppleUHCItdMemoryBlock::NewMemoryBlock, could not allocate buffer!");
    }
    (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v2 + 40LL))(v2, v9);
    return v7;
  }
  KernelDebugLogInternal(1LL, 1431519814LL, "AppleUHCItdMemoryBlock::NewMemoryBlock, constructor failed!");
  return v2;
}
// 0: using guessed type int dword_0;
// 20: using guessed type segment_command_64 stru_20;
// D010: using guessed type __int64 off_D010[18];
// D098: using guessed type __int64 off_D098;
// E640: using guessed type __int64 (__fastcall *off_E640[2])(AppleUHCItdMemoryBlock *__hidden this);
// F440: using guessed type _QWORD AppleUHCItdMemoryBlock::gMetaClass;
// 20DB0: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);
// 20E78: using guessed type int __fastcall IODMACommand::withSpecification(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 21620: using guessed type int __fastcall OSObject::OSObject(_QWORD, _QWORD);

//----- (0000000000009EA2) ----------------------------------------------------
__int64 __fastcall AppleUHCItdMemoryBlock::NumTDs(AppleUHCItdMemoryBlock *this)
{
  return 256LL;
}

//----- (0000000000009EAE) ----------------------------------------------------
__int64 __fastcall AppleUHCItdMemoryBlock::GetPhysicalPtr(AppleUHCItdMemoryBlock *this, unsigned int a2)
{
  __int64 result; // rax@1

  result = 0LL;
  if ( a2 <= 0xFF )
    result = *((_QWORD *)this + 2) + 16LL * a2;
  return result;
}

//----- (0000000000009EC8) ----------------------------------------------------
__int64 __fastcall AppleUHCItdMemoryBlock::GetLogicalPtr(AppleUHCItdMemoryBlock *this, unsigned int a2)
{
  __int64 result; // rax@1

  result = 0LL;
  if ( a2 <= 0xFF )
    result = *((_QWORD *)this + 3) + 16LL * a2;
  return result;
}

//----- (0000000000009EE2) ----------------------------------------------------
__int64 __fastcall AppleUHCItdMemoryBlock::GetNextBlock(AppleUHCItdMemoryBlock *this)
{
  return *((_QWORD *)this + 4);
}

//----- (0000000000009EEC) ----------------------------------------------------
void __fastcall AppleUHCItdMemoryBlock::SetNextBlock(AppleUHCItdMemoryBlock *this, AppleUHCItdMemoryBlock *a2)
{
  *((_QWORD *)this + 4) = a2;
}

//----- (0000000000009EF6) ----------------------------------------------------
__int64 __fastcall AppleUHCItdMemoryBlock::MetaClass::~MetaClass(AppleUHCItdMemoryBlock::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000009F00) ----------------------------------------------------
__int64 `global constructor keyed to'_a_0()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(&AppleUHCItdMemoryBlock::gMetaClass, "AppleUHCItdMemoryBlock", off_D058[0], 48LL);
  result = (__int64)off_E770;
  AppleUHCItdMemoryBlock::gMetaClass = off_E770;
  return result;
}
// D058: using guessed type _QWORD off_D058[9];
// E770: using guessed type __int64 (__fastcall *off_E770[2])(AppleUHCItdMemoryBlock::MetaClass *__hidden this);
// F440: using guessed type _QWORD AppleUHCItdMemoryBlock::gMetaClass;
// 20E38: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000009F40) ----------------------------------------------------
__int64 `global destructor keyed to'_a_0()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&AppleUHCItdMemoryBlock::gMetaClass);
}
// F440: using guessed type _QWORD AppleUHCItdMemoryBlock::gMetaClass;

//----- (0000000000009F60) ----------------------------------------------------
__int64 __fastcall AppleUHCIqhMemoryBlock::MetaClass::MetaClass(AppleUHCIqhMemoryBlock::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "AppleUHCIqhMemoryBlock", off_D058[0], 48LL);
  result = (__int64)off_E9A0;
  *(_QWORD *)this = off_E9A0;
  return result;
}
// D058: using guessed type _QWORD off_D058[9];
// E9A0: using guessed type __int64 (__fastcall *off_E9A0[2])(AppleUHCIqhMemoryBlock::MetaClass *__hidden this);
// 20E38: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000009F92) ----------------------------------------------------
__int64 __fastcall AppleUHCIqhMemoryBlock::MetaClass::~MetaClass(AppleUHCIqhMemoryBlock::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000009F9C) ----------------------------------------------------
__int64 __fastcall AppleUHCIqhMemoryBlock::AppleUHCIqhMemoryBlock(__int64 a1, __int64 a2)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1, a2);
  result = (__int64)off_E870;
  *(_QWORD *)a1 = off_E870;
  return result;
}
// E870: using guessed type __int64 (__fastcall *off_E870[2])(AppleUHCIqhMemoryBlock *__hidden this);
// 21620: using guessed type int __fastcall OSObject::OSObject(_QWORD, _QWORD);

//----- (0000000000009FBC) ----------------------------------------------------
__int64 __fastcall AppleUHCIqhMemoryBlock::AppleUHCIqhMemoryBlock(__int64 a1, __int64 a2)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1, a2);
  result = (__int64)off_E870;
  *(_QWORD *)a1 = off_E870;
  return result;
}
// E870: using guessed type __int64 (__fastcall *off_E870[2])(AppleUHCIqhMemoryBlock *__hidden this);
// 21620: using guessed type int __fastcall OSObject::OSObject(_QWORD, _QWORD);

//----- (0000000000009FDC) ----------------------------------------------------
__int64 __fastcall AppleUHCIqhMemoryBlock::~AppleUHCIqhMemoryBlock(AppleUHCIqhMemoryBlock *this)
{
  return OSObject::~OSObject(this);
}

//----- (0000000000009FE6) ----------------------------------------------------
__int64 __fastcall AppleUHCIqhMemoryBlock::~AppleUHCIqhMemoryBlock(AppleUHCIqhMemoryBlock *this)
{
  return OSObject::~OSObject(this);
}

//----- (0000000000009FF0) ----------------------------------------------------
void __fastcall AppleUHCIqhMemoryBlock::~AppleUHCIqhMemoryBlock(AppleUHCIqhMemoryBlock *this)
{
  OSObject::~OSObject(this);
  OSObject::operator delete((void *)this);
}

//----- (000000000000A012) ----------------------------------------------------
__int64 __fastcall AppleUHCIqhMemoryBlock::getMetaClass(AppleUHCIqhMemoryBlock *this)
{
  return (__int64)&AppleUHCIqhMemoryBlock::gMetaClass;
}
// F468: using guessed type _QWORD AppleUHCIqhMemoryBlock::gMetaClass;

//----- (000000000000A020) ----------------------------------------------------
__int64 __fastcall AppleUHCIqhMemoryBlock::MetaClass::MetaClass(AppleUHCIqhMemoryBlock::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "AppleUHCIqhMemoryBlock", off_D058[0], 48LL);
  result = (__int64)off_E9A0;
  *(_QWORD *)this = off_E9A0;
  return result;
}
// D058: using guessed type _QWORD off_D058[9];
// E9A0: using guessed type __int64 (__fastcall *off_E9A0[2])(AppleUHCIqhMemoryBlock::MetaClass *__hidden this);
// 20E38: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000000A052) ----------------------------------------------------
__int64 __fastcall AppleUHCIqhMemoryBlock::MetaClass::alloc(AppleUHCIqhMemoryBlock::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&stru_20.segname[8], a2);
  OSObject::OSObject(v2, &AppleUHCIqhMemoryBlock::gMetaClass);
  *(_QWORD *)v2 = off_E870;
  OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUHCIqhMemoryBlock::gMetaClass);
  return v2;
}
// 20: using guessed type segment_command_64 stru_20;
// E870: using guessed type __int64 (__fastcall *off_E870[2])(AppleUHCIqhMemoryBlock *__hidden this);
// F468: using guessed type _QWORD AppleUHCIqhMemoryBlock::gMetaClass;
// 21620: using guessed type int __fastcall OSObject::OSObject(_QWORD, _QWORD);

//----- (000000000000A092) ----------------------------------------------------
__int64 __fastcall AppleUHCIqhMemoryBlock::AppleUHCIqhMemoryBlock(__int64 a1)
{
  OSObject::OSObject(a1, &AppleUHCIqhMemoryBlock::gMetaClass);
  *(_QWORD *)a1 = off_E870;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUHCIqhMemoryBlock::gMetaClass);
}
// E870: using guessed type __int64 (__fastcall *off_E870[2])(AppleUHCIqhMemoryBlock *__hidden this);
// F468: using guessed type _QWORD AppleUHCIqhMemoryBlock::gMetaClass;
// 21620: using guessed type int __fastcall OSObject::OSObject(_QWORD, _QWORD);

//----- (000000000000A0C2) ----------------------------------------------------
__int64 __fastcall AppleUHCIqhMemoryBlock::AppleUHCIqhMemoryBlock(__int64 a1)
{
  OSObject::OSObject(a1, &AppleUHCIqhMemoryBlock::gMetaClass);
  *(_QWORD *)a1 = off_E870;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUHCIqhMemoryBlock::gMetaClass);
}
// E870: using guessed type __int64 (__fastcall *off_E870[2])(AppleUHCIqhMemoryBlock *__hidden this);
// F468: using guessed type _QWORD AppleUHCIqhMemoryBlock::gMetaClass;
// 21620: using guessed type int __fastcall OSObject::OSObject(_QWORD, _QWORD);

//----- (000000000000A0F2) ----------------------------------------------------
__int64 __fastcall AppleUHCIqhMemoryBlock::NewMemoryBlock(AppleUHCIqhMemoryBlock *this, unsigned __int64 a2)
{
  __int64 v2; // r12@1
  __int64 v3; // rax@2
  unsigned __int64 v4; // r8@2
  __int64 v5; // r14@2
  __int64 v6; // rax@3
  __int64 v7; // r15@5
  signed __int64 v8; // rsi@5
  signed __int64 v9; // rsi@9
  void *v10; // rax@11
  int v12; // ebx@15
  int v13; // [sp+1Ch] [bp-34h]@1
  unsigned int v14; // [sp+20h] [bp-30h]@15
  int v15; // [sp+24h] [bp-2Ch]@17
  __int64 v16; // [sp+28h] [bp-28h]@1

  v2 = OSObject::operator new((OSObject *)&stru_20.segname[8], a2);
  OSObject::OSObject(v2, &AppleUHCIqhMemoryBlock::gMetaClass);
  *(_QWORD *)v2 = off_E870;
  OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUHCIqhMemoryBlock::gMetaClass);
  v16 = 0LL;
  v13 = 1;
  if ( v2 )
  {
    LODWORD(v3) = IODMACommand::withSpecification(off_D010[0], 32LL, 4096LL, 64LL, 0LL, 1LL);
    v5 = v3;
    if ( !v3 )
    {
      v7 = 0LL;
      KernelDebugLogInternal(
        1LL,
        1431519814LL,
        "AppleUHCIqhMemoryBlock::NewMemoryBlock - could not create IODMACommand");
      return v7;
    }
    v6 = IOBufferMemoryDescriptor::inTaskWithPhysicalMask(
           *(IOBufferMemoryDescriptor **)off_D098,
           (task *)((char *)&dword_0 + 3),
           0x1000u,
           0xFFFFF000uLL,
           v4);
    *(_QWORD *)(v2 + 40) = v6;
    if ( v6 )
    {
      if ( (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v6 + 496LL))(v6, 0LL) )
      {
        v7 = 0LL;
        v8 = 1431519814LL;
        KernelDebugLogInternal(1LL, 1431519814LL, "AppleUHCIqhMemoryBlock::NewMemoryBlock - could not prepare buffer");
LABEL_13:
        (*(void (__fastcall **)(_QWORD, signed __int64))(**(_QWORD **)(v2 + 40) + 40LL))(*(_QWORD *)(v2 + 40), v8);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 40LL))(v2);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v5 + 40LL))(v5);
        return v7;
      }
      LODWORD(v10) = (*(int (__cdecl **)(_QWORD, _QWORD))(**(_QWORD **)(v2 + 40) + 736LL))(*(_QWORD *)(v2 + 40), 0LL);
      *(_QWORD *)(v2 + 24) = v10;
      bzero(v10, 0x1000uLL);
      if ( (*(int (__fastcall **)(__int64, _QWORD, signed __int64))(*(_QWORD *)v5 + 296LL))(
             v5,
             *(_QWORD *)(v2 + 40),
             1LL) )
      {
        v7 = 0LL;
        KernelDebugLogInternal(
          1LL,
          1431519814LL,
          "AppleUHCIqhMemoryBlock::NewMemoryBlock - could not set memory descriptor");
        v8 = 0LL;
        (*(void (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(v2 + 40) + 504LL))(*(_QWORD *)(v2 + 40), 0LL);
        goto LABEL_13;
      }
      v12 = (*(int (__fastcall **)(__int64, __int64 *, int *, int *))(*(_QWORD *)v5 + 344LL))(v5, &v16, &v14, &v13);
      (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v5 + 304LL))(v5, 1LL);
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v5 + 40LL))(v5);
      if ( !v12 && v13 == 1 && v15 == 4096 )
      {
        *(_QWORD *)(v2 + 16) = v14;
        return v2;
      }
      v7 = 0LL;
      KernelDebugLogInternal(
        1LL,
        1431519814LL,
        "AppleUHCIqhMemoryBlock::NewMemoryBlock - could not get physical segment");
      v9 = 0LL;
      (*(void (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(v2 + 40) + 504LL))(*(_QWORD *)(v2 + 40), 0LL);
      (*(void (__cdecl **)(_QWORD, _QWORD))(**(_QWORD **)(v2 + 40) + 40LL))(*(_QWORD *)(v2 + 40), 0LL);
    }
    else
    {
      v7 = 0LL;
      v9 = 1431519814LL;
      KernelDebugLogInternal(1LL, 1431519814LL, "AppleUHCIqhMemoryBlock::NewMemoryBlock, could not allocate buffer!");
    }
    (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v2 + 40LL))(v2, v9);
    return v7;
  }
  KernelDebugLogInternal(1LL, 1431519814LL, "AppleUHCIqhMemoryBlock::NewMemoryBlock, constructor failed!");
  return v2;
}
// 0: using guessed type int dword_0;
// 20: using guessed type segment_command_64 stru_20;
// D010: using guessed type __int64 off_D010[18];
// D098: using guessed type __int64 off_D098;
// E870: using guessed type __int64 (__fastcall *off_E870[2])(AppleUHCIqhMemoryBlock *__hidden this);
// F468: using guessed type _QWORD AppleUHCIqhMemoryBlock::gMetaClass;
// 20DB0: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);
// 20E78: using guessed type int __fastcall IODMACommand::withSpecification(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 21620: using guessed type int __fastcall OSObject::OSObject(_QWORD, _QWORD);

//----- (000000000000A372) ----------------------------------------------------
__int64 __fastcall AppleUHCIqhMemoryBlock::NumQHs(AppleUHCIqhMemoryBlock *this)
{
  return 256LL;
}

//----- (000000000000A37E) ----------------------------------------------------
__int64 __fastcall AppleUHCIqhMemoryBlock::GetPhysicalPtr(AppleUHCIqhMemoryBlock *this, unsigned int a2)
{
  __int64 result; // rax@1

  result = 0LL;
  if ( a2 <= 0xFF )
    result = *((_QWORD *)this + 2) + 16LL * a2;
  return result;
}

//----- (000000000000A398) ----------------------------------------------------
__int64 __fastcall AppleUHCIqhMemoryBlock::GetLogicalPtr(AppleUHCIqhMemoryBlock *this, unsigned int a2)
{
  __int64 result; // rax@1

  result = 0LL;
  if ( a2 <= 0xFF )
    result = *((_QWORD *)this + 3) + 16LL * a2;
  return result;
}

//----- (000000000000A3B2) ----------------------------------------------------
__int64 __fastcall AppleUHCIqhMemoryBlock::GetNextBlock(AppleUHCIqhMemoryBlock *this)
{
  return *((_QWORD *)this + 4);
}

//----- (000000000000A3BC) ----------------------------------------------------
void __fastcall AppleUHCIqhMemoryBlock::SetNextBlock(AppleUHCIqhMemoryBlock *this, AppleUHCIqhMemoryBlock *a2)
{
  *((_QWORD *)this + 4) = a2;
}

//----- (000000000000A3C6) ----------------------------------------------------
__int64 __fastcall AppleUHCIqhMemoryBlock::MetaClass::~MetaClass(AppleUHCIqhMemoryBlock::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000000A3D0) ----------------------------------------------------
__int64 `global constructor keyed to'_a_1()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(&AppleUHCIqhMemoryBlock::gMetaClass, "AppleUHCIqhMemoryBlock", off_D058[0], 48LL);
  result = (__int64)off_E9A0;
  AppleUHCIqhMemoryBlock::gMetaClass = off_E9A0;
  return result;
}
// D058: using guessed type _QWORD off_D058[9];
// E9A0: using guessed type __int64 (__fastcall *off_E9A0[2])(AppleUHCIqhMemoryBlock::MetaClass *__hidden this);
// F468: using guessed type _QWORD AppleUHCIqhMemoryBlock::gMetaClass;
// 20E38: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000000A410) ----------------------------------------------------
__int64 `global destructor keyed to'_a_1()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&AppleUHCIqhMemoryBlock::gMetaClass);
}
// F468: using guessed type _QWORD AppleUHCIqhMemoryBlock::gMetaClass;

//----- (000000000000A430) ----------------------------------------------------
__int64 __fastcall AppleUHCIQueueHead::MetaClass::MetaClass(AppleUHCIQueueHead::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "AppleUHCIQueueHead", off_D030[0], 72LL);
  result = (__int64)off_EBF0;
  *(_QWORD *)this = off_EBF0;
  return result;
}
// D030: using guessed type _QWORD off_D030[14];
// EBF0: using guessed type __int64 (__fastcall *off_EBF0[2])(AppleUHCIQueueHead::MetaClass *__hidden this);
// 20E38: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000000A462) ----------------------------------------------------
__int64 __fastcall AppleUHCIQueueHead::MetaClass::~MetaClass(AppleUHCIQueueHead::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000000A46C) ----------------------------------------------------
__int64 __fastcall AppleUHCIQueueHead::AppleUHCIQueueHead(IOUSBControllerListElement *a1, const OSMetaClass *a2)
{
  __int64 result; // rax@1

  IOUSBControllerListElement::IOUSBControllerListElement(a1, a2);
  result = (__int64)off_EAA0;
  *(_QWORD *)a1 = off_EAA0;
  return result;
}
// EAA0: using guessed type __int64 (__fastcall *off_EAA0[2])(AppleUHCIQueueHead *__hidden this);

//----- (000000000000A48C) ----------------------------------------------------
__int64 __fastcall AppleUHCIQueueHead::AppleUHCIQueueHead(IOUSBControllerListElement *a1, const OSMetaClass *a2)
{
  __int64 result; // rax@1

  IOUSBControllerListElement::IOUSBControllerListElement(a1, a2);
  result = (__int64)off_EAA0;
  *(_QWORD *)a1 = off_EAA0;
  return result;
}
// EAA0: using guessed type __int64 (__fastcall *off_EAA0[2])(AppleUHCIQueueHead *__hidden this);

//----- (000000000000A4AC) ----------------------------------------------------
__int64 __fastcall AppleUHCIQueueHead::~AppleUHCIQueueHead(AppleUHCIQueueHead *this)
{
  return IOUSBControllerListElement::~IOUSBControllerListElement(this);
}

//----- (000000000000A4B6) ----------------------------------------------------
__int64 __fastcall AppleUHCIQueueHead::~AppleUHCIQueueHead(AppleUHCIQueueHead *this)
{
  return IOUSBControllerListElement::~IOUSBControllerListElement(this);
}

//----- (000000000000A4C0) ----------------------------------------------------
void __fastcall AppleUHCIQueueHead::~AppleUHCIQueueHead(AppleUHCIQueueHead *this)
{
  IOUSBControllerListElement::~IOUSBControllerListElement(this);
  OSObject::operator delete((void *)this);
}

//----- (000000000000A4E2) ----------------------------------------------------
__int64 __fastcall AppleUHCIQueueHead::getMetaClass(AppleUHCIQueueHead *this)
{
  return (__int64)&AppleUHCIQueueHead::gMetaClass;
}
// F490: using guessed type _QWORD AppleUHCIQueueHead::gMetaClass;

//----- (000000000000A4F0) ----------------------------------------------------
__int64 __fastcall AppleUHCIQueueHead::MetaClass::MetaClass(AppleUHCIQueueHead::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "AppleUHCIQueueHead", off_D030[0], 72LL);
  result = (__int64)off_EBF0;
  *(_QWORD *)this = off_EBF0;
  return result;
}
// D030: using guessed type _QWORD off_D030[14];
// EBF0: using guessed type __int64 (__fastcall *off_EBF0[2])(AppleUHCIQueueHead::MetaClass *__hidden this);
// 20E38: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000000A522) ----------------------------------------------------
IOUSBControllerListElement *__fastcall AppleUHCIQueueHead::MetaClass::alloc(AppleUHCIQueueHead::MetaClass *this, unsigned __int64 a2)
{
  IOUSBControllerListElement *v2; // rbx@1

  v2 = (IOUSBControllerListElement *)OSObject::operator new((OSObject *)&stru_20.fileoff, a2);
  IOUSBControllerListElement::IOUSBControllerListElement(v2, (const OSMetaClass *)&AppleUHCIQueueHead::gMetaClass);
  *(_QWORD *)v2 = off_EAA0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUHCIQueueHead::gMetaClass);
  return v2;
}
// 20: using guessed type segment_command_64 stru_20;
// EAA0: using guessed type __int64 (__fastcall *off_EAA0[2])(AppleUHCIQueueHead *__hidden this);
// F490: using guessed type _QWORD AppleUHCIQueueHead::gMetaClass;

//----- (000000000000A562) ----------------------------------------------------
__int64 __fastcall AppleUHCIQueueHead::AppleUHCIQueueHead(IOUSBControllerListElement *a1)
{
  IOUSBControllerListElement::IOUSBControllerListElement(a1, (const OSMetaClass *)&AppleUHCIQueueHead::gMetaClass);
  *(_QWORD *)a1 = off_EAA0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUHCIQueueHead::gMetaClass);
}
// EAA0: using guessed type __int64 (__fastcall *off_EAA0[2])(AppleUHCIQueueHead *__hidden this);
// F490: using guessed type _QWORD AppleUHCIQueueHead::gMetaClass;

//----- (000000000000A592) ----------------------------------------------------
__int64 __fastcall AppleUHCIQueueHead::AppleUHCIQueueHead(IOUSBControllerListElement *a1)
{
  IOUSBControllerListElement::IOUSBControllerListElement(a1, (const OSMetaClass *)&AppleUHCIQueueHead::gMetaClass);
  *(_QWORD *)a1 = off_EAA0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUHCIQueueHead::gMetaClass);
}
// EAA0: using guessed type __int64 (__fastcall *off_EAA0[2])(AppleUHCIQueueHead *__hidden this);
// F490: using guessed type _QWORD AppleUHCIQueueHead::gMetaClass;

//----- (000000000000A5C2) ----------------------------------------------------
__int64 __fastcall AppleUHCIQueueHead::WithSharedMemory(__int64 a1, unsigned __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 result; // rax@1
  char v4; // cl@2

  v2 = OSObject::operator new((OSObject *)&stru_20.fileoff, a2);
  IOUSBControllerListElement::IOUSBControllerListElement(
    (IOUSBControllerListElement *)v2,
    (const OSMetaClass *)&AppleUHCIQueueHead::gMetaClass);
  *(_QWORD *)v2 = off_EAA0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUHCIQueueHead::gMetaClass);
  result = 0LL;
  if ( v2 )
  {
    v4 = (*(int (__fastcall **)(__int64, _QWORD *))(*(_QWORD *)v2 + 136LL))(v2, &AppleUHCIQueueHead::gMetaClass);
    result = 0LL;
    if ( v4 )
    {
      *(_QWORD *)(v2 + 24) = a1;
      *(_QWORD *)(v2 + 16) = a2;
      result = v2;
    }
  }
  return result;
}
// 20: using guessed type segment_command_64 stru_20;
// EAA0: using guessed type __int64 (__fastcall *off_EAA0[2])(AppleUHCIQueueHead *__hidden this);
// F490: using guessed type _QWORD AppleUHCIQueueHead::gMetaClass;

//----- (000000000000A634) ----------------------------------------------------
__int64 __fastcall AppleUHCIQueueHead::GetSharedLogical(AppleUHCIQueueHead *this)
{
  return *((_QWORD *)this + 3);
}

//----- (000000000000A63E) ----------------------------------------------------
__int64 __fastcall AppleUHCIQueueHead::SetPhysicalLink(AppleUHCIQueueHead *this, int a2)
{
  __int64 result; // rax@1

  result = *((_QWORD *)this + 3);
  *(_DWORD *)result = a2;
  _mm_mfence();
  return result;
}

//----- (000000000000A64E) ----------------------------------------------------
__int64 __fastcall AppleUHCIQueueHead::GetPhysicalLink(AppleUHCIQueueHead *this)
{
  return **((_DWORD **)this + 3);
}

//----- (000000000000A65A) ----------------------------------------------------
__int64 __fastcall AppleUHCIQueueHead::GetPhysicalAddrWithType(AppleUHCIQueueHead *this)
{
  return *((_QWORD *)this + 2) | 2LL;
}

//----- (000000000000A668) ----------------------------------------------------
int __fastcall AppleUHCIQueueHead::print(AppleUHCIQueueHead *this)
{
  return (*(int (__fastcall **)(AppleUHCIQueueHead *))(off_D070[0] + 320))(this);
}
// D070: using guessed type __int64 off_D070[6];

//----- (000000000000A67A) ----------------------------------------------------
__int64 __fastcall AppleUHCITransferDescriptor::MetaClass::MetaClass(AppleUHCITransferDescriptor::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "AppleUHCITransferDescriptor", off_D030[0], 88LL);
  result = (__int64)off_EE40;
  *(_QWORD *)this = off_EE40;
  return result;
}
// D030: using guessed type _QWORD off_D030[14];
// EE40: using guessed type __int64 (__fastcall *off_EE40[2])(AppleUHCITransferDescriptor::MetaClass *__hidden this);
// 20E38: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000000A6AC) ----------------------------------------------------
__int64 __fastcall AppleUHCITransferDescriptor::MetaClass::~MetaClass(AppleUHCITransferDescriptor::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000000A6B6) ----------------------------------------------------
__int64 __fastcall AppleUHCITransferDescriptor::AppleUHCITransferDescriptor(IOUSBControllerListElement *a1, const OSMetaClass *a2)
{
  __int64 result; // rax@1

  IOUSBControllerListElement::IOUSBControllerListElement(a1, a2);
  result = (__int64)off_ECF0;
  *(_QWORD *)a1 = off_ECF0;
  return result;
}
// ECF0: using guessed type __int64 (__fastcall *off_ECF0[2])(AppleUHCITransferDescriptor *__hidden this);

//----- (000000000000A6D6) ----------------------------------------------------
__int64 __fastcall AppleUHCITransferDescriptor::AppleUHCITransferDescriptor(IOUSBControllerListElement *a1, const OSMetaClass *a2)
{
  __int64 result; // rax@1

  IOUSBControllerListElement::IOUSBControllerListElement(a1, a2);
  result = (__int64)off_ECF0;
  *(_QWORD *)a1 = off_ECF0;
  return result;
}
// ECF0: using guessed type __int64 (__fastcall *off_ECF0[2])(AppleUHCITransferDescriptor *__hidden this);

//----- (000000000000A6F6) ----------------------------------------------------
__int64 __fastcall AppleUHCITransferDescriptor::~AppleUHCITransferDescriptor(AppleUHCITransferDescriptor *this)
{
  return IOUSBControllerListElement::~IOUSBControllerListElement(this);
}

//----- (000000000000A700) ----------------------------------------------------
__int64 __fastcall AppleUHCITransferDescriptor::~AppleUHCITransferDescriptor(AppleUHCITransferDescriptor *this)
{
  return IOUSBControllerListElement::~IOUSBControllerListElement(this);
}

//----- (000000000000A70A) ----------------------------------------------------
void __fastcall AppleUHCITransferDescriptor::~AppleUHCITransferDescriptor(AppleUHCITransferDescriptor *this)
{
  IOUSBControllerListElement::~IOUSBControllerListElement(this);
  OSObject::operator delete((void *)this);
}

//----- (000000000000A72C) ----------------------------------------------------
__int64 __fastcall AppleUHCITransferDescriptor::getMetaClass(AppleUHCITransferDescriptor *this)
{
  return (__int64)&AppleUHCITransferDescriptor::gMetaClass;
}
// F4B8: using guessed type _QWORD AppleUHCITransferDescriptor::gMetaClass;

//----- (000000000000A73A) ----------------------------------------------------
__int64 __fastcall AppleUHCITransferDescriptor::MetaClass::MetaClass(AppleUHCITransferDescriptor::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "AppleUHCITransferDescriptor", off_D030[0], 88LL);
  result = (__int64)off_EE40;
  *(_QWORD *)this = off_EE40;
  return result;
}
// D030: using guessed type _QWORD off_D030[14];
// EE40: using guessed type __int64 (__fastcall *off_EE40[2])(AppleUHCITransferDescriptor::MetaClass *__hidden this);
// 20E38: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000000A76C) ----------------------------------------------------
IOUSBControllerListElement *__fastcall AppleUHCITransferDescriptor::MetaClass::alloc(AppleUHCITransferDescriptor::MetaClass *this, unsigned __int64 a2)
{
  IOUSBControllerListElement *v2; // rbx@1

  v2 = (IOUSBControllerListElement *)OSObject::operator new((OSObject *)&stru_20.maxprot, a2);
  IOUSBControllerListElement::IOUSBControllerListElement(
    v2,
    (const OSMetaClass *)&AppleUHCITransferDescriptor::gMetaClass);
  *(_QWORD *)v2 = off_ECF0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUHCITransferDescriptor::gMetaClass);
  return v2;
}
// 20: using guessed type segment_command_64 stru_20;
// ECF0: using guessed type __int64 (__fastcall *off_ECF0[2])(AppleUHCITransferDescriptor *__hidden this);
// F4B8: using guessed type _QWORD AppleUHCITransferDescriptor::gMetaClass;

//----- (000000000000A7AC) ----------------------------------------------------
__int64 __fastcall AppleUHCITransferDescriptor::AppleUHCITransferDescriptor(IOUSBControllerListElement *a1)
{
  IOUSBControllerListElement::IOUSBControllerListElement(
    a1,
    (const OSMetaClass *)&AppleUHCITransferDescriptor::gMetaClass);
  *(_QWORD *)a1 = off_ECF0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUHCITransferDescriptor::gMetaClass);
}
// ECF0: using guessed type __int64 (__fastcall *off_ECF0[2])(AppleUHCITransferDescriptor *__hidden this);
// F4B8: using guessed type _QWORD AppleUHCITransferDescriptor::gMetaClass;

//----- (000000000000A7DC) ----------------------------------------------------
__int64 __fastcall AppleUHCITransferDescriptor::AppleUHCITransferDescriptor(IOUSBControllerListElement *a1)
{
  IOUSBControllerListElement::IOUSBControllerListElement(
    a1,
    (const OSMetaClass *)&AppleUHCITransferDescriptor::gMetaClass);
  *(_QWORD *)a1 = off_ECF0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUHCITransferDescriptor::gMetaClass);
}
// ECF0: using guessed type __int64 (__fastcall *off_ECF0[2])(AppleUHCITransferDescriptor *__hidden this);
// F4B8: using guessed type _QWORD AppleUHCITransferDescriptor::gMetaClass;

//----- (000000000000A80C) ----------------------------------------------------
__int64 __fastcall AppleUHCITransferDescriptor::WithSharedMemory(__int64 a1, unsigned __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 result; // rax@1
  char v4; // cl@2

  v2 = OSObject::operator new((OSObject *)&stru_20.maxprot, a2);
  IOUSBControllerListElement::IOUSBControllerListElement(
    (IOUSBControllerListElement *)v2,
    (const OSMetaClass *)&AppleUHCITransferDescriptor::gMetaClass);
  *(_QWORD *)v2 = off_ECF0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUHCITransferDescriptor::gMetaClass);
  result = 0LL;
  if ( v2 )
  {
    v4 = (*(int (__fastcall **)(__int64, _QWORD *))(*(_QWORD *)v2 + 136LL))(
           v2,
           &AppleUHCITransferDescriptor::gMetaClass);
    result = 0LL;
    if ( v4 )
    {
      *(_QWORD *)(v2 + 24) = a1;
      *(_QWORD *)(v2 + 16) = a2;
      result = v2;
    }
  }
  return result;
}
// 20: using guessed type segment_command_64 stru_20;
// ECF0: using guessed type __int64 (__fastcall *off_ECF0[2])(AppleUHCITransferDescriptor *__hidden this);
// F4B8: using guessed type _QWORD AppleUHCITransferDescriptor::gMetaClass;

//----- (000000000000A87E) ----------------------------------------------------
__int64 __fastcall AppleUHCITransferDescriptor::GetSharedLogical(AppleUHCITransferDescriptor *this)
{
  return *((_QWORD *)this + 3);
}

//----- (000000000000A888) ----------------------------------------------------
__int64 __fastcall AppleUHCITransferDescriptor::SetPhysicalLink(AppleUHCITransferDescriptor *this, int a2)
{
  __int64 result; // rax@1

  result = *((_QWORD *)this + 3);
  *(_DWORD *)result = a2;
  _mm_mfence();
  return result;
}

//----- (000000000000A898) ----------------------------------------------------
__int64 __fastcall AppleUHCITransferDescriptor::GetPhysicalLink(AppleUHCITransferDescriptor *this)
{
  return **((_DWORD **)this + 3);
}

//----- (000000000000A8A4) ----------------------------------------------------
__int64 __fastcall AppleUHCITransferDescriptor::GetPhysicalAddrWithType(AppleUHCITransferDescriptor *this)
{
  return *((_QWORD *)this + 2);
}

//----- (000000000000A8AE) ----------------------------------------------------
__int64 __fastcall AppleUHCITransferDescriptor::print(AppleUHCITransferDescriptor *this)
{
  __int64 v1; // rbx@1
  int v2; // et1@1
  int v3; // et1@1

  v1 = *((_QWORD *)this + 3);
  (*(void (__cdecl **)(AppleUHCITransferDescriptor *))(off_D070[0] + 320))(this);
  v2 = *(_DWORD *)v1;
  v3 = *(_DWORD *)(v1 + 4);
  return *(_DWORD *)(v1 + 8);
}
// D070: using guessed type __int64 off_D070[6];

//----- (000000000000A8D4) ----------------------------------------------------
__int64 __fastcall AppleUHCIIsochTransferDescriptor::MetaClass::MetaClass(AppleUHCIIsochTransferDescriptor::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "AppleUHCIIsochTransferDescriptor", off_D038[0], 136LL);
  result = (__int64)off_F0A0;
  *(_QWORD *)this = off_F0A0;
  return result;
}
// D038: using guessed type _QWORD off_D038[13];
// F0A0: using guessed type __int64 (__fastcall *off_F0A0[2])(AppleUHCIIsochTransferDescriptor::MetaClass *__hidden this);
// 20E38: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000000A906) ----------------------------------------------------
__int64 __fastcall AppleUHCIIsochTransferDescriptor::MetaClass::~MetaClass(AppleUHCIIsochTransferDescriptor::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000000A910) ----------------------------------------------------
__int64 __fastcall AppleUHCIIsochTransferDescriptor::AppleUHCIIsochTransferDescriptor(IOUSBControllerIsochListElement *a1, const OSMetaClass *a2)
{
  __int64 result; // rax@1

  IOUSBControllerIsochListElement::IOUSBControllerIsochListElement(a1, a2);
  result = (__int64)off_EF40;
  *(_QWORD *)a1 = off_EF40;
  return result;
}
// EF40: using guessed type __int64 (__fastcall *off_EF40[2])(AppleUHCIIsochTransferDescriptor *__hidden this);

//----- (000000000000A930) ----------------------------------------------------
__int64 __fastcall AppleUHCIIsochTransferDescriptor::AppleUHCIIsochTransferDescriptor(IOUSBControllerIsochListElement *a1, const OSMetaClass *a2)
{
  __int64 result; // rax@1

  IOUSBControllerIsochListElement::IOUSBControllerIsochListElement(a1, a2);
  result = (__int64)off_EF40;
  *(_QWORD *)a1 = off_EF40;
  return result;
}
// EF40: using guessed type __int64 (__fastcall *off_EF40[2])(AppleUHCIIsochTransferDescriptor *__hidden this);

//----- (000000000000A950) ----------------------------------------------------
__int64 __fastcall AppleUHCIIsochTransferDescriptor::~AppleUHCIIsochTransferDescriptor(AppleUHCIIsochTransferDescriptor *this)
{
  return IOUSBControllerIsochListElement::~IOUSBControllerIsochListElement(this);
}

//----- (000000000000A95A) ----------------------------------------------------
__int64 __fastcall AppleUHCIIsochTransferDescriptor::~AppleUHCIIsochTransferDescriptor(AppleUHCIIsochTransferDescriptor *this)
{
  return IOUSBControllerIsochListElement::~IOUSBControllerIsochListElement(this);
}

//----- (000000000000A964) ----------------------------------------------------
void __fastcall AppleUHCIIsochTransferDescriptor::~AppleUHCIIsochTransferDescriptor(AppleUHCIIsochTransferDescriptor *this)
{
  IOUSBControllerIsochListElement::~IOUSBControllerIsochListElement(this);
  OSObject::operator delete((void *)this);
}

//----- (000000000000A986) ----------------------------------------------------
__int64 __fastcall AppleUHCIIsochTransferDescriptor::getMetaClass(AppleUHCIIsochTransferDescriptor *this)
{
  return (__int64)&AppleUHCIIsochTransferDescriptor::gMetaClass;
}
// F4E0: using guessed type _QWORD AppleUHCIIsochTransferDescriptor::gMetaClass;

//----- (000000000000A994) ----------------------------------------------------
__int64 __fastcall AppleUHCIIsochTransferDescriptor::MetaClass::MetaClass(AppleUHCIIsochTransferDescriptor::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "AppleUHCIIsochTransferDescriptor", off_D038[0], 136LL);
  result = (__int64)off_F0A0;
  *(_QWORD *)this = off_F0A0;
  return result;
}
// D038: using guessed type _QWORD off_D038[13];
// F0A0: using guessed type __int64 (__fastcall *off_F0A0[2])(AppleUHCIIsochTransferDescriptor::MetaClass *__hidden this);
// 20E38: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000000A9C6) ----------------------------------------------------
IOUSBControllerIsochListElement *__fastcall AppleUHCIIsochTransferDescriptor::MetaClass::alloc(AppleUHCIIsochTransferDescriptor::MetaClass *this, unsigned __int64 a2)
{
  IOUSBControllerIsochListElement *v2; // rbx@1

  v2 = (IOUSBControllerIsochListElement *)OSObject::operator new((OSObject *)&stru_68.addr, a2);
  IOUSBControllerIsochListElement::IOUSBControllerIsochListElement(
    v2,
    (const OSMetaClass *)&AppleUHCIIsochTransferDescriptor::gMetaClass);
  *(_QWORD *)v2 = off_EF40;
  OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUHCIIsochTransferDescriptor::gMetaClass);
  return v2;
}
// 68: using guessed type section_64 stru_68;
// EF40: using guessed type __int64 (__fastcall *off_EF40[2])(AppleUHCIIsochTransferDescriptor *__hidden this);
// F4E0: using guessed type _QWORD AppleUHCIIsochTransferDescriptor::gMetaClass;

//----- (000000000000AA06) ----------------------------------------------------
__int64 __fastcall AppleUHCIIsochTransferDescriptor::AppleUHCIIsochTransferDescriptor(IOUSBControllerIsochListElement *a1)
{
  IOUSBControllerIsochListElement::IOUSBControllerIsochListElement(
    a1,
    (const OSMetaClass *)&AppleUHCIIsochTransferDescriptor::gMetaClass);
  *(_QWORD *)a1 = off_EF40;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUHCIIsochTransferDescriptor::gMetaClass);
}
// EF40: using guessed type __int64 (__fastcall *off_EF40[2])(AppleUHCIIsochTransferDescriptor *__hidden this);
// F4E0: using guessed type _QWORD AppleUHCIIsochTransferDescriptor::gMetaClass;

//----- (000000000000AA36) ----------------------------------------------------
__int64 __fastcall AppleUHCIIsochTransferDescriptor::AppleUHCIIsochTransferDescriptor(IOUSBControllerIsochListElement *a1)
{
  IOUSBControllerIsochListElement::IOUSBControllerIsochListElement(
    a1,
    (const OSMetaClass *)&AppleUHCIIsochTransferDescriptor::gMetaClass);
  *(_QWORD *)a1 = off_EF40;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUHCIIsochTransferDescriptor::gMetaClass);
}
// EF40: using guessed type __int64 (__fastcall *off_EF40[2])(AppleUHCIIsochTransferDescriptor *__hidden this);
// F4E0: using guessed type _QWORD AppleUHCIIsochTransferDescriptor::gMetaClass;

//----- (000000000000AA66) ----------------------------------------------------
__int64 __fastcall AppleUHCIIsochTransferDescriptor::WithSharedMemory(__int64 a1, unsigned __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 result; // rax@1
  char v4; // cl@2

  v2 = OSObject::operator new((OSObject *)&stru_68.addr, a2);
  IOUSBControllerIsochListElement::IOUSBControllerIsochListElement(
    (IOUSBControllerIsochListElement *)v2,
    (const OSMetaClass *)&AppleUHCIIsochTransferDescriptor::gMetaClass);
  *(_QWORD *)v2 = off_EF40;
  OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUHCIIsochTransferDescriptor::gMetaClass);
  result = 0LL;
  if ( v2 )
  {
    v4 = (*(int (__fastcall **)(__int64, _QWORD *))(*(_QWORD *)v2 + 136LL))(
           v2,
           &AppleUHCIIsochTransferDescriptor::gMetaClass);
    result = 0LL;
    if ( v4 )
    {
      *(_QWORD *)(v2 + 24) = a1;
      *(_QWORD *)(v2 + 16) = a2;
      result = v2;
    }
  }
  return result;
}
// 68: using guessed type section_64 stru_68;
// EF40: using guessed type __int64 (__fastcall *off_EF40[2])(AppleUHCIIsochTransferDescriptor *__hidden this);
// F4E0: using guessed type _QWORD AppleUHCIIsochTransferDescriptor::gMetaClass;

//----- (000000000000AAD8) ----------------------------------------------------
__int64 __fastcall AppleUHCIIsochTransferDescriptor::GetSharedLogical(AppleUHCIIsochTransferDescriptor *this)
{
  return *((_QWORD *)this + 3);
}

//----- (000000000000AAE2) ----------------------------------------------------
__int64 __fastcall AppleUHCIIsochTransferDescriptor::SetPhysicalLink(AppleUHCIIsochTransferDescriptor *this, int a2)
{
  __int64 result; // rax@1

  result = *((_QWORD *)this + 3);
  *(_DWORD *)result = a2;
  _mm_mfence();
  return result;
}

//----- (000000000000AAF2) ----------------------------------------------------
__int64 __fastcall AppleUHCIIsochTransferDescriptor::GetPhysicalLink(AppleUHCIIsochTransferDescriptor *this)
{
  return **((_DWORD **)this + 3);
}

//----- (000000000000AAFE) ----------------------------------------------------
__int64 __fastcall AppleUHCIIsochTransferDescriptor::GetPhysicalAddrWithType(AppleUHCIIsochTransferDescriptor *this)
{
  return *((_QWORD *)this + 2);
}

//----- (000000000000AB08) ----------------------------------------------------
__int64 __fastcall AppleUHCIIsochTransferDescriptor::Deallocate(AppleUHCIIsochTransferDescriptor *a1, AppleUSBUHCI *this)
{
  return AppleUSBUHCI::DeallocateITD(this, a1);
}

//----- (000000000000AB1C) ----------------------------------------------------
__int64 __fastcall AppleUHCIIsochTransferDescriptor::UpdateFrameList(AppleUHCIIsochTransferDescriptor *this, uintptr_t a2)
{
  AppleUHCIIsochTransferDescriptor *v3; // rbx@1
  int v4; // ecx@1
  __int64 v5; // r15@1
  signed int v6; // er14@1
  unsigned __int16 v7; // r13@2
  char v8; // al@2
  __int64 v9; // rdx@2
  signed __int64 v10; // rdx@3
  int v11; // er12@5
  char v12; // cl@13
  __int64 v13; // rcx@16
  __int64 v14; // rdi@17
  bool v15; // zf@21
  char v16; // al@21
  __int16 v17; // r13@23
  signed __int64 v18; // rax@23
  __int16 v19; // t0@23
  __int16 v21; // r13@25
  __int64 v22; // rax@25
  __int16 v23; // t0@25
  signed __int64 v24; // rax@26
  __int64 v25; // rax@29
  __int64 v26; // rax@31

  _R8 = a2;
  v3 = this;
  v4 = *(_DWORD *)(*((_QWORD *)this + 3) + 4LL);
  v5 = *((_QWORD *)this + 6);
  v6 = 0;
  if ( v5 )
  {
    v7 = (v4 + 1) & 0x7FF;
    v8 = *((_BYTE *)this + 80);
    v9 = *((_DWORD *)this + 24);
    if ( v8 )
      v10 = v5 + 16 * v9 + 4;
    else
      v10 = v5 + 8 * v9 + 4;
    v11 = -536854513;
    if ( !(v4 & 0x800000) )
    {
      v11 = -536870163;
      if ( !(v4 & 0x40000) )
      {
        if ( v4 & 0x200000 )
        {
          v11 = (*(_BYTE *)(*((_QWORD *)this + 5) + 128LL) == 0) | 0xE000400C;
        }
        else if ( v4 & 0x100000 )
        {
          v11 = 5 * (*(_BYTE *)(*((_QWORD *)this + 5) + 128LL) == 0) - 536870168;
        }
        else
        {
          v11 = -536854521;
          if ( !(v4 & 0x400000) )
          {
            v11 = 0;
            if ( v7 != *(_WORD *)v10 )
            {
              v12 = *(_BYTE *)(*((_QWORD *)this + 5) + 128LL);
              v11 = -536854515;
              if ( v12 )
              {
                v11 = -536870169;
                if ( v12 != 1 )
                  v11 = 0;
              }
            }
          }
        }
      }
    }
    v13 = *((_QWORD *)this + 14);
    if ( v13 )
    {
      v14 = *(_QWORD *)(v13 + 32);
      if ( v14 )
      {
        if ( *(_QWORD *)(v13 + 24) && *(_BYTE *)(*((_QWORD *)v3 + 5) + 128LL) == 1 )
        {
          (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v14 + 488LL))(v14, *(_QWORD *)(v13 + 40));
          _R8 = a2;
          *(_QWORD *)(*((_QWORD *)v3 + 14) + 48LL) = v7;
          v8 = *((_BYTE *)v3 + 80);
        }
      }
    }
    v15 = v8 == 0;
    v16 = *((_BYTE *)v3 + 81);
    if ( v15 )
    {
      if ( v16 )
      {
        v21 = __ROL2__(v7, 8);
        v22 = *((_DWORD *)v3 + 24);
        *(_WORD *)(v5 + 8 * v22 + 6) = v21;
        v23 = __ROL2__(*(_WORD *)(v5 + 8 * v22 + 4), 8);
        *(_WORD *)(v5 + 8 * v22 + 4) = v23;
        *(_DWORD *)(v5 + 8 * v22) = _byteswap_ulong(v11);
      }
      else
      {
        v25 = *((_DWORD *)v3 + 24);
        *(_WORD *)(v5 + 8 * v25 + 6) = v7;
        *(_DWORD *)(v5 + 8 * v25) = v11;
      }
    }
    else if ( v16 )
    {
      v17 = __ROL2__(v7, 8);
      v18 = 16LL * *((_DWORD *)v3 + 24);
      *(_WORD *)(v5 + v18 + 6) = v17;
      v19 = __ROL2__(*(_WORD *)(v5 + v18 + 4), 8);
      *(_WORD *)(v5 + v18 + 4) = v19;
      __asm { bswap   r8 }
      *(_QWORD *)(v5 + v18 + 8) = _R8;
      *(_DWORD *)(v5 + v18) = _byteswap_ulong(v11);
    }
    else
    {
      v24 = 16LL * *((_DWORD *)v3 + 24);
      *(_WORD *)(v5 + v24 + 6) = v7;
      *(_QWORD *)(v5 + v24 + 8) = _R8;
      *(_DWORD *)(v5 + v24) = v11;
      if ( *(_BYTE *)off_D080[0] & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
        kernel_debug(
          0x52D3410u,
          *(_WORD *)(*((_QWORD *)v3 + 5) + 116LL) | (*(_WORD *)(*((_QWORD *)v3 + 5) + 114LL) << 8) | (*(_BYTE *)(*((_QWORD *)v3 + 5) + 128LL) << 24),
          v24 + v5,
          v7,
          _R8,
          0LL);
    }
    if ( v11 == -536870169 )
    {
      v26 = *((_QWORD *)v3 + 5);
      v6 = -536870169;
      if ( !*(_DWORD *)(v26 + 120) )
        *(_DWORD *)(v26 + 120) = -536870169;
    }
    else if ( v11 )
    {
      *(_DWORD *)(*((_QWORD *)v3 + 5) + 120LL) = v11;
      v6 = v11;
    }
  }
  return (unsigned int)v6;
}
// D080: using guessed type __int64 off_D080[4];
// D090: using guessed type __int64 off_D090[2];

//----- (000000000000AD92) ----------------------------------------------------
__int64 __fastcall AppleUHCIIsochTransferDescriptor::print(AppleUHCIIsochTransferDescriptor *this)
{
  __int64 v1; // rbx@1
  int v2; // et1@1
  int v3; // et1@1

  v1 = *((_QWORD *)this + 3);
  (*(void (__cdecl **)(AppleUHCIIsochTransferDescriptor *))(off_D070[0] + 320))(this);
  v2 = *(_DWORD *)v1;
  v3 = *(_DWORD *)(v1 + 4);
  return *(_DWORD *)(v1 + 8);
}
// D070: using guessed type __int64 off_D070[6];

//----- (000000000000ADB8) ----------------------------------------------------
__int64 __fastcall AppleUHCIQueueHead::MetaClass::~MetaClass(AppleUHCIQueueHead::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000000ADC2) ----------------------------------------------------
__int64 __fastcall AppleUHCITransferDescriptor::MetaClass::~MetaClass(AppleUHCITransferDescriptor::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000000ADCC) ----------------------------------------------------
__int64 __fastcall AppleUHCIIsochTransferDescriptor::MetaClass::~MetaClass(AppleUHCIIsochTransferDescriptor::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000000ADE0) ----------------------------------------------------
__int64 `global constructor keyed to'_a_2()
{
  __int64 v0; // rbx@1
  __int64 result; // rax@1

  v0 = off_D030[0];
  OSMetaClass::OSMetaClass(&AppleUHCIQueueHead::gMetaClass, "AppleUHCIQueueHead", off_D030[0], 72LL);
  AppleUHCIQueueHead::gMetaClass = off_EBF0;
  OSMetaClass::OSMetaClass(&AppleUHCITransferDescriptor::gMetaClass, "AppleUHCITransferDescriptor", v0, 88LL);
  AppleUHCITransferDescriptor::gMetaClass = off_EE40;
  OSMetaClass::OSMetaClass(
    &AppleUHCIIsochTransferDescriptor::gMetaClass,
    "AppleUHCIIsochTransferDescriptor",
    off_D038[0],
    136LL);
  result = (__int64)off_F0A0;
  AppleUHCIIsochTransferDescriptor::gMetaClass = off_F0A0;
  return result;
}
// D030: using guessed type _QWORD off_D030[14];
// D038: using guessed type _QWORD off_D038[13];
// EBF0: using guessed type __int64 (__fastcall *off_EBF0[2])(AppleUHCIQueueHead::MetaClass *__hidden this);
// EE40: using guessed type __int64 (__fastcall *off_EE40[2])(AppleUHCITransferDescriptor::MetaClass *__hidden this);
// F0A0: using guessed type __int64 (__fastcall *off_F0A0[2])(AppleUHCIIsochTransferDescriptor::MetaClass *__hidden this);
// F490: using guessed type _QWORD AppleUHCIQueueHead::gMetaClass;
// F4B8: using guessed type _QWORD AppleUHCITransferDescriptor::gMetaClass;
// F4E0: using guessed type _QWORD AppleUHCIIsochTransferDescriptor::gMetaClass;
// 20E38: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000000AE80) ----------------------------------------------------
__int64 `global destructor keyed to'_a_2()
{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&AppleUHCIIsochTransferDescriptor::gMetaClass);
  OSMetaClass::~OSMetaClass((OSMetaClass *)&AppleUHCITransferDescriptor::gMetaClass);
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&AppleUHCIQueueHead::gMetaClass);
}
// F490: using guessed type _QWORD AppleUHCIQueueHead::gMetaClass;
// F4B8: using guessed type _QWORD AppleUHCITransferDescriptor::gMetaClass;
// F4E0: using guessed type _QWORD AppleUHCIIsochTransferDescriptor::gMetaClass;

//----- (000000000000AEAA) ----------------------------------------------------
void __fastcall AppleUSBUHCI::PollInterrupts(AppleUSBUHCI *this, void (__cdecl *a2)(void *, void *, int, unsigned int))
{
  ;
}

//----- (000000000000AEB0) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::UpdateFrameNumberWithTime(AppleUSBUHCI *this)
{
  __int64 result; // rax@1

  result = *((_QWORD *)this + 1176);
  if ( *((_QWORD *)this + 1179) != result )
  {
    *((_QWORD *)this + 1175) = *((_QWORD *)this + 1174);
    *((_QWORD *)this + 1179) = result;
  }
  return result;
}

//----- (000000000000AEDC) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::PrimaryInterruptFilter(AppleUSBUHCI *this)
{
  if ( this && !(unsigned __int8)IOService::isInactive(this) && *((_BYTE *)this + 444) )
  {
    *((_BYTE *)this + 9384) = 1;
    AppleUSBUHCI::FilterInterrupt(this);
    *((_BYTE *)this + 9384) = 0;
  }
  return 0LL;
}

//----- (000000000000AF1E) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::FilterInterrupt(AppleUSBUHCI *this)
{
  AppleUSBUHCI *v1; // rbx@1
  AppleUSBUHCI *v2; // rsi@1
  unsigned __int16 v3; // ax@1
  char v4; // r14@2
  __int64 v5; // r15@2
  char v6; // r13@6
  uintptr_t v7; // r12@7
  unsigned __int16 v8; // ax@7
  uintptr_t v9; // r12@12
  unsigned __int16 v10; // ax@12
  int v11; // eax@21
  __int64 v12; // r13@21
  int v13; // er14@21
  __int64 v14; // rbx@26
  __int64 v15; // r12@26
  __int64 v16; // r15@27
  __int64 v17; // rax@27
  __int64 v18; // rdi@30
  int v20; // [sp+Ch] [bp-64h]@25
  uint64_t v21; // [sp+18h] [bp-58h]@19
  AppleUSBUHCI *v22; // [sp+30h] [bp-40h]@25

  v1 = this;
  v2 = (AppleUSBUHCI *)(&dword_0 + 2);
  v3 = AppleUSBUHCI::ioRead16(this, 2) & 0x1F;
  if ( v3 )
  {
    v4 = v3;
    v5 = off_D080[0];
    if ( *(_BYTE *)off_D080[0] & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
    {
      v2 = this;
      kernel_debug(0x52D3408u, (uintptr_t)this, v3, 0LL, 3uLL, 0LL);
    }
    if ( v4 & 0x10 )
    {
      *((_WORD *)this + 426) = 16;
      v2 = (AppleUSBUHCI *)(&dword_0 + 2);
      AppleUSBUHCI::ioWrite16(this, 2, 0x10u);
      v6 = 1;
      if ( *(_BYTE *)v5 & 2 )
      {
        v7 = *((_WORD *)this + 426);
        v2 = (AppleUSBUHCI *)(&stru_B8 + 8);
        v8 = IOPCIDevice::extendedConfigRead16(*((IOPCIDevice **)this + 61), 0xC0uLL);
        if ( *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
        {
          v2 = this;
          kernel_debug(0x52D3408u, (uintptr_t)this, v7, v8, 1uLL, 0LL);
        }
      }
    }
    else
    {
      v6 = 0;
    }
    if ( v4 & 8 )
    {
      *((_WORD *)this + 427) = 8;
      v2 = (AppleUSBUHCI *)(&dword_0 + 2);
      AppleUSBUHCI::ioWrite16(this, 2, 8u);
      v6 = 1;
      if ( *(_BYTE *)v5 & 2 )
      {
        v9 = *((_WORD *)this + 427);
        v2 = (AppleUSBUHCI *)(&stru_B8 + 8);
        v10 = IOPCIDevice::extendedConfigRead16(*((IOPCIDevice **)this + 61), 0xC0uLL);
        if ( *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
        {
          v2 = this;
          kernel_debug(0x52D3408u, (uintptr_t)this, v9, v10, 2uLL, 0LL);
        }
      }
    }
    if ( v4 & 4 )
    {
      *((_WORD *)this + 428) = 4;
      v2 = (AppleUSBUHCI *)(&dword_0 + 2);
      AppleUSBUHCI::ioWrite16(this, 2, 4u);
      v6 = 1;
    }
    if ( v4 & 2 )
    {
      *((_WORD *)this + 429) = 2;
      v2 = (AppleUSBUHCI *)(&dword_0 + 2);
      AppleUSBUHCI::ioWrite16(this, 2, 2u);
      v6 = 1;
    }
    if ( v4 & 1 )
    {
      v21 = mach_absolute_time();
      v2 = (AppleUSBUHCI *)(&dword_0 + 2);
      AppleUSBUHCI::ioWrite16(this, 2, 1u);
      AppleUSBUHCI::GetFrameNumberInternal(this);
      if ( !*((_BYTE *)this + 9385) && (unsigned int)*((_WORD *)this + 4644) <= 0x3FF )
      {
        v11 = AppleUSBUHCI::ioRead16(this, 6) & 0x3FF;
        v12 = *((_QWORD *)this + 1171);
        v13 = *((_DWORD *)this + 2344);
        v2 = (AppleUSBUHCI *)*((_WORD *)this + 4644);
        if ( (_DWORD)v2 != v11 )
        {
          v20 = (unsigned __int16)v11;
          v22 = this;
          do
          {
            v14 = *((_QWORD *)v1 + (unsigned __int16)v2 + 110);
            v15 = v12;
            if ( v14 )
            {
              while ( 1 )
              {
                v16 = *(_QWORD *)(v14 + 32);
                LODWORD(v17) = OSMetaClassBase::safeMetaCast(v14, AppleUHCIIsochTransferDescriptor::metaClass);
                v12 = v17;
                if ( !v17 )
                  break;
                *((_QWORD *)v22 + (unsigned __int16)v2 + 110) = v16;
                *(_DWORD *)(*((_QWORD *)v22 + 1134) + 4LL * (unsigned __int16)v2) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v14 + 288LL))(
                                                                                      v14,
                                                                                      AppleUHCIIsochTransferDescriptor::metaClass);
                if ( *(_BYTE *)(v12 + 80) )
                  *(_DWORD *)(v12 + 128) = (*(int (__fastcall **)(__int64, uint64_t))(*(_QWORD *)v12 + 312LL))(v12, v21);
                *(_QWORD *)(v12 + 104) = v15;
                v18 = *(_QWORD *)(v12 + 40);
                if ( v18 )
                {
                  ++*(_DWORD *)(v18 + 104);
                  OSDecrementAtomic(v18 + 96);
                }
                ++v13;
                v15 = v12;
                v14 = v16;
                if ( !v16 )
                  goto LABEL_35;
              }
              v12 = v15;
            }
LABEL_35:
            v2 = (AppleUSBUHCI *)(((_WORD)v2 + 1) & 0x3FF);
            v1 = v22;
            *((_WORD *)v22 + 4644) = (_WORD)v2;
          }
          while ( (unsigned __int16)v2 != v20 );
        }
        IOSimpleLockLock(*((_QWORD *)v1 + 1160));
        *((_QWORD *)v1 + 1171) = v12;
        *((_DWORD *)v1 + 2344) = v13;
        IOSimpleLockUnlock(*((_QWORD *)v1 + 1160));
      }
      *((_WORD *)v1 + 430) = 1;
    }
    else if ( !v6 )
    {
      return 0LL;
    }
    (*(void (__fastcall **)(_QWORD, AppleUSBUHCI *))(**((_QWORD **)v1 + 94) + 568LL))(*((_QWORD *)v1 + 94), v2);
  }
  return 0LL;
}
// 0: using guessed type int dword_0;
// B8: using guessed type section_64;
// D080: using guessed type __int64 off_D080[4];
// D090: using guessed type __int64 off_D090[2];
// EF18: using guessed type _QWORD AppleUHCIIsochTransferDescriptor::metaClass;
// 20D90: using guessed type int __fastcall IOSimpleLockLock(_QWORD);
// 20DA0: using guessed type int __fastcall IOSimpleLockUnlock(_QWORD);
// 20DC0: using guessed type int __fastcall OSDecrementAtomic(_QWORD);
// 211C8: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (000000000000B286) ----------------------------------------------------
void __fastcall AppleUSBUHCI::InterruptHandler(IOService *this)
{
  if ( this && !(unsigned __int8)IOService::isInactive(this) )
  {
    if ( *((_BYTE *)this + 444) )
      AppleUSBUHCI::HandleInterrupt(this);
  }
}

//----- (000000000000B2BE) ----------------------------------------------------
void __fastcall AppleUSBUHCI::HandleInterrupt(AppleUSBUHCI *this)
{
  signed __int64 v1; // rsi@1
  unsigned __int16 v2; // r15@1
  __int64 v3; // r12@1
  char v4; // r14@5
  unsigned __int16 v5; // ax@11
  unsigned __int16 v6; // r15@14
  unsigned __int16 v7; // r14@14
  unsigned __int16 v8; // ax@14
  __int64 v9; // r13@17
  unsigned __int16 v10; // r15@17
  unsigned __int32 v11; // er12@17
  unsigned __int16 v12; // ax@17
  __int64 v13; // rax@31
  int v14; // et1@33
  __int64 v15; // rax@33
  int v16; // eax@39
  unsigned __int16 v17; // [sp+0h] [bp-2Ah]@13

  v1 = 2LL;
  v2 = AppleUSBUHCI::ioRead16(this, 2);
  v3 = off_D080[0];
  if ( *(_BYTE *)off_D080[0] & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
  {
    v1 = (signed __int64)this;
    kernel_debug(0x52D340Du, (uintptr_t)this, 0LL, 0LL, 0LL, 0LL);
  }
  if ( *((_BYTE *)this + 852) & 0x10 )
  {
    *((_WORD *)this + 426) = 0;
    v4 = 1;
    if ( *(_BYTE *)v3 & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
    {
      v1 = (signed __int64)this;
      kernel_debug(0x52D340Cu, (uintptr_t)this, 0LL, 0LL, 1uLL, 0LL);
    }
  }
  else
  {
    v4 = 0;
  }
  if ( *((_BYTE *)this + 854) & 8 )
  {
    *((_WORD *)this + 427) = 0;
    if ( *(_BYTE *)v3 & 2 )
    {
      v1 = 0LL;
      v5 = AppleUSBUHCI::ioRead16(this, 0);
      if ( *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
      {
        v1 = (signed __int64)this;
        kernel_debug(0x52D340Cu, (uintptr_t)this, v5, 0LL, 2uLL, 0LL);
      }
    }
    v17 = v2;
    if ( *(_BYTE *)v3 & 2 )
    {
      v6 = AppleUSBUHCI::ioRead16(this, 2);
      v7 = AppleUSBUHCI::ioRead16(this, 4);
      v1 = 16LL;
      v8 = AppleUSBUHCI::ioRead16(this, 16);
      if ( *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
      {
        v1 = v6;
        kernel_debug(0x52D340Cu, v6, v7, v8, 3uLL, 0LL);
      }
    }
    v4 = 1;
    if ( *(_BYTE *)v3 & 2 )
    {
      v9 = v3;
      v10 = AppleUSBUHCI::ioRead16(this, 18);
      v11 = AppleUSBUHCI::ioRead32(this, 8);
      v1 = 4LL;
      v12 = IOPCIDevice::extendedConfigRead16(*((IOPCIDevice **)this + 61), 4uLL);
      if ( *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
      {
        v1 = v10;
        kernel_debug(0x52D340Cu, v10, v11, v12, 4uLL, 0LL);
      }
      v2 = v17;
      v3 = v9;
    }
    else
    {
      v2 = v17;
    }
  }
  if ( *((_BYTE *)this + 856) & 4 )
  {
    *((_WORD *)this + 428) = 0;
    if ( *(_BYTE *)v3 & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
    {
      v1 = (signed __int64)this;
      kernel_debug(0x52D340Cu, (uintptr_t)this, 0LL, 0LL, 6uLL, 0LL);
    }
    (*(void (__fastcall **)(AppleUSBUHCI *, signed __int64))(*(_QWORD *)this + 2976LL))(this, v1);
  }
  if ( *((_BYTE *)this + 858) & 2 )
  {
    *((_WORD *)this + 429) = 0;
    if ( *(_BYTE *)v3 & 2 )
    {
      if ( *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D340Cu, (uintptr_t)this, 0LL, 0LL, 7uLL, 0LL);
    }
  }
  if ( *((_BYTE *)this + 860) & 1 )
  {
    *((_WORD *)this + 430) = 0;
    v13 = *((_QWORD *)this + 1176);
    if ( *((_QWORD *)this + 1179) != v13 )
    {
      *((_QWORD *)this + 1175) = *((_QWORD *)this + 1174);
      *((_QWORD *)this + 1179) = v13;
    }
    v14 = *((_DWORD *)this + 2345);
    v15 = *((_DWORD *)this + 2344);
  }
  if ( v4 )
  {
    IOSleep(1000LL);
    if ( *(_BYTE *)v3 & 2 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D340Cu, (uintptr_t)this, v2, (unsigned __int8)v4, 5uLL, 0LL);
    AppleUSBUHCI::Reset(this, 1);
    AppleUSBUHCI::Run(this, 1);
  }
  v16 = *(_DWORD *)v3 & 2;
  if ( *((_QWORD *)this + 57) == 4LL )
  {
    if ( v16 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D340Cu, (uintptr_t)this, v2, 0LL, 9uLL, 0LL);
    AppleUSBUHCI::ProcessCompletedTransactions(this);
    AppleUSBUHCI::RHCheckStatus(this);
  }
  else if ( v16 && *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
  {
    kernel_debug(0x52D340Cu, (uintptr_t)this, 0LL, 0LL, 0xAuLL, 0LL);
  }
  if ( *(_BYTE *)v3 & 2 )
  {
    if ( *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D340Eu, (uintptr_t)this, 0LL, 0LL, 0LL, 0LL);
  }
}
// D080: using guessed type __int64 off_D080[4];
// D090: using guessed type __int64 off_D090[2];
// 20DA8: using guessed type int __fastcall IOSleep(_QWORD);

//----- (000000000000B688) ----------------------------------------------------
__int64 __fastcall AppleUSBUHCI::GetFrameNumberInternal(AppleUSBUHCI *this)
{
  signed __int64 v1; // rbx@2
  unsigned int v2; // ebx@6
  unsigned __int64 v3; // r12@6
  unsigned int v4; // er15@6

  if ( AppleUSBUHCI::ioRead16(this, 2) & 0x20 )
  {
    v1 = 0LL;
    if ( *((_QWORD *)this + 57) == 4LL )
    {
      v1 = 0LL;
      if ( *(_BYTE *)off_D080[0] & 2 )
      {
        v1 = 0LL;
        if ( *(_DWORD *)off_D090[0] & 0xFFFFFFF7 )
        {
          v1 = 0LL;
          kernel_debug(0x52D3404u, (uintptr_t)this, 0x20uLL, 0LL, 0LL, 0LL);
        }
      }
    }
  }
  else
  {
    v2 = *((_DWORD *)this + 2356);
    v3 = *((_QWORD *)this + 1177) & 0xFFFFFFFFFFFFF800LL;
    v4 = AppleUSBUHCI::ioRead16(this, 6) & 0x7FF;
    if ( v4 <= v2 )
    {
      v1 = (v3 + 2048) | (unsigned __int16)v4;
      *((_QWORD *)this + 1176) = v1;
      *((_QWORD *)this + 1174) = mach_absolute_time();
    }
    else
    {
      v1 = v3 | (unsigned __int16)v4;
    }
    *((_DWORD *)this + 2356) = v4;
    *((_QWORD *)this + 1177) = v1;
  }
  return v1;
}
// D080: using guessed type __int64 off_D080[4];
// D090: using guessed type __int64 off_D090[2];

//----- (000000000000B76F) ----------------------------------------------------
int _start()
{
  int result; // eax@2

  if ( _realmain )
    result = _realmain();
  else
    result = 0;
  return result;
}
// F508: using guessed type int (*_realmain)(void);

//----- (000000000000B789) ----------------------------------------------------
__int64 *OSKextGetCurrentIdentifier()
{
  return &kmod_info + 2;
}
// F300: using guessed type __int64 kmod_info;

//----- (000000000000B79A) ----------------------------------------------------
__int64 *OSKextGetCurrentVersionString()
{
  return &kmod_info + 10;
}
// F300: using guessed type __int64 kmod_info;

//----- (000000000000B7AB) ----------------------------------------------------
__int64 OSKextGetCurrentLoadTag()
{
  return *((_DWORD *)&kmod_info + 3);
}
// F300: using guessed type __int64 kmod_info;

//----- (000000000000B7BB) ----------------------------------------------------
int _stop()
{
  int result; // eax@2

  if ( _antimain )
    result = _antimain();
  else
    result = 0;
  return result;
}
// F510: using guessed type int (*_antimain)(void);

// ALL OK, 287 function(s) have been successfully decompiled
