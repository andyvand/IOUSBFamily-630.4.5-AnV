/* This file has been generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2014 Hex-Rays <info@hex-rays.com>

   Detected compiler: GNU C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

__int64 __fastcall AppleEHCIedMemoryBlock::MetaClass::MetaClass(AppleEHCIedMemoryBlock::MetaClass *__hidden this); // idb
__int64 __fastcall AppleEHCIedMemoryBlock::MetaClass::~MetaClass(AppleEHCIedMemoryBlock::MetaClass *__hidden this); // idb
__int64 __fastcall AppleEHCIedMemoryBlock::AppleEHCIedMemoryBlock(__int64 a1);
__int64 __fastcall AppleEHCIedMemoryBlock::AppleEHCIedMemoryBlock(__int64 a1);
__int64 __fastcall AppleEHCIedMemoryBlock::~AppleEHCIedMemoryBlock(AppleEHCIedMemoryBlock *__hidden this); // idb
__int64 __fastcall AppleEHCIedMemoryBlock::~AppleEHCIedMemoryBlock(AppleEHCIedMemoryBlock *__hidden this); // idb
void __fastcall AppleEHCIedMemoryBlock::~AppleEHCIedMemoryBlock(AppleEHCIedMemoryBlock *this);
__int64 __fastcall AppleEHCIedMemoryBlock::getMetaClass(AppleEHCIedMemoryBlock *__hidden this); // idb
__int64 __fastcall AppleEHCIedMemoryBlock::MetaClass::MetaClass(AppleEHCIedMemoryBlock::MetaClass *__hidden this); // idb
__int64 __fastcall AppleEHCIedMemoryBlock::MetaClass::alloc(AppleEHCIedMemoryBlock::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall AppleEHCIedMemoryBlock::AppleEHCIedMemoryBlock(__int64 a1);
__int64 __fastcall AppleEHCIedMemoryBlock::AppleEHCIedMemoryBlock(__int64 a1);
__int64 __fastcall AppleEHCIedMemoryBlock::NewMemoryBlock(AppleEHCIedMemoryBlock *this, unsigned __int64 a2);
__int64 __fastcall AppleEHCIedMemoryBlock::NumEDs(AppleEHCIedMemoryBlock *__hidden this); // idb
__int64 __fastcall AppleEHCIedMemoryBlock::GetPhysicalPtr(AppleEHCIedMemoryBlock *__hidden this, unsigned int); // idb
__int64 __fastcall AppleEHCIedMemoryBlock::GetLogicalPtr(AppleEHCIedMemoryBlock *__hidden this, unsigned int); // idb
__int64 __fastcall AppleEHCIedMemoryBlock::GetNextBlock(AppleEHCIedMemoryBlock *__hidden this); // idb
void __fastcall AppleEHCIedMemoryBlock::SetNextBlock(AppleEHCIedMemoryBlock *this, AppleEHCIedMemoryBlock *a2);
int __fastcall AppleEHCIedMemoryBlock::free(AppleEHCIedMemoryBlock *this);
__int64 __fastcall AppleEHCIedMemoryBlock::MetaClass::~MetaClass(AppleEHCIedMemoryBlock::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a();
__int64 `global destructor keyed to'_a();
__int64 __fastcall AppleEHCIitdMemoryBlock::MetaClass::MetaClass(AppleEHCIitdMemoryBlock::MetaClass *__hidden this); // idb
__int64 __fastcall AppleEHCIitdMemoryBlock::MetaClass::~MetaClass(AppleEHCIitdMemoryBlock::MetaClass *__hidden this); // idb
__int64 __fastcall AppleEHCIitdMemoryBlock::AppleEHCIitdMemoryBlock(__int64 a1);
__int64 __fastcall AppleEHCIitdMemoryBlock::AppleEHCIitdMemoryBlock(__int64 a1);
__int64 __fastcall AppleEHCIitdMemoryBlock::~AppleEHCIitdMemoryBlock(AppleEHCIitdMemoryBlock *__hidden this); // idb
__int64 __fastcall AppleEHCIitdMemoryBlock::~AppleEHCIitdMemoryBlock(AppleEHCIitdMemoryBlock *__hidden this); // idb
void __fastcall AppleEHCIitdMemoryBlock::~AppleEHCIitdMemoryBlock(AppleEHCIitdMemoryBlock *this);
__int64 __fastcall AppleEHCIitdMemoryBlock::getMetaClass(AppleEHCIitdMemoryBlock *__hidden this); // idb
__int64 __fastcall AppleEHCIitdMemoryBlock::MetaClass::MetaClass(AppleEHCIitdMemoryBlock::MetaClass *__hidden this); // idb
__int64 __fastcall AppleEHCIitdMemoryBlock::MetaClass::alloc(AppleEHCIitdMemoryBlock::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall AppleEHCIitdMemoryBlock::AppleEHCIitdMemoryBlock(__int64 a1);
__int64 __fastcall AppleEHCIitdMemoryBlock::AppleEHCIitdMemoryBlock(__int64 a1);
__int64 __fastcall AppleEHCIitdMemoryBlock::NewMemoryBlock(AppleEHCIitdMemoryBlock *this, unsigned __int64 a2);
__int64 __fastcall AppleEHCIitdMemoryBlock::NumTDs(AppleEHCIitdMemoryBlock *__hidden this); // idb
__int64 __fastcall AppleEHCIitdMemoryBlock::GetPhysicalPtr(AppleEHCIitdMemoryBlock *__hidden this, unsigned int); // idb
__int64 __fastcall AppleEHCIitdMemoryBlock::GetLogicalPtr(AppleEHCIitdMemoryBlock *__hidden this, unsigned int); // idb
__int64 __fastcall AppleEHCIitdMemoryBlock::GetNextBlock(AppleEHCIitdMemoryBlock *__hidden this); // idb
void __fastcall AppleEHCIitdMemoryBlock::SetNextBlock(AppleEHCIitdMemoryBlock *this, AppleEHCIitdMemoryBlock *a2);
int __fastcall AppleEHCIitdMemoryBlock::free(AppleEHCIitdMemoryBlock *this);
__int64 __fastcall AppleEHCIitdMemoryBlock::MetaClass::~MetaClass(AppleEHCIitdMemoryBlock::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_0();
__int64 `global destructor keyed to'_a_0();
__int64 __fastcall AppleEHCIQueueHead::MetaClass::MetaClass(AppleEHCIQueueHead::MetaClass *__hidden this); // idb
__int64 __fastcall AppleEHCIQueueHead::MetaClass::~MetaClass(AppleEHCIQueueHead::MetaClass *__hidden this); // idb
__int64 __fastcall AppleEHCIQueueHead::AppleEHCIQueueHead(IOUSBControllerListElement *a1, const OSMetaClass *a2);
__int64 __fastcall AppleEHCIQueueHead::AppleEHCIQueueHead(IOUSBControllerListElement *a1, const OSMetaClass *a2);
__int64 __fastcall AppleEHCIQueueHead::~AppleEHCIQueueHead(AppleEHCIQueueHead *__hidden this); // idb
__int64 __fastcall AppleEHCIQueueHead::~AppleEHCIQueueHead(AppleEHCIQueueHead *__hidden this); // idb
void __fastcall AppleEHCIQueueHead::~AppleEHCIQueueHead(AppleEHCIQueueHead *this);
__int64 __fastcall AppleEHCIQueueHead::getMetaClass(AppleEHCIQueueHead *__hidden this); // idb
__int64 __fastcall AppleEHCIQueueHead::MetaClass::MetaClass(AppleEHCIQueueHead::MetaClass *__hidden this); // idb
IOUSBControllerListElement *__fastcall AppleEHCIQueueHead::MetaClass::alloc(AppleEHCIQueueHead::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall AppleEHCIQueueHead::AppleEHCIQueueHead(IOUSBControllerListElement *a1);
__int64 __fastcall AppleEHCIQueueHead::AppleEHCIQueueHead(IOUSBControllerListElement *a1);
__int64 __fastcall AppleEHCIQueueHead::WithSharedMemory(__int64 a1, unsigned __int64 a2);
__int64 __fastcall AppleEHCIQueueHead::GetSharedLogical(AppleEHCIQueueHead *__hidden this); // idb
__int64 __fastcall AppleEHCIQueueHead::SetPhysicalLink(AppleEHCIQueueHead *this, int a2);
__int64 __fastcall AppleEHCIQueueHead::GetPhysicalLink(AppleEHCIQueueHead *__hidden this); // idb
__int64 __fastcall AppleEHCIQueueHead::GetPhysicalAddrWithType(AppleEHCIQueueHead *__hidden this); // idb
__int64 __fastcall AppleEHCIQueueHead::NormalizedPollingRate(AppleEHCIQueueHead *__hidden this); // idb
void __fastcall AppleEHCIQueueHead::print(uintptr_t arg2, signed int a2, uintptr_t a3);
__int64 __fastcall AppleEHCIIsochTransferDescriptor::MetaClass::MetaClass(AppleEHCIIsochTransferDescriptor::MetaClass *__hidden this); // idb
__int64 __fastcall AppleEHCIIsochTransferDescriptor::MetaClass::~MetaClass(AppleEHCIIsochTransferDescriptor::MetaClass *__hidden this); // idb
__int64 __fastcall AppleEHCIIsochTransferDescriptor::AppleEHCIIsochTransferDescriptor(IOUSBControllerIsochListElement *a1, const OSMetaClass *a2);
__int64 __fastcall AppleEHCIIsochTransferDescriptor::AppleEHCIIsochTransferDescriptor(IOUSBControllerIsochListElement *a1, const OSMetaClass *a2);
__int64 __fastcall AppleEHCIIsochTransferDescriptor::~AppleEHCIIsochTransferDescriptor(AppleEHCIIsochTransferDescriptor *__hidden this); // idb
__int64 __fastcall AppleEHCIIsochTransferDescriptor::~AppleEHCIIsochTransferDescriptor(AppleEHCIIsochTransferDescriptor *__hidden this); // idb
void __fastcall AppleEHCIIsochTransferDescriptor::~AppleEHCIIsochTransferDescriptor(AppleEHCIIsochTransferDescriptor *this);
__int64 __fastcall AppleEHCIIsochTransferDescriptor::getMetaClass(AppleEHCIIsochTransferDescriptor *__hidden this); // idb
__int64 __fastcall AppleEHCIIsochTransferDescriptor::MetaClass::MetaClass(AppleEHCIIsochTransferDescriptor::MetaClass *__hidden this); // idb
IOUSBControllerIsochListElement *__fastcall AppleEHCIIsochTransferDescriptor::MetaClass::alloc(AppleEHCIIsochTransferDescriptor::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall AppleEHCIIsochTransferDescriptor::AppleEHCIIsochTransferDescriptor(IOUSBControllerIsochListElement *a1);
__int64 __fastcall AppleEHCIIsochTransferDescriptor::AppleEHCIIsochTransferDescriptor(IOUSBControllerIsochListElement *a1);
__int64 __fastcall AppleEHCIIsochTransferDescriptor::WithSharedMemory(__int64 a1, unsigned __int64 a2);
__int64 __fastcall AppleEHCIIsochTransferDescriptor::GetSharedLogical(AppleEHCIIsochTransferDescriptor *__hidden this); // idb
__int64 __fastcall AppleEHCIIsochTransferDescriptor::SetPhysicalLink(AppleEHCIIsochTransferDescriptor *this, int a2);
__int64 __fastcall AppleEHCIIsochTransferDescriptor::GetPhysicalLink(AppleEHCIIsochTransferDescriptor *__hidden this); // idb
__int64 __fastcall AppleEHCIIsochTransferDescriptor::GetPhysicalAddrWithType(AppleEHCIIsochTransferDescriptor *__hidden this); // idb
__int64 __fastcall AppleEHCIIsochTransferDescriptor::mungeEHCIStatus(AppleEHCIIsochTransferDescriptor *this, unsigned int a2, unsigned __int16 *a3, int a4, char a5);
__int64 __fastcall AppleEHCIIsochTransferDescriptor::UpdateFrameList(AppleEHCIIsochTransferDescriptor *this, __int64 a2);
__int64 __fastcall AppleEHCIIsochTransferDescriptor::Deallocate(AppleEHCIIsochTransferDescriptor *a1, AppleUSBEHCI *this);
int __fastcall AppleEHCIIsochTransferDescriptor::print(AppleEHCIIsochTransferDescriptor *this);
__int64 __fastcall AppleEHCISplitIsochTransferDescriptor::MetaClass::MetaClass(AppleEHCISplitIsochTransferDescriptor::MetaClass *__hidden this); // idb
__int64 __fastcall AppleEHCISplitIsochTransferDescriptor::MetaClass::~MetaClass(AppleEHCISplitIsochTransferDescriptor::MetaClass *__hidden this); // idb
__int64 __fastcall AppleEHCISplitIsochTransferDescriptor::AppleEHCISplitIsochTransferDescriptor(IOUSBControllerIsochListElement *a1, const OSMetaClass *a2);
__int64 __fastcall AppleEHCISplitIsochTransferDescriptor::AppleEHCISplitIsochTransferDescriptor(IOUSBControllerIsochListElement *a1, const OSMetaClass *a2);
__int64 __fastcall AppleEHCISplitIsochTransferDescriptor::~AppleEHCISplitIsochTransferDescriptor(AppleEHCISplitIsochTransferDescriptor *__hidden this); // idb
__int64 __fastcall AppleEHCISplitIsochTransferDescriptor::~AppleEHCISplitIsochTransferDescriptor(AppleEHCISplitIsochTransferDescriptor *__hidden this); // idb
void __fastcall AppleEHCISplitIsochTransferDescriptor::~AppleEHCISplitIsochTransferDescriptor(AppleEHCISplitIsochTransferDescriptor *this);
__int64 __fastcall AppleEHCISplitIsochTransferDescriptor::getMetaClass(AppleEHCISplitIsochTransferDescriptor *__hidden this); // idb
__int64 __fastcall AppleEHCISplitIsochTransferDescriptor::MetaClass::MetaClass(AppleEHCISplitIsochTransferDescriptor::MetaClass *__hidden this); // idb
IOUSBControllerIsochListElement *__fastcall AppleEHCISplitIsochTransferDescriptor::MetaClass::alloc(AppleEHCISplitIsochTransferDescriptor::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall AppleEHCISplitIsochTransferDescriptor::AppleEHCISplitIsochTransferDescriptor(IOUSBControllerIsochListElement *a1);
__int64 __fastcall AppleEHCISplitIsochTransferDescriptor::AppleEHCISplitIsochTransferDescriptor(IOUSBControllerIsochListElement *a1);
__int64 __fastcall AppleEHCISplitIsochTransferDescriptor::WithSharedMemory(__int64 a1, unsigned __int64 a2);
__int64 __fastcall AppleEHCISplitIsochTransferDescriptor::GetSharedLogical(AppleEHCISplitIsochTransferDescriptor *__hidden this); // idb
__int64 __fastcall AppleEHCISplitIsochTransferDescriptor::SetPhysicalLink(AppleEHCISplitIsochTransferDescriptor *this, int a2);
__int64 __fastcall AppleEHCISplitIsochTransferDescriptor::GetPhysicalLink(AppleEHCISplitIsochTransferDescriptor *__hidden this); // idb
__int64 __fastcall AppleEHCISplitIsochTransferDescriptor::GetPhysicalAddrWithType(AppleEHCISplitIsochTransferDescriptor *__hidden this); // idb
__int64 __fastcall AppleEHCISplitIsochTransferDescriptor::UpdateFrameList(AppleEHCISplitIsochTransferDescriptor *this, uintptr_t a2);
__int64 __fastcall AppleEHCISplitIsochTransferDescriptor::Deallocate(AppleEHCISplitIsochTransferDescriptor *a1, AppleUSBEHCI *this);
int __fastcall AppleEHCISplitIsochTransferDescriptor::print(AppleEHCISplitIsochTransferDescriptor *this);
__int64 __fastcall AppleEHCIIsochEndpoint::MetaClass::MetaClass(AppleEHCIIsochEndpoint::MetaClass *__hidden this); // idb
__int64 __fastcall AppleEHCIIsochEndpoint::MetaClass::~MetaClass(AppleEHCIIsochEndpoint::MetaClass *__hidden this); // idb
__int64 __fastcall AppleEHCIIsochEndpoint::AppleEHCIIsochEndpoint(IOUSBControllerIsochEndpoint *a1, const OSMetaClass *a2);
__int64 __fastcall AppleEHCIIsochEndpoint::AppleEHCIIsochEndpoint(IOUSBControllerIsochEndpoint *a1, const OSMetaClass *a2);
__int64 __fastcall AppleEHCIIsochEndpoint::~AppleEHCIIsochEndpoint(AppleEHCIIsochEndpoint *__hidden this); // idb
__int64 __fastcall AppleEHCIIsochEndpoint::~AppleEHCIIsochEndpoint(AppleEHCIIsochEndpoint *__hidden this); // idb
void __fastcall AppleEHCIIsochEndpoint::~AppleEHCIIsochEndpoint(AppleEHCIIsochEndpoint *this);
__int64 __fastcall AppleEHCIIsochEndpoint::getMetaClass(AppleEHCIIsochEndpoint *__hidden this); // idb
__int64 __fastcall AppleEHCIIsochEndpoint::MetaClass::MetaClass(AppleEHCIIsochEndpoint::MetaClass *__hidden this); // idb
IOUSBControllerIsochEndpoint *__fastcall AppleEHCIIsochEndpoint::MetaClass::alloc(AppleEHCIIsochEndpoint::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall AppleEHCIIsochEndpoint::AppleEHCIIsochEndpoint(IOUSBControllerIsochEndpoint *a1);
__int64 __fastcall AppleEHCIIsochEndpoint::AppleEHCIIsochEndpoint(IOUSBControllerIsochEndpoint *a1);
int __fastcall AppleEHCIIsochEndpoint::init(AppleEHCIIsochEndpoint *this);
void __fastcall AppleEHCIIsochEndpoint::print(AppleEHCIIsochEndpoint *this);
__int64 __fastcall AppleEHCIQueueHead::MetaClass::~MetaClass(AppleEHCIQueueHead::MetaClass *__hidden this); // idb
__int64 __fastcall AppleEHCIIsochTransferDescriptor::MetaClass::~MetaClass(AppleEHCIIsochTransferDescriptor::MetaClass *__hidden this); // idb
__int64 __fastcall AppleEHCISplitIsochTransferDescriptor::MetaClass::~MetaClass(AppleEHCISplitIsochTransferDescriptor::MetaClass *__hidden this); // idb
__int64 __fastcall AppleEHCIIsochEndpoint::MetaClass::~MetaClass(AppleEHCIIsochEndpoint::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_1();
__int64 `global destructor keyed to'_a_1();
__int64 __fastcall AppleEHCIsitdMemoryBlock::MetaClass::MetaClass(AppleEHCIsitdMemoryBlock::MetaClass *__hidden this); // idb
__int64 __fastcall AppleEHCIsitdMemoryBlock::MetaClass::~MetaClass(AppleEHCIsitdMemoryBlock::MetaClass *__hidden this); // idb
__int64 __fastcall AppleEHCIsitdMemoryBlock::AppleEHCIsitdMemoryBlock(__int64 a1);
__int64 __fastcall AppleEHCIsitdMemoryBlock::AppleEHCIsitdMemoryBlock(__int64 a1);
__int64 __fastcall AppleEHCIsitdMemoryBlock::~AppleEHCIsitdMemoryBlock(AppleEHCIsitdMemoryBlock *__hidden this); // idb
__int64 __fastcall AppleEHCIsitdMemoryBlock::~AppleEHCIsitdMemoryBlock(AppleEHCIsitdMemoryBlock *__hidden this); // idb
void __fastcall AppleEHCIsitdMemoryBlock::~AppleEHCIsitdMemoryBlock(AppleEHCIsitdMemoryBlock *this);
__int64 __fastcall AppleEHCIsitdMemoryBlock::getMetaClass(AppleEHCIsitdMemoryBlock *__hidden this); // idb
__int64 __fastcall AppleEHCIsitdMemoryBlock::MetaClass::MetaClass(AppleEHCIsitdMemoryBlock::MetaClass *__hidden this); // idb
__int64 __fastcall AppleEHCIsitdMemoryBlock::MetaClass::alloc(AppleEHCIsitdMemoryBlock::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall AppleEHCIsitdMemoryBlock::AppleEHCIsitdMemoryBlock(__int64 a1);
__int64 __fastcall AppleEHCIsitdMemoryBlock::AppleEHCIsitdMemoryBlock(__int64 a1);
__int64 __fastcall AppleEHCIsitdMemoryBlock::NewMemoryBlock(AppleEHCIsitdMemoryBlock *this, unsigned __int64 a2);
__int64 __fastcall AppleEHCIsitdMemoryBlock::NumTDs(AppleEHCIsitdMemoryBlock *__hidden this); // idb
unsigned __int64 __fastcall AppleEHCIsitdMemoryBlock::GetPhysicalPtr(AppleEHCIsitdMemoryBlock *this, unsigned int a2);
unsigned __int64 __fastcall AppleEHCIsitdMemoryBlock::GetLogicalPtr(AppleEHCIsitdMemoryBlock *this, unsigned int a2);
__int64 __fastcall AppleEHCIsitdMemoryBlock::GetNextBlock(AppleEHCIsitdMemoryBlock *__hidden this); // idb
void __fastcall AppleEHCIsitdMemoryBlock::SetNextBlock(AppleEHCIsitdMemoryBlock *this, AppleEHCIsitdMemoryBlock *a2);
int __fastcall AppleEHCIsitdMemoryBlock::free(AppleEHCIsitdMemoryBlock *this);
__int64 __fastcall AppleEHCIsitdMemoryBlock::MetaClass::~MetaClass(AppleEHCIsitdMemoryBlock::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_2();
__int64 `global destructor keyed to'_a_2();
__int64 __fastcall AppleEHCItdMemoryBlock::MetaClass::MetaClass(AppleEHCItdMemoryBlock::MetaClass *__hidden this); // idb
__int64 __fastcall AppleEHCItdMemoryBlock::MetaClass::~MetaClass(AppleEHCItdMemoryBlock::MetaClass *__hidden this); // idb
__int64 __fastcall AppleEHCItdMemoryBlock::AppleEHCItdMemoryBlock(__int64 a1);
__int64 __fastcall AppleEHCItdMemoryBlock::AppleEHCItdMemoryBlock(__int64 a1);
__int64 __fastcall AppleEHCItdMemoryBlock::~AppleEHCItdMemoryBlock(AppleEHCItdMemoryBlock *__hidden this); // idb
__int64 __fastcall AppleEHCItdMemoryBlock::~AppleEHCItdMemoryBlock(AppleEHCItdMemoryBlock *__hidden this); // idb
void __fastcall AppleEHCItdMemoryBlock::~AppleEHCItdMemoryBlock(AppleEHCItdMemoryBlock *this);
__int64 __fastcall AppleEHCItdMemoryBlock::getMetaClass(AppleEHCItdMemoryBlock *__hidden this); // idb
__int64 __fastcall AppleEHCItdMemoryBlock::MetaClass::MetaClass(AppleEHCItdMemoryBlock::MetaClass *__hidden this); // idb
__int64 __fastcall AppleEHCItdMemoryBlock::MetaClass::alloc(AppleEHCItdMemoryBlock::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall AppleEHCItdMemoryBlock::AppleEHCItdMemoryBlock(__int64 a1);
__int64 __fastcall AppleEHCItdMemoryBlock::AppleEHCItdMemoryBlock(__int64 a1);
__int64 __fastcall AppleEHCItdMemoryBlock::NewMemoryBlock(AppleEHCItdMemoryBlock *this, unsigned __int64 a2);
__int64 __fastcall AppleEHCItdMemoryBlock::NumTDs(AppleEHCItdMemoryBlock *__hidden this); // idb
AppleEHCItdMemoryBlock *__fastcall AppleEHCItdMemoryBlock::GetTD(AppleEHCItdMemoryBlock *this, unsigned int a2);
__int64 __fastcall AppleEHCItdMemoryBlock::GetNextBlock(AppleEHCItdMemoryBlock *__hidden this); // idb
void __fastcall AppleEHCItdMemoryBlock::SetNextBlock(AppleEHCItdMemoryBlock *this, AppleEHCItdMemoryBlock *a2);
int __fastcall AppleEHCItdMemoryBlock::free(AppleEHCItdMemoryBlock *this);
__int64 __fastcall AppleEHCItdMemoryBlock::MetaClass::~MetaClass(AppleEHCItdMemoryBlock::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_3();
__int64 `global destructor keyed to'_a_3();
int __fastcall AppleUSBEHCI::SwitchMuxes(AppleUSBEHCI *this, unsigned __int8 a2, unsigned int a3);
// __int64 __usercall AppleUSBEHCI::EnterTestMode@<rax>(AppleUSBEHCI *this@<rdi>, __int64 a2@<rax>);
__int64 __fastcall AppleUSBEHCI::PlacePortInMode(AppleUSBEHCI *this, unsigned int a2, int a3);
__int64 __fastcall AppleUSBEHCI::LeaveTestMode(AppleUSBEHCI *this); // idb
__int64 __fastcall AppleUSBEHCI::UIMSetTestMode(AppleUSBEHCI *this, int a2, char a3);
void __fastcall AppleUSBEHCI::PollInterrupts(AppleUSBEHCI *this, void (__cdecl *a2)(void *, void *, int, unsigned int));
int __fastcall AppleUSBEHCI::InterruptHandler(IOService *this);
__int64 __fastcall AppleUSBEHCI::PrimaryInterruptFilter(AppleUSBEHCI *this); // idb
__int64 __fastcall AppleUSBEHCI::FilterInterrupt(AppleUSBEHCI *this);
int __fastcall AppleUSBEHCI_IOLockClass::AppleUSBEHCI_IOLockClass(__int64 a1);
int __fastcall AppleUSBEHCI_IOLockClass::~AppleUSBEHCI_IOLockClass(AppleUSBEHCI_IOLockClass *this);
int __fastcall AppleUSBEHCI_IOLockClass::AppleUSBEHCI_IOLockClass(__int64 a1);
int __fastcall AppleUSBEHCI_IOLockClass::~AppleUSBEHCI_IOLockClass(AppleUSBEHCI_IOLockClass *this);
void __fastcall AppleUSBEHCI_IOLockClass::~AppleUSBEHCI_IOLockClass(AppleUSBEHCI_IOLockClass *this);
__int64 __fastcall AppleUSBEHCI::CheckSleepCapability(AppleUSBEHCI *this); // idb
__int64 __fastcall AppleUSBEHCI::ResumeUSBBus(uintptr_t arg1); // idb
// void __usercall AppleUSBEHCI::SuspendUSBBus(AppleUSBEHCI *this@<rdi>, __int64 a2@<rax>);
__int64 __fastcall AppleUSBEHCI::StopUSBBus(uintptr_t arg1); // idb
__int64 __fastcall AppleUSBEHCI::RestartUSBBus(uintptr_t arg1); // idb
__int64 __fastcall AppleUSBEHCI::SaveControllerStateForSleep(AppleUSBEHCI *this); // idb
__int64 __fastcall AppleUSBEHCI::RestoreControllerStateFromSleep(uintptr_t arg1); // idb
__int64 __fastcall AppleUSBEHCI::ResetControllerState(AppleUSBEHCI *this); // idb
__int64 __fastcall AppleUSBEHCI::RestartControllerFromReset(AppleUSBEHCI *this); // idb
__int64 __fastcall AppleUSBEHCI::DozeController(uintptr_t arg1); // idb
__int64 __fastcall AppleUSBEHCI::WakeControllerFromDoze(AppleUSBEHCI *this); // idb
__int64 __fastcall AppleUSBEHCI::EnableInterruptsFromController(uintptr_t arg1, uintptr_t a2);
int __fastcall AppleUSBEHCI::maxCapabilityForDomainState(AppleUSBEHCI *this, __int64 a2);
int __fastcall AppleUSBEHCI::powerStateDidChangeTo(uintptr_t arg1, __int64 a2, uintptr_t a3, __int64 a4);
int __fastcall AppleUSBEHCI::powerChangeDone(AppleUSBEHCI *this, uintptr_t arg2);
__int64 __fastcall AppleUSBEHCI::ToggleSMSCHubResetGPIO(__int64 a1, __int64 a2, unsigned int a3);
bool __fastcall AppleUSBEHCI::HasSMSCHubResetGPIO(__int64 a1, __int64 a2);
__int64 __fastcall AppleUSBEHCI::SMSCHubReset(AppleUSBEHCI *__hidden this, IOService *); // idb
int __fastcall `global constructor keyed to'_a_4(__int64 a1);
int `global destructor keyed to'_a_4();
signed __int64 __fastcall AppleUSBEHCI::GetRootHubDeviceDescriptor(__int64 a1, void *a2);
signed __int64 __fastcall AppleUSBEHCI::GetRootHubDescriptor(__int64 a1, void *a2);
__int64 __fastcall AppleUSBEHCI::GetRootHubConfDescriptor(__int64 a1, __int64 a2);
__int64 AppleUSBEHCI::SetRootHubDescriptor();
__int64 __fastcall AppleUSBEHCI::GetRootHubStatus(__int64 a1, __int64 a2);
__int64 __fastcall AppleUSBEHCI::SetRootHubFeature(AppleUSBEHCI *this);
__int64 __fastcall AppleUSBEHCI::ClearRootHubFeature(AppleUSBEHCI *this);
__int64 __fastcall AppleUSBEHCI::GetRootHubPortStatus(AppleUSBEHCI *this, __int64 a2, unsigned __int16 a3);
__int64 __fastcall AppleUSBEHCI::EHCIRootHubResetOverCurrentChange(AppleUSBEHCI *this, unsigned int a2);
__int64 __fastcall AppleUSBEHCI::SetRootHubPortFeature(AppleUSBEHCI *this, int a2, unsigned __int16 a3);
__int64 __fastcall AppleUSBEHCI::EHCIRootHubPortSuspend(uintptr_t arg1, uintptr_t arg2, char a3);
__int64 __fastcall AppleUSBEHCI::EHCIRootHubResetPort(uintptr_t arg1, unsigned __int16); // idb
__int64 __fastcall AppleUSBEHCI::EHCIRootHubPortEnable(uintptr_t arg1, unsigned __int16 a2, char a3);
__int64 __fastcall AppleUSBEHCI::EHCIRootHubPortPower(AppleUSBEHCI *this, unsigned __int16 a2, char a3);
__int64 __fastcall AppleUSBEHCI::EHCIRootHubPower(AppleUSBEHCI *this);
__int64 __fastcall AppleUSBEHCI::ClearRootHubPortFeature(AppleUSBEHCI *this, int a2, unsigned __int16 a3);
__int64 __fastcall AppleUSBEHCI::EHCIRootHubResetChangeConnection(AppleUSBEHCI *this, unsigned int a2);
__int64 __fastcall AppleUSBEHCI::EHCIRootHubResetEnableChange(AppleUSBEHCI *this, unsigned int a2);
__int64 __fastcall AppleUSBEHCI::EHCIRootHubResetSuspendChange(AppleUSBEHCI *this, __int16 a2);
__int64 __fastcall AppleUSBEHCI::EHCIRootHubResetResetChange(AppleUSBEHCI *this, __int16 a2);
__int64 __fastcall AppleUSBEHCI::GetRootHubPortState(AppleUSBEHCI *this, unsigned __int8 *a2);
__int64 __fastcall AppleUSBEHCI::SetHubAddress(AppleUSBEHCI *this, __int16 a2);
__int64 __fastcall getPortSCForWriting(__int64 a1, int a2);
int __fastcall AppleUSBEHCI::EHCIMuxedPortDeviceDisconnected(AppleUSBEHCI *this, char *a2);
int AppleUSBEHCI::waitForSOF();
void __fastcall AppleUSBEHCI::UIMRootHubStatusChange(AppleUSBEHCI *this);
void __fastcall AppleUSBEHCI::UIMRootHubStatusChange(AppleUSBEHCI *this);
void __fastcall AppleUSBEHCI::RHCheckForPortResumes(AppleUSBEHCI *this);
__int64 __fastcall AppleUSBEHCI::SimulateEDDelete(AppleUSBEHCI *__hidden this, __int16, __int16); // idb
__int64 __fastcall AppleUSBEHCI::SimulateEDAbort(AppleUSBEHCI *__hidden this, __int16, __int16); // idb
__int64 __fastcall AppleUSBEHCI::GetRootHubStringDescriptor(__int64 a1, char a2, __int64 a3);
uint64_t __fastcall AppleUSBEHCI::LastRootHubPortStatusChanged(AppleUSBEHCI *this, char a2);
unsigned __int8 __fastcall AppleUSBEHCI::GetNumberOfPorts(AppleUSBEHCI *this, unsigned __int8 *a2);
int __fastcall AppleUSBEHCI::RHResumePortTimerEntry(AppleUSBEHCI *this, OSObject *a2, void *a3);
int __fastcall AppleUSBEHCI::RHResumePortTimer(AppleUSBEHCI *this, unsigned int a2);
__int64 __fastcall AppleUSBEHCI::RHResumePortCompletionEntry(AppleUSBEHCI *__hidden this, OSObject *, void *, void *, void *, void *); // idb
__int64 __fastcall AppleUSBEHCI::RHResumePortCompletion(uintptr_t arg1, uintptr_t arg2); // idb
__int64 __fastcall AppleUSBEHCI::RHCompleteResumeOnAllPorts(AppleUSBEHCI *__hidden this); // idb
__int64 __fastcall AppleUSBEHCI::MakeEmptyEndPoint(AppleUSBEHCI *this, unsigned __int64 a2, unsigned __int8 a3, unsigned __int16 a4, unsigned __int8 a5, unsigned __int16 a6, int a7, unsigned __int8 a8);
__int64 __fastcall AppleUSBEHCI::FindControlBulkEndpoint(AppleUSBEHCI *this, int a2, const OSMetaClass *a3, AppleEHCIQueueHead **a4, __int16 a5);
__int64 __fastcall AppleUSBEHCI::UIMAbortEndpoint(AppleUSBEHCI *this, uintptr_t a2, uintptr_t a3, __int16 a4);
__int64 __fastcall AppleUSBEHCI::HandleEndpointAbort(AppleUSBEHCI *this, uintptr_t a2, uintptr_t a3, __int16 a4, unsigned __int8 a5);
__int64 __fastcall AppleUSBEHCI::UIMClearEndpointStall(AppleUSBEHCI *this, uintptr_t a2, uintptr_t a3, __int16 a4);
__int64 __fastcall AppleUSBEHCI::UIMDeleteEndpoint(AppleUSBEHCI *this, unsigned __int16 a2, __int16 a3, __int16 a4);
__int64 __fastcall AppleUSBEHCI::DeleteIsochEP(AppleUSBEHCI *this, AppleEHCIIsochEndpoint *); // idb
__int64 __fastcall AppleUSBEHCI::FindInterruptEndpoint(AppleUSBEHCI *this, int a2, int a3, unsigned __int8 a4, IOUSBControllerListElement **a5);
int __fastcall AppleUSBEHCI::printAsyncQueue(uintptr_t arg1, signed int a2, const char *a3, __int64 a4, char a5);
void __fastcall AppleUSBEHCI::printInactiveQueue(AppleUSBEHCI *this, unsigned int a2, const char *a3);
__int64 __fastcall AppleUSBEHCI::unlinkIntEndpoint(AppleUSBEHCI *this, AppleEHCIQueueHead *this); // idb
__int64 __fastcall AppleUSBEHCI::ReturnInterruptBandwidth(AppleUSBEHCI *this, AppleEHCIQueueHead *); // idb
void __fastcall AppleUSBEHCI::unlinkAsyncEndpoint(uintptr_t arg1, AppleEHCIQueueHead *this, uintptr_t arg3);
__int64 __fastcall AppleUSBEHCI::EHCIUIMDoDoneQueueProcessing(__int64 a1, __int64 a2, int a3, __int64 a4, __int64 a5);
__int64 __fastcall AppleUSBEHCI::AddEmptyCBEndPoint(AppleUSBEHCI *this, unsigned __int64 a2, unsigned __int8 a3, unsigned __int16 a4, unsigned __int8 a5, unsigned __int16 a6, int a7, unsigned __int8 a8);
void __fastcall AppleUSBEHCI::linkAsyncEndpoint(AppleUSBEHCI *this, AppleEHCIQueueHead *a2);
void __fastcall AppleUSBEHCI::checkHeads(AppleUSBEHCI *this);
__int64 __fastcall AppleUSBEHCI::UIMCreateControlEndpoint(AppleUSBEHCI *this);
signed __int64 __fastcall AppleUSBEHCI::UIMCreateControlTransfer(AppleUSBEHCI *this, __int64 a2, __int64 a3, IOUSBCommand *a4, void *a5);
signed __int64 AppleUSBEHCI::UIMCreateControlTransfer();
__int64 __fastcall AppleUSBEHCI::UIMCreateControlEndpoint(AppleUSBEHCI *this, int a2, unsigned __int8 a3, unsigned __int16 a4, unsigned __int8 a5, unsigned __int16 a6, int a7);
signed __int64 AppleUSBEHCI::UIMCreateControlTransfer();
// __int64 __usercall AppleUSBEHCI::UIMCreateControlTransfer@<rax>(AppleUSBEHCI *this@<rdi>, unsigned int a2@<edx>, __int64 a3@<rcx>, int a4@<esi>, __int64 a5@<r8>, unsigned int a6, unsigned __int16 a7);
__int64 __fastcall AppleUSBEHCI::allocateTDs(uintptr_t a1, AppleEHCIQueueHead *a2, __int64 a3, __int64 a4, unsigned int a5, int a6, unsigned __int8 a7);
__int64 __fastcall AppleUSBEHCI::scavengeIsocTransactions(AppleUSBEHCI *this, void (__cdecl *a2)(void *, void *, int, unsigned int), char a3);
__int64 __fastcall AppleUSBEHCI::scavengeAnIsocTD(AppleUSBEHCI *__hidden this, IOUSBControllerIsochListElement *, void (__cdecl *)(void *, void *, int, unsigned int)); // idb
void __fastcall AppleUSBEHCI::AddIsocFramesToSchedule(AppleUSBEHCI *this, AppleEHCIIsochEndpoint *a2);
__int64 __fastcall AppleUSBEHCI::scavengeAnEndpointQueue(AppleUSBEHCI *__hidden this, IOUSBControllerListElement *, void (__cdecl *)(void *, void *, int, unsigned int)); // idb
__int64 __fastcall AppleUSBEHCI::scavengeCompletedTransactions(AppleUSBEHCI *this, void (__cdecl *)(void *, void *, int, unsigned int)); // idb
__int64 __fastcall AppleUSBEHCI::UIMCreateBulkEndpoint(AppleUSBEHCI *this);
__int64 __fastcall AppleUSBEHCI::UIMCreateBulkEndpoint(AppleUSBEHCI *this, unsigned __int8 a2, unsigned __int8 a3, unsigned int a4, __int64 a5, unsigned __int16 a6, unsigned __int16 a7, int a8);
__int64 __fastcall AppleUSBEHCI::UIMCreateBulkTransfer(AppleUSBEHCI *this, IOUSBCommand *this); // idb
signed __int64 AppleUSBEHCI::UIMCreateBulkTransfer();
void __fastcall AppleUSBEHCI::returnTransactions(uintptr_t arg1, AppleEHCIQueueHead *this, __int64 a3, uintptr_t a4, unsigned __int8 a5);
__int64 __fastcall AppleUSBEHCI::HaltAsyncEndpoint(uintptr_t arg1, AppleEHCIQueueHead *this, uintptr_t arg3); // idb
__int64 __fastcall AppleUSBEHCI::AbortIsochEP(AppleUSBEHCI *this, uintptr_t arg1); // idb
__int64 __fastcall AppleUSBEHCI::HaltInterruptEndpoint(AppleUSBEHCI *this, AppleEHCIQueueHead *this); // idb
void __fastcall AppleUSBEHCI::maybeLinkAsyncEndpoint(AppleUSBEHCI *this, AppleEHCIQueueHead *a2);
void __fastcall AppleUSBEHCI::printTD(uintptr_t arg1, uintptr_t arg2, signed int a3);
void __fastcall AppleUSBEHCI::printPeriodicList(AppleUSBEHCI *this, __int64 a2, const char *a3);
__int64 __fastcall AppleUSBEHCI::MakeEmptyIntEndPoint(AppleUSBEHCI *this, unsigned __int64 a2, unsigned __int8 a3, unsigned __int16 a4, unsigned __int8 a5, unsigned __int16 a6, int a7, unsigned __int8 a8);
__int64 __fastcall AppleUSBEHCI::UIMCreateInterruptEndpoint(AppleUSBEHCI *this);
__int64 __fastcall AppleUSBEHCI::UIMCreateInterruptEndpoint(AppleUSBEHCI *this, int a2, __int16 a3, unsigned __int8 a4, __int16 a5, unsigned __int16 a6, __int16 a7, unsigned __int16 a8, int a9);
__int64 __fastcall AppleUSBEHCI::AllocateInterruptBandwidth(AppleUSBEHCI *this, AppleEHCIQueueHead *, AppleUSBEHCITTInfo *this); // idb
__int64 __fastcall AppleUSBEHCI::linkInterruptEndpoint(AppleUSBEHCI *this, AppleEHCIQueueHead *this); // idb
__int64 __fastcall AppleUSBEHCI::UIMCreateInterruptTransfer(AppleUSBEHCI *this, IOUSBCommand *this); // idb
signed __int64 AppleUSBEHCI::UIMCreateInterruptTransfer();
__int64 __fastcall AppleUSBEHCI::UIMCreateIsochEndpoint(AppleUSBEHCI *this);
__int64 __fastcall AppleUSBEHCI::UIMCreateIsochEndpoint(AppleUSBEHCI *this);
__int64 __fastcall AppleUSBEHCI::UIMCreateIsochEndpoint(AppleUSBEHCI *this, __int16 a2, __int16 a3, unsigned int a4, unsigned __int8 a5, unsigned __int16 a6, int a7, unsigned __int8 a8);
__int64 __fastcall AppleUSBEHCI::ReturnIsochBandwidth(AppleUSBEHCI *this, AppleEHCIIsochEndpoint *); // idb
// __int64 __usercall AppleUSBEHCI::AllocateIsochBandwidth@<rax>(AppleUSBEHCI *this@<rdi>, AppleEHCIIsochEndpoint *a2@<rsi>, AppleUSBEHCITTInfo *a3@<rdx>, int a4@<r10d>);
__int64 __fastcall AppleUSBEHCI::CreateHSIsochTransfer(uintptr_t a1, unsigned __int64 a2, __int64 a3);
__int64 __fastcall AppleUSBEHCI::CreateSplitIsochTransfer(AppleUSBEHCI *this, unsigned __int64 a2, uintptr_t a3);
signed __int64 AppleUSBEHCI::UIMCreateIsochTransfer();
signed __int64 AppleUSBEHCI::UIMCreateIsochTransfer();
__int64 __fastcall AppleUSBEHCI::UIMCreateIsochTransfer(uintptr_t arg1, uintptr_t a2);
signed __int64 __fastcall AppleUSBEHCI::UIMHubMaintenance(AppleUSBEHCI *this, unsigned __int16 a2, __int64 a3, int a4, char a5);
void __fastcall AppleUSBEHCI::ReturnOneTransaction(uintptr_t arg1, __int64 a2, uintptr_t a3, uintptr_t a4, unsigned int a5, unsigned __int8 a6);
__int64 __fastcall AppleUSBEHCI::findBufferRemaining(AppleUSBEHCI *this, AppleEHCIQueueHead *a2);
__int64 __fastcall AppleUSBEHCI::ReturnAllOutstandingAsyncIO(uintptr_t arg1); // idb
char __fastcall AppleUSBEHCI::CheckEDListForTimeouts(uintptr_t arg1, AppleEHCIQueueHead *this);
void __fastcall AppleUSBEHCI::UIMCheckForTimeouts(uintptr_t arg1);
int __fastcall AppleUSBEHCI::GetFrameNumberWithTime(AppleUSBEHCI *this, unsigned __int64 *a2, unsigned __int64 *a3);
__int64 __fastcall AppleUSBEHCI::GatedGetFrameNumberWithTime(AppleUSBEHCI *__hidden this, OSObject *, void *, void *, void *, void *); // idb
__int64 __fastcall AppleUSBEHCI::UIMEnableAddressEndpoints(AppleUSBEHCI *this, unsigned __int16 a2, const char *a3);
__int64 __fastcall AppleUSBEHCI::UIMEnableAllEndpoints(AppleUSBEHCI *this, char a2);
__int64 __fastcall AppleUSBEHCI::ShowPeriodicBandwidthUsed(AppleUSBEHCI *this, __int64 a2, const char *a3);
__int64 __fastcall AppleUSBEHCI::ReservePeriodicBandwidth(AppleUSBEHCI *this, unsigned int a2, unsigned int a3, unsigned __int16 a4);
__int64 __fastcall AppleUSBEHCI::ReleasePeriodicBandwidth(AppleUSBEHCI *this, unsigned int a2, unsigned int a3, unsigned __int16 a4);
// __int64 __usercall AppleUSBEHCI::AllocateHSPeriodicSplitBandwidth@<rax>(AppleUSBEHCI *this@<rdi>, AppleUSBEHCISplitPeriodicEndpoint *a2@<rsi>, __int64 a3@<rdx>, int a4@<r11d>);
__int64 __fastcall AppleUSBEHCI::AdjustSPEs(AppleUSBEHCI *this, AppleUSBEHCISplitPeriodicEndpoint *a2, __int64 a3);
__int64 __fastcall AppleUSBEHCI::ReturnHSPeriodicSplitBandwidth(AppleUSBEHCI *this, AppleUSBEHCISplitPeriodicEndpoint *a2, __int64 a3, __int64 a4, int a5);
__int64 __fastcall AppleUSBEHCI::MetaClass::MetaClass(AppleUSBEHCI::MetaClass *__hidden this); // idb
__int64 __fastcall AppleUSBEHCI::MetaClass::~MetaClass(AppleUSBEHCI::MetaClass *__hidden this); // idb
__int64 __fastcall AppleUSBEHCI::AppleUSBEHCI(__int64 a1);
__int64 __fastcall AppleUSBEHCI::AppleUSBEHCI(__int64 a1);
__int64 __fastcall AppleUSBEHCI::~AppleUSBEHCI(AppleUSBEHCI *__hidden this); // idb
__int64 __fastcall AppleUSBEHCI::~AppleUSBEHCI(AppleUSBEHCI *__hidden this); // idb
void __fastcall AppleUSBEHCI::~AppleUSBEHCI(AppleUSBEHCI *this);
__int64 __fastcall AppleUSBEHCI::getMetaClass(AppleUSBEHCI *__hidden this); // idb
__int64 __fastcall AppleUSBEHCI::MetaClass::MetaClass(AppleUSBEHCI::MetaClass *__hidden this); // idb
__int64 __fastcall AppleUSBEHCI::MetaClass::alloc(AppleUSBEHCI::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall AppleUSBEHCI::AppleUSBEHCI(__int64 a1);
__int64 __fastcall AppleUSBEHCI::AppleUSBEHCI(__int64 a1);
char __fastcall AppleUSBEHCI::init(__int64 a1);
int __fastcall AppleUSBEHCI::stop(AppleUSBEHCI *this, IOService *a2);
int __fastcall AppleUSBEHCI::willTerminate(AppleUSBEHCI *this, IOService *a2);
int __fastcall AppleUSBEHCI::didTerminate(AppleUSBEHCI *this, IOService *a2, __int64 a3, bool *a4);
int __fastcall AppleUSBEHCI::finalize(AppleUSBEHCI *this);
int __fastcall AppleUSBEHCI::free(AppleUSBEHCI *this);
void __fastcall AppleUSBEHCI::showRegisters(AppleUSBEHCI *this, __int64 a2, const char *a3);
int __fastcall AppleUSBEHCI::start(AppleUSBEHCI *this, IOService *a2);
__int64 __fastcall AppleUSBEHCI::UIMInitialize(AppleUSBEHCI *this, IOService *a2, const OSMetaClass *a3);
__int16 __fastcall AppleUSBEHCI::SetVendorInfo(AppleUSBEHCI *this);
__int64 __fastcall AppleUSBEHCI::AcquireOSOwnership(AppleUSBEHCI *__hidden this); // idb
int __fastcall AppleUSBEHCI::CheckForSharedXHCIController(AppleUSBEHCI *this);
__int64 __fastcall AppleUSBEHCI::EnablePrefetchRegister(AppleUSBEHCI *this, IOPCIDevice *); // idb
__int64 __fastcall AppleUSBEHCI::InterruptInitialize(AppleUSBEHCI *this, __int64 a2, __int64 a3, __int64 a4, unsigned __int64 a5);
char __fastcall AppleUSBEHCI::XHCIControllerMatchingNotifcationHandler(AppleUSBEHCI *this, void *a2, IOService *a3);
__int64 __fastcall AppleUSBEHCI::AsyncInitialize(AppleUSBEHCI *__hidden this); // idb
__int64 __fastcall AppleUSBEHCI::DeallocateTD(__int64 a1, __int64 a2);
int __fastcall AppleUSBEHCI::SetPeriodicListEntry(AppleUSBEHCI *this, int a2, IOUSBControllerListElement *a3);
__int64 __fastcall AppleUSBEHCI::UIMFinalize(AppleUSBEHCI *this); // idb
__int64 __fastcall AppleUSBEHCI::GetBandwidthAvailable(AppleUSBEHCI *__hidden this); // idb
__int64 __fastcall AppleUSBEHCI::GetFrameNumber32(uintptr_t arg1); // idb
__int64 __fastcall AppleUSBEHCI::GetFrameNumber(uintptr_t arg1); // idb
__int64 __fastcall AppleUSBEHCI::GetMicroFrameNumber(AppleUSBEHCI *__hidden this); // idb
__int64 __fastcall AppleUSBEHCI::AllocateQH(uintptr_t arg1, unsigned __int64 a2, const OSMetaClass *a3);
__int64 __fastcall AppleUSBEHCI::DeallocateED(AppleUSBEHCI *__hidden this, AppleEHCIQueueHead *); // idb
AppleEHCItdMemoryBlock *__fastcall AppleUSBEHCI::AllocateTD(AppleUSBEHCI *this, unsigned __int64 a2);
AppleEHCIIsochTransferDescriptor *__fastcall AppleUSBEHCI::AllocateITD(AppleUSBEHCI *this, unsigned __int64 a2, const OSMetaClass *a3);
__int64 __fastcall AppleUSBEHCI::DeallocateITD(AppleUSBEHCI *__hidden this, AppleEHCIIsochTransferDescriptor *); // idb
__int64 __fastcall AppleUSBEHCI::AllocateSITD(AppleUSBEHCI *this, unsigned __int64 a2, const OSMetaClass *a3);
__int64 __fastcall AppleUSBEHCI::DeallocateSITD(AppleUSBEHCI *__hidden this, AppleEHCISplitIsochTransferDescriptor *); // idb
int AppleUSBEHCI::doCallback();
__int64 __fastcall AppleUSBEHCI::EnableAsyncSchedule(uintptr_t arg1, char a2);
__int64 __fastcall AppleUSBEHCI::DisableAsyncSchedule(uintptr_t arg1, char a2);
__int64 __fastcall AppleUSBEHCI::EnablePeriodicSchedule(AppleUSBEHCI *this, IOPCIDevice *a2);
__int64 __fastcall AppleUSBEHCI::DisablePeriodicSchedule(uintptr_t arg1, char a2);
__int64 __fastcall AppleUSBEHCI::DisablePrefetchRegister(IOPCIDevice *this, __int64 a2);
__int64 __fastcall AppleUSBEHCI::GetPeriodicListLogicalEntry(AppleUSBEHCI *__hidden this, int); // idb
__int64 __fastcall AppleUSBEHCI::GetPeriodicListPhysicalEntry(AppleUSBEHCI *__hidden this, int); // idb
__int64 __fastcall AppleUSBEHCI::message(AppleUSBEHCI *this, const char *a2, IOService *a3, void *a4);
IOUSBControllerIsochEndpoint *__fastcall AppleUSBEHCI::AllocateIsochEP(AppleUSBEHCI *this, unsigned __int64 a2);
__int64 __fastcall AppleUSBEHCI::ReturnIsochDoneQueue(AppleUSBEHCI *this, IOUSBControllerIsochEndpoint *a2);
int __fastcall AppleUSBEHCI::GetNewDMACommand(AppleUSBEHCI *this);
__int64 __fastcall AppleUSBEHCI::GetLowLatencyOptionsAndPhysicalMask(uintptr_t arg1, unsigned int *, unsigned __int64 *); // idb
__int64 __fastcall AppleUSBEHCI::MetaClass::~MetaClass(AppleUSBEHCI::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_5();
__int64 `global destructor keyed to'_a_5();
__int64 __fastcall AppleUSBEHCIHubInfo::MetaClass::MetaClass(AppleUSBEHCIHubInfo::MetaClass *__hidden this); // idb
__int64 __fastcall AppleUSBEHCIHubInfo::MetaClass::~MetaClass(AppleUSBEHCIHubInfo::MetaClass *__hidden this); // idb
__int64 __fastcall AppleUSBEHCIHubInfo::AppleUSBEHCIHubInfo(__int64 a1);
__int64 __fastcall AppleUSBEHCIHubInfo::AppleUSBEHCIHubInfo(__int64 a1);
__int64 __fastcall AppleUSBEHCIHubInfo::~AppleUSBEHCIHubInfo(AppleUSBEHCIHubInfo *__hidden this); // idb
__int64 __fastcall AppleUSBEHCIHubInfo::~AppleUSBEHCIHubInfo(AppleUSBEHCIHubInfo *__hidden this); // idb
void __fastcall AppleUSBEHCIHubInfo::~AppleUSBEHCIHubInfo(AppleUSBEHCIHubInfo *this);
__int64 __fastcall AppleUSBEHCIHubInfo::getMetaClass(AppleUSBEHCIHubInfo *__hidden this); // idb
__int64 __fastcall AppleUSBEHCIHubInfo::MetaClass::MetaClass(AppleUSBEHCIHubInfo::MetaClass *__hidden this); // idb
__int64 __fastcall AppleUSBEHCIHubInfo::MetaClass::alloc(AppleUSBEHCIHubInfo::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall AppleUSBEHCIHubInfo::AppleUSBEHCIHubInfo(__int64 a1);
__int64 __fastcall AppleUSBEHCIHubInfo::AppleUSBEHCIHubInfo(__int64 a1);
__int64 __fastcall AppleUSBEHCIHubInfo::AddHubInfo(AppleUSBEHCIHubInfo *this, AppleUSBEHCIHubInfo **a2, char a3);
AppleUSBEHCIHubInfo *__fastcall AppleUSBEHCIHubInfo::FindHubInfo(AppleUSBEHCIHubInfo *this, AppleUSBEHCIHubInfo *a2);
__int64 __fastcall AppleUSBEHCIHubInfo::DeleteHubInfo(AppleUSBEHCIHubInfo *this, AppleUSBEHCIHubInfo **a2);
__int64 __fastcall AppleUSBEHCIHubInfo::GetTTInfo(AppleUSBEHCIHubInfo *this, unsigned __int64 a2);
__int64 __fastcall AppleUSBEHCITTInfo::NewTTInfo(AppleUSBEHCITTInfo *this, unsigned __int64 a2);
__int64 __fastcall AppleUSBEHCITTInfo::MetaClass::MetaClass(AppleUSBEHCITTInfo::MetaClass *__hidden this); // idb
__int64 __fastcall AppleUSBEHCITTInfo::MetaClass::~MetaClass(AppleUSBEHCITTInfo::MetaClass *__hidden this); // idb
__int64 __fastcall AppleUSBEHCITTInfo::AppleUSBEHCITTInfo(__int64 a1);
__int64 __fastcall AppleUSBEHCITTInfo::AppleUSBEHCITTInfo(__int64 a1);
__int64 __fastcall AppleUSBEHCITTInfo::~AppleUSBEHCITTInfo(AppleUSBEHCITTInfo *__hidden this); // idb
__int64 __fastcall AppleUSBEHCITTInfo::~AppleUSBEHCITTInfo(AppleUSBEHCITTInfo *__hidden this); // idb
void __fastcall AppleUSBEHCITTInfo::~AppleUSBEHCITTInfo(AppleUSBEHCITTInfo *this);
__int64 __fastcall AppleUSBEHCITTInfo::getMetaClass(AppleUSBEHCITTInfo *__hidden this); // idb
__int64 __fastcall AppleUSBEHCITTInfo::MetaClass::MetaClass(AppleUSBEHCITTInfo::MetaClass *__hidden this); // idb
__int64 __fastcall AppleUSBEHCITTInfo::MetaClass::alloc(AppleUSBEHCITTInfo::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall AppleUSBEHCITTInfo::AppleUSBEHCITTInfo(__int64 a1);
__int64 __fastcall AppleUSBEHCITTInfo::AppleUSBEHCITTInfo(__int64 a1);
__int64 __fastcall AppleUSBEHCISplitPeriodicEndpoint::NewSplitPeriodicEndpoint(AppleUSBEHCISplitPeriodicEndpoint *this, AppleUSBEHCITTInfo *a2, OSMetaClassBase *a3, OSObject *a4, char a5);
__int64 __fastcall AppleUSBEHCISplitPeriodicEndpoint::SetStartFrameAndStartTime(AppleUSBEHCISplitPeriodicEndpoint *this, char a2, __int16 a3);
__int64 __fastcall CompareSPEs(const AppleUSBEHCISplitPeriodicEndpoint *this, const AppleUSBEHCISplitPeriodicEndpoint *this, const AppleUSBEHCITTInfo *); // idb
__int64 __fastcall AppleUSBEHCITTInfo::ReserveHSSplitINBytes(AppleUSBEHCITTInfo *this, unsigned int a2, unsigned int a3, unsigned __int16 a4);
__int64 __fastcall AppleUSBEHCITTInfo::ReleaseHSSplitINBytes(AppleUSBEHCITTInfo *this, unsigned int a2, unsigned int a3, unsigned __int16 a4);
__int64 __fastcall AppleUSBEHCITTInfo::ReserveFSBusBytes(AppleUSBEHCITTInfo *this, unsigned int a2, unsigned __int16 a3);
__int64 __fastcall AppleUSBEHCITTInfo::ReleaseFSBusBytes(AppleUSBEHCITTInfo *this, unsigned int a2, unsigned __int16 a3);
__int64 __fastcall AppleUSBEHCITTInfo::AllocatePeriodicBandwidth(AppleUSBEHCITTInfo *this, AppleUSBEHCISplitPeriodicEndpoint *a2);
__int64 __fastcall AppleUSBEHCITTInfo::ShowPeriodicBandwidthUsed(AppleUSBEHCITTInfo *this, __int64 a2, const char *a3);
__int64 __fastcall AppleUSBEHCISplitPeriodicEndpoint::FindStartFrameAndStartTime(AppleUSBEHCISplitPeriodicEndpoint *__hidden this); // idb
__int64 __fastcall AppleUSBEHCISplitPeriodicEndpoint::CheckPlacementBefore(AppleUSBEHCISplitPeriodicEndpoint *__hidden this, AppleUSBEHCISplitPeriodicEndpoint *); // idb
__int64 __fastcall AppleUSBEHCITTInfo::DeallocatePeriodicBandwidth(AppleUSBEHCITTInfo *__hidden this, AppleUSBEHCISplitPeriodicEndpoint *); // idb
signed __int64 __fastcall AppleUSBEHCITTInfo::CalculateSPEsToAdjustAfterChange(AppleUSBEHCITTInfo *this, AppleUSBEHCISplitPeriodicEndpoint *a2, char a3);
int __fastcall AppleUSBEHCITTInfo::release(AppleUSBEHCITTInfo *this);
__int64 __fastcall AppleUSBEHCITTInfo::ShowHSSplitTimeUsed(AppleUSBEHCITTInfo *this, __int64 a2, const char *a3);
int __fastcall AppleUSBEHCITTInfo::print(AppleUSBEHCITTInfo *this, unsigned int a2, const char *a3);
int __fastcall AppleUSBEHCISplitPeriodicEndpoint::print(AppleUSBEHCISplitPeriodicEndpoint *this, unsigned int a2);
__int64 __fastcall AppleUSBEHCISplitPeriodicEndpoint::MetaClass::MetaClass(AppleUSBEHCISplitPeriodicEndpoint::MetaClass *__hidden this); // idb
__int64 __fastcall AppleUSBEHCISplitPeriodicEndpoint::MetaClass::~MetaClass(AppleUSBEHCISplitPeriodicEndpoint::MetaClass *__hidden this); // idb
__int64 __fastcall AppleUSBEHCISplitPeriodicEndpoint::AppleUSBEHCISplitPeriodicEndpoint(__int64 a1);
__int64 __fastcall AppleUSBEHCISplitPeriodicEndpoint::AppleUSBEHCISplitPeriodicEndpoint(__int64 a1);
__int64 __fastcall AppleUSBEHCISplitPeriodicEndpoint::~AppleUSBEHCISplitPeriodicEndpoint(AppleUSBEHCISplitPeriodicEndpoint *__hidden this); // idb
__int64 __fastcall AppleUSBEHCISplitPeriodicEndpoint::~AppleUSBEHCISplitPeriodicEndpoint(AppleUSBEHCISplitPeriodicEndpoint *__hidden this); // idb
void __fastcall AppleUSBEHCISplitPeriodicEndpoint::~AppleUSBEHCISplitPeriodicEndpoint(AppleUSBEHCISplitPeriodicEndpoint *this);
__int64 __fastcall AppleUSBEHCISplitPeriodicEndpoint::getMetaClass(AppleUSBEHCISplitPeriodicEndpoint *__hidden this); // idb
__int64 __fastcall AppleUSBEHCISplitPeriodicEndpoint::MetaClass::MetaClass(AppleUSBEHCISplitPeriodicEndpoint::MetaClass *__hidden this); // idb
__int64 __fastcall AppleUSBEHCISplitPeriodicEndpoint::MetaClass::alloc(AppleUSBEHCISplitPeriodicEndpoint::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall AppleUSBEHCISplitPeriodicEndpoint::AppleUSBEHCISplitPeriodicEndpoint(__int64 a1);
__int64 __fastcall AppleUSBEHCISplitPeriodicEndpoint::AppleUSBEHCISplitPeriodicEndpoint(__int64 a1);
int __fastcall AppleUSBEHCISplitPeriodicEndpoint::release(AppleUSBEHCISplitPeriodicEndpoint *this);
__int64 __fastcall AppleUSBEHCISplitPeriodicEndpoint::CalculateAllFrameStartTimes(AppleUSBEHCISplitPeriodicEndpoint *this, unsigned __int16 *); // idb
__int64 __fastcall AppleUSBEHCISplitPeriodicEndpoint::CalculateStartTime(AppleUSBEHCISplitPeriodicEndpoint *this, unsigned __int16 a2, AppleUSBEHCISplitPeriodicEndpoint *a3, AppleUSBEHCISplitPeriodicEndpoint *a4);
__int64 __fastcall AppleUSBEHCISplitPeriodicEndpoint::CalculateNewStartTimeFromChange(AppleUSBEHCISplitPeriodicEndpoint *this, AppleUSBEHCISplitPeriodicEndpoint *this); // idb
__int64 __fastcall AppleUSBEHCIHubInfo::MetaClass::~MetaClass(AppleUSBEHCIHubInfo::MetaClass *__hidden this); // idb
__int64 __fastcall AppleUSBEHCITTInfo::MetaClass::~MetaClass(AppleUSBEHCITTInfo::MetaClass *__hidden this); // idb
__int64 __fastcall AppleUSBEHCISplitPeriodicEndpoint::MetaClass::~MetaClass(AppleUSBEHCISplitPeriodicEndpoint::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_6();
__int64 `global destructor keyed to'_a_6();
int _start();
__int64 *OSKextGetCurrentIdentifier();
__int64 *OSKextGetCurrentVersionString();
__int64 OSKextGetCurrentLoadTag();
int _stop();
// int __fastcall IODelay(_QWORD); weak
// int __fastcall IOFree(_QWORD, _QWORD); weak
// int __cdecl IOLockAlloc(_QWORD); weak
// int __fastcall IOLockFree(_QWORD); weak
// int __fastcall IOLockLock(_QWORD); weak
// int __fastcall IOLockTryLock(_QWORD); weak
// int __fastcall IOLockUnlock(_QWORD); weak
// int __fastcall IOLog(_QWORD); weak
// int __fastcall IOMalloc(_QWORD); weak
// int __cdecl IOSimpleLockAlloc(_QWORD); weak
// int __cdecl IOSimpleLockFree(_QWORD); weak
// int __fastcall IOSimpleLockLock(_QWORD); weak
// int __fastcall IOSimpleLockTryLock(_QWORD); weak
// int __fastcall IOSimpleLockUnlock(_QWORD); weak
// int __fastcall IOSleep(_QWORD); weak
// int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD); weak
// int __fastcall OSDecrementAtomic(_QWORD); weak
// int __fastcall OSIncrementAtomic(_QWORD); weak
// _QWORD __cdecl IOPCIDevice::extendedConfigRead8(IOPCIDevice *__hidden this, unsigned __int64); idb
// _QWORD __cdecl IOPCIDevice::extendedConfigRead16(IOPCIDevice *__hidden this, unsigned __int64); idb
// _QWORD __cdecl IOPCIDevice::extendedConfigRead32(IOPCIDevice *__hidden this, unsigned __int64); idb
// _QWORD __cdecl IOPCIDevice::extendedConfigWrite8(IOPCIDevice *__hidden this, unsigned __int64, unsigned __int8); idb
// _QWORD __cdecl IOPCIDevice::extendedConfigWrite16(IOPCIDevice *__hidden this, unsigned __int64, unsigned __int16); idb
// _QWORD __cdecl IOPCIDevice::extendedConfigWrite32(IOPCIDevice *__hidden this, unsigned __int64, unsigned int); idb
// int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD); weak
// _QWORD __cdecl OSMetaClass::~OSMetaClass(OSMetaClass *__hidden this); idb
// int __fastcall IODMACommand::withSpecification(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD); weak
// _QWORD IOUSBCommand::GetAddress(IOUSBCommand *__hidden this); idb
// _QWORD IOUSBCommand::GetEndpoint(IOUSBCommand *__hidden this); idb
// _QWORD IOUSBCommand::GetReqCount(IOUSBCommand *__hidden this); idb
// _QWORD IOUSBCommand::GetDirection(IOUSBCommand *__hidden this); idb
// _QWORD __cdecl IOUSBCommand::GetUIMScratch(IOUSBCommand *__hidden this, unsigned int); idb
// _QWORD __cdecl IOUSBCommand::SetUIMScratch(IOUSBCommand *__hidden this, unsigned int, unsigned int); idb
// _QWORD __cdecl IOUSBCommand::GetUIMScratch64(IOUSBCommand *__hidden this, unsigned int); idb
// _QWORD __cdecl IOUSBCommand::SetUIMScratch64(IOUSBCommand *__hidden this, unsigned int, unsigned __int64); idb
// _QWORD IOUSBCommand::GetNoDataTimeout(IOUSBCommand *__hidden this); idb
// _QWORD IOUSBCommand::GetUSLCompletion(IOUSBCommand *__hidden this); idb
// _QWORD IOUSBCommand::GetCompletionTimeout(IOUSBCommand *__hidden this); idb
// _QWORD IOUSBCommand::GetMultiTransferTransaction(IOUSBCommand *__hidden this); idb
// _QWORD IOUSBCommand::GetFinalTransferInTransaction(IOUSBCommand *__hidden this); idb
// _QWORD IOUSBCommand::GetBuffer(IOUSBCommand *__hidden this); idb
// _QWORD __cdecl OSOrderedSet::withCapacity(OSOrderedSet *__hidden this, unsigned int, int (__cdecl *)(const OSMetaClassBase *, const OSMetaClassBase *, void *), void *); weak
// _QWORD __cdecl IOUSBWorkLoop::SleepWithTimeout(IOUSBWorkLoop *__hidden this, void *, unsigned __int64); idb
// _QWORD __cdecl IOUSBWorkLoop::Wakeup(IOUSBWorkLoop *__hidden this, void *, bool); idb
// _QWORD IOUSBWorkLoop::OpenGate(IOUSBWorkLoop *__hidden this); idb
// _QWORD IOUSBWorkLoop::CloseGate(IOUSBWorkLoop *__hidden this); idb
// _QWORD __cdecl IORegistryEntry::getPlane(IORegistryEntry *__hidden this, const char *); idb
// _QWORD __cdecl IOUSBController::DumpUSBACPI(IOUSBController *__hidden this, IORegistryEntry *); idb
// _QWORD __cdecl IOUSBController::CopyACPIDevice(IOUSBController *__hidden this, IORegistryEntry *); idb
// _QWORD __cdecl IOUSBController::ExpressCardPort(IOUSBController *__hidden this, IORegistryEntry *); idb
// int __fastcall IOUSBController::Complete(_QWORD, _QWORD, _QWORD); weak
// _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *); weak
// _QWORD IOUSBControllerV3::FixupNECControllerConfigRegisters(IOUSBControllerV3 *__hidden this); idb
// int __cdecl IOUSBControllerV3::IOUSBControllerV3(_QWORD); weak
// _QWORD __cdecl IOUSBControllerV3::~IOUSBControllerV3(IOUSBControllerV3 *__hidden this); idb
// int __fastcall AppleUSBDiagnostics::createDiagnostics(_QWORD, _QWORD, _QWORD); weak
// _QWORD __cdecl IOBufferMemoryDescriptor::inTaskWithPhysicalMask(IOBufferMemoryDescriptor *__hidden this, task *, unsigned int, unsigned __int64, unsigned __int64); idb
// _QWORD __cdecl IOUSBControllerListElement::IOUSBControllerListElement(IOUSBControllerListElement *__hidden this, const OSMetaClass *); idb
// _QWORD __cdecl IOUSBControllerListElement::~IOUSBControllerListElement(IOUSBControllerListElement *__hidden this); idb
// int __fastcall IOFilterInterruptEventSource::filterInterruptEventSource(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD); weak
// _QWORD __cdecl IOUSBControllerIsochEndpoint::IOUSBControllerIsochEndpoint(IOUSBControllerIsochEndpoint *__hidden this, const OSMetaClass *); idb
// _QWORD __cdecl IOUSBControllerIsochEndpoint::~IOUSBControllerIsochEndpoint(IOUSBControllerIsochEndpoint *__hidden this); idb
// _QWORD __cdecl IOUSBControllerIsochListElement::IOUSBControllerIsochListElement(IOUSBControllerIsochListElement *__hidden this, const OSMetaClass *); idb
// _QWORD __cdecl IOUSBControllerIsochListElement::~IOUSBControllerIsochListElement(IOUSBControllerIsochListElement *__hidden this); idb
// _QWORD __cdecl OSArray::withCapacity(OSArray *__hidden this, unsigned int); idb
// _QWORD __cdecl OSNumber::withNumber(OSNumber *__hidden this, unsigned __int64, unsigned int); idb
// int __cdecl OSObject::OSObject(_QWORD); weak
// _QWORD __cdecl OSObject::~OSObject(OSObject *__hidden this); idb
// void __cdecl OSObject::operator delete(void *); idb
// _QWORD __cdecl OSObject::operator new(OSObject *__hidden this, unsigned __int64); idb
// _QWORD IOService::getPlatform(IOService *__hidden this); idb
// _QWORD IOService::getPowerState(IOService *__hidden this); idb
// int __fastcall IOService::serviceMatching(_QWORD, _QWORD); weak
// int __fastcall IOService::addMatchingNotification(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD); weak
// _QWORD OSMetaClass::instanceConstructed(OSMetaClass *__hidden this); idb
// _QWORD __cdecl OSMetaClassBase::metaCast(OSMetaClassBase *__hidden this, const char *); idb
// _QWORD IOService::isInactive(IOService *__hidden this); idb
// void __cdecl operator delete(void *); idb
// int __fastcall absolutetime_to_nanoseconds(_QWORD, _QWORD); weak
// void __cdecl bcopy(const void *, void *, size_t);
// void __cdecl bzero(void *, size_t);
// int __fastcall clock_get_uptime(_QWORD, _QWORD); weak
// void __cdecl kernel_debug(uint32_t debugid, uintptr_t arg1, uintptr_t arg2, uintptr_t arg3, uintptr_t arg4, uintptr_t arg5);
// uint64_t mach_absolute_time(void);
// int __fastcall ml_cpu_int_event_time(_QWORD); weak
// int __fastcall ml_set_interrupts_enabled(_QWORD, _QWORD); weak
// int __cdecl strncmp(const char *, const char *, size_t);
// int __fastcall thread_call_allocate(_QWORD, _QWORD); weak
// int __fastcall thread_call_enter1(_QWORD, _QWORD); weak

//-------------------------------------------------------------------------
// Data declarations

int dword_0 = 4277009103; // weak
int dword_10 = 8; // weak
segment_command_64 stru_20 = { 25u, 312u, "__TEXT", 0uLL, 90112uLL, 0uLL, 90112uLL, 7, 5, 3u, 0u }; // weak
section_64 stru_68 =
{
  {
    '_',
    '_',
    't',
    'e',
    'x',
    't',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0'
  },
  "__TEXT",
  2976uLL,
  76207uLL,
  2976u,
  4u,
  0u,
  0u,
  2147484672u,
  0u,
  0u,
  0u
}; // weak
__int64 qword_4B8[221] =
{
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL,
  0LL
}; // weak
_UNKNOWN loc_121B; // weak
_UNKNOWN loc_9C5A; // weak
__int64 TranslateStatusToUSBError(unsigned int)::statusToErrorMap[8] =
{
  -2305772636174548992LL,
  -2305772623826501630LL,
  -2305839788525076401LL,
  -2305772606646632442LL,
  -2305839814294895896LL,
  -2305772589466763254LL,
  -2305772580876828660LL,
  -2305772572286894066LL
}; // weak
_QWORD off_16000[27] =
{
  187264LL,
  187352LL,
  187360LL,
  188304LL,
  188920LL,
  188944LL,
  188960LL,
  188992LL,
  189016LL,
  189024LL,
  189048LL,
  189072LL,
  189080LL,
  190752LL,
  190760LL,
  190768LL,
  190776LL,
  190784LL,
  190808LL,
  190848LL,
  190856LL,
  190864LL,
  190872LL,
  190880LL,
  190888LL,
  190896LL,
  190912LL
}; // weak
__int64 off_16008[26] =
{
  187352LL,
  187360LL,
  188304LL,
  188920LL,
  188944LL,
  188960LL,
  188992LL,
  189016LL,
  189024LL,
  189048LL,
  189072LL,
  189080LL,
  190752LL,
  190760LL,
  190768LL,
  190776LL,
  190784LL,
  190808LL,
  190848LL,
  190856LL,
  190864LL,
  190872LL,
  190880LL,
  190888LL,
  190896LL,
  190912LL
}; // weak
__int64 off_16010[25] =
{
  187360LL,
  188304LL,
  188920LL,
  188944LL,
  188960LL,
  188992LL,
  189016LL,
  189024LL,
  189048LL,
  189072LL,
  189080LL,
  190752LL,
  190760LL,
  190768LL,
  190776LL,
  190784LL,
  190808LL,
  190848LL,
  190856LL,
  190864LL,
  190872LL,
  190880LL,
  190888LL,
  190896LL,
  190912LL
}; // weak
_QWORD off_16018[24] =
{
  188304LL,
  188920LL,
  188944LL,
  188960LL,
  188992LL,
  189016LL,
  189024LL,
  189048LL,
  189072LL,
  189080LL,
  190752LL,
  190760LL,
  190768LL,
  190776LL,
  190784LL,
  190808LL,
  190848LL,
  190856LL,
  190864LL,
  190872LL,
  190880LL,
  190888LL,
  190896LL,
  190912LL
}; // weak
_QWORD off_16020[23] =
{
  188920LL,
  188944LL,
  188960LL,
  188992LL,
  189016LL,
  189024LL,
  189048LL,
  189072LL,
  189080LL,
  190752LL,
  190760LL,
  190768LL,
  190776LL,
  190784LL,
  190808LL,
  190848LL,
  190856LL,
  190864LL,
  190872LL,
  190880LL,
  190888LL,
  190896LL,
  190912LL
}; // weak
_QWORD off_16028[22] =
{
  188944LL,
  188960LL,
  188992LL,
  189016LL,
  189024LL,
  189048LL,
  189072LL,
  189080LL,
  190752LL,
  190760LL,
  190768LL,
  190776LL,
  190784LL,
  190808LL,
  190848LL,
  190856LL,
  190864LL,
  190872LL,
  190880LL,
  190888LL,
  190896LL,
  190912LL
}; // weak
_QWORD off_16030[21] =
{
  188960LL,
  188992LL,
  189016LL,
  189024LL,
  189048LL,
  189072LL,
  189080LL,
  190752LL,
  190760LL,
  190768LL,
  190776LL,
  190784LL,
  190808LL,
  190848LL,
  190856LL,
  190864LL,
  190872LL,
  190880LL,
  190888LL,
  190896LL,
  190912LL
}; // weak
_QWORD off_16038[20] =
{
  188992LL,
  189016LL,
  189024LL,
  189048LL,
  189072LL,
  189080LL,
  190752LL,
  190760LL,
  190768LL,
  190776LL,
  190784LL,
  190808LL,
  190848LL,
  190856LL,
  190864LL,
  190872LL,
  190880LL,
  190888LL,
  190896LL,
  190912LL
}; // weak
_QWORD off_16040[19] =
{
  189016LL,
  189024LL,
  189048LL,
  189072LL,
  189080LL,
  190752LL,
  190760LL,
  190768LL,
  190776LL,
  190784LL,
  190808LL,
  190848LL,
  190856LL,
  190864LL,
  190872LL,
  190880LL,
  190888LL,
  190896LL,
  190912LL
}; // weak
_QWORD off_16048[18] =
{
  189024LL,
  189048LL,
  189072LL,
  189080LL,
  190752LL,
  190760LL,
  190768LL,
  190776LL,
  190784LL,
  190808LL,
  190848LL,
  190856LL,
  190864LL,
  190872LL,
  190880LL,
  190888LL,
  190896LL,
  190912LL
}; // weak
_QWORD off_16050[17] =
{
  189048LL,
  189072LL,
  189080LL,
  190752LL,
  190760LL,
  190768LL,
  190776LL,
  190784LL,
  190808LL,
  190848LL,
  190856LL,
  190864LL,
  190872LL,
  190880LL,
  190888LL,
  190896LL,
  190912LL
}; // weak
_QWORD off_16058[16] =
{
  189072LL,
  189080LL,
  190752LL,
  190760LL,
  190768LL,
  190776LL,
  190784LL,
  190808LL,
  190848LL,
  190856LL,
  190864LL,
  190872LL,
  190880LL,
  190888LL,
  190896LL,
  190912LL
}; // weak
_QWORD off_16060[15] =
{
  189080LL,
  190752LL,
  190760LL,
  190768LL,
  190776LL,
  190784LL,
  190808LL,
  190848LL,
  190856LL,
  190864LL,
  190872LL,
  190880LL,
  190888LL,
  190896LL,
  190912LL
}; // weak
__int64 off_16068[14] =
{
  190752LL,
  190760LL,
  190768LL,
  190776LL,
  190784LL,
  190808LL,
  190848LL,
  190856LL,
  190864LL,
  190872LL,
  190880LL,
  190888LL,
  190896LL,
  190912LL
}; // weak
__int64 off_16070[13] =
{
  190760LL,
  190768LL,
  190776LL,
  190784LL,
  190808LL,
  190848LL,
  190856LL,
  190864LL,
  190872LL,
  190880LL,
  190888LL,
  190896LL,
  190912LL
}; // weak
__int64 off_16078[12] =
{
  190768LL,
  190776LL,
  190784LL,
  190808LL,
  190848LL,
  190856LL,
  190864LL,
  190872LL,
  190880LL,
  190888LL,
  190896LL,
  190912LL
}; // weak
__int64 off_16080[11] =
{
  190776LL,
  190784LL,
  190808LL,
  190848LL,
  190856LL,
  190864LL,
  190872LL,
  190880LL,
  190888LL,
  190896LL,
  190912LL
}; // weak
__int64 off_16088[10] =
{
  190784LL,
  190808LL,
  190848LL,
  190856LL,
  190864LL,
  190872LL,
  190880LL,
  190888LL,
  190896LL,
  190912LL
}; // weak
__int64 off_16090[9] =
{
  190808LL,
  190848LL,
  190856LL,
  190864LL,
  190872LL,
  190880LL,
  190888LL,
  190896LL,
  190912LL
}; // weak
__int64 off_16098[8] =
{
  190848LL,
  190856LL,
  190864LL,
  190872LL,
  190880LL,
  190888LL,
  190896LL,
  190912LL
}; // weak
__int64 off_160A0[7] = { 190856LL, 190864LL, 190872LL, 190880LL, 190888LL, 190896LL, 190912LL }; // weak
__int64 off_160A8[6] = { 190864LL, 190872LL, 190880LL, 190888LL, 190896LL, 190912LL }; // weak
__int64 off_160B0[5] = { 190872LL, 190880LL, 190888LL, 190896LL, 190912LL }; // weak
__int64 off_160B8[4] = { 190880LL, 190888LL, 190896LL, 190912LL }; // weak
__int64 off_160C0[3] = { 190888LL, 190896LL, 190912LL }; // weak
__int64 off_160C8[2] = { 190896LL, 190912LL }; // weak
__int64 off_160D0 = 190912LL; // weak
__int64 (__fastcall *off_16180[2])(AppleEHCIedMemoryBlock *__hidden this) =
{
  &AppleEHCIedMemoryBlock::~AppleEHCIedMemoryBlock,
  &AppleEHCIedMemoryBlock::~AppleEHCIedMemoryBlock
}; // weak
__int64 (__fastcall *off_162B0[2])(AppleEHCIedMemoryBlock::MetaClass *__hidden this) =
{
  &AppleEHCIedMemoryBlock::MetaClass::~MetaClass,
  &AppleEHCIedMemoryBlock::MetaClass::~MetaClass
}; // weak
__int64 (__fastcall *off_163B0[2])(AppleEHCIitdMemoryBlock *__hidden this) =
{
  &AppleEHCIitdMemoryBlock::~AppleEHCIitdMemoryBlock,
  &AppleEHCIitdMemoryBlock::~AppleEHCIitdMemoryBlock
}; // weak
__int64 (__fastcall *off_164E0[2])(AppleEHCIitdMemoryBlock::MetaClass *__hidden this) =
{
  &AppleEHCIitdMemoryBlock::MetaClass::~MetaClass,
  &AppleEHCIitdMemoryBlock::MetaClass::~MetaClass
}; // weak
_QWORD AppleEHCIQueueHead::metaClass = 100784LL; // weak
__int64 (__fastcall *off_165E0[2])(AppleEHCIQueueHead *__hidden this) =
{
  &AppleEHCIQueueHead::~AppleEHCIQueueHead,
  &AppleEHCIQueueHead::~AppleEHCIQueueHead
}; // weak
__int64 (__fastcall *off_16740[2])(AppleEHCIQueueHead::MetaClass *__hidden this) =
{
  &AppleEHCIQueueHead::MetaClass::~MetaClass,
  &AppleEHCIQueueHead::MetaClass::~MetaClass
}; // weak
_QWORD AppleEHCIIsochTransferDescriptor::metaClass = 100824LL; // weak
__int64 (__fastcall *off_16840[2])(AppleEHCIIsochTransferDescriptor *__hidden this) =
{
  &AppleEHCIIsochTransferDescriptor::~AppleEHCIIsochTransferDescriptor,
  &AppleEHCIIsochTransferDescriptor::~AppleEHCIIsochTransferDescriptor
}; // weak
__int64 (__fastcall *off_169A0[2])(AppleEHCIIsochTransferDescriptor::MetaClass *__hidden this) =
{
  &AppleEHCIIsochTransferDescriptor::MetaClass::~MetaClass,
  &AppleEHCIIsochTransferDescriptor::MetaClass::~MetaClass
}; // weak
_QWORD AppleEHCISplitIsochTransferDescriptor::metaClass = 100864LL; // weak
__int64 (__fastcall *off_16AA0[2])(AppleEHCISplitIsochTransferDescriptor *__hidden this) =
{
  &AppleEHCISplitIsochTransferDescriptor::~AppleEHCISplitIsochTransferDescriptor,
  &AppleEHCISplitIsochTransferDescriptor::~AppleEHCISplitIsochTransferDescriptor
}; // weak
__int64 (__fastcall *off_16C00[2])(AppleEHCISplitIsochTransferDescriptor::MetaClass *__hidden this) =
{
  &AppleEHCISplitIsochTransferDescriptor::MetaClass::~MetaClass,
  &AppleEHCISplitIsochTransferDescriptor::MetaClass::~MetaClass
}; // weak
_QWORD AppleEHCIIsochEndpoint::metaClass = 100904LL; // weak
__int64 (__fastcall *off_16D00[2])(AppleEHCIIsochEndpoint *__hidden this) =
{
  &AppleEHCIIsochEndpoint::~AppleEHCIIsochEndpoint,
  &AppleEHCIIsochEndpoint::~AppleEHCIIsochEndpoint
}; // weak
__int64 (__fastcall *off_16E30[2])(AppleEHCIIsochEndpoint::MetaClass *__hidden this) =
{
  &AppleEHCIIsochEndpoint::MetaClass::~MetaClass,
  &AppleEHCIIsochEndpoint::MetaClass::~MetaClass
}; // weak
__int64 (__fastcall *off_16F30[2])(AppleEHCIsitdMemoryBlock *__hidden this) =
{
  &AppleEHCIsitdMemoryBlock::~AppleEHCIsitdMemoryBlock,
  &AppleEHCIsitdMemoryBlock::~AppleEHCIsitdMemoryBlock
}; // weak
__int64 (__fastcall *off_17060[2])(AppleEHCIsitdMemoryBlock::MetaClass *__hidden this) =
{
  &AppleEHCIsitdMemoryBlock::MetaClass::~MetaClass,
  &AppleEHCIsitdMemoryBlock::MetaClass::~MetaClass
}; // weak
__int64 (__fastcall *off_17160[2])(AppleEHCItdMemoryBlock *__hidden this) =
{
  &AppleEHCItdMemoryBlock::~AppleEHCItdMemoryBlock,
  &AppleEHCItdMemoryBlock::~AppleEHCItdMemoryBlock
}; // weak
__int64 (__fastcall *off_17290[2])(AppleEHCItdMemoryBlock::MetaClass *__hidden this) =
{
  &AppleEHCItdMemoryBlock::MetaClass::~MetaClass,
  &AppleEHCItdMemoryBlock::MetaClass::~MetaClass
}; // weak
__int64 (__fastcall *off_17380[2])(AppleUSBEHCI_IOLockClass *__hidden this) =
{
  &AppleUSBEHCI_IOLockClass::~AppleUSBEHCI_IOLockClass,
  &AppleUSBEHCI_IOLockClass::~AppleUSBEHCI_IOLockClass
}; // weak
_QWORD AppleUSBEHCI::metaClass = 101024LL; // weak
__int64 (__fastcall *off_173C0[2])(AppleUSBEHCI *__hidden this) = { &AppleUSBEHCI::~AppleUSBEHCI, &AppleUSBEHCI::~AppleUSBEHCI }; // weak
__int64 (__fastcall *off_18130[2])(AppleUSBEHCI::MetaClass *__hidden this) = { &AppleUSBEHCI::MetaClass::~MetaClass, &AppleUSBEHCI::MetaClass::~MetaClass }; // weak
__int64 (__fastcall *off_18230[2])(AppleUSBEHCIHubInfo *__hidden this) =
{
  &AppleUSBEHCIHubInfo::~AppleUSBEHCIHubInfo,
  &AppleUSBEHCIHubInfo::~AppleUSBEHCIHubInfo
}; // weak
__int64 (__fastcall *off_18360[2])(AppleUSBEHCIHubInfo::MetaClass *__hidden this) =
{
  &AppleUSBEHCIHubInfo::MetaClass::~MetaClass,
  &AppleUSBEHCIHubInfo::MetaClass::~MetaClass
}; // weak
__int64 (__fastcall *off_18460[2])(AppleUSBEHCITTInfo *__hidden this) =
{
  &AppleUSBEHCITTInfo::~AppleUSBEHCITTInfo,
  &AppleUSBEHCITTInfo::~AppleUSBEHCITTInfo
}; // weak
__int64 (__fastcall *off_18590[2])(AppleUSBEHCITTInfo::MetaClass *__hidden this) =
{
  &AppleUSBEHCITTInfo::MetaClass::~MetaClass,
  &AppleUSBEHCITTInfo::MetaClass::~MetaClass
}; // weak
__int64 (__fastcall *off_18690[2])(AppleUSBEHCISplitPeriodicEndpoint *__hidden this) =
{
  &AppleUSBEHCISplitPeriodicEndpoint::~AppleUSBEHCISplitPeriodicEndpoint,
  &AppleUSBEHCISplitPeriodicEndpoint::~AppleUSBEHCISplitPeriodicEndpoint
}; // weak
__int64 (__fastcall *off_187C0[2])(AppleUSBEHCISplitPeriodicEndpoint::MetaClass *__hidden this) =
{
  &AppleUSBEHCISplitPeriodicEndpoint::MetaClass::~MetaClass,
  &AppleUSBEHCISplitPeriodicEndpoint::MetaClass::~MetaClass
}; // weak
__int64 kmod_info = 0LL; // weak
_QWORD AppleEHCIedMemoryBlock::gMetaClass; // weak
_QWORD AppleEHCIitdMemoryBlock::gMetaClass; // weak
_QWORD AppleEHCIQueueHead::gMetaClass; // weak
_QWORD AppleEHCIIsochTransferDescriptor::gMetaClass; // weak
_QWORD AppleEHCISplitIsochTransferDescriptor::gMetaClass; // weak
_QWORD AppleEHCIIsochEndpoint::gMetaClass; // weak
_QWORD AppleEHCIsitdMemoryBlock::gMetaClass; // weak
_QWORD AppleEHCItdMemoryBlock::gMetaClass; // weak
_QWORD AppleUSBEHCI::gMetaClass; // weak
_QWORD AppleUSBEHCIHubInfo::gMetaClass; // weak
_QWORD AppleUSBEHCITTInfo::gMetaClass; // weak
_QWORD AppleUSBEHCISplitPeriodicEndpoint::gMetaClass; // weak
int (*_realmain)(void); // weak
int (*_antimain)(void); // weak
char AppleUSBEHCI::InterruptHandler(OSObject *,IOInterruptEventSource *,int)::emitted; // weak
_QWORD gEHCI_GlobalLock; // weak
__int64 qword_18B60; // weak


//----- (0000000000000BA0) ----------------------------------------------------
__int64 __fastcall AppleEHCIedMemoryBlock::MetaClass::MetaClass(AppleEHCIedMemoryBlock::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "AppleEHCIedMemoryBlock", off_16060[0], 48LL);
  result = (__int64)off_162B0;
  *(_QWORD *)this = off_162B0;
  return result;
}
// 16060: using guessed type _QWORD off_16060[15];
// 162B0: using guessed type __int64 (__fastcall *off_162B0[2])(AppleEHCIedMemoryBlock::MetaClass *__hidden this);
// 2DBC8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000000BD2) ----------------------------------------------------
__int64 __fastcall AppleEHCIedMemoryBlock::MetaClass::~MetaClass(AppleEHCIedMemoryBlock::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000000BDC) ----------------------------------------------------
__int64 __fastcall AppleEHCIedMemoryBlock::AppleEHCIedMemoryBlock(__int64 a1)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1);
  result = (__int64)off_16180;
  *(_QWORD *)a1 = off_16180;
  return result;
}
// 16180: using guessed type __int64 (__fastcall *off_16180[2])(AppleEHCIedMemoryBlock *__hidden this);
// 2E330: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000000BFC) ----------------------------------------------------
__int64 __fastcall AppleEHCIedMemoryBlock::AppleEHCIedMemoryBlock(__int64 a1)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1);
  result = (__int64)off_16180;
  *(_QWORD *)a1 = off_16180;
  return result;
}
// 16180: using guessed type __int64 (__fastcall *off_16180[2])(AppleEHCIedMemoryBlock *__hidden this);
// 2E330: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000000C1C) ----------------------------------------------------
__int64 __fastcall AppleEHCIedMemoryBlock::~AppleEHCIedMemoryBlock(AppleEHCIedMemoryBlock *this)
{
  return OSObject::~OSObject(this);
}

//----- (0000000000000C26) ----------------------------------------------------
__int64 __fastcall AppleEHCIedMemoryBlock::~AppleEHCIedMemoryBlock(AppleEHCIedMemoryBlock *this)
{
  return OSObject::~OSObject(this);
}

//----- (0000000000000C30) ----------------------------------------------------
void __fastcall AppleEHCIedMemoryBlock::~AppleEHCIedMemoryBlock(AppleEHCIedMemoryBlock *this)
{
  OSObject::~OSObject(this);
  OSObject::operator delete((void *)this);
}

//----- (0000000000000C52) ----------------------------------------------------
__int64 __fastcall AppleEHCIedMemoryBlock::getMetaClass(AppleEHCIedMemoryBlock *this)
{
  return (__int64)&AppleEHCIedMemoryBlock::gMetaClass;
}
// 18960: using guessed type _QWORD AppleEHCIedMemoryBlock::gMetaClass;

//----- (0000000000000C60) ----------------------------------------------------
__int64 __fastcall AppleEHCIedMemoryBlock::MetaClass::MetaClass(AppleEHCIedMemoryBlock::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "AppleEHCIedMemoryBlock", off_16060[0], 48LL);
  result = (__int64)off_162B0;
  *(_QWORD *)this = off_162B0;
  return result;
}
// 16060: using guessed type _QWORD off_16060[15];
// 162B0: using guessed type __int64 (__fastcall *off_162B0[2])(AppleEHCIedMemoryBlock::MetaClass *__hidden this);
// 2DBC8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000000C92) ----------------------------------------------------
__int64 __fastcall AppleEHCIedMemoryBlock::MetaClass::alloc(AppleEHCIedMemoryBlock::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&stru_20.segname[8], a2);
  OSObject::OSObject(v2);
  *(_QWORD *)v2 = off_16180;
  OSMetaClass::instanceConstructed((OSMetaClass *)&AppleEHCIedMemoryBlock::gMetaClass);
  return v2;
}
// 20: using guessed type segment_command_64;
// 16180: using guessed type __int64 (__fastcall *off_16180[2])(AppleEHCIedMemoryBlock *__hidden this);
// 18960: using guessed type _QWORD AppleEHCIedMemoryBlock::gMetaClass;
// 2E330: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000000CD2) ----------------------------------------------------
__int64 __fastcall AppleEHCIedMemoryBlock::AppleEHCIedMemoryBlock(__int64 a1)
{
  OSObject::OSObject(a1);
  *(_QWORD *)a1 = off_16180;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&AppleEHCIedMemoryBlock::gMetaClass);
}
// 16180: using guessed type __int64 (__fastcall *off_16180[2])(AppleEHCIedMemoryBlock *__hidden this);
// 18960: using guessed type _QWORD AppleEHCIedMemoryBlock::gMetaClass;
// 2E330: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000000D02) ----------------------------------------------------
__int64 __fastcall AppleEHCIedMemoryBlock::AppleEHCIedMemoryBlock(__int64 a1)
{
  OSObject::OSObject(a1);
  *(_QWORD *)a1 = off_16180;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&AppleEHCIedMemoryBlock::gMetaClass);
}
// 16180: using guessed type __int64 (__fastcall *off_16180[2])(AppleEHCIedMemoryBlock *__hidden this);
// 18960: using guessed type _QWORD AppleEHCIedMemoryBlock::gMetaClass;
// 2E330: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000000D32) ----------------------------------------------------
__int64 __fastcall AppleEHCIedMemoryBlock::NewMemoryBlock(AppleEHCIedMemoryBlock *this, unsigned __int64 a2)
{
  __int64 v2; // r12@1
  __int64 v3; // rax@2
  unsigned __int64 v4; // r8@2
  __int64 v5; // r14@2
  __int64 v6; // rax@3
  __int64 v7; // r15@5
  signed __int64 v8; // rsi@5
  void *v9; // rax@11
  int v11; // ebx@15
  int v12; // [sp+1Ch] [bp-34h]@1
  unsigned int v13; // [sp+20h] [bp-30h]@15
  int v14; // [sp+24h] [bp-2Ch]@17
  __int64 v15; // [sp+28h] [bp-28h]@1

  v2 = OSObject::operator new((OSObject *)&stru_20.segname[8], a2);
  OSObject::OSObject(v2);
  *(_QWORD *)v2 = off_16180;
  OSMetaClass::instanceConstructed((OSMetaClass *)&AppleEHCIedMemoryBlock::gMetaClass);
  v15 = 0LL;
  v12 = 1;
  if ( v2 )
  {
    LODWORD(v3) = IODMACommand::withSpecification(off_16008[0], 32LL, 4096LL, 64LL, 0LL, 1LL);
    v5 = v3;
    if ( !v3 )
    {
      v7 = 0LL;
      KernelDebugLogInternal(
        1LL,
        1431519814LL,
        "AppleEHCIedMemoryBlock::NewMemoryBlock - could not create IODMACommand");
      return v7;
    }
    v6 = IOBufferMemoryDescriptor::inTaskWithPhysicalMask(
           *(IOBufferMemoryDescriptor **)off_160D0,
           (task *)((char *)&dword_0 + 3),
           0x1000u,
           0xFFFFF000uLL,
           v4);
    *(_QWORD *)(v2 + 40) = v6;
    if ( v6 )
    {
      if ( (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v6 + 496LL))(v6, 0LL) )
      {
        v7 = 0LL;
        v8 = 1431519814LL;
        KernelDebugLogInternal(1LL, 1431519814LL, "AppleEHCIedMemoryBlock::NewMemoryBlock - could not prepare buffer");
LABEL_13:
        (*(void (__cdecl **)(_QWORD, signed __int64))(**(_QWORD **)(v2 + 40) + 40LL))(*(_QWORD *)(v2 + 40), v8);
        *(_QWORD *)(v2 + 40) = 0LL;
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 40LL))(v2);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v5 + 40LL))(v5);
        return v7;
      }
      LODWORD(v9) = (*(int (__cdecl **)(_QWORD, _QWORD))(**(_QWORD **)(v2 + 40) + 736LL))(*(_QWORD *)(v2 + 40), 0LL);
      *(_QWORD *)(v2 + 24) = v9;
      bzero(v9, 0x1000uLL);
      if ( (*(int (__fastcall **)(__int64, _QWORD, signed __int64))(*(_QWORD *)v5 + 296LL))(
             v5,
             *(_QWORD *)(v2 + 40),
             1LL) )
      {
        v7 = 0LL;
        KernelDebugLogInternal(
          1LL,
          1431519814LL,
          "AppleEHCIedMemoryBlock::NewMemoryBlock - could not set memory descriptor");
        v8 = 0LL;
        (*(void (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(v2 + 40) + 504LL))(*(_QWORD *)(v2 + 40), 0LL);
        goto LABEL_13;
      }
      v11 = (*(int (__fastcall **)(__int64, __int64 *, int *, int *))(*(_QWORD *)v5 + 344LL))(v5, &v15, &v13, &v12);
      (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v5 + 304LL))(v5, 1LL);
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v5 + 40LL))(v5);
      if ( !v11 && v12 == 1 && v14 == 4096 )
      {
        *(_QWORD *)(v2 + 16) = v13;
        return v2;
      }
      v7 = 0LL;
      KernelDebugLogInternal(
        1LL,
        1431519814LL,
        "AppleEHCIedMemoryBlock::NewMemoryBlock - could not get physical segment");
      (*(void (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(v2 + 40) + 504LL))(*(_QWORD *)(v2 + 40), 0LL);
      (*(void (__cdecl **)(_QWORD, _QWORD))(**(_QWORD **)(v2 + 40) + 40LL))(*(_QWORD *)(v2 + 40), 0LL);
      *(_QWORD *)(v2 + 40) = 0LL;
    }
    else
    {
      v7 = 0LL;
      KernelDebugLogInternal(
        1LL,
        1431519814LL,
        "AppleEHCIedMemoryBlock::NewMemoryBlock, could not allocate buffer! (size: %d, mask: %qd)");
    }
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 40LL))(v2);
    return v7;
  }
  KernelDebugLogInternal(1LL, 1431519814LL, "AppleEHCIedMemoryBlock::NewMemoryBlock, constructor failed!");
  return v2;
}
// 0: using guessed type int;
// 20: using guessed type segment_command_64 stru_20;
// 16008: using guessed type __int64 off_16008[26];
// 160D0: using guessed type __int64 off_160D0;
// 16180: using guessed type __int64 (__fastcall *off_16180[2])(AppleEHCIedMemoryBlock *__hidden this);
// 18960: using guessed type _QWORD AppleEHCIedMemoryBlock::gMetaClass;
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);
// 2DBE8: using guessed type int __fastcall IODMACommand::withSpecification(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 2E330: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000000FD0) ----------------------------------------------------
__int64 __fastcall AppleEHCIedMemoryBlock::NumEDs(AppleEHCIedMemoryBlock *this)
{
  return 42LL;
}

//----- (0000000000000FDC) ----------------------------------------------------
__int64 __fastcall AppleEHCIedMemoryBlock::GetPhysicalPtr(AppleEHCIedMemoryBlock *this, unsigned int a2)
{
  __int64 result; // rax@1

  result = 0LL;
  if ( a2 <= 0x29 )
    result = *((_QWORD *)this + 2) + 96LL * a2;
  return result;
}

//----- (0000000000000FF8) ----------------------------------------------------
__int64 __fastcall AppleEHCIedMemoryBlock::GetLogicalPtr(AppleEHCIedMemoryBlock *this, unsigned int a2)
{
  __int64 result; // rax@1

  result = 0LL;
  if ( a2 <= 0x29 )
    result = *((_QWORD *)this + 3) + 96LL * a2;
  return result;
}

//----- (0000000000001014) ----------------------------------------------------
__int64 __fastcall AppleEHCIedMemoryBlock::GetNextBlock(AppleEHCIedMemoryBlock *this)
{
  return *((_QWORD *)this + 4);
}

//----- (000000000000101E) ----------------------------------------------------
void __fastcall AppleEHCIedMemoryBlock::SetNextBlock(AppleEHCIedMemoryBlock *this, AppleEHCIedMemoryBlock *a2)
{
  *((_QWORD *)this + 4) = a2;
}

//----- (0000000000001028) ----------------------------------------------------
int __fastcall AppleEHCIedMemoryBlock::free(AppleEHCIedMemoryBlock *this)
{
  AppleEHCIedMemoryBlock *v1; // rbx@1
  __int64 v2; // rdi@1

  v1 = this;
  v2 = *((_QWORD *)this + 5);
  if ( v2 )
  {
    (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v2 + 504LL))(v2, 0LL);
    (*(void (__cdecl **)(_QWORD))(**((_QWORD **)v1 + 5) + 40LL))(*((_QWORD *)v1 + 5));
  }
  return (*(int (__fastcall **)(AppleEHCIedMemoryBlock *))(off_16088[0] + 160))(v1);
}
// 16088: using guessed type __int64 off_16088[10];

//----- (0000000000001066) ----------------------------------------------------
__int64 __fastcall AppleEHCIedMemoryBlock::MetaClass::~MetaClass(AppleEHCIedMemoryBlock::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000001070) ----------------------------------------------------
__int64 `global constructor keyed to'_a()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(&AppleEHCIedMemoryBlock::gMetaClass, "AppleEHCIedMemoryBlock", off_16060[0], 48LL);
  result = (__int64)off_162B0;
  AppleEHCIedMemoryBlock::gMetaClass = off_162B0;
  return result;
}
// 16060: using guessed type _QWORD off_16060[15];
// 162B0: using guessed type __int64 (__fastcall *off_162B0[2])(AppleEHCIedMemoryBlock::MetaClass *__hidden this);
// 18960: using guessed type _QWORD AppleEHCIedMemoryBlock::gMetaClass;
// 2DBC8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000010B0) ----------------------------------------------------
__int64 `global destructor keyed to'_a()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&AppleEHCIedMemoryBlock::gMetaClass);
}
// 18960: using guessed type _QWORD AppleEHCIedMemoryBlock::gMetaClass;

//----- (00000000000010D0) ----------------------------------------------------
__int64 __fastcall AppleEHCIitdMemoryBlock::MetaClass::MetaClass(AppleEHCIitdMemoryBlock::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "AppleEHCIitdMemoryBlock", off_16060[0], 48LL);
  result = (__int64)off_164E0;
  *(_QWORD *)this = off_164E0;
  return result;
}
// 16060: using guessed type _QWORD off_16060[15];
// 164E0: using guessed type __int64 (__fastcall *off_164E0[2])(AppleEHCIitdMemoryBlock::MetaClass *__hidden this);
// 2DBC8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000001102) ----------------------------------------------------
__int64 __fastcall AppleEHCIitdMemoryBlock::MetaClass::~MetaClass(AppleEHCIitdMemoryBlock::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000000110C) ----------------------------------------------------
__int64 __fastcall AppleEHCIitdMemoryBlock::AppleEHCIitdMemoryBlock(__int64 a1)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1);
  result = (__int64)off_163B0;
  *(_QWORD *)a1 = off_163B0;
  return result;
}
// 163B0: using guessed type __int64 (__fastcall *off_163B0[2])(AppleEHCIitdMemoryBlock *__hidden this);
// 2E330: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (000000000000112C) ----------------------------------------------------
__int64 __fastcall AppleEHCIitdMemoryBlock::AppleEHCIitdMemoryBlock(__int64 a1)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1);
  result = (__int64)off_163B0;
  *(_QWORD *)a1 = off_163B0;
  return result;
}
// 163B0: using guessed type __int64 (__fastcall *off_163B0[2])(AppleEHCIitdMemoryBlock *__hidden this);
// 2E330: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (000000000000114C) ----------------------------------------------------
__int64 __fastcall AppleEHCIitdMemoryBlock::~AppleEHCIitdMemoryBlock(AppleEHCIitdMemoryBlock *this)
{
  return OSObject::~OSObject(this);
}

//----- (0000000000001156) ----------------------------------------------------
__int64 __fastcall AppleEHCIitdMemoryBlock::~AppleEHCIitdMemoryBlock(AppleEHCIitdMemoryBlock *this)
{
  return OSObject::~OSObject(this);
}

//----- (0000000000001160) ----------------------------------------------------
void __fastcall AppleEHCIitdMemoryBlock::~AppleEHCIitdMemoryBlock(AppleEHCIitdMemoryBlock *this)
{
  OSObject::~OSObject(this);
  OSObject::operator delete((void *)this);
}

//----- (0000000000001182) ----------------------------------------------------
__int64 __fastcall AppleEHCIitdMemoryBlock::getMetaClass(AppleEHCIitdMemoryBlock *this)
{
  return (__int64)&AppleEHCIitdMemoryBlock::gMetaClass;
}
// 18988: using guessed type _QWORD AppleEHCIitdMemoryBlock::gMetaClass;

//----- (0000000000001190) ----------------------------------------------------
__int64 __fastcall AppleEHCIitdMemoryBlock::MetaClass::MetaClass(AppleEHCIitdMemoryBlock::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "AppleEHCIitdMemoryBlock", off_16060[0], 48LL);
  result = (__int64)off_164E0;
  *(_QWORD *)this = off_164E0;
  return result;
}
// 16060: using guessed type _QWORD off_16060[15];
// 164E0: using guessed type __int64 (__fastcall *off_164E0[2])(AppleEHCIitdMemoryBlock::MetaClass *__hidden this);
// 2DBC8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000011C2) ----------------------------------------------------
__int64 __fastcall AppleEHCIitdMemoryBlock::MetaClass::alloc(AppleEHCIitdMemoryBlock::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&stru_20.segname[8], a2);
  OSObject::OSObject(v2);
  *(_QWORD *)v2 = off_163B0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&AppleEHCIitdMemoryBlock::gMetaClass);
  return v2;
}
// 20: using guessed type segment_command_64 stru_20;
// 163B0: using guessed type __int64 (__fastcall *off_163B0[2])(AppleEHCIitdMemoryBlock *__hidden this);
// 18988: using guessed type _QWORD AppleEHCIitdMemoryBlock::gMetaClass;
// 2E330: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000001202) ----------------------------------------------------
__int64 __fastcall AppleEHCIitdMemoryBlock::AppleEHCIitdMemoryBlock(__int64 a1)
{
  OSObject::OSObject(a1);
  *(_QWORD *)a1 = off_163B0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&AppleEHCIitdMemoryBlock::gMetaClass);
}
// 163B0: using guessed type __int64 (__fastcall *off_163B0[2])(AppleEHCIitdMemoryBlock *__hidden this);
// 18988: using guessed type _QWORD AppleEHCIitdMemoryBlock::gMetaClass;
// 2E330: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000001232) ----------------------------------------------------
__int64 __fastcall AppleEHCIitdMemoryBlock::AppleEHCIitdMemoryBlock(__int64 a1)
{
  OSObject::OSObject(a1);
  *(_QWORD *)a1 = off_163B0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&AppleEHCIitdMemoryBlock::gMetaClass);
}
// 163B0: using guessed type __int64 (__fastcall *off_163B0[2])(AppleEHCIitdMemoryBlock *__hidden this);
// 18988: using guessed type _QWORD AppleEHCIitdMemoryBlock::gMetaClass;
// 2E330: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000001262) ----------------------------------------------------
__int64 __fastcall AppleEHCIitdMemoryBlock::NewMemoryBlock(AppleEHCIitdMemoryBlock *this, unsigned __int64 a2)
{
  __int64 v2; // r12@1
  __int64 v3; // rax@2
  unsigned __int64 v4; // r8@2
  __int64 v5; // r14@2
  __int64 v6; // rax@3
  __int64 v7; // r15@5
  signed __int64 v8; // rsi@5
  signed __int64 v9; // rsi@9
  void *v10; // rax@11
  int v12; // ebx@15
  int v13; // [sp+1Ch] [bp-34h]@1
  unsigned int v14; // [sp+20h] [bp-30h]@15
  int v15; // [sp+24h] [bp-2Ch]@17
  __int64 v16; // [sp+28h] [bp-28h]@1

  v2 = OSObject::operator new((OSObject *)&stru_20.segname[8], a2);
  OSObject::OSObject(v2);
  *(_QWORD *)v2 = off_163B0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&AppleEHCIitdMemoryBlock::gMetaClass);
  v16 = 0LL;
  v13 = 1;
  if ( v2 )
  {
    LODWORD(v3) = IODMACommand::withSpecification(off_16008[0], 32LL, 4096LL, 64LL, 0LL, 1LL);
    v5 = v3;
    if ( !v3 )
    {
      v7 = 0LL;
      KernelDebugLogInternal(
        1LL,
        1431519814LL,
        "AppleEHCIitdMemoryBlock::NewMemoryBlock - could not create IODMACommand");
      return v7;
    }
    v6 = IOBufferMemoryDescriptor::inTaskWithPhysicalMask(
           *(IOBufferMemoryDescriptor **)off_160D0,
           (task *)((char *)&dword_0 + 3),
           0x1000u,
           0xFFFFF000uLL,
           v4);
    *(_QWORD *)(v2 + 40) = v6;
    if ( v6 )
    {
      if ( (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v6 + 496LL))(v6, 0LL) )
      {
        v7 = 0LL;
        v8 = 1431519814LL;
        KernelDebugLogInternal(1LL, 1431519814LL, "AppleEHCIitdMemoryBlock::NewMemoryBlock - could not prepare buffer");
LABEL_13:
        (*(void (__fastcall **)(_QWORD, signed __int64))(**(_QWORD **)(v2 + 40) + 40LL))(*(_QWORD *)(v2 + 40), v8);
        *(_QWORD *)(v2 + 40) = 0LL;
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 40LL))(v2);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v5 + 40LL))(v5);
        return v7;
      }
      LODWORD(v10) = (*(int (__cdecl **)(_QWORD, _QWORD))(**(_QWORD **)(v2 + 40) + 736LL))(*(_QWORD *)(v2 + 40), 0LL);
      *(_QWORD *)(v2 + 24) = v10;
      bzero(v10, 0x1000uLL);
      if ( (*(int (__fastcall **)(__int64, _QWORD, signed __int64))(*(_QWORD *)v5 + 296LL))(
             v5,
             *(_QWORD *)(v2 + 40),
             1LL) )
      {
        v7 = 0LL;
        KernelDebugLogInternal(
          1LL,
          1431519814LL,
          "AppleEHCIitdMemoryBlock::NewMemoryBlock - could not set memory descriptor");
        v8 = 0LL;
        (*(void (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(v2 + 40) + 504LL))(*(_QWORD *)(v2 + 40), 0LL);
        goto LABEL_13;
      }
      v12 = (*(int (__fastcall **)(__int64, __int64 *, int *, int *))(*(_QWORD *)v5 + 344LL))(v5, &v16, &v14, &v13);
      (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v5 + 304LL))(v5, 1LL);
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v5 + 40LL))(v5);
      if ( !v12 && v13 == 1 && v15 == 4096 )
      {
        *(_QWORD *)(v2 + 16) = v14;
        return v2;
      }
      v7 = 0LL;
      KernelDebugLogInternal(
        1LL,
        1431519814LL,
        "AppleEHCIitdMemoryBlock::NewMemoryBlock - could not get physical segment");
      v9 = 0LL;
      (*(void (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(v2 + 40) + 504LL))(*(_QWORD *)(v2 + 40), 0LL);
      (*(void (__cdecl **)(_QWORD, _QWORD))(**(_QWORD **)(v2 + 40) + 40LL))(*(_QWORD *)(v2 + 40), 0LL);
      *(_QWORD *)(v2 + 40) = 0LL;
    }
    else
    {
      v7 = 0LL;
      v9 = 1431519814LL;
      KernelDebugLogInternal(1LL, 1431519814LL, "AppleEHCIitdMemoryBlock::NewMemoryBlock, could not allocate buffer!");
    }
    (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v2 + 40LL))(v2, v9);
    return v7;
  }
  KernelDebugLogInternal(1LL, 1431519814LL, "AppleEHCIitdMemoryBlock::NewMemoryBlock, constructor failed!");
  return v2;
}
// 0: using guessed type int dword_0;
// 20: using guessed type segment_command_64 stru_20;
// 16008: using guessed type __int64 off_16008[26];
// 160D0: using guessed type __int64 off_160D0;
// 163B0: using guessed type __int64 (__fastcall *off_163B0[2])(AppleEHCIitdMemoryBlock *__hidden this);
// 18988: using guessed type _QWORD AppleEHCIitdMemoryBlock::gMetaClass;
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);
// 2DBE8: using guessed type int __fastcall IODMACommand::withSpecification(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 2E330: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (00000000000014F4) ----------------------------------------------------
__int64 __fastcall AppleEHCIitdMemoryBlock::NumTDs(AppleEHCIitdMemoryBlock *this)
{
  return 42LL;
}

//----- (0000000000001500) ----------------------------------------------------
__int64 __fastcall AppleEHCIitdMemoryBlock::GetPhysicalPtr(AppleEHCIitdMemoryBlock *this, unsigned int a2)
{
  __int64 result; // rax@1

  result = 0LL;
  if ( a2 <= 0x29 )
    result = *((_QWORD *)this + 2) + 96LL * a2;
  return result;
}

//----- (000000000000151C) ----------------------------------------------------
__int64 __fastcall AppleEHCIitdMemoryBlock::GetLogicalPtr(AppleEHCIitdMemoryBlock *this, unsigned int a2)
{
  __int64 result; // rax@1

  result = 0LL;
  if ( a2 <= 0x29 )
    result = *((_QWORD *)this + 3) + 96LL * a2;
  return result;
}

//----- (0000000000001538) ----------------------------------------------------
__int64 __fastcall AppleEHCIitdMemoryBlock::GetNextBlock(AppleEHCIitdMemoryBlock *this)
{
  return *((_QWORD *)this + 4);
}

//----- (0000000000001542) ----------------------------------------------------
void __fastcall AppleEHCIitdMemoryBlock::SetNextBlock(AppleEHCIitdMemoryBlock *this, AppleEHCIitdMemoryBlock *a2)
{
  *((_QWORD *)this + 4) = a2;
}

//----- (000000000000154C) ----------------------------------------------------
int __fastcall AppleEHCIitdMemoryBlock::free(AppleEHCIitdMemoryBlock *this)
{
  AppleEHCIitdMemoryBlock *v1; // rbx@1
  __int64 v2; // rdi@1

  v1 = this;
  v2 = *((_QWORD *)this + 5);
  if ( v2 )
  {
    (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v2 + 504LL))(v2, 0LL);
    (*(void (__cdecl **)(_QWORD))(**((_QWORD **)v1 + 5) + 40LL))(*((_QWORD *)v1 + 5));
  }
  return (*(int (__fastcall **)(AppleEHCIitdMemoryBlock *))(off_16088[0] + 160))(v1);
}
// 16088: using guessed type __int64 off_16088[10];

//----- (000000000000158A) ----------------------------------------------------
__int64 __fastcall AppleEHCIitdMemoryBlock::MetaClass::~MetaClass(AppleEHCIitdMemoryBlock::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (00000000000015A0) ----------------------------------------------------
__int64 `global constructor keyed to'_a_0()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(&AppleEHCIitdMemoryBlock::gMetaClass, "AppleEHCIitdMemoryBlock", off_16060[0], 48LL);
  result = (__int64)off_164E0;
  AppleEHCIitdMemoryBlock::gMetaClass = off_164E0;
  return result;
}
// 16060: using guessed type _QWORD off_16060[15];
// 164E0: using guessed type __int64 (__fastcall *off_164E0[2])(AppleEHCIitdMemoryBlock::MetaClass *__hidden this);
// 18988: using guessed type _QWORD AppleEHCIitdMemoryBlock::gMetaClass;
// 2DBC8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000015E0) ----------------------------------------------------
__int64 `global destructor keyed to'_a_0()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&AppleEHCIitdMemoryBlock::gMetaClass);
}
// 18988: using guessed type _QWORD AppleEHCIitdMemoryBlock::gMetaClass;

//----- (0000000000001600) ----------------------------------------------------
__int64 __fastcall AppleEHCIQueueHead::MetaClass::MetaClass(AppleEHCIQueueHead::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "AppleEHCIQueueHead", off_16028[0], 112LL);
  result = (__int64)off_16740;
  *(_QWORD *)this = off_16740;
  return result;
}
// 16028: using guessed type _QWORD off_16028[22];
// 16740: using guessed type __int64 (__fastcall *off_16740[2])(AppleEHCIQueueHead::MetaClass *__hidden this);
// 2DBC8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000001632) ----------------------------------------------------
__int64 __fastcall AppleEHCIQueueHead::MetaClass::~MetaClass(AppleEHCIQueueHead::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000000163C) ----------------------------------------------------
__int64 __fastcall AppleEHCIQueueHead::AppleEHCIQueueHead(IOUSBControllerListElement *a1, const OSMetaClass *a2)
{
  __int64 result; // rax@1

  IOUSBControllerListElement::IOUSBControllerListElement(a1, a2);
  result = (__int64)off_165E0;
  *(_QWORD *)a1 = off_165E0;
  return result;
}
// 165E0: using guessed type __int64 (__fastcall *off_165E0[2])(AppleEHCIQueueHead *__hidden this);

//----- (000000000000165C) ----------------------------------------------------
__int64 __fastcall AppleEHCIQueueHead::AppleEHCIQueueHead(IOUSBControllerListElement *a1, const OSMetaClass *a2)
{
  __int64 result; // rax@1

  IOUSBControllerListElement::IOUSBControllerListElement(a1, a2);
  result = (__int64)off_165E0;
  *(_QWORD *)a1 = off_165E0;
  return result;
}
// 165E0: using guessed type __int64 (__fastcall *off_165E0[2])(AppleEHCIQueueHead *__hidden this);

//----- (000000000000167C) ----------------------------------------------------
__int64 __fastcall AppleEHCIQueueHead::~AppleEHCIQueueHead(AppleEHCIQueueHead *this)
{
  return IOUSBControllerListElement::~IOUSBControllerListElement(this);
}

//----- (0000000000001686) ----------------------------------------------------
__int64 __fastcall AppleEHCIQueueHead::~AppleEHCIQueueHead(AppleEHCIQueueHead *this)
{
  return IOUSBControllerListElement::~IOUSBControllerListElement(this);
}

//----- (0000000000001690) ----------------------------------------------------
void __fastcall AppleEHCIQueueHead::~AppleEHCIQueueHead(AppleEHCIQueueHead *this)
{
  IOUSBControllerListElement::~IOUSBControllerListElement(this);
  OSObject::operator delete((void *)this);
}

//----- (00000000000016B2) ----------------------------------------------------
__int64 __fastcall AppleEHCIQueueHead::getMetaClass(AppleEHCIQueueHead *this)
{
  return (__int64)&AppleEHCIQueueHead::gMetaClass;
}
// 189B0: using guessed type _QWORD AppleEHCIQueueHead::gMetaClass;

//----- (00000000000016C0) ----------------------------------------------------
__int64 __fastcall AppleEHCIQueueHead::MetaClass::MetaClass(AppleEHCIQueueHead::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "AppleEHCIQueueHead", off_16028[0], 112LL);
  result = (__int64)off_16740;
  *(_QWORD *)this = off_16740;
  return result;
}
// 16028: using guessed type _QWORD off_16028[22];
// 16740: using guessed type __int64 (__fastcall *off_16740[2])(AppleEHCIQueueHead::MetaClass *__hidden this);
// 2DBC8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000016F2) ----------------------------------------------------
IOUSBControllerListElement *__fastcall AppleEHCIQueueHead::MetaClass::alloc(AppleEHCIQueueHead::MetaClass *this, unsigned __int64 a2)
{
  IOUSBControllerListElement *v2; // rbx@1

  v2 = (IOUSBControllerListElement *)OSObject::operator new((OSObject *)&stru_68.sectname[8], a2);
  IOUSBControllerListElement::IOUSBControllerListElement(v2, (const OSMetaClass *)&AppleEHCIQueueHead::gMetaClass);
  *(_QWORD *)v2 = off_165E0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&AppleEHCIQueueHead::gMetaClass);
  return v2;
}
// 68: using guessed type section_64;
// 165E0: using guessed type __int64 (__fastcall *off_165E0[2])(AppleEHCIQueueHead *__hidden this);
// 189B0: using guessed type _QWORD AppleEHCIQueueHead::gMetaClass;

//----- (0000000000001732) ----------------------------------------------------
__int64 __fastcall AppleEHCIQueueHead::AppleEHCIQueueHead(IOUSBControllerListElement *a1)
{
  IOUSBControllerListElement::IOUSBControllerListElement(a1, (const OSMetaClass *)&AppleEHCIQueueHead::gMetaClass);
  *(_QWORD *)a1 = off_165E0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&AppleEHCIQueueHead::gMetaClass);
}
// 165E0: using guessed type __int64 (__fastcall *off_165E0[2])(AppleEHCIQueueHead *__hidden this);
// 189B0: using guessed type _QWORD AppleEHCIQueueHead::gMetaClass;

//----- (0000000000001762) ----------------------------------------------------
__int64 __fastcall AppleEHCIQueueHead::AppleEHCIQueueHead(IOUSBControllerListElement *a1)
{
  IOUSBControllerListElement::IOUSBControllerListElement(a1, (const OSMetaClass *)&AppleEHCIQueueHead::gMetaClass);
  *(_QWORD *)a1 = off_165E0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&AppleEHCIQueueHead::gMetaClass);
}
// 165E0: using guessed type __int64 (__fastcall *off_165E0[2])(AppleEHCIQueueHead *__hidden this);
// 189B0: using guessed type _QWORD AppleEHCIQueueHead::gMetaClass;

//----- (0000000000001792) ----------------------------------------------------
__int64 __fastcall AppleEHCIQueueHead::WithSharedMemory(__int64 a1, unsigned __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 result; // rax@1
  char v4; // cl@2

  v2 = OSObject::operator new((OSObject *)&stru_68.sectname[8], a2);
  IOUSBControllerListElement::IOUSBControllerListElement(
    (IOUSBControllerListElement *)v2,
    (const OSMetaClass *)&AppleEHCIQueueHead::gMetaClass);
  *(_QWORD *)v2 = off_165E0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&AppleEHCIQueueHead::gMetaClass);
  result = 0LL;
  if ( v2 )
  {
    v4 = (*(int (__fastcall **)(__int64, _QWORD *))(*(_QWORD *)v2 + 136LL))(v2, &AppleEHCIQueueHead::gMetaClass);
    result = 0LL;
    if ( v4 )
    {
      *(_QWORD *)(v2 + 24) = a1;
      *(_QWORD *)(v2 + 16) = a2;
      result = v2;
    }
  }
  return result;
}
// 68: using guessed type section_64 stru_68;
// 165E0: using guessed type __int64 (__fastcall *off_165E0[2])(AppleEHCIQueueHead *__hidden this);
// 189B0: using guessed type _QWORD AppleEHCIQueueHead::gMetaClass;

//----- (0000000000001804) ----------------------------------------------------
__int64 __fastcall AppleEHCIQueueHead::GetSharedLogical(AppleEHCIQueueHead *this)
{
  return *((_QWORD *)this + 3);
}

//----- (000000000000180E) ----------------------------------------------------
__int64 __fastcall AppleEHCIQueueHead::SetPhysicalLink(AppleEHCIQueueHead *this, int a2)
{
  __int64 result; // rax@1

  result = *((_QWORD *)this + 3);
  *(_DWORD *)result = a2;
  _mm_mfence();
  return result;
}

//----- (000000000000181E) ----------------------------------------------------
__int64 __fastcall AppleEHCIQueueHead::GetPhysicalLink(AppleEHCIQueueHead *this)
{
  return **((_DWORD **)this + 3);
}

//----- (000000000000182A) ----------------------------------------------------
__int64 __fastcall AppleEHCIQueueHead::GetPhysicalAddrWithType(AppleEHCIQueueHead *this)
{
  return *((_QWORD *)this + 2) | 2LL;
}

//----- (0000000000001838) ----------------------------------------------------
__int64 __fastcall AppleEHCIQueueHead::NormalizedPollingRate(AppleEHCIQueueHead *this)
{
  __int64 result; // rax@1

  LODWORD(result) = *((_WORD *)this + 39);
  if ( *((_BYTE *)this + 73) == 2 )
  {
    LODWORD(result) = (unsigned int)result >> 3;
    if ( !(_BYTE)result )
      LOBYTE(result) = 1;
  }
  return (unsigned __int8)result;
}

//----- (0000000000001858) ----------------------------------------------------
void __fastcall AppleEHCIQueueHead::print(uintptr_t arg2, signed int a2, uintptr_t a3)
{
  __int64 v3; // r14@1
  uintptr_t v4; // r15@1
  uintptr_t v5; // r12@1
  __int64 v6; // rbx@2
  int v7; // eax@2
  int v8; // eax@23
  uintptr_t arg1; // [sp+0h] [bp-30h]@1

  arg1 = a3;
  v3 = *(_QWORD *)(arg2 + 24);
  v4 = *(_DWORD *)(v3 + 4);
  v5 = *(_DWORD *)(v3 + 8);
  (*(void (**)(void))(off_16070[0] + 320))();
  if ( a2 <= 6 )
  {
    v6 = off_160C0[0];
    v7 = *(_DWORD *)off_160C0[0];
    if ( *(_DWORD *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    {
      kernel_debug(0x52D6004u, arg1, arg2, *(_DWORD *)(arg2 + 16), *(_QWORD *)(arg2 + 32), 0LL);
      v7 = *(_DWORD *)v6;
    }
    if ( v7 & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D6008u, arg1, *(_DWORD *)v3, v4, v5, 0LL);
    if ( *(_BYTE *)v6 & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D600Cu, arg1, *(_DWORD *)(v3 + 12), *(_DWORD *)(v3 + 16), *(_DWORD *)(v3 + 20), 0LL);
    if ( *(_BYTE *)v6 & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D6010u, arg1, *(_DWORD *)(v3 + 24), *(_DWORD *)(v3 + 28), *(_DWORD *)(v3 + 32), 0LL);
    if ( *(_BYTE *)v6 & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D6014u, arg1, *(_DWORD *)(v3 + 36), *(_DWORD *)(v3 + 40), *(_DWORD *)(v3 + 44), 0LL);
    if ( *(_BYTE *)v6 & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D6018u, arg1, *(_DWORD *)(v3 + 48), *(_DWORD *)(v3 + 52), *(_DWORD *)(v3 + 56), 0LL);
    if ( *(_BYTE *)v6 & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D601Cu, arg1, *(_DWORD *)(v3 + 60), *(_DWORD *)(v3 + 64), *(_QWORD *)(arg2 + 40), 0LL);
    v8 = *(_DWORD *)v6;
    if ( *(_DWORD *)v6 & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    {
      kernel_debug(0x52D6020u, arg1, *(_QWORD *)(arg2 + 48), *(_QWORD *)(arg2 + 56), *(_WORD *)(arg2 + 64), 0LL);
      v8 = *(_DWORD *)v6;
    }
    if ( v8 & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    {
      kernel_debug(0x52D6024u, arg1, *(_WORD *)(arg2 + 66), *(_WORD *)(arg2 + 68), *(_BYTE *)(arg2 + 70), 0LL);
      v8 = *(_DWORD *)v6;
    }
    if ( v8 & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    {
      kernel_debug(0x52D6028u, arg1, *(_BYTE *)(arg2 + 71), *(_BYTE *)(arg2 + 72), *(_BYTE *)(arg2 + 73), 0LL);
      v8 = *(_DWORD *)v6;
    }
    if ( v8 & 2 )
    {
      if ( *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D602Cu, arg1, *(_BYTE *)(arg2 + 74), *(_BYTE *)(arg2 + 75), *(_WORD *)(arg2 + 78), 0LL);
    }
  }
}
// 16070: using guessed type __int64 off_16070[13];
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];

//----- (0000000000001ADC) ----------------------------------------------------
__int64 __fastcall AppleEHCIIsochTransferDescriptor::MetaClass::MetaClass(AppleEHCIIsochTransferDescriptor::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "AppleEHCIIsochTransferDescriptor", off_16040[0], 112LL);
  result = (__int64)off_169A0;
  *(_QWORD *)this = off_169A0;
  return result;
}
// 16040: using guessed type _QWORD off_16040[19];
// 169A0: using guessed type __int64 (__fastcall *off_169A0[2])(AppleEHCIIsochTransferDescriptor::MetaClass *__hidden this);
// 2DBC8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000001B0E) ----------------------------------------------------
__int64 __fastcall AppleEHCIIsochTransferDescriptor::MetaClass::~MetaClass(AppleEHCIIsochTransferDescriptor::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000001B18) ----------------------------------------------------
__int64 __fastcall AppleEHCIIsochTransferDescriptor::AppleEHCIIsochTransferDescriptor(IOUSBControllerIsochListElement *a1, const OSMetaClass *a2)
{
  __int64 result; // rax@1

  IOUSBControllerIsochListElement::IOUSBControllerIsochListElement(a1, a2);
  result = (__int64)off_16840;
  *(_QWORD *)a1 = off_16840;
  return result;
}
// 16840: using guessed type __int64 (__fastcall *off_16840[2])(AppleEHCIIsochTransferDescriptor *__hidden this);

//----- (0000000000001B38) ----------------------------------------------------
__int64 __fastcall AppleEHCIIsochTransferDescriptor::AppleEHCIIsochTransferDescriptor(IOUSBControllerIsochListElement *a1, const OSMetaClass *a2)
{
  __int64 result; // rax@1

  IOUSBControllerIsochListElement::IOUSBControllerIsochListElement(a1, a2);
  result = (__int64)off_16840;
  *(_QWORD *)a1 = off_16840;
  return result;
}
// 16840: using guessed type __int64 (__fastcall *off_16840[2])(AppleEHCIIsochTransferDescriptor *__hidden this);

//----- (0000000000001B58) ----------------------------------------------------
__int64 __fastcall AppleEHCIIsochTransferDescriptor::~AppleEHCIIsochTransferDescriptor(AppleEHCIIsochTransferDescriptor *this)
{
  return IOUSBControllerIsochListElement::~IOUSBControllerIsochListElement(this);
}

//----- (0000000000001B62) ----------------------------------------------------
__int64 __fastcall AppleEHCIIsochTransferDescriptor::~AppleEHCIIsochTransferDescriptor(AppleEHCIIsochTransferDescriptor *this)
{
  return IOUSBControllerIsochListElement::~IOUSBControllerIsochListElement(this);
}

//----- (0000000000001B6C) ----------------------------------------------------
void __fastcall AppleEHCIIsochTransferDescriptor::~AppleEHCIIsochTransferDescriptor(AppleEHCIIsochTransferDescriptor *this)
{
  IOUSBControllerIsochListElement::~IOUSBControllerIsochListElement(this);
  OSObject::operator delete((void *)this);
}

//----- (0000000000001B8E) ----------------------------------------------------
__int64 __fastcall AppleEHCIIsochTransferDescriptor::getMetaClass(AppleEHCIIsochTransferDescriptor *this)
{
  return (__int64)&AppleEHCIIsochTransferDescriptor::gMetaClass;
}
// 189D8: using guessed type _QWORD AppleEHCIIsochTransferDescriptor::gMetaClass;

//----- (0000000000001B9C) ----------------------------------------------------
__int64 __fastcall AppleEHCIIsochTransferDescriptor::MetaClass::MetaClass(AppleEHCIIsochTransferDescriptor::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "AppleEHCIIsochTransferDescriptor", off_16040[0], 112LL);
  result = (__int64)off_169A0;
  *(_QWORD *)this = off_169A0;
  return result;
}
// 16040: using guessed type _QWORD off_16040[19];
// 169A0: using guessed type __int64 (__fastcall *off_169A0[2])(AppleEHCIIsochTransferDescriptor::MetaClass *__hidden this);
// 2DBC8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000001BCE) ----------------------------------------------------
IOUSBControllerIsochListElement *__fastcall AppleEHCIIsochTransferDescriptor::MetaClass::alloc(AppleEHCIIsochTransferDescriptor::MetaClass *this, unsigned __int64 a2)
{
  IOUSBControllerIsochListElement *v2; // rbx@1

  v2 = (IOUSBControllerIsochListElement *)OSObject::operator new((OSObject *)&stru_68.sectname[8], a2);
  IOUSBControllerIsochListElement::IOUSBControllerIsochListElement(
    v2,
    (const OSMetaClass *)&AppleEHCIIsochTransferDescriptor::gMetaClass);
  *(_QWORD *)v2 = off_16840;
  OSMetaClass::instanceConstructed((OSMetaClass *)&AppleEHCIIsochTransferDescriptor::gMetaClass);
  return v2;
}
// 68: using guessed type section_64 stru_68;
// 16840: using guessed type __int64 (__fastcall *off_16840[2])(AppleEHCIIsochTransferDescriptor *__hidden this);
// 189D8: using guessed type _QWORD AppleEHCIIsochTransferDescriptor::gMetaClass;

//----- (0000000000001C0E) ----------------------------------------------------
__int64 __fastcall AppleEHCIIsochTransferDescriptor::AppleEHCIIsochTransferDescriptor(IOUSBControllerIsochListElement *a1)
{
  IOUSBControllerIsochListElement::IOUSBControllerIsochListElement(
    a1,
    (const OSMetaClass *)&AppleEHCIIsochTransferDescriptor::gMetaClass);
  *(_QWORD *)a1 = off_16840;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&AppleEHCIIsochTransferDescriptor::gMetaClass);
}
// 16840: using guessed type __int64 (__fastcall *off_16840[2])(AppleEHCIIsochTransferDescriptor *__hidden this);
// 189D8: using guessed type _QWORD AppleEHCIIsochTransferDescriptor::gMetaClass;

//----- (0000000000001C3E) ----------------------------------------------------
__int64 __fastcall AppleEHCIIsochTransferDescriptor::AppleEHCIIsochTransferDescriptor(IOUSBControllerIsochListElement *a1)
{
  IOUSBControllerIsochListElement::IOUSBControllerIsochListElement(
    a1,
    (const OSMetaClass *)&AppleEHCIIsochTransferDescriptor::gMetaClass);
  *(_QWORD *)a1 = off_16840;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&AppleEHCIIsochTransferDescriptor::gMetaClass);
}
// 16840: using guessed type __int64 (__fastcall *off_16840[2])(AppleEHCIIsochTransferDescriptor *__hidden this);
// 189D8: using guessed type _QWORD AppleEHCIIsochTransferDescriptor::gMetaClass;

//----- (0000000000001C6E) ----------------------------------------------------
__int64 __fastcall AppleEHCIIsochTransferDescriptor::WithSharedMemory(__int64 a1, unsigned __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 result; // rax@1
  char v4; // cl@2

  v2 = OSObject::operator new((OSObject *)&stru_68.sectname[8], a2);
  IOUSBControllerIsochListElement::IOUSBControllerIsochListElement(
    (IOUSBControllerIsochListElement *)v2,
    (const OSMetaClass *)&AppleEHCIIsochTransferDescriptor::gMetaClass);
  *(_QWORD *)v2 = off_16840;
  OSMetaClass::instanceConstructed((OSMetaClass *)&AppleEHCIIsochTransferDescriptor::gMetaClass);
  result = 0LL;
  if ( v2 )
  {
    v4 = (*(int (__fastcall **)(__int64, _QWORD *))(*(_QWORD *)v2 + 136LL))(
           v2,
           &AppleEHCIIsochTransferDescriptor::gMetaClass);
    result = 0LL;
    if ( v4 )
    {
      *(_QWORD *)(v2 + 24) = a1;
      *(_QWORD *)(v2 + 16) = a2;
      result = v2;
    }
  }
  return result;
}
// 68: using guessed type section_64 stru_68;
// 16840: using guessed type __int64 (__fastcall *off_16840[2])(AppleEHCIIsochTransferDescriptor *__hidden this);
// 189D8: using guessed type _QWORD AppleEHCIIsochTransferDescriptor::gMetaClass;

//----- (0000000000001CE0) ----------------------------------------------------
__int64 __fastcall AppleEHCIIsochTransferDescriptor::GetSharedLogical(AppleEHCIIsochTransferDescriptor *this)
{
  return *((_QWORD *)this + 3);
}

//----- (0000000000001CEA) ----------------------------------------------------
__int64 __fastcall AppleEHCIIsochTransferDescriptor::SetPhysicalLink(AppleEHCIIsochTransferDescriptor *this, int a2)
{
  __int64 result; // rax@1

  result = *((_QWORD *)this + 3);
  *(_DWORD *)result = a2;
  _mm_mfence();
  return result;
}

//----- (0000000000001CFA) ----------------------------------------------------
__int64 __fastcall AppleEHCIIsochTransferDescriptor::GetPhysicalLink(AppleEHCIIsochTransferDescriptor *this)
{
  return **((_DWORD **)this + 3);
}

//----- (0000000000001D06) ----------------------------------------------------
__int64 __fastcall AppleEHCIIsochTransferDescriptor::GetPhysicalAddrWithType(AppleEHCIIsochTransferDescriptor *this)
{
  return *((_QWORD *)this + 2);
}

//----- (0000000000001D10) ----------------------------------------------------
__int64 __fastcall AppleEHCIIsochTransferDescriptor::mungeEHCIStatus(AppleEHCIIsochTransferDescriptor *this, unsigned int a2, unsigned __int16 *a3, int a4, char a5)
{
  unsigned int v5; // ebx@5
  int v6; // esi@10
  __int64 result; // rax@10

  if ( (unsigned __int64)(a2 & 0xE0000000) || a2 & 0x10000000 && a5 != 1 )
  {
    *a3 = 0;
    if ( (unsigned __int64)(a2 & 0x80000000) )
    {
      v5 = -536854514;
      if ( *(_BYTE *)off_160C0[0] & 2 )
      {
        if ( *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
          kernel_debug(
            0x52D5C10u,
            *(_WORD *)(*((_QWORD *)this + 5) + 116LL) | (*(_WORD *)(*((_QWORD *)this + 5) + 114LL) << 8) | (*(_BYTE *)(*((_QWORD *)this + 5) + 128LL) << 24),
            0LL,
            0LL,
            8uLL,
            0LL);
      }
    }
    else if ( a2 & 0x40000000 )
    {
      v5 = (a5 == 0) | 0xE000400C;
    }
    else
    {
      v5 = 5 * ((a2 & 0x20000000) == 0) - 536870168;
    }
    result = v5;
  }
  else
  {
    v6 = (a2 >> 16) & 0xFFF;
    *a3 = v6;
    result = 3758097127LL;
    if ( a5 != 1 || v6 == a4 )
      result = 0LL;
  }
  return result;
}
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];

//----- (0000000000001E0A) ----------------------------------------------------
__int64 __fastcall AppleEHCIIsochTransferDescriptor::UpdateFrameList(AppleEHCIIsochTransferDescriptor *this, __int64 a2)
{
  AppleEHCIIsochTransferDescriptor *v2; // rbx@1
  __int64 v3; // r12@1
  signed int v4; // er15@1
  char v5; // si@2
  __int64 v6; // rax@3
  char v9; // di@3
  int v10; // ecx@3
  int v11; // er13@3
  signed int v12; // er14@3
  __int64 v13; // rcx@4
  signed __int64 v14; // rdx@5
  unsigned int v15; // eax@7
  char v16; // dl@13
  __int64 v17; // rsi@13
  signed __int64 v18; // rsi@14
  __int16 v19; // t0@15
  __int16 v20; // t0@15
  __int16 v21; // t0@17
  __int16 v22; // t0@17
  __int64 v25; // [sp+8h] [bp-48h]@1
  __int64 v26; // [sp+10h] [bp-40h]@3
  int v27; // [sp+1Ch] [bp-34h]@3
  __int64 v28; // [sp+20h] [bp-30h]@3

  v25 = a2;
  v2 = this;
  v3 = *((_QWORD *)this + 6);
  v4 = 0;
  if ( v3 )
  {
    v5 = *((_BYTE *)this + 82);
    if ( v5 )
    {
      v28 = *((_QWORD *)this + 3);
      v6 = *((_QWORD *)this + 5);
      v4 = *(_DWORD *)(v6 + 120);
      _RCX = v25;
      __asm { bswap   rcx }
      v26 = _RCX;
      v9 = *((_BYTE *)this + 80);
      v10 = *((_DWORD *)v2 + 24);
      v11 = 0;
      v27 = (unsigned __int8)(v5 - 1);
      v12 = 0;
      do
      {
        v13 = (unsigned int)(v11 + v10);
        if ( v9 )
          v14 = v3 + 16 * v13 + 6;
        else
          v14 = v3 + 8 * v13 + 6;
        v15 = AppleEHCIIsochTransferDescriptor::mungeEHCIStatus(
                v2,
                *(_DWORD *)(v28 + 4LL * v12 + 4),
                (unsigned __int16 *)v14,
                *(_DWORD *)(v6 + 80),
                *(_BYTE *)(v6 + 128));
        if ( v15 == -536870169 )
        {
          if ( !v4 )
            v4 = -536870169;
        }
        else if ( v15 )
        {
          v4 = v15;
        }
        v9 = *((_BYTE *)v2 + 80);
        v16 = *((_BYTE *)v2 + 81);
        v10 = *((_DWORD *)v2 + 24);
        v17 = (unsigned int)(v11 + v10);
        if ( v9 )
        {
          v18 = 16 * v17;
          if ( v16 )
          {
            v19 = __ROL2__(*(_WORD *)(v3 + v18 + 6), 8);
            *(_WORD *)(v3 + v18 + 6) = v19;
            v20 = __ROL2__(*(_WORD *)(v3 + v18 + 4), 8);
            *(_WORD *)(v3 + v18 + 4) = v20;
            *(_QWORD *)(v3 + v18 + 8) = v26;
            *(_DWORD *)(v3 + v18) = _byteswap_ulong(v15);
          }
          else
          {
            *(_DWORD *)(v3 + v18) = v15;
            *(_QWORD *)(v3 + v18 + 8) = v25;
          }
        }
        else
        {
          if ( v16 )
          {
            v21 = __ROL2__(*(_WORD *)(v3 + 8 * v17 + 6), 8);
            *(_WORD *)(v3 + 8 * v17 + 6) = v21;
            v22 = __ROL2__(*(_WORD *)(v3 + 8 * v17 + 4), 8);
            *(_WORD *)(v3 + 8 * v17 + 4) = v22;
            v15 = _byteswap_ulong(v15);
          }
          *(_DWORD *)(v3 + 8 * v17) = v15;
        }
        v6 = *((_QWORD *)v2 + 5);
        v12 += *(_DWORD *)(v6 + 124);
        if ( v12 > 7 )
          break;
      }
      while ( v27 != (unsigned __int8)v11++ );
      *(_DWORD *)(v6 + 120) = v4;
    }
  }
  return (unsigned int)v4;
}

//----- (0000000000001F5E) ----------------------------------------------------
__int64 __fastcall AppleEHCIIsochTransferDescriptor::Deallocate(AppleEHCIIsochTransferDescriptor *a1, AppleUSBEHCI *this)
{
  return AppleUSBEHCI::DeallocateITD(this, a1);
}

//----- (0000000000001F72) ----------------------------------------------------
int __fastcall AppleEHCIIsochTransferDescriptor::print(AppleEHCIIsochTransferDescriptor *this)
{
  return (*(int (__fastcall **)(AppleEHCIIsochTransferDescriptor *))(off_16080[0] + 320))(this);
}
// 16080: using guessed type __int64 off_16080[11];

//----- (0000000000001F84) ----------------------------------------------------
__int64 __fastcall AppleEHCISplitIsochTransferDescriptor::MetaClass::MetaClass(AppleEHCISplitIsochTransferDescriptor::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "AppleEHCISplitIsochTransferDescriptor", off_16040[0], 120LL);
  result = (__int64)off_16C00;
  *(_QWORD *)this = off_16C00;
  return result;
}
// 16040: using guessed type _QWORD off_16040[19];
// 16C00: using guessed type __int64 (__fastcall *off_16C00[2])(AppleEHCISplitIsochTransferDescriptor::MetaClass *__hidden this);
// 2DBC8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000001FB6) ----------------------------------------------------
__int64 __fastcall AppleEHCISplitIsochTransferDescriptor::MetaClass::~MetaClass(AppleEHCISplitIsochTransferDescriptor::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000001FC0) ----------------------------------------------------
__int64 __fastcall AppleEHCISplitIsochTransferDescriptor::AppleEHCISplitIsochTransferDescriptor(IOUSBControllerIsochListElement *a1, const OSMetaClass *a2)
{
  __int64 result; // rax@1

  IOUSBControllerIsochListElement::IOUSBControllerIsochListElement(a1, a2);
  result = (__int64)off_16AA0;
  *(_QWORD *)a1 = off_16AA0;
  return result;
}
// 16AA0: using guessed type __int64 (__fastcall *off_16AA0[2])(AppleEHCISplitIsochTransferDescriptor *__hidden this);

//----- (0000000000001FE0) ----------------------------------------------------
__int64 __fastcall AppleEHCISplitIsochTransferDescriptor::AppleEHCISplitIsochTransferDescriptor(IOUSBControllerIsochListElement *a1, const OSMetaClass *a2)
{
  __int64 result; // rax@1

  IOUSBControllerIsochListElement::IOUSBControllerIsochListElement(a1, a2);
  result = (__int64)off_16AA0;
  *(_QWORD *)a1 = off_16AA0;
  return result;
}
// 16AA0: using guessed type __int64 (__fastcall *off_16AA0[2])(AppleEHCISplitIsochTransferDescriptor *__hidden this);

//----- (0000000000002000) ----------------------------------------------------
__int64 __fastcall AppleEHCISplitIsochTransferDescriptor::~AppleEHCISplitIsochTransferDescriptor(AppleEHCISplitIsochTransferDescriptor *this)
{
  return IOUSBControllerIsochListElement::~IOUSBControllerIsochListElement(this);
}

//----- (000000000000200A) ----------------------------------------------------
__int64 __fastcall AppleEHCISplitIsochTransferDescriptor::~AppleEHCISplitIsochTransferDescriptor(AppleEHCISplitIsochTransferDescriptor *this)
{
  return IOUSBControllerIsochListElement::~IOUSBControllerIsochListElement(this);
}

//----- (0000000000002014) ----------------------------------------------------
void __fastcall AppleEHCISplitIsochTransferDescriptor::~AppleEHCISplitIsochTransferDescriptor(AppleEHCISplitIsochTransferDescriptor *this)
{
  IOUSBControllerIsochListElement::~IOUSBControllerIsochListElement(this);
  OSObject::operator delete((void *)this);
}

//----- (0000000000002036) ----------------------------------------------------
__int64 __fastcall AppleEHCISplitIsochTransferDescriptor::getMetaClass(AppleEHCISplitIsochTransferDescriptor *this)
{
  return (__int64)&AppleEHCISplitIsochTransferDescriptor::gMetaClass;
}
// 18A00: using guessed type _QWORD AppleEHCISplitIsochTransferDescriptor::gMetaClass;

//----- (0000000000002044) ----------------------------------------------------
__int64 __fastcall AppleEHCISplitIsochTransferDescriptor::MetaClass::MetaClass(AppleEHCISplitIsochTransferDescriptor::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "AppleEHCISplitIsochTransferDescriptor", off_16040[0], 120LL);
  result = (__int64)off_16C00;
  *(_QWORD *)this = off_16C00;
  return result;
}
// 16040: using guessed type _QWORD off_16040[19];
// 16C00: using guessed type __int64 (__fastcall *off_16C00[2])(AppleEHCISplitIsochTransferDescriptor::MetaClass *__hidden this);
// 2DBC8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000002076) ----------------------------------------------------
IOUSBControllerIsochListElement *__fastcall AppleEHCISplitIsochTransferDescriptor::MetaClass::alloc(AppleEHCISplitIsochTransferDescriptor::MetaClass *this, unsigned __int64 a2)
{
  IOUSBControllerIsochListElement *v2; // rbx@1

  v2 = (IOUSBControllerIsochListElement *)OSObject::operator new((OSObject *)stru_68.segname, a2);
  IOUSBControllerIsochListElement::IOUSBControllerIsochListElement(
    v2,
    (const OSMetaClass *)&AppleEHCISplitIsochTransferDescriptor::gMetaClass);
  *(_QWORD *)v2 = off_16AA0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&AppleEHCISplitIsochTransferDescriptor::gMetaClass);
  return v2;
}
// 68: using guessed type section_64 stru_68;
// 16AA0: using guessed type __int64 (__fastcall *off_16AA0[2])(AppleEHCISplitIsochTransferDescriptor *__hidden this);
// 18A00: using guessed type _QWORD AppleEHCISplitIsochTransferDescriptor::gMetaClass;

//----- (00000000000020B6) ----------------------------------------------------
__int64 __fastcall AppleEHCISplitIsochTransferDescriptor::AppleEHCISplitIsochTransferDescriptor(IOUSBControllerIsochListElement *a1)
{
  IOUSBControllerIsochListElement::IOUSBControllerIsochListElement(
    a1,
    (const OSMetaClass *)&AppleEHCISplitIsochTransferDescriptor::gMetaClass);
  *(_QWORD *)a1 = off_16AA0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&AppleEHCISplitIsochTransferDescriptor::gMetaClass);
}
// 16AA0: using guessed type __int64 (__fastcall *off_16AA0[2])(AppleEHCISplitIsochTransferDescriptor *__hidden this);
// 18A00: using guessed type _QWORD AppleEHCISplitIsochTransferDescriptor::gMetaClass;

//----- (00000000000020E6) ----------------------------------------------------
__int64 __fastcall AppleEHCISplitIsochTransferDescriptor::AppleEHCISplitIsochTransferDescriptor(IOUSBControllerIsochListElement *a1)
{
  IOUSBControllerIsochListElement::IOUSBControllerIsochListElement(
    a1,
    (const OSMetaClass *)&AppleEHCISplitIsochTransferDescriptor::gMetaClass);
  *(_QWORD *)a1 = off_16AA0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&AppleEHCISplitIsochTransferDescriptor::gMetaClass);
}
// 16AA0: using guessed type __int64 (__fastcall *off_16AA0[2])(AppleEHCISplitIsochTransferDescriptor *__hidden this);
// 18A00: using guessed type _QWORD AppleEHCISplitIsochTransferDescriptor::gMetaClass;

//----- (0000000000002116) ----------------------------------------------------
__int64 __fastcall AppleEHCISplitIsochTransferDescriptor::WithSharedMemory(__int64 a1, unsigned __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 result; // rax@1
  char v4; // cl@2

  v2 = OSObject::operator new((OSObject *)stru_68.segname, a2);
  IOUSBControllerIsochListElement::IOUSBControllerIsochListElement(
    (IOUSBControllerIsochListElement *)v2,
    (const OSMetaClass *)&AppleEHCISplitIsochTransferDescriptor::gMetaClass);
  *(_QWORD *)v2 = off_16AA0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&AppleEHCISplitIsochTransferDescriptor::gMetaClass);
  result = 0LL;
  if ( v2 )
  {
    v4 = (*(int (__fastcall **)(__int64, _QWORD *))(*(_QWORD *)v2 + 136LL))(
           v2,
           &AppleEHCISplitIsochTransferDescriptor::gMetaClass);
    result = 0LL;
    if ( v4 )
    {
      *(_QWORD *)(v2 + 24) = a1;
      *(_QWORD *)(v2 + 16) = a2;
      result = v2;
    }
  }
  return result;
}
// 68: using guessed type section_64 stru_68;
// 16AA0: using guessed type __int64 (__fastcall *off_16AA0[2])(AppleEHCISplitIsochTransferDescriptor *__hidden this);
// 18A00: using guessed type _QWORD AppleEHCISplitIsochTransferDescriptor::gMetaClass;

//----- (0000000000002188) ----------------------------------------------------
__int64 __fastcall AppleEHCISplitIsochTransferDescriptor::GetSharedLogical(AppleEHCISplitIsochTransferDescriptor *this)
{
  return *((_QWORD *)this + 3);
}

//----- (0000000000002192) ----------------------------------------------------
__int64 __fastcall AppleEHCISplitIsochTransferDescriptor::SetPhysicalLink(AppleEHCISplitIsochTransferDescriptor *this, int a2)
{
  __int64 result; // rax@1

  result = *((_QWORD *)this + 3);
  *(_DWORD *)result = a2;
  _mm_mfence();
  return result;
}

//----- (00000000000021A2) ----------------------------------------------------
__int64 __fastcall AppleEHCISplitIsochTransferDescriptor::GetPhysicalLink(AppleEHCISplitIsochTransferDescriptor *this)
{
  return **((_DWORD **)this + 3);
}

//----- (00000000000021AE) ----------------------------------------------------
__int64 __fastcall AppleEHCISplitIsochTransferDescriptor::GetPhysicalAddrWithType(AppleEHCISplitIsochTransferDescriptor *this)
{
  return *((_QWORD *)this + 2) | 4LL;
}

//----- (00000000000021BC) ----------------------------------------------------
__int64 __fastcall AppleEHCISplitIsochTransferDescriptor::UpdateFrameList(AppleEHCISplitIsochTransferDescriptor *this, uintptr_t a2)
{
  unsigned int v3; // eax@1
  __int64 v4; // r15@1
  signed int v5; // er14@1
  __int64 v6; // rcx@3
  signed __int64 v7; // rcx@4
  unsigned __int16 v8; // r13@6
  int v9; // ecx@6
  int v10; // esi@7
  char v11; // al@25
  __int16 v12; // r13@27
  signed __int64 v13; // rax@27
  __int16 v14; // t0@27
  __int16 v16; // r13@29
  __int64 v17; // rax@29
  __int16 v18; // t0@29
  signed __int64 v19; // rax@30
  __int64 v20; // rax@33
  __int64 v21; // rax@35
  int v23; // edx@48
  char v24; // al@49

  _R12 = a2;
  v3 = *(_DWORD *)(*((_QWORD *)this + 3) + 12LL);
  v4 = *((_QWORD *)this + 6);
  v5 = 0;
  if ( !v4 || *((_BYTE *)this + 112) )
    return (unsigned int)v5;
  v6 = *((_DWORD *)this + 24);
  if ( *((_BYTE *)this + 80) )
    v7 = v4 + 16 * v6 + 4;
  else
    v7 = v4 + 8 * v6 + 4;
  v8 = *(_WORD *)v7;
  v9 = *(_WORD *)v7;
  if ( !(v3 & 0x80) )
  {
    if ( v3 & 0x40 )
    {
      v10 = -536870163;
      if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      {
        v8 = 0;
        kernel_debug(
          0x52D5C10u,
          *(_WORD *)(*((_QWORD *)this + 5) + 116LL) | (*(_WORD *)(*((_QWORD *)this + 5) + 114LL) << 8) | (*(_BYTE *)(*((_QWORD *)this + 5) + 128LL) << 24),
          0LL,
          0LL,
          6uLL,
          0LL);
        v10 = -536870163;
        goto LABEL_25;
      }
    }
    else if ( v3 & 0x20 )
    {
      if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
        kernel_debug(
          0x52D5C10u,
          *(_WORD *)(*((_QWORD *)this + 5) + 116LL) | (*(_WORD *)(*((_QWORD *)this + 5) + 114LL) << 8) | (*(_BYTE *)(*((_QWORD *)this + 5) + 128LL) << 24),
          0LL,
          0LL,
          5uLL,
          0LL);
      v10 = (*(_BYTE *)(*((_QWORD *)this + 5) + 128LL) == 0) | 0xE000400C;
    }
    else if ( v3 & 0x10 )
    {
      if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
        kernel_debug(
          0x52D5C10u,
          *(_WORD *)(*((_QWORD *)this + 5) + 116LL) | (*(_WORD *)(*((_QWORD *)this + 5) + 114LL) << 8) | (*(_BYTE *)(*((_QWORD *)this + 5) + 128LL) << 24),
          0LL,
          0LL,
          4uLL,
          0LL);
      v10 = 5 * (*(_BYTE *)(*((_QWORD *)this + 5) + 128LL) == 0) - 536870168;
    }
    else if ( v3 & 8 )
    {
      v10 = -536854521;
      if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      {
        v8 = 0;
        kernel_debug(
          0x52D5C10u,
          *(_WORD *)(*((_QWORD *)this + 5) + 116LL) | (*(_WORD *)(*((_QWORD *)this + 5) + 114LL) << 8) | (*(_BYTE *)(*((_QWORD *)this + 5) + 128LL) << 24),
          0LL,
          0LL,
          3uLL,
          0LL);
        v10 = -536854521;
        goto LABEL_25;
      }
    }
    else
    {
      if ( !(v3 & 4) )
      {
        v23 = v9 - ((v3 >> 16) & 0x3FF);
        v10 = 0;
        if ( v9 != (unsigned __int16)(v9 - (HIWORD(v3) & 0x3FF)) )
        {
          v24 = *(_BYTE *)(*((_QWORD *)this + 5) + 128LL);
          v10 = -536854515;
          if ( v24 )
          {
            v10 = -536870169;
            if ( v24 != 1 )
              v10 = 0;
          }
          v8 = v23;
        }
        goto LABEL_25;
      }
      v10 = -536854514;
      if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      {
        v8 = 0;
        kernel_debug(
          0x52D5C10u,
          *(_WORD *)(*((_QWORD *)this + 5) + 116LL) | (*(_WORD *)(*((_QWORD *)this + 5) + 114LL) << 8) | (*(_BYTE *)(*((_QWORD *)this + 5) + 128LL) << 24),
          0LL,
          0LL,
          2uLL,
          0LL);
        v10 = -536854514;
        goto LABEL_25;
      }
    }
LABEL_24:
    v8 = 0;
    goto LABEL_25;
  }
  v10 = -536854513;
  if ( !(*(_BYTE *)off_160C0[0] & 2) || !(*(_DWORD *)off_160C8[0] & 0xFFFFFFF7) )
    goto LABEL_24;
  v8 = 0;
  kernel_debug(
    0x52D5C10u,
    *(_WORD *)(*((_QWORD *)this + 5) + 116LL) | (*(_WORD *)(*((_QWORD *)this + 5) + 114LL) << 8) | (*(_BYTE *)(*((_QWORD *)this + 5) + 128LL) << 24),
    0LL,
    0LL,
    7uLL,
    0LL);
  v10 = -536854513;
LABEL_25:
  v11 = *((_BYTE *)this + 81);
  if ( *((_BYTE *)this + 80) )
  {
    if ( v11 )
    {
      v12 = __ROL2__(v8, 8);
      v13 = 16LL * *((_DWORD *)this + 24);
      *(_WORD *)(v4 + v13 + 6) = v12;
      v14 = __ROL2__(*(_WORD *)(v4 + v13 + 4), 8);
      *(_WORD *)(v4 + v13 + 4) = v14;
      __asm { bswap   r12 }
      *(_QWORD *)(v4 + v13 + 8) = _R12;
      *(_DWORD *)(v4 + v13) = _byteswap_ulong(v10);
    }
    else
    {
      v19 = 16LL * *((_DWORD *)this + 24);
      *(_WORD *)(v4 + v19 + 6) = v8;
      *(_QWORD *)(v4 + v19 + 8) = _R12;
      *(_DWORD *)(v4 + v19) = v10;
      if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
        kernel_debug(
          0x52D5C0Cu,
          *(_WORD *)(*((_QWORD *)this + 5) + 116LL) | (*(_WORD *)(*((_QWORD *)this + 5) + 114LL) << 8) | (*(_BYTE *)(*((_QWORD *)this + 5) + 128LL) << 24),
          v19 + v4,
          v8,
          _R12,
          0LL);
    }
  }
  else if ( v11 )
  {
    v16 = __ROL2__(v8, 8);
    v17 = *((_DWORD *)this + 24);
    *(_WORD *)(v4 + 8 * v17 + 6) = v16;
    v18 = __ROL2__(*(_WORD *)(v4 + 8 * v17 + 4), 8);
    *(_WORD *)(v4 + 8 * v17 + 4) = v18;
    *(_DWORD *)(v4 + 8 * v17) = _byteswap_ulong(v10);
  }
  else
  {
    v20 = *((_DWORD *)this + 24);
    *(_WORD *)(v4 + 8 * v20 + 6) = v8;
    *(_DWORD *)(v4 + 8 * v20) = v10;
  }
  if ( v10 == -536870169 )
  {
    v21 = *((_QWORD *)this + 5);
    v5 = -536870169;
    if ( !*(_DWORD *)(v21 + 120) )
      *(_DWORD *)(v21 + 120) = -536870169;
  }
  else if ( v10 )
  {
    *(_DWORD *)(*((_QWORD *)this + 5) + 120LL) = v10;
    v5 = v10;
  }
  return (unsigned int)v5;
}
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];

//----- (0000000000002622) ----------------------------------------------------
__int64 __fastcall AppleEHCISplitIsochTransferDescriptor::Deallocate(AppleEHCISplitIsochTransferDescriptor *a1, AppleUSBEHCI *this)
{
  return AppleUSBEHCI::DeallocateSITD(this, a1);
}

//----- (0000000000002636) ----------------------------------------------------
int __fastcall AppleEHCISplitIsochTransferDescriptor::print(AppleEHCISplitIsochTransferDescriptor *this)
{
  return (*(int (__fastcall **)(AppleEHCISplitIsochTransferDescriptor *))(off_16080[0] + 320))(this);
}
// 16080: using guessed type __int64 off_16080[11];

//----- (0000000000002648) ----------------------------------------------------
__int64 __fastcall AppleEHCIIsochEndpoint::MetaClass::MetaClass(AppleEHCIIsochEndpoint::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "AppleEHCIIsochEndpoint", off_16038[0], 168LL);
  result = (__int64)off_16E30;
  *(_QWORD *)this = off_16E30;
  return result;
}
// 16038: using guessed type _QWORD off_16038[20];
// 16E30: using guessed type __int64 (__fastcall *off_16E30[2])(AppleEHCIIsochEndpoint::MetaClass *__hidden this);
// 2DBC8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000000267A) ----------------------------------------------------
__int64 __fastcall AppleEHCIIsochEndpoint::MetaClass::~MetaClass(AppleEHCIIsochEndpoint::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000002684) ----------------------------------------------------
__int64 __fastcall AppleEHCIIsochEndpoint::AppleEHCIIsochEndpoint(IOUSBControllerIsochEndpoint *a1, const OSMetaClass *a2)
{
  __int64 result; // rax@1

  IOUSBControllerIsochEndpoint::IOUSBControllerIsochEndpoint(a1, a2);
  result = (__int64)off_16D00;
  *(_QWORD *)a1 = off_16D00;
  return result;
}
// 16D00: using guessed type __int64 (__fastcall *off_16D00[2])(AppleEHCIIsochEndpoint *__hidden this);

//----- (00000000000026A4) ----------------------------------------------------
__int64 __fastcall AppleEHCIIsochEndpoint::AppleEHCIIsochEndpoint(IOUSBControllerIsochEndpoint *a1, const OSMetaClass *a2)
{
  __int64 result; // rax@1

  IOUSBControllerIsochEndpoint::IOUSBControllerIsochEndpoint(a1, a2);
  result = (__int64)off_16D00;
  *(_QWORD *)a1 = off_16D00;
  return result;
}
// 16D00: using guessed type __int64 (__fastcall *off_16D00[2])(AppleEHCIIsochEndpoint *__hidden this);

//----- (00000000000026C4) ----------------------------------------------------
__int64 __fastcall AppleEHCIIsochEndpoint::~AppleEHCIIsochEndpoint(AppleEHCIIsochEndpoint *this)
{
  return IOUSBControllerIsochEndpoint::~IOUSBControllerIsochEndpoint(this);
}

//----- (00000000000026CE) ----------------------------------------------------
__int64 __fastcall AppleEHCIIsochEndpoint::~AppleEHCIIsochEndpoint(AppleEHCIIsochEndpoint *this)
{
  return IOUSBControllerIsochEndpoint::~IOUSBControllerIsochEndpoint(this);
}

//----- (00000000000026D8) ----------------------------------------------------
void __fastcall AppleEHCIIsochEndpoint::~AppleEHCIIsochEndpoint(AppleEHCIIsochEndpoint *this)
{
  IOUSBControllerIsochEndpoint::~IOUSBControllerIsochEndpoint(this);
  OSObject::operator delete((void *)this);
}

//----- (00000000000026FA) ----------------------------------------------------
__int64 __fastcall AppleEHCIIsochEndpoint::getMetaClass(AppleEHCIIsochEndpoint *this)
{
  return (__int64)&AppleEHCIIsochEndpoint::gMetaClass;
}
// 18A28: using guessed type _QWORD AppleEHCIIsochEndpoint::gMetaClass;

//----- (0000000000002708) ----------------------------------------------------
__int64 __fastcall AppleEHCIIsochEndpoint::MetaClass::MetaClass(AppleEHCIIsochEndpoint::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "AppleEHCIIsochEndpoint", off_16038[0], 168LL);
  result = (__int64)off_16E30;
  *(_QWORD *)this = off_16E30;
  return result;
}
// 16038: using guessed type _QWORD off_16038[20];
// 16E30: using guessed type __int64 (__fastcall *off_16E30[2])(AppleEHCIIsochEndpoint::MetaClass *__hidden this);
// 2DBC8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000000273A) ----------------------------------------------------
IOUSBControllerIsochEndpoint *__fastcall AppleEHCIIsochEndpoint::MetaClass::alloc(AppleEHCIIsochEndpoint::MetaClass *this, unsigned __int64 a2)
{
  IOUSBControllerIsochEndpoint *v2; // rbx@1

  v2 = (IOUSBControllerIsochEndpoint *)OSObject::operator new((OSObject *)&stru_68.flags, a2);
  IOUSBControllerIsochEndpoint::IOUSBControllerIsochEndpoint(
    v2,
    (const OSMetaClass *)&AppleEHCIIsochEndpoint::gMetaClass);
  *(_QWORD *)v2 = off_16D00;
  OSMetaClass::instanceConstructed((OSMetaClass *)&AppleEHCIIsochEndpoint::gMetaClass);
  return v2;
}
// 68: using guessed type section_64 stru_68;
// 16D00: using guessed type __int64 (__fastcall *off_16D00[2])(AppleEHCIIsochEndpoint *__hidden this);
// 18A28: using guessed type _QWORD AppleEHCIIsochEndpoint::gMetaClass;

//----- (000000000000277A) ----------------------------------------------------
__int64 __fastcall AppleEHCIIsochEndpoint::AppleEHCIIsochEndpoint(IOUSBControllerIsochEndpoint *a1)
{
  IOUSBControllerIsochEndpoint::IOUSBControllerIsochEndpoint(
    a1,
    (const OSMetaClass *)&AppleEHCIIsochEndpoint::gMetaClass);
  *(_QWORD *)a1 = off_16D00;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&AppleEHCIIsochEndpoint::gMetaClass);
}
// 16D00: using guessed type __int64 (__fastcall *off_16D00[2])(AppleEHCIIsochEndpoint *__hidden this);
// 18A28: using guessed type _QWORD AppleEHCIIsochEndpoint::gMetaClass;

//----- (00000000000027AA) ----------------------------------------------------
__int64 __fastcall AppleEHCIIsochEndpoint::AppleEHCIIsochEndpoint(IOUSBControllerIsochEndpoint *a1)
{
  IOUSBControllerIsochEndpoint::IOUSBControllerIsochEndpoint(
    a1,
    (const OSMetaClass *)&AppleEHCIIsochEndpoint::gMetaClass);
  *(_QWORD *)a1 = off_16D00;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&AppleEHCIIsochEndpoint::gMetaClass);
}
// 16D00: using guessed type __int64 (__fastcall *off_16D00[2])(AppleEHCIIsochEndpoint *__hidden this);
// 18A28: using guessed type _QWORD AppleEHCIIsochEndpoint::gMetaClass;

//----- (00000000000027DA) ----------------------------------------------------
int __fastcall AppleEHCIIsochEndpoint::init(AppleEHCIIsochEndpoint *this)
{
  int result; // eax@1

  result = (*(int (__cdecl **)(AppleEHCIIsochEndpoint *))(off_16078[0] + 152))(this);
  if ( (_BYTE)result )
  {
    *((_QWORD *)this + 18) = 0LL;
    *((_WORD *)this + 76) = 0;
    *((_DWORD *)this + 40) = 0;
    *((_WORD *)this + 78) = 0;
    *((_BYTE *)this + 164) = 0;
    *((_QWORD *)this + 17) = 0LL;
  }
  return result;
}
// 16078: using guessed type __int64 off_16078[12];

//----- (0000000000002834) ----------------------------------------------------
void __fastcall AppleEHCIIsochEndpoint::print(AppleEHCIIsochEndpoint *this)
{
  ;
}

//----- (000000000000283A) ----------------------------------------------------
__int64 __fastcall AppleEHCIQueueHead::MetaClass::~MetaClass(AppleEHCIQueueHead::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000002844) ----------------------------------------------------
__int64 __fastcall AppleEHCIIsochTransferDescriptor::MetaClass::~MetaClass(AppleEHCIIsochTransferDescriptor::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000000284E) ----------------------------------------------------
__int64 __fastcall AppleEHCISplitIsochTransferDescriptor::MetaClass::~MetaClass(AppleEHCISplitIsochTransferDescriptor::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000002858) ----------------------------------------------------
__int64 __fastcall AppleEHCIIsochEndpoint::MetaClass::~MetaClass(AppleEHCIIsochEndpoint::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000002870) ----------------------------------------------------
__int64 `global constructor keyed to'_a_1()
{
  __int64 v0; // rbx@1
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(&AppleEHCIQueueHead::gMetaClass, "AppleEHCIQueueHead", off_16028[0], 112LL);
  AppleEHCIQueueHead::gMetaClass = off_16740;
  v0 = off_16040[0];
  OSMetaClass::OSMetaClass(
    &AppleEHCIIsochTransferDescriptor::gMetaClass,
    "AppleEHCIIsochTransferDescriptor",
    off_16040[0],
    112LL);
  AppleEHCIIsochTransferDescriptor::gMetaClass = off_169A0;
  OSMetaClass::OSMetaClass(
    &AppleEHCISplitIsochTransferDescriptor::gMetaClass,
    "AppleEHCISplitIsochTransferDescriptor",
    v0,
    120LL);
  AppleEHCISplitIsochTransferDescriptor::gMetaClass = off_16C00;
  OSMetaClass::OSMetaClass(&AppleEHCIIsochEndpoint::gMetaClass, "AppleEHCIIsochEndpoint", off_16038[0], 168LL);
  result = (__int64)off_16E30;
  AppleEHCIIsochEndpoint::gMetaClass = off_16E30;
  return result;
}
// 16028: using guessed type _QWORD off_16028[22];
// 16038: using guessed type _QWORD off_16038[20];
// 16040: using guessed type _QWORD off_16040[19];
// 16740: using guessed type __int64 (__fastcall *off_16740[2])(AppleEHCIQueueHead::MetaClass *__hidden this);
// 169A0: using guessed type __int64 (__fastcall *off_169A0[2])(AppleEHCIIsochTransferDescriptor::MetaClass *__hidden this);
// 16C00: using guessed type __int64 (__fastcall *off_16C00[2])(AppleEHCISplitIsochTransferDescriptor::MetaClass *__hidden this);
// 16E30: using guessed type __int64 (__fastcall *off_16E30[2])(AppleEHCIIsochEndpoint::MetaClass *__hidden this);
// 189B0: using guessed type _QWORD AppleEHCIQueueHead::gMetaClass;
// 189D8: using guessed type _QWORD AppleEHCIIsochTransferDescriptor::gMetaClass;
// 18A00: using guessed type _QWORD AppleEHCISplitIsochTransferDescriptor::gMetaClass;
// 18A28: using guessed type _QWORD AppleEHCIIsochEndpoint::gMetaClass;
// 2DBC8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000002930) ----------------------------------------------------
__int64 `global destructor keyed to'_a_1()
{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&AppleEHCIIsochEndpoint::gMetaClass);
  OSMetaClass::~OSMetaClass((OSMetaClass *)&AppleEHCISplitIsochTransferDescriptor::gMetaClass);
  OSMetaClass::~OSMetaClass((OSMetaClass *)&AppleEHCIIsochTransferDescriptor::gMetaClass);
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&AppleEHCIQueueHead::gMetaClass);
}
// 189B0: using guessed type _QWORD AppleEHCIQueueHead::gMetaClass;
// 189D8: using guessed type _QWORD AppleEHCIIsochTransferDescriptor::gMetaClass;
// 18A00: using guessed type _QWORD AppleEHCISplitIsochTransferDescriptor::gMetaClass;
// 18A28: using guessed type _QWORD AppleEHCIIsochEndpoint::gMetaClass;

//----- (0000000000002970) ----------------------------------------------------
__int64 __fastcall AppleEHCIsitdMemoryBlock::MetaClass::MetaClass(AppleEHCIsitdMemoryBlock::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "AppleEHCIsitdMemoryBlock", off_16060[0], 48LL);
  result = (__int64)off_17060;
  *(_QWORD *)this = off_17060;
  return result;
}
// 16060: using guessed type _QWORD off_16060[15];
// 17060: using guessed type __int64 (__fastcall *off_17060[2])(AppleEHCIsitdMemoryBlock::MetaClass *__hidden this);
// 2DBC8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000029A2) ----------------------------------------------------
__int64 __fastcall AppleEHCIsitdMemoryBlock::MetaClass::~MetaClass(AppleEHCIsitdMemoryBlock::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (00000000000029AC) ----------------------------------------------------
__int64 __fastcall AppleEHCIsitdMemoryBlock::AppleEHCIsitdMemoryBlock(__int64 a1)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1);
  result = (__int64)off_16F30;
  *(_QWORD *)a1 = off_16F30;
  return result;
}
// 16F30: using guessed type __int64 (__fastcall *off_16F30[2])(AppleEHCIsitdMemoryBlock *__hidden this);
// 2E330: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (00000000000029CC) ----------------------------------------------------
__int64 __fastcall AppleEHCIsitdMemoryBlock::AppleEHCIsitdMemoryBlock(__int64 a1)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1);
  result = (__int64)off_16F30;
  *(_QWORD *)a1 = off_16F30;
  return result;
}
// 16F30: using guessed type __int64 (__fastcall *off_16F30[2])(AppleEHCIsitdMemoryBlock *__hidden this);
// 2E330: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (00000000000029EC) ----------------------------------------------------
__int64 __fastcall AppleEHCIsitdMemoryBlock::~AppleEHCIsitdMemoryBlock(AppleEHCIsitdMemoryBlock *this)
{
  return OSObject::~OSObject(this);
}

//----- (00000000000029F6) ----------------------------------------------------
__int64 __fastcall AppleEHCIsitdMemoryBlock::~AppleEHCIsitdMemoryBlock(AppleEHCIsitdMemoryBlock *this)
{
  return OSObject::~OSObject(this);
}

//----- (0000000000002A00) ----------------------------------------------------
void __fastcall AppleEHCIsitdMemoryBlock::~AppleEHCIsitdMemoryBlock(AppleEHCIsitdMemoryBlock *this)
{
  OSObject::~OSObject(this);
  OSObject::operator delete((void *)this);
}

//----- (0000000000002A22) ----------------------------------------------------
__int64 __fastcall AppleEHCIsitdMemoryBlock::getMetaClass(AppleEHCIsitdMemoryBlock *this)
{
  return (__int64)&AppleEHCIsitdMemoryBlock::gMetaClass;
}
// 18A50: using guessed type _QWORD AppleEHCIsitdMemoryBlock::gMetaClass;

//----- (0000000000002A30) ----------------------------------------------------
__int64 __fastcall AppleEHCIsitdMemoryBlock::MetaClass::MetaClass(AppleEHCIsitdMemoryBlock::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "AppleEHCIsitdMemoryBlock", off_16060[0], 48LL);
  result = (__int64)off_17060;
  *(_QWORD *)this = off_17060;
  return result;
}
// 16060: using guessed type _QWORD off_16060[15];
// 17060: using guessed type __int64 (__fastcall *off_17060[2])(AppleEHCIsitdMemoryBlock::MetaClass *__hidden this);
// 2DBC8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000002A62) ----------------------------------------------------
__int64 __fastcall AppleEHCIsitdMemoryBlock::MetaClass::alloc(AppleEHCIsitdMemoryBlock::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&stru_20.segname[8], a2);
  OSObject::OSObject(v2);
  *(_QWORD *)v2 = off_16F30;
  OSMetaClass::instanceConstructed((OSMetaClass *)&AppleEHCIsitdMemoryBlock::gMetaClass);
  return v2;
}
// 20: using guessed type segment_command_64 stru_20;
// 16F30: using guessed type __int64 (__fastcall *off_16F30[2])(AppleEHCIsitdMemoryBlock *__hidden this);
// 18A50: using guessed type _QWORD AppleEHCIsitdMemoryBlock::gMetaClass;
// 2E330: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000002AA2) ----------------------------------------------------
__int64 __fastcall AppleEHCIsitdMemoryBlock::AppleEHCIsitdMemoryBlock(__int64 a1)
{
  OSObject::OSObject(a1);
  *(_QWORD *)a1 = off_16F30;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&AppleEHCIsitdMemoryBlock::gMetaClass);
}
// 16F30: using guessed type __int64 (__fastcall *off_16F30[2])(AppleEHCIsitdMemoryBlock *__hidden this);
// 18A50: using guessed type _QWORD AppleEHCIsitdMemoryBlock::gMetaClass;
// 2E330: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000002AD2) ----------------------------------------------------
__int64 __fastcall AppleEHCIsitdMemoryBlock::AppleEHCIsitdMemoryBlock(__int64 a1)
{
  OSObject::OSObject(a1);
  *(_QWORD *)a1 = off_16F30;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&AppleEHCIsitdMemoryBlock::gMetaClass);
}
// 16F30: using guessed type __int64 (__fastcall *off_16F30[2])(AppleEHCIsitdMemoryBlock *__hidden this);
// 18A50: using guessed type _QWORD AppleEHCIsitdMemoryBlock::gMetaClass;
// 2E330: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000002B02) ----------------------------------------------------
__int64 __fastcall AppleEHCIsitdMemoryBlock::NewMemoryBlock(AppleEHCIsitdMemoryBlock *this, unsigned __int64 a2)
{
  __int64 v2; // r12@1
  __int64 v3; // rax@2
  unsigned __int64 v4; // r8@2
  __int64 v5; // r14@2
  __int64 v6; // rax@3
  __int64 v7; // r15@5
  signed __int64 v8; // rsi@5
  signed __int64 v9; // rsi@9
  void *v10; // rax@11
  int v12; // ebx@15
  int v13; // [sp+1Ch] [bp-34h]@1
  unsigned int v14; // [sp+20h] [bp-30h]@15
  int v15; // [sp+24h] [bp-2Ch]@17
  __int64 v16; // [sp+28h] [bp-28h]@1

  v2 = OSObject::operator new((OSObject *)&stru_20.segname[8], a2);
  OSObject::OSObject(v2);
  *(_QWORD *)v2 = off_16F30;
  OSMetaClass::instanceConstructed((OSMetaClass *)&AppleEHCIsitdMemoryBlock::gMetaClass);
  v16 = 0LL;
  v13 = 1;
  if ( v2 )
  {
    LODWORD(v3) = IODMACommand::withSpecification(off_16008[0], 32LL, 4096LL, 64LL, 0LL, 1LL);
    v5 = v3;
    if ( !v3 )
    {
      v7 = 0LL;
      KernelDebugLogInternal(
        1LL,
        1431519814LL,
        "AppleEHCIsitdMemoryBlock::NewMemoryBlock - could not create IODMACommand");
      return v7;
    }
    v6 = IOBufferMemoryDescriptor::inTaskWithPhysicalMask(
           *(IOBufferMemoryDescriptor **)off_160D0,
           (task *)((char *)&dword_0 + 3),
           0x1000u,
           0xFFFFF000uLL,
           v4);
    *(_QWORD *)(v2 + 40) = v6;
    if ( v6 )
    {
      if ( (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v6 + 496LL))(v6, 0LL) )
      {
        v7 = 0LL;
        v8 = 1431519814LL;
        KernelDebugLogInternal(1LL, 1431519814LL, "AppleEHCIsitdMemoryBlock::NewMemoryBlock - could not prepare buffer");
LABEL_13:
        (*(void (__fastcall **)(_QWORD, signed __int64))(**(_QWORD **)(v2 + 40) + 40LL))(*(_QWORD *)(v2 + 40), v8);
        *(_QWORD *)(v2 + 40) = 0LL;
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 40LL))(v2);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v5 + 40LL))(v5);
        return v7;
      }
      LODWORD(v10) = (*(int (__cdecl **)(_QWORD, _QWORD))(**(_QWORD **)(v2 + 40) + 736LL))(*(_QWORD *)(v2 + 40), 0LL);
      *(_QWORD *)(v2 + 24) = v10;
      bzero(v10, 0x1000uLL);
      if ( (*(int (__fastcall **)(__int64, _QWORD, signed __int64))(*(_QWORD *)v5 + 296LL))(
             v5,
             *(_QWORD *)(v2 + 40),
             1LL) )
      {
        v7 = 0LL;
        KernelDebugLogInternal(
          1LL,
          1431519814LL,
          "AppleEHCIsitdMemoryBlock::NewMemoryBlock - could not set memory descriptor");
        v8 = 0LL;
        (*(void (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(v2 + 40) + 504LL))(*(_QWORD *)(v2 + 40), 0LL);
        goto LABEL_13;
      }
      v12 = (*(int (__fastcall **)(__int64, __int64 *, int *, int *))(*(_QWORD *)v5 + 344LL))(v5, &v16, &v14, &v13);
      (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v5 + 304LL))(v5, 1LL);
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v5 + 40LL))(v5);
      if ( !v12 && v13 == 1 && v15 == 4096 )
      {
        *(_QWORD *)(v2 + 16) = v14;
        return v2;
      }
      v7 = 0LL;
      KernelDebugLogInternal(
        1LL,
        1431519814LL,
        "AppleEHCIsitdMemoryBlock::NewMemoryBlock - could not get physical segment");
      v9 = 0LL;
      (*(void (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(v2 + 40) + 504LL))(*(_QWORD *)(v2 + 40), 0LL);
      (*(void (__cdecl **)(_QWORD, _QWORD))(**(_QWORD **)(v2 + 40) + 40LL))(*(_QWORD *)(v2 + 40), 0LL);
      *(_QWORD *)(v2 + 40) = 0LL;
    }
    else
    {
      v7 = 0LL;
      v9 = 1431519814LL;
      KernelDebugLogInternal(1LL, 1431519814LL, "AppleEHCIsitdMemoryBlock::NewMemoryBlock, could not allocate buffer!");
    }
    (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v2 + 40LL))(v2, v9);
    return v7;
  }
  KernelDebugLogInternal(1LL, 1431519814LL, "AppleEHCIsitdMemoryBlock::NewMemoryBlock, constructor failed!");
  return v2;
}
// 0: using guessed type int dword_0;
// 20: using guessed type segment_command_64 stru_20;
// 16008: using guessed type __int64 off_16008[26];
// 160D0: using guessed type __int64 off_160D0;
// 16F30: using guessed type __int64 (__fastcall *off_16F30[2])(AppleEHCIsitdMemoryBlock *__hidden this);
// 18A50: using guessed type _QWORD AppleEHCIsitdMemoryBlock::gMetaClass;
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);
// 2DBE8: using guessed type int __fastcall IODMACommand::withSpecification(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 2E330: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000002D94) ----------------------------------------------------
__int64 __fastcall AppleEHCIsitdMemoryBlock::NumTDs(AppleEHCIsitdMemoryBlock *this)
{
  return 64LL;
}

//----- (0000000000002DA0) ----------------------------------------------------
unsigned __int64 __fastcall AppleEHCIsitdMemoryBlock::GetPhysicalPtr(AppleEHCIsitdMemoryBlock *this, unsigned int a2)
{
  unsigned __int64 result; // rax@1

  result = 0LL;
  if ( a2 <= 0x3F )
    result = *((_QWORD *)this + 2) + ((unsigned __int64)a2 << 6);
  return result;
}

//----- (0000000000002DB8) ----------------------------------------------------
unsigned __int64 __fastcall AppleEHCIsitdMemoryBlock::GetLogicalPtr(AppleEHCIsitdMemoryBlock *this, unsigned int a2)
{
  unsigned __int64 result; // rax@1

  result = 0LL;
  if ( a2 <= 0x3F )
    result = *((_QWORD *)this + 3) + ((unsigned __int64)a2 << 6);
  return result;
}

//----- (0000000000002DD0) ----------------------------------------------------
__int64 __fastcall AppleEHCIsitdMemoryBlock::GetNextBlock(AppleEHCIsitdMemoryBlock *this)
{
  return *((_QWORD *)this + 4);
}

//----- (0000000000002DDA) ----------------------------------------------------
void __fastcall AppleEHCIsitdMemoryBlock::SetNextBlock(AppleEHCIsitdMemoryBlock *this, AppleEHCIsitdMemoryBlock *a2)
{
  *((_QWORD *)this + 4) = a2;
}

//----- (0000000000002DE4) ----------------------------------------------------
int __fastcall AppleEHCIsitdMemoryBlock::free(AppleEHCIsitdMemoryBlock *this)
{
  AppleEHCIsitdMemoryBlock *v1; // rbx@1
  __int64 v2; // rdi@1

  v1 = this;
  v2 = *((_QWORD *)this + 5);
  if ( v2 )
  {
    (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v2 + 504LL))(v2, 0LL);
    (*(void (__cdecl **)(_QWORD))(**((_QWORD **)v1 + 5) + 40LL))(*((_QWORD *)v1 + 5));
  }
  return (*(int (__fastcall **)(AppleEHCIsitdMemoryBlock *))(off_16088[0] + 160))(v1);
}
// 16088: using guessed type __int64 off_16088[10];

//----- (0000000000002E22) ----------------------------------------------------
__int64 __fastcall AppleEHCIsitdMemoryBlock::MetaClass::~MetaClass(AppleEHCIsitdMemoryBlock::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000002E30) ----------------------------------------------------
__int64 `global constructor keyed to'_a_2()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(&AppleEHCIsitdMemoryBlock::gMetaClass, "AppleEHCIsitdMemoryBlock", off_16060[0], 48LL);
  result = (__int64)off_17060;
  AppleEHCIsitdMemoryBlock::gMetaClass = off_17060;
  return result;
}
// 16060: using guessed type _QWORD off_16060[15];
// 17060: using guessed type __int64 (__fastcall *off_17060[2])(AppleEHCIsitdMemoryBlock::MetaClass *__hidden this);
// 18A50: using guessed type _QWORD AppleEHCIsitdMemoryBlock::gMetaClass;
// 2DBC8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000002E70) ----------------------------------------------------
__int64 `global destructor keyed to'_a_2()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&AppleEHCIsitdMemoryBlock::gMetaClass);
}
// 18A50: using guessed type _QWORD AppleEHCIsitdMemoryBlock::gMetaClass;

//----- (0000000000002E90) ----------------------------------------------------
__int64 __fastcall AppleEHCItdMemoryBlock::MetaClass::MetaClass(AppleEHCItdMemoryBlock::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "AppleEHCItdMemoryBlock", off_16060[0], 4640LL);
  result = (__int64)off_17290;
  *(_QWORD *)this = off_17290;
  return result;
}
// 16060: using guessed type _QWORD off_16060[15];
// 17290: using guessed type __int64 (__fastcall *off_17290[2])(AppleEHCItdMemoryBlock::MetaClass *__hidden this);
// 2DBC8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000002EC2) ----------------------------------------------------
__int64 __fastcall AppleEHCItdMemoryBlock::MetaClass::~MetaClass(AppleEHCItdMemoryBlock::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000002ECC) ----------------------------------------------------
__int64 __fastcall AppleEHCItdMemoryBlock::AppleEHCItdMemoryBlock(__int64 a1)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1);
  result = (__int64)off_17160;
  *(_QWORD *)a1 = off_17160;
  return result;
}
// 17160: using guessed type __int64 (__fastcall *off_17160[2])(AppleEHCItdMemoryBlock *__hidden this);
// 2E330: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000002EEC) ----------------------------------------------------
__int64 __fastcall AppleEHCItdMemoryBlock::AppleEHCItdMemoryBlock(__int64 a1)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1);
  result = (__int64)off_17160;
  *(_QWORD *)a1 = off_17160;
  return result;
}
// 17160: using guessed type __int64 (__fastcall *off_17160[2])(AppleEHCItdMemoryBlock *__hidden this);
// 2E330: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000002F0C) ----------------------------------------------------
__int64 __fastcall AppleEHCItdMemoryBlock::~AppleEHCItdMemoryBlock(AppleEHCItdMemoryBlock *this)
{
  return OSObject::~OSObject(this);
}

//----- (0000000000002F16) ----------------------------------------------------
__int64 __fastcall AppleEHCItdMemoryBlock::~AppleEHCItdMemoryBlock(AppleEHCItdMemoryBlock *this)
{
  return OSObject::~OSObject(this);
}

//----- (0000000000002F20) ----------------------------------------------------
void __fastcall AppleEHCItdMemoryBlock::~AppleEHCItdMemoryBlock(AppleEHCItdMemoryBlock *this)
{
  OSObject::~OSObject(this);
  OSObject::operator delete((void *)this);
}

//----- (0000000000002F42) ----------------------------------------------------
__int64 __fastcall AppleEHCItdMemoryBlock::getMetaClass(AppleEHCItdMemoryBlock *this)
{
  return (__int64)&AppleEHCItdMemoryBlock::gMetaClass;
}
// 18A78: using guessed type _QWORD AppleEHCItdMemoryBlock::gMetaClass;

//----- (0000000000002F50) ----------------------------------------------------
__int64 __fastcall AppleEHCItdMemoryBlock::MetaClass::MetaClass(AppleEHCItdMemoryBlock::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "AppleEHCItdMemoryBlock", off_16060[0], 4640LL);
  result = (__int64)off_17290;
  *(_QWORD *)this = off_17290;
  return result;
}
// 16060: using guessed type _QWORD off_16060[15];
// 17290: using guessed type __int64 (__fastcall *off_17290[2])(AppleEHCItdMemoryBlock::MetaClass *__hidden this);
// 2DBC8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000002F82) ----------------------------------------------------
__int64 __fastcall AppleEHCItdMemoryBlock::MetaClass::alloc(AppleEHCItdMemoryBlock::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)((char *)&loc_121B + 5), a2);
  OSObject::OSObject(v2);
  *(_QWORD *)v2 = off_17160;
  OSMetaClass::instanceConstructed((OSMetaClass *)&AppleEHCItdMemoryBlock::gMetaClass);
  return v2;
}
// 17160: using guessed type __int64 (__fastcall *off_17160[2])(AppleEHCItdMemoryBlock *__hidden this);
// 18A78: using guessed type _QWORD AppleEHCItdMemoryBlock::gMetaClass;
// 2E330: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000002FC2) ----------------------------------------------------
__int64 __fastcall AppleEHCItdMemoryBlock::AppleEHCItdMemoryBlock(__int64 a1)
{
  OSObject::OSObject(a1);
  *(_QWORD *)a1 = off_17160;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&AppleEHCItdMemoryBlock::gMetaClass);
}
// 17160: using guessed type __int64 (__fastcall *off_17160[2])(AppleEHCItdMemoryBlock *__hidden this);
// 18A78: using guessed type _QWORD AppleEHCItdMemoryBlock::gMetaClass;
// 2E330: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000002FF2) ----------------------------------------------------
__int64 __fastcall AppleEHCItdMemoryBlock::AppleEHCItdMemoryBlock(__int64 a1)
{
  OSObject::OSObject(a1);
  *(_QWORD *)a1 = off_17160;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&AppleEHCItdMemoryBlock::gMetaClass);
}
// 17160: using guessed type __int64 (__fastcall *off_17160[2])(AppleEHCItdMemoryBlock *__hidden this);
// 18A78: using guessed type _QWORD AppleEHCItdMemoryBlock::gMetaClass;
// 2E330: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000003022) ----------------------------------------------------
__int64 __fastcall AppleEHCItdMemoryBlock::NewMemoryBlock(AppleEHCItdMemoryBlock *this, unsigned __int64 a2)
{
  __int64 v2; // r12@1
  __int64 v3; // rax@2
  unsigned __int64 v4; // r8@2
  __int64 v5; // r14@2
  __int64 v6; // rax@3
  signed __int64 v7; // rsi@5
  __int64 v8; // rdx@6
  __int64 v9; // rax@10
  __int64 v10; // rdi@10
  void *v11; // rax@11
  void *v12; // r15@11
  int v14; // ebx@16
  signed __int64 v15; // rax@19
  int v16; // ecx@19
  __int64 v17; // rdx@19
  int v18; // [sp+1Ch] [bp-34h]@1
  int v19; // [sp+20h] [bp-30h]@16
  int v20; // [sp+24h] [bp-2Ch]@18
  __int64 v21; // [sp+28h] [bp-28h]@1

  v2 = OSObject::operator new((OSObject *)((char *)&loc_121B + 5), a2);
  OSObject::OSObject(v2);
  *(_QWORD *)v2 = off_17160;
  OSMetaClass::instanceConstructed((OSMetaClass *)&AppleEHCItdMemoryBlock::gMetaClass);
  v21 = 0LL;
  v18 = 1;
  if ( !v2 )
  {
    v8 = (__int64)"AppleEHCItdMemoryBlock::NewMemoryBlock, constructor failed!";
LABEL_8:
    KernelDebugLogInternal(1LL, 1431519814LL, v8);
    return v2;
  }
  LODWORD(v3) = IODMACommand::withSpecification(off_16008[0], 32LL, 4096LL, 64LL, 0LL, 1LL);
  v5 = v3;
  if ( !v3 )
  {
    v8 = (__int64)"AppleEHCItdMemoryBlock::NewMemoryBlock - could not create IODMACommand";
    v2 = 0LL;
    goto LABEL_8;
  }
  v6 = IOBufferMemoryDescriptor::inTaskWithPhysicalMask(
         *(IOBufferMemoryDescriptor **)off_160D0,
         (task *)((char *)&dword_0 + 3),
         0x1000u,
         0xFFFFF000uLL,
         v4);
  *(_QWORD *)(v2 + 4632) = v6;
  if ( !v6 )
  {
    v7 = 1431519814LL;
    KernelDebugLogInternal(1LL, 1431519814LL, "AppleEHCItdMemoryBlock::NewMemoryBlock, could not allocate buffer!");
LABEL_10:
    v9 = *(_QWORD *)v2;
    v10 = v2;
LABEL_14:
    (*(void (__fastcall **)(__int64, signed __int64))(v9 + 40))(v10, v7);
    return 0LL;
  }
  if ( (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v6 + 496LL))(v6, 0LL) )
  {
    v7 = 1431519814LL;
    KernelDebugLogInternal(1LL, 1431519814LL, "AppleEHCItdMemoryBlock::NewMemoryBlock - could not prepare buffer");
LABEL_13:
    (*(void (__fastcall **)(_QWORD, signed __int64))(**(_QWORD **)(v2 + 4632) + 40LL))(*(_QWORD *)(v2 + 4632), v7);
    *(_QWORD *)(v2 + 4632) = 0LL;
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 40LL))(v2);
    v9 = *(_QWORD *)v5;
    v10 = v5;
    goto LABEL_14;
  }
  LODWORD(v11) = (*(int (__cdecl **)(_QWORD, _QWORD))(**(_QWORD **)(v2 + 4632) + 736LL))(*(_QWORD *)(v2 + 4632), 0LL);
  v12 = v11;
  bzero(v11, 0x1000uLL);
  if ( (*(int (__fastcall **)(__int64, _QWORD, signed __int64))(*(_QWORD *)v5 + 296LL))(v5, *(_QWORD *)(v2 + 4632), 1LL) )
  {
    KernelDebugLogInternal(
      1LL,
      1431519814LL,
      "AppleEHCItdMemoryBlock::NewMemoryBlock - could not set memory descriptor");
    v7 = 0LL;
    (*(void (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(v2 + 4632) + 504LL))(*(_QWORD *)(v2 + 4632), 0LL);
    goto LABEL_13;
  }
  v14 = (*(int (__fastcall **)(__int64, __int64 *, int *, int *))(*(_QWORD *)v5 + 344LL))(v5, &v21, &v19, &v18);
  (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v5 + 304LL))(v5, 1LL);
  (*(void (__fastcall **)(__int64))(*(_QWORD *)v5 + 40LL))(v5);
  if ( v14 || v18 != 1 || v20 != 4096 )
  {
    KernelDebugLogInternal(1LL, 1431519814LL, "AppleEHCItdMemoryBlock::NewMemoryBlock - could not get physical segment");
    v7 = 0LL;
    (*(void (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(v2 + 4632) + 504LL))(*(_QWORD *)(v2 + 4632), 0LL);
    (*(void (__cdecl **)(_QWORD, _QWORD))(**(_QWORD **)(v2 + 4632) + 40LL))(*(_QWORD *)(v2 + 4632), 0LL);
    *(_QWORD *)(v2 + 4632) = 0LL;
    goto LABEL_10;
  }
  v15 = v2 + 16;
  v16 = v19;
  v17 = 0LL;
  do
  {
    *(_DWORD *)(v15 + 28) = v16 + v17;
    *(_QWORD *)v15 = (char *)v12 + v17;
    v15 += 72LL;
    v17 += 64LL;
  }
  while ( v17 != 4096 );
  return v2;
}
// 0: using guessed type int dword_0;
// 16008: using guessed type __int64 off_16008[26];
// 160D0: using guessed type __int64 off_160D0;
// 17160: using guessed type __int64 (__fastcall *off_17160[2])(AppleEHCItdMemoryBlock *__hidden this);
// 18A78: using guessed type _QWORD AppleEHCItdMemoryBlock::gMetaClass;
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);
// 2DBE8: using guessed type int __fastcall IODMACommand::withSpecification(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 2E330: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (00000000000032C6) ----------------------------------------------------
__int64 __fastcall AppleEHCItdMemoryBlock::NumTDs(AppleEHCItdMemoryBlock *this)
{
  return 64LL;
}

//----- (00000000000032D2) ----------------------------------------------------
AppleEHCItdMemoryBlock *__fastcall AppleEHCItdMemoryBlock::GetTD(AppleEHCItdMemoryBlock *this, unsigned int a2)
{
  AppleEHCItdMemoryBlock *result; // rax@1

  result = 0LL;
  if ( a2 <= 0x3F )
    result = (AppleEHCItdMemoryBlock *)((char *)this + 72 * a2 + 16);
  return result;
}

//----- (00000000000032EA) ----------------------------------------------------
__int64 __fastcall AppleEHCItdMemoryBlock::GetNextBlock(AppleEHCItdMemoryBlock *this)
{
  return *((_QWORD *)this + 578);
}

//----- (00000000000032F8) ----------------------------------------------------
void __fastcall AppleEHCItdMemoryBlock::SetNextBlock(AppleEHCItdMemoryBlock *this, AppleEHCItdMemoryBlock *a2)
{
  *((_QWORD *)this + 578) = a2;
}

//----- (0000000000003306) ----------------------------------------------------
int __fastcall AppleEHCItdMemoryBlock::free(AppleEHCItdMemoryBlock *this)
{
  AppleEHCItdMemoryBlock *v1; // rbx@1
  __int64 v2; // rdi@1

  v1 = this;
  v2 = *((_QWORD *)this + 579);
  if ( v2 )
  {
    (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v2 + 504LL))(v2, 0LL);
    (*(void (__cdecl **)(_QWORD))(**((_QWORD **)v1 + 579) + 40LL))(*((_QWORD *)v1 + 579));
  }
  return (*(int (__fastcall **)(AppleEHCItdMemoryBlock *))(off_16088[0] + 160))(v1);
}
// 16088: using guessed type __int64 off_16088[10];

//----- (000000000000334A) ----------------------------------------------------
__int64 __fastcall AppleEHCItdMemoryBlock::MetaClass::~MetaClass(AppleEHCItdMemoryBlock::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000003360) ----------------------------------------------------
__int64 `global constructor keyed to'_a_3()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(&AppleEHCItdMemoryBlock::gMetaClass, "AppleEHCItdMemoryBlock", off_16060[0], 4640LL);
  result = (__int64)off_17290;
  AppleEHCItdMemoryBlock::gMetaClass = off_17290;
  return result;
}
// 16060: using guessed type _QWORD off_16060[15];
// 17290: using guessed type __int64 (__fastcall *off_17290[2])(AppleEHCItdMemoryBlock::MetaClass *__hidden this);
// 18A78: using guessed type _QWORD AppleEHCItdMemoryBlock::gMetaClass;
// 2DBC8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000033A0) ----------------------------------------------------
__int64 `global destructor keyed to'_a_3()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&AppleEHCItdMemoryBlock::gMetaClass);
}
// 18A78: using guessed type _QWORD AppleEHCItdMemoryBlock::gMetaClass;

//----- (00000000000033B2) ----------------------------------------------------
int __fastcall AppleUSBEHCI::SwitchMuxes(AppleUSBEHCI *this, unsigned __int8 a2, unsigned int a3)
{
  unsigned int v3; // er14@1
  AppleUSBEHCI *v4; // r15@1
  __int64 v5; // rdi@1
  __int64 v6; // rbx@3
  int result; // eax@5

  v3 = a3;
  v4 = this;
  v5 = *((_QWORD *)this + 5002);
  if ( v5 && a2 )
  {
    v6 = 0LL;
    while ( 1 )
    {
      result = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, __int64))(*(_QWORD *)v5 + 1840LL))(
                 v5,
                 v3,
                 *((_QWORD *)v4 + 61),
                 v6++);
      if ( (signed int)v6 >= a2 )
        break;
      v5 = *((_QWORD *)v4 + 5002);
    }
  }
  return result;
}

//----- (000000000000340A) ----------------------------------------------------
__int64 __usercall AppleUSBEHCI::EnterTestMode@<rax>(AppleUSBEHCI *this@<rdi>, __int64 a2@<rax>)
{
  __int64 v2; // rcx@5
  int v3; // er8@5
  signed int v4; // ecx@5
  __int64 v5; // rdx@6
  __int64 v6; // rsi@6
  int v7; // ecx@11
  __int64 v9; // [sp-6h] [bp-10h]@1

  v9 = a2;
  AppleUSBEHCI::GetNumberOfPorts(this, (unsigned __int8 *)&v9 + 7);
  if ( *(_BYTE *)(*((_QWORD *)this + 84) + 209LL) & 0x10 )
    AppleUSBEHCI::DisablePrefetchRegister(*((IOPCIDevice **)this + 61), *((_QWORD *)this + 88));
  if ( *((_QWORD *)this + 5002) )
    AppleUSBEHCI::SwitchMuxes(this, BYTE7(v9), 0xE00040E2);
  v2 = *((_QWORD *)this + 88);
  v3 = *(_DWORD *)v2;
  *(_DWORD *)v2 &= 0xFFFFFFCF;
  v4 = BYTE7(v9);
  if ( BYTE7(v9) )
  {
    v5 = *((_QWORD *)this + 88);
    v6 = 0LL;
    do
    {
      if ( (*(_DWORD *)(v5 + 4 * v6 + 68) & 0x2004) == 4 )
        *(_DWORD *)(v5 + 4 * v6 + 68) |= 0x80u;
      ++v6;
    }
    while ( (signed int)v6 < v4 );
  }
  **((_DWORD **)this + 88) = v3 & 0xFFFFFFCE;
  *((_BYTE *)this + 440) = 0;
  do
    v7 = *(_DWORD *)(*((_QWORD *)this + 88) + 4LL);
  while ( !(BYTE1(v7) & 0x10) );
  *((_BYTE *)this + 1693) = 1;
  return 0LL;
}

//----- (00000000000034D2) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::PlacePortInMode(AppleUSBEHCI *this, unsigned int a2, int a3)
{
  __int64 result; // rax@1
  __int64 v4; // rcx@3
  __int64 v5; // rsi@3
  int v6; // ebx@3

  result = 3758097097LL;
  if ( *((_BYTE *)this + 1693) && (*(_DWORD *)(*((_QWORD *)this + 87) + 4LL) & 0xFu) > a2 )
  {
    v4 = a2;
    v5 = *((_QWORD *)this + 88);
    v6 = *(_DWORD *)(v5 + 4 * v4 + 68);
    if ( !(BYTE1(v6) & 0x20) )
    {
      *(_DWORD *)(v5 + 4 * v4 + 68) = v6 & 0xFFF0FFFF | (a3 << 16);
      result = 0LL;
    }
  }
  return result;
}

//----- (000000000000351C) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::LeaveTestMode(AppleUSBEHCI *this)
{
  __int64 v1; // rax@1
  int v2; // er14@1
  int v3; // ecx@1
  __int64 result; // rax@1

  v1 = *((_QWORD *)this + 88);
  v2 = *(_DWORD *)v1;
  v3 = *(_DWORD *)(v1 + 4);
  result = 3758097097LL;
  if ( BYTE1(v3) & 0x10 )
  {
    if ( *((_QWORD *)this + 5002) )
      AppleUSBEHCI::SwitchMuxes(this, *((_BYTE *)this + 505), 0xE00040E1);
    **((_DWORD **)this + 88) = v2 | 2;
    *((_BYTE *)this + 1693) = 0;
    result = 0LL;
  }
  return result;
}

//----- (0000000000003578) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::UIMSetTestMode(AppleUSBEHCI *this, int a2, char a3)
{
  signed int v3; // ebx@1

  v3 = -536870199;
  if ( a2 > 253 )
  {
    if ( a2 == 255 )
    {
      if ( *((_QWORD *)this + 5002) )
        AppleUSBEHCI::SwitchMuxes(this, a3, 0xE00040E1);
    }
    else if ( a2 == 254 && *((_QWORD *)this + 5002) )
    {
      AppleUSBEHCI::SwitchMuxes(this, a3, 0xE00040E2);
    }
  }
  else if ( (unsigned int)a2 >= 6 )
  {
    if ( a2 == 10 )
    {
      AppleUSBEHCI::EnterTestMode(this, 10LL);
      v3 = 0;
    }
    else if ( a2 == 11 )
    {
      return AppleUSBEHCI::LeaveTestMode(this);
    }
  }
  else if ( *((_BYTE *)this + 1693) )
  {
    return AppleUSBEHCI::PlacePortInMode(this, a3, a2);
  }
  return (unsigned int)v3;
}

//----- (0000000000003610) ----------------------------------------------------
void __fastcall AppleUSBEHCI::PollInterrupts(AppleUSBEHCI *this, void (__cdecl *a2)(void *, void *, int, unsigned int))
{
  void (__cdecl *v2)(void *, void *, int, unsigned int); // r14@1
  __int64 v3; // r15@1
  int v4; // eax@5

  v2 = a2;
  v3 = off_160C0[0];
  if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
  {
    a2 = (void (__cdecl *)(void *, void *, int, unsigned int))this;
    kernel_debug(
      0x52D5C05u,
      (uintptr_t)this,
      *((_DWORD *)this + 420),
      *((_DWORD *)this + 421),
      *((_DWORD *)this + 419),
      0LL);
  }
  if ( *((_BYTE *)this + 1668) & 0x10 )
  {
    *((_DWORD *)this + 417) = 0;
    v4 = *((_DWORD *)this + 429) + 1;
    *((_DWORD *)this + 429) = v4;
    if ( v4 == (unsigned int)(1LL << *((_BYTE *)this + 1728)) )
    {
      a2 = (void (__cdecl *)(void *, void *, int, unsigned int))(&dword_0 + 1);
      AppleUSBEHCI::showRegisters(this, 1LL, "Host System Error");
      if ( *(_BYTE *)v3 & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      {
        a2 = (void (__cdecl *)(void *, void *, int, unsigned int))this;
        kernel_debug(0x52D5C04u, (uintptr_t)this, *((_DWORD *)this + 432), 0LL, 1uLL, 0LL);
      }
      ++*((_DWORD *)this + 432);
    }
  }
  if ( *((_BYTE *)this + 1680) & 2 )
  {
    *((_DWORD *)this + 420) = 0;
    if ( *(_BYTE *)v3 & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D5C04u, (uintptr_t)this, 0LL, 0LL, 4uLL, 0LL);
    a2 = v2;
    AppleUSBEHCI::scavengeCompletedTransactions(this, v2);
  }
  if ( *((_BYTE *)this + 1684) & 1 )
  {
    *((_DWORD *)this + 421) = 0;
    if ( *(_BYTE *)v3 & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D5C04u, (uintptr_t)this, 0LL, 0LL, 3uLL, 0LL);
    a2 = v2;
    AppleUSBEHCI::scavengeCompletedTransactions(this, v2);
  }
  if ( *((_BYTE *)this + 1676) & 4 )
  {
    *((_DWORD *)this + 419) = 0;
    if ( *(_BYTE *)v3 & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    {
      a2 = (void (__cdecl *)(void *, void *, int, unsigned int))this;
      kernel_debug(0x52D5C04u, (uintptr_t)this, 0LL, 0LL, 5uLL, 0LL);
    }
    (*(void (__fastcall **)(AppleUSBEHCI *, void (__cdecl *)(void *, void *, int, unsigned int)))(*(_QWORD *)this
                                                                                                + 2976LL))(
      this,
      a2);
    if ( *((_QWORD *)this + 57) == 4LL )
      AppleUSBEHCI::RHCheckForPortResumes(this);
  }
  if ( *((_BYTE *)this + 1664) & 0x20 )
  {
    *((_DWORD *)this + 416) = 0;
    if ( *(_BYTE *)v3 & 2 )
    {
      if ( *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D5C04u, (uintptr_t)this, 0LL, 0LL, 6uLL, 0LL);
    }
  }
  if ( *((_BYTE *)this + 1672) & 8 )
  {
    *((_DWORD *)this + 418) = 0;
    *((_QWORD *)this + 264) = *((_QWORD *)this + 263);
    *((_QWORD *)this + 266) = *((_QWORD *)this + 265);
    if ( *(_BYTE *)v3 & 2 )
    {
      if ( *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D5C04u, (uintptr_t)this, 0LL, 0LL, 7uLL, 0LL);
    }
  }
  if ( *(_BYTE *)v3 & 2 )
  {
    if ( *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D5C06u, (uintptr_t)this, 0LL, 0LL, 0LL, 0LL);
  }
}
// 0: using guessed type int dword_0;
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];

//----- (00000000000038BA) ----------------------------------------------------
int __fastcall AppleUSBEHCI::InterruptHandler(IOService *this)
{
  int result; // eax@2

  if ( this )
  {
    result = IOService::isInactive(this);
    if ( !(_BYTE)result )
    {
      if ( *((_BYTE *)this + 444) )
      {
        if ( !AppleUSBEHCI::InterruptHandler(OSObject *,IOInterruptEventSource *,int)::emitted )
          AppleUSBEHCI::InterruptHandler(OSObject *,IOInterruptEventSource *,int)::emitted = 1;
        result = (*(int (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)this + 2472LL))(this, 0LL);
      }
    }
  }
  return result;
}
// 18B50: using guessed type char AppleUSBEHCI::InterruptHandler(OSObject *,IOInterruptEventSource *,int)::emitted;

//----- (000000000000390C) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::PrimaryInterruptFilter(AppleUSBEHCI *this)
{
  if ( this && !(unsigned __int8)IOService::isInactive(this) && *((_BYTE *)this + 444) )
  {
    *((_BYTE *)this + 1640) = 1;
    AppleUSBEHCI::FilterInterrupt(this);
    *((_BYTE *)this + 1640) = 0;
  }
  return 0LL;
}

//----- (000000000000394E) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::FilterInterrupt(AppleUSBEHCI *this)
{
  uintptr_t v1; // r14@1
  __int64 v2; // rax@1
  uintptr_t v3; // rdx@1
  int v4; // ebx@2
  unsigned int v5; // ebx@3
  signed int v6; // er15@7
  unsigned int v7; // eax@8
  __int64 v8; // rax@11
  char v9; // al@13
  uint64_t v10; // rax@22
  __int64 v11; // rdx@24
  int v12; // ecx@25
  unsigned int v13; // esi@26
  __int64 v14; // rdx@29
  __int64 v15; // r13@29
  AppleEHCIIsochTransferDescriptor *v16; // rax@29
  char v17; // bl@29
  __int64 v18; // r14@57
  __int64 v19; // r15@30
  char v20; // r13@30
  __int64 v21; // rbx@32
  __int64 v22; // r14@33
  OSMetaClassBase *v23; // rax@33
  const OSMetaClass *v24; // rdx@33
  OSMetaClassBase *v25; // r12@33
  __int64 v26; // rax@34
  const OSMetaClass *v27; // rdx@34
  AppleEHCISplitIsochTransferDescriptor *v28; // rbx@34
  int v29; // eax@36
  AppleEHCIIsochTransferDescriptor *v30; // rsi@38
  __int64 v31; // r14@43
  __int64 v32; // rax@43
  bool v33; // zf@43
  __int64 v34; // r14@46
  __int64 v35; // rax@46
  __int64 v36; // rcx@46
  __int64 v37; // rbx@52
  void (__fastcall *v38)(_QWORD, _QWORD); // r14@52
  __int64 v39; // rax@52
  __int64 v40; // rdi@56
  __int64 v41; // rcx@65
  uint64_t v43; // [sp+8h] [bp-98h]@28
  int v44; // [sp+14h] [bp-8Ch]@27
  OSMetaClassBase *v45; // [sp+20h] [bp-80h]@27
  int v46; // [sp+28h] [bp-78h]@27
  int v47; // [sp+2Ch] [bp-74h]@29
  uintptr_t v48; // [sp+30h] [bp-70h]@29
  AppleEHCIIsochTransferDescriptor *v49; // [sp+38h] [bp-68h]@31
  int v50; // [sp+44h] [bp-5Ch]@28
  char v51; // [sp+50h] [bp-50h]@34
  __int64 v52; // [sp+58h] [bp-48h]@34
  const OSMetaClassBase *v53; // [sp+60h] [bp-40h]@28
  int v54; // [sp+68h] [bp-38h]@28
  int v55; // [sp+74h] [bp-2Ch]@29

  v1 = (uintptr_t)this;
  v2 = *((_QWORD *)this + 88);
  v3 = *(_DWORD *)(v2 + 8);
  if ( v3 == 0xFFFFFFFF )
    goto LABEL_68;
  v4 = *(_DWORD *)(v2 + 4);
  if ( v4 == -1 )
    goto LABEL_68;
  v5 = v3 & v4;
  if ( !v5 )
    return 0LL;
  if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
  {
    this = (AppleUSBEHCI *)86858760;
    kernel_debug(0x52D5C08u, v1, v3, v5, 0LL, 0LL);
  }
  v6 = 0;
  if ( v5 & 8 )
  {
    v7 = *(_DWORD *)(*(_QWORD *)(v1 + 704) + 12LL);
    if ( v7 == -1 )
      goto LABEL_68;
    if ( v7 <= 0x1FFF )
      *(_QWORD *)(v1 + 1704) += 2048LL;
    *(_QWORD *)(v1 + 2120) = *(_QWORD *)(v1 + 1704) + (v7 >> 3);
    LODWORD(v8) = ml_cpu_int_event_time(this);
    *(_QWORD *)(v1 + 2104) = v8;
    *(_DWORD *)(v1 + 1672) = 8;
    v6 = 8;
  }
  if ( v5 & 0x20 )
  {
    *(_DWORD *)(v1 + 1664) = 32;
    v6 |= 0x20u;
    v9 = 1;
  }
  else
  {
    v9 = 0;
  }
  if ( v5 & 0x10 )
  {
    *(_DWORD *)(v1 + 1668) = 16;
    v6 |= 0x10u;
    v9 = 1;
  }
  if ( v5 & 4 )
  {
    *(_DWORD *)(v1 + 1676) = 4;
    v6 |= 4u;
    v9 = 1;
  }
  if ( v5 & 2 )
  {
    *(_DWORD *)(v1 + 1680) = 2;
    v6 |= 2u;
    v9 = 1;
  }
  if ( !(v5 & 1) )
    goto LABEL_64;
  v10 = mach_absolute_time();
  v6 |= 1u;
  if ( !*(_BYTE *)(v1 + 1696) )
  {
    *(_DWORD *)(*(_QWORD *)(v1 + 704) + 4LL) = v6;
    _mm_mfence();
    v6 = 0;
    if ( !*(_BYTE *)(v1 + 1696) )
    {
      v11 = *(_QWORD *)(v1 + 704);
      if ( *(_DWORD *)v11 & 0x10 )
      {
        v12 = *(_WORD *)(v1 + 1812);
        if ( (unsigned int)v12 <= 0x3FF )
        {
          v13 = *(_DWORD *)(v11 + 12);
          if ( v13 != -1 )
          {
            v46 = ((unsigned __int16)(v13 >> 3) + 1) & 0x3FF;
            v45 = *(OSMetaClassBase **)(v1 + 1624);
            v44 = *(_DWORD *)(v1 + 1632);
            if ( v12 != v46 )
            {
              v43 = v10;
              v54 = (v13 >> 3) & 0x3FF;
              v50 = v13 & 6;
              v53 = *(const OSMetaClassBase **)off_16048[0];
              do
              {
                v47 = v12;
                v55 = ((_WORD)v12 + 1) & 0x3FF;
                v48 = v1;
                v14 = AppleUSBEHCI::GetPeriodicListLogicalEntry((AppleUSBEHCI *)v1, v12);
                v15 = 0LL;
                v16 = 0LL;
                v17 = 0;
LABEL_30:
                v19 = v15;
                v20 = v17;
LABEL_31:
                v49 = v16;
                while ( 1 )
                {
                  v21 = v19;
                  v19 = v14;
                  if ( !v14 )
                    break;
                  v22 = *(_QWORD *)(v14 + 32);
                  v23 = (OSMetaClassBase *)OSMetaClassBase::safeMetaCast(
                                             (OSMetaClassBase *)v14,
                                             v53,
                                             (const OSMetaClass *)v14);
                  v25 = v23;
                  if ( !v23 )
                    break;
                  v51 = v20;
                  v52 = v21;
                  v26 = OSMetaClassBase::safeMetaCast(
                          v23,
                          (const OSMetaClassBase *)AppleEHCISplitIsochTransferDescriptor::metaClass,
                          v24);
                  v28 = (AppleEHCISplitIsochTransferDescriptor *)v26;
                  if ( !v26 )
                  {
                    v30 = (AppleEHCIIsochTransferDescriptor *)OSMetaClassBase::safeMetaCast(
                                                                v25,
                                                                (const OSMetaClassBase *)AppleEHCIIsochTransferDescriptor::metaClass,
                                                                v27);
                    v20 = 0;
                    v29 = v54;
                    v14 = v22;
                    goto LABEL_41;
                  }
                  v20 = 1;
                  v14 = v22;
                  if ( !*(_BYTE *)(*(_QWORD *)(v26 + 40) + 164LL) )
                    goto LABEL_38;
                  v29 = v54;
                  if ( v55 != v54 )
                  {
                    v30 = v49;
LABEL_41:
                    if ( v47 != v29 )
                      goto LABEL_51;
                    if ( v20 )
                    {
                      v31 = v14;
                      v32 = AppleEHCISplitIsochTransferDescriptor::GetSharedLogical(v28);
                      v14 = v31;
                      v20 = 1;
                      v33 = (*(_DWORD *)(v32 + 12) & 0x80) == 0;
                      v16 = v30;
                      if ( !v33 )
                        goto LABEL_31;
                      goto LABEL_51;
                    }
                    v20 = 1;
                    v16 = 0LL;
                    if ( v30 )
                    {
                      v34 = v14;
                      v35 = AppleEHCIIsochTransferDescriptor::GetSharedLogical(v30);
                      v14 = v34;
                      v36 = 0LL;
                      while ( *(_DWORD *)(v35 + 4 * v36 + 4) >= 0 )
                      {
                        ++v36;
                        if ( (signed int)v36 >= 8 )
                          goto LABEL_51;
                      }
                      v16 = v30;
                      if ( (signed int)v36 > 7 )
                      {
LABEL_51:
                        v15 = v52;
                        if ( v52 )
                        {
                          *(_QWORD *)(v52 + 32) = v14;
                          v37 = v14;
                          v38 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v52 + 280LL);
                          LODWORD(v39) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v19 + 288LL))(v19);
                          v38(v52, v39);
                        }
                        else
                        {
                          v37 = v14;
                          AppleUSBEHCI::SetPeriodicListEntry(
                            (AppleUSBEHCI *)v48,
                            v47,
                            (IOUSBControllerListElement *)v14);
                        }
                        if ( *((_BYTE *)v25 + 80) )
                          (*(void (__fastcall **)(OSMetaClassBase *, uint64_t))(*(_QWORD *)v25 + 312LL))(v25, v43);
                        *((_QWORD *)v25 + 13) = v45;
                        ++v44;
                        v40 = *((_QWORD *)v25 + 5);
                        v45 = v25;
                        v14 = v37;
                        v17 = v51;
                        v16 = v30;
                        if ( v40 )
                        {
                          ++*(_DWORD *)(v40 + 104);
                          v18 = v14;
                          OSDecrementAtomic(v40 + 96);
                          v16 = v30;
                          v14 = v18;
                          v45 = v25;
                        }
                        goto LABEL_30;
                      }
                    }
                    goto LABEL_31;
                  }
                  if ( (unsigned int)v50 >= 2 )
                  {
LABEL_38:
                    v30 = v49;
                    v29 = v54;
                    goto LABEL_41;
                  }
                }
                v1 = v48;
                v12 = v55;
                if ( !v20 && v55 != v54 )
                  *(_WORD *)(v48 + 1812) = v55;
              }
              while ( v55 != v46 );
            }
            IOSimpleLockLock(*(_QWORD *)(v1 + 1648));
            *(_QWORD *)(v1 + 1624) = v45;
            *(_DWORD *)(v1 + 1632) = v44;
            IOSimpleLockUnlock(*(_QWORD *)(v1 + 1648));
            v6 = 0;
            goto LABEL_63;
          }
LABEL_68:
          *(_BYTE *)(v1 + 444) = 0;
          return 0LL;
        }
      }
    }
  }
LABEL_63:
  *(_DWORD *)(v1 + 1684) = 1;
  v9 = 1;
LABEL_64:
  if ( v6 )
  {
    *(_DWORD *)(*(_QWORD *)(v1 + 704) + 4LL) = v6;
    _mm_mfence();
    v41 = *(_DWORD *)(*(_QWORD *)(v1 + 704) + 4LL);
  }
  if ( v9 )
    (*(void (**)(void))(**(_QWORD **)(v1 + 1608) + 568LL))();
  return 0LL;
}
// 16048: using guessed type _QWORD off_16048[18];
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];
// 16818: using guessed type _QWORD AppleEHCIIsochTransferDescriptor::metaClass;
// 16A78: using guessed type _QWORD AppleEHCISplitIsochTransferDescriptor::metaClass;
// 2DB18: using guessed type int __fastcall IOSimpleLockLock(_QWORD);
// 2DB28: using guessed type int __fastcall IOSimpleLockUnlock(_QWORD);
// 2DB40: using guessed type int __fastcall OSDecrementAtomic(_QWORD);
// 2DEC8: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);
// 2E9D0: using guessed type int __fastcall ml_cpu_int_event_time(_QWORD);

//----- (0000000000003E00) ----------------------------------------------------
int __fastcall AppleUSBEHCI_IOLockClass::AppleUSBEHCI_IOLockClass(__int64 a1)
{
  __int64 v1; // rax@1

  *(_QWORD *)a1 = off_17380;
  LODWORD(v1) = IOLockAlloc(a1);
  *(_QWORD *)(a1 + 8) = v1;
  return v1;
}
// 17380: using guessed type __int64 (__fastcall *off_17380[2])(AppleUSBEHCI_IOLockClass *__hidden this);
// 2DAD0: using guessed type int __cdecl IOLockAlloc(_QWORD);

//----- (0000000000003E24) ----------------------------------------------------
int __fastcall AppleUSBEHCI_IOLockClass::~AppleUSBEHCI_IOLockClass(AppleUSBEHCI_IOLockClass *this)
{
  *(_QWORD *)this = off_17380;
  return IOLockFree(*((_QWORD *)this + 1));
}
// 17380: using guessed type __int64 (__fastcall *off_17380[2])(AppleUSBEHCI_IOLockClass *__hidden this);
// 2DAD8: using guessed type int __fastcall IOLockFree(_QWORD);

//----- (0000000000003E3C) ----------------------------------------------------
int __fastcall AppleUSBEHCI_IOLockClass::AppleUSBEHCI_IOLockClass(__int64 a1)
{
  __int64 v1; // rax@1

  *(_QWORD *)a1 = off_17380;
  LODWORD(v1) = IOLockAlloc(a1);
  *(_QWORD *)(a1 + 8) = v1;
  return v1;
}
// 17380: using guessed type __int64 (__fastcall *off_17380[2])(AppleUSBEHCI_IOLockClass *__hidden this);
// 2DAD0: using guessed type int __cdecl IOLockAlloc(_QWORD);

//----- (0000000000003E60) ----------------------------------------------------
int __fastcall AppleUSBEHCI_IOLockClass::~AppleUSBEHCI_IOLockClass(AppleUSBEHCI_IOLockClass *this)
{
  *(_QWORD *)this = off_17380;
  return IOLockFree(*((_QWORD *)this + 1));
}
// 17380: using guessed type __int64 (__fastcall *off_17380[2])(AppleUSBEHCI_IOLockClass *__hidden this);
// 2DAD8: using guessed type int __fastcall IOLockFree(_QWORD);

//----- (0000000000003E78) ----------------------------------------------------
void __fastcall AppleUSBEHCI_IOLockClass::~AppleUSBEHCI_IOLockClass(AppleUSBEHCI_IOLockClass *this)
{
  *(_QWORD *)this = off_17380;
  IOLockFree(*((_QWORD *)this + 1));
  operator delete((void *)this);
}
// 17380: using guessed type __int64 (__fastcall *off_17380[2])(AppleUSBEHCI_IOLockClass *__hidden this);
// 2DAD8: using guessed type int __fastcall IOLockFree(_QWORD);

//----- (0000000000003EA2) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::CheckSleepCapability(AppleUSBEHCI *this)
{
  AppleUSBEHCI *v1; // rbx@1
  IOService *v2; // rdi@1
  __int64 v3; // rax@1
  IOService *v4; // rax@2
  IOService *v5; // rdi@2
  __int64 v6; // rax@2
  __int64 v7; // rax@3
  __int64 v8; // rax@3
  __int64 v9; // rax@4
  __int64 v10; // rsi@4
  __int64 v11; // rdx@4
  __int64 v12; // rax@6
  __int64 v13; // rdi@10
  __int64 v14; // rax@10
  signed __int64 v15; // rsi@10
  __int64 result; // rax@16

  v1 = this;
  *(_BYTE *)(*((_QWORD *)this + 21) + 200LL) = 1;
  *(_BYTE *)(*((_QWORD *)this + 84) + 249LL) = 0;
  v2 = (IOService *)*((_QWORD *)this + 61);
  LODWORD(v3) = (*(int (__fastcall **)(IOService *, _QWORD))(*(_QWORD *)v2 + 696LL))(v2, "AAPL,clock-id");
  if ( v3
    || (v4 = (IOService *)IOService::getPlatform(v2),
        v5 = v4,
        LODWORD(v6) = (*(int (__fastcall **)(IOService *))(*(_QWORD *)v4 + 2216LL))(v4),
        v6 == 2)
    && (v7 = IOService::getPlatform(v5),
        LODWORD(v8) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v7 + 2224LL))(v7),
        v8 == 5) )
  {
    v9 = *(_QWORD *)v1;
    v10 = (__int64)"Card Type";
    v11 = (__int64)"Built-in";
    goto LABEL_5;
  }
  LODWORD(v12) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)v1 + 61) + 696LL))(
                   *((_QWORD *)v1 + 61),
                   "built-in");
  if ( v12 )
  {
    if ( *(_BYTE *)(*((_QWORD *)v1 + 84) + 209LL) & 4 )
      IOUSBControllerV3::FixupNECControllerConfigRegisters(v1);
    if ( !(unsigned __int8)(*(int (__fastcall **)(_QWORD, signed __int64))(**((_QWORD **)v1 + 61) + 2376LL))(
                             *((_QWORD *)v1 + 61),
                             0x8000LL) )
      goto LABEL_15;
    v13 = *((_QWORD *)v1 + 61);
    v14 = *(_QWORD *)v13;
    v15 = 3LL;
    goto LABEL_13;
  }
  if ( (unsigned __int8)(*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)v1 + 61) + 2376LL))(
                          *((_QWORD *)v1 + 61),
                          0LL) )
  {
    v13 = *((_QWORD *)v1 + 61);
    v14 = *(_QWORD *)v13;
    v15 = 0xFFFFFFFFLL;
LABEL_13:
    if ( !(*(int (__fastcall **)(__int64, signed __int64))(v14 + 2384))(v13, v15) )
    {
      *(_BYTE *)(*((_QWORD *)v1 + 84) + 249LL) = 1;
      (*(void (__fastcall **)(AppleUSBEHCI *, _QWORD, _QWORD))(*(_QWORD *)v1 + 624LL))(v1, "Card Type", "Built-in");
    }
  }
LABEL_15:
  if ( *(_BYTE *)(*((_QWORD *)v1 + 84) + 249LL) )
    goto LABEL_16;
  KernelDebugLogInternal(
    1LL,
    1431519814LL,
    "AppleUSBEHCI::CheckSleepCapability - controller will be unloaded across sleep");
  *(_BYTE *)(*((_QWORD *)v1 + 21) + 200LL) = 0;
  v9 = *(_QWORD *)v1;
  v10 = (__int64)"Card Type";
  v11 = (__int64)"PCI";
LABEL_5:
  (*(void (__fastcall **)(AppleUSBEHCI *, __int64, __int64))(v9 + 624))(v1, v10, v11);
LABEL_16:
  result = IOUSBController::ExpressCardPort(v1, *((IORegistryEntry **)v1 + 61));
  *((_DWORD *)v1 + 520) = result;
  *((_BYTE *)v1 + 2097) = 0;
  return result;
}
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (0000000000004054) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::ResumeUSBBus(uintptr_t arg1)
{
  __int64 v1; // rax@4
  signed int v2; // ebx@7
  int v3; // eax@10
  __int64 v4; // rcx@11
  signed int v5; // ebx@16
  int v6; // eax@17
  __int64 v7; // rbx@20
  __int64 v8; // r14@21
  int v9; // eax@21
  __int64 result; // rax@26

  if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D509Cu, arg1, 0LL, 0LL, 0LL, 0LL);
  v1 = *(_QWORD *)(arg1 + 704);
  if ( *(_DWORD *)(v1 + 64) != 1 )
  {
    *(_DWORD *)(v1 + 64) = 1;
    _mm_mfence();
    if ( *(_BYTE *)(*(_QWORD *)(arg1 + 672) + 209LL) & 4 )
    {
      if ( *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 64LL) != 1 )
      {
        v2 = 1;
        do
        {
          KernelDebugLogInternal(
            1LL,
            1431519814LL,
            "EHCI driver: ResumeUSBBus - ConfigFlag bit not sticking. Retrying.");
          *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 64LL) = 1;
          _mm_mfence();
          if ( (unsigned int)v2 > 9 )
            break;
          ++v2;
        }
        while ( *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 64LL) != 1 );
      }
    }
  }
  *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 20LL) = *(_DWORD *)(arg1 + 1800);
  _mm_mfence();
  v3 = *(_DWORD *)(arg1 + 1804);
  if ( v3 )
  {
    v4 = *(_QWORD *)(arg1 + 704);
    if ( *(_DWORD *)(v4 + 24) != v3 )
    {
      *(_DWORD *)(v4 + 24) = v3;
      _mm_mfence();
    }
  }
  if ( *(_BYTE *)(arg1 + 1695) )
    *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 16LL) = 0;
  if ( *(_BYTE *)(arg1 + 1796) & 1 )
  {
    **(_DWORD **)(arg1 + 704) = **(_DWORD **)(arg1 + 704) & 0xFF00FFFE | 0x10001;
    _mm_mfence();
    v5 = 0;
    do
    {
      v6 = *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 4LL);
      if ( !(BYTE1(v6) & 0x10) )
        break;
      IODelay(100LL);
      ++v5;
    }
    while ( v5 < 100 );
  }
  if ( *(_BYTE *)(arg1 + 505) )
  {
    v7 = 0LL;
    do
    {
      v8 = v7++;
      v9 = getPortSCForWriting(*(_QWORD *)(arg1 + 704), (signed __int16)v7);
      if ( (v9 & 0x2004) == 4 && *(_BYTE *)(arg1 + 2097) && (_DWORD)v7 == *(_DWORD *)(arg1 + 2080) )
      {
        *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 4 * v8 + 68) = v9 | 0x300000;
        _mm_mfence();
      }
    }
    while ( (signed int)v7 < *(_BYTE *)(arg1 + 505) );
  }
  result = *(_DWORD *)(arg1 + 1796);
  if ( (_DWORD)result )
    **(_DWORD **)(arg1 + 704) = result;
  return result;
}
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];
// 2DAC0: using guessed type int __fastcall IODelay(_QWORD);
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (0000000000004224) ----------------------------------------------------
void __usercall AppleUSBEHCI::SuspendUSBBus(AppleUSBEHCI *this@<rdi>, __int64 a2@<rax>)
{
  int v2; // er13@4
  signed int v3; // ebx@7
  int v4; // eax@8
  signed int v5; // ebx@15
  int v6; // eax@16
  signed int v7; // ebx@22
  int v8; // eax@23
  signed int v9; // er14@26
  int v10; // eax@28
  __int64 v11; // rax@32
  __int64 v12; // r8@32
  __int64 v13; // r9@32
  __int64 v14; // rbx@34
  __int64 v15; // r12@35
  int v16; // eax@35
  signed int v17; // er14@44
  uintptr_t v18; // rbx@44
  __int64 v19; // r12@44
  __int64 v20; // r13@44
  int v21; // eax@51
  __int64 v22; // [sp-6h] [bp-30h]@1

  v22 = a2;
  if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D5095u, (uintptr_t)this, 0LL, 0LL, 0LL, 0LL);
  *((_DWORD *)this + 452) = 0;
  v2 = **((_DWORD **)this + 88);
  *((_DWORD *)this + 449) = v2;
  if ( *(_BYTE *)(*((_QWORD *)this + 84) + 209LL) & 0x10 )
    AppleUSBEHCI::DisablePrefetchRegister(*((IOPCIDevice **)this + 61), *((_QWORD *)this + 88));
  if ( v2 & 0x20 )
  {
    v3 = 0;
    while ( 1 )
    {
      v4 = *(_DWORD *)(*((_QWORD *)this + 88) + 4LL);
      if ( BYTE1(v4) & 0x80 )
        break;
      IODelay(100LL);
      ++v3;
      if ( v3 >= 100 )
        goto LABEL_12;
    }
    if ( !v3 )
      goto LABEL_13;
LABEL_12:
    KernelDebugLogInternal(
      1LL,
      1431519814LL,
      "AppleUSBEHCI::SuspendUSBBus - Async Schedule should have been on but was off for %d loops");
LABEL_13:
    v2 &= 0xFFFFFFDF;
  }
  if ( v2 & 0x10 )
  {
    v5 = 0;
    while ( 1 )
    {
      v6 = *(_DWORD *)(*((_QWORD *)this + 88) + 4LL);
      if ( BYTE1(v6) & 0x40 )
        break;
      IODelay(100LL);
      ++v5;
      if ( v5 >= 100 )
        goto LABEL_20;
    }
    if ( !v5 )
      goto LABEL_21;
LABEL_20:
    KernelDebugLogInternal(
      1LL,
      1431519814LL,
      "AppleUSBEHCI::SuspendUSBBus - Periodic Schedule should have been on but was off for %d loops");
LABEL_21:
    v2 &= 0xFFFFFFEF;
  }
  **((_DWORD **)this + 88) = v2;
  _mm_mfence();
  v7 = 0;
  while ( 1 )
  {
    v8 = *(_DWORD *)(*((_QWORD *)this + 88) + 4LL);
    if ( !(BYTE1(v8) & 0x80) )
      break;
    IODelay(1000LL);
    ++v7;
    if ( v7 >= 100 )
      goto LABEL_27;
  }
  v9 = 0;
  if ( v7 < 3 )
    goto LABEL_28;
LABEL_27:
  v9 = 0;
  KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBEHCI::SuspendUSBBus - Async Schedule took %d loops to turn off");
LABEL_28:
  while ( 1 )
  {
    v10 = *(_DWORD *)(*((_QWORD *)this + 88) + 4LL);
    if ( !(BYTE1(v10) & 0x40) )
      break;
    IODelay(1000LL);
    ++v9;
    if ( v9 >= 1000 )
      goto LABEL_32;
  }
  if ( v9 < 3 )
    goto LABEL_33;
LABEL_32:
  v11 = *((_QWORD *)this + 88);
  v12 = *(_DWORD *)v11;
  v13 = *(_DWORD *)(v11 + 4);
  KernelDebugLogInternal(
    1LL,
    1431519814LL,
    "AppleUSBEHCI::SuspendUSBBus - Periodic Schedule took %d loops to turn off CMD(0x%x) STS(0x%x)");
LABEL_33:
  *((_DWORD *)this + 451) = *(_DWORD *)(*((_QWORD *)this + 88) + 24LL);
  AppleUSBEHCI::GetNumberOfPorts(this, (unsigned __int8 *)&v22 + 7);
  if ( BYTE7(v22) )
  {
    v14 = 0LL;
    do
    {
      v15 = v14++;
      v16 = getPortSCForWriting(*((_QWORD *)this + 88), (signed __int16)v14);
      if ( !(BYTE1(v16) & 0x20) )
      {
        if ( *((_BYTE *)this + 2097) && (_DWORD)v14 == *((_DWORD *)this + 520) )
        {
          v16 &= 0xFFCFFFFF;
          *(_DWORD *)(*((_QWORD *)this + 88) + 4 * v15 + 68) = v16;
          _mm_mfence();
        }
        if ( v16 & 4 )
        {
          if ( v16 & 0x80 )
            *((_DWORD *)this + 452) |= 1 << v15;
          else
            KernelDebugLogInternal(
              1LL,
              1431519814LL,
              "AppleUSBEHCI::SuspendUSBBus - port %d was NOT already suspended (as it should have been) PROBLEMS AHEAD");
        }
      }
    }
    while ( (signed int)v14 < BYTE7(v22) );
  }
  **((_DWORD **)this + 88) = v2 & 0xFFFFFFFE;
  _mm_mfence();
  *((_BYTE *)this + 440) = 0;
  v17 = 0;
  v18 = 1LL;
  v19 = off_160C8[0];
  v20 = off_160C0[0];
  while ( (_DWORD)v18 != 10000
                       * (((unsigned __int64)(1759218605LL * (signed int)v18) >> 63)
                        + (unsigned int)(1759218605LL * (signed int)v18 >> 44)) )
  {
LABEL_51:
    v21 = *(_DWORD *)(*((_QWORD *)this + 88) + 4LL);
    ++v18;
    if ( BYTE1(v21) & 0x10 )
      return;
  }
  if ( *(_BYTE *)v20 & 2 )
  {
    if ( *(_DWORD *)v19 & 0xFFFFFFF7 )
      kernel_debug(
        0x52D5094u,
        (uintptr_t)this,
        **((_DWORD **)this + 88),
        *(_DWORD *)(*((_QWORD *)this + 88) + 4LL),
        v18,
        0LL);
  }
  if ( v17 <= 98 )
  {
    ++v17;
    goto LABEL_51;
  }
}
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];
// 2DAC0: using guessed type int __fastcall IODelay(_QWORD);
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (0000000000004540) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::StopUSBBus(uintptr_t arg1)
{
  __int64 result; // rax@6

  if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D50B8u, arg1, 0LL, 0LL, 0LL, 0LL);
  if ( *(_BYTE *)(*(_QWORD *)(arg1 + 672) + 209LL) & 0x10 )
    AppleUSBEHCI::DisablePrefetchRegister(*(IOPCIDevice **)(arg1 + 488), *(_QWORD *)(arg1 + 704));
  result = *(_QWORD *)(arg1 + 704);
  *(_DWORD *)result &= 0xFFFFFFFE;
  _mm_mfence();
  *(_BYTE *)(arg1 + 440) = 0;
  return result;
}
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];

//----- (00000000000045BA) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::RestartUSBBus(uintptr_t arg1)
{
  __int64 result; // rax@4
  int v2; // ecx@5

  if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D50A0u, arg1, 0LL, 0LL, 0LL, 0LL);
  result = *(_QWORD *)(arg1 + 704);
  do
    v2 = *(_DWORD *)(result + 4);
  while ( !(BYTE1(v2) & 0x10) );
  *(_DWORD *)result |= 1u;
  _mm_mfence();
  *(_BYTE *)(arg1 + 440) = 2;
  return result;
}
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];

//----- (0000000000004618) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::SaveControllerStateForSleep(AppleUSBEHCI *this)
{
  __int64 v1; // rax@3

  AppleUSBEHCI::showRegisters(this, 7LL, "+SaveControllerStateForSleep");
  if ( (unsigned int)*((_BYTE *)this + 440) <= 1 )
    AppleUSBEHCI::RestartUSBBus((uintptr_t)this);
  LODWORD(v1) = AppleUSBEHCI::printAsyncQueue((uintptr_t)this, 7, "SaveControllerStateForSleep", 1LL, 0);
  AppleUSBEHCI::SuspendUSBBus(this, v1);
  AppleUSBEHCI::printAsyncQueue((uintptr_t)this, 7, "SaveControllerStateForSleep", 1LL, 0);
  *((_BYTE *)this + 440) = 1;
  if ( *(_BYTE *)(*((_QWORD *)this + 84) + 211LL) & 1 )
  {
    *(_DWORD *)(*((_QWORD *)this + 88) + 128LL) |= 1u;
    _mm_mfence();
  }
  AppleUSBEHCI::showRegisters(this, 7LL, "-SaveControllerStateForSleep");
  return 0LL;
}

//----- (00000000000046CA) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::RestoreControllerStateFromSleep(uintptr_t arg1)
{
  uintptr_t v1; // r14@1
  int v2; // ebx@1
  signed __int64 v3; // rsi@2
  __int64 v4; // rax@2
  signed int v5; // ebx@9
  __int64 v6; // r12@10
  int v7; // er9@10
  __int64 v8; // r8@11
  __int64 v9; // rdi@14
  __int64 v10; // rax@15
  __int64 v11; // rax@16
  __int64 v12; // rdx@18
  __int64 v13; // r8@24
  bool v14; // cf@25

  v1 = arg1;
  v2 = *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 4LL);
  if ( v2 == -1 )
  {
    *(_BYTE *)(arg1 + 444) = 0;
  }
  else
  {
    v3 = 7LL;
    AppleUSBEHCI::showRegisters((AppleUSBEHCI *)arg1, 7LL, "+RestoreControllerStateFromSleep");
    v4 = *(_QWORD *)(*(_QWORD *)(arg1 + 672) + 208LL);
    if ( v4 & 0x1000000 )
    {
      *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 128LL) &= 0xFFFFFFFE;
      _mm_mfence();
      v4 = *(_QWORD *)(*(_QWORD *)(arg1 + 672) + 208LL);
    }
    if ( BYTE1(v4) & 4 )
      IOUSBControllerV3::FixupNECControllerConfigRegisters((IOUSBControllerV3 *)arg1);
    if ( (v2 & 4 || *(_BYTE *)(*(_QWORD *)(arg1 + 672) + 210LL) & 4) && *(_BYTE *)(arg1 + 505) )
    {
      v5 = 1;
      do
      {
        v6 = (unsigned int)(v5 - 1);
        v7 = *(_DWORD *)(*(_QWORD *)(v1 + 704) + 4 * v6 + 68);
        if ( v7 & 2 )
        {
          v8 = *(_DWORD *)(*(_QWORD *)(v1 + 168) + 28LL);
          if ( v7 & 4 )
          {
            KernelDebugLogInternal(
              1LL,
              1431519814LL,
              "USB (EHCI):Port %d on bus 0x%x - connect status changed but still enabled. clearing enable bit: portSC(0x%x)\n");
            v3 = (unsigned int)(signed __int16)v5;
            *(_DWORD *)(*(_QWORD *)(v1 + 704) + 4 * v6 + 68) = getPortSCForWriting(*(_QWORD *)(v1 + 704), v3) & 0xFFFFFFFB;
            _mm_mfence();
          }
          else
          {
            v3 = (unsigned int)v5;
            IOLog("USB (EHCI):Port %d on bus 0x%x connected or disconnected: portSC(0x%x)\n");
            (*(void (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)v1 + 2976LL))(v1, (unsigned int)v5);
          }
        }
        else if ( v7 & 0x40 )
        {
          v9 = *(_QWORD *)(v1 + 152);
          if ( v9
            && (LODWORD(v10) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v9 + 2608LL))(v9, v3), v10) )
          {
            LODWORD(v11) = (*(int (__cdecl **)(_QWORD))(**(_QWORD **)(v1 + 152) + 2608LL))(*(_QWORD *)(v1 + 152));
            v3 = 3758112790LL;
            (*(void (__fastcall **)(__int64, signed __int64, uintptr_t, _QWORD))(*(_QWORD *)v11 + 1840LL))(
              v11,
              3758112790LL,
              v1,
              (unsigned int)(v5 - 1));
          }
          else
          {
            v12 = *(_DWORD *)(*(_QWORD *)(v1 + 168) + 28LL);
            v3 = (unsigned int)v5;
            IOLog("\tUSB (EHCI):Port %d on bus 0x%x has remote wakeup from some device\n");
          }
          if ( *(_BYTE *)(*(_QWORD *)(v1 + 672) + 210LL) & 4
            && !*(_DWORD *)(v1 + 1676)
            && !(*(_DWORD *)(*(_QWORD *)(v1 + 704) + 4LL) & 4) )
            *(_DWORD *)(v1 + 1676) = 4;
        }
        else if ( (*(_DWORD *)(*(_QWORD *)(v1 + 704) + 4 * v6 + 68) & 0x84) == 4 )
        {
          v13 = *(_DWORD *)(*(_QWORD *)(v1 + 168) + 28LL);
          KernelDebugLogInternal(
            1LL,
            1431519814LL,
            "USB (EHCI):Port %d on bus 0x%x - port enabled but not suspended.  clearing enable bit: portSC(0x%x)\n");
          v3 = (unsigned int)(signed __int16)v5;
          *(_DWORD *)(*(_QWORD *)(v1 + 704) + 4 * v6 + 68) = getPortSCForWriting(*(_QWORD *)(v1 + 704), v3) & 0xFFFFFFFB;
          _mm_mfence();
        }
        v14 = v5++ < (unsigned int)*(_BYTE *)(v1 + 505);
      }
      while ( v14 );
    }
    AppleUSBEHCI::printAsyncQueue(v1, 7, "RestoreControllerStateFromSleep", 1LL, 0);
    AppleUSBEHCI::ResumeUSBBus(v1);
    AppleUSBEHCI::printAsyncQueue(v1, 7, "RestoreControllerStateFromSleep", 1LL, 0);
    *(_BYTE *)(v1 + 440) = 2;
    AppleUSBEHCI::showRegisters((AppleUSBEHCI *)v1, 7LL, "-RestoreControllerStateFromSleep");
  }
  return 0LL;
}
// 2DAF8: using guessed type int __fastcall IOLog(_QWORD);
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (0000000000004982) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::ResetControllerState(AppleUSBEHCI *this)
{
  __int64 v1; // rax@6
  int v2; // ecx@6
  signed int v3; // ebx@8
  int v4; // eax@9
  int v6; // eax@12
  __int64 v7; // rax@17

  if ( *(_DWORD *)(*((_QWORD *)this + 88) + 24LL) == -1 )
    goto LABEL_14;
  if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D50A4u, (uintptr_t)this, 0LL, 0LL, 0LL, 0LL);
  if ( *(_BYTE *)(*((_QWORD *)this + 84) + 211LL) & 1 )
  {
    v1 = *((_QWORD *)this + 88);
    v2 = *(_DWORD *)(v1 + 128);
    if ( v2 & 1 )
    {
      *(_DWORD *)(v1 + 128) = v2 & 0xFFFFFFFE;
      _mm_mfence();
    }
  }
  AppleUSBEHCI::showRegisters(this, 2LL, "+ResetControllerState");
  **((_DWORD **)this + 88) = 0;
  _mm_mfence();
  *((_BYTE *)this + 440) = 0;
  v3 = 0;
  while ( 1 )
  {
    v4 = *(_DWORD *)(*((_QWORD *)this + 88) + 4LL);
    if ( BYTE1(v4) & 0x10 )
      break;
    IOSleep(1LL);
    ++v3;
    if ( v3 >= 100 )
    {
      KernelDebugLogInternal(
        1LL,
        1431519814LL,
        "AppleUSBEHCI::ResetControllerState - could not get chip to halt within 100 ms");
      return 3758097097LL;
    }
  }
  v6 = *(_DWORD *)(*((_QWORD *)this + 88) + 24LL);
  if ( !v6 )
  {
LABEL_16:
    *(_DWORD *)(*((_QWORD *)this + 88) + 20LL) = 0;
    *(_DWORD *)(*((_QWORD *)this + 88) + 24LL) = 0;
    _mm_mfence();
    if ( *((_BYTE *)this + 505) )
    {
      v7 = 0LL;
      do
        *((_DWORD *)this + v7++ + 456) = 0;
      while ( (signed int)v7 < *((_BYTE *)this + 505) );
    }
    *((_BYTE *)this + 1692) = 0;
    AppleUSBEHCI::showRegisters(this, 2LL, "-ResetControllerState");
    return 0LL;
  }
  if ( v6 != -1 )
  {
    *((_DWORD *)this + 451) = v6;
    goto LABEL_16;
  }
LABEL_14:
  *((_BYTE *)this + 444) = 0;
  return 0LL;
}
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];
// 2DB30: using guessed type int __fastcall IOSleep(_QWORD);
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (0000000000004AFC) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::RestartControllerFromReset(AppleUSBEHCI *this)
{
  signed int v1; // ebx@5
  __int64 result; // rax@10
  __int64 v3; // rax@11
  int v4; // ecx@11
  unsigned int v5; // ecx@13
  signed int v6; // ebx@15

  if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D50BCu, (uintptr_t)this, 0LL, 0LL, 0LL, 0LL);
  if ( *((_BYTE *)this + 1692) )
  {
LABEL_11:
    *(_DWORD *)(*((_QWORD *)this + 88) + 20LL) = *((_DWORD *)this + 450);
    _mm_mfence();
    v3 = *((_QWORD *)this + 88);
    v4 = *((_DWORD *)this + 451);
    if ( *(_DWORD *)(v3 + 24) != v4 )
    {
      *(_DWORD *)(v3 + 24) = v4;
      _mm_mfence();
    }
    v5 = **((_DWORD **)this + 88) & 0xFF00FFFE;
    *((_DWORD *)this + 433) = 1024;
    *((_BYTE *)this + 440) = 2;
    **((_DWORD **)this + 88) = v5 | 0x10001;
    *(_DWORD *)(*((_QWORD *)this + 88) + 64LL) = 1;
    _mm_mfence();
    if ( *(_BYTE *)(*((_QWORD *)this + 84) + 209LL) & 4 && *(_DWORD *)(*((_QWORD *)this + 88) + 64LL) != 1 )
    {
      v6 = 1;
      do
      {
        KernelDebugLogInternal(
          1LL,
          1431519814LL,
          "EHCI driver: RestartControllerFromReset - ConfigFlag bit not sticking. Retrying.");
        *(_DWORD *)(*((_QWORD *)this + 88) + 64LL) = 1;
        _mm_mfence();
        if ( (unsigned int)v6 > 9 )
          break;
        ++v6;
      }
      while ( *(_DWORD *)(*((_QWORD *)this + 88) + 64LL) != 1 );
    }
    *((_DWORD *)this + 448) = 31;
    *((_WORD *)this + 906) = 1025;
    AppleUSBEHCI::CheckSleepCapability(this);
    result = 0LL;
  }
  else
  {
    **((_DWORD **)this + 88) = 2;
    _mm_mfence();
    v1 = 0;
    while ( **((_DWORD **)this + 88) & 2 )
    {
      IOSleep(1LL);
      ++v1;
      if ( v1 >= 100 )
        goto LABEL_10;
    }
    if ( v1 < 100 )
      goto LABEL_11;
LABEL_10:
    KernelDebugLogInternal(
      1LL,
      1431519814LL,
      "AppleUSBEHCI::RestartControllerFromReset - could not get chip to come out of reset within 100 ms");
    result = 3758097097LL;
  }
  return result;
}
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];
// 2DB30: using guessed type int __fastcall IOSleep(_QWORD);
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (0000000000004C9E) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::DozeController(uintptr_t arg1)
{
  if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D50A8u, arg1, 0LL, 0LL, 0LL, 0LL);
  AppleUSBEHCI::DisableAsyncSchedule(arg1, 1);
  AppleUSBEHCI::DisablePeriodicSchedule(arg1, 1);
  AppleUSBEHCI::StopUSBBus(arg1);
  if ( *(_QWORD *)(arg1 + 456) == 4LL )
  {
    *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 8LL) |= 4u;
    _mm_mfence();
  }
  return 0LL;
}
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];

//----- (0000000000004D1C) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::WakeControllerFromDoze(AppleUSBEHCI *this)
{
  __int64 v1; // rax@6
  char v2; // cl@6

  if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D50ACu, (uintptr_t)this, 0LL, 0LL, 0LL, 0LL);
  AppleUSBEHCI::RestartUSBBus((uintptr_t)this);
  if ( *((_DWORD *)this + 112) >= 3 && *((_BYTE *)this + 505) )
  {
    LODWORD(v1) = 0;
    v2 = 0;
    do
    {
      v1 = (unsigned int)v1;
      if ( *(_DWORD *)(*((_QWORD *)this + 88) + 4LL * (unsigned int)v1 + 68) & 0x40 )
      {
        *((_BYTE *)this + v1 + 1944) = 1;
        v2 = 1;
      }
      LODWORD(v1) = v1 + 1;
    }
    while ( (unsigned int)v1 < *((_BYTE *)this + 505) );
    if ( v2 & 1 )
    {
      IOSleep(20LL);
      AppleUSBEHCI::RHCompleteResumeOnAllPorts(this);
    }
  }
  return 0LL;
}
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];
// 2DB30: using guessed type int __fastcall IOSleep(_QWORD);

//----- (0000000000004DBE) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::EnableInterruptsFromController(uintptr_t arg1, uintptr_t a2)
{
  char v2; // r14@1
  uintptr_t v3; // rdx@3
  int v4; // eax@7
  __int64 v5; // rdi@8

  v2 = a2;
  if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
  {
    v3 = (unsigned __int8)a2;
    a2 = arg1;
    kernel_debug(0x52D50B0u, arg1, v3, 0LL, 0LL, 0LL);
  }
  if ( !v2 )
  {
    *(_DWORD *)(arg1 + 1792) = *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 8LL);
    *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 8LL) = 0;
    _mm_mfence();
    return 0LL;
  }
  if ( !(*(_BYTE *)(*(_QWORD *)(arg1 + 672) + 210LL) & 4) )
  {
    *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 8LL) = *(_DWORD *)(arg1 + 1792);
    _mm_mfence();
LABEL_13:
    *(_DWORD *)(arg1 + 1792) = 0;
    return 0LL;
  }
  if ( !*(_DWORD *)(arg1 + 1676) )
  {
    *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 8LL) = *(_DWORD *)(arg1 + 1792);
    _mm_mfence();
    goto LABEL_13;
  }
  v4 = *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 4LL) | *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 8LL);
  *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 8LL) = *(_DWORD *)(arg1 + 1792);
  _mm_mfence();
  *(_DWORD *)(arg1 + 1792) = 0;
  if ( !(v4 & 4) )
  {
    v5 = *(_QWORD *)(arg1 + 1608);
    if ( v5 )
      (*(void (__fastcall **)(__int64, uintptr_t))(*(_QWORD *)v5 + 568LL))(v5, a2);
  }
  return 0LL;
}
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];

//----- (0000000000004EC0) ----------------------------------------------------
int __fastcall AppleUSBEHCI::maxCapabilityForDomainState(AppleUSBEHCI *this, __int64 a2)
{
  __int64 v2; // rax@4
  int v3; // ecx@4
  __int64 v4; // rcx@7

  if ( *(_BYTE *)(*((_QWORD *)this + 21) + 244LL) )
  {
    if ( !*((_BYTE *)this + 441) && *((_QWORD *)this + 57) == 2LL )
    {
      v2 = *((_QWORD *)this + 88);
      v3 = *(_DWORD *)(v2 + 64);
      if ( v3 != 1 )
      {
        if ( v3 == -1 )
        {
          *((_BYTE *)this + 444) = 0;
        }
        else
        {
          v4 = *(_DWORD *)(v2 + 68);
          KernelDebugLogInternal(
            1LL,
            1431519814LL,
            "EHCI: Thunderbolt controller appears to have been reset - going into wake from hibernation PortSC[0](0x%x)");
          *(_BYTE *)(*((_QWORD *)this + 84) + 384LL) = 1;
        }
      }
    }
  }
  return (*(int (__fastcall **)(AppleUSBEHCI *, __int64))(off_16068[0] + 2048))(this, a2);
}
// 16068: using guessed type __int64 off_16068[14];
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (0000000000004F4E) ----------------------------------------------------
int __fastcall AppleUSBEHCI::powerStateDidChangeTo(uintptr_t arg1, __int64 a2, uintptr_t a3, __int64 a4)
{
  __int64 v4; // r12@1
  uintptr_t v5; // r14@1

  v4 = a4;
  v5 = a3;
  if ( arg1 == a4 )
  {
    if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D50B4u, arg1, a3, 0LL, 2uLL, 0LL);
    if ( *(_QWORD *)(arg1 + 456) == 2LL && v5 == 3 )
      *(_BYTE *)(arg1 + 1792) |= 4u;
  }
  return (*(int (__fastcall **)(uintptr_t, __int64, uintptr_t, __int64))(off_16068[0] + 2080))(arg1, a2, v5, v4);
}
// 16068: using guessed type __int64 off_16068[14];
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];

//----- (0000000000004FD8) ----------------------------------------------------
int __fastcall AppleUSBEHCI::powerChangeDone(AppleUSBEHCI *this, uintptr_t arg2)
{
  unsigned int v2; // eax@1
  int v3; // eax@5
  __int64 v4; // rbx@9
  int v5; // eax@11
  const OSMetaClass *v6; // rdx@11

  v2 = IOService::getPowerState(this);
  if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D50B4u, (uintptr_t)this, arg2, v2, 1uLL, 0LL);
  if ( *((_BYTE *)this + 441) )
  {
    v3 = *(_DWORD *)(*((_QWORD *)this + 88) + 24LL);
    *((_DWORD *)this + 451) = v3;
    if ( v3 )
    {
      if ( v3 == -1 )
      {
        *((_BYTE *)this + 444) = 0;
        *((_DWORD *)this + 451) = 0;
        goto LABEL_13;
      }
      *((_DWORD *)this + 451) = 0;
    }
    v4 = *((_QWORD *)this + 217);
    if ( v4 )
    {
      KernelDebugLogInternal(
        1LL,
        1431519814LL,
        "AppleUSBEHCI::powerChangeDone - waking from hibernation with some queue heads on the queue. UNEXPECTED");
      do
      {
        v5 = *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v4) + 4);
        v4 = OSMetaClassBase::safeMetaCast(
               *(OSMetaClassBase **)(v4 + 32),
               (const OSMetaClassBase *)AppleEHCIQueueHead::metaClass,
               v6);
      }
      while ( v4 );
      *((_QWORD *)this + 217) = 0LL;
    }
  }
LABEL_13:
  if ( *((_BYTE *)this + 444) )
    AppleUSBEHCI::showRegisters(this, 7LL, "powerChangeDone");
  return (*(int (__fastcall **)(AppleUSBEHCI *, uintptr_t))(off_16068[0] + 2136))(this, arg2);
}
// 16068: using guessed type __int64 off_16068[14];
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];
// 165C0: using guessed type _QWORD AppleEHCIQueueHead::metaClass;
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);
// 2DEC8: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (00000000000050FE) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::ToggleSMSCHubResetGPIO(__int64 a1, __int64 a2, unsigned int a3)
{
  __int64 v3; // r12@1
  __int64 v4; // rax@1
  __int64 v5; // rbx@1
  signed int v6; // er15@1
  __int64 result; // rax@5
  int v8; // [sp+Ch] [bp-34h]@1
  __int64 v9; // [sp+10h] [bp-30h]@1
  __int64 v10; // [sp+18h] [bp-28h]@1

  v3 = off_16090[0];
  v10 = *(_QWORD *)off_16090[0];
  v9 = 0LL;
  v8 = 0;
  v4 = OSNumber::withNumber(0LL, 4uLL, a3);
  v5 = v4;
  v6 = -536870211;
  if ( v4 )
  {
    v9 = v4;
    (*(void (__fastcall **)(__int64, _QWORD, int *, __int64 *, signed __int64, _QWORD))(*(_QWORD *)a2 + 2256LL))(
      a2,
      "HRST",
      &v8,
      &v9,
      1LL,
      0LL);
    IOSleep(100LL);
    v8 = 1;
    v6 = -536870211;
    if ( (unsigned __int8)(*(int (__fastcall **)(__int64, signed __int64, signed __int64))(*(_QWORD *)v5 + 280LL))(
                            v5,
                            1LL,
                            4LL) )
    {
      v9 = v5;
      (*(void (__fastcall **)(__int64, _QWORD, int *, __int64 *, signed __int64, _QWORD))(*(_QWORD *)a2 + 2256LL))(
        a2,
        "HRST",
        &v8,
        &v9,
        1LL,
        0LL);
      v6 = 0;
    }
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v5 + 40LL))(v5);
  }
  result = *(_QWORD *)v3;
  if ( *(_QWORD *)v3 == v10 )
    result = (unsigned int)v6;
  return result;
}
// 16090: using guessed type __int64 off_16090[9];
// 2DB30: using guessed type int __fastcall IOSleep(_QWORD);

//----- (00000000000051F8) ----------------------------------------------------
bool __fastcall AppleUSBEHCI::HasSMSCHubResetGPIO(__int64 a1, __int64 a2)
{
  return (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)a2 + 2224LL))(a2, "HRST") == 0;
}

//----- (000000000000521A) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::SMSCHubReset(AppleUSBEHCI *this, IOService *a2)
{
  __int64 v2; // rbx@1
  signed int v3; // er14@1
  __int64 v4; // rdi@3
  unsigned int v5; // edx@3

  v2 = IOUSBController::CopyACPIDevice(this, a2);
  v3 = -536870208;
  if ( v2 )
  {
    v3 = -536870208;
    if ( !(*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v2 + 2224LL))(v2, "HRST") )
    {
      v4 = qword_18B60;
      if ( IOLockTryLock(qword_18B60) )
      {
        v3 = AppleUSBEHCI::ToggleSMSCHubResetGPIO(v4, v2, v5);
        IOLockUnlock(qword_18B60);
      }
      else
      {
        IOLockLock(qword_18B60);
        IOLockUnlock(qword_18B60);
        v3 = 0;
      }
    }
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 40LL))(v2);
  }
  return (unsigned int)v3;
}
// 18B60: using guessed type __int64 qword_18B60;
// 2DAE0: using guessed type int __fastcall IOLockLock(_QWORD);
// 2DAE8: using guessed type int __fastcall IOLockTryLock(_QWORD);
// 2DAF0: using guessed type int __fastcall IOLockUnlock(_QWORD);

//----- (00000000000052B0) ----------------------------------------------------
int __fastcall `global constructor keyed to'_a_4(__int64 a1)
{
  __int64 v1; // rax@1

  gEHCI_GlobalLock = off_17380;
  LODWORD(v1) = IOLockAlloc(a1);
  qword_18B60 = v1;
  return v1;
}
// 17380: using guessed type __int64 (__fastcall *off_17380[2])(AppleUSBEHCI_IOLockClass *__hidden this);
// 18B58: using guessed type _QWORD gEHCI_GlobalLock;
// 18B60: using guessed type __int64 qword_18B60;
// 2DAD0: using guessed type int __cdecl IOLockAlloc(_QWORD);

//----- (00000000000052D0) ----------------------------------------------------
int `global destructor keyed to'_a_4()
{
  gEHCI_GlobalLock = off_17380;
  return IOLockFree(qword_18B60);
}
// 17380: using guessed type __int64 (__fastcall *off_17380[2])(AppleUSBEHCI_IOLockClass *__hidden this);
// 18B58: using guessed type _QWORD gEHCI_GlobalLock;
// 18B60: using guessed type __int64 qword_18B60;
// 2DAD8: using guessed type int __fastcall IOLockFree(_QWORD);

//----- (00000000000052F0) ----------------------------------------------------
signed __int64 __fastcall AppleUSBEHCI::GetRootHubDeviceDescriptor(__int64 a1, void *a2)
{
  signed __int64 result; // rax@1
  __int64 v3; // [sp+8h] [bp-18h]@1
  __int64 v4; // [sp+10h] [bp-10h]@1
  __int16 v5; // [sp+18h] [bp-8h]@1

  v5 = 256;
  v4 = 72622745162483116LL;
  v3 = 4611967532092358930LL;
  result = 3758097085LL;
  if ( a2 )
  {
    bcopy(&v3, a2, 0x12uLL);
    result = 0LL;
  }
  return result;
}

//----- (000000000000533A) ----------------------------------------------------
signed __int64 __fastcall AppleUSBEHCI::GetRootHubDescriptor(__int64 a1, void *a2)
{
  void *v2; // r15@1
  __int64 v3; // r14@1
  unsigned int v4; // eax@1
  unsigned __int8 v5; // cl@1
  __int64 v6; // rbx@1
  __int64 v7; // r12@1
  OSMetaClassBase *v8; // rax@1
  __int64 v9; // rsi@1
  const OSMetaClass *v10; // rdx@1
  __int64 v11; // rcx@1
  unsigned int v12; // eax@1
  char *v13; // rcx@3
  signed __int64 v14; // rbx@3
  __int64 v15; // rdx@3
  char *v16; // rax@5
  __int64 v17; // rcx@5
  unsigned __int8 v18; // cl@7
  signed __int64 result; // rax@7
  __int64 v20; // rcx@9
  __int16 v21; // [sp+8h] [bp-48h]@1
  unsigned __int8 v22; // [sp+Ah] [bp-46h]@1
  __int16 v23; // [sp+Bh] [bp-45h]@1
  char v24; // [sp+Dh] [bp-43h]@1
  char v25; // [sp+Eh] [bp-42h]@1
  char v26; // [sp+Fh] [bp-41h]@3
  __int64 v27; // [sp+28h] [bp-28h]@1

  v2 = a2;
  v3 = off_16090[0];
  v27 = *(_QWORD *)off_16090[0];
  v21 = 10521;
  v4 = *(_DWORD *)(*(_QWORD *)(a1 + 696) + 4LL);
  v22 = *(_BYTE *)(a1 + 505);
  v5 = v22;
  v23 = (v4 >> 4) & 1;
  *(_BYTE *)(a1 + 2096) = 1;
  v24 = 50;
  v25 = 0;
  v6 = v5 >> 3;
  v7 = (unsigned int)(v6 + 1);
  LODWORD(v8) = (*(int (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(a1 + 488) + 696LL))(
                  *(_QWORD *)(a1 + 488),
                  "AAPL,device-internal");
  v9 = *(_QWORD *)off_16058[0];
  v11 = OSMetaClassBase::safeMetaCast(v8, *(const OSMetaClassBase **)off_16058[0], v10);
  v12 = 0;
  if ( v11 )
    v12 = (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v11 + 328LL))(v11, v9);
  v13 = &v26;
  v14 = v6 + 8;
  v15 = v7;
  do
  {
    *v13++ = v12;
    v12 >>= 8;
    --v15;
  }
  while ( v15 );
  v16 = (char *)&v21 + v14;
  v17 = v7;
  do
  {
    *v16++ = -1;
    --v17;
  }
  while ( v17 );
  v18 = v21 - 2 * (9 - v7);
  LOBYTE(v21) = v21 - 2 * (9 - v7);
  result = 3758097085LL;
  if ( v2 )
  {
    bcopy(&v21, v2, v18);
    result = 0LL;
  }
  v20 = *(_QWORD *)v3;
  return result;
}
// 16058: using guessed type _QWORD off_16058[16];
// 16090: using guessed type __int64 off_16090[9];
// 2DEC8: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000005446) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::GetRootHubConfDescriptor(__int64 a1, __int64 a2)
{
  signed int v2; // er14@1
  __int64 v4; // [sp+8h] [bp-38h]@1
  __int64 v5; // [sp+10h] [bp-30h]@1
  char v6; // [sp+18h] [bp-28h]@1
  __int64 v7; // [sp+20h] [bp-20h]@1
  __int16 v8; // [sp+28h] [bp-18h]@1

  v8 = 0;
  v7 = 6917530131449446922LL;
  v6 = 0;
  v5 = 72067493937546249LL;
  v4 = 2533309208921352LL;
  v2 = -536870211;
  if ( a2 )
  {
    if ( (unsigned __int8)(*(int (__fastcall **)(_QWORD, __int64 *, signed __int64))(*(_QWORD *)a2 + 360LL))(
                            a2,
                            &v7,
                            10LL) )
    {
      if ( (unsigned __int8)(*(int (__fastcall **)(__int64, __int64 *, signed __int64))(*(_QWORD *)a2 + 360LL))(
                              a2,
                              &v5,
                              9LL) )
      {
        v2 = -536870211;
        if ( (unsigned __int8)(*(int (__fastcall **)(__int64, __int64 *, signed __int64))(*(_QWORD *)a2 + 360LL))(
                                a2,
                                &v4,
                                8LL) )
          v2 = 0;
      }
    }
  }
  return (unsigned int)v2;
}

//----- (00000000000054F8) ----------------------------------------------------
__int64 AppleUSBEHCI::SetRootHubDescriptor()
{
  return 0LL;
}

//----- (0000000000005500) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::GetRootHubStatus(__int64 a1, __int64 a2)
{
  *(_DWORD *)a2 = 0;
  return 0LL;
}

//----- (000000000000550E) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::SetRootHubFeature(AppleUSBEHCI *this)
{
  return 0LL;
}

//----- (0000000000005516) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::ClearRootHubFeature(AppleUSBEHCI *this)
{
  return 0LL;
}

//----- (000000000000551E) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::GetRootHubPortStatus(AppleUSBEHCI *this, __int64 a2, unsigned __int16 a3)
{
  unsigned __int16 v3; // r15@1
  __int64 result; // rax@1
  __int64 v5; // r12@3
  unsigned int v6; // er13@4
  __int16 v7; // r8@5
  int v8; // ecx@5
  bool v9; // zf@6
  signed __int16 v10; // r8@6
  int v11; // edx@11
  int v12; // eax@11
  int v13; // er9@11
  int v14; // er14@13

  v3 = a3;
  result = 3758097133LL;
  if ( *((_BYTE *)this + 440) != 1 )
  {
    if ( *((_BYTE *)this + 444) )
    {
      v5 = (unsigned __int16)(a3 - 1);
      result = 3758097090LL;
      if ( (unsigned int)v5 <= 0xE )
      {
        v6 = *(_DWORD *)(*((_QWORD *)this + 88) + 4 * v5 + 68);
        if ( v6 == -1 )
        {
          *((_BYTE *)this + 444) = 0;
          result = 3758097133LL;
        }
        else
        {
          v7 = v6 & 1;
          *(_WORD *)a2 = (v6 >> 4) & 0x100 | (v6 >> 4) & 0x10 | (v6 >> 1) & 8 | (v6 >> 5) & 4 | v7 | (v6 >> 1) & 2 | 0x400;
          v8 = v6 ^ *((_DWORD *)this + v5 + 456);
          if ( v6 & 2 )
          {
            v9 = v7 == 0;
            v10 = 1;
            if ( v9 && v8 & 0x80 )
              *((_BYTE *)this + 4 * v5 + 1884) |= 4u;
          }
          else
          {
            v10 = 0;
          }
          v11 = *((_DWORD *)this + v5 + 471);
          v12 = *((_DWORD *)this + v5 + 471) & 4;
          v13 = (v6 >> 2) & 8;
          if ( BYTE1(v8) & 1 )
          {
            v11 |= 0x10u;
            *((_DWORD *)this + v5 + 471) = v11;
          }
          v14 = v11 & 0x10 | (v6 >> 2) & 0xA | (unsigned __int16)v10 | (signed __int16)v12;
          if ( (_WORD)v13 && *(_BYTE *)(*((_QWORD *)this + 84) + 209LL) & 0x40 )
          {
            IOSleep(10LL);
            if ( !(*(_DWORD *)(*((_QWORD *)this + 88) + 4 * v5 + 68) & 0x10) )
            {
              LOWORD(v14) = v14 & 0x17;
              AppleUSBEHCI::EHCIRootHubResetOverCurrentChange(this, v3);
            }
          }
          *(_WORD *)(a2 + 2) = v14;
          *((_DWORD *)this + v5 + 456) = v6;
          result = 0LL;
        }
      }
    }
  }
  return result;
}
// 2DB30: using guessed type int __fastcall IOSleep(_QWORD);

//----- (00000000000056AC) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::EHCIRootHubResetOverCurrentChange(AppleUSBEHCI *this, unsigned int a2)
{
  __int64 v2; // rax@1
  unsigned int v3; // er12@1
  signed int v4; // ebx@3
  bool v5; // cf@5

  v2 = *((_QWORD *)this + 88);
  v3 = *(_DWORD *)(v2 + 4LL * (signed __int16)a2 + 64) & 0xFFFFFFD5 | 0x20;
  *(_DWORD *)(v2 + 4LL * a2 + 64) = v3;
  _mm_mfence();
  if ( *(_BYTE *)(*((_QWORD *)this + 84) + 209LL) & 4 && *(_DWORD *)(*((_QWORD *)this + 88) + 4LL * a2 + 64) & 0x20 )
  {
    v4 = 1;
    do
    {
      KernelDebugLogInternal(1LL, 1431519814LL, "EHCI driver - OC Change bit not clearing. Retrying");
      *(_DWORD *)(*((_QWORD *)this + 88) + 4LL * a2 + 64) = v3;
      _mm_mfence();
      if ( !(*(_DWORD *)(*((_QWORD *)this + 88) + 4LL * a2 + 64) & 0x20) )
        break;
      v5 = (unsigned int)v4++ < 0xA;
    }
    while ( v5 );
  }
  return 0LL;
}
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (000000000000575A) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::SetRootHubPortFeature(AppleUSBEHCI *this, int a2, unsigned __int16 a3)
{
  __int64 result; // rax@1

  result = 3758097095LL;
  switch ( a2 )
  {
    case 1:
      result = AppleUSBEHCI::EHCIRootHubPortEnable((uintptr_t)this, a3, 1);
      break;
    case 2:
      AppleUSBEHCI::EHCIRootHubPortSuspend((uintptr_t)this, a3, 1);
      goto LABEL_6;
    case 4:
      result = AppleUSBEHCI::EHCIRootHubResetPort((uintptr_t)this, a3);
      break;
    case 8:
      AppleUSBEHCI::EHCIRootHubPortPower(this, a3, 1);
LABEL_6:
      result = 0LL;
      break;
    default:
      return result;
  }
  return result;
}

//----- (00000000000057D4) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::EHCIRootHubPortSuspend(uintptr_t arg1, uintptr_t arg2, char a3)
{
  char v3; // r15@1
  uintptr_t v4; // r14@1
  unsigned int v5; // er13@6
  int v6; // er13@7
  signed int v7; // er15@9
  signed int v8; // edx@10
  int v9; // er12@13
  uintptr_t v10; // r13@13
  int v11; // er14@13
  bool v12; // zf@13
  bool v13; // cf@14
  __int64 v14; // rdi@16
  char v16; // [sp+0h] [bp-30h]@7
  signed int v17; // [sp+4h] [bp-2Ch]@12

  v3 = a3;
  v4 = arg1;
  if ( *(_BYTE *)((unsigned int)arg2 + arg1 + 1943) )
  {
    if ( !a3 )
      return 0LL;
    if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D500Cu, arg1, (unsigned int)arg2, 1uLL, 1uLL, 0LL);
  }
  v5 = *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 4LL * (signed __int16)arg2 + 64) & 0xFFFFFFD5;
  if ( v3 )
  {
    v16 = v3;
    v6 = v5 | 0x80;
    *(_DWORD *)(arg1 + 4LL * (unsigned int)arg2 + 1820) = v6;
  }
  else
  {
    v16 = 0;
    v6 = v5 | 0x40;
  }
  *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 4LL * (unsigned int)arg2 + 64) = v6;
  _mm_mfence();
  v7 = 1;
  IOSleep(1LL);
  if ( *(_BYTE *)(*(_QWORD *)(arg1 + 672) + 209LL) & 4 )
  {
    v8 = 64;
    if ( v16 )
      v8 = 128;
    v17 = v8;
    if ( !(v8 & *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 4LL * (unsigned int)arg2 + 64)) )
    {
      do
      {
        KernelDebugLogInternal(1LL, 1431519814LL, "EHCI driver - PortSuspend did not stick. Retrying");
        *(_DWORD *)(*(_QWORD *)(v4 + 704) + 4LL * (unsigned int)arg2 + 64) = v6;
        _mm_mfence();
        v9 = v6;
        v10 = v4;
        v11 = *(_DWORD *)(*(_QWORD *)(v4 + 704) + 4LL * (unsigned int)arg2 + 64);
        IOSleep(1LL);
        v12 = (v11 & v17) == 0;
        v4 = v10;
        v6 = v9;
        if ( !v12 )
          break;
        v13 = (unsigned int)v7++ < 0xA;
      }
      while ( v13 );
    }
  }
  if ( !v16 )
  {
    *(_BYTE *)(v4 + (unsigned int)arg2 + 1943) = 1;
    v14 = *(_QWORD *)(v4 + 8LL * (unsigned int)arg2 + 1952);
    if ( v14 )
    {
      thread_call_enter1(v14, (unsigned int)arg2);
    }
    else if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    {
      kernel_debug(0x52D500Cu, v4, (unsigned int)arg2, 0LL, 2uLL, 0LL);
    }
  }
  return 0LL;
}
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];
// 2DB30: using guessed type int __fastcall IOSleep(_QWORD);
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);
// 2E9F0: using guessed type int __fastcall thread_call_enter1(_QWORD, _QWORD);

//----- (0000000000005988) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::EHCIRootHubResetPort(uintptr_t arg1, unsigned __int16 a2)
{
  __int64 v2; // rax@1
  int v3; // er15@1
  signed int v4; // er13@3
  unsigned int v5; // er15@7
  signed int v6; // ebx@7
  int v7; // eax@8
  int v8; // eax@9
  bool v9; // cf@10
  unsigned int v10; // er15@15
  signed int v11; // er13@17
  int v12; // er13@20
  signed int v13; // er15@21
  uintptr_t v14; // rbx@22
  __int64 v15; // rax@25
  __int64 v16; // rax@32
  int v17; // et1@32
  unsigned int v18; // er15@37
  int v19; // er15@40
  signed int v20; // ebx@40
  int v21; // eax@41
  int v22; // eax@42
  unsigned int v24; // [sp+14h] [bp-2Ch]@20

  ++*(_DWORD *)(arg1 + 2844);
  v2 = *(_QWORD *)(arg1 + 704);
  v3 = *(_DWORD *)(v2 + 4LL * (signed __int16)a2 + 64);
  if ( (*(_DWORD *)(v2 + 4LL * (signed __int16)a2 + 64) & 0x1001) == 4097 )
  {
    if ( (*(_DWORD *)(v2 + 4LL * (signed __int16)a2 + 64) & 0xC00) == 1024 )
    {
      v4 = -536854455;
      if ( !(*(_BYTE *)(*(_QWORD *)(arg1 + 672) + 210LL) & 0x40) )
      {
        if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
          kernel_debug(0x52D2820u, arg1, 0LL, 0LL, 0LL, 0LL);
        v5 = v3 & 0xFFDFDFD5 | 0x2000;
        *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 4LL * a2 + 64) = v5;
        _mm_mfence();
        v6 = 1;
        IOSleep(1LL);
        if ( *(_BYTE *)(*(_QWORD *)(arg1 + 672) + 209LL) & 4 )
        {
          v7 = *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 4LL * a2 + 64);
          if ( !(BYTE1(v7) & 0x20) )
          {
            do
            {
              KernelDebugLogInternal(
                1LL,
                1431519814LL,
                "EHCI driver - PortSC_Owner (LS device) bit not sticking. Retrying");
              *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 4LL * a2 + 64) = v5;
              _mm_mfence();
              IOSleep(1LL);
              v8 = *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 4LL * a2 + 64);
              if ( BYTE1(v8) & 0x20 )
                break;
              v9 = (unsigned int)v6++ < 0xA;
            }
            while ( v9 );
          }
        }
        goto LABEL_44;
      }
    }
    else
    {
      v10 = v3 & 0xFFFFFED1 | 0x100;
      *(_DWORD *)(v2 + 4LL * a2 + 64) = v10;
      _mm_mfence();
      if ( *(_BYTE *)(*(_QWORD *)(arg1 + 672) + 209LL) & 4
        && (*(_DWORD *)(*(_QWORD *)(arg1 + 704) + 4LL * a2 + 64) & 0x104) != 256 )
      {
        v11 = 1;
        do
        {
          KernelDebugLogInternal(1LL, 1431519814LL, "EHCI driver - Reset and enabled bits not sticking. Retrying");
          *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 4LL * a2 + 64) = v10;
          _mm_mfence();
          if ( (unsigned int)v11 > 9 )
            break;
          ++v11;
        }
        while ( (*(_DWORD *)(*(_QWORD *)(arg1 + 704) + 4LL * a2 + 64) & 0x104) != 256 );
      }
      IOSleep(10LL);
      v24 = *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 4LL * (signed __int16)a2 + 64) & 0xFFFFFED5;
      v12 = 0;
LABEL_21:
      *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 4LL * a2 + 64) = v24;
      _mm_mfence();
      IOSleep(2LL);
      v13 = -1;
      while ( 1 )
      {
        IOSleep(1LL);
        v14 = *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 4LL * a2 + 64);
        if ( !(BYTE1(v14) & 1) )
          break;
        ++v13;
        if ( (unsigned int)v13 >= 0x7D1 )
        {
          KernelDebugLogInternal(1LL, 1431519814LL, "EHCIRootHubResetPort - clear reset didn't take - retrying");
          v9 = (unsigned int)v12++ < 0xA;
          if ( v9 )
            goto LABEL_21;
          break;
        }
      }
      IOSleep(1LL);
      v15 = *(_QWORD *)(arg1 + 704);
      if ( (_DWORD)v14 != *(_DWORD *)(v15 + 4LL * a2 + 64) )
      {
        if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
          kernel_debug(0x52D5004u, arg1, v14, *(_DWORD *)(v15 + 4LL * a2 + 64), 2uLL, 0LL);
        LODWORD(v14) = *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 4LL * a2 + 64);
      }
      if ( (v14 & 0x1001) == 4097 )
      {
        *(_BYTE *)(arg1 + 4LL * a2 + 1880) |= 0x10u;
        if ( v14 & 4 )
        {
          IOSleep(1LL);
          IOSleep(1LL);
          v16 = *(_QWORD *)(arg1 + 704);
          v17 = *(_DWORD *)(v16 + 4LL * a2 + 64);
          *(_DWORD *)(v16 + 4LL * a2 + 64) = *(_DWORD *)(v16 + 4LL * (signed __int16)a2 + 64) & 0xFFDFFFD5 | 0x200000;
          _mm_mfence();
          v4 = 0;
        }
        else
        {
          v4 = -536854455;
          if ( !(*(_BYTE *)(*(_QWORD *)(arg1 + 672) + 210LL) & 0x40) )
          {
            v18 = *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 4LL * (signed __int16)a2 + 64) & 0xFFDFDFD5;
            if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
              kernel_debug(0x52D2824u, arg1, (unsigned int)v14, 0LL, 0LL, 0LL);
            v19 = v18 | 0x2000;
            *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 4LL * a2 + 64) = v19;
            _mm_mfence();
            v20 = 1;
            IOSleep(1LL);
            if ( *(_BYTE *)(*(_QWORD *)(arg1 + 672) + 209LL) & 4 )
            {
              v21 = *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 4LL * a2 + 64);
              if ( !(BYTE1(v21) & 0x20) )
              {
                do
                {
                  KernelDebugLogInternal(
                    1LL,
                    1431519814LL,
                    "EHCI driver - PortSC_Owner (FS device) bit not sticking. Retrying");
                  *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 4LL * a2 + 64) = v19;
                  _mm_mfence();
                  IOSleep(1LL);
                  v22 = *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 4LL * a2 + 64);
                  if ( BYTE1(v22) & 0x20 )
                    break;
                  v9 = (unsigned int)v20++ < 0xA;
                }
                while ( v9 );
LABEL_44:
                v4 = -536854455;
                return (unsigned int)v4;
              }
            }
          }
        }
      }
      else
      {
        v4 = -536870163;
        if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
          kernel_debug(0x52D5004u, arg1, a2, (unsigned int)v14, 3uLL, 0LL);
      }
    }
  }
  else
  {
    v4 = -536870163;
    if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D5004u, arg1, a2, v3 & 0xFFFFFFD5, 1uLL, 0LL);
  }
  return (unsigned int)v4;
}
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];
// 2DB30: using guessed type int __fastcall IOSleep(_QWORD);
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (0000000000005E70) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::EHCIRootHubPortEnable(uintptr_t arg1, unsigned __int16 a2, char a3)
{
  signed int v3; // ebx@2
  __int64 v4; // rax@5
  unsigned int v5; // er12@5
  signed int v6; // er15@7
  bool v7; // cf@9

  if ( a3 )
  {
    v3 = -536870201;
    if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D5008u, arg1, a2, 1uLL, 0xFFFFFFFFE00002C7LL, 0LL);
  }
  else
  {
    v4 = *(_QWORD *)(arg1 + 704);
    v5 = *(_DWORD *)(v4 + 4LL * (signed __int16)a2 + 64) & 0xFFFFFFD1;
    *(_DWORD *)(v4 + 4LL * a2 + 64) = v5;
    _mm_mfence();
    v3 = 0;
    if ( *(_BYTE *)(*(_QWORD *)(arg1 + 672) + 209LL) & 4 )
    {
      IOSleep(3LL);
      if ( *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 4LL * a2 + 64) & 4 )
      {
        v6 = 1;
        do
        {
          v3 = 0;
          KernelDebugLogInternal(1LL, 1431519814LL, "EHCI driver - PortEnable did not disable. Retrying");
          *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 4LL * a2 + 64) = v5;
          _mm_mfence();
          if ( !(*(_DWORD *)(*(_QWORD *)(arg1 + 704) + 4LL * a2 + 64) & 4) )
            break;
          v7 = (unsigned int)v6++ < 0xA;
        }
        while ( v7 );
      }
    }
  }
  return (unsigned int)v3;
}
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];
// 2DB30: using guessed type int __fastcall IOSleep(_QWORD);
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (0000000000005F7A) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::EHCIRootHubPortPower(AppleUSBEHCI *this, unsigned __int16 a2, char a3)
{
  char v3; // r14@1
  __int64 v4; // rax@1
  int v5; // er12@1
  unsigned int v6; // er12@2
  int v7; // eax@3
  signed int v8; // er15@4
  int v9; // eax@5
  bool v10; // cf@6
  signed __int64 v11; // rbx@7
  unsigned int v12; // er12@7
  unsigned int v13; // er15@10
  int v14; // eax@12
  bool v15; // cl@13
  int v16; // eax@15

  v3 = a3;
  v4 = *((_QWORD *)this + 88);
  v5 = *(_DWORD *)(v4 + 4LL * (signed __int16)a2 + 64);
  if ( a3 )
  {
    v6 = v5 & 0xFFFFFFD5;
    *(_DWORD *)(v4 + 4LL * a2 + 64) = v6 | 0x1000;
    _mm_mfence();
    if ( *(_BYTE *)(*((_QWORD *)this + 84) + 209LL) & 4 )
    {
      v7 = *(_DWORD *)(*((_QWORD *)this + 88) + 4LL * a2 + 64);
      if ( !(BYTE1(v7) & 0x10) )
      {
        v8 = 1;
        do
        {
          KernelDebugLogInternal(1LL, 1431519814LL, "EHCI driver - PortPower bit not sticking. Retrying");
          *(_DWORD *)(*((_QWORD *)this + 88) + 4LL * a2 + 64) = v6 | 0x1000;
          _mm_mfence();
          v9 = *(_DWORD *)(*((_QWORD *)this + 88) + 4LL * a2 + 64);
          if ( BYTE1(v9) & 0x10 )
            break;
          v10 = (unsigned int)v8++ < 0xA;
        }
        while ( v10 );
      }
    }
    v11 = a2 - 1LL;
    v12 = v6 | 0x301000;
  }
  else
  {
    v12 = v5 & 0xFFCFEFD5;
    v11 = a2 - 1LL;
  }
  *(_DWORD *)(*((_QWORD *)this + 88) + 4 * v11 + 68) = v12;
  _mm_mfence();
  if ( *(_BYTE *)(*((_QWORD *)this + 84) + 209LL) & 4 )
  {
    v13 = 0;
    while ( 1 )
    {
      v14 = *(_DWORD *)(*((_QWORD *)this + 88) + 4 * v11 + 68);
      if ( v3 )
      {
        v15 = 1;
        if ( v14 & 0x100000 )
          v15 = (v14 & 0x200000) == 0;
        v16 = v15;
      }
      else
      {
        v16 = v14 & 0x1000;
      }
      if ( !v16 || v13 > 9 )
        break;
      ++v13;
      KernelDebugLogInternal(1LL, 1431519814LL, "EHCI driver - PortPower end bits not sticking. Retrying");
      *(_DWORD *)(*((_QWORD *)this + 88) + 4 * v11 + 68) = v12;
      _mm_mfence();
    }
  }
  return 0LL;
}
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (00000000000060DA) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::EHCIRootHubPower(AppleUSBEHCI *this)
{
  return 0LL;
}

//----- (00000000000060E2) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::ClearRootHubPortFeature(AppleUSBEHCI *this, int a2, unsigned __int16 a3)
{
  signed int v3; // ebx@1
  unsigned __int16 v5; // dx@8
  unsigned __int16 v6; // dx@11

  v3 = -536870201;
  switch ( a2 )
  {
    case 1:
      return AppleUSBEHCI::EHCIRootHubPortEnable((uintptr_t)this, a3, 0);
    case 2:
      v3 = 0;
      AppleUSBEHCI::EHCIRootHubPortSuspend((uintptr_t)this, a3, 0);
      return (unsigned int)v3;
    case 8:
      if ( !(*(_BYTE *)(*((_QWORD *)this + 84) + 210LL) & 0x80) )
      {
        v3 = 0;
        AppleUSBEHCI::EHCIRootHubPortPower(this, a3, 0);
      }
      return (unsigned int)v3;
    case 16:
      AppleUSBEHCI::EHCIRootHubResetChangeConnection(this, a3);
      goto LABEL_13;
    case 17:
      AppleUSBEHCI::EHCIRootHubResetEnableChange(this, a3);
      goto LABEL_13;
    case 18:
      v5 = a3 - 1;
      v3 = -536870206;
      if ( v5 > 0xEu )
        return (unsigned int)v3;
      *((_BYTE *)this + 4 * v5 + 1884) &= 0xFBu;
      _mm_mfence();
      goto LABEL_13;
    case 19:
      AppleUSBEHCI::EHCIRootHubResetOverCurrentChange(this, a3);
      goto LABEL_13;
    case 20:
      v6 = a3 - 1;
      v3 = -536870206;
      if ( v6 <= 0xEu )
      {
        *((_BYTE *)this + 4 * v6 + 1884) &= 0xEFu;
LABEL_13:
        v3 = 0;
      }
      break;
    default:
      return (unsigned int)v3;
  }
  return (unsigned int)v3;
}

//----- (00000000000061F0) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::EHCIRootHubResetChangeConnection(AppleUSBEHCI *this, unsigned int a2)
{
  __int64 v2; // rax@1
  unsigned int v3; // er12@1
  signed int v4; // ebx@3
  bool v5; // cf@5

  v2 = *((_QWORD *)this + 88);
  v3 = *(_DWORD *)(v2 + 4LL * (signed __int16)a2 + 64) & 0xFFFFFFD5 | 2;
  *(_DWORD *)(v2 + 4LL * a2 + 64) = v3;
  _mm_mfence();
  if ( *(_BYTE *)(*((_QWORD *)this + 84) + 209LL) & 4 && *(_DWORD *)(*((_QWORD *)this + 88) + 4LL * a2 + 64) & 2 )
  {
    v4 = 1;
    do
    {
      KernelDebugLogInternal(1LL, 1431519814LL, "EHCI driver - Connect Change bit not clearing. Retrying");
      *(_DWORD *)(*((_QWORD *)this + 88) + 4LL * a2 + 64) = v3;
      _mm_mfence();
      if ( !(*(_DWORD *)(*((_QWORD *)this + 88) + 4LL * a2 + 64) & 2) )
        break;
      v5 = (unsigned int)v4++ < 0xA;
    }
    while ( v5 );
  }
  return 0LL;
}
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (000000000000629E) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::EHCIRootHubResetEnableChange(AppleUSBEHCI *this, unsigned int a2)
{
  __int64 v2; // rax@1
  unsigned int v3; // er12@1
  signed int v4; // ebx@3
  bool v5; // cf@5

  v2 = *((_QWORD *)this + 88);
  v3 = *(_DWORD *)(v2 + 4LL * (signed __int16)a2 + 64) & 0xFFFFFFD5 | 8;
  *(_DWORD *)(v2 + 4LL * a2 + 64) = v3;
  _mm_mfence();
  if ( *(_BYTE *)(*((_QWORD *)this + 84) + 209LL) & 4 && *(_DWORD *)(*((_QWORD *)this + 88) + 4LL * a2 + 64) & 8 )
  {
    v4 = 1;
    do
    {
      KernelDebugLogInternal(1LL, 1431519814LL, "EHCI driver - Enable Change bit not clearing. Retrying");
      *(_DWORD *)(*((_QWORD *)this + 88) + 4LL * a2 + 64) = v3;
      _mm_mfence();
      if ( !(*(_DWORD *)(*((_QWORD *)this + 88) + 4LL * a2 + 64) & 8) )
        break;
      v5 = (unsigned int)v4++ < 0xA;
    }
    while ( v5 );
  }
  return 0LL;
}
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (000000000000634C) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::EHCIRootHubResetSuspendChange(AppleUSBEHCI *this, __int16 a2)
{
  unsigned __int16 v2; // si@1
  __int64 result; // rax@1

  v2 = a2 - 1;
  result = 3758097090LL;
  if ( v2 <= 0xEu )
  {
    *((_BYTE *)this + 4 * v2 + 1884) &= 0xFBu;
    _mm_mfence();
    result = 0LL;
  }
  return result;
}

//----- (000000000000636E) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::EHCIRootHubResetResetChange(AppleUSBEHCI *this, __int16 a2)
{
  unsigned __int16 v2; // si@1
  __int64 result; // rax@1

  v2 = a2 - 1;
  result = 3758097090LL;
  if ( v2 <= 0xEu )
  {
    *((_BYTE *)this + 4 * v2 + 1884) &= 0xEFu;
    result = 0LL;
  }
  return result;
}

//----- (000000000000638E) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::GetRootHubPortState(AppleUSBEHCI *this, unsigned __int8 *a2)
{
  return 0LL;
}

//----- (0000000000006396) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::SetHubAddress(AppleUSBEHCI *this, __int16 a2)
{
  *((_WORD *)this + 856) = a2;
  return 0LL;
}

//----- (00000000000063A5) ----------------------------------------------------
__int64 __fastcall getPortSCForWriting(__int64 a1, int a2)
{
  return *(_DWORD *)(a1 + 4LL * a2 + 64) & 0xFFFFFFD5;
}

//----- (00000000000063B6) ----------------------------------------------------
int __fastcall AppleUSBEHCI::EHCIMuxedPortDeviceDisconnected(AppleUSBEHCI *this, char *a2)
{
  AppleUSBEHCI *v2; // rcx@1
  __int64 v3; // rdi@1
  int result; // eax@2

  v2 = this;
  v3 = *((_QWORD *)this + 5002);
  if ( v3 )
    result = (*(int (__fastcall **)(__int64, signed __int64, _QWORD, char *))(*(_QWORD *)v3 + 1840LL))(
               v3,
               3758112795LL,
               *((_QWORD *)v2 + 61),
               a2);
  else
    result = 0;
  return result;
}

//----- (00000000000063EE) ----------------------------------------------------
int AppleUSBEHCI::waitForSOF()
{
  return IOSleep(1LL);
}
// 2DB30: using guessed type int __fastcall IOSleep(_QWORD);

//----- (00000000000063FE) ----------------------------------------------------
void __fastcall AppleUSBEHCI::UIMRootHubStatusChange(AppleUSBEHCI *this)
{
  ;
}

//----- (0000000000006404) ----------------------------------------------------
void __fastcall AppleUSBEHCI::UIMRootHubStatusChange(AppleUSBEHCI *this)
{
  __int16 v1; // r15@4
  __int64 v2; // rax@6
  signed __int16 v3; // r13@7
  unsigned int v4; // ebx@7
  char v5; // [sp+8h] [bp-38h]@7
  int v6; // [sp+Ch] [bp-34h]@3
  char v7; // [sp+10h] [bp-30h]@8
  __int16 v8; // [sp+12h] [bp-2Eh]@11

  if ( !*((_BYTE *)this + 444)
    || *((_BYTE *)this + 441)
    || (AppleUSBEHCI::RHCheckForPortResumes(this),
        (*(int (__fastcall **)(AppleUSBEHCI *, int *))(*(_QWORD *)this + 2288LL))(this, &v6)) )
  {
    v1 = 0;
  }
  else
  {
    v1 = (v6 & 3) != 0;
    v2 = *(_DWORD *)(*((_QWORD *)this + 87) + 4LL);
    if ( *((_BYTE *)this + 505) )
    {
      v3 = 2;
      v4 = 1;
      v5 = 0;
      do
      {
        if ( !(*(int (__fastcall **)(AppleUSBEHCI *, char *, _QWORD))(*(_QWORD *)this + 2312LL))(
                this,
                &v7,
                (unsigned __int16)v4) )
        {
          if ( *((_BYTE *)this + 2096) && v5 & 1 && v8 & 8 )
          {
            v8 &= 0xFFF7u;
            AppleUSBEHCI::EHCIRootHubResetOverCurrentChange(this, (unsigned __int16)v4);
          }
          if ( v8 & 0x1F )
          {
            if ( v8 & 8 )
              v5 = 1;
            v1 |= v3;
          }
        }
        ++v4;
        v3 *= 2;
      }
      while ( v4 <= *((_BYTE *)this + 505) );
    }
  }
  *((_WORD *)this + 253) = v1;
}

//----- (000000000000650E) ----------------------------------------------------
void __fastcall AppleUSBEHCI::RHCheckForPortResumes(AppleUSBEHCI *this)
{
  AppleUSBEHCI *v1; // r14@1
  __int64 v2; // rbx@3
  int v3; // eax@5
  __int64 v4; // rdi@7

  v1 = this;
  if ( *((_BYTE *)this + 444) && *((_BYTE *)this + 505) )
  {
    LODWORD(v2) = 0;
    do
    {
      v2 = (unsigned int)v2;
      if ( !*((_BYTE *)v1 + (unsigned int)v2 + 1944) )
      {
        v3 = *(_DWORD *)(*((_QWORD *)v1 + 88) + 4 * v2 + 68);
        if ( v3 == -1 )
        {
          *((_BYTE *)v1 + 444) = 0;
          return;
        }
        if ( v3 & 0x40 )
        {
          *((_BYTE *)v1 + v2 + 1944) = 1;
          v4 = *((_QWORD *)v1 + v2 + 245);
          if ( v4 )
            thread_call_enter1(v4, (unsigned int)(v2 + 1));
        }
      }
      LODWORD(v2) = v2 + 1;
    }
    while ( (unsigned int)v2 < *((_BYTE *)v1 + 505) );
  }
}
// 2E9F0: using guessed type int __fastcall thread_call_enter1(_QWORD, _QWORD);

//----- (000000000000658A) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::SimulateEDDelete(AppleUSBEHCI *this, __int16 a2, __int16 a3)
{
  __int64 result; // rax@1

  result = 0LL;
  if ( a2 == 1 )
  {
    result = 3758097097LL;
    if ( a3 == 1 )
    {
      (*(void (**)(void))(*(_QWORD *)this + 3000LL))();
      result = 0LL;
    }
  }
  return result;
}

//----- (00000000000065B2) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::SimulateEDAbort(AppleUSBEHCI *this, __int16 a2, __int16 a3)
{
  __int64 result; // rax@1

  result = 0LL;
  if ( a2 == 1 )
  {
    result = 3758097097LL;
    if ( a3 == 1 )
    {
      (*(void (**)(void))(*(_QWORD *)this + 3000LL))();
      result = 0LL;
    }
  }
  return result;
}

//----- (00000000000065DA) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::GetRootHubStringDescriptor(__int64 a1, char a2, __int64 a3)
{
  __int64 v3; // rax@1
  __int64 v4; // r14@1
  signed int v5; // ebx@1
  __int64 v6; // rcx@4
  signed __int64 v7; // rdx@4
  __int64 *v8; // rsi@4
  __int64 result; // rax@10
  __int64 v10; // [sp+0h] [bp-70h]@1
  __int64 v11; // [sp+8h] [bp-68h]@1
  int v12; // [sp+10h] [bp-60h]@1
  __int16 v13; // [sp+14h] [bp-5Ch]@1
  __int64 v14; // [sp+20h] [bp-50h]@1
  __int64 v15; // [sp+28h] [bp-48h]@1
  __int64 v16; // [sp+30h] [bp-40h]@1
  __int64 v17; // [sp+38h] [bp-38h]@1
  __int64 v18; // [sp+40h] [bp-30h]@1
  __int64 v19; // [sp+48h] [bp-28h]@1
  __int16 v20; // [sp+50h] [bp-20h]@1
  __int64 v21; // [sp+58h] [bp-18h]@1

  v3 = a3;
  v4 = off_16090[0];
  v21 = *(_QWORD *)off_16090[0];
  v19 = 31244173394051169LL;
  v18 = 30399800003068009LL;
  v17 = 23362560512360565LL;
  v16 = 20266335769722991LL;
  v15 = 31244074604298313LL;
  v14 = 18859132681782016LL;
  v20 = 110;
  v11 = 20547810745450604LL;
  v10 = 31525678432191232LL;
  v13 = 46;
  v12 = 6488174;
  v5 = -536870206;
  if ( (unsigned __int8)(a2 - 1) > 1u )
    goto LABEL_10;
  LOBYTE(v10) = 22;
  LOBYTE(v14) = 50;
  if ( a2 == 2 )
  {
    v5 = -536870211;
    if ( !a3 )
      goto LABEL_10;
    v6 = *(_QWORD *)a3;
    v7 = (unsigned __int8)v10;
    v8 = &v10;
    goto LABEL_8;
  }
  if ( a2 == 1 )
  {
    v5 = -536870211;
    if ( !a3 )
      goto LABEL_10;
    v6 = *(_QWORD *)a3;
    v8 = &v14;
    v7 = 50LL;
LABEL_8:
    if ( !(unsigned __int8)(*(int (__fastcall **)(__int64, __int64 *, signed __int64))(v6 + 360))(v3, v8, v7) )
      goto LABEL_10;
  }
  v5 = 0;
LABEL_10:
  result = *(_QWORD *)v4;
  if ( *(_QWORD *)v4 == v21 )
    result = (unsigned int)v5;
  return result;
}
// 16090: using guessed type __int64 off_16090[9];

//----- (00000000000066F6) ----------------------------------------------------
uint64_t __fastcall AppleUSBEHCI::LastRootHubPortStatusChanged(AppleUSBEHCI *this, char a2)
{
  uint64_t result; // rax@2

  if ( a2 )
  {
    result = mach_absolute_time();
    *((_QWORD *)this + 223) = result;
  }
  else
  {
    result = *((_QWORD *)this + 223);
  }
  return result;
}

//----- (0000000000006720) ----------------------------------------------------
unsigned __int8 __fastcall AppleUSBEHCI::GetNumberOfPorts(AppleUSBEHCI *this, unsigned __int8 *a2)
{
  unsigned __int8 result; // al@2

  if ( *((_BYTE *)this + 440) )
    result = *((_BYTE *)this + 505);
  else
    result = 0;
  *a2 = result;
  return result;
}

//----- (000000000000673C) ----------------------------------------------------
int __fastcall AppleUSBEHCI::RHResumePortTimerEntry(AppleUSBEHCI *this, OSObject *a2, void *a3)
{
  AppleUSBEHCI *v3; // rax@1

  v3 = (AppleUSBEHCI *)OSMetaClassBase::safeMetaCast(
                         this,
                         (const OSMetaClassBase *)AppleUSBEHCI::metaClass,
                         (const OSMetaClass *)a3);
  if ( v3 )
    LODWORD(v3) = AppleUSBEHCI::RHResumePortTimer(v3, (unsigned int)a2);
  return (signed int)v3;
}
// 173A0: using guessed type _QWORD AppleUSBEHCI::metaClass;
// 2DEC8: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000006770) ----------------------------------------------------
int __fastcall AppleUSBEHCI::RHResumePortTimer(AppleUSBEHCI *this, unsigned int a2)
{
  int result; // eax@2

  if ( *((_QWORD *)this + 18) )
  {
    IOSleep(20LL);
    (*(void (__fastcall **)(AppleUSBEHCI *))(*(_QWORD *)this + 2976LL))(this);
    result = (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(**((_QWORD **)this + 18) + 456LL))(
               *((_QWORD *)this + 18),
               AppleUSBEHCI::RHResumePortCompletionEntry,
               a2,
               0LL,
               0LL,
               0LL);
  }
  return result;
}
// 2DB30: using guessed type int __fastcall IOSleep(_QWORD);

//----- (00000000000067CC) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::RHResumePortCompletionEntry(AppleUSBEHCI *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  uintptr_t v6; // rax@1
  __int64 result; // rax@2

  v6 = OSMetaClassBase::safeMetaCast(this, (const OSMetaClassBase *)AppleUSBEHCI::metaClass, (const OSMetaClass *)a3);
  if ( v6 )
    result = AppleUSBEHCI::RHResumePortCompletion(v6, (unsigned int)a2);
  else
    result = 3758097097LL;
  return result;
}
// 173A0: using guessed type _QWORD AppleUSBEHCI::metaClass;
// 2DEC8: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000006806) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::RHResumePortCompletion(uintptr_t arg1, uintptr_t arg2)
{
  __int64 v2; // r13@1
  __int64 v3; // rax@3
  unsigned int v4; // er12@3
  signed int v5; // ebx@5
  int v6; // er14@6
  bool v7; // cf@7
  signed int v8; // er14@8

  v2 = (unsigned int)(arg2 - 1);
  if ( *(_BYTE *)(arg1 + v2 + 1944) )
  {
    if ( *(_BYTE *)(arg1 + 444) )
    {
      v3 = *(_QWORD *)(arg1 + 704);
      v4 = *(_DWORD *)(v3 + 4LL * (signed __int16)arg2 + 64) & 0xFFFFFF95;
      *(_DWORD *)(v3 + 4 * v2 + 68) = v4;
      _mm_mfence();
      IOSleep(2LL);
      if ( *(_BYTE *)(*(_QWORD *)(arg1 + 672) + 209LL) & 4 && *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 4 * v2 + 68) & 0x40 )
      {
        v5 = 1;
        do
        {
          KernelDebugLogInternal(1LL, 1431519814LL, "EHCI driver - PortSuspend reesume did not clear. Retrying");
          *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 4 * v2 + 68) = v4;
          _mm_mfence();
          v6 = *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 4 * v2 + 68);
          IOSleep(3LL);
          if ( !(v6 & 0x40) )
            break;
          v7 = (unsigned int)v5++ < 0xA;
        }
        while ( v7 );
      }
      *(_BYTE *)(arg1 + v2 + 1944) = 0;
      *(_BYTE *)(arg1 + 4 * v2 + 1884) |= 4u;
      (*(void (__fastcall **)(uintptr_t))(*(_QWORD *)arg1 + 2984LL))(arg1);
      v8 = 0;
    }
    else
    {
      *(_BYTE *)(arg1 + v2 + 1944) = 0;
      v8 = -536870199;
    }
  }
  else
  {
    v8 = -536870199;
    if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D5014u, arg1, (unsigned int)arg2, 0xFFFFFFFFE00002C9LL, 0LL, 0LL);
  }
  return (unsigned int)v8;
}
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];
// 2DB30: using guessed type int __fastcall IOSleep(_QWORD);
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (0000000000006954) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::RHCompleteResumeOnAllPorts(AppleUSBEHCI *this)
{
  AppleUSBEHCI *v1; // r15@1
  unsigned int v2; // ebx@2
  signed __int64 v3; // rdi@2
  unsigned __int8 v4; // cl@3
  __int64 v5; // r12@5
  __int64 v6; // rax@6
  unsigned int v7; // er13@6
  signed int v8; // er14@7
  bool v9; // cf@9
  __int64 result; // rax@13
  __int64 v11; // rdx@14
  unsigned __int8 v12; // cl@19
  __int64 v13; // rdx@20

  v1 = this;
  if ( *((_BYTE *)this + 444) )
  {
    v2 = 0;
    v3 = 0LL;
LABEL_3:
    v4 = *((_BYTE *)v1 + 505);
    while ( v2 < *((_BYTE *)v1 + 505) )
    {
      v5 = v2++;
      if ( *((_BYTE *)v1 + v5 + 1944) )
      {
        v6 = *((_QWORD *)v1 + 88);
        v7 = *(_DWORD *)(v6 + 4LL * (signed __int16)v2 + 64) & 0xFFFFFF95;
        *(_DWORD *)(v6 + 4 * v5 + 68) = v7;
        _mm_mfence();
        v3 = 2LL;
        if ( *(_BYTE *)(*((_QWORD *)v1 + 84) + 209LL) & 4 )
        {
          v8 = 1;
          if ( *(_DWORD *)(*((_QWORD *)v1 + 88) + 4 * v5 + 68) & 0x40 )
          {
            do
            {
              KernelDebugLogInternal(1LL, 1431519814LL, "EHCI driver - PortSuspend reesume did not clear. Retrying");
              *(_DWORD *)(*((_QWORD *)v1 + 88) + 4 * v5 + 68) = v7;
              _mm_mfence();
              v3 = 3LL;
              if ( !(*(_DWORD *)(*((_QWORD *)v1 + 88) + 4 * v5 + 68) & 0x40) )
                break;
              v9 = (unsigned int)v8++ < 0xA;
            }
            while ( v9 );
          }
        }
        goto LABEL_3;
      }
    }
    if ( (_DWORD)v3 )
    {
      IOSleep(v3);
      v4 = *((_BYTE *)v1 + 505);
    }
    result = 0LL;
    if ( v4 )
    {
      LODWORD(v11) = 0;
      do
      {
        v11 = (unsigned int)v11;
        if ( *((_BYTE *)v1 + (unsigned int)v11 + 1944) )
        {
          *((_BYTE *)v1 + v11 + 1944) = 0;
          *((_BYTE *)v1 + 4 * v11 + 1884) |= 4u;
          v4 = *((_BYTE *)v1 + 505);
        }
        LODWORD(v11) = v11 + 1;
      }
      while ( (unsigned int)v11 < v4 );
    }
  }
  else
  {
    v12 = *((_BYTE *)this + 505);
    result = 3758097097LL;
    if ( v12 )
    {
      LODWORD(v13) = 0;
      do
      {
        v13 = (unsigned int)v13;
        if ( *((_BYTE *)this + (unsigned int)v13 + 1944) )
        {
          *((_BYTE *)this + v13 + 1944) = 0;
          v12 = *((_BYTE *)this + 505);
        }
        LODWORD(v13) = v13 + 1;
      }
      while ( (unsigned int)v13 < v12 );
    }
  }
  return result;
}
// 2DB30: using guessed type int __fastcall IOSleep(_QWORD);
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (0000000000006AC4) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::MakeEmptyEndPoint(AppleUSBEHCI *this, unsigned __int64 a2, unsigned __int8 a3, unsigned __int16 a4, unsigned __int8 a5, unsigned __int16 a6, int a7, unsigned __int8 a8)
{
  unsigned __int16 v8; // r10@1
  unsigned __int8 v9; // r13@1
  unsigned __int8 v10; // r14@1
  AppleUSBEHCI *v11; // r12@1
  unsigned __int8 v12; // bl@1
  unsigned __int8 v13; // bl@3
  unsigned __int16 v14; // r12@3
  __int64 v15; // r15@9
  const OSMetaClass *v16; // rdx@9
  __int64 v17; // rbx@9
  __int64 v18; // r14@14
  unsigned __int8 v19; // bl@14
  __int64 v20; // rcx@17
  int v21; // er13@18
  unsigned __int8 v22; // di@19
  unsigned int v23; // eax@22
  int v24; // er12@22
  signed int v25; // esi@23
  AppleEHCItdMemoryBlock *v26; // rbx@24
  unsigned int v27; // er15@24
  __int64 v29; // [sp+0h] [bp-50h]@18
  __int64 v30; // [sp+8h] [bp-48h]@24
  unsigned __int16 arg1; // [sp+10h] [bp-40h]@4
  uintptr_t arg1a; // [sp+10h] [bp-40h]@19
  __int64 v33; // [sp+18h] [bp-38h]@9
  unsigned int v34; // [sp+20h] [bp-30h]@9
  unsigned __int16 v35; // [sp+24h] [bp-2Ch]@1

  v8 = a6;
  v9 = a5;
  v35 = a4;
  v10 = a3;
  v11 = this;
  v12 = a8;
  if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
  {
    v13 = a5;
    v14 = a6;
    kernel_debug(
      0x52D503Du,
      (uintptr_t)this,
      a8 | ((unsigned __int64)a5 << 16) | ((unsigned __int64)a4 << 32) | ((unsigned __int8)a2 << 24) | ((unsigned __int64)a3 << 8),
      a6,
      a7,
      0LL);
    v8 = v14;
    v11 = this;
    v9 = v13;
    v12 = a8;
  }
  arg1 = v8;
  if ( !v8 && v9 != 2 && *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    kernel_debug(
      0x52D503Cu,
      (uintptr_t)v11,
      v12 | ((unsigned __int64)v9 << 16) | ((unsigned __int64)v35 << 32) | ((unsigned __int8)a2 << 24) | ((unsigned __int64)v10 << 8),
      0LL,
      1uLL,
      0LL);
  a2 = (unsigned __int8)a2;
  v34 = (unsigned __int8)a2;
  v15 = v10;
  v33 = v12;
  v17 = AppleUSBEHCI::FindControlBulkEndpoint(v11, (unsigned __int8)a2, (const OSMetaClass *)v10, 0LL, v12);
  if ( v17 )
  {
    if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    {
      a2 = (unsigned __int64)v11;
      kernel_debug(
        0x52D503Cu,
        (uintptr_t)v11,
        v33
      + (((unsigned __int64)v9 << 16) | ((unsigned __int64)v35 << 32) | (signed int)(v34 << 24) | ((unsigned __int64)v10 << 8)),
        v17,
        2uLL,
        0LL);
    }
    *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v17) + 4) = -32769;
  }
  v18 = AppleUSBEHCI::AllocateQH((uintptr_t)v11, a2, v16);
  v19 = v9;
  if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    kernel_debug(
      0x52D503Cu,
      (uintptr_t)v11,
      v33
    + (((unsigned __int64)v9 << 16) | ((unsigned __int64)v35 << 32) | (signed int)(v34 << 24) | (unsigned __int64)(v15 << 8)),
      v18,
      3uLL,
      0LL);
  v20 = 0LL;
  if ( v18 )
  {
    v21 = arg1;
    v29 = v19;
    if ( v19 == 2 )
    {
      arg1a = (uintptr_t)v11;
      LODWORD(v20) = 0x2000;
      v22 = a8;
    }
    else
    {
      arg1a = (uintptr_t)v11;
      v22 = a8;
      if ( !v19 )
        LODWORD(v20) = 4096;
    }
    v23 = v35;
    v24 = 0x40000000;
    if ( v35 >= 0x401u )
    {
      v25 = (signed int)(v35 + ((unsigned int)((v35 - 1) >> 31) >> 22) - 1) >> 10;
      v23 = ((unsigned int)v35 + v25) / (v25 + 1);
      v24 = (v25 + 1) << 30;
    }
    *(_BYTE *)(v18 + 70) = v22;
    *(_WORD *)(v18 + 66) = v34;
    *(_WORD *)(v18 + 68) = v15;
    *(_BYTE *)(v18 + 73) = v19;
    *(_WORD *)(v18 + 64) = v23;
    *(_BYTE *)(v18 + 74) = 0;
    *(_WORD *)(v18 + 78) = 0;
    v30 = (_DWORD)v15 << 8;
    *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v18) + 4) = (v23 << 16) | v20 | v34 | ((_DWORD)v15 << 8);
    *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v18) + 8) = v24 | (v21 << 16) | (a7 << 23);
    *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v18) + 12) = 0;
    *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v18) + 20) = 1;
    *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v18) + 24) = 0;
    *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v18) + 28) = 0;
    *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v18) + 32) = 0;
    *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v18) + 36) = 0;
    *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v18) + 40) = 0;
    *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v18) + 44) = 0;
    *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v18) + 48) = 0;
    *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v18) + 52) = 0;
    *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v18) + 56) = 0;
    *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v18) + 60) = 0;
    *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v18) + 64) = 0;
    v26 = AppleUSBEHCI::AllocateTD((AppleUSBEHCI *)arg1a, v34);
    *(_DWORD *)(*(_QWORD *)v26 + 8LL) = 0;
    **(_DWORD **)v26 = 1;
    *(_DWORD *)(*(_QWORD *)v26 + 4LL) = 1;
    *((_QWORD *)v26 + 1) = 0LL;
    v27 = *((_DWORD *)v26 + 7) & 0xFFFFFFE0;
    *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v18) + 16) = v27;
    *(_QWORD *)(v18 + 40) = v26;
    *(_QWORD *)(v18 + 48) = v26;
    *(_DWORD *)(v18 + 104) = 1;
    *(_BYTE *)(v18 + 71) = 0;
    *(_DWORD *)(v18 + 80) = 0;
    if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      kernel_debug(
        0x52D503Eu,
        arg1a,
        v33 | (v29 << 16) | (signed int)(v34 << 24) | ((unsigned __int64)v35 << 32) | v30,
        v18,
        0LL,
        0LL);
    v20 = v18;
  }
  return v20;
}
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];

//----- (0000000000006F62) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::FindControlBulkEndpoint(AppleUSBEHCI *this, int a2, const OSMetaClass *a3, AppleEHCIQueueHead **a4, __int16 a5)
{
  int v5; // er12@1
  __int64 v6; // rbx@1
  int v7; // et1@2
  AppleEHCIQueueHead *v8; // r15@2
  __int64 v9; // r14@3
  int v10; // er13@3
  __int64 v11; // rax@7
  __int64 v12; // r14@8
  __int64 v13; // r15@9
  int v14; // er13@9
  const OSMetaClass *v15; // rdx@9
  OSMetaClassBase *v16; // rdi@16
  AppleEHCIQueueHead **v17; // r14@17
  AppleUSBEHCI *v18; // rbx@17
  const OSMetaClass *v19; // rdx@19
  __int64 v20; // rax@19
  __int64 v21; // rax@20
  AppleEHCIQueueHead *v22; // rbx@21
  AppleEHCIQueueHead *v23; // rcx@21
  AppleEHCIQueueHead **v25; // [sp+0h] [bp-50h]@1
  __int16 v26; // [sp+Ch] [bp-44h]@1
  AppleUSBEHCI *v27; // [sp+10h] [bp-40h]@1

  v26 = a5;
  v25 = a4;
  v27 = this;
  v5 = a2 | ((_DWORD)a3 << 8);
  v6 = *((_QWORD *)this + 217);
  if ( v6 )
  {
    v7 = *(_DWORD *)(*((_QWORD *)this + 88) + 24LL);
    v8 = 0LL;
    while ( 1 )
    {
      v9 = OSMetaClassBase::safeMetaCast(
             *(OSMetaClassBase **)(v6 + 32),
             (const OSMetaClassBase *)AppleEHCIQueueHead::metaClass,
             a3);
      v10 = *(_BYTE *)(v6 + 70);
      if ( (*(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v6) + 4) & 0xF7F) == v5
        && (v10 == 2 || v10 == v26) )
        break;
      v8 = (AppleEHCIQueueHead *)v6;
      v6 = v9;
      if ( !v9 )
        goto LABEL_7;
    }
    if ( v25 )
      *v25 = v8;
  }
  else
  {
LABEL_7:
    v11 = *((_QWORD *)this + 218);
    v6 = 0LL;
    if ( v11 )
    {
      v6 = 0LL;
      v12 = 0LL;
      while ( 1 )
      {
        v13 = v11;
        v14 = *(_BYTE *)(v11 + 70);
        if ( (*(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v11) + 4) & 0xF7F) == v5
          && (v14 == 2 || v14 == v26) )
          break;
        v11 = OSMetaClassBase::safeMetaCast(
                *(OSMetaClassBase **)(v13 + 32),
                (const OSMetaClassBase *)AppleEHCIQueueHead::metaClass,
                v15);
        v12 = v13;
        if ( !v11 )
          return v6;
      }
      v16 = *(OSMetaClassBase **)(v13 + 32);
      if ( v12 )
      {
        *(_QWORD *)(v12 + 32) = v16;
        v17 = v25;
        v18 = v27;
      }
      else
      {
        v18 = v27;
        *((_QWORD *)v27 + 218) = OSMetaClassBase::safeMetaCast(
                                   v16,
                                   (const OSMetaClassBase *)AppleEHCIQueueHead::metaClass,
                                   v15);
        v17 = v25;
      }
      AppleUSBEHCI::linkAsyncEndpoint(v18, (AppleEHCIQueueHead *)v13);
      v20 = *(_DWORD *)(*((_QWORD *)v18 + 88) + 24LL);
      if ( v17 )
      {
        v21 = *((_QWORD *)v18 + 217);
        if ( v13 == v21 )
        {
          *v17 = 0LL;
        }
        else
        {
          do
          {
            v22 = (AppleEHCIQueueHead *)v21;
            v23 = 0LL;
            if ( !v21 )
              break;
            v21 = OSMetaClassBase::safeMetaCast(
                    *(OSMetaClassBase **)(v21 + 32),
                    (const OSMetaClassBase *)AppleEHCIQueueHead::metaClass,
                    v19);
            v23 = v22;
          }
          while ( v21 != v13 );
          *v17 = v23;
        }
      }
      v6 = v13;
    }
  }
  return v6;
}
// 165C0: using guessed type _QWORD AppleEHCIQueueHead::metaClass;
// 2DEC8: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000000712A) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::UIMAbortEndpoint(AppleUSBEHCI *this, uintptr_t a2, uintptr_t a3, __int16 a4)
{
  return AppleUSBEHCI::HandleEndpointAbort(this, a2, a3, a4, 0);
}

//----- (0000000000007138) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::HandleEndpointAbort(AppleUSBEHCI *this, uintptr_t a2, uintptr_t a3, __int16 a4, unsigned __int8 a5)
{
  __int16 v5; // r13@1
  signed int v6; // er12@3
  int v7; // er12@4
  __int16 v8; // r15@4
  OSMetaClassBase *v9; // rax@4
  const OSMetaClass *v10; // rdx@4
  uintptr_t v11; // rax@4
  uintptr_t v12; // rcx@9
  uintptr_t v13; // r8@9
  __int64 v14; // rax@11
  __int64 v15; // r15@12
  __int64 v16; // rax@14
  int v17; // eax@17
  __int64 v18; // rax@18
  uintptr_t v19; // rsi@21
  unsigned __int8 v21; // [sp+8h] [bp-38h]@4
  uintptr_t arg3; // [sp+10h] [bp-30h]@11

  v5 = a3;
  if ( (_DWORD)a2 == *((_WORD *)this + 856) )
  {
    if ( (unsigned __int16)a3 < 2u )
    {
      v6 = AppleUSBEHCI::SimulateEDAbort(this, a3, a4);
      return (unsigned int)v6;
    }
    v6 = -536870206;
    if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    {
      a3 = (signed __int16)a3;
      a2 = (signed __int16)a2;
      v12 = -536870206LL;
      v13 = 2LL;
LABEL_10:
      kernel_debug(0x52D506Cu, a2, a3, v12, v13, 0LL);
      return (unsigned int)v6;
    }
    return (unsigned int)v6;
  }
  v21 = a5;
  v7 = (signed __int16)a3;
  v8 = a4;
  LODWORD(v9) = (*(int (__fastcall **)(AppleUSBEHCI *, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 2776LL))(
                  this,
                  (unsigned int)(signed __int16)a2,
                  (unsigned int)(signed __int16)a3,
                  (unsigned int)a4,
                  0LL);
  v11 = OSMetaClassBase::safeMetaCast(v9, (const OSMetaClassBase *)AppleEHCIIsochEndpoint::metaClass, v10);
  if ( v11 )
  {
    AppleUSBEHCI::AbortIsochEP(this, v11);
LABEL_6:
    v6 = 0;
    return (unsigned int)v6;
  }
  v14 = AppleUSBEHCI::FindControlBulkEndpoint(
          this,
          (signed __int16)a2,
          (const OSMetaClass *)(unsigned int)v7,
          (AppleEHCIQueueHead **)&arg3,
          v8);
  if ( v14 )
  {
    v6 = -536854456;
    v15 = v14;
    if ( *(_BYTE *)(v14 + 77) )
      return (unsigned int)v6;
    *(_BYTE *)(v14 + 77) = 1;
    AppleUSBEHCI::HaltAsyncEndpoint((uintptr_t)this, (AppleEHCIQueueHead *)v14, arg3);
    goto LABEL_17;
  }
  v16 = AppleUSBEHCI::FindInterruptEndpoint(this, (signed __int16)a2, v7, v8, 0LL);
  v15 = v16;
  if ( v16 )
  {
    v6 = -536854456;
    if ( *(_BYTE *)(v16 + 77) )
      return (unsigned int)v6;
    *(_BYTE *)(v16 + 77) = 1;
    AppleUSBEHCI::HaltInterruptEndpoint(this, (AppleEHCIQueueHead *)v16);
LABEL_17:
    AppleUSBEHCI::returnTransactions((uintptr_t)this, (AppleEHCIQueueHead *)v15, 0LL, 0xE0004050uLL, v21);
    v17 = *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v15) + 24);
    if ( v21 )
    {
      v18 = AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v15);
      *(_DWORD *)(v18 + 24) &= 0x7FFFFFFFu;
      _mm_mfence();
    }
    if ( *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v15) + 24) & 0x40 )
    {
      if ( *(_BYTE *)off_160C0[0] & 2 )
      {
        v19 = *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v15) + 24);
        if ( *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
          kernel_debug(0x52D506Cu, v19, 0x40uLL, 0LL, 4uLL, 0LL);
      }
    }
    *(_BYTE *)(v15 + 77) = 0;
    goto LABEL_6;
  }
  v6 = -536854441;
  if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
  {
    a3 = v5;
    a2 = (signed __int16)a2;
    v12 = -536854441LL;
    v13 = 3LL;
    goto LABEL_10;
  }
  return (unsigned int)v6;
}
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];
// 16CD8: using guessed type _QWORD AppleEHCIIsochEndpoint::metaClass;
// 2DEC8: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000000738C) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::UIMClearEndpointStall(AppleUSBEHCI *this, uintptr_t a2, uintptr_t a3, __int16 a4)
{
  return AppleUSBEHCI::HandleEndpointAbort(this, a2, a3, a4, 1u);
}

//----- (000000000000739C) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::UIMDeleteEndpoint(AppleUSBEHCI *this, unsigned __int16 a2, __int16 a3, __int16 a4)
{
  unsigned __int16 v4; // r12@1
  __int64 v5; // r14@1
  __int16 v6; // r15@3
  __int16 v7; // r13@3
  __int16 v8; // bx@5
  unsigned __int8 v9; // r13@6
  unsigned __int8 v10; // r12@8
  unsigned __int64 v11; // rdx@8
  uintptr_t v12; // r13@8
  int v13; // er12@9
  __int16 v14; // r13@9
  OSMetaClassBase *v15; // rax@9
  const OSMetaClass *v16; // rdx@9
  AppleEHCIIsochEndpoint *v17; // rax@9
  __int16 v18; // r14@14
  char v19; // ST10_1@15
  __int64 v20; // rax@17
  __int64 v21; // r15@18
  uintptr_t v22; // rdx@25
  int v23; // eax@25
  int v24; // ecx@25
  uintptr_t v25; // rax@30
  __int64 v26; // r8@30
  __int64 v27; // rax@34
  __int64 v28; // rbx@34
  int v29; // er15@34
  const char *v31; // rdx@55
  unsigned __int8 v32; // [sp+10h] [bp-40h]@9
  __int16 v33; // [sp+14h] [bp-3Ch]@6
  __int16 v34; // [sp+14h] [bp-3Ch]@9
  signed int v35; // [sp+18h] [bp-38h]@6
  uintptr_t arg3; // [sp+20h] [bp-30h]@17

  v4 = a2;
  v5 = off_160C0[0];
  if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
  {
    v6 = a3;
    v7 = a4;
    kernel_debug(
      0x52D5079u,
      (uintptr_t)this,
      (unsigned __int8)a4 | (unsigned __int16)(a3 << 8) | (unsigned __int64)((a2 << 16) & 0xFF0000),
      0LL,
      0LL,
      0LL);
    a4 = v7;
    a3 = v6;
  }
  if ( (signed __int16)a2 != *((_WORD *)this + 856) )
  {
    v13 = a3;
    v34 = a3;
    v32 = a4;
    v14 = a4;
    v35 = 0;
    LODWORD(v15) = (*(int (__fastcall **)(AppleUSBEHCI *, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 2776LL))(
                     this,
                     (unsigned int)(signed __int16)a2,
                     (unsigned int)a3,
                     (unsigned int)a4,
                     0LL);
    v17 = (AppleEHCIIsochEndpoint *)OSMetaClassBase::safeMetaCast(
                                      v15,
                                      (const OSMetaClassBase *)AppleEHCIIsochEndpoint::metaClass,
                                      v16);
    if ( v17 )
    {
      AppleUSBEHCI::DeleteIsochEP(this, v17);
      v4 = a2;
      if ( *(_BYTE *)v5 & 2 )
      {
        LOBYTE(a4) = v32;
        v12 = (uintptr_t)this;
        a3 = v34;
        if ( *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
        {
          v35 = 0;
          kernel_debug(
            0x52D5078u,
            (uintptr_t)this,
            v32 | (unsigned __int16)(v34 << 8) | (unsigned __int64)((a2 << 16) & 0xFF0000),
            0LL,
            3uLL,
            0LL);
          LOBYTE(a4) = v32;
          a3 = v34;
        }
      }
      else
      {
        LOBYTE(a4) = v32;
        v12 = (uintptr_t)this;
        a3 = v34;
      }
      goto LABEL_44;
    }
    v20 = AppleUSBEHCI::FindControlBulkEndpoint(
            this,
            (signed __int16)a2,
            (const OSMetaClass *)(unsigned int)v13,
            (AppleEHCIQueueHead **)&arg3,
            v14);
    if ( v20 )
    {
      v4 = a2;
      v12 = (uintptr_t)this;
      v21 = v20;
      if ( *(_BYTE *)v5 & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
        kernel_debug(
          0x52D5078u,
          (uintptr_t)this,
          v32 | (unsigned __int16)(v34 << 8) | (unsigned __int64)((a2 << 16) & 0xFF0000),
          v20,
          6uLL,
          0LL);
      AppleUSBEHCI::unlinkAsyncEndpoint((uintptr_t)this, (AppleEHCIQueueHead *)v21, arg3);
    }
    else
    {
      v21 = AppleUSBEHCI::FindInterruptEndpoint(this, (signed __int16)a2, v13, v14, 0LL);
      v23 = *(_DWORD *)v5;
      v24 = *(_DWORD *)v5 & 2;
      if ( !v21 )
      {
        v4 = a2;
        if ( v24 )
        {
          v12 = (uintptr_t)this;
          if ( *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
          {
            kernel_debug(
              0x52D5078u,
              (uintptr_t)this,
              v32 | (unsigned __int16)(v34 << 8) | (unsigned __int64)((a2 << 16) & 0xFF0000),
              0LL,
              4uLL,
              0LL);
            v23 = *(_DWORD *)v5;
          }
        }
        else
        {
          v12 = (uintptr_t)this;
        }
        if ( v23 & 2 )
        {
          v22 = *(_QWORD *)(v12 + 1736);
          if ( *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
            kernel_debug(0x52D50C0u, v12, v22, *(_DWORD *)(*(_QWORD *)(v12 + 704) + 24LL), 1uLL, 0LL);
        }
        AppleUSBEHCI::printAsyncQueue(v12, 6, (const char *)v22, 0LL, 1);
        IOSleep(5LL);
        if ( *(_BYTE *)v5 & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
          kernel_debug(0x52D50C0u, v12, *(_QWORD *)(v12 + 1744), 0LL, 2uLL, 0LL);
        AppleUSBEHCI::printInactiveQueue((AppleUSBEHCI *)v12, 6u, v31);
        v35 = -536854441;
        a3 = v34;
        LOBYTE(a4) = v32;
        goto LABEL_44;
      }
      v4 = a2;
      v12 = (uintptr_t)this;
      if ( v24 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
        kernel_debug(
          0x52D5078u,
          (uintptr_t)this,
          v32 | (unsigned __int16)(v34 << 8) | (unsigned __int64)((a2 << 16) & 0xFF0000),
          v21,
          5uLL,
          0LL);
      AppleUSBEHCI::unlinkIntEndpoint(this, (AppleEHCIQueueHead *)v21);
      AppleUSBEHCI::ReturnInterruptBandwidth(this, (AppleEHCIQueueHead *)v21);
    }
    v25 = *(_QWORD *)(v21 + 40);
    v26 = *(_QWORD *)(v21 + 48);
    if ( v25 != v26 )
    {
      if ( *(_BYTE *)v5 & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      {
        kernel_debug(0x52D5078u, v12, *(_QWORD *)(v21 + 40), 0LL, 7uLL, 0LL);
        v25 = *(_QWORD *)(v21 + 40);
        v26 = *(_QWORD *)(v21 + 48);
      }
      AppleUSBEHCI::EHCIUIMDoDoneQueueProcessing(v12, v25, -536854448, 0LL, v26);
      v27 = *(_QWORD *)(v21 + 48);
      *(_QWORD *)(v21 + 40) = v27;
      v28 = v21;
      v29 = *(_DWORD *)(v27 + 28);
      *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v28) + 16) = v29;
      v21 = v28;
      _mm_mfence();
      v25 = *(_QWORD *)(v28 + 40);
    }
    if ( v25 )
    {
      if ( *(_BYTE *)v5 & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      {
        kernel_debug(0x52D5078u, v12, v25, 0LL, 8uLL, 0LL);
        v25 = *(_QWORD *)(v21 + 40);
      }
      AppleUSBEHCI::DeallocateTD(v12, v25);
      *(_QWORD *)(v21 + 40) = 0LL;
    }
    if ( *(_BYTE *)v5 & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D5078u, v12, v21, 0LL, 9uLL, 0LL);
    AppleUSBEHCI::DeallocateED((AppleUSBEHCI *)v12, (AppleEHCIQueueHead *)v21);
    a3 = v34;
    LOBYTE(a4) = v32;
    goto LABEL_44;
  }
  v8 = a3;
  if ( (unsigned __int16)a3 < 2u )
  {
    v33 = a3;
    v9 = a4;
    v35 = AppleUSBEHCI::SimulateEDDelete(this, a3, a4);
    if ( *(_BYTE *)v5 & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    {
      v10 = v9;
      v11 = v9 | (unsigned __int16)(v8 << 8) | (unsigned __int64)((a2 << 16) & 0xFF0000);
      v12 = (uintptr_t)this;
      kernel_debug(0x52D5078u, (uintptr_t)this, v11, v35, 2uLL, 0LL);
      LOBYTE(a4) = v10;
      v4 = a2;
      a3 = v33;
      goto LABEL_44;
    }
    a3 = v33;
    LOBYTE(a4) = v9;
LABEL_23:
    v12 = (uintptr_t)this;
    goto LABEL_44;
  }
  v35 = -536870206;
  if ( !(*(_BYTE *)v5 & 2) )
    goto LABEL_23;
  v18 = a3;
  v12 = (uintptr_t)this;
  if ( *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
  {
    v19 = a4;
    kernel_debug(
      0x52D5078u,
      (uintptr_t)this,
      (unsigned __int8)a4 | (unsigned __int16)(a3 << 8) | (unsigned __int64)((a2 << 16) & 0xFF0000),
      0LL,
      1uLL,
      0LL);
    LOBYTE(a4) = v19;
  }
  a3 = v18;
  v5 = off_160C0[0];
LABEL_44:
  if ( *(_BYTE *)v5 & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    kernel_debug(
      0x52D507Au,
      v12,
      (unsigned __int8)a4 | (unsigned __int16)(a3 << 8) | (unsigned __int64)((v4 << 16) & 0xFF0000),
      v35,
      0LL,
      0LL);
  return (unsigned int)v35;
}
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];
// 16CD8: using guessed type _QWORD AppleEHCIIsochEndpoint::metaClass;
// 2DB30: using guessed type int __fastcall IOSleep(_QWORD);
// 2DEC8: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (00000000000079EC) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::DeleteIsochEP(AppleUSBEHCI *this, AppleEHCIIsochEndpoint *a2)
{
  AppleEHCIIsochEndpoint *v2; // rbx@1
  __int64 v3; // rax@4
  __int64 v4; // rdx@4
  __int64 v5; // rcx@4
  __int64 v6; // rsi@5
  __int64 v7; // rdx@8

  v2 = a2;
  if ( *((_DWORD *)a2 + 21) )
  {
    AppleUSBEHCI::AbortIsochEP(this, (uintptr_t)a2);
    if ( *((_DWORD *)a2 + 21) )
      KernelDebugLogInternal(
        1LL,
        1431519814LL,
        "AppleUSBEHCI::DeleteIsochEP- after abort there are STILL %d active TDs");
  }
  v3 = *((_QWORD *)this + 54);
  v4 = *(_QWORD *)(v3 + 136);
  v5 = 0LL;
  if ( v4 )
  {
    while ( 1 )
    {
      v6 = v4;
      if ( (AppleEHCIIsochEndpoint *)v4 == v2 )
        break;
      v4 = *(_QWORD *)(v4 + 16);
      v5 = v6;
      if ( !v4 )
        goto LABEL_11;
    }
    v7 = *((_QWORD *)v2 + 2);
    if ( v5 )
      *(_QWORD *)(v5 + 16) = v7;
    else
      *(_QWORD *)(v3 + 136) = v7;
  }
LABEL_11:
  AppleUSBEHCI::ReturnIsochBandwidth(this, v2);
  (*(void (__fastcall **)(AppleUSBEHCI *, AppleEHCIIsochEndpoint *))(*(_QWORD *)this + 2768LL))(this, v2);
  return 0LL;
}
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (0000000000007A8C) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::FindInterruptEndpoint(AppleUSBEHCI *this, int a2, int a3, unsigned __int8 a4, IOUSBControllerListElement **a5)
{
  int v5; // ebx@1
  __int64 v6; // r15@1
  OSMetaClassBase *v7; // r14@2
  OSMetaClassBase *v8; // rax@3
  const OSMetaClass *v9; // rdx@4
  IOUSBControllerListElement *v10; // r13@5
  IOUSBControllerListElement **v12; // [sp+8h] [bp-48h]@1
  int v13; // [sp+10h] [bp-40h]@2
  int v14; // [sp+14h] [bp-3Ch]@2
  AppleUSBEHCI *v15; // [sp+18h] [bp-38h]@1

  v12 = a5;
  v15 = this;
  v5 = 0;
  v6 = 0LL;
  if ( *((_DWORD *)this + 179) > 0 )
  {
    v14 = a2 | (a3 << 8);
    v13 = a4;
    v7 = 0LL;
    while ( 1 )
    {
      v8 = (OSMetaClassBase *)AppleUSBEHCI::GetPeriodicListLogicalEntry(this, v5);
      if ( v8 )
        break;
LABEL_10:
      ++v5;
      this = v15;
      v6 = 0LL;
      if ( v5 >= *((_DWORD *)v15 + 179) )
        return v6;
    }
    v9 = (const OSMetaClass *)(unsigned int)(v5 % 32);
    while ( 1 )
    {
      v10 = v7;
      v7 = v8;
      v6 = OSMetaClassBase::safeMetaCast(v8, (const OSMetaClassBase *)AppleEHCIQueueHead::metaClass, v9);
      if ( v6 )
      {
        if ( v6 != *((_QWORD *)v15 + v5 % 32 + 103)
          && (*(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v6) + 4) & 0xF7F) == v14
          && *(_BYTE *)(v6 + 70) == v13 )
          break;
      }
      v8 = (OSMetaClassBase *)*((_QWORD *)v7 + 4);
      if ( !v8 )
        goto LABEL_10;
    }
    if ( v12 )
      *v12 = v10;
  }
  return v6;
}
// 165C0: using guessed type _QWORD AppleEHCIQueueHead::metaClass;
// 2DEC8: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000007B86) ----------------------------------------------------
int __fastcall AppleUSBEHCI::printAsyncQueue(uintptr_t arg1, signed int a2, const char *a3, __int64 a4, char a5)
{
  __int64 v5; // rbx@1
  const OSMetaClass *v6; // rdx@2
  uintptr_t i; // r14@3
  __int64 v8; // rax@6
  char v10; // [sp+0h] [bp-2Ch]@1

  v10 = a5;
  v5 = *(_QWORD *)(arg1 + 1736);
  if ( v5 )
  {
    do
    {
      (*(void (__fastcall **)(__int64, _QWORD, uintptr_t))(*(_QWORD *)v5 + 312LL))(v5, (unsigned int)a2, arg1);
      if ( v10 )
      {
        for ( i = *(_QWORD *)(v5 + 40); i != *(_QWORD *)(v5 + 48); i = *(_QWORD *)(i + 32) )
          AppleUSBEHCI::printTD(arg1, i, a2);
      }
      v8 = OSMetaClassBase::safeMetaCast(
             *(OSMetaClassBase **)(v5 + 32),
             (const OSMetaClassBase *)AppleEHCIQueueHead::metaClass,
             v6);
      v5 = v8;
    }
    while ( v8 );
  }
  return v8;
}
// 165C0: using guessed type _QWORD AppleEHCIQueueHead::metaClass;
// 2DEC8: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000007C10) ----------------------------------------------------
void __fastcall AppleUSBEHCI::printInactiveQueue(AppleUSBEHCI *this, unsigned int a2, const char *a3)
{
  __int64 i; // rbx@1
  const OSMetaClass *v4; // rdx@2

  for ( i = *((_QWORD *)this + 218);
        i;
        i = OSMetaClassBase::safeMetaCast(
              *(OSMetaClassBase **)(i + 32),
              (const OSMetaClassBase *)AppleEHCIQueueHead::metaClass,
              v4) )
    (*(void (__fastcall **)(__int64, _QWORD, AppleUSBEHCI *))(*(_QWORD *)i + 312LL))(i, a2, this);
}
// 165C0: using guessed type _QWORD AppleEHCIQueueHead::metaClass;
// 2DEC8: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000007C66) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::unlinkIntEndpoint(AppleUSBEHCI *this, AppleEHCIQueueHead *a2)
{
  AppleEHCIQueueHead *v2; // r15@1
  unsigned __int8 v3; // bl@1
  int v4; // et1@1
  int v5; // er13@1
  AppleUSBEHCI *v6; // rbx@1
  const OSMetaClassBase *v7; // r12@1
  const OSMetaClassBase *v8; // rsi@2
  AppleUSBEHCI *v9; // r14@2
  const OSMetaClass *v10; // rdx@2
  __int64 v11; // rbx@2
  int v12; // eax@3
  OSMetaClassBase *v13; // rdi@7
  int (__fastcall *v14)(_QWORD, _QWORD); // ST08_8@8
  __int64 v15; // rax@8
  __int64 result; // rax@10
  int v17; // [sp+8h] [bp-38h]@1
  int v18; // [sp+14h] [bp-2Ch]@1

  v2 = a2;
  v3 = AppleEHCIQueueHead::NormalizedPollingRate(a2);
  v4 = *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical(a2) + 4);
  v5 = *((_BYTE *)a2 + 75);
  v18 = v3;
  v6 = this;
  v7 = *(const OSMetaClassBase **)off_16030[0];
  v17 = 0;
  do
  {
    v8 = (const OSMetaClassBase *)(unsigned int)v5;
    v9 = v6;
    v11 = AppleUSBEHCI::GetPeriodicListLogicalEntry(v6, v5);
    if ( v2 == (AppleEHCIQueueHead *)v11 )
    {
      v12 = AppleUSBEHCI::SetPeriodicListEntry(v9, v5, *((IOUSBControllerListElement **)v2 + 4));
LABEL_4:
      LOBYTE(v12) = 1;
      v17 = v12;
    }
    else
    {
      while ( v11 )
      {
        v13 = *(OSMetaClassBase **)(v11 + 32);
        if ( v13 == v2 )
        {
          *(_QWORD *)(v11 + 32) = *((_QWORD *)v2 + 4);
          v14 = *(int (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v11 + 280LL);
          LODWORD(v15) = (*(int (__fastcall **)(AppleEHCIQueueHead *, const OSMetaClassBase *))(*(_QWORD *)v2 + 288LL))(
                           v2,
                           v8);
          v12 = v14(v11, v15);
          goto LABEL_4;
        }
        v8 = v7;
        v11 = OSMetaClassBase::safeMetaCast(v13, v7, v10);
      }
    }
    v6 = v9;
    v5 += v18;
  }
  while ( v5 < 1024 );
  IOSleep(1LL);
  *((_QWORD *)v2 + 4) = 0LL;
  result = (unsigned int)v17;
  if ( v17 & 1 )
    --*((_DWORD *)v9 + 425);
  return result;
}
// 16030: using guessed type _QWORD off_16030[21];
// 2DB30: using guessed type int __fastcall IOSleep(_QWORD);
// 2DEC8: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000007D66) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::ReturnInterruptBandwidth(AppleUSBEHCI *this, AppleEHCIQueueHead *a2)
{
  AppleEHCIQueueHead *v2; // r13@1
  AppleUSBEHCI *v3; // r15@1
  signed int v4; // er14@1
  __int64 *v5; // r12@2
  int v6; // er8@2
  signed __int16 v7; // r8@3
  signed int v8; // eax@5
  unsigned int v9; // er8@6
  int v10; // edi@9
  __int64 v11; // rsi@9
  __int64 v12; // rbx@10
  signed __int64 v13; // rdi@11
  unsigned int v14; // esi@11
  __int64 v15; // rax@16
  AppleUSBEHCITTInfo *v16; // rdi@17
  __int64 v17; // rdx@18
  __int64 v18; // rcx@18
  int v19; // er8@18
  __int64 v20; // rsi@18

  v2 = a2;
  v3 = this;
  v4 = 0;
  if ( *((_WORD *)a2 + 32) )
  {
    v5 = (__int64 *)off_16098[0];
    (*(void (__fastcall **)(AppleEHCIQueueHead *, _QWORD, AppleUSBEHCI *))(*(_QWORD *)a2 + 312LL))(
      a2,
      *(_DWORD *)off_16098[0],
      this);
    if ( *((_BYTE *)a2 + 73) == 2 )
    {
      v7 = 45;
      if ( *((_BYTE *)a2 + 70) == 1 )
        v7 = 25;
      LOWORD(v6) = *((_WORD *)this + 796) + v6;
      v8 = *((_BYTE *)a2 + 76) + 8 * *((_BYTE *)a2 + 75);
      if ( v8 <= 255 )
      {
        v9 = 7 * (unsigned int)*((_WORD *)a2 + 32) / 6 + v6;
        do
        {
          if ( (_WORD)v9 )
          {
            if ( (unsigned __int16)v9 <= 0x1770u )
            {
              v10 = v8 + ((unsigned int)(v8 >> 31) >> 29);
              v11 = (unsigned __int16)(v8 / 8);
              if ( (unsigned int)v11 <= 0x20 )
              {
                v12 = (unsigned __int16)(v8 - (v10 & 0xFFF8));
                if ( (unsigned int)v12 <= 8 )
                {
                  v13 = (signed __int64)((char *)v3 + 16 * v11 + 2 * v12 + 1080);
                  v14 = *(_WORD *)v13;
                  if ( v14 >= (unsigned __int16)v9 )
                    *(_WORD *)v13 = v14 - v9;
                  else
                    *(_WORD *)v13 = 0;
                }
              }
            }
          }
          v8 += *((_WORD *)v2 + 39);
        }
        while ( v8 < 256 );
      }
    }
    else
    {
      v15 = *((_QWORD *)a2 + 7);
      v4 = -536870199;
      if ( v15 )
      {
        v16 = *(AppleUSBEHCITTInfo **)(v15 + 40);
        if ( v16 )
        {
          AppleUSBEHCITTInfo::ShowHSSplitTimeUsed(v16, *(_DWORD *)v5, "+ReturnInterruptBandwidth");
          v4 = AppleUSBEHCITTInfo::DeallocatePeriodicBandwidth(
                 *(AppleUSBEHCITTInfo **)(*((_QWORD *)a2 + 7) + 40LL),
                 *((AppleUSBEHCISplitPeriodicEndpoint **)a2 + 7));
          v20 = *((_QWORD *)a2 + 7);
          *(_WORD *)(v20 + 50) = 0;
          if ( !v4 )
          {
            AppleUSBEHCI::ReturnHSPeriodicSplitBandwidth(v3, (AppleUSBEHCISplitPeriodicEndpoint *)v20, v17, v18, v19);
            v4 = 0;
            AppleUSBEHCITTInfo::CalculateSPEsToAdjustAfterChange(
              *(AppleUSBEHCITTInfo **)(*((_QWORD *)v2 + 7) + 40LL),
              *((AppleUSBEHCISplitPeriodicEndpoint **)v2 + 7),
              0);
            AppleUSBEHCI::AdjustSPEs(v3, *((AppleUSBEHCISplitPeriodicEndpoint **)v2 + 7), 0LL);
            AppleUSBEHCITTInfo::ShowHSSplitTimeUsed(
              *(AppleUSBEHCITTInfo **)(*((_QWORD *)v2 + 7) + 40LL),
              *(_DWORD *)v5,
              "-ReturnInterruptBandwidth");
            AppleUSBEHCITTInfo::print(
              *(AppleUSBEHCITTInfo **)(*((_QWORD *)v2 + 7) + 40LL),
              *(_DWORD *)v5,
              "-ReturnInterruptBandwidth");
            (*(void (__cdecl **)(_QWORD))(**((_QWORD **)v2 + 7) + 40LL))(*((_QWORD *)v2 + 7));
            *((_QWORD *)v2 + 7) = 0LL;
          }
        }
      }
    }
  }
  return (unsigned int)v4;
}
// 16098: using guessed type __int64 off_16098[8];

//----- (0000000000007F40) ----------------------------------------------------
void __fastcall AppleUSBEHCI::unlinkAsyncEndpoint(uintptr_t arg1, AppleEHCIQueueHead *this, uintptr_t arg3)
{
  uintptr_t v3; // rbx@1
  uintptr_t v4; // r12@1
  AppleEHCIQueueHead *v5; // r15@7
  void (__fastcall *v6)(_QWORD, _QWORD); // r14@8
  __int64 v7; // rax@8
  const char *v8; // rdx@8
  OSMetaClassBase *v9; // rdi@14
  __int64 v10; // rbx@15
  const OSMetaClass *v11; // rdx@16
  void (__fastcall *v12)(_QWORD, _QWORD); // r14@16
  __int64 v13; // rax@16
  __int64 v14; // rax@16
  __int64 v15; // rax@16
  uintptr_t v16; // rdx@23
  signed __int64 v17; // rcx@23
  uintptr_t v18; // r8@23
  uintptr_t v19; // rsi@23
  __int64 v20; // rax@24
  uintptr_t v21; // rcx@24
  uintptr_t v22; // r13@24
  char v23; // bh@26
  uintptr_t v24; // rbx@28
  __int64 v25; // r14@29
  uintptr_t v26; // r15@30
  AppleEHCIQueueHead *v27; // r14@37
  __int64 v28; // r15@40
  int v29; // ebx@56
  uintptr_t v30; // rbx@60
  __int64 v31; // r14@60
  int v32; // er15@61
  uintptr_t v33; // rdx@66
  __int64 v34; // rax@70
  const char *v35; // rdx@80
  __int64 v36; // rax@80
  AppleEHCIQueueHead *v37; // [sp+8h] [bp-38h]@29

  v3 = arg3;
  v4 = arg1;
  if ( !arg3 && !*((_QWORD *)this + 4) )
  {
    if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      kernel_debug(
        0x52D5074u,
        arg1,
        (uintptr_t)this,
        *((_BYTE *)this + 70) | (*((_WORD *)this + 34) << 16) | ((unsigned __int64)*((_WORD *)this + 33) << 32),
        0xBuLL,
        0LL);
    AppleUSBEHCI::DisableAsyncSchedule(arg1, 1);
    AppleUSBEHCI::printAsyncQueue(arg1, 7, v35, 0LL, 0);
    v36 = AppleEHCIQueueHead::GetSharedLogical(this);
    *(_DWORD *)(v36 + 4) &= 0xFFFF7FFF;
    *(_QWORD *)(arg1 + 1736) = 0LL;
    *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 24LL) = 0;
    return;
  }
  if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    kernel_debug(
      0x52D5074u,
      arg1,
      (uintptr_t)this,
      *((_BYTE *)this + 70) | (*((_WORD *)this + 34) << 16) | ((unsigned __int64)*((_WORD *)this + 33) << 32),
      0xCuLL,
      0LL);
  if ( *(AppleEHCIQueueHead **)(arg1 + 1736) == this )
  {
    if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D5074u, arg1, (uintptr_t)this, v3, 0xDuLL, 0LL);
    if ( v3 )
      KernelDebugLogInternal(
        1LL,
        1431519814LL,
        "AppleUSBEHCI::unlinkAsyncEndpoint: ERROR - pEDQueueBack should be NULL at this point");
    v9 = (OSMetaClassBase *)*((_QWORD *)this + 4);
    do
    {
      v10 = OSMetaClassBase::safeMetaCast(
              v9,
              (const OSMetaClassBase *)AppleEHCIQueueHead::metaClass,
              (const OSMetaClass *)arg3);
      v9 = *(OSMetaClassBase **)(v10 + 32);
    }
    while ( v9 );
    AppleUSBEHCI::printAsyncQueue(v4, 7, (const char *)arg3, 0LL, 0);
    v5 = (AppleEHCIQueueHead *)OSMetaClassBase::safeMetaCast(
                                 *((OSMetaClassBase **)this + 4),
                                 (const OSMetaClassBase *)AppleEHCIQueueHead::metaClass,
                                 v11);
    *(_QWORD *)(v4 + 1736) = v5;
    v12 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v10 + 280LL);
    LODWORD(v13) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 4) + 296LL))(
                     *((_QWORD *)this + 4),
                     AppleEHCIQueueHead::metaClass);
    v12(v10, v13);
    v14 = AppleEHCIQueueHead::GetSharedLogical(this);
    *(_DWORD *)(v14 + 4) &= 0xFFFF7FFF;
    v15 = AppleEHCIQueueHead::GetSharedLogical(v5);
    *(_DWORD *)(v15 + 4) |= 0x8000u;
  }
  else
  {
    v5 = 0LL;
    if ( v3 )
    {
      AppleUSBEHCI::printAsyncQueue(arg1, 7, (const char *)arg3, 0LL, 0);
      v6 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v3 + 280LL);
      LODWORD(v7) = (*(int (__fastcall **)(AppleEHCIQueueHead *, signed __int64))(*(_QWORD *)this + 288LL))(this, 7LL);
      v6(v3, v7);
      *(_QWORD *)(v3 + 32) = *((_QWORD *)this + 4);
      AppleUSBEHCI::printAsyncQueue(arg1, 7, v8, 0LL, 0);
    }
    else if ( *(_BYTE *)off_160C0[0] & 2 )
    {
      v5 = 0LL;
      if ( *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      {
        v5 = 0LL;
        kernel_debug(0x52D5074u, arg1, (uintptr_t)this, 0LL, 0xEuLL, 0LL);
      }
    }
  }
  if ( (unsigned __int8)IOService::isInactive((IOService *)v4) )
  {
    if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    {
      v16 = 0LL;
      v17 = 0LL;
      v18 = 15LL;
      v19 = v4;
LABEL_85:
      kernel_debug(0x52D5074u, v19, v16, v17, v18, 0LL);
      return;
    }
  }
  else
  {
    v20 = *(_QWORD *)(v4 + 704);
    v21 = *(_DWORD *)(v20 + 4);
    v22 = *(_DWORD *)v20;
    if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    {
      v23 = BYTE1(v21);
      kernel_debug(0x52D5074u, v4, v22, v21, 3uLL, 0LL);
      BYTE1(v21) = v23;
    }
    if ( v22 & 0x20 )
    {
      LODWORD(v24) = 0;
      if ( !(BYTE1(v21) & 0x80) )
      {
        v37 = v5;
        v24 = 0LL;
        v25 = off_160C8[0];
        do
        {
          IODelay(50LL);
          v26 = *(_DWORD *)(*(_QWORD *)(v4 + 704) + 4LL);
          if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)v25 & 0xFFFFFFF7 )
            kernel_debug(0x52D5074u, v4, v24, *(_DWORD *)(*(_QWORD *)(v4 + 704) + 4LL), 4uLL, 0LL);
          ++v24;
        }
        while ( (unsigned int)v24 <= 0x7CF && !(v26 & 0x8000) );
        if ( !(v26 & 0x8000) )
        {
          if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)v25 & 0xFFFFFFF7 )
          {
            v17 = 0x8000LL;
            v18 = 1LL;
            v19 = v4;
            v16 = v26;
            goto LABEL_85;
          }
          return;
        }
        v5 = v37;
      }
      v27 = v5;
      **(_DWORD **)(v4 + 704) = v22 | 0x40;
      _mm_mfence();
      IODelay(10LL);
      LODWORD(v22) = *(_DWORD *)(*(_QWORD *)(v4 + 704) + 4LL);
      if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D5074u, v4, (unsigned int)v24, *(_DWORD *)(*(_QWORD *)(v4 + 704) + 4LL), 5uLL, 0LL);
      v28 = off_160C8[0];
      while ( !(v22 & 0x20) )
      {
        IODelay(50LL);
        v22 = *(_DWORD *)(*(_QWORD *)(v4 + 704) + 4LL);
        v24 = (unsigned int)(v24 + 1);
        if ( (_DWORD)v24 == 1000 * (274877907 * v24 >> 38) && *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)v28 & 0xFFFFFFF7 )
          kernel_debug(0x52D5074u, v4, (unsigned int)v24, *(_DWORD *)(*(_QWORD *)(v4 + 704) + 4LL), 5uLL, 0LL);
        if ( (unsigned int)v24 >= 0x4E21 )
        {
          if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)v28 & 0xFFFFFFF7 )
            kernel_debug(0x52D5074u, v4, (unsigned int)v24, v22, 6uLL, 0LL);
          break;
        }
      }
      *(_DWORD *)(*(_QWORD *)(v4 + 704) + 4LL) = 32;
      _mm_mfence();
      if ( (*(_DWORD *)(*(_QWORD *)(v4 + 704) + 24LL) & 0xFFFFFFE0) == *((_QWORD *)this + 2) )
      {
        if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)v28 & 0xFFFFFFF7 )
          kernel_debug(0x52D5074u, v4, (uintptr_t)this, 0LL, 7uLL, 0LL);
        KernelDebugLogInternal(
          1LL,
          1431519814LL,
          "AppleUSBEHCI::unlinkAsyncEndpoint - pED[%p] seems to still be the AsyncListAddr after doorbell");
        if ( v27 )
        {
          *(_DWORD *)(*(_QWORD *)(v4 + 704) + 24LL) = *((_DWORD *)v27 + 4);
          _mm_mfence();
        }
      }
      return;
    }
    v29 = *(_DWORD *)(*(_QWORD *)(v4 + 704) + 4LL);
    if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D5074u, v4, 0LL, *(_DWORD *)(*(_QWORD *)(v4 + 704) + 4LL), 8uLL, 0LL);
    if ( BYTE1(v29) & 0x80 )
    {
      v30 = 0LL;
      v31 = off_160C8[0];
      do
      {
        IODelay(50LL);
        v32 = *(_DWORD *)(*(_QWORD *)(v4 + 704) + 4LL);
        if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)v31 & 0xFFFFFFF7 )
          kernel_debug(0x52D5074u, v4, v30, *(_DWORD *)(*(_QWORD *)(v4 + 704) + 4LL), 8uLL, 0LL);
        ++v30;
      }
      while ( (unsigned int)v30 <= 0x7CF && v32 & 0x8000 );
    }
    v33 = *(_DWORD *)(*(_QWORD *)(v4 + 704) + 4LL);
    if ( BYTE1(v33) & 0x80 && *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D5074u, v4, v33, 0x8000uLL, 2uLL, 0LL);
    v34 = *(_QWORD *)(v4 + 704);
    if ( *(_DWORD *)(v34 + 24) == *((_QWORD *)this + 2) )
    {
      *(_DWORD *)(v34 + 24) = *(_DWORD *)(*(_QWORD *)(v4 + 1736) + 16LL);
      _mm_mfence();
      if ( *(_BYTE *)off_160C0[0] & 2 )
      {
        if ( *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
          kernel_debug(
            0x52D5074u,
            v4,
            *(_DWORD *)(*(_QWORD *)(v4 + 704) + 24LL),
            *(_QWORD *)(*(_QWORD *)(v4 + 1736) + 16LL) & 0xFFFFFFFFLL,
            9uLL,
            0LL);
      }
    }
    if ( *(_BYTE *)off_160C0[0] & 2 )
    {
      v16 = *(_DWORD *)(*(_QWORD *)(v4 + 704) + 24LL);
      if ( *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      {
        v18 = 10LL;
        v19 = v4;
        v17 = *(_QWORD *)(*(_QWORD *)(v4 + 1736) + 16LL) & 0xFFFFFFFFLL;
        goto LABEL_85;
      }
    }
  }
}
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];
// 165C0: using guessed type _QWORD AppleEHCIQueueHead::metaClass;
// 2DAC0: using guessed type int __fastcall IODelay(_QWORD);
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);
// 2DEC8: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (00000000000086A0) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::EHCIUIMDoDoneQueueProcessing(__int64 a1, __int64 a2, int a3, __int64 a4, __int64 a5)
{
  signed __int64 v5; // rax@1
  unsigned int v6; // ecx@1
  signed int v7; // edx@4
  signed int v8; // ecx@4
  char v9; // al@4
  signed __int64 v10; // rax@11
  __int64 v11; // r12@11
  int v12; // esi@11
  __int64 v13; // rcx@11
  signed __int64 v14; // rcx@13
  __int64 v15; // rax@14
  int v16; // eax@16
  int v17; // eax@17
  __int64 v18; // r13@22
  unsigned __int64 v19; // rbx@22
  signed __int64 v20; // r14@23
  signed __int64 v21; // rax@27
  bool v22; // zf@35
  char v23; // al@37
  __int64 v24; // rax@39
  signed __int64 v25; // rcx@39
  __int64 v26; // rax@46
  __int64 v27; // rax@46
  signed __int64 v28; // rbx@47
  signed __int64 v29; // r15@56
  __int64 v30; // rax@56
  char v32; // [sp+20h] [bp-90h]@4
  signed int v33; // [sp+24h] [bp-8Ch]@13
  __int64 v34; // [sp+28h] [bp-88h]@11
  int v35; // [sp+34h] [bp-7Ch]@11
  __int64 v36; // [sp+38h] [bp-78h]@11
  uintptr_t arg1; // [sp+40h] [bp-70h]@1
  signed __int64 v38; // [sp+50h] [bp-60h]@13
  __int64 v39; // [sp+70h] [bp-40h]@49
  __int64 v40; // [sp+78h] [bp-38h]@50

  arg1 = a1;
  v5 = 32LL * *(_DWORD *)(a1 + 2136);
  *(_QWORD *)(a1 + v5 + 2144) = a2;
  *(_DWORD *)(a1 + v5 + 2152) = a3;
  *(_QWORD *)(a1 + v5 + 2160) = a4;
  *(_QWORD *)(a1 + v5 + 2168) = a5;
  v6 = *(_DWORD *)(a1 + 2136);
  if ( !v6 )
  {
    v32 = 1;
    v7 = 0;
    v8 = 1;
    v9 = 0;
    goto LABEL_6;
  }
  if ( v6 > 0x12 )
  {
    v32 = 0;
    KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBEHCI::EHCIUIMDoDoneQueueProcessing queue buffer overflow (%d)");
    v8 = *(_DWORD *)(a1 + 2136);
    *(_DWORD *)(a1 + 2136) = v8 - 1;
    v9 = 1;
    v7 = v8;
LABEL_6:
    *(_DWORD *)(a1 + 2136) = v8;
LABEL_8:
    while ( 2 )
    {
      if ( !(v9 & 1) )
      {
        if ( !v32 )
          return 0LL;
        if ( (unsigned int)v7 >= *(_DWORD *)(a1 + 2136) )
        {
          *(_DWORD *)(a1 + 2136) = 0;
          return 0LL;
        }
      }
      v10 = 32LL * (unsigned int)v7;
      v11 = *(_QWORD *)(a1 + v10 + 2144);
      v12 = *(_DWORD *)(a1 + v10 + 2152);
      v35 = *(_DWORD *)(a1 + v10 + 2152);
      v34 = *(_QWORD *)(a1 + v10 + 2160);
      v13 = *(_QWORD *)(a1 + v10 + 2168);
      v36 = *(_QWORD *)(a1 + v10 + 2168);
      ++v7;
      v9 = 0;
      if ( !v11 || v11 == v13 )
        continue;
      break;
    }
    v33 = v7;
    v14 = 0LL;
    LODWORD(v38) = 0;
    while ( 1 )
    {
      v18 = *(_QWORD *)(v11 + 32);
      v19 = *(_DWORD *)(*(_QWORD *)v11 + 8LL);
      if ( v12 )
      {
        LODWORD(v20) = v12;
        goto LABEL_47;
      }
      LODWORD(v20) = v14;
      if ( !(_DWORD)v14 )
        break;
LABEL_47:
      v28 = (v19 >> 16) & 0x7FFF;
      if ( !*(_BYTE *)(v11 + 25) )
      {
        v38 = v28 + ((unsigned int)v38 & 0xFFFFFFFF);
        goto LABEL_55;
      }
      if ( !*(_QWORD *)(v11 + 8) )
      {
        LODWORD(v38) = 0;
        KernelDebugLogInternal(
          1LL,
          1431519814LL,
          "AppleUSBEHCI::EHCIUIMDoDoneQueueProcessing pHCDoneTD->command is NULL (%p)");
LABEL_54:
        v14 = 0LL;
LABEL_55:
        a1 = arg1;
        goto LABEL_56;
      }
      IOUSBCommand::GetUSLCompletion((IOUSBCommand *)&v39);
      if ( v34 && v34 != v40 )
      {
        LODWORD(v38) = 0;
        KernelDebugLogInternal(1LL, 1431519814LL, "The EHCI driver has detected an error [safeAction != NULL]");
        goto LABEL_54;
      }
      *(_BYTE *)(v11 + 25) = 0;
      *(_QWORD *)(arg1 + 2808) -= ((_DWORD)v38 + (_DWORD)v28) & 0xFFFFFFFF;
      a1 = arg1;
      IOUSBController::Complete(arg1, (unsigned int)v20, (unsigned int)(v28 + v38));
      v15 = *(_QWORD *)(v11 + 16);
      if ( v15 )
      {
        LODWORD(v38) = 0;
        v14 = 0LL;
        if ( (unsigned __int8)(*(_BYTE *)(v15 + 72) - 1) <= 1u )
        {
          v16 = *(_DWORD *)(arg1 + 1688);
          if ( !v16 )
          {
            LODWORD(v38) = 0;
            KernelDebugLogInternal(
              1LL,
              1431519814LL,
              "AppleUSBEHCI::EHCIUIMDoDoneQueueProcessing - _controlBulkTransactionsOut underrun!");
            goto LABEL_21;
          }
          LODWORD(v38) = 0;
          v17 = v16 - 1;
          *(_DWORD *)(arg1 + 1688) = v17;
          v14 = 0LL;
          if ( !v17 )
          {
            LODWORD(v38) = 0;
            AppleUSBEHCI::DisableAsyncSchedule(arg1, 0);
LABEL_21:
            a1 = arg1;
            v14 = 0LL;
            goto LABEL_56;
          }
        }
      }
      else
      {
        LODWORD(v38) = 0;
        KernelDebugLogInternal(1LL, 1431519814LL, "The EHCI driver has detected an error [pHCDoneTD->pQH == NULL]");
        v14 = 0LL;
        a1 = arg1;
      }
LABEL_56:
      v29 = v14;
      *(_QWORD *)(v11 + 40) = 0LL;
      v30 = *(_QWORD *)(v11 + 16);
      if ( v30 )
        --*(_DWORD *)(v30 + 104);
      AppleUSBEHCI::DeallocateTD(a1, v11);
      v9 = 0;
      if ( v18 )
      {
        v11 = v18;
        v14 = v29;
        v12 = v35;
        if ( v18 != v36 )
          continue;
      }
      v7 = v33;
      goto LABEL_8;
    }
    v20 = *(_QWORD *)(v11 + 16);
    if ( !(v19 & 0x40) )
    {
      *(_BYTE *)(v20 + 71) = 0;
      v14 = 0LL;
      LODWORD(v20) = 0;
      goto LABEL_47;
    }
    if ( v19 & 0x20 )
    {
      v21 = ((v19 & 0x300) != 256) | 0xCLL;
    }
    else
    {
      if ( v19 & 4 && *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
        kernel_debug(
          0x52D5044u,
          arg1,
          *(_DWORD *)(*(_QWORD *)v11 + 8LL),
          *(_DWORD *)(*(_QWORD *)(arg1 + 168) + 28LL),
          1uLL,
          0LL);
      v21 = 8LL;
      if ( (v19 & 0x310) != 272 )
      {
        if ( BYTE1(v19) & 0xC )
        {
          v22 = (*(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v20) + 4) & 0x3000) == 0x2000;
          v21 = 4LL;
          if ( !v22 )
          {
            v22 = (unsigned __int8)*(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v20) + 8) == 0;
            v21 = 4LL;
            if ( v22 )
            {
              v23 = *(_BYTE *)(v20 + 71);
              *(_BYTE *)(v20 + 71) = 1 - v23;
              v21 = (v23 != 0) | 4LL;
            }
          }
        }
        else if ( v19 & 8 )
        {
          v24 = AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v20);
          v25 = 3758112843LL;
          v22 = (*(_DWORD *)(v24 + 4) & 0x3000) == 0x2000;
          v21 = 5LL;
          if ( !v22 )
            goto LABEL_46;
        }
        else
        {
          v21 = 5LL;
          if ( !(v19 & 1) )
          {
            v21 = 1LL;
            if ( *(_BYTE *)off_160C0[0] & 2 )
            {
              v21 = 1LL;
              if ( *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
              {
                kernel_debug(0x52D5044u, arg1, v19, 1uLL, 0LL, 0LL);
                v21 = 1LL;
              }
            }
          }
        }
      }
    }
    v25 = *((_DWORD *)TranslateStatusToUSBError(unsigned int)::statusToErrorMap + v21);
LABEL_46:
    v20 = v25;
    v26 = AppleEHCIQueueHead::GetSharedLogical(*(AppleEHCIQueueHead **)(v11 + 16));
    v14 = v20;
    v27 = *(_DWORD *)(v26 + 4);
    goto LABEL_47;
  }
  *(_DWORD *)(a1 + 2136) = v6 + 1;
  return 0LL;
}
// 15FC0: using guessed type __int64 TranslateStatusToUSBError(unsigned int)::statusToErrorMap[8];
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);
// 2DEC0: using guessed type int __fastcall IOUSBController::Complete(_QWORD, _QWORD, _QWORD);

//----- (0000000000008B9E) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::AddEmptyCBEndPoint(AppleUSBEHCI *this, unsigned __int64 a2, unsigned __int8 a3, unsigned __int16 a4, unsigned __int8 a5, unsigned __int16 a6, int a7, unsigned __int8 a8)
{
  unsigned __int8 v8; // r15@1
  __int64 v9; // r12@1
  __int64 result; // rax@1
  signed int v11; // ebx@2
  int v12; // ecx@4
  int v13; // ebx@6
  __int64 v14; // rax@6

  v8 = a5;
  v9 = AppleUSBEHCI::MakeEmptyEndPoint(this, a2, a3, a4, a5, a6, a7, a8);
  result = 0LL;
  if ( v9 )
  {
    v11 = 0;
    if ( a8 == 2 )
    {
      LODWORD(result) = (v8 != 2) << 27;
      v11 = 0x4000;
    }
    v12 = 0;
    if ( *(_BYTE *)(*((_QWORD *)this + 84) + 211LL) & 4 )
      v12 = *(_DWORD *)off_160A0[0] << 28;
    v13 = v12 | result | v11;
    v14 = AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v9);
    *(_DWORD *)(v14 + 4) |= v13;
    AppleUSBEHCI::linkAsyncEndpoint(this, (AppleEHCIQueueHead *)v9);
    result = v9;
  }
  return result;
}
// 160A0: using guessed type __int64 off_160A0[7];

//----- (0000000000008C3A) ----------------------------------------------------
void __fastcall AppleUSBEHCI::linkAsyncEndpoint(AppleUSBEHCI *this, AppleEHCIQueueHead *a2)
{
  uintptr_t v2; // r12@1
  uintptr_t v3; // rbx@1
  __int64 v4; // rax@1
  __int64 v5; // r14@1
  void (__fastcall *v6)(_QWORD, _QWORD); // r13@5
  __int64 v7; // rax@5
  uintptr_t v8; // r8@7
  uintptr_t v9; // rsi@7
  uintptr_t v10; // rdx@7
  __int64 v11; // rax@8
  __int64 v12; // rbx@8
  int v13; // er12@13
  __int64 v14; // r13@13
  __int64 v15; // rbx@17
  __int64 v16; // rsi@17
  uintptr_t arg2; // [sp+0h] [bp-30h]@17

  v2 = (uintptr_t)a2;
  v3 = *((_QWORD *)this + 217);
  LODWORD(v4) = (*(int (__fastcall **)(AppleEHCIQueueHead *))(*(_QWORD *)a2 + 296LL))(a2);
  v5 = v4;
  if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
  {
    a2 = this;
    kernel_debug(0x52D505Cu, (uintptr_t)this, v2, v3, 0LL, 0LL);
  }
  if ( v3 )
  {
    v6 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v2 + 280LL);
    LODWORD(v7) = (*(int (__fastcall **)(uintptr_t, AppleEHCIQueueHead *))(*(_QWORD *)v3 + 288LL))(v3, a2);
    v6(v2, v7);
    *(_QWORD *)(v2 + 32) = *(_QWORD *)(v3 + 32);
    *(_QWORD *)(v3 + 32) = v2;
    (*(void (__fastcall **)(uintptr_t, __int64))(*(_QWORD *)v3 + 280LL))(v3, v5);
    if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    {
      v8 = 4LL;
      v9 = (uintptr_t)this;
      v10 = v2;
LABEL_12:
      kernel_debug(0x52D505Cu, v9, v10, 0LL, v8, 0LL);
      return;
    }
  }
  else
  {
    v11 = AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v2);
    *(_DWORD *)(v11 + 4) |= 0x8000u;
    (*(void (__fastcall **)(uintptr_t, __int64))(*(_QWORD *)v2 + 280LL))(v2, v5);
    *(_QWORD *)(v2 + 32) = 0LL;
    *((_QWORD *)this + 217) = v2;
    v12 = *(_QWORD *)(v2 + 16);
    if ( (unsigned __int8)IOService::isInactive(this) )
    {
      if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      {
        v10 = 0LL;
        v8 = 3LL;
        v9 = (uintptr_t)this;
        goto LABEL_12;
      }
    }
    else
    {
      v13 = v12;
      *(_DWORD *)(*((_QWORD *)this + 88) + 24LL) = v12;
      v14 = off_160C0[0];
      if ( *(_DWORD *)(*((_QWORD *)this + 88) + 24LL) != (_DWORD)v12
        && *(_BYTE *)off_160C0[0] & 2
        && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D505Cu, (uintptr_t)this, (unsigned int)v12 & 0xFFFFFFFF, 0LL, 1uLL, 0LL);
      _mm_mfence();
      arg2 = (unsigned int)v12 & 0xFFFFFFFF;
      v15 = 0LL;
      v16 = off_160C8[0];
      do
      {
        if ( *(_DWORD *)(*((_QWORD *)this + 88) + 24LL) == v13 )
          break;
        if ( (_DWORD)v15 + 499 == 10
                                * ((unsigned int)(1717986919LL * ((signed int)v15 + 499) >> 34)
                                 + ((unsigned int)(1717986919LL * ((signed int)v15 + 499) >> 34) >> 31))
          && *(_BYTE *)v14 & 2
          && *(_DWORD *)v16 & 0xFFFFFFF7 )
          kernel_debug(0x52D505Cu, (uintptr_t)this, arg2, v15 + 499, 2uLL, 0LL);
        --v15;
      }
      while ( (_DWORD)v15 != -500 );
    }
  }
}
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];

//----- (0000000000008E92) ----------------------------------------------------
void __fastcall AppleUSBEHCI::checkHeads(AppleUSBEHCI *this)
{
  ;
}

//----- (0000000000008E98) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::UIMCreateControlEndpoint(AppleUSBEHCI *this)
{
  IOLog("EHCIUIM -- UIMCreateControlEndpoint old version called with no split params\n");
  return 3758097097LL;
}
// 2DAF8: using guessed type int __fastcall IOLog(_QWORD);

//----- (0000000000008EB2) ----------------------------------------------------
signed __int64 __fastcall AppleUSBEHCI::UIMCreateControlTransfer(AppleUSBEHCI *this, __int64 a2, __int64 a3, IOUSBCommand *a4, void *a5)
{
  return 3758097087LL;
}

//----- (0000000000008EBE) ----------------------------------------------------
signed __int64 AppleUSBEHCI::UIMCreateControlTransfer()
{
  return 3758097087LL;
}

//----- (0000000000008ECA) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::UIMCreateControlEndpoint(AppleUSBEHCI *this, int a2, unsigned __int8 a3, unsigned __int16 a4, unsigned __int8 a5, unsigned __int16 a6, int a7)
{
  signed int v7; // ebx@1
  __int64 v8; // rax@6
  const char *v9; // rdx@6

  v7 = 0;
  if ( *((_WORD *)this + 856) != a2 )
  {
    if ( a5 || a4 < 9u || (a4 = 8, !(_BYTE)a2) )
    {
      v8 = AppleUSBEHCI::AddEmptyCBEndPoint(this, (unsigned __int8)a2, a3, a4, a5, a6, a7, 2u);
      if ( v8 )
      {
        *(_BYTE *)(v8 + 72) = 2;
        v7 = 0;
        AppleUSBEHCI::printAsyncQueue((uintptr_t)this, 7, v9, 0LL, 0);
      }
      else
      {
        KernelDebugLogInternal(
          1LL,
          1431519814LL,
          "AppleUSBEHCI::UIMCreateControlEndpoint - could not add empty endpoint");
        v7 = -536870210;
      }
    }
    else
    {
      KernelDebugLogInternal(
        1LL,
        1431519814LL,
        "AppleUSBEHCI::UIMCreateControlEndpoint - incorrect max packet size (%d) for low speed");
      v7 = -536870206;
    }
  }
  return (unsigned int)v7;
}
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (0000000000008F94) ----------------------------------------------------
signed __int64 AppleUSBEHCI::UIMCreateControlTransfer()
{
  return 3758097087LL;
}

//----- (0000000000008FA0) ----------------------------------------------------
__int64 __usercall AppleUSBEHCI::UIMCreateControlTransfer@<rax>(AppleUSBEHCI *this@<rdi>, unsigned int a2@<edx>, __int64 a3@<rcx>, int a4@<esi>, __int64 a5@<r8>, unsigned int a6, unsigned __int16 a7)
{
  __int64 v7; // r14@1
  __int64 v8; // r12@1
  unsigned int v9; // er13@1
  __int64 v10; // rax@1
  signed int v11; // ebx@1
  const char *v12; // rdx@2
  char v14; // [sp+10h] [bp-40h]@1

  v7 = a5;
  v8 = a3;
  v9 = a2;
  IOUSBCommand::GetUSLCompletion((IOUSBCommand *)&v14);
  v10 = AppleUSBEHCI::FindControlBulkEndpoint(this, a4, (const OSMetaClass *)v9, 0LL, 2);
  v11 = -536854441;
  if ( v10 )
  {
    v11 = AppleUSBEHCI::allocateTDs((uintptr_t)this, (AppleEHCIQueueHead *)v10, v8, v7, a6, a7, 1u);
    if ( !v11 )
    {
      v11 = 0;
      AppleUSBEHCI::printAsyncQueue((uintptr_t)this, 7, v12, 0LL, 0);
      AppleUSBEHCI::EnableAsyncSchedule((uintptr_t)this, 0);
    }
  }
  return (unsigned int)v11;
}

//----- (0000000000009044) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::allocateTDs(uintptr_t a1, AppleEHCIQueueHead *a2, __int64 a3, __int64 a4, unsigned int a5, int a6, unsigned __int8 a7)
{
  IOUSBCommand *v7; // rbx@1
  AppleEHCIQueueHead *v8; // r15@1
  int v9; // er12@1
  int v10; // er13@1
  int v11; // er14@1
  IOUSBCommand *v12; // rdi@2
  uintptr_t v13; // rbx@2
  uintptr_t v14; // rsi@2
  uintptr_t v15; // rdx@5
  uintptr_t v16; // rcx@5
  IOUSBCommand *v17; // rdi@6
  unsigned __int64 v18; // rbx@6
  signed int v19; // ebx@13
  uintptr_t v20; // r14@18
  __int64 v21; // rax@22
  int v22; // eax@24
  __int64 v23; // rdi@24
  __int64 v24; // r15@28
  unsigned int v25; // er13@28
  unsigned __int64 v26; // rsi@31
  unsigned __int64 v27; // rdi@31
  unsigned int v28; // ecx@33
  int v29; // er10@33
  unsigned __int64 v30; // rdi@35
  AppleEHCIQueueHead *v31; // r15@35
  int v32; // eax@38
  unsigned __int64 v33; // rbx@42
  unsigned int v34; // edx@46
  unsigned __int64 v35; // r8@52
  __int64 v36; // r11@53
  char v37; // r9@53
  __int64 v38; // rbx@54
  __int64 v39; // rbx@54
  bool v40; // zf@54
  bool v41; // cf@54
  int v42; // eax@59
  int v43; // er12@62
  AppleEHCItdMemoryBlock *v44; // rax@63
  uintptr_t v45; // r15@63
  unsigned __int64 v46; // r12@65
  uintptr_t v47; // rdi@79
  __int64 v48; // rax@88
  int v49; // ecx@88
  uintptr_t v51; // [sp+8h] [bp-B8h]@28
  signed int v52; // [sp+10h] [bp-B0h]@24
  int v53; // [sp+1Ch] [bp-A4h]@62
  unsigned int v54; // [sp+28h] [bp-98h]@16
  unsigned int v55; // [sp+34h] [bp-8Ch]@1
  __int64 v56; // [sp+38h] [bp-88h]@1
  int v57; // [sp+44h] [bp-7Ch]@1
  unsigned __int64 v58; // [sp+48h] [bp-78h]@28
  AppleEHCIQueueHead *v59; // [sp+50h] [bp-70h]@24
  bool v60; // [sp+50h] [bp-70h]@50
  __int64 v61; // [sp+58h] [bp-68h]@1
  uintptr_t arg2; // [sp+60h] [bp-60h]@2
  uintptr_t arg1; // [sp+70h] [bp-50h]@1
  int v64; // [sp+7Ch] [bp-44h]@29
  unsigned __int64 v65; // [sp+80h] [bp-40h]@29
  unsigned int v66; // [sp+88h] [bp-38h]@33
  __int64 v67; // [sp+90h] [bp-30h]@29

  v55 = a5;
  v56 = a4;
  v7 = (IOUSBCommand *)a3;
  v8 = a2;
  arg1 = a1;
  v61 = *(_QWORD *)(*(_QWORD *)(a3 + 216) + 48LL);
  v9 = (((unsigned __int8)(a7 ^ 1) | (a6 == 2)) == 0) << 31;
  v57 = a6 << 8;
  v10 = (*(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical(a2) + 4) >> 16) & 0x7FF;
  v11 = (*(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical(a2) + 4) >> 8) & 0xF;
  if ( *(_BYTE *)off_160C0[0] & 0x80 )
  {
    v12 = v7;
    arg2 = (uintptr_t)v7;
    v13 = IOUSBCommand::GetUIMScratch64(v7, 0);
    v14 = 1LL;
    if ( v13 | IOUSBCommand::GetUIMScratch64(v12, 1u)
      && *(_BYTE *)off_160C0[0] & 2
      && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    {
      v14 = arg1;
      v15 = arg2;
      v16 = v13;
LABEL_10:
      kernel_debug(0x52D5040u, v14, v15, v16, 4uLL, 0LL);
      goto LABEL_11;
    }
  }
  else
  {
    v17 = v7;
    arg2 = (uintptr_t)v7;
    v18 = (unsigned __int64)(unsigned int)IOUSBCommand::GetUIMScratch(v7, 1u) << 32;
    v14 = 0LL;
    v16 = v18 | (unsigned int)IOUSBCommand::GetUIMScratch(v17, 0);
    if ( v16 && *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    {
      v14 = arg1;
      v15 = arg2;
      goto LABEL_10;
    }
  }
LABEL_11:
  if ( !v10 && a7 )
  {
    v19 = -536870174;
    if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D5040u, arg1, (unsigned __int16)v11, 0xFFFFFFFFE00002E2LL, 0LL, 0LL);
    return (unsigned int)v19;
  }
  v54 = v10;
  if ( *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical(v8) + 24) & 0x40 )
  {
    v19 = -536854449;
    if ( !(a7 & ((_WORD)v11 == 0)) )
      return (unsigned int)v19;
  }
  v20 = (uintptr_t)AppleUSBEHCI::AllocateTD((AppleUSBEHCI *)arg1, v14);
  ++*((_DWORD *)v8 + 26);
  if ( !v20 )
  {
    KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBEHCI::allocateTDs can't allocate 1st new TD");
    v19 = -536870211;
    return (unsigned int)v19;
  }
  if ( v56 && v55 )
  {
    if ( !v61 )
    {
      KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBEHCI::allocateTDs - no dmaCommand");
      AppleUSBEHCI::DeallocateTD(arg1, v20);
      --*((_DWORD *)v8 + 26);
      v19 = -536870211;
      return (unsigned int)v19;
    }
    LODWORD(v21) = (*(int (**)(void))(*(_QWORD *)v61 + 312LL))();
    if ( v21 != v56 )
    {
      (*(void (**)(void))(*(_QWORD *)v61 + 312LL))();
      KernelDebugLogInternal(
        1LL,
        1431519814LL,
        "AppleUSBEHCI::allocateTDs - mismatched CBP (%p) and dmaCommand memory descriptor (%p)");
      AppleUSBEHCI::DeallocateTD(arg1, v20);
      --*((_DWORD *)v8 + 26);
      v19 = -536870199;
      return (unsigned int)v19;
    }
  }
  v59 = v8;
  v22 = (*(_DWORD *)off_160C0[0] >> 8) & 3;
  v52 = 3072;
  v23 = v61;
  if ( v22 && v22 != 3 )
    v52 = v22 << 10;
  if ( v55 )
  {
    v51 = v20;
    v24 = 0LL;
    v25 = 0;
    v58 = 0LL;
    while ( 1 )
    {
      v67 = v24;
      v64 = 1;
      if ( (*(int (__fastcall **)(__int64, __int64 *, __int64 *, int *))(*(_QWORD *)v23 + 344LL))(v23, &v67, &v65, &v64)
        || v64 != 1
        || (v26 = v65, v27 = v65 >> 32, HIDWORD(v65)) && !*(_BYTE *)(arg1 + 1695) )
      {
        KernelDebugLogInternal(
          1LL,
          1431519814LL,
          "AppleUSBEHCI::allocateTDs - could not generate segments err (0x%x) numSegments (%d) fLength (%d)");
        v19 = -536870199;
        return (unsigned int)v19;
      }
      v28 = v66;
      v29 = v65 & 0xFFF;
      if ( v25 )
      {
        if ( v65 & 0xFFF )
          break;
      }
      if ( v66 > v55 )
        v28 = v55;
      v32 = (5 - v25) << 12;
      if ( v28 > ((5 - v25) << 12) - v29 )
      {
        if ( v25 == 0 && v29 != 0 )
          v32 = 0x4000;
        v28 = v32;
      }
      v58 = v28 + (unsigned int)v58;
      v33 = v24 + v28;
      if ( v25 == 4 )
      {
        v31 = v59;
        if ( v54 )
        {
          if ( 0x1000 % v54 )
          {
            if ( v33 < v55 )
            {
              v34 = (unsigned int)v58 % v54;
              if ( v28 > (unsigned int)v58 % v54 )
              {
                v28 -= v34;
                v58 = (unsigned int)v58 - v34;
                v33 -= v34;
              }
            }
          }
        }
      }
      else
      {
        v31 = v59;
      }
      if ( v33 >= v55 )
        v60 = 0;
      else
        v60 = (((_WORD)v28 + (_WORD)v65) & 0xFFF) != 0;
      v35 = v33;
      if ( v28 )
      {
        v36 = *(_QWORD *)v20;
        v37 = *(_BYTE *)(arg1 + 1695);
        do
        {
          v38 = v25;
          *(_DWORD *)(v36 + 4 * v38 + 32) = v27;
          ++v25;
          *(_DWORD *)(v36 + 4 * v38 + 12) = v26;
          v39 = (unsigned int)(4096 - v29);
          v40 = v39 + v26 == 0;
          v26 += v39;
          LODWORD(v27) = (v37 != 0 && v40) + (_DWORD)v27;
          v29 = 0;
          v41 = v28 < (unsigned int)v39;
          v28 -= v39;
        }
        while ( !v41 && v28 != 0 );
      }
      v30 = v35;
      if ( v25 > 4 )
        goto LABEL_59;
      if ( v35 >= v55 )
        goto LABEL_59;
      v19 = 0;
      if ( v60 )
        goto LABEL_59;
      v59 = v31;
LABEL_78:
      v41 = v30 < v55;
      v24 = v30;
      v23 = v61;
      if ( !v41 )
      {
        v8 = v59;
        v47 = v51;
        goto LABEL_88;
      }
    }
    v30 = v24;
    v31 = v59;
LABEL_59:
    *(_DWORD *)(v20 + 60) = v58;
    *(_DWORD *)(v20 + 64) = -1;
    *(_DWORD *)(v20 + 68) = 0;
    *(_DWORD *)(*(_QWORD *)v20 + 4LL) = *(_DWORD *)(v51 + 28);
    *(_BYTE *)(v20 + 24) = 0;
    *(_QWORD *)(v20 + 16) = v31;
    v42 = 0;
    if ( a7 )
    {
      v42 = v9;
      if ( (v54 - 1) / v54 & 1 )
        v42 = (v9 == 0) << 31;
    }
    v53 = v42;
    v43 = ((_DWORD)v58 << 16) | v52 | v57 | v9 | 0x8080;
    *(_QWORD *)(v20 + 8) = arg2;
    if ( v30 >= v55 )
    {
      *(_BYTE *)(v20 + 25) = 1;
      *(_QWORD *)(v20 + 40) = v56;
      *(_DWORD *)(*(_QWORD *)v20 + 8LL) = v43;
      *(_BYTE *)(v20 + 26) = IOUSBCommand::GetMultiTransferTransaction((IOUSBCommand *)arg2);
      *(_BYTE *)(v20 + 27) = IOUSBCommand::GetFinalTransferInTransaction((IOUSBCommand *)arg2);
      if ( (unsigned __int8)(*((_BYTE *)v31 + 72) - 1) <= 1u )
        ++*(_DWORD *)(arg1 + 1688);
      v19 = 0;
      if ( !(*(_BYTE *)off_160C0[0] & 2) )
      {
        v59 = v31;
        goto LABEL_77;
      }
      v46 = v30;
      v59 = v31;
      if ( *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      {
        v19 = 0;
        kernel_debug(0x52D5040u, arg1, v20, *(_DWORD *)(v20 + 60), 1uLL, 0LL);
      }
    }
    else
    {
      v59 = v31;
      *(_BYTE *)(v20 + 25) = 0;
      v44 = AppleUSBEHCI::AllocateTD((AppleUSBEHCI *)arg1, v58);
      v45 = (uintptr_t)v44;
      if ( !v44 )
      {
        KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBEHCI::allocateTDs can't allocate new TD");
        v19 = -536870211;
        goto LABEL_77;
      }
      ++*((_DWORD *)v59 + 26);
      **(_DWORD **)v20 = *((_DWORD *)v44 + 7);
      *(_QWORD *)(v20 + 32) = v44;
      *(_DWORD *)(*(_QWORD *)v20 + 8LL) = v43;
      v19 = 0;
      if ( !(*(_BYTE *)off_160C0[0] & 2) )
      {
        v58 = 0LL;
        v25 = 0;
        v20 = (uintptr_t)v44;
        goto LABEL_77;
      }
      v46 = v30;
      if ( *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      {
        v19 = 0;
        kernel_debug(0x52D5040u, arg1, v20, *(_DWORD *)(v20 + 60), 2uLL, 0LL);
      }
      v58 = 0LL;
      v25 = 0;
      v20 = v45;
    }
    v30 = v46;
LABEL_77:
    v9 = v53;
    goto LABEL_78;
  }
  *(_DWORD *)(*(_QWORD *)v20 + 4LL) = *(_DWORD *)(v20 + 28);
  *(_QWORD *)(v20 + 8) = arg2;
  *(_BYTE *)(v20 + 25) = 1;
  *(_BYTE *)(v20 + 26) = IOUSBCommand::GetMultiTransferTransaction((IOUSBCommand *)arg2);
  *(_BYTE *)(v20 + 27) = IOUSBCommand::GetFinalTransferInTransaction((IOUSBCommand *)arg2);
  if ( (unsigned __int8)(*((_BYTE *)v8 + 72) - 1) <= 1u )
    ++*(_DWORD *)(arg1 + 1688);
  *(_QWORD *)(v20 + 40) = v56;
  *(_BYTE *)(v20 + 24) = 0;
  *(_QWORD *)(v20 + 16) = v8;
  if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D5040u, arg1, v20, *(_DWORD *)(v20 + 60), 3uLL, 0LL);
  *(_DWORD *)(*(_QWORD *)v20 + 8LL) = v57 | v9 | v52 | 0x8080;
  v19 = 0;
  v47 = v20;
LABEL_88:
  v48 = *((_QWORD *)v8 + 6);
  **(_DWORD **)v20 = *(_DWORD *)(v47 + 28);
  *(_QWORD *)(v20 + 32) = v47;
  v49 = *(_DWORD *)(*(_QWORD *)v47 + 8LL);
  *(_DWORD *)(*(_QWORD *)v47 + 8LL) = 0;
  **(_DWORD **)v48 = **(_DWORD **)v47;
  *(_DWORD *)(*(_QWORD *)v48 + 4LL) = *(_DWORD *)(*(_QWORD *)v47 + 4LL);
  *(_DWORD *)(*(_QWORD *)v48 + 8LL) = 0;
  *(_DWORD *)(*(_QWORD *)v48 + 12LL) = *(_DWORD *)(*(_QWORD *)v47 + 12LL);
  *(_DWORD *)(*(_QWORD *)v48 + 16LL) = *(_DWORD *)(*(_QWORD *)v47 + 16LL);
  *(_DWORD *)(*(_QWORD *)v48 + 20LL) = *(_DWORD *)(*(_QWORD *)v47 + 20LL);
  *(_DWORD *)(*(_QWORD *)v48 + 24LL) = *(_DWORD *)(*(_QWORD *)v47 + 24LL);
  *(_DWORD *)(*(_QWORD *)v48 + 28LL) = *(_DWORD *)(*(_QWORD *)v47 + 28LL);
  *(_DWORD *)(*(_QWORD *)v48 + 32LL) = *(_DWORD *)(*(_QWORD *)v47 + 32LL);
  *(_DWORD *)(*(_QWORD *)v48 + 36LL) = *(_DWORD *)(*(_QWORD *)v47 + 36LL);
  *(_DWORD *)(*(_QWORD *)v48 + 40LL) = *(_DWORD *)(*(_QWORD *)v47 + 40LL);
  *(_DWORD *)(*(_QWORD *)v48 + 44LL) = *(_DWORD *)(*(_QWORD *)v47 + 44LL);
  *(_DWORD *)(*(_QWORD *)v48 + 48LL) = *(_DWORD *)(*(_QWORD *)v47 + 48LL);
  *(_QWORD *)(v48 + 16) = *(_QWORD *)(v47 + 16);
  *(_QWORD *)(v48 + 8) = *(_QWORD *)(v47 + 8);
  *(_BYTE *)(v48 + 25) = *(_BYTE *)(v47 + 25);
  *(_BYTE *)(v48 + 26) = *(_BYTE *)(v47 + 26);
  *(_BYTE *)(v48 + 27) = *(_BYTE *)(v47 + 27);
  *(_BYTE *)(v48 + 24) = *(_BYTE *)(v47 + 24);
  *(_QWORD *)(v48 + 32) = *(_QWORD *)(v47 + 32);
  *(_QWORD *)(v48 + 40) = *(_QWORD *)(v47 + 40);
  **(_DWORD **)v47 = 1;
  *(_DWORD *)(*(_QWORD *)v47 + 4LL) = 1;
  *(_QWORD *)(v47 + 32) = 0LL;
  *(_QWORD *)(v47 + 8) = 0LL;
  **(_DWORD **)v20 = *(_DWORD *)(v47 + 28);
  *(_QWORD *)(v20 + 32) = v47;
  *((_QWORD *)v8 + 6) = v47;
  *(_DWORD *)(*(_QWORD *)v48 + 8LL) = v49;
  _mm_mfence();
  return (unsigned int)v19;
}
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (000000000000993A) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::scavengeIsocTransactions(AppleUSBEHCI *this, void (__cdecl *a2)(void *, void *, int, unsigned int), char a3)
{
  __int64 v3; // rbx@1
  __int64 v4; // r14@1
  int v5; // er12@1
  __int64 v6; // rbx@1
  int v7; // er13@1
  const OSMetaClass *v8; // rdx@1
  int v9; // eax@1
  __int64 v10; // rcx@5
  const OSMetaClassBase *v11; // r12@9
  void (__cdecl *v12)(void *, void *, int, unsigned int); // rdx@10
  __int64 v13; // r13@10
  __int64 v14; // rax@10
  uintptr_t v15; // rbx@14
  __int64 v16; // r12@15
  __int64 v17; // r13@15
  const OSMetaClass *v18; // rdx@20
  char v20; // [sp+0h] [bp-2Ch]@1

  v20 = a3;
  v3 = *((_QWORD *)this + 206);
  v4 = 0LL;
  v5 = ml_set_interrupts_enabled(0LL, a2);
  IOSimpleLockLock(v3);
  v6 = *((_QWORD *)this + 203);
  v7 = *((_DWORD *)this + 408);
  IOSimpleLockUnlock(*((_QWORD *)this + 206));
  ml_set_interrupts_enabled((unsigned int)v5, a2);
  v9 = *((_DWORD *)this + 409);
  if ( v6 && v9 != v7 )
  {
    while ( 1 )
    {
      *(_QWORD *)(v6 + 32) = v4;
      ++v9;
      v10 = *(_QWORD *)(v6 + 40);
      if ( v10 )
      {
        --*(_DWORD *)(v10 + 104);
        ++*(_DWORD *)(v10 + 108);
      }
      if ( v7 == v9 )
        break;
      v4 = v6;
      v6 = *(_QWORD *)(v6 + 104);
    }
    *((_DWORD *)this + 409) = v7;
    if ( v6 )
    {
      v11 = *(const OSMetaClassBase **)off_16048[0];
      do
      {
        v13 = OSMetaClassBase::safeMetaCast(*(OSMetaClassBase **)(v6 + 32), v11, v8);
        *(_QWORD *)(v6 + 32) = 0LL;
        v14 = *(_QWORD *)(v6 + 40);
        if ( v14 )
          --*(_DWORD *)(v14 + 108);
        AppleUSBEHCI::scavengeAnIsocTD(this, (IOUSBControllerIsochListElement *)v6, v12);
        v6 = v13;
      }
      while ( v13 );
    }
  }
  if ( v20 )
  {
    v15 = OSMetaClassBase::safeMetaCast(
            *(OSMetaClassBase **)(*((_QWORD *)this + 54) + 136LL),
            (const OSMetaClassBase *)AppleEHCIIsochEndpoint::metaClass,
            v8);
    if ( v15 )
    {
      v16 = off_160C0[0];
      v17 = off_160C8[0];
      do
      {
        if ( *(_DWORD *)(v15 + 108) && *(_BYTE *)v16 & 2 && *(_DWORD *)v17 & 0xFFFFFFF7 )
          kernel_debug(0x52D5048u, (uintptr_t)this, v15, *(_DWORD *)(v15 + 108), 0LL, 0LL);
        (*(void (__fastcall **)(AppleUSBEHCI *, uintptr_t))(*(_QWORD *)this + 2840LL))(this, v15);
        AppleUSBEHCI::AddIsocFramesToSchedule(this, (AppleEHCIIsochEndpoint *)v15);
        v15 = OSMetaClassBase::safeMetaCast(
                *(OSMetaClassBase **)(v15 + 16),
                (const OSMetaClassBase *)AppleEHCIIsochEndpoint::metaClass,
                v18);
      }
      while ( v15 );
    }
  }
  return 0LL;
}
// 16048: using guessed type _QWORD off_16048[18];
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];
// 16CD8: using guessed type _QWORD AppleEHCIIsochEndpoint::metaClass;
// 2DB18: using guessed type int __fastcall IOSimpleLockLock(_QWORD);
// 2DB28: using guessed type int __fastcall IOSimpleLockUnlock(_QWORD);
// 2DEC8: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);
// 2E9D8: using guessed type int __fastcall ml_set_interrupts_enabled(_QWORD, _QWORD);

//----- (0000000000009ABC) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::scavengeAnIsocTD(AppleUSBEHCI *this, IOUSBControllerIsochListElement *a2, void (__cdecl *a3)(void *, void *, int, unsigned int))
{
  __int64 v3; // r15@1
  uint64_t v4; // rax@1
  __int64 v5; // rcx@5

  v3 = *((_QWORD *)a2 + 5);
  v4 = mach_absolute_time();
  if ( v3 )
  {
    if ( !*((_BYTE *)a2 + 80) )
      (*(void (__fastcall **)(IOUSBControllerIsochListElement *, uint64_t))(*(_QWORD *)a2 + 312LL))(a2, v4);
    (*(void (__fastcall **)(AppleUSBEHCI *, __int64, IOUSBControllerIsochListElement *, signed __int64))(*(_QWORD *)this + 2824LL))(
      this,
      v3,
      a2,
      1LL);
  }
  else
  {
    v5 = *((_QWORD *)a2 + 5);
    KernelDebugLogInternal(
      1LL,
      1431519814LL,
      "AppleUSBEHCI::scavengeAnIsocEndPoint - could not find endpoint associated with iTD (%p)");
  }
  return 0LL;
}
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (0000000000009B32) ----------------------------------------------------
void __fastcall AppleUSBEHCI::AddIsocFramesToSchedule(AppleUSBEHCI *this, AppleEHCIIsochEndpoint *a2)
{
  uintptr_t v2; // r13@1
  __int64 v3; // r8@6
  int v4; // ST08_4@8
  __int64 v5; // ST00_8@8
  unsigned __int64 v6; // rax@11
  unsigned __int64 v7; // r12@11
  uint64_t v8; // r14@11
  unsigned __int64 v9; // rdi@11
  IOUSBControllerListElement *v10; // r14@12
  IOUSBControllerListElement *v11; // rax@15
  IOUSBControllerListElement *v12; // rbx@15
  unsigned __int64 v13; // rax@19
  unsigned __int16 v14; // cx@24
  char v15; // al@24
  __int64 v16; // rbx@24
  int v17; // edx@26
  unsigned __int16 v18; // r12@27
  OSMetaClassBase *v19; // rax@29
  const OSMetaClass *v20; // rdx@29
  OSMetaClassBase *v21; // rax@34
  const OSMetaClass *v22; // rdx@34
  const OSMetaClass *v23; // rdx@34
  __int64 v24; // r13@34
  __int64 v25; // rbx@34
  __int64 v26; // rax@35
  const OSMetaClass *v27; // rdx@35
  __int64 v28; // r14@35
  __int64 v29; // rax@36
  __int64 v30; // rax@37
  __int64 v31; // rcx@38
  void (__fastcall *v32)(_QWORD, _QWORD); // r13@42
  __int64 v33; // rax@43
  void (__fastcall *v34)(_QWORD, _QWORD); // r13@43
  __int64 v35; // rax@43
  void (__fastcall *v36)(_QWORD, _QWORD); // rbx@45
  unsigned int v37; // eax@48
  __int16 v38; // [sp+10h] [bp-70h]@24
  uintptr_t v39; // [sp+18h] [bp-68h]@24
  char *v40; // [sp+20h] [bp-60h]@12
  __int64 v41; // [sp+28h] [bp-58h]@33
  IOUSBControllerListElement *v42; // [sp+38h] [bp-48h]@31
  const OSMetaClassBase *v43; // [sp+48h] [bp-38h]@24

  v2 = (uintptr_t)this;
  if ( !*((_QWORD *)a2 + 3) )
    return;
  if ( *((_BYTE *)a2 + 129) )
  {
    if ( *(_BYTE *)off_160C0[0] & 2 )
    {
      if ( *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D5088u, (uintptr_t)this, *((_WORD *)a2 + 57), *((_WORD *)a2 + 58), 1uLL, 0LL);
    }
    return;
  }
  v3 = *((_QWORD *)a2 + 5);
  if ( v3 && !*((_QWORD *)a2 + 6) )
  {
    v4 = *((_DWORD *)a2 + 23);
    v5 = *(_QWORD *)(v3 + 32);
    KernelDebugLogInternal(
      1LL,
      1431519814LL,
      "AppleUSBEHCI::AddIsocFramesToSchedule - inconsistent EP queue. pEP[%p] doneQueue[%p] doneEnd[%p] doneQueue->_logicalNext[%p] onDoneQueue[%d]");
    IOSleep(1LL);
  }
  if ( *(_DWORD *)(*((_QWORD *)this + 88) + 4LL) != -1 )
  {
    if ( !IOSimpleLockTryLock(*((_QWORD *)this + 207)) )
    {
      KernelDebugLogInternal(
        1LL,
        1431519814LL,
        "AppleUSBEHCI::AddIsocFramesToSchedule - could not obtain scheduling lock");
      return;
    }
    LODWORD(v6) = (*(int (__fastcall **)(AppleUSBEHCI *))(*(_QWORD *)this + 2456LL))(this);
    v7 = v6;
    v8 = mach_absolute_time();
    v9 = *(_QWORD *)(*((_QWORD *)a2 + 3) + 88LL);
    if ( v9 <= v7 + *(_BYTE *)(v2 + 1620) )
    {
      v40 = (char *)a2 + 96;
      do
      {
        LODWORD(v11) = (*(int (__fastcall **)(uintptr_t, AppleEHCIIsochEndpoint *))(*(_QWORD *)v2 + 2800LL))(v2, a2);
        v12 = v11;
        (*(void (__fastcall **)(IOUSBControllerListElement *, uint64_t))(*(_QWORD *)v11 + 312LL))(v11, v8);
        if ( *((_DWORD *)a2 + 24) <= 0 )
          (*(void (__fastcall **)(uintptr_t, AppleEHCIIsochEndpoint *, IOUSBControllerListElement *, signed __int64))(*(_QWORD *)v2 + 2824LL))(
            v2,
            a2,
            v12,
            1LL);
        else
          (*(void (__fastcall **)(uintptr_t, AppleEHCIIsochEndpoint *, IOUSBControllerListElement *))(*(_QWORD *)v2 + 2808LL))(
            v2,
            a2,
            v12);
        if ( !*((_QWORD *)a2 + 3) )
        {
          IOSimpleLockUnlock(*(_QWORD *)(v2 + 1656));
          (*(void (__fastcall **)(uintptr_t))(*(_QWORD *)v2 + 32LL))(v2);
          if ( thread_call_enter1(*(_QWORD *)(*(_QWORD *)(v2 + 432) + 152LL), a2) )
          {
            if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
            {
              a2 = (AppleEHCIIsochEndpoint *)v2;
              kernel_debug(0x52D5088u, v2, 0LL, 0LL, 2uLL, 0LL);
            }
            (*(void (__fastcall **)(uintptr_t, AppleEHCIIsochEndpoint *))(*(_QWORD *)v2 + 40LL))(v2, a2);
          }
          return;
        }
        LODWORD(v13) = (*(int (__fastcall **)(uintptr_t))(*(_QWORD *)v2 + 2456LL))(v2);
        if ( !v13 )
          goto LABEL_55;
        if ( v13 > v7 )
          v7 = v13;
        v9 = *(_QWORD *)(*((_QWORD *)a2 + 3) + 88LL);
      }
      while ( v9 <= v7 + *(_BYTE *)(v2 + 1620) );
      v10 = v12;
    }
    else
    {
      v40 = (char *)a2 + 96;
      v10 = 0LL;
    }
    v39 = v2;
    v38 = v7 & 0x3FF;
    v14 = v9 & 0x3FF;
    *((_WORD *)a2 + 56) = v9 & 0x3FF;
    v43 = *(const OSMetaClassBase **)off_16048[0];
    v15 = 1;
    v16 = 0LL;
    while ( 1 )
    {
      v17 = *(_WORD *)(v2 + 1812);
      if ( v14 == v17 || (v18 = (v14 + 1) & 0x3FF, v18 == (unsigned __int16)v17) )
      {
LABEL_54:
        (*(void (__fastcall **)(uintptr_t))(*(_QWORD *)v2 + 2456LL))(v2);
LABEL_55:
        IOSimpleLockUnlock(*(_QWORD *)(v2 + 1656));
        return;
      }
      if ( v15 & 1 )
      {
        LODWORD(v19) = (*(int (__fastcall **)(uintptr_t, AppleEHCIIsochEndpoint *))(*(_QWORD *)v2 + 2800LL))(v2, a2);
        v10 = v19;
        v16 = OSMetaClassBase::safeMetaCast(
                v19,
                (const OSMetaClassBase *)AppleEHCISplitIsochTransferDescriptor::metaClass,
                v20);
      }
      if ( v9 == *((_QWORD *)v10 + 11) )
        break;
      v15 = 0;
LABEL_50:
      if ( !v16 || !*(_BYTE *)(v16 + 112) )
      {
        ++v9;
        *((_WORD *)a2 + 56) = v18;
      }
      if ( !*((_QWORD *)a2 + 3) )
        goto LABEL_54;
      v14 = *((_WORD *)a2 + 56);
    }
    v42 = v10;
    if ( (unsigned int)*(_WORD *)(v2 + 1812) >= 0x401 )
      *(_WORD *)(v2 + 1812) = v38;
    v41 = v16;
    if ( *((_QWORD *)a2 + 17) )
    {
      v21 = (OSMetaClassBase *)AppleUSBEHCI::GetPeriodicListLogicalEntry((AppleUSBEHCI *)v2, *((_WORD *)a2 + 56));
      v24 = OSMetaClassBase::safeMetaCast(v21, v43, v22);
      v25 = 0LL;
      if ( v24 )
      {
        do
        {
          v26 = OSMetaClassBase::safeMetaCast(
                  (OSMetaClassBase *)v24,
                  (const OSMetaClassBase *)AppleEHCISplitIsochTransferDescriptor::metaClass,
                  v23);
          v28 = v26;
          if ( v26 )
          {
            v29 = OSMetaClassBase::safeMetaCast(
                    *(OSMetaClassBase **)(v26 + 40),
                    (const OSMetaClassBase *)AppleEHCIIsochEndpoint::metaClass,
                    v27);
            if ( v29 )
            {
              v30 = *(_QWORD *)(v29 + 136);
              if ( v30 )
              {
                v27 = *(const OSMetaClass **)(v30 + 40);
                v31 = *((_QWORD *)a2 + 17);
                if ( v27 == *(const OSMetaClass **)(v31 + 40)
                  && *(_WORD *)(v30 + 52) < (unsigned int)*(_WORD *)(v31 + 52) )
                  v25 = v28;
              }
            }
          }
          v24 = OSMetaClassBase::safeMetaCast(*(OSMetaClassBase **)(v24 + 32), v43, v27);
        }
        while ( v24 );
        v10 = v42;
        v32 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v42 + 280LL);
        if ( v25 )
        {
          LODWORD(v33) = (*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v25 + 288LL))(v25, v43);
          v32(v42, v33);
          *((_QWORD *)v42 + 4) = *(_QWORD *)(v25 + 32);
          *(_QWORD *)(v25 + 32) = v42;
          v34 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v25 + 280LL);
          LODWORD(v35) = (*(int (__fastcall **)(IOUSBControllerListElement *))(*(_QWORD *)v42 + 296LL))(v42);
          v34(v25, v35);
          v2 = v39;
LABEL_49:
          OSIncrementAtomic(v40);
          v15 = 1;
          v16 = v41;
          goto LABEL_50;
        }
        v2 = v39;
        v36 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v42 + 280LL);
      }
      else
      {
        v36 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v10 + 280LL);
        v2 = v39;
      }
    }
    else
    {
      v36 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v10 + 280LL);
    }
    v37 = AppleUSBEHCI::GetPeriodicListPhysicalEntry((AppleUSBEHCI *)v2, *((_WORD *)a2 + 56));
    v36(v10, v37);
    *((_QWORD *)v10 + 4) = AppleUSBEHCI::GetPeriodicListLogicalEntry((AppleUSBEHCI *)v2, *((_WORD *)a2 + 56));
    AppleUSBEHCI::SetPeriodicListEntry((AppleUSBEHCI *)v2, *((_WORD *)a2 + 56), v10);
    goto LABEL_49;
  }
}
// 16048: using guessed type _QWORD off_16048[18];
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];
// 16A78: using guessed type _QWORD AppleEHCISplitIsochTransferDescriptor::metaClass;
// 16CD8: using guessed type _QWORD AppleEHCIIsochEndpoint::metaClass;
// 2DB20: using guessed type int __fastcall IOSimpleLockTryLock(_QWORD);
// 2DB28: using guessed type int __fastcall IOSimpleLockUnlock(_QWORD);
// 2DB30: using guessed type int __fastcall IOSleep(_QWORD);
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);
// 2DB48: using guessed type int __fastcall OSIncrementAtomic(_QWORD);
// 2DEC8: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);
// 2E9F0: using guessed type int __fastcall thread_call_enter1(_QWORD, _QWORD);

//----- (000000000000A046) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::scavengeAnEndpointQueue(AppleUSBEHCI *this, IOUSBControllerListElement *a2, void (__cdecl *a3)(void *, void *, int, unsigned int))
{
  IOUSBControllerListElement *v3; // r12@1
  __int64 v4; // r14@2
  unsigned int v5; // er15@2
  __int64 v6; // rax@3
  AppleEHCIQueueHead *v7; // rbx@3
  __int64 v8; // r12@4
  __int64 v9; // r14@4
  int v10; // er9@6
  int v11; // er13@7
  __int64 v12; // r15@8
  char v13; // cl@8
  char v14; // r14@8
  int v15; // eax@9
  char v16; // r12@10
  AppleEHCIQueueHead *v17; // r13@11
  __int64 v18; // rbx@12
  int v19; // et1@14
  int v20; // eax@16
  int v21; // ebx@22
  bool v22; // zf@22
  char v23; // al@22
  int v24; // ebx@24
  __int64 v25; // rax@24
  int v26; // er12@26
  __int64 v27; // rbx@32
  __int64 v28; // rax@32
  int v29; // er14@36
  int v30; // er14@38
  int v31; // ecx@28
  int v32; // eax@28
  int v33; // ebx@45
  __int64 v34; // rcx@54
  __int64 v36; // [sp+0h] [bp-90h]@2
  char v37; // [sp+Fh] [bp-81h]@30
  __int64 v38; // [sp+10h] [bp-80h]@2
  unsigned int v39; // [sp+20h] [bp-70h]@7
  IOUSBControllerListElement *v40; // [sp+28h] [bp-68h]@4
  __int64 v41; // [sp+30h] [bp-60h]@4
  __int64 v42; // [sp+38h] [bp-58h]@7
  __int64 v43; // [sp+48h] [bp-48h]@7
  bool v44; // [sp+54h] [bp-3Ch]@8
  unsigned __int8 v45; // [sp+58h] [bp-38h]@8
  char v46; // [sp+5Fh] [bp-31h]@24
  int v47[12]; // [sp+60h] [bp-30h]@11
  int v48; // [sp+60h] [bp-30h]@35

  v3 = a2;
  if ( !a2 )
    return 0LL;
  v36 = (__int64)a3;
  v4 = 0LL;
  v5 = 0;
  v38 = 0LL;
  do
  {
    if ( v5 > 0x249EF )
      break;
    v6 = OSMetaClassBase::safeMetaCast(
           v3,
           (const OSMetaClassBase *)AppleEHCIQueueHead::metaClass,
           (const OSMetaClass *)a3);
    v7 = (AppleEHCIQueueHead *)v6;
    if ( !v6 )
      goto LABEL_52;
    v41 = v4;
    v40 = v3;
    v8 = *(_QWORD *)(v6 + 40);
    v9 = *(_QWORD *)(v6 + 48);
    if ( (v9 == 0 || v8 == 0) && v8 != v9 )
    {
      v10 = *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v6) + 4);
      KernelDebugLogInternal(
        1LL,
        1431519814LL,
        "The EHCI driver found a device queue with invalid head (%p) or tail (%p) - flags 0x%x");
    }
    v42 = v8;
    v43 = v9;
    v39 = v5;
    v11 = 0;
    while ( 2 )
    {
      v45 = 0;
      v12 = v42;
      v44 = 0;
      v13 = 0;
      v14 = 0;
      while ( 1 )
      {
        v15 = v11;
        if ( !v12 )
          goto LABEL_41;
        v16 = v13;
        if ( v12 == v43 )
          goto LABEL_41;
        v47[0] = v11;
        v17 = v7;
        if ( (unsigned int)v15 > 0x249EF )
          goto LABEL_46;
        v18 = *(_DWORD *)(*(_QWORD *)v12 + 8LL);
        if ( !(BYTE1(v18) & 0xC) )
        {
          ++*((_DWORD *)this + 707);
          if ( *(_BYTE *)off_160C0[0] & 4 )
          {
            v19 = *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical(v17) + 4);
            if ( (v18 & 0x48) == 72 )
            {
              if ( (_DWORD)v18 == *(_DWORD *)(v12 + 64) )
              {
                v20 = *(_DWORD *)(v12 + 68) + 1;
                *(_DWORD *)(v12 + 68) = v20;
                *(_DWORD *)(v12 + 64) = v18;
                if ( (unsigned int)v20 > 2 )
                {
                  ++*((_DWORD *)this + 717);
                  goto LABEL_18;
                }
                ++*((_DWORD *)this + 713);
                if ( v20 == 2 )
                  ++*((_DWORD *)this + 715);
              }
              else
              {
                *(_DWORD *)(v12 + 68) = 1;
                *(_DWORD *)(v12 + 64) = v18;
                ++*((_DWORD *)this + 713);
              }
              v33 = v18 & 0xFFFFFB00 | 0x480;
              *(_DWORD *)(*(_QWORD *)v12 + 8LL) = v33;
              *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical(v17) + 24) = v33;
              _mm_mfence();
LABEL_46:
              v32 = v47[0];
              goto LABEL_47;
            }
          }
        }
LABEL_18:
        if ( !((v45 | v44) & 1) )
        {
          if ( v18 & 0x80 )
            goto LABEL_46;
          *((_QWORD *)this + 351) += *(_DWORD *)(v12 + 60);
          v45 = ((unsigned __int8)v18 >> 6) & 1;
          if ( !_bittest((const unsigned __int64 *)&v18, 6u) )
            v44 = (v18 & 0x7FFF0000) != 0;
        }
        v21 = *(_DWORD *)(v12 + 28);
        v22 = v21 == *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical(v17) + 16);
        v23 = 1;
        if ( !v22 )
          v23 = v16;
        v46 = v23;
        v24 = *(_DWORD *)(v12 + 28);
        v25 = AppleEHCIQueueHead::GetSharedLogical(v17);
        LOBYTE(a3) = 1;
        if ( v24 != *(_DWORD *)(v25 + 20) )
          LOBYTE(a3) = v14;
        v7 = v17;
        v26 = v47[0];
        if ( *(_BYTE *)(v12 + 25) )
          break;
        v11 = v47[0] + 1;
        v12 = *(_QWORD *)(v12 + 32);
        v13 = v46;
        v14 = (char)a3;
        if ( !v12 )
        {
          v17 = v7;
          v31 = *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical(v7) + 4);
          KernelDebugLogInternal(
            1LL,
            1431519814LL,
            "The EHCI driver found a NULL Transfer Descriptor - Queue flags 0x%x");
          v32 = v47[0];
LABEL_47:
          v15 = v32 + 1;
          v3 = v40;
          v4 = v41;
          goto LABEL_48;
        }
      }
      v4 = v41;
      if ( v41 )
      {
        v37 = (char)a3;
        *(_QWORD *)(v38 + 32) = v42;
      }
      else
      {
        v37 = (char)a3;
        v4 = v42;
      }
      v42 = *(_QWORD *)(v12 + 32);
      v27 = *(_QWORD *)(v12 + 32);
      *(_QWORD *)(v12 + 32) = 0LL;
      *((_QWORD *)v17 + 5) = v27;
      v28 = AppleEHCIQueueHead::GetSharedLogical(v17);
      if ( v27 )
      {
        v7 = v17;
        v41 = v4;
        v11 = v47[0] + 1;
        v38 = v12;
        if ( *(_DWORD *)(v28 + 24) & 0x40 )
        {
          v38 = v12;
          if ( (v45 | v44) & 1 )
          {
            v48 = *(_DWORD *)(*(_QWORD *)v42 + 8LL);
            if ( v37 & 1 )
            {
              v29 = *(_DWORD *)(v42 + 28);
              *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical(v7) + 20) = v29;
              _mm_mfence();
            }
            if ( v46 & 1 )
            {
              v30 = *(_DWORD *)(v42 + 28);
              *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical(v7) + 16) = v30;
              _mm_mfence();
            }
            v38 = v12;
            if ( v48 & 0x80 )
            {
              v15 = v26 + 1;
              v38 = v12;
LABEL_41:
              v3 = v40;
              v4 = v41;
              v17 = v7;
              goto LABEL_48;
            }
          }
        }
        continue;
      }
      break;
    }
    v34 = *(_DWORD *)(v28 + 4);
    KernelDebugLogInternal(1LL, 1431519814LL, "The EHCI driver found a NULL Transfer Descriptor - Queue flags 0x%x");
    v15 = v47[0] + 1;
    v38 = v12;
    v3 = v40;
LABEL_48:
    v5 = v39;
    if ( (unsigned int)v15 > *((_DWORD *)v17 + 26) && *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D504Cu, (uintptr_t)this, (unsigned int)v15, 0LL, 0LL, 0LL);
LABEL_52:
    ++v5;
    v3 = (IOUSBControllerListElement *)*((_QWORD *)v3 + 4);
  }
  while ( v3 );
  if ( v4 )
    AppleUSBEHCI::EHCIUIMDoDoneQueueProcessing((__int64)this, v4, 0, v36, 0LL);
  return 0LL;
}
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];
// 165C0: using guessed type _QWORD AppleEHCIQueueHead::metaClass;
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);
// 2DEC8: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000000A47C) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::scavengeCompletedTransactions(AppleUSBEHCI *this, void (__cdecl *a2)(void *, void *, int, unsigned int))
{
  __int64 result; // rax@1
  IOUSBControllerListElement *v3; // rsi@1
  IOUSBControllerListElement *v4; // rsi@3
  int v5; // ebx@6
  IOUSBControllerListElement *v6; // rax@8

  result = AppleUSBEHCI::scavengeIsocTransactions(this, 0LL, 1);
  v3 = (IOUSBControllerListElement *)*((_QWORD *)this + 217);
  if ( v3 )
    result = AppleUSBEHCI::scavengeAnEndpointQueue(this, v3, 0LL);
  v4 = (IOUSBControllerListElement *)*((_QWORD *)this + 218);
  if ( v4 )
    result = AppleUSBEHCI::scavengeAnEndpointQueue(this, v4, 0LL);
  if ( *((_QWORD *)this + 102) )
  {
    v5 = 0;
    do
    {
      result = AppleUSBEHCI::GetPeriodicListLogicalEntry(this, v5);
      if ( result )
      {
        v6 = (IOUSBControllerListElement *)AppleUSBEHCI::GetPeriodicListLogicalEntry(this, v5);
        result = AppleUSBEHCI::scavengeAnEndpointQueue(this, v6, 0LL);
      }
      ++v5;
    }
    while ( v5 != 32 );
  }
  return result;
}

//----- (000000000000A4FC) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::UIMCreateBulkEndpoint(AppleUSBEHCI *this)
{
  return 3758097097LL;
}

//----- (000000000000A508) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::UIMCreateBulkEndpoint(AppleUSBEHCI *this, unsigned __int8 a2, unsigned __int8 a3, unsigned int a4, __int64 a5, unsigned __int16 a6, unsigned __int16 a7, int a8)
{
  __int64 v8; // rax@2
  const char *v9; // rdx@2
  signed int v10; // ebx@2

  if ( a4 >= 2 )
  {
    v10 = -536870206;
    if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D5054u, (uintptr_t)this, a2, a3, (unsigned __int8)a4, 0LL);
  }
  else
  {
    v8 = AppleUSBEHCI::AddEmptyCBEndPoint(this, a2, a3, a6, (a7 == 0) + 1, a7, a8, a4);
    v10 = -536870210;
    if ( v8 )
    {
      *(_BYTE *)(v8 + 72) = 1;
      v10 = 0;
      AppleUSBEHCI::printAsyncQueue((uintptr_t)this, 7, v9, 0LL, 0);
    }
  }
  return (unsigned int)v10;
}
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];

//----- (000000000000A5BA) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::UIMCreateBulkTransfer(AppleUSBEHCI *this, IOUSBCommand *a2)
{
  __int16 v2; // r13@1
  __int16 v3; // r15@1
  unsigned __int8 v4; // al@1
  __int64 v5; // r15@1
  signed int v6; // er12@1
  unsigned int v7; // eax@2
  __int64 v9; // [sp+10h] [bp-30h]@1

  v9 = IOUSBCommand::GetBuffer(a2);
  v2 = (unsigned __int8)IOUSBCommand::GetDirection(a2);
  v3 = IOUSBCommand::GetAddress(a2);
  v4 = IOUSBCommand::GetEndpoint(a2);
  v5 = AppleUSBEHCI::FindControlBulkEndpoint(this, v3, (const OSMetaClass *)v4, 0LL, v2);
  v6 = -536854441;
  if ( v5 )
  {
    v7 = IOUSBCommand::GetReqCount(a2);
    v6 = AppleUSBEHCI::allocateTDs(
           (uintptr_t)this,
           (AppleEHCIQueueHead *)v5,
           (__int64)a2,
           v9,
           v7,
           (unsigned __int16)v2,
           0);
    if ( v6 )
    {
      if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D5058u, (uintptr_t)this, v6, 0LL, 0LL, 0LL);
    }
    else
    {
      v6 = 0;
      AppleUSBEHCI::EnableAsyncSchedule((uintptr_t)this, 0);
    }
  }
  return (unsigned int)v6;
}
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];

//----- (000000000000A6A4) ----------------------------------------------------
signed __int64 AppleUSBEHCI::UIMCreateBulkTransfer()
{
  return 3758097087LL;
}

//----- (000000000000A6B0) ----------------------------------------------------
void __fastcall AppleUSBEHCI::returnTransactions(uintptr_t arg1, AppleEHCIQueueHead *this, __int64 a3, uintptr_t a4, unsigned __int8 a5)
{
  unsigned __int8 v5; // r13@1
  int v6; // er14@1
  __int64 v7; // r12@1
  uintptr_t v8; // r15@1
  int v9; // er8@5
  uintptr_t v10; // rcx@6
  __int64 v11; // rax@8
  int v12; // er13@10
  unsigned int v13; // er13@15
  __int64 v14; // rax@15
  __int64 v15; // r15@15
  unsigned __int64 v16; // r14@18
  unsigned __int64 v17; // rcx@18
  __int64 v18; // rcx@21
  int v19; // er14@24
  __int64 v20; // rax@25
  unsigned int v21; // er14@25
  uintptr_t v22; // rcx@27
  __int64 v23; // rax@29
  uintptr_t v24; // rcx@34
  uintptr_t v25; // rcx@38
  unsigned __int8 v26; // [sp+4h] [bp-4Ch]@10
  int v27; // [sp+14h] [bp-3Ch]@8
  __int64 v28; // [sp+18h] [bp-38h]@8

  v5 = a5;
  v6 = a4;
  v7 = a3;
  v8 = arg1;
  if ( *(_BYTE *)off_160C0[0] & 2 )
  {
    a4 = *(_DWORD *)(**((_QWORD **)this + 5) + 8LL);
    if ( *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D50C5u, arg1, (uintptr_t)this, a4, v6, 0LL);
  }
  (*(void (__fastcall **)(AppleEHCIQueueHead *, signed __int64, uintptr_t, uintptr_t))(*(_QWORD *)this + 312LL))(
    this,
    7LL,
    arg1,
    a4);
  if ( !(*(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical(this) + 24) & 0x40) )
  {
    v9 = *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical(this) + 24);
    KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBEHCI::returnTransactions, pED (%p) NOT HALTED (qTDFlags = 0x%x)");
    if ( *(_BYTE *)off_160C0[0] & 2 )
    {
      v10 = *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical(this) + 24);
      if ( *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D50C4u, arg1, (uintptr_t)this, v10, 0LL, 0LL);
    }
  }
  v27 = v6;
  v11 = *((_QWORD *)this + 5);
  v28 = 0LL;
  if ( v11 != *((_QWORD *)this + 6) && v11 != v7 )
  {
    v26 = v5;
    v12 = *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical(this) + 12);
    if ( !v7 )
    {
      if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D50C4u, arg1, (uintptr_t)this, *((_QWORD *)this + 6), 1uLL, 0LL);
      v7 = *((_QWORD *)this + 6);
    }
    v13 = v12 & 0xFFFFFFE0;
    v14 = *((_QWORD *)this + 5);
    v28 = *((_QWORD *)this + 5);
    v15 = 0LL;
    do
    {
      if ( *(_DWORD *)(v14 + 28) == v13 )
      {
        if ( *(_BYTE *)off_160C0[0] & 2 )
        {
          v16 = *(_DWORD *)(*(_QWORD *)v14 + 8LL);
          v17 = *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical(this) + 24);
          if ( *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
            kernel_debug(0x52D50C4u, v13, (v16 >> 16) & 0x7FFF, (v17 >> 16) & 0x7FFF, 4uLL, 0LL);
        }
        *(_DWORD *)(**((_QWORD **)this + 5) + 8LL) = *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical(this) + 24);
      }
      v18 = *((_QWORD *)this + 5);
      if ( v15 )
        *(_QWORD *)(v15 + 32) = v18;
      v14 = *(_QWORD *)(v18 + 32);
      *((_QWORD *)this + 5) = v14;
      v15 = v18;
    }
    while ( v14 != v7 );
    *(_QWORD *)(v18 + 32) = 0LL;
    *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical(this) + 20) = 1;
    v19 = *(_DWORD *)(v7 + 28);
    *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical(this) + 16) = v19;
    *((_QWORD *)this + 5) = v7;
    v11 = v7;
    v8 = arg1;
    v5 = v26;
  }
  *(_DWORD *)(*(_QWORD *)v11 + 8LL) &= 0xFFFFFFBF;
  _mm_mfence();
  v20 = AppleEHCIQueueHead::GetSharedLogical(this);
  v21 = *(_DWORD *)(*((_QWORD *)this + 5) + 28LL) & 0xFFFFFFE0;
  if ( *(_DWORD *)(v20 + 16) != v21 )
  {
    *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical(this) + 16) = v21;
    if ( *(_BYTE *)off_160C0[0] & 2 )
    {
      v22 = *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical(this) + 16);
      if ( *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D50C4u, v8, (uintptr_t)this, v22, 2uLL, 0LL);
    }
  }
  v23 = AppleEHCIQueueHead::GetSharedLogical(this);
  if ( v5 )
    *(_DWORD *)(v23 + 24) = 0;
  else
    *(_DWORD *)(v23 + 24) &= 0x80000000;
  _mm_mfence();
  if ( v28 )
  {
    if ( *(_BYTE *)off_160C0[0] & 2 )
    {
      v24 = *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical(this) + 24);
      if ( *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D50C4u, v8, (uintptr_t)this, v24, 3uLL, 0LL);
    }
    AppleUSBEHCI::EHCIUIMDoDoneQueueProcessing(v8, v28, v27, 0LL, 0LL);
  }
  if ( *(_BYTE *)off_160C0[0] & 2 )
  {
    v25 = *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical(this) + 24);
    if ( *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D50C6u, v8, (uintptr_t)this, v25, v5, 0LL);
  }
}
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (000000000000AA38) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::HaltAsyncEndpoint(uintptr_t arg1, AppleEHCIQueueHead *this, uintptr_t arg3)
{
  uintptr_t v3; // r15@1
  __int64 result; // rax@1
  __int64 v5; // rax@2
  __int64 v6; // rax@2

  v3 = arg3;
  result = *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical(this) + 24);
  if ( !(result & 0x40) )
  {
    AppleUSBEHCI::unlinkAsyncEndpoint(arg1, this, v3);
    v5 = AppleEHCIQueueHead::GetSharedLogical(this);
    *(_DWORD *)(v5 + 24) |= 0x40u;
    v6 = AppleEHCIQueueHead::GetSharedLogical(this);
    *(_DWORD *)(v6 + 24) &= 0xFFFFFF7F;
    AppleUSBEHCI::linkAsyncEndpoint((AppleUSBEHCI *)arg1, this);
    result = *(_BYTE *)(arg1 + 440);
    if ( (_DWORD)result == 2 )
      result = AppleUSBEHCI::EnableAsyncSchedule(arg1, 0);
  }
  return result;
}

//----- (000000000000AABA) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::AbortIsochEP(AppleUSBEHCI *this, uintptr_t arg1)
{
  AppleUSBEHCI *v2; // r12@1
  __int64 v3; // rax@5
  uint64_t v4; // r14@6
  __int64 v5; // rax@12
  uintptr_t v6; // r13@13
  int v7; // ebx@13
  unsigned int v8; // eax@14
  int v9; // esi@17
  const OSMetaClass *v10; // rdx@17
  __int64 v11; // r15@17
  __int64 v12; // r14@18
  __int64 v13; // r12@19
  uintptr_t v14; // rbx@19
  uintptr_t v15; // rax@20
  uintptr_t v16; // r13@20
  __int64 v17; // rax@21
  void (__fastcall *v18)(_QWORD, _QWORD); // rbx@28
  __int64 v19; // rax@28
  uintptr_t v20; // r14@28
  __int64 v21; // rax@46
  __int64 v22; // rbx@46
  __int64 v23; // rax@47
  __int64 v24; // r14@59
  int v25; // eax@59
  char v27; // [sp+0h] [bp-70h]@16
  int v28; // [sp+8h] [bp-68h]@15
  int v29; // [sp+10h] [bp-60h]@17
  int v30; // [sp+1Ch] [bp-54h]@17
  uintptr_t arg2; // [sp+20h] [bp-50h]@1
  uint64_t v32; // [sp+28h] [bp-48h]@13
  uintptr_t v33; // [sp+30h] [bp-40h]@16
  const OSMetaClassBase *v34; // [sp+40h] [bp-30h]@16

  arg2 = arg1;
  v2 = this;
  if ( !*(_QWORD *)(arg1 + 56)
    && !*(_QWORD *)(arg1 + 24)
    && !*(_QWORD *)(arg1 + 40)
    && !__PAIR__(*(_DWORD *)(arg1 + 88), *(_DWORD *)(arg1 + 84)) )
    v3 = *(_DWORD *)(arg1 + 96);
  *((_BYTE *)this + 1696) = 1;
  *(_BYTE *)(arg1 + 129) = 1;
  v4 = mach_absolute_time();
  while ( *((_BYTE *)this + 1640) )
    ;
  AppleUSBEHCI::scavengeIsocTransactions(this, 0LL, 0);
  if ( !*(_QWORD *)(arg1 + 56)
    && !*(_QWORD *)(arg1 + 24)
    && !*(_QWORD *)(arg1 + 40)
    && !__PAIR__(*(_DWORD *)(arg1 + 88), *(_DWORD *)(arg1 + 84)) )
    v5 = *(_DWORD *)(arg1 + 96);
  v6 = arg1;
  v32 = v4;
  v7 = *((_WORD *)this + 906);
  if ( (unsigned int)v7 > 0x3FF )
    goto LABEL_46;
  v8 = *(_WORD *)(arg1 + 112);
  if ( v8 > 0x3FF )
    goto LABEL_46;
  v28 = ((_WORD)v8 + 1) & 0x3FF;
  if ( v7 == v28 )
    goto LABEL_46;
  v34 = *(const OSMetaClassBase **)off_16048[0];
  v33 = arg1 + 96;
  v27 = 0;
  do
  {
    v9 = v7;
    v29 = v7;
    v7 = ((_WORD)v7 + 1) & 0x3FF;
    v30 = v7;
    v11 = AppleUSBEHCI::GetPeriodicListLogicalEntry(v2, v9);
    if ( !v11 )
    {
      if ( v7 != *(_WORD *)(v6 + 112) )
        *((_WORD *)v2 + 906) = v7;
      continue;
    }
    v12 = 0LL;
    while ( 2 )
    {
      v13 = v12;
      v14 = v6;
      while ( 1 )
      {
        v12 = v11;
        v11 = *(_QWORD *)(v11 + 32);
        v15 = OSMetaClassBase::safeMetaCast((OSMetaClassBase *)v12, v34, v10);
        v16 = v15;
        if ( !v15 )
        {
LABEL_42:
          v6 = v14;
          v2 = this;
          v7 = v30;
          goto LABEL_45;
        }
        v17 = *(_QWORD *)(v15 + 40);
        if ( v17 == v14 )
        {
          if ( v13 )
          {
            *(_QWORD *)(v13 + 32) = *(_QWORD *)(v12 + 32);
            v18 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v13 + 280LL);
            LODWORD(v19) = (*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v12 + 288LL))(v12, v34);
            v18(v13, v19);
            v20 = arg2;
            goto LABEL_33;
          }
          v20 = v14;
          AppleUSBEHCI::SetPeriodicListEntry(this, v29, (IOUSBControllerListElement *)v11);
          if ( !v11 )
          {
            v13 = 0LL;
            if ( v27 & 1 )
              goto LABEL_33;
            *((_WORD *)this + 906) = v30;
          }
          v13 = 0LL;
LABEL_33:
          (*(void (__fastcall **)(uintptr_t, uint64_t))(*(_QWORD *)v16 + 312LL))(v16, v32);
          OSDecrementAtomic(v33);
          v14 = v20;
          if ( *(_DWORD *)v33 < 0 && *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
            kernel_debug(0x52D5068u, (uintptr_t)this, v20, *(_DWORD *)v33, 2uLL, 0LL);
          (*(void (__fastcall **)(AppleUSBEHCI *, uintptr_t, uintptr_t, signed __int64))(*(_QWORD *)this + 2824LL))(
            this,
            v20,
            v16,
            1LL);
          goto LABEL_38;
        }
        if ( v17 )
          break;
        if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
          kernel_debug(0x52D5068u, (uintptr_t)this, v14, v16, 3uLL, 0LL);
        v13 = v12;
LABEL_38:
        if ( !v11 )
          goto LABEL_42;
      }
      v6 = v14;
      v27 = 1;
      v2 = this;
      v7 = v30;
      if ( v11 )
        continue;
      break;
    }
LABEL_45:
    ;
  }
  while ( v7 != v28 );
LABEL_46:
  LODWORD(v21) = (*(int (__fastcall **)(AppleUSBEHCI *, uintptr_t))(*(_QWORD *)v2 + 2800LL))(v2, v6);
  v22 = v21;
  if ( v21 )
  {
    do
    {
      (*(void (__fastcall **)(__int64, uint64_t))(*(_QWORD *)v22 + 312LL))(v22, v32);
      (*(void (__fastcall **)(AppleUSBEHCI *, uintptr_t, __int64, signed __int64))(*(_QWORD *)v2 + 2824LL))(
        v2,
        v6,
        v22,
        1LL);
      LODWORD(v23) = (*(int (__fastcall **)(AppleUSBEHCI *, uintptr_t))(*(_QWORD *)v2 + 2800LL))(v2, v6);
      v22 = v23;
    }
    while ( v23 );
  }
  if ( !*(_DWORD *)(v6 + 96) )
  {
    *(_QWORD *)(v6 + 72) = 0LL;
    *(_WORD *)(v6 + 112) = 1025;
  }
  *((_BYTE *)v2 + 1696) = 0;
  IOSleep(1LL);
  *(_DWORD *)(v6 + 120) = -536870165;
  (*(void (__fastcall **)(AppleUSBEHCI *, uintptr_t))(*(_QWORD *)v2 + 2840LL))(v2, v6);
  *(_DWORD *)(v6 + 120) = 0;
  if ( *(_QWORD *)(v6 + 56)
    || *(_QWORD *)(v6 + 24)
    || *(_QWORD *)(v6 + 40)
    || *(_DWORD *)(v6 + 84)
    || *(_DWORD *)(v6 + 88)
    || *(_DWORD *)(v6 + 96)
    || *(_DWORD *)(v6 + 100)
    || *(_DWORD *)(v6 + 108)
    || *(_DWORD *)(v6 + 92) )
  {
    v24 = off_160C0[0];
    v25 = *(_DWORD *)off_160C0[0];
    if ( *(_DWORD *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    {
      kernel_debug(0x52D5068u, v6, *((_WORD *)v2 + 906), *(_WORD *)(v6 + 112), 4uLL, 0LL);
      v25 = *(_DWORD *)v24;
    }
    if ( v25 & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    {
      kernel_debug(0x52D5068u, *(_DWORD *)(v6 + 84), *(_DWORD *)(v6 + 88), *(_QWORD *)(v6 + 24), 5uLL, 0LL);
      v25 = *(_DWORD *)v24;
    }
    if ( v25 & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D5068u, *(_DWORD *)(v6 + 100), *(_QWORD *)(v6 + 56), *(_DWORD *)(v6 + 96), 6uLL, 0LL);
    if ( *(_BYTE *)v24 & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D5068u, *(_DWORD *)(v6 + 104), *((_DWORD *)v2 + 409), *((_DWORD *)v2 + 408), 7uLL, 0LL);
    if ( *(_BYTE *)v24 & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D5068u, *(_DWORD *)(v6 + 108), *(_DWORD *)(v6 + 92), *(_QWORD *)(v6 + 40), 8uLL, 0LL);
  }
  *(_BYTE *)(v6 + 129) = 0;
  return 0LL;
}
// 16048: using guessed type _QWORD off_16048[18];
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];
// 2DB30: using guessed type int __fastcall IOSleep(_QWORD);
// 2DB40: using guessed type int __fastcall OSDecrementAtomic(_QWORD);
// 2DEC8: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000000AF92) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::HaltInterruptEndpoint(AppleUSBEHCI *this, AppleEHCIQueueHead *a2)
{
  __int64 result; // rax@1
  __int64 v3; // rax@2
  __int64 v4; // rax@2

  result = *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical(a2) + 24);
  if ( !(result & 0x40) )
  {
    AppleUSBEHCI::unlinkIntEndpoint(this, a2);
    v3 = AppleEHCIQueueHead::GetSharedLogical(a2);
    *(_DWORD *)(v3 + 24) |= 0x40u;
    v4 = AppleEHCIQueueHead::GetSharedLogical(a2);
    *(_DWORD *)(v4 + 24) &= 0xFFFFFF7F;
    result = AppleUSBEHCI::linkInterruptEndpoint(this, a2);
  }
  return result;
}

//----- (000000000000AFE8) ----------------------------------------------------
void __fastcall AppleUSBEHCI::maybeLinkAsyncEndpoint(AppleUSBEHCI *this, AppleEHCIQueueHead *a2)
{
  AppleUSBEHCI::linkAsyncEndpoint(this, a2);
}

//----- (000000000000AFF2) ----------------------------------------------------
void __fastcall AppleUSBEHCI::printTD(uintptr_t arg1, uintptr_t arg2, signed int a3)
{
  __int64 v3; // r15@3
  int v4; // eax@3
  int v5; // eax@21

  if ( arg2 && a3 <= 6 )
  {
    v3 = off_160C0[0];
    v4 = *(_DWORD *)off_160C0[0];
    if ( *(_DWORD *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    {
      kernel_debug(0x52D603Cu, arg1, arg2, *(_DWORD *)(arg2 + 28), *(_QWORD *)(arg2 + 32), 0LL);
      v4 = *(_DWORD *)v3;
    }
    if ( v4 & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      kernel_debug(
        0x52D6040u,
        arg1,
        **(_DWORD **)arg2,
        *(_DWORD *)(*(_QWORD *)arg2 + 4LL),
        *(_DWORD *)(*(_QWORD *)arg2 + 8LL),
        0LL);
    if ( *(_BYTE *)v3 & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      kernel_debug(
        0x52D6044u,
        arg1,
        *(_DWORD *)(*(_QWORD *)arg2 + 12LL),
        *(_DWORD *)(*(_QWORD *)arg2 + 16LL),
        *(_DWORD *)(*(_QWORD *)arg2 + 20LL),
        0LL);
    if ( *(_BYTE *)v3 & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D6048u, arg1, *(_DWORD *)(*(_QWORD *)arg2 + 24LL), *(_DWORD *)(*(_QWORD *)arg2 + 28LL), 0LL, 0LL);
    if ( *(_BYTE *)v3 & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      kernel_debug(
        0x52D604Cu,
        arg1,
        *(_DWORD *)(*(_QWORD *)arg2 + 32LL),
        *(_DWORD *)(*(_QWORD *)arg2 + 36LL),
        *(_DWORD *)(*(_QWORD *)arg2 + 40LL),
        0LL);
    if ( *(_BYTE *)v3 & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D6050u, arg1, *(_DWORD *)(*(_QWORD *)arg2 + 44LL), *(_DWORD *)(*(_QWORD *)arg2 + 48LL), 0LL, 0LL);
    v5 = *(_DWORD *)v3;
    if ( *(_DWORD *)v3 & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    {
      kernel_debug(0x52D6054u, arg1, *(_QWORD *)(arg2 + 40), *(_BYTE *)(arg2 + 25), *(_BYTE *)(arg2 + 26), 0LL);
      v5 = *(_DWORD *)v3;
    }
    if ( v5 & 2 )
    {
      if ( *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D6058u, arg1, *(_BYTE *)(arg2 + 27), 0LL, 0LL, 0LL);
    }
  }
}
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];

//----- (000000000000B1BA) ----------------------------------------------------
void __fastcall AppleUSBEHCI::printPeriodicList(AppleUSBEHCI *this, __int64 a2, const char *a3)
{
  ;
}

//----- (000000000000B1C0) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::MakeEmptyIntEndPoint(AppleUSBEHCI *this, unsigned __int64 a2, unsigned __int8 a3, unsigned __int16 a4, unsigned __int8 a5, unsigned __int16 a6, int a7, unsigned __int8 a8)
{
  __int64 v8; // rax@1
  __int64 v9; // rcx@1

  v8 = AppleUSBEHCI::MakeEmptyEndPoint(this, a2, a3, a4, a5, a6, a7, a8);
  v9 = 0LL;
  if ( v8 )
  {
    *(_BYTE *)(v8 + 72) = 3;
    v9 = v8;
  }
  return v9;
}

//----- (000000000000B1F4) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::UIMCreateInterruptEndpoint(AppleUSBEHCI *this)
{
  KernelDebugLogInternal(
    1LL,
    1431519814LL,
    "AppleUSBEHCI::UIMCreateInterruptEndpoint - old version called with no split params");
  return 3758097097LL;
}
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (000000000000B218) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::UIMCreateInterruptEndpoint(AppleUSBEHCI *this, int a2, __int16 a3, unsigned __int8 a4, __int16 a5, unsigned __int16 a6, __int16 a7, unsigned __int16 a8, int a9)
{
  __int16 v9; // r13@1
  int v10; // er15@2
  __int64 v11; // rax@5
  unsigned int v12; // ecx@5
  __int64 v13; // rax@8
  __int64 v14; // r13@8
  __int64 v15; // rax@9
  signed __int16 v16; // ax@10
  __int64 v17; // rdx@12
  AppleUSBEHCIHubInfo *v18; // rax@15
  int v19; // eax@19
  unsigned __int16 v21; // [sp+18h] [bp-48h]@5
  unsigned __int16 v22; // [sp+1Ch] [bp-44h]@5
  int v23; // [sp+24h] [bp-3Ch]@6
  unsigned int v24; // [sp+24h] [bp-3Ch]@8
  __int16 v25; // [sp+28h] [bp-38h]@4
  unsigned __int16 v26; // [sp+2Ch] [bp-34h]@5
  IOUSBControllerListElement *v27; // [sp+30h] [bp-30h]@5

  v9 = a3;
  if ( *((_WORD *)this + 856) == a2 )
  {
    v10 = (*(int (__fastcall **)(AppleUSBEHCI *, _QWORD))(*(_QWORD *)this + 3176LL))(this, (unsigned int)a7);
    return (unsigned int)v10;
  }
  v10 = -536870206;
  if ( a5 != 0 || a6 <= 8u )
  {
    v25 = a5;
    if ( a7 )
    {
      v22 = a6;
      v21 = a6;
      v26 = a4;
      v11 = AppleUSBEHCI::FindInterruptEndpoint(this, (signed __int16)a2, a3, a4, &v27);
      v12 = 0;
      if ( v11 )
      {
        v23 = *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v11) + 24);
        v10 = (*(int (__fastcall **)(AppleUSBEHCI *, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 2232LL))(
                this,
                (unsigned int)(signed __int16)a2,
                (unsigned int)v9,
                v26);
        if ( v10 )
          return (unsigned int)v10;
        v12 = v23 & 0x80000000;
      }
      v24 = v12;
      v13 = AppleUSBEHCI::MakeEmptyEndPoint(this, (unsigned __int8)a2, v9, v22, v25, a8, a9, v26);
      v14 = v13;
      if ( !v13 )
      {
        KernelDebugLogInternal(
          1LL,
          1431519814LL,
          "AppleUSBEHCI::UIMCreateInterruptEndpoint - could not create empty endpoint");
        v10 = -536870210;
        return (unsigned int)v10;
      }
      *(_BYTE *)(v13 + 72) = 3;
      *(_WORD *)(v13 + 64) = v21;
      *(_BYTE *)(v13 + 74) = a7;
      v15 = AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v13);
      *(_DWORD *)(v15 + 24) |= v24;
      if ( v25 == 2 )
      {
        v16 = -32768;
        if ( a7 <= 16 )
          v16 = 1 << (a7 - 1);
        *(_WORD *)(v14 + 78) = v16;
        v17 = 0LL;
LABEL_17:
        v10 = AppleUSBEHCI::AllocateInterruptBandwidth(this, (AppleEHCIQueueHead *)v14, (AppleUSBEHCITTInfo *)v17);
        if ( v10 )
        {
          AppleUSBEHCI::DeallocateED(this, (AppleEHCIQueueHead *)v14);
        }
        else
        {
          v19 = *(_BYTE *)(v14 + 75) + 1;
          if ( *((_DWORD *)this + 179) < v19 )
            *((_DWORD *)this + 179) = v19;
          AppleUSBEHCI::linkInterruptEndpoint(this, (AppleEHCIQueueHead *)v14);
          v10 = 0;
        }
        return (unsigned int)v10;
      }
      *(_WORD *)(v14 + 78) = a7;
      if ( !a8 )
      {
        AppleUSBEHCI::DeallocateED(this, (AppleEHCIQueueHead *)v14);
        v10 = -536870206;
        return (unsigned int)v10;
      }
      v18 = AppleUSBEHCIHubInfo::FindHubInfo(*((AppleUSBEHCIHubInfo **)this + 200), (AppleUSBEHCIHubInfo *)a8);
      v10 = -536870199;
      if ( v18 )
      {
        v17 = AppleUSBEHCIHubInfo::GetTTInfo(v18, (unsigned int)a9);
        if ( v17 )
          goto LABEL_17;
      }
    }
  }
  return (unsigned int)v10;
}
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (000000000000B446) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::AllocateInterruptBandwidth(AppleUSBEHCI *this, AppleEHCIQueueHead *a2, AppleUSBEHCITTInfo *a3)
{
  AppleUSBEHCITTInfo *v3; // r15@1
  AppleEHCIQueueHead *v4; // r11@1
  int v5; // edx@1
  signed int v6; // eax@1
  unsigned int v7; // esi@1
  char v8; // cl@5
  signed __int16 v9; // si@11
  signed __int16 v10; // dx@14
  char v11; // r9@14
  signed int v12; // esi@14
  char v13; // r8@14
  int v14; // er14@15
  int v15; // ecx@15
  signed int v16; // er15@20
  signed int v17; // er13@20
  __int64 v18; // r13@22
  AppleEHCIQueueHead *v19; // r12@22
  __int64 v20; // rax@22
  unsigned int v21; // ebx@24
  char *v22; // rax@26
  unsigned __int16 v23; // cx@26
  int v24; // eax@26
  signed int v25; // eax@32
  int v26; // esi@35
  __int64 v27; // rdx@35
  __int64 v28; // rdi@36
  signed __int64 v29; // rsi@37
  unsigned int v30; // edx@37
  __int64 v31; // rbx@45
  int v32; // eax@45
  __int64 v33; // rax@48
  __int64 v34; // rsi@49
  signed int v35; // eax@49
  int v36; // er11@49
  bool v37; // zf@49
  AppleUSBEHCISplitPeriodicEndpoint *v38; // rax@49
  __int64 v40; // r14@52
  unsigned int v41; // ebx@52
  unsigned int *v42; // rbx@52
  AppleUSBEHCI *v43; // [sp+8h] [bp-38h]@20
  int v44; // [sp+10h] [bp-30h]@21
  unsigned int v45; // [sp+14h] [bp-2Ch]@14

  v3 = a3;
  v4 = a2;
  v5 = *((_BYTE *)a2 + 73);
  LOWORD(v6) = *((_WORD *)a2 + 39);
  v7 = *((_WORD *)a2 + 39);
  if ( v5 == 2 )
  {
    if ( v7 >= 0x101 )
    {
      *((_WORD *)v4 + 39) = 256;
      LOWORD(v6) = 256;
    }
  }
  else
  {
    LOWORD(v6) = 32;
    if ( v7 <= 0x20 )
    {
      v8 = -1;
      do
        ++v8;
      while ( v7 >> v8 != 1 );
      v6 = 1 << v8;
    }
    *((_WORD *)v4 + 39) = v6;
  }
  if ( !*((_WORD *)v4 + 32) )
  {
    *(_WORD *)((char *)v4 + 75) = 0;
    goto LABEL_43;
  }
  if ( (unsigned __int8)v5 != 2 )
  {
    v17 = -536870206;
    if ( !v3 )
      return (unsigned int)v17;
    v31 = (__int64)v4;
    AppleUSBEHCITTInfo::ShowHSSplitTimeUsed(v3, *(_DWORD *)off_16098[0], "+AllocateInterruptBandwidth");
    v32 = *((_WORD *)v3 + 401);
    if ( *(_BYTE *)(v31 + 73) == 1 )
      LOWORD(v32) = *(_WORD *)(v31 + 64) + v32 + 13;
    else
      v32 += 8 * *(_WORD *)(v31 + 64) + 117;
    v33 = AppleUSBEHCISplitPeriodicEndpoint::NewSplitPeriodicEndpoint(
            v3,
            (AppleUSBEHCITTInfo *)((char *)&dword_0 + 3),
            (OSMetaClassBase *)v31,
            (OSObject *)(unsigned __int16)v32,
            *(_BYTE *)(v31 + 78));
    *(_QWORD *)(v31 + 56) = v33;
    v17 = -536870211;
    if ( !v33 )
      return (unsigned int)v17;
    v34 = v33;
    v35 = AppleUSBEHCITTInfo::AllocatePeriodicBandwidth(v3, (AppleUSBEHCISplitPeriodicEndpoint *)v33);
    v17 = v35;
    v37 = v35 == 0;
    v38 = *(AppleUSBEHCISplitPeriodicEndpoint **)(v31 + 56);
    if ( !v37 )
    {
      (*(void (__fastcall **)(_QWORD, __int64))(*(_QWORD *)v38 + 40LL))(*(_QWORD *)(v31 + 56), v34);
      *(_QWORD *)(v31 + 56) = 0LL;
      return (unsigned int)v17;
    }
    *(_BYTE *)(v31 + 75) = *((_BYTE *)v38 + 56);
    v40 = v31;
    AppleUSBEHCI::AllocateHSPeriodicSplitBandwidth(this, v38, v31, v36);
    v41 = *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v31) + 8) & 0xFFFF0000 | *(_BYTE *)(*(_QWORD *)(v40 + 56) + 59LL) | (*(_DWORD *)(*(_QWORD *)(v40 + 56) + 60LL) << 8);
    *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v40) + 8) = v41;
    AppleUSBEHCITTInfo::CalculateSPEsToAdjustAfterChange(v3, *(AppleUSBEHCISplitPeriodicEndpoint **)(v40 + 56), 1);
    AppleUSBEHCI::AdjustSPEs(this, *(AppleUSBEHCISplitPeriodicEndpoint **)(v40 + 56), 1LL);
    v42 = (unsigned int *)off_16098[0];
    AppleUSBEHCITTInfo::ShowHSSplitTimeUsed(v3, *(_DWORD *)off_16098[0], "-AllocateInterruptBandwidth");
    AppleUSBEHCITTInfo::print(v3, *v42, "-AllocateInterruptBandwidth");
LABEL_43:
    v17 = 0;
    return (unsigned int)v17;
  }
  v9 = 45;
  if ( *((_BYTE *)v4 + 70) == 1 )
    v9 = 25;
  LOWORD(v7) = *((_WORD *)this + 796) + v7;
  if ( !(_WORD)v6 )
    goto LABEL_41;
  v45 = 7 * (unsigned int)*((_WORD *)v4 + 32) / 6 + v7;
  v10 = -1;
  v11 = -1;
  v12 = 0;
  v13 = -1;
  do
  {
    v14 = v12 % 8;
    v15 = v12 / 8;
    if ( *((_WORD *)this + 8 * (v12 / 8) + v12 % 8 + 540) < (unsigned int)(unsigned __int16)v10 )
    {
      v10 = *((_WORD *)this + 8 * (unsigned __int8)v15 + (unsigned __int8)v14 + 540);
      v13 = v14;
      v11 = v15;
    }
    ++v12;
  }
  while ( v12 < (unsigned __int16)v6 );
  if ( (unsigned __int8)v11 == 255 || (unsigned __int8)v13 == 255 )
    goto LABEL_41;
  v43 = this;
  *((_BYTE *)v4 + 75) = v11;
  *((_BYTE *)v4 + 76) = v13;
  v16 = (unsigned __int8)v13 + 8 * (unsigned __int8)v11;
  v17 = 0;
  if ( v16 <= 255 )
  {
    v44 = 0;
    do
    {
      v18 = (unsigned __int16)((signed __int16)v16 % 8);
      v19 = v4;
      v20 = AppleEHCIQueueHead::GetSharedLogical(v4);
      *(_DWORD *)(v20 + 8) |= 1 << (signed __int16)v16 % 8;
      if ( (_WORD)v45 && (unsigned __int16)v45 <= 0x1770u )
      {
        v21 = (v16 + ((unsigned int)(v16 >> 31) >> 29)) >> 3;
        v4 = v19;
        if ( (unsigned __int16)v21 <= 0x20u && (unsigned int)v18 <= 8 )
        {
          v22 = (char *)this + 16 * (unsigned __int16)v21;
          v23 = v45 + *(_WORD *)&v22[2 * v18 + 1080];
          *(_WORD *)&v22[2 * v18 + 1080] = v23;
          v24 = v23;
          LOBYTE(v24) = 1;
          if ( v23 <= 0x1770u )
            v24 = v44;
          v44 = v24;
        }
      }
      else
      {
        v4 = v19;
      }
      v16 += *((_WORD *)v4 + 39);
    }
    while ( v16 < 256 );
    v17 = 0;
    if ( v44 & 1 )
    {
      v25 = *((_BYTE *)v4 + 76) + 8 * *((_BYTE *)v4 + 75);
      if ( v25 <= 255 )
      {
        do
        {
          if ( (_WORD)v45 )
          {
            if ( (unsigned __int16)v45 <= 0x1770u )
            {
              v26 = v25 + ((unsigned int)(v25 >> 31) >> 29);
              v27 = (unsigned __int16)(v25 / 8);
              if ( (unsigned int)v27 <= 0x20 )
              {
                v28 = (unsigned __int16)(v25 - (v26 & 0xFFF8));
                if ( (unsigned int)v28 <= 8 )
                {
                  v29 = (signed __int64)((char *)v43 + 16 * v27 + 2 * v28 + 1080);
                  v30 = *(_WORD *)v29;
                  if ( v30 >= (unsigned __int16)v45 )
                    *(_WORD *)v29 = v30 - v45;
                  else
                    *(_WORD *)v29 = 0;
                }
              }
            }
          }
          v25 += *((_WORD *)v4 + 39);
        }
        while ( v25 < 256 );
      }
LABEL_41:
      v17 = -536870164;
      return (unsigned int)v17;
    }
  }
  return (unsigned int)v17;
}
// 0: using guessed type int dword_0;
// 16098: using guessed type __int64 off_16098[8];

//----- (000000000000B854) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::linkInterruptEndpoint(AppleUSBEHCI *this, AppleEHCIQueueHead *a2)
{
  AppleEHCIQueueHead *v2; // rbx@1
  AppleUSBEHCI *v3; // r13@1
  unsigned __int8 v4; // r14@1
  int v5; // er15@1
  const OSMetaClassBase *v6; // r12@3
  int v7; // ebx@3
  __int64 v8; // r13@4
  IOPCIDevice *v9; // rsi@4
  const OSMetaClass *v10; // rdx@4
  const OSMetaClass *v11; // rdx@4
  __int64 v12; // r15@4
  __int64 v13; // rax@5
  __int64 v14; // r14@5
  signed __int64 v15; // rbx@6
  __int64 v16; // rbx@7
  const OSMetaClass *v17; // rdx@7
  __int64 v18; // rax@7
  AppleEHCIQueueHead *v19; // rax@11
  const OSMetaClass *v20; // rdx@11
  AppleEHCIQueueHead *v21; // r13@11
  signed __int64 v22; // rbx@15
  AppleEHCIQueueHead *v23; // rax@16
  AppleEHCIQueueHead *v24; // rax@17
  AppleEHCIQueueHead *v25; // r15@17
  bool v26; // zf@17
  bool v27; // cf@18
  int v28; // ebx@21
  __int64 v29; // rcx@22
  __int64 v30; // rax@22
  __int64 v31; // r14@25
  __int64 v32; // rax@25
  void (__fastcall *v33)(_QWORD, _QWORD); // rbx@28
  __int64 v34; // rax@28
  void (__fastcall *v35)(_QWORD, _QWORD); // r14@30
  unsigned int v36; // eax@30
  __int64 result; // rax@33
  IOPCIDevice *v38; // [sp+0h] [bp-50h]@3
  AppleEHCIQueueHead *v39; // [sp+8h] [bp-48h]@1
  int v40; // [sp+18h] [bp-38h]@1
  int v41; // [sp+18h] [bp-38h]@4
  unsigned int v42; // [sp+1Ch] [bp-34h]@3

  v2 = a2;
  v39 = a2;
  v3 = this;
  v40 = *((_BYTE *)a2 + 75);
  v4 = AppleEHCIQueueHead::NormalizedPollingRate(a2);
  (*(void (__fastcall **)(AppleEHCIQueueHead *, signed __int64, AppleUSBEHCI *))(*(_QWORD *)v2 + 312LL))(v2, 7LL, this);
  v5 = (*(int (__fastcall **)(AppleEHCIQueueHead *))(*(_QWORD *)v2 + 296LL))(v2);
  if ( *(_BYTE *)(*((_QWORD *)this + 84) + 209LL) & 0x10 )
    AppleUSBEHCI::DisablePrefetchRegister(*((IOPCIDevice **)this + 61), *((_QWORD *)this + 88));
  v6 = *(const OSMetaClassBase **)off_16048[0];
  v42 = v4;
  v38 = (IOPCIDevice *)(unsigned int)v5;
  v7 = v40;
  do
  {
    v41 = v7;
    v8 = AppleUSBEHCI::GetPeriodicListLogicalEntry(v3, v7);
    v9 = v6;
    v12 = OSMetaClassBase::safeMetaCast((OSMetaClassBase *)v8, v6, v10);
    if ( v12 )
    {
      v9 = v6;
      v13 = OSMetaClassBase::safeMetaCast(*(OSMetaClassBase **)(v8 + 32), v6, v11);
      v14 = *(_QWORD *)(v8 + 32);
      if ( v13 )
      {
        v15 = v8 + 32;
        do
        {
          v12 = OSMetaClassBase::safeMetaCast((OSMetaClassBase *)v14, v6, v11);
          v16 = *(_QWORD *)v15;
          v9 = v6;
          v18 = OSMetaClassBase::safeMetaCast(*(OSMetaClassBase **)(v16 + 32), v6, v17);
          v14 = *(_QWORD *)(v16 + 32);
          v15 = v16 + 32;
        }
        while ( v18 );
      }
    }
    else
    {
      v14 = v8;
    }
    if ( v14
      && ((v9 = (IOPCIDevice *)AppleEHCIQueueHead::metaClass,
           v19 = (AppleEHCIQueueHead *)OSMetaClassBase::safeMetaCast(
                                         (OSMetaClassBase *)v14,
                                         (const OSMetaClassBase *)AppleEHCIQueueHead::metaClass,
                                         v11),
           (v21 = v19) == 0LL)
       || (unsigned __int8)AppleEHCIQueueHead::NormalizedPollingRate(v19) >= v42) )
    {
      if ( *(_QWORD *)(v14 + 32) )
      {
        v22 = v14 + 32;
        do
        {
          v23 = 0LL;
          if ( v21 )
          {
            v9 = (IOPCIDevice *)AppleEHCIQueueHead::metaClass;
            v24 = (AppleEHCIQueueHead *)OSMetaClassBase::safeMetaCast(
                                          *((OSMetaClassBase **)v21 + 4),
                                          (const OSMetaClassBase *)AppleEHCIQueueHead::metaClass,
                                          v20);
            v25 = v24;
            v26 = v24 == 0LL;
            v23 = 0LL;
            if ( !v26 )
            {
              v27 = (unsigned __int8)AppleEHCIQueueHead::NormalizedPollingRate(v25) < v42;
              v23 = v25;
              if ( v27 )
                break;
            }
          }
          v14 = *(_QWORD *)v22;
          v22 = v14 + 32;
          v21 = v23;
        }
        while ( *(_QWORD *)(v14 + 32) );
      }
    }
    else
    {
      v14 = v12;
    }
    if ( v14 )
    {
      v3 = this;
      v28 = v41;
      if ( v39 != (AppleEHCIQueueHead *)v14 )
      {
        v29 = *((_QWORD *)v39 + 4);
        v30 = *(_QWORD *)(v14 + 32);
        if ( v29 )
        {
          if ( v29 != v30 )
            KernelDebugLogInternal(
              1LL,
              1431519814LL,
              "The Apple EHCI driver has found an endpoint with an incorrect link in the middle.");
        }
        else
        {
          *((_QWORD *)v39 + 4) = v30;
          v33 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v39 + 280LL);
          LODWORD(v34) = (*(int (__fastcall **)(__int64, IOPCIDevice *))(*(_QWORD *)v14 + 288LL))(v14, v9);
          v33(v39, v34);
          v28 = v41;
        }
        *(_QWORD *)(v14 + 32) = v39;
        v9 = v38;
        (*(void (__fastcall **)(__int64, IOPCIDevice *))(*(_QWORD *)v14 + 280LL))(v14, v38);
      }
    }
    else
    {
      v31 = *((_QWORD *)v39 + 4);
      v3 = this;
      v28 = v41;
      v32 = AppleUSBEHCI::GetPeriodicListLogicalEntry(this, v41);
      if ( v31 )
      {
        if ( v31 != v32 )
          KernelDebugLogInternal(
            1LL,
            1431519814LL,
            "The Apple EHCI driver has found an endpoint with an incorrect link at the begining.");
      }
      else
      {
        *((_QWORD *)v39 + 4) = v32;
        v35 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v39 + 280LL);
        v36 = AppleUSBEHCI::GetPeriodicListPhysicalEntry(this, v41);
        v35(v39, v36);
      }
      v9 = (IOPCIDevice *)(unsigned int)v41;
      AppleUSBEHCI::SetPeriodicListEntry(this, v41, v39);
    }
    v7 = v42 + v28;
  }
  while ( v7 < 1024 );
  ++*((_DWORD *)v3 + 425);
  result = *((_QWORD *)v3 + 84);
  if ( *(_BYTE *)(result + 209) & 0x10 )
    result = AppleUSBEHCI::EnablePrefetchRegister(*((AppleUSBEHCI **)v3 + 61), v9);
  return result;
}
// 16048: using guessed type _QWORD off_16048[18];
// 165C0: using guessed type _QWORD AppleEHCIQueueHead::metaClass;
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);
// 2DEC8: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000000BB1A) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::UIMCreateInterruptTransfer(AppleUSBEHCI *this, IOUSBCommand *a2)
{
  IOUSBCommand *v2; // r13@1
  __int64 v3; // r12@1
  unsigned __int8 v4; // r15@1
  int v5; // ebx@1
  __int64 v6; // rbx@2
  __int64 v7; // rax@3
  int (__fastcall *v8)(_QWORD, _QWORD, _QWORD); // rbx@6
  unsigned int v9; // eax@6
  int v10; // er12@6
  __int16 v11; // bx@7
  unsigned __int8 v12; // al@7
  int v13; // esi@7
  int v14; // ebx@7
  __int64 v15; // r15@7
  __int64 v16; // rax@11
  unsigned int v17; // eax@11
  unsigned __int16 v18; // ax@13
  uintptr_t v19; // rcx@14
  uintptr_t v20; // rdx@14
  uintptr_t v21; // r8@14
  unsigned int v22; // eax@15
  unsigned __int8 v23; // al@17
  __int64 v25; // [sp+18h] [bp-78h]@8
  __int64 v26; // [sp+50h] [bp-40h]@1

  v2 = a2;
  IOUSBCommand::GetUSLCompletion((IOUSBCommand *)&v26);
  v3 = IOUSBCommand::GetBuffer(a2);
  v4 = IOUSBCommand::GetDirection(a2);
  v5 = *((_WORD *)this + 856);
  if ( v5 == (unsigned __int16)IOUSBCommand::GetAddress(a2) )
  {
    v6 = *(_QWORD *)(*((_QWORD *)a2 + 27) + 48LL);
    if ( v6 )
    {
      LODWORD(v7) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v6 + 312LL))(v6);
      if ( v7 )
        (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v6 + 304LL))(v6, 1LL);
    }
    if ( (unsigned __int8)IOUSBCommand::GetEndpoint(a2) == 1 )
    {
      v8 = *(int (__fastcall **)(_QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 2992LL);
      v9 = IOUSBCommand::GetReqCount(a2);
      v10 = v8(this, v3, v9);
    }
    else
    {
      v22 = IOUSBCommand::GetReqCount(a2);
      v10 = -536854441;
      IOUSBController::Complete(this, 3758112855LL, v22);
    }
    return (unsigned int)v10;
  }
  v11 = IOUSBCommand::GetAddress(a2);
  v12 = IOUSBCommand::GetEndpoint(a2);
  v13 = v11;
  v14 = v4;
  v15 = AppleUSBEHCI::FindInterruptEndpoint(this, v13, v12, v4, 0LL);
  if ( !v15 )
  {
    v10 = -536854441;
    if ( !(*(_BYTE *)off_160C0[0] & 2) )
      return (unsigned int)v10;
    v23 = IOUSBCommand::GetEndpoint(v2);
    if ( !(*(_DWORD *)off_160C8[0] & 0xFFFFFFF7) )
      return (unsigned int)v10;
    v20 = v23;
    v19 = -536854441LL;
    v21 = 1LL;
LABEL_19:
    kernel_debug(0x52D5070u, (uintptr_t)this, v20, v19, v21, 0LL);
    return (unsigned int)v10;
  }
  v25 = v3;
  if ( *(_BYTE *)(*((_QWORD *)this + 84) + 209LL) & 0x10 )
    AppleUSBEHCI::DisablePrefetchRegister(*((IOPCIDevice **)this + 61), *((_QWORD *)this + 88));
  v10 = -536870164;
  if ( *(_WORD *)(v15 + 64) )
  {
    v16 = IOUSBCommand::GetBuffer(v2);
    v17 = (*(int (__fastcall **)(__int64))(*(_QWORD *)v16 + 456LL))(v16);
    v10 = AppleUSBEHCI::allocateTDs((uintptr_t)this, (AppleEHCIQueueHead *)v15, (__int64)v2, v25, v17, v14, 0);
    if ( !v10 )
    {
      v10 = 0;
      AppleUSBEHCI::EnablePeriodicSchedule(this, 0LL);
      return (unsigned int)v10;
    }
    if ( *(_BYTE *)off_160C0[0] & 2 )
    {
      v18 = IOUSBCommand::GetAddress(v2);
      if ( *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      {
        v19 = v10;
        v20 = v18;
        v21 = 2LL;
        goto LABEL_19;
      }
    }
  }
  return (unsigned int)v10;
}
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];
// 2DEC0: using guessed type int __fastcall IOUSBController::Complete(_QWORD, _QWORD, _QWORD);

//----- (000000000000BDB6) ----------------------------------------------------
signed __int64 AppleUSBEHCI::UIMCreateInterruptTransfer()
{
  return 3758097087LL;
}

//----- (000000000000BDC2) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::UIMCreateIsochEndpoint(AppleUSBEHCI *this)
{
  KernelDebugLogInternal(
    1LL,
    1431519814LL,
    "AppleUSBEHCI::UIMCreateIsochEndpoint -- old version called with no split params");
  return 3758097087LL;
}
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (000000000000BDE6) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::UIMCreateIsochEndpoint(AppleUSBEHCI *this)
{
  KernelDebugLogInternal(
    1LL,
    1431519814LL,
    "AppleUSBEHCI::UIMCreateIsochEndpoint -- old version called with no interval");
  return 3758097087LL;
}
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (000000000000BE0A) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::UIMCreateIsochEndpoint(AppleUSBEHCI *this, __int16 a2, __int16 a3, unsigned int a4, unsigned __int8 a5, unsigned __int16 a6, int a7, unsigned __int8 a8)
{
  __int16 v8; // r14@2
  AppleUSBEHCIHubInfo *v9; // rax@2
  signed int v10; // er12@2
  __int64 v11; // rax@3
  __int64 v12; // rsi@8
  unsigned int v13; // er13@8
  AppleUSBEHCI *v14; // r15@8
  OSMetaClassBase *v15; // rax@8
  const OSMetaClass *v16; // rdx@8
  __int64 v17; // rax@8
  __int64 v18; // rbx@8
  int v19; // er10@10
  unsigned int v20; // ecx@11
  OSMetaClassBase *v21; // rax@12
  const OSMetaClass *v22; // rdx@12
  __int64 v23; // rax@12
  AppleUSBEHCITTInfo *v24; // rcx@12
  unsigned int v25; // edi@18
  signed int v26; // er14@21
  signed int v28; // [sp+4h] [bp-4Ch]@4
  AppleUSBEHCITTInfo *v29; // [sp+8h] [bp-48h]@4
  unsigned __int8 v30; // [sp+18h] [bp-38h]@2
  unsigned __int16 v31; // [sp+18h] [bp-38h]@8
  unsigned __int16 v32; // [sp+1Ch] [bp-34h]@2
  unsigned int v33; // [sp+20h] [bp-30h]@2

  if ( a6 )
  {
    v30 = a5;
    v8 = a3;
    v33 = a4;
    v32 = a6;
    v9 = AppleUSBEHCIHubInfo::FindHubInfo(*((AppleUSBEHCIHubInfo **)this + 200), (AppleUSBEHCIHubInfo *)a6);
    v10 = -536870199;
    if ( !v9 )
      return (unsigned int)v10;
    v11 = AppleUSBEHCIHubInfo::GetTTInfo(v9, (unsigned int)a7);
    if ( !v11 )
      return (unsigned int)v10;
    v29 = (AppleUSBEHCITTInfo *)v11;
    v28 = a8;
    a3 = v8;
    a5 = v30;
  }
  else
  {
    if ( (unsigned __int8)(a8 - 1) >= 0x10u )
    {
      KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBEHCI::UIMCreateIsochEndpoint: bad interval %d");
      v10 = -536870206;
      return (unsigned int)v10;
    }
    v32 = a6;
    v33 = a4;
    v28 = 1 << (a8 - 1);
    v29 = 0LL;
  }
  v31 = a5;
  v12 = (unsigned int)a2;
  v13 = a3;
  v10 = 0;
  v14 = this;
  LODWORD(v15) = (*(int (__fastcall **)(AppleUSBEHCI *, __int64, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 2776LL))(
                   this,
                   v12,
                   (unsigned int)a3,
                   a5,
                   0LL);
  v17 = OSMetaClassBase::safeMetaCast(v15, (const OSMetaClassBase *)AppleEHCIIsochEndpoint::metaClass, v16);
  v18 = v17;
  if ( v17 )
  {
    if ( *(_DWORD *)(v17 + 80) == v33 )
      return (unsigned int)v10;
    AppleUSBEHCI::ReturnIsochBandwidth(this, (AppleEHCIIsochEndpoint *)v17);
    *(_DWORD *)(v18 + 80) = v33;
    if ( v33 < 0x401 )
    {
      *(_WORD *)(v18 + 154) = 1;
      *(_WORD *)(v18 + 152) = v33;
    }
    else
    {
      *(_WORD *)(v18 + 154) = ((v33 + 0x3FFFFFF) >> 10) + 1;
      v20 = (signed __int16)(((v33 + 0x3FFFFFF) >> 10) + 1);
      *(_WORD *)(v18 + 152) = (v33 + v20 - 1) / v20;
    }
    v24 = v29;
  }
  else
  {
    LODWORD(v21) = (*(int (__fastcall **)(AppleUSBEHCI *, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 2784LL))(
                     this,
                     (unsigned int)v12,
                     v13,
                     v31);
    v23 = OSMetaClassBase::safeMetaCast(v21, (const OSMetaClassBase *)AppleEHCIIsochEndpoint::metaClass, v22);
    v18 = v23;
    v10 = -536870211;
    v24 = v29;
    if ( !v23 )
      return (unsigned int)v10;
    *(_WORD *)(v23 + 156) = v32;
    *(_DWORD *)(v23 + 160) = a7;
    *(_DWORD *)(v23 + 124) = v28;
    if ( v29 )
    {
      *(_BYTE *)(v23 + 165) = 1;
    }
    else
    {
      *(_BYTE *)(v23 + 165) = 2;
      if ( v33 < 0x401 )
      {
        *(_WORD *)(v23 + 154) = 1;
        *(_WORD *)(v23 + 152) = v33;
      }
      else
      {
        *(_WORD *)(v23 + 154) = ((v33 + 0x3FFFFFF) >> 10) + 1;
        v25 = (signed __int16)(((v33 + 0x3FFFFFF) >> 10) + 1);
        *(_WORD *)(v23 + 152) = (v33 + v25 - 1) / v25;
      }
    }
    this = v14;
    *(_DWORD *)(v23 + 80) = v33;
    *(_WORD *)(v23 + 112) = 1025;
    *(_QWORD *)(v23 + 144) = v29;
  }
  v26 = AppleUSBEHCI::AllocateIsochBandwidth(this, (AppleEHCIIsochEndpoint *)v18, v24, v19);
  v10 = 0;
  if ( v26 )
  {
    *(_DWORD *)(v18 + 80) = 0;
    AppleUSBEHCI::DeleteIsochEP(this, (AppleEHCIIsochEndpoint *)v18);
    v10 = v26;
  }
  return (unsigned int)v10;
}
// 16CD8: using guessed type _QWORD AppleEHCIIsochEndpoint::metaClass;
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);
// 2DEC8: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000000C08E) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::ReturnIsochBandwidth(AppleUSBEHCI *this, AppleEHCIIsochEndpoint *a2)
{
  AppleEHCIIsochEndpoint *v2; // rbx@1
  AppleUSBEHCI *v3; // r15@1
  int v4; // ecx@1
  signed int v5; // er14@1
  bool v6; // zf@3
  int v7; // eax@3
  __int64 v8; // rcx@5
  int v9; // edx@5
  int v10; // esi@5
  int v11; // eax@6
  int v12; // er8@6
  signed int v13; // ebx@6
  int v14; // edx@9
  __int64 v15; // rdi@9
  __int64 v16; // rcx@10
  signed __int64 v17; // rdx@11
  unsigned int v18; // ecx@11
  __int64 v19; // rax@16
  AppleUSBEHCITTInfo *v20; // rdi@17
  __int64 *v21; // r12@18
  __int64 v22; // rdx@18
  __int64 v23; // rcx@18
  int v24; // er8@18
  __int64 v25; // rsi@18

  v2 = a2;
  v3 = this;
  v4 = *((_DWORD *)a2 + 20);
  v5 = 0;
  if ( v4 )
  {
    if ( *((_BYTE *)a2 + 165) == 2 )
    {
      v7 = *((_BYTE *)a2 + 128);
      v6 = v7 == 1;
      LOWORD(v7) = 45;
      if ( v6 )
        LOWORD(v7) = 25;
      LOWORD(v7) = *((_WORD *)this + 796) + v7;
      v8 = (unsigned int)(7 * v4);
      v9 = *((_BYTE *)a2 + 166);
      v10 = *((_BYTE *)a2 + 167);
      if ( v10 + 8 * v9 <= 255 )
      {
        v11 = ((unsigned __int64)(2863311531LL * v8) >> 34) + v7;
        v12 = *((_DWORD *)v2 + 31);
        v13 = v10 + 8 * v9;
        do
        {
          if ( (_WORD)v11 )
          {
            if ( (unsigned __int16)v11 <= 0x1770u )
            {
              v14 = v13 + ((unsigned int)(v13 >> 31) >> 29);
              v15 = (unsigned __int16)(v13 / 8);
              if ( (unsigned int)v15 <= 0x20 )
              {
                v16 = (unsigned __int16)(v13 - (v14 & 0xFFF8));
                if ( (unsigned int)v16 <= 8 )
                {
                  v17 = (signed __int64)((char *)v3 + 16 * v15 + 2 * v16 + 1080);
                  v18 = *(_WORD *)v17;
                  if ( v18 >= (unsigned __int16)v11 )
                    *(_WORD *)v17 = v18 - v11;
                  else
                    *(_WORD *)v17 = 0;
                }
              }
            }
          }
          v13 += v12;
        }
        while ( v13 < 256 );
      }
    }
    else
    {
      v19 = *((_QWORD *)a2 + 17);
      v5 = -536870199;
      if ( v19 )
      {
        v20 = *(AppleUSBEHCITTInfo **)(v19 + 40);
        if ( v20 )
        {
          v21 = (__int64 *)off_16098[0];
          AppleUSBEHCITTInfo::ShowHSSplitTimeUsed(v20, *(_DWORD *)off_16098[0], "+ReturnIsochBandwidth");
          v5 = AppleUSBEHCITTInfo::DeallocatePeriodicBandwidth(
                 *(AppleUSBEHCITTInfo **)(*((_QWORD *)a2 + 17) + 40LL),
                 *((AppleUSBEHCISplitPeriodicEndpoint **)a2 + 17));
          v25 = *((_QWORD *)a2 + 17);
          *(_WORD *)(v25 + 50) = 0;
          if ( !v5 )
          {
            AppleUSBEHCI::ReturnHSPeriodicSplitBandwidth(v3, (AppleUSBEHCISplitPeriodicEndpoint *)v25, v22, v23, v24);
            v5 = 0;
            AppleUSBEHCITTInfo::CalculateSPEsToAdjustAfterChange(
              *(AppleUSBEHCITTInfo **)(*((_QWORD *)v2 + 17) + 40LL),
              *((AppleUSBEHCISplitPeriodicEndpoint **)v2 + 17),
              0);
            AppleUSBEHCI::AdjustSPEs(v3, *((AppleUSBEHCISplitPeriodicEndpoint **)v2 + 17), 0LL);
            AppleUSBEHCITTInfo::ShowHSSplitTimeUsed(
              *(AppleUSBEHCITTInfo **)(*((_QWORD *)v2 + 17) + 40LL),
              *(_DWORD *)v21,
              "-ReturnIsochBandwidth");
            AppleUSBEHCITTInfo::print(
              *(AppleUSBEHCITTInfo **)(*((_QWORD *)v2 + 17) + 40LL),
              *(_DWORD *)v21,
              "-ReturnIsochBandwidth");
            (*(void (**)(void))(**((_QWORD **)v2 + 17) + 40LL))();
            *((_QWORD *)v2 + 17) = 0LL;
          }
        }
      }
    }
  }
  return (unsigned int)v5;
}
// 16098: using guessed type __int64 off_16098[8];

//----- (000000000000C268) ----------------------------------------------------
__int64 __usercall AppleUSBEHCI::AllocateIsochBandwidth@<rax>(AppleUSBEHCI *this@<rdi>, AppleEHCIIsochEndpoint *a2@<rsi>, AppleUSBEHCITTInfo *a3@<rdx>, int a4@<r10d>)
{
  AppleUSBEHCITTInfo *v4; // r12@1
  AppleEHCIIsochEndpoint *v5; // r14@1
  AppleUSBEHCI *v6; // r13@1
  int v7; // eax@1
  signed int v8; // er15@1
  signed int v9; // er11@3
  signed __int16 v10; // r10@5
  __int64 v11; // rax@7
  int v12; // er10@8
  signed int v13; // edi@8
  char v14; // r9@8
  signed __int16 v15; // si@8
  char v16; // r8@8
  int v17; // eax@9
  int v18; // edx@9
  int v19; // edx@12
  int v20; // er9@13
  int v21; // er8@14
  signed int v22; // esi@15
  char v23; // cl@15
  int v24; // edi@18
  __int64 v25; // rax@18
  __int64 v26; // rdi@19
  signed __int64 v27; // rax@20
  unsigned __int16 v28; // bx@20
  char v29; // al@20
  char v30; // cl@24
  signed int v31; // edx@28
  int v32; // esi@31
  __int64 v33; // rax@31
  __int64 v34; // rdi@32
  signed __int64 v35; // rsi@33
  unsigned int v36; // eax@33
  __int64 *v37; // rbx@39
  int v38; // eax@39
  __int64 v39; // rsi@41
  signed int v40; // eax@44
  __int64 v41; // rdx@44
  int v42; // er11@44
  bool v43; // zf@44
  __int64 v44; // rax@44
  __int64 v45; // rsi@46

  v4 = a3;
  v5 = a2;
  v6 = this;
  v7 = *((_DWORD *)a2 + 20);
  v8 = 0;
  if ( v7 )
  {
    if ( *((_BYTE *)a2 + 165) == 2 )
    {
      v9 = *((_DWORD *)a2 + 31);
      if ( (unsigned int)v9 >= 0x101 )
      {
        *((_DWORD *)a2 + 31) = 256;
        v9 = 256;
      }
      v10 = 45;
      if ( *((_BYTE *)a2 + 128) == 1 )
        v10 = 25;
      LOWORD(a4) = *((_WORD *)this + 796) + a4;
      v11 = (unsigned int)(7 * v7);
      v8 = -536870164;
      if ( v9 > 0 )
      {
        v12 = ((unsigned __int64)(2863311531LL * v11) >> 34) + a4;
        v13 = 0;
        v14 = -1;
        v15 = -1;
        v16 = -1;
        do
        {
          v17 = v13 % 8;
          v18 = v13 / 8;
          if ( *((_WORD *)v6 + 8 * (v13 / 8) + v13 % 8 + 540) < (unsigned int)(unsigned __int16)v15 )
          {
            v15 = *((_WORD *)v6 + 8 * (unsigned __int8)v18 + (unsigned __int8)v17 + 540);
            v16 = v17;
            v14 = v18;
          }
          ++v13;
        }
        while ( v13 < v9 );
        v19 = (unsigned __int8)v14;
        if ( (unsigned __int8)v14 != 255 )
        {
          v20 = (unsigned __int8)v16;
          if ( (unsigned __int8)v16 != 255 )
          {
            *((_BYTE *)v5 + 166) = v19;
            *((_BYTE *)v5 + 167) = v16;
            v21 = (unsigned __int8)v16 + 8 * v19;
            v8 = 0;
            if ( v21 <= 255 )
            {
              v22 = v20 + 8 * v19;
              v23 = 0;
              do
              {
                if ( (_WORD)v12 )
                {
                  if ( (unsigned __int16)v12 <= 0x1770u )
                  {
                    v24 = v22 + ((unsigned int)(v22 >> 31) >> 29);
                    v25 = (unsigned __int16)(v22 / 8);
                    if ( (unsigned int)v25 <= 0x20 )
                    {
                      v26 = (unsigned __int16)(v22 - (v24 & 0xFFF8));
                      if ( (unsigned int)v26 <= 8 )
                      {
                        v27 = (signed __int64)((char *)v6 + 16 * v25);
                        v28 = v12 + *(_WORD *)(v27 + 2 * v26 + 1080);
                        *(_WORD *)(v27 + 2 * v26 + 1080) = v28;
                        v29 = 1;
                        if ( v28 <= 0x1770u )
                          v29 = v23;
                        v23 = v29;
                      }
                    }
                  }
                }
                v22 += v9;
              }
              while ( v22 < 256 );
              v30 = v23 & 1;
              v8 = -536870164;
              if ( !v30 )
                v8 = 0;
              if ( v30 && v21 <= 255 )
              {
                v31 = v20 + 8 * v19;
                v8 = -536870164;
                do
                {
                  if ( (_WORD)v12 )
                  {
                    if ( (unsigned __int16)v12 <= 0x1770u )
                    {
                      v32 = v31 + ((unsigned int)(v31 >> 31) >> 29);
                      v33 = (unsigned __int16)(v31 / 8);
                      if ( (unsigned int)v33 <= 0x20 )
                      {
                        v34 = (unsigned __int16)(v31 - (v32 & 0xFFF8));
                        if ( (unsigned int)v34 <= 8 )
                        {
                          v35 = (signed __int64)((char *)v6 + 16 * v33 + 2 * v34 + 1080);
                          v36 = *(_WORD *)v35;
                          if ( v36 >= (unsigned __int16)v12 )
                            *(_WORD *)v35 = v36 - v12;
                          else
                            *(_WORD *)v35 = 0;
                        }
                      }
                    }
                  }
                  v31 += v9;
                }
                while ( v31 < 256 );
              }
            }
          }
        }
      }
    }
    else
    {
      v8 = -536870199;
      if ( a3 )
      {
        v37 = (__int64 *)off_16098[0];
        AppleUSBEHCITTInfo::ShowHSSplitTimeUsed(a3, *(_DWORD *)off_16098[0], "+AllocateIsochBandwidth");
        v38 = *((_WORD *)v4 + 401) + *((_DWORD *)a2 + 20) + 9;
        if ( *((_DWORD *)a2 + 31) != 1 )
          *((_DWORD *)a2 + 31) = 1;
        v39 = *((_QWORD *)a2 + 17);
        if ( v39 )
        {
          *(_WORD *)(v39 + 50) = v38;
        }
        else
        {
          v39 = AppleUSBEHCISplitPeriodicEndpoint::NewSplitPeriodicEndpoint(
                  v4,
                  (AppleUSBEHCITTInfo *)((char *)&dword_0 + 1),
                  v5,
                  (OSObject *)(unsigned __int16)v38,
                  1);
          *((_QWORD *)v5 + 17) = v39;
          if ( !v39 )
            return (unsigned int)v8;
        }
        v40 = AppleUSBEHCITTInfo::AllocatePeriodicBandwidth(v4, (AppleUSBEHCISplitPeriodicEndpoint *)v39);
        v8 = v40;
        v43 = v40 == 0;
        v44 = *((_QWORD *)v5 + 17);
        if ( v43 )
        {
          *((_BYTE *)v5 + 166) = *(_BYTE *)(v44 + 56);
          AppleUSBEHCI::AllocateHSPeriodicSplitBandwidth(this, (AppleUSBEHCISplitPeriodicEndpoint *)v44, v41, v42);
          AppleUSBEHCITTInfo::ShowHSSplitTimeUsed(v4, *(_DWORD *)v37, "-AllocateIsochBandwidth");
          AppleUSBEHCITTInfo::CalculateSPEsToAdjustAfterChange(v4, *((AppleUSBEHCISplitPeriodicEndpoint **)v5 + 17), 1);
          AppleUSBEHCI::AdjustSPEs(this, *((AppleUSBEHCISplitPeriodicEndpoint **)v5 + 17), 1LL);
          v45 = *(_DWORD *)v37;
          AppleEHCIIsochEndpoint::print(v5);
          AppleUSBEHCITTInfo::ShowHSSplitTimeUsed(v4, *(_DWORD *)v37, "-AllocateIsochBandwidth");
          AppleUSBEHCITTInfo::print(v4, *(_DWORD *)v37, "-AllocateIsochBandwidth");
          v8 = 0;
        }
        else
        {
          (*(void (__fastcall **)(_QWORD))(*(_QWORD *)v44 + 40LL))(*((_QWORD *)v5 + 17));
          *((_QWORD *)v5 + 17) = 0LL;
        }
      }
    }
  }
  return (unsigned int)v8;
}
// 0: using guessed type int dword_0;
// 16098: using guessed type __int64 off_16098[8];

//----- (000000000000C5F8) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::CreateHSIsochTransfer(uintptr_t a1, unsigned __int64 a2, __int64 a3)
{
  __int64 v3; // rbx@1
  __int64 v4; // rcx@1
  char v5; // r8@1
  __int64 v6; // r10@1
  unsigned int v7; // er11@1
  __int64 v8; // r13@1
  unsigned __int64 v9; // rdi@1
  unsigned int v10; // er14@1
  unsigned int v11; // er9@3
  signed int v12; // er15@5
  AppleEHCIIsochTransferDescriptor *v13; // r15@6
  signed __int64 v14; // rdx@6
  signed __int64 v15; // rcx@7
  unsigned int v16; // er10@9
  int v17; // er14@9
  unsigned int v18; // eax@10
  unsigned int v19; // er13@10
  __int64 v20; // rcx@11
  signed __int64 v21; // rdx@12
  AppleEHCIIsochTransferDescriptor *v22; // rax@20
  AppleEHCIIsochTransferDescriptor *v23; // r12@20
  __int64 v24; // rbx@24
  __int64 v25; // rax@24
  __int64 v26; // r8@24
  __int64 v27; // rcx@24
  __int64 v28; // rcx@26
  __int64 v29; // r12@26
  unsigned int v30; // ebx@26
  __int64 v31; // r14@27
  __int64 v32; // r15@27
  __int16 v33; // r9@29
  unsigned __int64 v34; // rdx@29
  unsigned __int64 v35; // rcx@31
  __int64 v36; // rsi@32
  __int64 v37; // r9@36
  signed __int64 v38; // rdx@38
  __int64 v39; // r12@44
  __int64 v40; // r14@44
  __int64 v41; // rax@44
  signed __int64 v42; // rax@45
  signed __int64 v43; // rdi@45
  __int64 v44; // r15@45
  __int64 v45; // r10@45
  __int64 v46; // rsi@45
  signed __int64 v47; // rcx@46
  __int64 v48; // rax@46
  signed __int64 v49; // rax@47
  __int64 v50; // r9@49
  int v51; // eax@49
  __int64 v52; // rdx@49
  __int64 v53; // r13@50
  __int64 v54; // r12@50
  signed __int64 v55; // r14@60
  signed __int64 v56; // rcx@60
  int v57; // er15@66
  __int64 v58; // rax@66
  int v59; // er15@66
  __int64 v60; // rax@66
  int v61; // er15@66
  __int64 v62; // rax@66
  __int64 v63; // ST98_8@68
  __int64 v64; // ST90_8@68
  __int64 v65; // rdx@71
  __int64 v67; // [sp+8h] [bp-E8h]@24
  unsigned int v68; // [sp+14h] [bp-DCh]@20
  unsigned int v69; // [sp+18h] [bp-D8h]@7
  bool v70; // [sp+1Fh] [bp-D1h]@7
  __int64 v71; // [sp+20h] [bp-D0h]@7
  unsigned int v72; // [sp+28h] [bp-C8h]@9
  int v73; // [sp+30h] [bp-C0h]@24
  __int64 v74; // [sp+38h] [bp-B8h]@7
  unsigned int v75; // [sp+40h] [bp-B0h]@9
  char v76; // [sp+47h] [bp-A9h]@20
  AppleEHCIIsochTransferDescriptor *v77; // [sp+48h] [bp-A8h]@24
  signed __int64 v78; // [sp+50h] [bp-A0h]@9
  signed __int64 v79; // [sp+50h] [bp-A0h]@47
  __int64 v80; // [sp+58h] [bp-98h]@9
  __int64 v81; // [sp+60h] [bp-90h]@7
  AppleEHCIIsochEndpoint *v82; // [sp+68h] [bp-88h]@6
  signed __int64 v83; // [sp+70h] [bp-80h]@9
  uintptr_t arg1; // [sp+78h] [bp-78h]@1
  __int64 v85; // [sp+80h] [bp-70h]@1
  __int64 v86; // [sp+88h] [bp-68h]@27
  signed __int64 v87; // [sp+88h] [bp-68h]@47
  int v88; // [sp+ACh] [bp-44h]@27
  unsigned __int64 v89; // [sp+B0h] [bp-40h]@27
  unsigned __int64 v90; // [sp+B8h] [bp-38h]@31
  __int64 v91; // [sp+C0h] [bp-30h]@27

  v3 = a3;
  arg1 = a1;
  v4 = *(_QWORD *)(a3 + 104);
  v5 = *(_BYTE *)(v4 + 56);
  v6 = *(_QWORD *)(a3 + 88);
  v7 = *(_DWORD *)(a3 + 80);
  v8 = *(_QWORD *)(a3 + 72);
  v85 = *(_QWORD *)(v4 + 24);
  v9 = *(_DWORD *)(a2 + 124);
  v10 = 1;
  if ( v9 <= 7 )
    v10 = 8 / (unsigned int)v9;
  v11 = (unsigned int)v9 >> 3;
  if ( (unsigned int)v9 < 9 )
    v11 = 1;
  v12 = -536870206;
  if ( !(v7 % v10) )
  {
    v82 = (AppleEHCIIsochEndpoint *)a2;
    v13 = 0LL;
    v14 = 0LL;
    if ( v7 )
    {
      v71 = v8;
      v81 = v6;
      v69 = *(_DWORD *)v4;
      v70 = *(_DWORD *)v4 < 9u ? v5 != 0 && *(_DWORD *)v4 != 0 : 0;
      v74 = v11;
      v15 = *(_DWORD *)(a2 + 124);
      if ( v11 > 1 )
        v15 = 8LL;
      v83 = v15;
      v72 = 0;
      v80 = 0LL;
      v78 = 0LL;
      v16 = v10;
      v75 = v10;
      v17 = 0;
      while ( 1 )
      {
        v18 = 0;
        v19 = 0;
        v12 = -536870206;
        if ( v16 )
          break;
LABEL_20:
        v68 = v7;
        v76 = v5;
        v22 = AppleUSBEHCI::AllocateITD((AppleUSBEHCI *)arg1, a2, (const OSMetaClass *)v14);
        v23 = v22;
        if ( !v22 )
        {
          v12 = -536870211;
          if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
            kernel_debug(0x52D507Cu, arg1, 0xFFFFFFFFE00002BDLL, 0LL, 0LL, 0LL);
          return (unsigned int)v12;
        }
        *((_BYTE *)v22 + 80) = v76;
        *((_BYTE *)v22 + 82) = 0;
        *((_QWORD *)v82 + 9) += v74;
        if ( *(_BYTE *)(*(_QWORD *)(arg1 + 672) + 209LL) & 0x10 && *(_DWORD *)(*(_QWORD *)(arg1 + 168) + 188LL) <= 1 )
          AppleUSBEHCI::DisablePrefetchRegister(*(IOPCIDevice **)(arg1 + 488), *(_QWORD *)(arg1 + 704));
        v73 = v17;
        v67 = v3;
        v77 = v23;
        v24 = AppleEHCIIsochTransferDescriptor::GetSharedLogical(v23);
        v25 = AppleEHCIIsochTransferDescriptor::GetSharedLogical(v23);
        v26 = v24;
        v27 = 0LL;
        do
        {
          *(_DWORD *)(v24 + 4 * v27 + 36) = 0;
          *(_DWORD *)(v25 + 4 * v27++ + 64) = 0;
        }
        while ( v27 != 7 );
        v28 = 0LL;
        v29 = v80;
        v30 = 0;
        if ( v19 )
        {
          do
          {
            v86 = v28;
            v31 = v26;
            v32 = v25;
            v91 = v29;
            v88 = 1;
            if ( (*(int (__fastcall **)(__int64, __int64 *, __int64 *, int *))(*(_QWORD *)v85 + 344LL))(
                   v85,
                   &v91,
                   &v89,
                   &v88)
              || v88 != 1
              || (v33 = v89, v34 = v89 >> 32, HIDWORD(v89)) && !*(_BYTE *)(arg1 + 1695) )
            {
              v65 = (__int64)"AppleUSBEHCI::CreateHSIsochTransfer - could not generate segments err (0x%x) numSegments (%d) fLength (%d)";
              goto LABEL_72;
            }
            v35 = v90;
            v26 = v31;
            if ( v30 )
            {
              v36 = v30 - 1;
              v25 = v32;
              if ( *(_DWORD *)(v31 + 4 * v36 + 36) != (v89 & 0xFFFFF000)
                || *(_DWORD *)(v32 + 4 * v36 + 64) != HIDWORD(v89) )
              {
                *(_DWORD *)(v31 + 4 * v86 + 36) = v89 & 0xFFFFF000;
                *(_DWORD *)(v32 + 4 * v86 + 64) = v34;
                ++v30;
              }
            }
            else
            {
              *(_DWORD *)(v31 + 4 * v86 + 36) = v89 & 0xFFFFF000;
              v25 = v32;
              *(_DWORD *)(v32 + 4 * v86 + 64) = v34;
              v30 = 1;
            }
            v37 = v33 & 0xFFF;
            if ( v35 > v19 )
              v35 = v19;
            v38 = 4096 - v37;
            if ( v35 <= 4096 - v37 )
              v38 = v35;
            v19 -= v38;
            v28 = v30;
            if ( v30 > 6 )
              break;
            v29 += v38;
          }
          while ( v19 );
          if ( v30 >= 7 && v19 )
          {
            KernelDebugLogInternal(
              1LL,
              1431519814LL,
              "AppleUSBEHCI::CreateHSIochTransfer - ran out of physical page slots");
            v12 = -536870199;
            return (unsigned int)v12;
          }
        }
        v39 = v26;
        v40 = v25;
        v41 = AppleEHCIIsochTransferDescriptor::GetSharedLogical(v77);
        if ( v75 )
        {
          v42 = v41 + 4;
          v43 = 0LL;
          v44 = v81;
          v45 = v40;
          v46 = v39;
          while ( 1 )
          {
            v47 = v42;
            ++*((_BYTE *)v77 + 82);
            v48 = (unsigned int)(v43 + v73);
            if ( v76 )
            {
              v87 = v43;
              v79 = v47;
              v49 = v81 + 16 * v48 + 4;
            }
            else
            {
              v87 = v43;
              v79 = v47;
              v49 = v81 + 8 * v48 + 4;
            }
            v50 = *(_WORD *)v49;
            v51 = 0;
            LODWORD(v52) = 0;
            if ( v50 )
              break;
LABEL_60:
            v55 = v79;
            *(_DWORD *)v79 = v51 | ((_DWORD)v50 << 16) | ((_DWORD)v52 << 12) | 0x80000000;
            v56 = v83;
            v42 = v79 + 4 * v83;
            v80 += v50;
            v43 = v87 + 1;
            if ( (signed int)v87 + 1 >= v75 )
              goto LABEL_63;
          }
          v53 = v50;
          v54 = v45;
          v91 = v80;
          v88 = 1;
          if ( (*(int (__fastcall **)(__int64, __int64 *, unsigned __int64 *, int *))(*(_QWORD *)v85 + 344LL))(
                 v85,
                 &v91,
                 &v89,
                 &v88)
            || v88 != 1
            || HIDWORD(v89) && !*(_BYTE *)(arg1 + 1695) )
          {
            v65 = (__int64)"AppleUSBEHCI::CreateHSIsochTransfer - could not generate segments err (0x%x) numSegments (%d) fLength (%d)";
LABEL_72:
            KernelDebugLogInternal(1LL, 1431519814LL, v65);
            v12 = -536870199;
          }
          else
          {
            v51 = v89 & 0xFFF;
            v52 = 0LL;
            v45 = v54;
            v50 = v53;
            while ( *(_DWORD *)(v46 + 4 * v52 + 36) != (v89 & 0xFFFFF000)
                 || *(_DWORD *)(v54 + 4 * v52 + 64) != HIDWORD(v89) )
            {
              ++v52;
              if ( (unsigned int)v52 >= 7 )
                goto LABEL_73;
            }
            if ( (unsigned int)v52 < 7 )
              goto LABEL_60;
LABEL_73:
            KernelDebugLogInternal(
              1LL,
              1431519814LL,
              "AppleUSBEHCI::CreateHSIochTransfer - could not find the correct physical page slot for buffP 0x%x buffHighP 0x%x");
            v12 = -536870199;
          }
          return (unsigned int)v12;
        }
        v44 = v81;
        v56 = v83;
        v55 = v78;
LABEL_63:
        v83 = v56;
        if ( v70 && !(v72 % v69) )
          *(_BYTE *)(v55 + 1) |= 0x80u;
        v78 = v55;
        *((_QWORD *)v77 + 6) = v44;
        *((_QWORD *)v77 + 11) = v71;
        *((_DWORD *)v77 + 24) = v73;
        *((_QWORD *)v77 + 8) = 0LL;
        *((_QWORD *)v77 + 5) = v82;
        v3 = v67;
        *((_BYTE *)v77 + 81) = *(_BYTE *)(*(_QWORD *)(v67 + 104) + 17LL);
        v57 = *((_WORD *)v82 + 57) | (*((_WORD *)v82 + 58) << 8);
        v58 = AppleEHCIIsochTransferDescriptor::GetSharedLogical(v77);
        *(_DWORD *)(v58 + 36) |= v57;
        v59 = *((_WORD *)v82 + 76) | ((*((_BYTE *)v82 + 128) == 1) << 11);
        v60 = AppleEHCIIsochTransferDescriptor::GetSharedLogical(v77);
        *(_DWORD *)(v60 + 40) |= v59;
        v61 = *((_WORD *)v82 + 77);
        v62 = AppleEHCIIsochTransferDescriptor::GetSharedLogical(v77);
        *(_DWORD *)(v62 + 44) |= v61;
        (*(void (__fastcall **)(AppleEHCIIsochTransferDescriptor *, signed __int64))(*(_QWORD *)v77 + 304LL))(v77, 7LL);
        v13 = v77;
        a2 = (unsigned __int64)v82;
        (*(void (__fastcall **)(uintptr_t, AppleEHCIIsochEndpoint *, AppleEHCIIsochTransferDescriptor *))(*(_QWORD *)arg1 + 2792LL))(
          arg1,
          v82,
          v77);
        v71 += v74;
        ++v72;
        v16 = v75;
        v17 = v75 + v73;
        v7 = v68;
        v5 = v76;
        if ( v75 + v73 >= v68 )
        {
          v4 = *(_QWORD *)(v67 + 104);
          v14 = v78;
          goto LABEL_68;
        }
      }
      while ( 1 )
      {
        v20 = v17 + v18;
        v21 = v5 ? v81 + 16 * v20 + 4 : v81 + 8 * v20 + 4;
        v14 = *(_WORD *)v21;
        if ( (unsigned int)v14 > 0xC00 )
          break;
        if ( v5 )
        {
          a2 = 1819044212LL;
          if ( *(_BYTE *)(*(_QWORD *)(v3 + 104) + 17LL) )
            a2 = 1953066092LL;
          *(_DWORD *)(v81 + 16 * v20) = a2;
        }
        v19 += v14;
        ++v18;
        if ( v18 >= v16 )
          goto LABEL_20;
      }
    }
    else
    {
LABEL_68:
      v63 = *(_QWORD *)(v4 + 40);
      v64 = *(_QWORD *)(v4 + 32);
      *((_QWORD *)v13 + 9) = *(_QWORD *)(v4 + 48);
      *((_QWORD *)v13 + 8) = v63;
      *((_QWORD *)v13 + 7) = v64;
      if ( v14 )
        *(_BYTE *)(v14 + 1) |= 0x80u;
      AppleUSBEHCI::AddIsocFramesToSchedule((AppleUSBEHCI *)arg1, v82);
      v12 = 0;
      AppleUSBEHCI::EnablePeriodicSchedule((AppleUSBEHCI *)arg1, 0LL);
    }
  }
  return (unsigned int)v12;
}
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (000000000000CD7E) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::CreateSplitIsochTransfer(AppleUSBEHCI *this, unsigned __int64 a2, uintptr_t a3)
{
  unsigned __int64 v3; // r14@1
  AppleUSBEHCI *v4; // r10@1
  __int64 v5; // rax@1
  char v6; // r13@1
  unsigned int v7; // er9@1
  __int64 v8; // r11@1
  unsigned int v9; // ebx@1
  __int64 v10; // rdi@2
  signed int v11; // ecx@5
  uintptr_t v12; // rcx@8
  AppleUSBEHCI *v13; // r12@12
  __int64 v14; // r15@12
  AppleEHCIIsochEndpoint *v15; // r12@13
  AppleEHCIIsochEndpoint *v16; // r15@14
  signed __int64 v17; // rcx@14
  signed int v18; // er14@14
  __int64 v19; // r12@15
  signed __int64 v20; // rbx@15
  __int64 v21; // rax@15
  signed __int64 v22; // rcx@15
  signed __int64 v23; // rdx@15
  __int64 v24; // rbx@17
  int v25; // eax@18
  int v26; // er12@18
  unsigned __int64 v27; // r13@18
  AppleEHCISplitIsochTransferDescriptor *v28; // r15@22
  unsigned __int64 v29; // rbx@22
  int v30; // eax@24
  signed __int64 v31; // r13@28
  AppleEHCISplitIsochTransferDescriptor *v32; // r14@29
  int v33; // eax@29
  unsigned __int64 v34; // r15@29
  signed __int64 v35; // rbx@33
  int v36; // er12@33
  __int64 v37; // rdi@39
  char v38; // r8@39
  __int64 v39; // rax@42
  signed int v40; // esi@42
  int v41; // edx@42
  unsigned int v42; // ecx@43
  unsigned int v43; // esi@43
  bool v44; // cf@45
  bool v45; // cl@45
  int v46; // er15@48
  signed int v47; // er12@49
  bool v48; // zf@53
  __int64 v49; // rax@54
  __int64 v50; // STB8_8@54
  __int64 v51; // STB0_8@54
  int v52; // ebx@57
  int v53; // ecx@57
  int v54; // er15@57
  AppleUSBEHCI *v55; // r12@59
  int v56; // ecx@59
  AppleEHCISplitIsochTransferDescriptor *v57; // rbx@63
  __int64 v58; // rax@63
  signed __int64 v59; // rax@64
  AppleEHCISplitIsochTransferDescriptor *v60; // r14@64
  AppleUSBEHCI *v61; // r15@67
  __int64 v62; // r13@67
  int v63; // ebx@67
  unsigned int v64; // ebx@67
  int v65; // ebx@67
  int v66; // ebx@67
  int v67; // ebx@67
  int v68; // ebx@67
  __int64 v69; // rax@67
  __int64 v70; // STA0_8@67
  __int64 v71; // ST98_8@67
  AppleUSBEHCI *v72; // rbx@68
  signed int v73; // er15@68
  uintptr_t v74; // rsi@69
  uintptr_t v75; // r8@71
  unsigned int v77; // [sp+Ch] [bp-104h]@10
  int v78; // [sp+10h] [bp-100h]@14
  AppleEHCIIsochEndpoint *v79; // [sp+18h] [bp-F8h]@13
  unsigned int v80; // [sp+20h] [bp-F0h]@1
  __int64 v81; // [sp+28h] [bp-E8h]@1
  signed __int64 v82; // [sp+30h] [bp-E0h]@14
  uintptr_t v83; // [sp+38h] [bp-D8h]@1
  signed int v84; // [sp+44h] [bp-CCh]@18
  signed int v85; // [sp+44h] [bp-CCh]@64
  AppleUSBEHCI *v86; // [sp+48h] [bp-C8h]@1
  __int64 v87; // [sp+50h] [bp-C0h]@1
  int v88; // [sp+58h] [bp-B8h]@49
  signed int v89; // [sp+5Ch] [bp-B4h]@50
  signed __int64 v90; // [sp+60h] [bp-B0h]@18
  unsigned __int8 v91; // [sp+68h] [bp-A8h]@42
  char v92; // [sp+77h] [bp-99h]@1
  __int64 v93; // [sp+78h] [bp-98h]@1
  unsigned __int64 v94; // [sp+80h] [bp-90h]@17
  __int64 v95; // [sp+88h] [bp-88h]@14
  unsigned __int64 v96; // [sp+88h] [bp-88h]@29
  uintptr_t v97; // [sp+90h] [bp-80h]@14
  int v98; // [sp+CCh] [bp-44h]@18
  unsigned __int64 v99; // [sp+D0h] [bp-40h]@18
  unsigned __int64 v100; // [sp+D8h] [bp-38h]@22
  __int64 v101; // [sp+E0h] [bp-30h]@18

  v83 = a3;
  v3 = a2;
  v4 = this;
  v86 = this;
  v5 = *(_QWORD *)(a3 + 104);
  v6 = *(_BYTE *)(v5 + 56);
  v92 = *(_BYTE *)(v5 + 56);
  v7 = *(_DWORD *)v5;
  v8 = *(_QWORD *)(a3 + 88);
  v93 = *(_QWORD *)(a3 + 88);
  v9 = *(_DWORD *)(a3 + 80);
  v80 = v9;
  v81 = *(_QWORD *)(a3 + 72);
  v87 = *(_QWORD *)(v5 + 24);
  if ( v9 )
  {
    v10 = 0LL;
    a2 = 0LL;
    do
    {
      if ( v6 )
      {
        a3 = *(_WORD *)(v8 + v10 + 4);
        if ( a3 >= 0x400 )
        {
          v73 = -536870206;
          if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
          {
            v74 = a2 + 1;
            v12 = *(_DWORD *)(v3 + 80);
            v75 = 2LL;
            goto LABEL_78;
          }
          return (unsigned int)v73;
        }
        v11 = 1819044212;
        if ( *(_BYTE *)(v5 + 17) )
          v11 = 1953066092;
        *(_DWORD *)(v8 + v10) = v11;
      }
      else
      {
        a3 = *(_WORD *)(v8 + 8 * a2 + 4);
        v12 = *(_DWORD *)(v3 + 80);
        if ( (unsigned int)a3 > (unsigned int)v12 )
        {
          v73 = -536870206;
          if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
          {
            v74 = a2 + 1;
            v75 = 1LL;
            goto LABEL_78;
          }
          return (unsigned int)v73;
        }
      }
      ++a2;
      v10 += 16LL;
    }
    while ( (unsigned int)a2 < v9 );
  }
  v77 = v7;
  if ( *(_BYTE *)(*((_QWORD *)v4 + 84) + 209LL) & 0x10 && *(_DWORD *)(*((_QWORD *)v4 + 21) + 188LL) <= 1 )
  {
    a2 = *((_QWORD *)v4 + 88);
    v13 = v4;
    v14 = v8;
    AppleUSBEHCI::DisablePrefetchRegister(*((IOPCIDevice **)v4 + 61), a2);
    v8 = v14;
    v4 = v13;
  }
  v15 = (AppleEHCIIsochEndpoint *)v3;
  v79 = (AppleEHCIIsochEndpoint *)v3;
  if ( v9 )
  {
    v16 = (AppleEHCIIsochEndpoint *)v3;
    v82 = v3 + 164;
    v17 = v8 + 4;
    v78 = v9 - 1;
    v97 = 0LL;
    v95 = 0LL;
    v18 = 1;
    while ( 1 )
    {
      v19 = v8;
      v20 = v17;
      v21 = AppleUSBEHCI::AllocateSITD(v4, a2, (const OSMetaClass *)a3);
      v22 = v20;
      v23 = v20;
      if ( v6 )
        v23 = v19 + 16 * v97 + 4;
      v94 = *(_WORD *)v23;
      v24 = v21;
      if ( !v21 )
        break;
      v90 = v22;
      v84 = v18;
      ++*((_QWORD *)v16 + 9);
      *(_BYTE *)(v21 + 80) = v6;
      v101 = v95;
      v98 = 1;
      v25 = (*(int (__fastcall **)(__int64, __int64 *, __int64 *, int *))(*(_QWORD *)v87 + 344LL))(
              v87,
              &v101,
              &v99,
              &v98);
      v26 = v99;
      v27 = v99 >> 32;
      if ( v25 || v98 != 1 || HIDWORD(v99) && !*((_BYTE *)v86 + 1695) )
      {
        v28 = (AppleEHCISplitIsochTransferDescriptor *)v24;
        v26 = 0;
        KernelDebugLogInternal(
          1LL,
          1431519814LL,
          "AppleUSBEHCI::CreateSplitIsochTransfer - could not generate segments err (0x%x) numSegments (%d) fLength (%d)");
        v29 = 0LL;
      }
      else
      {
        v28 = (AppleEHCISplitIsochTransferDescriptor *)v24;
        v29 = v100;
      }
      v30 = v26 & 0xFFF;
      if ( v29 > v94 )
        v29 = v94;
      if ( v29 > (unsigned int)(4096 - v30) )
        v29 = (unsigned int)(4096 - v30);
      *(_DWORD *)(AppleEHCISplitIsochTransferDescriptor::GetSharedLogical(v28) + 16) = v26;
      *(_DWORD *)(AppleEHCISplitIsochTransferDescriptor::GetSharedLogical(v28) + 28) = v27;
      v31 = (unsigned __int16)(v94 - v29);
      if ( (_WORD)v94 == (_WORD)v29 )
      {
        *(_DWORD *)(AppleEHCISplitIsochTransferDescriptor::GetSharedLogical(v28) + 20) = 0;
        *(_DWORD *)(AppleEHCISplitIsochTransferDescriptor::GetSharedLogical(v28) + 32) = 0;
        v38 = v92;
        v37 = v29 + v95;
        v32 = v28;
      }
      else
      {
        v32 = v28;
        v101 = v29 + v95;
        v96 = v29 + v95;
        v98 = 1;
        v33 = (*(int (__fastcall **)(__int64, __int64 *, unsigned __int64 *, int *))(*(_QWORD *)v87 + 344LL))(
                v87,
                &v101,
                &v99,
                &v98);
        v34 = v99 >> 32;
        if ( v33 || v98 != 1 || HIDWORD(v99) && !*((_BYTE *)v86 + 1695) )
        {
          v36 = 0;
          KernelDebugLogInternal(
            1LL,
            1431519814LL,
            "AppleUSBEHCI::CreateSplitIsochTransfer - could not generate segments err (0x%x) numSegments (%d) fLength (%d)");
          v35 = 0LL;
        }
        else
        {
          v35 = v100;
          v36 = v99 & 0xFFFFF000;
        }
        *(_DWORD *)(AppleEHCISplitIsochTransferDescriptor::GetSharedLogical(v32) + 20) = v36;
        *(_DWORD *)(AppleEHCISplitIsochTransferDescriptor::GetSharedLogical(v32) + 32) = v34;
        if ( v35 > (unsigned __int64)v31 )
          v35 = v31;
        if ( (unsigned __int64)v35 > 0x1000 )
          v35 = 4096LL;
        v37 = v35 + v96;
        v38 = v92;
      }
      *((_QWORD *)v32 + 6) = v93;
      *((_QWORD *)v32 + 11) = v81 + v97;
      *((_DWORD *)v32 + 24) = v97;
      if ( *((_BYTE *)v79 + 128) )
      {
        v39 = *((_QWORD *)v79 + 17);
        v91 = *(_BYTE *)(v39 + 60);
        v40 = 0;
        v41 = 0;
      }
      else
      {
        v42 = ((signed int)(((unsigned __int64)(-1370734243LL * ((signed int)v94 - 1)) >> 32) + v94 - 1) >> 7)
            + ((unsigned int)(((unsigned __int64)(-1370734243LL * ((signed int)v94 - 1)) >> 32) + v94 - 1) >> 31)
            + 1;
        v39 = *((_QWORD *)v79 + 17);
        v43 = *(_BYTE *)(v39 + 57);
        if ( (unsigned __int8)(((signed int)(((unsigned __int64)(-1370734243LL * ((signed int)v94 - 1)) >> 32) + v94 - 1) >> 7)
                             + ((unsigned int)(((unsigned __int64)(-1370734243LL * ((signed int)v94 - 1)) >> 32)
                                             + v94
                                             - 1) >> 31)
                             + 1) > v43 )
          LOBYTE(v42) = *(_BYTE *)(v39 + 57);
        v40 = (unsigned __int8)v42;
        v44 = (unsigned __int8)v42 < 1u;
        v48 = (unsigned __int8)v42 == 1;
        v45 = (unsigned __int8)v42 > 1u;
        if ( v44 || v48 )
          v40 = 1;
        v41 = 8 * v45;
        v91 = 0;
      }
      v46 = *(_BYTE *)(v39 + 59);
      if ( v78 == (_DWORD)v97 )
      {
        v88 = v41;
        v47 = 1;
        if ( *(_BYTE *)v82 )
        {
          v89 = v40;
          v95 = v37;
        }
        else
        {
          v89 = v40;
          v95 = v37;
          v49 = *(_QWORD *)(v83 + 104);
          v50 = *(_QWORD *)(v49 + 40);
          v51 = *(_QWORD *)(v49 + 32);
          *((_QWORD *)v32 + 9) = *(_QWORD *)(v49 + 48);
          *((_QWORD *)v32 + 8) = v50;
          *((_QWORD *)v32 + 7) = v51;
        }
      }
      else
      {
        v88 = v41;
        v89 = v40;
        v95 = v37;
        v47 = 0;
        if ( v38 )
        {
          if ( v77 )
            v48 = ((signed int)v97 + 1) % v77 == 0;
          else
            v48 = (((_BYTE)v97 + 1) & 7) == 0;
          v47 = v48;
        }
      }
      *(_DWORD *)AppleEHCISplitIsochTransferDescriptor::GetSharedLogical(v32) = 1;
      v52 = ((*((_BYTE *)v79 + 128) != 0) << 31) | (*((_DWORD *)v79 + 40) << 24) | (*((_WORD *)v79 + 78) << 16) | (*((_WORD *)v79 + 58) << 8) | *((_WORD *)v79 + 57);
      *(_DWORD *)(AppleEHCISplitIsochTransferDescriptor::GetSharedLogical(v32) + 4) = v52;
      *(_DWORD *)(AppleEHCISplitIsochTransferDescriptor::GetSharedLogical(v32) + 8) = (v91 << 8) | v46;
      v53 = (v47 << 31) | ((_DWORD)v94 << 16);
      v54 = v53 + 128;
      if ( (_DWORD)v97 && *(_BYTE *)v82 )
      {
        v55 = v86;
        v56 = v53 | 0x82;
        if ( !(*(_QWORD *)(*((_QWORD *)v86 + 84) + 208LL) & 0x10000) )
          v54 = v56;
        *(_DWORD *)(AppleEHCISplitIsochTransferDescriptor::GetSharedLogical(v32) + 24) = v84;
      }
      else
      {
        *(_DWORD *)(AppleEHCISplitIsochTransferDescriptor::GetSharedLogical(v32) + 24) = 1;
        v55 = v86;
      }
      v57 = v32;
      v18 = *((_DWORD *)v32 + 4);
      *(_DWORD *)(AppleEHCISplitIsochTransferDescriptor::GetSharedLogical(v57) + 12) = v54;
      v58 = AppleEHCISplitIsochTransferDescriptor::GetSharedLogical(v57);
      *(_DWORD *)(v58 + 20) |= v89 | v88;
      a2 = (unsigned __int64)v79;
      *((_QWORD *)v57 + 5) = v79;
      *((_BYTE *)v57 + 81) = *(_BYTE *)(*(_QWORD *)(v83 + 104) + 17LL);
      v16 = v79;
      (*(void (__fastcall **)(AppleUSBEHCI *, AppleEHCIIsochEndpoint *, AppleEHCISplitIsochTransferDescriptor *))(*(_QWORD *)v55 + 2792LL))(
        v55,
        v79,
        v57);
      a3 = v97 + 1;
      v97 = a3;
      v17 = v90 + 8;
      v8 = v93;
      v6 = v92;
      v4 = v55;
      if ( (unsigned int)a3 >= v80 )
      {
        v85 = v18;
        v59 = v82;
        v60 = v57;
        v15 = v79;
        goto LABEL_66;
      }
    }
    v73 = -536870211;
    v74 = (uintptr_t)v86;
    if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    {
      a3 = 0LL;
      v12 = -536870211LL;
      v75 = 3LL;
LABEL_78:
      kernel_debug(0x52D5080u, v74, a3, v12, v75, 0LL);
    }
  }
  else
  {
    v93 = v8;
    v59 = v3 + 164;
    v85 = 1;
    v60 = 0LL;
    v91 = 0;
LABEL_66:
    if ( *(_BYTE *)v59 )
    {
      v61 = v4;
      v62 = AppleUSBEHCI::AllocateSITD(v4, a2, (const OSMetaClass *)a3);
      *(_DWORD *)AppleEHCISplitIsochTransferDescriptor::GetSharedLogical((AppleEHCISplitIsochTransferDescriptor *)v62) = 1;
      v63 = *(_DWORD *)(AppleEHCISplitIsochTransferDescriptor::GetSharedLogical(v60) + 4);
      *(_DWORD *)(AppleEHCISplitIsochTransferDescriptor::GetSharedLogical((AppleEHCISplitIsochTransferDescriptor *)v62)
                + 4) = v63;
      *(_DWORD *)(AppleEHCISplitIsochTransferDescriptor::GetSharedLogical((AppleEHCISplitIsochTransferDescriptor *)v62)
                + 8) = (v91 & 3) << 8;
      v64 = (*(_DWORD *)(*((_QWORD *)v61 + 84) + 208LL) >> 15) & 2 ^ 0x80000082;
      *(_DWORD *)(AppleEHCISplitIsochTransferDescriptor::GetSharedLogical((AppleEHCISplitIsochTransferDescriptor *)v62)
                + 12) = v64;
      v65 = *(_DWORD *)(AppleEHCISplitIsochTransferDescriptor::GetSharedLogical(v60) + 16);
      *(_DWORD *)(AppleEHCISplitIsochTransferDescriptor::GetSharedLogical((AppleEHCISplitIsochTransferDescriptor *)v62)
                + 16) = v65;
      v66 = *(_DWORD *)(AppleEHCISplitIsochTransferDescriptor::GetSharedLogical(v60) + 20);
      *(_DWORD *)(AppleEHCISplitIsochTransferDescriptor::GetSharedLogical((AppleEHCISplitIsochTransferDescriptor *)v62)
                + 20) = v66;
      v67 = *(_DWORD *)(AppleEHCISplitIsochTransferDescriptor::GetSharedLogical(v60) + 28);
      *(_DWORD *)(AppleEHCISplitIsochTransferDescriptor::GetSharedLogical((AppleEHCISplitIsochTransferDescriptor *)v62)
                + 28) = v67;
      v68 = *(_DWORD *)(AppleEHCISplitIsochTransferDescriptor::GetSharedLogical(v60) + 32);
      *(_DWORD *)(AppleEHCISplitIsochTransferDescriptor::GetSharedLogical((AppleEHCISplitIsochTransferDescriptor *)v62)
                + 32) = v68;
      *(_DWORD *)(AppleEHCISplitIsochTransferDescriptor::GetSharedLogical((AppleEHCISplitIsochTransferDescriptor *)v62)
                + 24) = v85;
      v69 = *(_QWORD *)(v83 + 104);
      v70 = *(_QWORD *)(v69 + 40);
      v71 = *(_QWORD *)(v69 + 32);
      *(_QWORD *)(v62 + 72) = *(_QWORD *)(v69 + 48);
      *(_QWORD *)(v62 + 64) = v70;
      *(_QWORD *)(v62 + 56) = v71;
      *(_QWORD *)(v62 + 40) = v15;
      *(_QWORD *)(v62 + 48) = v93;
      *(_QWORD *)(v62 + 88) = *((_QWORD *)v60 + 11) + 1LL;
      *(_BYTE *)(v62 + 112) = 1;
      (*(void (__fastcall **)(AppleUSBEHCI *, AppleEHCIIsochEndpoint *, __int64))(*(_QWORD *)v61 + 2792LL))(
        v61,
        v15,
        v62);
      v4 = v61;
    }
    v72 = v4;
    AppleUSBEHCI::AddIsocFramesToSchedule(v4, v15);
    v73 = 0;
    AppleUSBEHCI::EnablePeriodicSchedule(v72, 0LL);
  }
  return (unsigned int)v73;
}
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (000000000000D65E) ----------------------------------------------------
signed __int64 AppleUSBEHCI::UIMCreateIsochTransfer()
{
  KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBEHCI::UIMCreateIsochTransfer - old method");
  return 3758097087LL;
}
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (000000000000D682) ----------------------------------------------------
signed __int64 AppleUSBEHCI::UIMCreateIsochTransfer()
{
  KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBEHCI::UIMCreateIsochTransfer(LL) - old method");
  return 3758097087LL;
}
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (000000000000D6A6) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::UIMCreateIsochTransfer(uintptr_t arg1, uintptr_t a2)
{
  uintptr_t v2; // rbx@1
  unsigned __int64 v3; // rax@1
  unsigned __int64 v4; // r13@1
  signed int v5; // er15@1
  OSMetaClassBase *v6; // rax@2
  const OSMetaClass *v7; // rdx@2
  unsigned __int64 v8; // rax@2
  unsigned __int64 v9; // r12@2
  unsigned __int64 v10; // rax@4
  __int64 v11; // rcx@5
  __int64 v12; // rdi@12
  __int64 v13; // rax@13
  __int64 result; // rax@15

  v2 = arg1;
  LODWORD(v3) = (*(int (__cdecl **)(uintptr_t))(*(_QWORD *)arg1 + 2456LL))(arg1);
  v4 = v3;
  v5 = -536870206;
  if ( (unsigned int)(*(_DWORD *)(a2 + 80) - 1) > 0x3E7 )
    return (unsigned int)v5;
  LODWORD(v6) = (*(int (__fastcall **)(uintptr_t, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)arg1 + 2776LL))(
                  arg1,
                  *(_WORD *)(a2 + 36),
                  *(_BYTE *)(a2 + 38),
                  *(_BYTE *)(a2 + 39),
                  0LL);
  v8 = OSMetaClassBase::safeMetaCast(v6, (const OSMetaClassBase *)AppleEHCIIsochEndpoint::metaClass, v7);
  v9 = v8;
  if ( !v8 )
  {
    v5 = -536854441;
    if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D5084u, arg1, 0LL, 0LL, 0xFFFFFFFFE0004057LL, 0LL);
    return (unsigned int)v5;
  }
  v5 = -536870174;
  if ( *(_BYTE *)(v8 + 129) )
    return (unsigned int)v5;
  v10 = *(_QWORD *)(a2 + 72);
  v5 = -536870162;
  if ( v10 < *(_QWORD *)(v9 + 72) )
    return (unsigned int)v5;
  v11 = *(_DWORD *)(arg1 + 1732);
  *(_QWORD *)(v9 + 72) = v10;
  if ( v10 > v4 )
  {
    v5 = -536870161;
    if ( v10 <= v4 + v11 )
      goto LABEL_12;
    return (unsigned int)v5;
  }
  if ( v10 < v4 - v11 )
    return (unsigned int)v5;
LABEL_12:
  v12 = *(_QWORD *)(*(_QWORD *)(a2 + 104) + 24LL);
  if ( !v12
    || (LODWORD(v13) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v12 + 312LL))(
                         v12,
                         AppleEHCIIsochEndpoint::metaClass),
        !v13) )
  {
    KernelDebugLogInternal(
      1LL,
      1431519814LL,
      "AppleUSBEHCI::UIMCreateIsochTransfer - no DMA Command or missing memory descriptor");
    v5 = -536870206;
    return (unsigned int)v5;
  }
  if ( *(_WORD *)(v9 + 156) )
    result = AppleUSBEHCI::CreateSplitIsochTransfer((AppleUSBEHCI *)v2, v9, a2);
  else
    result = AppleUSBEHCI::CreateHSIsochTransfer(v2, v9, a2);
  return result;
}
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];
// 16CD8: using guessed type _QWORD AppleEHCIIsochEndpoint::metaClass;
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);
// 2DEC8: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000000D840) ----------------------------------------------------
signed __int64 __fastcall AppleUSBEHCI::UIMHubMaintenance(AppleUSBEHCI *this, unsigned __int16 a2, __int64 a3, int a4, char a5)
{
  signed __int64 result; // rax@3
  __int64 v6; // rcx@4

  if ( a4 == 2 )
  {
    AppleUSBEHCIHubInfo::DeleteHubInfo((AppleUSBEHCI *)((char *)this + 1600), (AppleUSBEHCIHubInfo **)a2);
    return 0LL;
  }
  result = 3758097090LL;
  if ( a4 == 1 )
  {
    v6 = AppleUSBEHCIHubInfo::AddHubInfo((AppleUSBEHCI *)((char *)this + 1600), (AppleUSBEHCIHubInfo **)a2, a5);
    result = 3758097085LL;
    if ( v6 )
      return 0LL;
  }
  return result;
}

//----- (000000000000D888) ----------------------------------------------------
void __fastcall AppleUSBEHCI::ReturnOneTransaction(uintptr_t arg1, __int64 a2, uintptr_t a3, uintptr_t a4, unsigned int a5, unsigned __int8 a6)
{
  unsigned __int8 v6; // r15@1
  uintptr_t v7; // r13@1
  __int64 v8; // rbx@1
  __int64 v9; // r14@1
  __int64 v10; // rbx@12
  unsigned int v11; // [sp+Ch] [bp-34h]@1
  uintptr_t arg2; // [sp+10h] [bp-30h]@1

  v6 = a6;
  v11 = a5;
  v7 = a4;
  arg2 = a3;
  v8 = a2;
  v9 = off_160C0[0];
  if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D508Du, arg1, a3, (signed int)a5, a6, 0LL);
  if ( !v6 )
    AppleUSBEHCI::HaltAsyncEndpoint(arg1, (AppleEHCIQueueHead *)arg2, v7);
  if ( !a2 )
    goto LABEL_13;
  while ( !*(_BYTE *)(v8 + 25) || *(_BYTE *)(v8 + 26) && !*(_BYTE *)(v8 + 27) )
  {
    v8 = *(_QWORD *)(v8 + 32);
    if ( !v8 )
      goto LABEL_13;
  }
  v10 = *(_QWORD *)(v8 + 32);
  if ( !v10 )
  {
LABEL_13:
    v10 = 0LL;
    if ( *(_BYTE *)v9 & 2 )
    {
      v10 = 0LL;
      if ( *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      {
        v10 = 0LL;
        kernel_debug(0x52D508Cu, arg1, arg2, 0LL, 0LL, 0LL);
      }
    }
  }
  AppleUSBEHCI::returnTransactions(arg1, (AppleEHCIQueueHead *)arg2, v10, v11, 1u);
  if ( *(_BYTE *)v9 & 2 )
  {
    if ( *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D508Eu, arg1, arg2, 0LL, 0LL, 0LL);
  }
}
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];

//----- (000000000000D9BE) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::findBufferRemaining(AppleUSBEHCI *this, AppleEHCIQueueHead *a2)
{
  return (*(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical(a2) + 24) >> 16) & 0x7FFF;
}

//----- (000000000000D9D8) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::ReturnAllOutstandingAsyncIO(uintptr_t arg1)
{
  int v1; // er13@1
  uintptr_t v2; // rbx@1
  uintptr_t v3; // rax@2
  uintptr_t i; // rax@4
  uintptr_t v5; // r15@7
  int v6; // eax@7
  __int64 v7; // r12@7

  v1 = 0;
  v2 = 0LL;
  do
  {
    v3 = arg1 + 1736;
    if ( !v1 )
      v3 = arg1 + 1744;
    for ( i = *(_QWORD *)v3; i; i = *(_QWORD *)(v2 + 32) )
    {
      v5 = v2;
      v2 = i;
      (*(void (__fastcall **)(uintptr_t, signed __int64, uintptr_t))(*(_QWORD *)i + 312LL))(i, 7LL, arg1);
      v6 = *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v2) + 12);
      v7 = *(_QWORD *)(v2 + 40);
      if ( v7 && *(_QWORD *)(v7 + 8) )
      {
        if ( v7 == *(_QWORD *)(v2 + 48) )
          (*(void (__fastcall **)(uintptr_t, signed __int64, uintptr_t))(*(_QWORD *)v2 + 312LL))(v2, 5LL, arg1);
        (*(void (__fastcall **)(uintptr_t, signed __int64, uintptr_t))(*(_QWORD *)v2 + 312LL))(v2, 2LL, arg1);
        AppleUSBEHCI::ReturnOneTransaction(arg1, v7, v2, v5, 0xE00002C0, 1u);
      }
    }
    ++v1;
  }
  while ( v1 != 2 );
  return 0LL;
}

//----- (000000000000DACA) ----------------------------------------------------
char __fastcall AppleUSBEHCI::CheckEDListForTimeouts(uintptr_t arg1, AppleEHCIQueueHead *this)
{
  uintptr_t v2; // r14@1
  uintptr_t v3; // rax@1
  unsigned __int64 v4; // rbx@1
  AppleEHCIQueueHead *v5; // rax@6
  uintptr_t v6; // r12@6
  __int64 v7; // r15@7
  uintptr_t v8; // rbx@7
  uintptr_t v9; // r13@7
  unsigned int v10; // er15@20
  unsigned int v11; // ebx@20
  unsigned int v12; // er14@21
  IOUSBCommand *v13; // rdi@21
  __int64 v14; // r15@22
  bool v15; // cf@23
  unsigned __int64 v16; // r15@24
  unsigned __int64 v17; // rax@24
  int v18; // eax@30
  __int64 v19; // rax@34
  __int64 v20; // rcx@34
  int v21; // er15@34
  int v22; // ebx@34
  int v23; // eax@42
  uintptr_t v24; // rcx@45
  int v25; // eax@45
  int v26; // eax@51
  __int64 v27; // rax@53
  __int64 v28; // r8@53
  int v29; // er15@53
  int v30; // ebx@53
  unsigned __int64 v32; // [sp+8h] [bp-68h]@6
  unsigned __int64 arg3; // [sp+10h] [bp-60h]@6
  uintptr_t arg1a; // [sp+18h] [bp-58h]@1
  uintptr_t v35; // [sp+28h] [bp-48h]@7
  unsigned __int64 v36; // [sp+30h] [bp-40h]@23
  unsigned __int64 v37; // [sp+38h] [bp-38h]@1
  unsigned __int64 v38; // [sp+40h] [bp-30h]@1

  v2 = arg1;
  arg1a = arg1;
  v38 = 0LL;
  v37 = 0LL;
  LODWORD(v3) = (*(int (**)(void))(*(_QWORD *)arg1 + 2456LL))();
  v4 = v3;
  if ( !v3 )
    return 0;
  if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D5090u, arg1, (uintptr_t)this, v3, 4uLL, 0LL);
  if ( !this )
    return 0;
  arg3 = v4;
  v32 = v4 >> 32;
  v5 = this;
  v6 = 0LL;
  while ( 1 )
  {
    v35 = v6;
    v6 = (uintptr_t)v5;
    (*(void (__fastcall **)(AppleEHCIQueueHead *, signed __int64, uintptr_t))(*(_QWORD *)v5 + 312LL))(v5, 7LL, v2);
    v7 = AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v6);
    v8 = *(_DWORD *)(v7 + 12) & 0xFFFFFFE0;
    v9 = *(_QWORD *)(v6 + 40);
    if ( !v9 )
      goto LABEL_68;
    if ( *(AppleEHCIQueueHead **)(v2 + 1744) != this )
      break;
LABEL_12:
    if ( !*(_QWORD *)(v9 + 8) )
      goto LABEL_68;
    if ( v9 == *(_QWORD *)(v6 + 48) )
    {
      if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D5090u, v2, v6, v9, 0LL, 0LL);
      (*(void (__fastcall **)(uintptr_t, signed __int64, uintptr_t))(*(_QWORD *)v6 + 312LL))(v6, 5LL, v2);
    }
    if ( (_DWORD)v8 != *(_DWORD *)(v9 + 28)
      && !(*(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v6) + 24) & 0xC0) )
    {
      (*(void (__fastcall **)(uintptr_t, signed __int64, uintptr_t))(*(_QWORD *)v6 + 312LL))(v6, 7LL, v2);
      goto LABEL_68;
    }
    v10 = IOUSBCommand::GetNoDataTimeout(*(IOUSBCommand **)(v9 + 8));
    v11 = IOUSBCommand::GetCompletionTimeout(*(IOUSBCommand **)(v9 + 8));
    if ( !v11 )
      goto LABEL_27;
    v12 = v10;
    v13 = *(IOUSBCommand **)(v9 + 8);
    if ( *(_BYTE *)off_160C0[0] & 0x80 )
    {
      v14 = IOUSBCommand::GetUIMScratch64(v13, 0);
      clock_get_uptime(&v38, 0LL);
      if ( v14 )
      {
        v38 -= v14;
        absolutetime_to_nanoseconds(v38, &v36);
        v36 = 4835703278458516699LL * v36 >> 64 >> 18;
        v15 = v36 < v11;
        goto LABEL_26;
      }
      IOUSBCommand::SetUIMScratch64(*(IOUSBCommand **)(v9 + 8), 0, v38);
LABEL_59:
      v2 = arg1a;
      if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D5090u, arg1a, v9, arg3, 3uLL, 0LL);
      goto LABEL_68;
    }
    v16 = (unsigned __int64)(unsigned int)IOUSBCommand::GetUIMScratch(v13, 1u) << 32;
    v17 = v16 | (unsigned int)IOUSBCommand::GetUIMScratch(*(IOUSBCommand **)(v9 + 8), 0);
    if ( !v17 )
    {
      IOUSBCommand::SetUIMScratch(*(IOUSBCommand **)(v9 + 8), 0, arg3);
      IOUSBCommand::SetUIMScratch(*(IOUSBCommand **)(v9 + 8), 1u, v32);
      goto LABEL_59;
    }
    v15 = arg3 - v17 < v11;
LABEL_26:
    v10 = v12;
    v2 = arg1a;
    if ( !v15 )
    {
      v19 = AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v6);
      v20 = *(_DWORD *)(*(_QWORD *)(arg1a + 168) + 28LL);
      v21 = *(_DWORD *)(v19 + 4) & 0x7F;
      v22 = (*(_DWORD *)(v19 + 4) >> 8) & 0xF;
      KernelDebugLogInternal(
        1LL,
        1431519814LL,
        "AppleUSBEHCI::Found a transaction past the completion deadline on bus 0x%x, timing out! (Addr: %d, EP: %d)");
      if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D5090u, arg1a, v22 | (unsigned int)(v21 << 8), arg3, 1uLL, 0LL);
      (*(void (__fastcall **)(uintptr_t, signed __int64, uintptr_t))(*(_QWORD *)v6 + 312LL))(v6, 7LL, arg1a);
      ++*(_DWORD *)(arg1a + 2836);
      goto LABEL_57;
    }
LABEL_27:
    if ( v10 )
    {
      if ( *(_BYTE *)off_160C0[0] & 0x80 )
      {
        if ( IOUSBCommand::GetUIMScratch64(*(IOUSBCommand **)(v9 + 8), 1u) )
        {
          v18 = (*(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v6) + 24) >> 16) & 0x7FFF;
          if ( *(_DWORD *)(v9 + 56) != v18 )
          {
            *(_DWORD *)(v9 + 56) = v18;
            clock_get_uptime(&v37, 1LL);
            IOUSBCommand::SetUIMScratch64(*(IOUSBCommand **)(v9 + 8), 1u, v37);
            goto LABEL_68;
          }
          clock_get_uptime(&v38, 1LL);
          v37 = IOUSBCommand::GetUIMScratch64(*(IOUSBCommand **)(v9 + 8), 1u);
          v38 -= v37;
          absolutetime_to_nanoseconds(v38, &v36);
          v36 = 4835703278458516699LL * v36 >> 64 >> 18;
          if ( v36 < v10 )
            goto LABEL_68;
LABEL_53:
          v27 = AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v6);
          v28 = *(_DWORD *)(*(_QWORD *)(v2 + 168) + 28LL);
          v29 = *(_DWORD *)(v27 + 4) & 0x7F;
          v30 = (*(_DWORD *)(v27 + 4) >> 8) & 0xF;
          KernelDebugLogInternal(
            1LL,
            1431519814LL,
            "AppleUSBEHCI::Found a transaction which hasn't moved in %d milliseconds on bus 0x%x, timing out! (Addr: %d, EP: %d)");
          if ( *(_BYTE *)off_160C0[0] & 2 )
          {
            if ( *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
              kernel_debug(0x52D5090u, v2, v30 | (unsigned int)(v29 << 8), arg3, 2uLL, 0LL);
          }
          ++*(_DWORD *)(v2 + 2836);
          (*(void (__fastcall **)(uintptr_t, signed __int64, uintptr_t))(*(_QWORD *)v6 + 312LL))(v6, 7LL, v2);
LABEL_57:
          AppleUSBEHCI::ReturnOneTransaction(v2, v9, v6, v35, 0xE0004051, *(_QWORD *)(v2 + 1744) == (_QWORD)this);
          goto LABEL_68;
        }
        clock_get_uptime(&v37, 1LL);
        IOUSBCommand::SetUIMScratch64(*(IOUSBCommand **)(v9 + 8), 1u, v37);
LABEL_66:
        *(_DWORD *)(v9 + 56) = (*(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v6) + 24) >> 16) & 0x7FFF;
        goto LABEL_68;
      }
      if ( *(_QWORD *)(v9 + 48) - 1LL >= arg3 )
      {
        *(_QWORD *)(v9 + 48) = arg3;
        goto LABEL_66;
      }
      v26 = (*(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v6) + 24) >> 16) & 0x7FFF;
      if ( *(_DWORD *)(v9 + 56) != v26 )
      {
        *(_DWORD *)(v9 + 56) = v26;
        *(_QWORD *)(v9 + 48) = arg3;
        goto LABEL_68;
      }
      if ( arg3 - *(_QWORD *)(v9 + 48) >= v10 )
        goto LABEL_53;
    }
LABEL_68:
    v5 = *(AppleEHCIQueueHead **)(v6 + 32);
    if ( !v5 )
      return 0;
  }
  if ( v9 != *(_QWORD *)(v6 + 48) || *(_DWORD *)(v7 + 24) & 0x80 )
  {
    *(_QWORD *)(v6 + 88) = 0LL;
    goto LABEL_12;
  }
  if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D5090u, v2, v6, 0LL, 5uLL, 0LL);
  if ( v8 != *(_QWORD *)(v6 + 88) )
  {
    *(_QWORD *)(v6 + 88) = v8;
    *(_QWORD *)(v6 + 96) = arg3;
    goto LABEL_12;
  }
  v23 = *(_DWORD *)off_160C0[0];
  if ( *(_DWORD *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
  {
    kernel_debug(0x52D5090u, v2, v6, v8, 6uLL, 0LL);
    v23 = *(_DWORD *)off_160C0[0];
  }
  v24 = arg3 - *(_QWORD *)(v6 + 96);
  v25 = v23 & 2;
  if ( v24 < 0x2EE )
  {
    if ( v25 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D5090u, v2, v6, v24, 9uLL, 0LL);
    goto LABEL_12;
  }
  if ( v25 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D5090u, v2, v6, v24, 7uLL, 0LL);
  AppleUSBEHCI::unlinkAsyncEndpoint(v2, (AppleEHCIQueueHead *)v6, v35);
  if ( *(_DWORD *)(v7 + 24) & 0x80 )
  {
    if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D5090u, v2, v6, 0LL, 8uLL, 0LL);
    KernelDebugLogInternal(
      1LL,
      1431519814LL,
      "AppleUSBEHCI::CheckEDListForTimeouts - pEDQueue: %p, became active while unlinking, let this be scavenged from the inactive queue");
  }
  *(_QWORD *)(v6 + 32) = *(_QWORD *)(v2 + 1744);
  *(_QWORD *)(v2 + 1744) = v6;
  return 1;
}
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);
// 2E960: using guessed type int __fastcall absolutetime_to_nanoseconds(_QWORD, _QWORD);
// 2E978: using guessed type int __fastcall clock_get_uptime(_QWORD, _QWORD);

//----- (000000000000E1FC) ----------------------------------------------------
void __fastcall AppleUSBEHCI::UIMCheckForTimeouts(uintptr_t arg1)
{
  uintptr_t v1; // r13@1
  __int64 v2; // r12@1
  uintptr_t v3; // rdx@6
  uintptr_t v4; // rcx@11
  uint32_t v5; // edi@11
  unsigned __int8 v6; // al@13
  __int64 v7; // rax@16
  uintptr_t v8; // r14@16
  uintptr_t v9; // r15@17
  unsigned __int8 v10; // al@22
  __int64 v11; // rax@23
  __int64 v12; // rcx@23
  __int64 v13; // r8@23
  __int64 v14; // rdx@23
  unsigned __int8 v15; // al@26
  __int64 v16; // rax@27
  __int64 v17; // rcx@27
  __int64 v18; // r8@27
  int v19; // er15@30
  unsigned __int8 v20; // al@32
  __int64 v21; // rax@33
  __int64 v22; // rcx@33
  __int64 v23; // r8@33
  __int64 v24; // rdx@33
  unsigned __int8 v25; // al@35
  __int64 v26; // rax@36
  __int64 v27; // rcx@36
  __int64 v28; // r8@36
  signed int v29; // ebx@39

  v1 = arg1;
  v2 = off_160C0[0];
  if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D5099u, arg1, *(_BYTE *)(arg1 + 440), 0LL, 0LL, 0LL);
  if ( (unsigned __int8)IOService::isInactive((IOService *)arg1) || !*(_BYTE *)(arg1 + 444) )
  {
    if ( *(_BYTE *)v2 & 2 )
    {
      v6 = IOService::isInactive((IOService *)arg1);
      if ( *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D5098u, arg1, v6, *(_BYTE *)(arg1 + 444), 1uLL, 0LL);
    }
    goto LABEL_15;
  }
  v3 = *(_BYTE *)(arg1 + 440);
  if ( v3 != 2 || *(_BYTE *)(arg1 + 441) )
  {
    if ( *(_DWORD *)(arg1 + 1688) && *(_BYTE *)v2 & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    {
      v4 = *(_BYTE *)(arg1 + 441);
      v5 = 86855832;
LABEL_46:
      kernel_debug(v5, v1, v3, v4, 0LL, 0LL);
      return;
    }
    return;
  }
  v7 = *(_QWORD *)(arg1 + 704);
  v8 = *(_DWORD *)v7;
  if ( v8 == 0xFFFFFFFF )
  {
    *(_BYTE *)(arg1 + 444) = 0;
LABEL_15:
    AppleUSBEHCI::ReturnAllOutstandingAsyncIO(arg1);
    return;
  }
  v9 = *(_DWORD *)(v7 + 4);
  if ( *(_BYTE *)v2 & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D5098u, arg1, v8, v9, 2uLL, 0LL);
  if ( v8 & 0x20 )
  {
    if ( !(v9 & 0x8000) )
    {
      v10 = *(_BYTE *)(arg1 + 1697) + 1;
      *(_BYTE *)(arg1 + 1697) = v10;
      if ( v10 != 10 * (v10 / 0xAu) )
        goto LABEL_30;
      v11 = *(_QWORD *)(arg1 + 704);
      v12 = *(_DWORD *)v11;
      v13 = *(_DWORD *)(v11 + 4);
      v14 = (__int64)"AppleUSBEHCI::UIMCheckForTimeouts - Async USBCMD(0x%x) and USBSTS(0x%x) not synched ON (#%d)";
LABEL_28:
      KernelDebugLogInternal(1LL, 1431519814LL, v14);
      goto LABEL_30;
    }
  }
  else if ( v9 & 0x8000 )
  {
    v15 = *(_BYTE *)(arg1 + 1697) + 1;
    *(_BYTE *)(arg1 + 1697) = v15;
    if ( v15 != 10 * (v15 / 0xAu) )
      goto LABEL_30;
    v16 = *(_QWORD *)(arg1 + 704);
    v17 = *(_DWORD *)v16;
    v18 = *(_DWORD *)(v16 + 4);
    v14 = (__int64)"AppleUSBEHCI::UIMCheckForTimeouts - Async USBCMD(0x%x) and USBSTS(0x%x) not synched OFF (#%d)";
    goto LABEL_28;
  }
  *(_BYTE *)(arg1 + 1697) = 0;
LABEL_30:
  v19 = v9 & 0x4000;
  if ( v8 & 0x10 )
  {
    if ( !v19 )
    {
      v20 = *(_BYTE *)(arg1 + 1698) + 1;
      *(_BYTE *)(arg1 + 1698) = v20;
      if ( v20 == 10 * (v20 / 0xAu) )
      {
        v21 = *(_QWORD *)(arg1 + 704);
        v22 = *(_DWORD *)v21;
        v23 = *(_DWORD *)(v21 + 4);
        v24 = (__int64)"AppleUSBEHCI::UIMCheckForTimeouts - Periodic USBCMD(0x%x) and USBSTS(0x%x) not synched ON (#%d)";
LABEL_37:
        KernelDebugLogInternal(1LL, 1431519814LL, v24);
        goto LABEL_39;
      }
      goto LABEL_39;
    }
LABEL_38:
    *(_BYTE *)(arg1 + 1698) = 0;
    goto LABEL_39;
  }
  if ( !v19 )
    goto LABEL_38;
  v25 = *(_BYTE *)(arg1 + 1698) + 1;
  *(_BYTE *)(arg1 + 1698) = v25;
  if ( v25 == 10 * (v25 / 0xAu) )
  {
    v26 = *(_QWORD *)(arg1 + 704);
    v27 = *(_DWORD *)v26;
    v28 = *(_DWORD *)(v26 + 4);
    v24 = (__int64)"AppleUSBEHCI::UIMCheckForTimeouts - Periodic USBCMD(0x%x) and USBSTS(0x%x) not synched OFF (#%d)";
    goto LABEL_37;
  }
LABEL_39:
  v29 = -1;
  while ( AppleUSBEHCI::CheckEDListForTimeouts(arg1, *(AppleEHCIQueueHead **)(arg1 + 1736)) )
  {
    ++v29;
    if ( (unsigned int)v29 >= 0x65 )
    {
      KernelDebugLogInternal(
        1LL,
        1431519814LL,
        "AppleUSBEHCI::UIMCheckForTimeouts - exceeded 100 calls to CheckEDListForTimeouts on the AsyncHead!");
      break;
    }
  }
  AppleUSBEHCI::CheckEDListForTimeouts(arg1, *(AppleEHCIQueueHead **)(arg1 + 1744));
  if ( *(_BYTE *)v2 & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
  {
    v5 = 86855834;
    v3 = 0LL;
    v4 = 0LL;
    goto LABEL_46;
  }
}
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (000000000000E552) ----------------------------------------------------
int __fastcall AppleUSBEHCI::GetFrameNumberWithTime(AppleUSBEHCI *this, unsigned __int64 *a2, unsigned __int64 *a3)
{
  __int64 v3; // rdi@1
  int result; // eax@2

  v3 = *((_QWORD *)this + 18);
  if ( v3 )
    result = (*(int (__fastcall **)(__int64, __int64 (__fastcall *)(AppleUSBEHCI *__hidden, OSObject *, void *, void *, void *, void *), unsigned __int64 *, unsigned __int64 *, _QWORD, _QWORD))(*(_QWORD *)v3 + 456LL))(
               v3,
               AppleUSBEHCI::GatedGetFrameNumberWithTime,
               a2,
               a3,
               0LL,
               0LL);
  else
    result = -536870201;
  return result;
}

//----- (000000000000E590) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::GatedGetFrameNumberWithTime(AppleUSBEHCI *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  *(_QWORD *)a2 = *((_QWORD *)this + 266);
  *(_QWORD *)a3 = *((_QWORD *)this + 264);
  return 0LL;
}

//----- (000000000000E5AC) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::UIMEnableAddressEndpoints(AppleUSBEHCI *this, unsigned __int16 a2, const char *a3)
{
  char v3; // bl@1
  AppleUSBEHCI *v4; // r12@1
  const OSMetaClass *v5; // rdx@1
  __int64 v6; // rax@2
  __int64 v7; // r14@3
  __int64 v8; // rbx@4
  OSMetaClassBase *v9; // rdi@5
  int v10; // er8@9
  uintptr_t v11; // rbx@21
  uintptr_t v12; // r15@21
  uintptr_t v13; // rbx@29
  uintptr_t v14; // rcx@31
  uintptr_t v15; // rax@33
  int v16; // eax@41
  __int64 v17; // r12@41
  __int64 v18; // rbx@42
  __int64 v19; // rax@44
  __int64 v20; // r14@45
  __int64 i; // rax@53
  char *v23; // [sp+0h] [bp-40h]@2
  int v24; // [sp+8h] [bp-38h]@42

  v3 = (char)a3;
  v4 = this;
  AppleUSBEHCI::printAsyncQueue((uintptr_t)this, 7, a3, 0LL, 0);
  AppleUSBEHCI::showRegisters(this, 7LL, "+UIMEnableAddressEndpoints");
  if ( !v3 )
  {
    v11 = *((_QWORD *)this + 217);
    v12 = 0LL;
    if ( v11 )
    {
      v12 = 0LL;
      while ( *(_WORD *)(v11 + 66) == a2 )
      {
        AppleUSBEHCI::unlinkAsyncEndpoint((uintptr_t)this, (AppleEHCIQueueHead *)v11, v12);
        *(_QWORD *)(v11 + 32) = *((_QWORD *)this + 348);
        *((_QWORD *)this + 348) = v11;
        if ( v12 )
          goto LABEL_27;
        v11 = *((_QWORD *)this + 217);
        v12 = 0LL;
LABEL_28:
        if ( !v11 )
          goto LABEL_29;
      }
      v12 = v11;
LABEL_27:
      v11 = OSMetaClassBase::safeMetaCast(
              *(OSMetaClassBase **)(v12 + 32),
              (const OSMetaClassBase *)AppleEHCIQueueHead::metaClass,
              v5);
      goto LABEL_28;
    }
LABEL_29:
    v13 = *((_QWORD *)this + 218);
    if ( !v13 )
    {
LABEL_40:
      if ( *((_DWORD *)this + 179) <= 0 )
      {
        v23 = (char *)this + 2784;
      }
      else
      {
        v23 = (char *)this + 2784;
        v16 = 0;
        v17 = 0LL;
        do
        {
          v24 = v16;
          v18 = AppleUSBEHCI::GetPeriodicListLogicalEntry(this, v16);
          if ( v18 )
          {
            do
            {
              v20 = OSMetaClassBase::safeMetaCast(
                      (OSMetaClassBase *)v18,
                      (const OSMetaClassBase *)AppleEHCIQueueHead::metaClass,
                      v5);
              if ( v20
                && *(_WORD *)(v20 + 66) == a2
                && (AppleUSBEHCI::unlinkIntEndpoint(this, (AppleEHCIQueueHead *)v20),
                    *(_QWORD *)(v20 + 32) = *((_QWORD *)this + 348),
                    *((_QWORD *)this + 348) = v20,
                    (v18 = v17) == 0) )
              {
                v19 = AppleUSBEHCI::GetPeriodicListLogicalEntry(this, v24);
                v18 = 0LL;
              }
              else
              {
                v19 = *(_QWORD *)(v18 + 32);
              }
              v17 = v18;
              v18 = v19;
            }
            while ( v19 );
          }
          v16 = v24 + 1;
        }
        while ( v24 + 1 < *((_DWORD *)this + 179) );
        v4 = this;
      }
      goto LABEL_53;
    }
    while ( *(_WORD *)(v13 + 66) == a2 )
    {
      v15 = *((_QWORD *)this + 218);
      if ( v15 == v13 )
      {
        v15 = OSMetaClassBase::safeMetaCast(
                *(OSMetaClassBase **)(v13 + 32),
                (const OSMetaClassBase *)AppleEHCIQueueHead::metaClass,
                v5);
        *((_QWORD *)this + 218) = v15;
        *(_QWORD *)(v13 + 32) = *((_QWORD *)this + 348);
        *((_QWORD *)this + 348) = v13;
        v14 = 0LL;
        if ( v12 )
          goto LABEL_38;
      }
      else
      {
        if ( v12 )
        {
          *(_QWORD *)(v12 + 32) = *(_QWORD *)(v13 + 32);
          *(_QWORD *)(v13 + 32) = *((_QWORD *)this + 348);
          *((_QWORD *)this + 348) = v13;
LABEL_38:
          v15 = OSMetaClassBase::safeMetaCast(
                  *(OSMetaClassBase **)(v12 + 32),
                  (const OSMetaClassBase *)AppleEHCIQueueHead::metaClass,
                  v5);
          v14 = v12;
          goto LABEL_39;
        }
        *(_QWORD *)(v13 + 32) = *((_QWORD *)this + 348);
        *((_QWORD *)this + 348) = v13;
        v14 = 0LL;
      }
LABEL_39:
      v12 = v14;
      v13 = v15;
      if ( !v15 )
        goto LABEL_40;
    }
    v12 = v13;
    goto LABEL_38;
  }
  v23 = (char *)this + 2784;
  v6 = *((_QWORD *)this + 348);
  if ( v6 )
  {
    v7 = 0LL;
    do
    {
      v8 = v6;
      while ( 1 )
      {
        v9 = *(OSMetaClassBase **)(v8 + 32);
        if ( *(_WORD *)(v8 + 66) != a2 )
        {
          v6 = OSMetaClassBase::safeMetaCast(v9, (const OSMetaClassBase *)AppleEHCIQueueHead::metaClass, v5);
          goto LABEL_19;
        }
        if ( v7 )
          *(_QWORD *)(v7 + 32) = v9;
        else
          *(_QWORD *)v23 = OSMetaClassBase::safeMetaCast(v9, (const OSMetaClassBase *)AppleEHCIQueueHead::metaClass, v5);
        *(_QWORD *)(v8 + 32) = 0LL;
        v10 = *(_BYTE *)(v8 + 72);
        if ( v10 == 3 )
        {
          AppleUSBEHCI::linkInterruptEndpoint(v4, (AppleEHCIQueueHead *)v8);
        }
        else if ( (unsigned int)(v10 - 1) > 1 )
        {
          KernelDebugLogInternal(
            1LL,
            1431519814LL,
            "AppleUSBEHCI::UIMEnableAddressEndpoints- found QH[%p] with unknown type(%d)");
        }
        else
        {
          AppleUSBEHCI::linkAsyncEndpoint(v4, (AppleEHCIQueueHead *)v8);
        }
        if ( !v7 )
          break;
        v8 = OSMetaClassBase::safeMetaCast(
               *(OSMetaClassBase **)(v7 + 32),
               (const OSMetaClassBase *)AppleEHCIQueueHead::metaClass,
               v5);
        if ( !v8 )
          goto LABEL_53;
      }
      v6 = *(_QWORD *)v23;
      v8 = 0LL;
LABEL_19:
      v7 = v8;
    }
    while ( v6 );
  }
LABEL_53:
  for ( i = *(_QWORD *)v23;
        i;
        i = OSMetaClassBase::safeMetaCast(
              *(OSMetaClassBase **)(i + 32),
              (const OSMetaClassBase *)AppleEHCIQueueHead::metaClass,
              v5) )
    ;
  AppleUSBEHCI::printAsyncQueue((uintptr_t)v4, 7, (const char *)v5, 0LL, 0);
  AppleUSBEHCI::showRegisters(v4, 7LL, "-UIMEnableAddressEndpoints");
  return 0LL;
}
// 165C0: using guessed type _QWORD AppleEHCIQueueHead::metaClass;
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);
// 2DEC8: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000000E95C) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::UIMEnableAllEndpoints(AppleUSBEHCI *this, char a2)
{
  const char *v2; // rdx@1
  const OSMetaClass *v3; // rdx@1
  __int64 i; // rbx@2
  int v5; // er8@3
  __int64 v6; // rbx@11
  __int64 j; // rbx@12
  int v8; // ebx@15
  __int64 k; // rax@17
  const char *v10; // rdx@19

  AppleUSBEHCI::showRegisters(this, 7LL, "+UIMEnableAllEndpoints");
  AppleUSBEHCI::printAsyncQueue((uintptr_t)this, 7, v2, 0LL, 0);
  if ( a2 )
  {
    for ( i = *((_QWORD *)this + 348); i; i = *((_QWORD *)this + 348) )
    {
      *((_QWORD *)this + 348) = OSMetaClassBase::safeMetaCast(
                                  *(OSMetaClassBase **)(i + 32),
                                  (const OSMetaClassBase *)AppleEHCIQueueHead::metaClass,
                                  v3);
      *(_QWORD *)(i + 32) = 0LL;
      v5 = *(_BYTE *)(i + 72);
      if ( v5 == 3 )
      {
        AppleUSBEHCI::linkInterruptEndpoint(this, (AppleEHCIQueueHead *)i);
      }
      else if ( (unsigned int)(v5 - 1) > 1 )
      {
        KernelDebugLogInternal(
          1LL,
          1431519814LL,
          "AppleUSBEHCI::UIMEnableAllEndpoints- found QH[%p] with unknown type(%d)");
      }
      else
      {
        AppleUSBEHCI::linkAsyncEndpoint(this, (AppleEHCIQueueHead *)i);
      }
    }
  }
  else
  {
    while ( 1 )
    {
      v6 = *((_QWORD *)this + 217);
      if ( !v6 )
        break;
      AppleUSBEHCI::unlinkAsyncEndpoint((uintptr_t)this, *((AppleEHCIQueueHead **)this + 217), 0LL);
      *(_QWORD *)(v6 + 32) = *((_QWORD *)this + 348);
      *((_QWORD *)this + 348) = v6;
    }
    for ( j = *((_QWORD *)this + 218); j; j = *((_QWORD *)this + 218) )
    {
      *((_QWORD *)this + 218) = OSMetaClassBase::safeMetaCast(
                                  *(OSMetaClassBase **)(j + 32),
                                  (const OSMetaClassBase *)AppleEHCIQueueHead::metaClass,
                                  v3);
      *(_QWORD *)(j + 32) = *((_QWORD *)this + 348);
      *((_QWORD *)this + 348) = j;
    }
    if ( *((_DWORD *)this + 179) > 0 )
    {
      v8 = 0;
      do
        AppleUSBEHCI::GetPeriodicListLogicalEntry(this, v8++);
      while ( v8 < *((_DWORD *)this + 179) );
    }
    for ( k = *((_QWORD *)this + 348);
          k;
          k = OSMetaClassBase::safeMetaCast(
                *(OSMetaClassBase **)(k + 32),
                (const OSMetaClassBase *)AppleEHCIQueueHead::metaClass,
                v3) )
      ;
  }
  AppleUSBEHCI::showRegisters(this, 7LL, "-UIMEnableAllEndpoints");
  AppleUSBEHCI::printAsyncQueue((uintptr_t)this, 7, v10, 0LL, 0);
  return 0LL;
}
// 165C0: using guessed type _QWORD AppleEHCIQueueHead::metaClass;
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);
// 2DEC8: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000000EB22) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::ShowPeriodicBandwidthUsed(AppleUSBEHCI *this, __int64 a2, const char *a3)
{
  return 0LL;
}

//----- (000000000000EB2A) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::ReservePeriodicBandwidth(AppleUSBEHCI *this, unsigned int a2, unsigned int a3, unsigned __int16 a4)
{
  __int64 result; // rax@1
  char *v5; // rdi@5
  unsigned __int16 v6; // cx@5

  result = 0LL;
  if ( a4 )
  {
    result = 3758097090LL;
    if ( a4 <= 0x1770u && a2 <= 0x20 && a3 <= 8 )
    {
      v5 = (char *)this + 16 * (signed int)a2;
      v6 = *(_WORD *)&v5[2 * a3 + 1080] + a4;
      *(_WORD *)&v5[2 * a3 + 1080] = v6;
      result = 3758097132LL;
      if ( v6 <= 0x1770u )
        result = 0LL;
    }
  }
  return result;
}

//----- (000000000000EB80) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::ReleasePeriodicBandwidth(AppleUSBEHCI *this, unsigned int a2, unsigned int a3, unsigned __int16 a4)
{
  __int64 result; // rax@1
  char *v5; // r9@5
  unsigned int v6; // esi@5

  result = 0LL;
  if ( a4 )
  {
    result = 3758097090LL;
    if ( a4 <= 0x1770u && a2 <= 0x20 && a3 <= 8 )
    {
      v5 = (char *)this + 16 * (signed int)a2 + 2 * (signed int)a3 + 1080;
      v6 = *(_WORD *)v5;
      if ( v6 >= a4 )
      {
        *(_WORD *)v5 = v6 - a4;
        result = 0LL;
      }
      else
      {
        *(_WORD *)v5 = 0;
      }
    }
  }
  return result;
}

//----- (000000000000EBDC) ----------------------------------------------------
__int64 __usercall AppleUSBEHCI::AllocateHSPeriodicSplitBandwidth@<rax>(AppleUSBEHCI *this@<rdi>, AppleUSBEHCISplitPeriodicEndpoint *a2@<rsi>, __int64 a3@<rdx>, int a4@<r11d>)
{
  AppleUSBEHCISplitPeriodicEndpoint *v4; // rbx@1
  unsigned int v5; // eax@1
  signed int v6; // ecx@1
  char v7; // dl@1
  __int16 v8; // si@1
  int v9; // edi@2
  __int16 v10; // si@3
  unsigned int v11; // edx@7
  unsigned int v12; // esi@7
  int v13; // eax@10
  unsigned int v14; // er10@10
  __int64 v15; // rax@18
  signed int v16; // er14@18
  int v17; // er13@20
  char v18; // dl@21
  int v19; // er12@21
  int v20; // er8@23
  signed __int16 v21; // si@23
  signed __int16 v22; // ax@25
  signed __int16 v23; // di@27
  int v24; // eax@29
  unsigned int v25; // er11@29
  unsigned __int16 v26; // di@34
  signed int v27; // er13@42
  int v28; // er12@43
  signed int v29; // eax@45
  int v30; // edx@45
  unsigned int v31; // esi@45
  AppleUSBEHCITTInfo *v32; // rdi@58
  AppleUSBEHCISplitPeriodicEndpoint *v33; // r15@58
  signed __int64 v34; // rcx@58
  unsigned int v35; // ebx@58
  unsigned int v36; // ebx@59
  int v37; // ebx@66
  unsigned __int16 v38; // cx@67
  unsigned __int64 v40; // [sp+0h] [bp-80h]@19
  int v41; // [sp+Ch] [bp-74h]@5
  signed int v42; // [sp+10h] [bp-70h]@19
  __int64 v43; // [sp+18h] [bp-68h]@21
  unsigned __int16 v44; // [sp+28h] [bp-58h]@19
  AppleUSBEHCISplitPeriodicEndpoint *v45; // [sp+30h] [bp-50h]@1
  AppleUSBEHCI *v46; // [sp+40h] [bp-40h]@1
  int v47; // [sp+48h] [bp-38h]@19
  __int16 v48; // [sp+54h] [bp-2Ch]@2

  v4 = a2;
  v45 = a2;
  v46 = this;
  v5 = *((_WORD *)a2 + 26);
  LOBYTE(v6) = (22311 * (v5 >> 2) >> 20) - 1;
  *((_BYTE *)a2 + 59) = 0;
  *((_DWORD *)a2 + 15) = 0;
  v7 = *((_BYTE *)a2 + 54);
  v8 = *((_WORD *)this + 796);
  if ( v7 )
  {
    v48 = v8 + 39;
    LOWORD(v9) = *((_WORD *)v4 + 24);
    LOWORD(a4) = v8 + 38;
  }
  else
  {
    v48 = v8 + 58;
    v9 = *((_WORD *)v4 + 24);
    v10 = v8 + 36;
    a4 = 0;
    if ( v9 == 3 )
      LOWORD(a4) = v10;
  }
  v41 = a4;
  if ( (unsigned __int16)v9 == 1 )
  {
    if ( v7 )
    {
      v11 = (v5 + *((_WORD *)v4 + 25)) / 0xBC + 1;
      *((_BYTE *)v4 + 57) = 1;
      v12 = (unsigned __int8)v11;
      a3 = v11 - ((char)v6 + 1);
      *((_BYTE *)v4 + 58) = a3;
      if ( v12 > 6 )
      {
        LOBYTE(v14) = 1;
        if ( v12 == 7 && (char)v6 != -1 )
        {
          LOBYTE(a3) = a3 + 1;
          *((_BYTE *)v4 + 58) = a3;
        }
      }
      else
      {
        if ( (char)v6 == -1 )
          LOBYTE(a3) = a3 + 1;
        else
          a3 = (unsigned int)(a3 + 2);
        *((_BYTE *)v4 + 58) = a3;
        LOBYTE(v14) = 1;
      }
    }
    else
    {
      *((_BYTE *)v4 + 58) = 0;
      v14 = (*(_DWORD *)(*((_QWORD *)v4 + 4) + 80LL) - 1) / 0xBCu + 1;
      *((_BYTE *)v4 + 57) = (*(_DWORD *)(*((_QWORD *)v4 + 4) + 80LL) - 1) / 0xBCu + 1;
      a3 = 0LL;
    }
    v13 = *(_DWORD *)(*((_QWORD *)v4 + 4) + 80LL);
  }
  else
  {
    *((_BYTE *)v4 + 57) = 1;
    LOBYTE(a3) = ((char)v6 < 5) | 2;
    *((_BYTE *)v4 + 58) = a3;
    v13 = *(_WORD *)(*((_QWORD *)v4 + 3) + 64LL);
    LOBYTE(v14) = 1;
  }
  v15 = (unsigned int)(7 * v13);
  v16 = *((_BYTE *)v4 + 56);
  if ( (unsigned int)v16 <= 0x1F )
  {
    v44 = (unsigned __int64)(2863311531LL * v15) >> 34;
    v6 = (char)v6;
    v42 = v6;
    v47 = (char)v6 + 1;
    v40 = (unsigned __int64)(2863311531LL * v15) >> 34;
    do
    {
      v17 = (unsigned __int8)v14 + v6;
      if ( (_BYTE)v14 )
      {
        v43 = a3;
        v18 = *((_BYTE *)v4 + 54);
        v19 = v16 - 1;
        if ( v16 <= 0 )
          v19 = 31;
        v20 = *((_BYTE *)v4 + 56);
        v21 = v40;
        do
        {
          if ( v18 )
            v22 = 0;
          else
            v22 = v21;
          v23 = v22;
          if ( (unsigned __int16)v22 > 0xBCu )
            v23 = 188;
          v24 = 7;
          v25 = v19;
          if ( v6 >= 0 )
          {
            v24 = v6;
            v25 = v16;
            if ( v6 >= 8 )
            {
              v24 = v6 % 8;
              v25 = v16 - ((v16 + ((unsigned int)((v16 + 1) >> 31) >> 27) + 1) & 0xFFFFFFE0) + 1;
            }
          }
          ++v6;
          if ( v16 == v20 )
            *((_BYTE *)v45 + 59) |= 1 << v6;
          v26 = v48 + v23;
          if ( v26 && v26 <= 0x1770u && v25 <= 0x20 && (unsigned int)v24 <= 8 )
            *((_WORD *)v46 + 8 * (signed int)v25 + v24 + 540) += v26;
          v21 -= 188;
        }
        while ( v6 < v17 );
        a4 = v41;
        v4 = v45;
        a3 = v43;
      }
      else
      {
        LOBYTE(v14) = 0;
      }
      v27 = v17 + 1;
      if ( v27 < (unsigned __int8)a3 + v47 + (unsigned __int8)v14 )
      {
        v28 = v16 - 1;
        if ( v16 <= 0 )
          v28 = 31;
        do
        {
          v29 = v27;
          v30 = 7;
          v31 = v28;
          if ( v27 >= 0 )
          {
            v30 = v27;
            v31 = v16;
            if ( v27 >= 8 )
            {
              v30 = v27 % 8;
              v31 = v16 - ((v16 + ((unsigned int)((v16 + 1) >> 31) >> 27) + 1) & 0xFFFFFFE0) + 1;
            }
          }
          ++v27;
          if ( v16 == *((_BYTE *)v4 + 56) )
          {
            if ( v29 < 7 )
            {
              *((_DWORD *)v4 + 15) |= 1 << v27;
            }
            else
            {
              *((_DWORD *)v4 + 15) |= 1 << (v27 & 7);
              *((_BYTE *)v4 + 64) = 1;
            }
          }
          if ( (_WORD)a4 && (unsigned __int16)a4 <= 0x1770u && v31 <= 0x20 && (unsigned int)v30 <= 8 )
            *((_WORD *)v46 + 8 * (signed int)v31 + v30 + 540) += a4;
          if ( *((_BYTE *)v4 + 54) == 1 )
          {
            v32 = (AppleUSBEHCITTInfo *)*((_QWORD *)v4 + 5);
            v33 = v4;
            v34 = 16LL * (signed int)v31;
            v35 = *(_WORD *)((char *)v32 + 2 * v30 + v34 + 868);
            if ( v35 <= 0xBB )
            {
              v36 = (unsigned __int16)(188 - v35);
              if ( v36 >= v44 )
                LOWORD(v36) = v44;
              if ( (_WORD)v36 && (unsigned __int16)v36 <= 0x1770u && v31 <= 0x20 && (unsigned int)v30 <= 8 )
                *(_WORD *)((char *)v46 + 2 * v30 + v34 + 1080) += v36;
            }
            v37 = a4;
            if ( v44 < 0xBDu )
              v38 = v44;
            else
              v38 = 188;
            AppleUSBEHCITTInfo::ReserveHSSplitINBytes(v32, v31, v30, v38);
            a4 = v37;
            v4 = v33;
          }
          v14 = *((_BYTE *)v4 + 57);
          a3 = *((_BYTE *)v4 + 58);
        }
        while ( v27 < (signed int)(a3 + v47 + v14) );
      }
      v16 += *((_BYTE *)v4 + 55);
      v6 = v42;
    }
    while ( v16 < 32 );
  }
  return 0LL;
}

//----- (000000000000F010) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::AdjustSPEs(AppleUSBEHCI *this, AppleUSBEHCISplitPeriodicEndpoint *a2, __int64 a3)
{
  __int64 v3; // rcx@1
  __int64 v4; // r14@2
  int v5; // eax@3
  __int64 v6; // rdx@3
  unsigned int *v7; // r15@4
  AppleUSBEHCISplitPeriodicEndpoint *v8; // rax@5
  AppleUSBEHCISplitPeriodicEndpoint *v9; // rbx@5
  __int16 v10; // r13@5
  __int64 v11; // rdx@5
  __int64 v12; // rcx@5
  int v13; // er8@5
  __int64 v14; // rdx@5
  int v15; // er11@5
  unsigned int v16; // er13@6
  AppleUSBEHCISplitPeriodicEndpoint *v18; // [sp+0h] [bp-30h]@4

  LODWORD(v3) = -536870199;
  if ( a2 )
  {
    v4 = *((_QWORD *)a2 + 5);
    if ( v4 )
    {
      v5 = (*(int (__fastcall **)(_QWORD, AppleUSBEHCISplitPeriodicEndpoint *, __int64, signed __int64))(**(_QWORD **)(v4 + 792) + 304LL))(
             *(_QWORD *)(v4 + 792),
             a2,
             a3,
             3758097097LL);
      v3 = 0LL;
      if ( v5 )
      {
        v18 = a2;
        v7 = (unsigned int *)off_16098[0];
        do
        {
          LODWORD(v8) = (*(int (__fastcall **)(_QWORD, AppleUSBEHCISplitPeriodicEndpoint *, __int64, __int64))(**(_QWORD **)(v4 + 792) + 472LL))(
                          *(_QWORD *)(v4 + 792),
                          a2,
                          v6,
                          v3);
          v9 = v8;
          AppleUSBEHCISplitPeriodicEndpoint::print(v8, *v7);
          (*(void (__fastcall **)(_QWORD, AppleUSBEHCISplitPeriodicEndpoint *))(**(_QWORD **)(v4 + 792) + 448LL))(
            *(_QWORD *)(v4 + 792),
            v9);
          v10 = AppleUSBEHCISplitPeriodicEndpoint::CalculateNewStartTimeFromChange(v9, v18);
          AppleUSBEHCI::ReturnHSPeriodicSplitBandwidth(this, v9, v11, v12, v13);
          *((_WORD *)v9 + 26) = v10;
          *((_BYTE *)v9 + 59) = 0;
          *((_DWORD *)v9 + 15) = 0;
          AppleUSBEHCI::AllocateHSPeriodicSplitBandwidth(this, v9, v14, v15);
          if ( *((_WORD *)v9 + 24) == 3 )
          {
            v16 = *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical(*((AppleEHCIQueueHead **)v9 + 3)) + 8) & 0xFFFF0000 | *((_BYTE *)v9 + 59) | (*((_DWORD *)v9 + 15) << 8);
            *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical(*((AppleEHCIQueueHead **)v9 + 3)) + 8) = v16;
          }
          a2 = (AppleUSBEHCISplitPeriodicEndpoint *)*v7;
          AppleUSBEHCISplitPeriodicEndpoint::print(v9, (unsigned int)a2);
        }
        while ( (*(int (**)(void))(**(_QWORD **)(v4 + 792) + 304LL))() );
        LODWORD(v3) = 0;
      }
    }
  }
  return (unsigned int)v3;
}
// 16098: using guessed type __int64 off_16098[8];

//----- (000000000000F13A) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::ReturnHSPeriodicSplitBandwidth(AppleUSBEHCI *this, AppleUSBEHCISplitPeriodicEndpoint *a2, __int64 a3, __int64 a4, int a5)
{
  AppleUSBEHCISplitPeriodicEndpoint *v5; // r12@1
  __int16 v6; // ax@1
  __int16 v7; // r13@2
  int v8; // ecx@2
  __int16 v9; // ax@3
  int v10; // eax@6
  __int64 v11; // rcx@8
  unsigned int v12; // edx@8
  signed int v13; // esi@10
  signed __int16 v14; // ax@10
  unsigned __int8 v15; // r11@12
  int v16; // er14@13
  char v17; // r9@14
  int v18; // er10@14
  signed __int16 v19; // di@16
  signed int v20; // ebx@16
  signed __int16 v21; // ax@18
  signed __int16 v22; // si@20
  int v23; // ecx@22
  unsigned int v24; // edx@22
  unsigned __int16 v25; // si@25
  signed __int64 v26; // r15@29
  unsigned int v27; // edx@29
  signed int v28; // er14@35
  int v29; // er9@36
  int v30; // edx@38
  unsigned int v31; // esi@38
  signed __int64 v32; // rcx@45
  unsigned int v33; // edi@45
  AppleUSBEHCITTInfo *v34; // rdi@49
  int v35; // er15@49
  AppleUSBEHCISplitPeriodicEndpoint *v36; // r13@49
  int v37; // er12@49
  unsigned int v38; // ebx@49
  signed __int64 v39; // rcx@49
  unsigned int v40; // edx@49
  unsigned int v41; // edx@50
  signed __int64 v42; // rdi@56
  unsigned int v43; // eax@56
  unsigned __int64 v45; // [sp+8h] [bp-78h]@12
  int v46; // [sp+14h] [bp-6Ch]@5
  signed int v47; // [sp+18h] [bp-68h]@10
  __int16 v48; // [sp+20h] [bp-60h]@5
  unsigned int v49; // [sp+24h] [bp-5Ch]@10
  unsigned int v50; // [sp+28h] [bp-58h]@10
  unsigned __int16 v51; // [sp+34h] [bp-4Ch]@12
  AppleUSBEHCI *v52; // [sp+38h] [bp-48h]@1
  int v53; // [sp+4Ch] [bp-34h]@10
  signed int v54; // [sp+50h] [bp-30h]@9

  v5 = a2;
  v52 = this;
  v6 = *((_WORD *)this + 796);
  if ( *((_BYTE *)a2 + 54) )
  {
    v7 = v6 + 39;
    LOWORD(v8) = *((_WORD *)a2 + 24);
    LOWORD(a5) = v6 + 38;
  }
  else
  {
    v7 = v6 + 58;
    v8 = *((_WORD *)a2 + 24);
    v9 = v6 + 36;
    a5 = 0;
    if ( v8 == 3 )
      LOWORD(a5) = v9;
  }
  v46 = a5;
  v48 = v7;
  if ( (unsigned __int16)v8 == 1 )
    v10 = *(_DWORD *)(*((_QWORD *)a2 + 4) + 80LL);
  else
    v10 = *(_WORD *)(*((_QWORD *)a2 + 3) + 64LL);
  v11 = (unsigned int)(7 * v10);
  v12 = 7 * v10 / 6u;
  if ( (_WORD)v12 )
  {
    v54 = *((_BYTE *)a2 + 56);
    if ( (unsigned int)v54 <= 0x1F )
    {
      v13 = (signed int)((356976 * ((unsigned int)*((_WORD *)a2 + 26) >> 2) & 0xFF000000) - 0x1000000) >> 24;
      v47 = v13;
      v53 = v13 + 1;
      v50 = 7 * v10 / 6u;
      v14 = v50;
      v49 = (unsigned __int16)v12;
      if ( (unsigned __int16)v12 > 0xBCu )
        v14 = 188;
      v15 = *((_BYTE *)v5 + 57);
      v45 = (unsigned __int64)(2863311531LL * v11) >> 34;
      v51 = v14;
      do
      {
        v16 = v15 + v13;
        if ( v15 )
        {
          v17 = *((_BYTE *)v5 + 54);
          v18 = v54 - 1;
          if ( v54 <= 0 )
            v18 = 31;
          v19 = v45;
          v20 = v13;
          do
          {
            if ( v17 )
              v21 = 0;
            else
              v21 = v19;
            v22 = v21;
            if ( (unsigned __int16)v21 > 0xBCu )
              v22 = 188;
            v23 = 7;
            v24 = v18;
            if ( v20 >= 0 )
            {
              v24 = v54;
              v23 = v20;
              if ( v20 >= 8 )
              {
                v23 = v20 % 8;
                v24 = v54 - ((v54 + ((unsigned int)((v54 + 1) >> 31) >> 27) + 1) & 0xFFFFFFE0) + 1;
              }
            }
            v25 = v7 + v22;
            if ( v25 && v25 <= 0x1770u && v24 <= 0x20 && (unsigned int)v23 <= 8 )
            {
              v26 = (signed __int64)((char *)v52 + 16 * (signed int)v24 + 2 * v23 + 1080);
              v27 = *(_WORD *)v26;
              if ( v27 >= v25 )
                *(_WORD *)v26 = v27 - v25;
              else
                *(_WORD *)v26 = 0;
            }
            ++v20;
            v19 -= 188;
          }
          while ( v20 < v16 );
          a5 = v46;
        }
        else
        {
          v15 = 0;
        }
        v28 = v16 + 1;
        if ( v28 < *((_BYTE *)v5 + 58) + v53 + v15 )
        {
          v29 = v54 - 1;
          if ( v54 <= 0 )
            v29 = 31;
          do
          {
            v30 = 7;
            v31 = v29;
            if ( v28 >= 0 )
            {
              v31 = v54;
              v30 = v28;
              if ( v28 - 1 >= 7 )
              {
                v30 = v28 % 8;
                v31 = v54 - ((v54 + ((unsigned int)((v54 + 1) >> 31) >> 27) + 1) & 0xFFFFFFE0) + 1;
              }
            }
            if ( (_WORD)a5 && (unsigned __int16)a5 <= 0x1770u && v31 <= 0x20 && (unsigned int)v30 <= 8 )
            {
              v32 = (signed __int64)((char *)v52 + 16 * (signed int)v31 + 2 * v30 + 1080);
              v33 = *(_WORD *)v32;
              if ( v33 >= (unsigned __int16)a5 )
                *(_WORD *)v32 = v33 - a5;
              else
                *(_WORD *)v32 = 0;
            }
            if ( *((_BYTE *)v5 + 54) == 1 )
            {
              v34 = (AppleUSBEHCITTInfo *)*((_QWORD *)v5 + 5);
              v35 = a5;
              v36 = v5;
              v37 = v29;
              v38 = v30;
              AppleUSBEHCITTInfo::ReleaseHSSplitINBytes(v34, v31, v30, v51);
              v29 = v37;
              v5 = v36;
              a5 = v35;
              v39 = 16LL * (signed int)v31;
              v40 = *(_WORD *)(v39 + *((_QWORD *)v36 + 5) + 2LL * (signed int)v38 + 868);
              if ( v40 <= 0xBB )
              {
                v41 = (unsigned __int16)(188 - v40);
                if ( v49 < v41 )
                  LOWORD(v41) = v50;
                if ( (_WORD)v41 && (unsigned __int16)v41 <= 0x1770u && v31 <= 0x20 && v38 <= 8 )
                {
                  v42 = (signed __int64)((char *)v52 + 2 * (signed int)v38 + v39 + 1080);
                  v43 = *(_WORD *)v42;
                  if ( v43 >= (unsigned __int16)v41 )
                    *(_WORD *)v42 = v43 - v41;
                  else
                    *(_WORD *)v42 = 0;
                }
              }
            }
            ++v28;
            v15 = *((_BYTE *)v5 + 57);
          }
          while ( v28 < *((_BYTE *)v5 + 58) + v53 + *((_BYTE *)v5 + 57) );
        }
        v54 += *((_BYTE *)v5 + 55);
        v7 = v48;
        v13 = v47;
      }
      while ( v54 < 32 );
    }
  }
  return 0LL;
}

//----- (000000000000F500) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::MetaClass::MetaClass(AppleUSBEHCI::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "AppleUSBEHCI", off_16018[0], 40032LL);
  result = (__int64)off_18130;
  *(_QWORD *)this = off_18130;
  return result;
}
// 16018: using guessed type _QWORD off_16018[24];
// 18130: using guessed type __int64 (__fastcall *off_18130[2])(AppleUSBEHCI::MetaClass *__hidden this);
// 2DBC8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000000F532) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::MetaClass::~MetaClass(AppleUSBEHCI::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000000F53C) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::AppleUSBEHCI(__int64 a1)
{
  __int64 result; // rax@1

  IOUSBControllerV3::IOUSBControllerV3(a1);
  result = (__int64)off_173C0;
  *(_QWORD *)a1 = off_173C0;
  return result;
}
// 173C0: using guessed type __int64 (__fastcall *off_173C0[2])(AppleUSBEHCI *__hidden this);
// 2E1E8: using guessed type int __cdecl IOUSBControllerV3::IOUSBControllerV3(_QWORD);

//----- (000000000000F55C) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::AppleUSBEHCI(__int64 a1)
{
  __int64 result; // rax@1

  IOUSBControllerV3::IOUSBControllerV3(a1);
  result = (__int64)off_173C0;
  *(_QWORD *)a1 = off_173C0;
  return result;
}
// 173C0: using guessed type __int64 (__fastcall *off_173C0[2])(AppleUSBEHCI *__hidden this);
// 2E1E8: using guessed type int __cdecl IOUSBControllerV3::IOUSBControllerV3(_QWORD);

//----- (000000000000F57C) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::~AppleUSBEHCI(AppleUSBEHCI *this)
{
  return IOUSBControllerV3::~IOUSBControllerV3(this);
}

//----- (000000000000F586) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::~AppleUSBEHCI(AppleUSBEHCI *this)
{
  return IOUSBControllerV3::~IOUSBControllerV3(this);
}

//----- (000000000000F590) ----------------------------------------------------
void __fastcall AppleUSBEHCI::~AppleUSBEHCI(AppleUSBEHCI *this)
{
  IOUSBControllerV3::~IOUSBControllerV3(this);
  OSObject::operator delete((void *)this);
}

//----- (000000000000F5B2) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::getMetaClass(AppleUSBEHCI *this)
{
  return (__int64)&AppleUSBEHCI::gMetaClass;
}
// 18AA0: using guessed type _QWORD AppleUSBEHCI::gMetaClass;

//----- (000000000000F5C0) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::MetaClass::MetaClass(AppleUSBEHCI::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "AppleUSBEHCI", off_16018[0], 40032LL);
  result = (__int64)off_18130;
  *(_QWORD *)this = off_18130;
  return result;
}
// 16018: using guessed type _QWORD off_16018[24];
// 18130: using guessed type __int64 (__fastcall *off_18130[2])(AppleUSBEHCI::MetaClass *__hidden this);
// 2DBC8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000000F5F2) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::MetaClass::alloc(AppleUSBEHCI::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)((char *)&loc_9C5A + 6), a2);
  IOUSBControllerV3::IOUSBControllerV3(v2);
  *(_QWORD *)v2 = off_173C0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUSBEHCI::gMetaClass);
  return v2;
}
// 173C0: using guessed type __int64 (__fastcall *off_173C0[2])(AppleUSBEHCI *__hidden this);
// 18AA0: using guessed type _QWORD AppleUSBEHCI::gMetaClass;
// 2E1E8: using guessed type int __cdecl IOUSBControllerV3::IOUSBControllerV3(_QWORD);

//----- (000000000000F632) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::AppleUSBEHCI(__int64 a1)
{
  IOUSBControllerV3::IOUSBControllerV3(a1);
  *(_QWORD *)a1 = off_173C0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUSBEHCI::gMetaClass);
}
// 173C0: using guessed type __int64 (__fastcall *off_173C0[2])(AppleUSBEHCI *__hidden this);
// 18AA0: using guessed type _QWORD AppleUSBEHCI::gMetaClass;
// 2E1E8: using guessed type int __cdecl IOUSBControllerV3::IOUSBControllerV3(_QWORD);

//----- (000000000000F662) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::AppleUSBEHCI(__int64 a1)
{
  IOUSBControllerV3::IOUSBControllerV3(a1);
  *(_QWORD *)a1 = off_173C0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUSBEHCI::gMetaClass);
}
// 173C0: using guessed type __int64 (__fastcall *off_173C0[2])(AppleUSBEHCI *__hidden this);
// 18AA0: using guessed type _QWORD AppleUSBEHCI::gMetaClass;
// 2E1E8: using guessed type int __cdecl IOUSBControllerV3::IOUSBControllerV3(_QWORD);

//----- (000000000000F692) ----------------------------------------------------
char __fastcall AppleUSBEHCI::init(__int64 a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // rax@2
  __int64 v3; // rax@3
  signed __int64 v5; // rbx@5
  __int64 v6; // rdi@6

  v1 = a1;
  if ( (unsigned __int8)(*(int (__cdecl **)(__int64))(off_16068[0] + 600))(a1) )
  {
    *(_BYTE *)(a1 + 440) = 0;
    LODWORD(v2) = IOSimpleLockAlloc(a1);
    *(_QWORD *)(a1 + 1648) = v2;
    if ( v2 )
    {
      LODWORD(v3) = IOSimpleLockAlloc(a1);
      *(_QWORD *)(a1 + 1656) = v3;
      if ( v3 )
      {
        *(_BYTE *)(a1 + 1692) = 0;
        *(_BYTE *)(*(_QWORD *)(a1 + 168) + 40LL) = 2;
        *(_DWORD *)(a1 + 1632) = 1;
        *(_DWORD *)(a1 + 1636) = 1;
        return 1;
      }
      v6 = *(_QWORD *)(a1 + 1648);
      v5 = v1 + 1656;
      if ( v6 )
        IOSimpleLockFree(v6);
    }
    else
    {
      v5 = a1 + 1656;
    }
    if ( *(_QWORD *)v5 )
      IOSimpleLockFree(*(_QWORD *)v5);
  }
  return 0;
}
// 16068: using guessed type __int64 off_16068[14];
// 2DB08: using guessed type int __cdecl IOSimpleLockAlloc(_QWORD);
// 2DB10: using guessed type int __cdecl IOSimpleLockFree(_QWORD);

//----- (000000000000F73A) ----------------------------------------------------
int __fastcall AppleUSBEHCI::stop(AppleUSBEHCI *this, IOService *a2)
{
  return (*(int (__fastcall **)(AppleUSBEHCI *, IOService *))(off_16068[0] + 1496))(this, a2);
}
// 16068: using guessed type __int64 off_16068[14];

//----- (000000000000F74C) ----------------------------------------------------
int __fastcall AppleUSBEHCI::willTerminate(AppleUSBEHCI *this, IOService *a2)
{
  if ( *((_BYTE *)this + 444) && *(_DWORD *)(*((_QWORD *)this + 88) + 4LL) == -1 )
    *((_BYTE *)this + 444) = 0;
  return (*(int (__fastcall **)(AppleUSBEHCI *, IOService *))(off_16068[0] + 1040))(this, a2);
}
// 16068: using guessed type __int64 off_16068[14];

//----- (000000000000F77E) ----------------------------------------------------
int __fastcall AppleUSBEHCI::didTerminate(AppleUSBEHCI *this, IOService *a2, __int64 a3, bool *a4)
{
  return (*(int (__fastcall **)(AppleUSBEHCI *, IOService *, __int64, bool *))(off_16068[0] + 1048))(this, a2, a3, a4);
}
// 16068: using guessed type __int64 off_16068[14];

//----- (000000000000F790) ----------------------------------------------------
int __fastcall AppleUSBEHCI::finalize(AppleUSBEHCI *this)
{
  return (*(int (__fastcall **)(AppleUSBEHCI *))(off_16068[0] + 1560))(this);
}
// 16068: using guessed type __int64 off_16068[14];

//----- (000000000000F7A2) ----------------------------------------------------
int __fastcall AppleUSBEHCI::free(AppleUSBEHCI *this)
{
  AppleUSBEHCI *v1; // rbx@1
  __int64 v2; // rdi@1
  __int64 v3; // rdi@3

  v1 = this;
  v2 = *((_QWORD *)this + 206);
  if ( v2 )
    IOSimpleLockFree(v2);
  v3 = *((_QWORD *)v1 + 207);
  if ( v3 )
    IOSimpleLockFree(v3);
  return (*(int (__fastcall **)(AppleUSBEHCI *))(off_16068[0] + 160))(v1);
}
// 16068: using guessed type __int64 off_16068[14];
// 2DB10: using guessed type int __cdecl IOSimpleLockFree(_QWORD);

//----- (000000000000F7E4) ----------------------------------------------------
void __fastcall AppleUSBEHCI::showRegisters(AppleUSBEHCI *this, __int64 a2, const char *a3)
{
  __int64 v3; // rdx@4
  __int64 v4; // rsi@5

  if ( *((_BYTE *)this + 444) )
  {
    if ( **((_DWORD **)this + 88) == -1 )
    {
      *((_BYTE *)this + 444) = 0;
    }
    else if ( *((_BYTE *)this + 505) )
    {
      v3 = 0LL;
      do
        v4 = *(_DWORD *)(*((_QWORD *)this + 88) + 4 * v3++ + 68);
      while ( (signed int)v3 < *((_BYTE *)this + 505) );
    }
  }
}

//----- (000000000000F82A) ----------------------------------------------------
int __fastcall AppleUSBEHCI::start(AppleUSBEHCI *this, IOService *a2)
{
  return (*(int (__fastcall **)(AppleUSBEHCI *, IOService *))(off_16068[0] + 1488))(this, a2);
}
// 16068: using guessed type __int64 off_16068[14];

//----- (000000000000F83C) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::UIMInitialize(AppleUSBEHCI *this, IOService *a2, const OSMetaClass *a3)
{
  __int64 v3; // rax@1
  signed int v4; // ebx@1
  __int64 v5; // rax@2
  __int64 v6; // rax@3
  char *v7; // r12@3
  signed __int64 v9; // rsi@12
  __int64 v10; // rax@12
  __int64 v11; // rcx@12
  __int64 v12; // rax@20
  int v13; // ebx@22
  char v14; // al@22
  __int64 v15; // rsi@22
  __int64 v16; // rax@27
  int v17; // ecx@27
  signed int v18; // ebx@29
  int v19; // eax@30
  __int64 v20; // rdx@32
  signed int v21; // ebx@33
  unsigned int v22; // ecx@40
  signed int v23; // ebx@40
  __int64 v24; // rdx@40
  __int64 v25; // rcx@40
  unsigned __int64 v26; // r8@40
  __int64 v27; // rax@44
  char v28; // al@47
  __int64 v29; // r13@48
  __int64 v30; // rax@49
  __int64 v31; // rax@51

  v3 = OSMetaClassBase::safeMetaCast(a2, *(const OSMetaClassBase **)off_16000[0], a3);
  *((_QWORD *)this + 61) = v3;
  v4 = -536870206;
  if ( !v3 )
    return (unsigned int)v4;
  LODWORD(v5) = (*(int (__fastcall **)(__int64, _QWORD, _QWORD))(*(_QWORD *)v3 + 1760LL))(v3, 0LL, 0LL);
  *((_QWORD *)this + 85) = v5;
  if ( v5 )
  {
    AppleUSBEHCI::SetVendorInfo(this);
    LODWORD(v6) = IOFilterInterruptEventSource::filterInterruptEventSource(
                    this,
                    AppleUSBEHCI::InterruptHandler,
                    AppleUSBEHCI::PrimaryInterruptFilter,
                    *((_QWORD *)this + 61),
                    0LL);
    v7 = (char *)this + 1608;
    *((_QWORD *)this + 201) = v6;
    if ( v6 )
    {
      if ( !(*(int (__fastcall **)(_QWORD, __int64))(**((_QWORD **)this + 17) + 320LL))(*((_QWORD *)this + 17), v6) )
      {
        v9 = *((_WORD *)this + 344);
        LODWORD(v10) = (*(int (__fastcall **)(AppleUSBEHCI *, signed __int64, _QWORD, _QWORD))(*(_QWORD *)this + 3344LL))(
                         this,
                         v9,
                         *((_WORD *)this + 345),
                         *((_WORD *)this + 346));
        v11 = *((_QWORD *)this + 84);
        *(_QWORD *)(v11 + 208) = v10;
        if ( !*(_BYTE *)(*((_QWORD *)this + 21) + 244LL)
          || (v4 = -536870201, *(_DWORD *)(v11 + 24) == 32770) && *(_DWORD *)(v11 + 28) == 1 )
        {
          if ( *((_WORD *)this + 344) == 4824 && *((_WORD *)this + 345) == 16399 )
          {
            if ( IOPCIDevice::extendedConfigRead16(*((IOPCIDevice **)this + 61), 0x84uLL) & 3 )
              KernelDebugLogInternal(
                1LL,
                1431519814LL,
                "The USB EHCI driver found a controller at the wrong PCI Power State (0x%x) - fixing that issue.");
            v9 = 132LL;
            IOPCIDevice::extendedConfigWrite16(*((IOPCIDevice **)this + 61), 0x84uLL, 0);
          }
          LODWORD(v12) = (*(int (__fastcall **)(_QWORD, signed __int64))(**((_QWORD **)this + 85) + 280LL))(
                           *((_QWORD *)this + 85),
                           v9);
          *((_QWORD *)this + 87) = v12;
          IOPCIDevice::extendedConfigWrite16(*((IOPCIDevice **)this + 61), 4uLL, 2u);
          v4 = AppleUSBEHCI::AcquireOSOwnership(this);
          if ( v4 )
          {
            KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBEHCI:: unable to obtain ownership: 0x%x");
          }
          else
          {
            AppleUSBEHCI::CheckForSharedXHCIController(this);
            v13 = *(_DWORD *)(*((_QWORD *)this + 87) + 8LL);
            v14 = (*(_QWORD *)(*((_QWORD *)this + 84) + 208LL) >> 20) & 1 | ~(unsigned __int8)*(_DWORD *)(*((_QWORD *)this + 87) + 8LL) & 1;
            *((_BYTE *)this + 1695) = v14 ^ 1;
            v15 = (__int64)"64bit";
            (*(void (__fastcall **)(AppleUSBEHCI *, _QWORD, _QWORD))(*(_QWORD *)this + 632LL))(this, "64bit", v14 != 1);
            *((_BYTE *)this + 1620) = ((v13 & 0xF0) != 0) + 1;
            if ( *(_BYTE *)(*((_QWORD *)this + 84) + 209LL) & 0x10 )
            {
              *((_BYTE *)this + 1620) = 4;
              AppleUSBEHCI::EnablePrefetchRegister(*((AppleUSBEHCI **)this + 61), "64bit");
            }
            *((_QWORD *)this + 88) = *((_QWORD *)this + 87) + **((_BYTE **)this + 87);
            (*(void (__cdecl **)(_QWORD))(**((_QWORD **)this + 17) + 352LL))(*((_QWORD *)this + 17));
            *((_WORD *)this + 856) = 1;
            if ( *((_BYTE *)this + 1695) )
              *(_DWORD *)(*((_QWORD *)this + 88) + 16LL) = 0;
            if ( *(_BYTE *)(*((_QWORD *)this + 84) + 211LL) & 1 )
            {
              v16 = *((_QWORD *)this + 88);
              v17 = *(_DWORD *)(v16 + 128);
              if ( v17 & 1 )
              {
                *(_DWORD *)(v16 + 128) = v17 & 0xFFFFFFFE;
                _mm_mfence();
              }
            }
            **((_DWORD **)this + 88) = 0;
            _mm_mfence();
            v18 = 0;
            while ( 1 )
            {
              v19 = *(_DWORD *)(*((_QWORD *)this + 88) + 4LL);
              if ( BYTE1(v19) & 0x10 )
                break;
              IOSleep(1LL);
              ++v18;
              if ( v18 >= 100 )
              {
                v20 = (__int64)"AppleUSBEHCI::UIMInitialize - could not get chip to halt within 100 ms";
LABEL_39:
                KernelDebugLogInternal(1LL, 1431519814LL, v20);
                v4 = -536870199;
                goto LABEL_9;
              }
            }
            **((_DWORD **)this + 88) = 2;
            _mm_mfence();
            v21 = 0;
            while ( **((_DWORD **)this + 88) & 2 )
            {
              IOSleep(1LL);
              ++v21;
              if ( v21 >= 100 )
                goto LABEL_38;
            }
            if ( v21 >= 100 )
            {
LABEL_38:
              v20 = (__int64)"AppleUSBEHCI::UIMInitialize - could not get chip to come out of reset within 100 ms";
              goto LABEL_39;
            }
            *(_DWORD *)(*((_QWORD *)this + 88) + 20LL) = 0;
            *(_DWORD *)(*((_QWORD *)this + 88) + 24LL) = 0;
            _mm_mfence();
            v22 = **((_DWORD **)this + 88) & 0xFF00FFFF;
            *((_DWORD *)this + 433) = 1024;
            *((_BYTE *)this + 440) = 2;
            **((_DWORD **)this + 88) = v22 | 0x10000;
            *(_DWORD *)(*((_QWORD *)this + 88) + 64LL) = 1;
            _mm_mfence();
            v23 = 1;
            IOSleep(1LL);
            if ( *(_BYTE *)(*((_QWORD *)this + 84) + 209LL) & 4 && *(_DWORD *)(*((_QWORD *)this + 88) + 64LL) != 1 )
            {
              do
              {
                v15 = 1431519814LL;
                KernelDebugLogInternal(
                  1LL,
                  1431519814LL,
                  "EHCI driver: UIMInitialize - ConfigFlag bit not sticking. Retrying.");
                *(_DWORD *)(*((_QWORD *)this + 88) + 64LL) = 1;
                _mm_mfence();
                if ( (unsigned int)v23 > 9 )
                  break;
                ++v23;
              }
              while ( *(_DWORD *)(*((_QWORD *)this + 88) + 64LL) != 1 );
            }
            *((_WORD *)this + 906) = 1025;
            *((_QWORD *)this + 213) = 0LL;
            v27 = *((_QWORD *)this + 21);
            if ( !*(_BYTE *)(v27 + 244) )
              *(_DWORD *)(v27 + 204) = 25000;
            *((_WORD *)this + 796) = 100;
            v4 = AppleUSBEHCI::InterruptInitialize(this, v15, v24, v25, v26);
            if ( !v4 )
            {
              AppleUSBEHCI::CheckSleepCapability(this);
              v28 = *(_DWORD *)(*((_QWORD *)this + 87) + 4LL) & 0xF;
              *((_BYTE *)this + 505) = v28;
              if ( !v28 )
              {
LABEL_51:
                v4 = 0;
                LODWORD(v31) = AppleUSBDiagnostics::createDiagnostics((char *)this + 2800, (char *)this + 1688, 0LL);
                *((_QWORD *)this + 349) = v31;
                if ( v31 )
                  (*(void (__fastcall **)(AppleUSBEHCI *, _QWORD, __int64))(*(_QWORD *)this + 616LL))(
                    this,
                    "Statistics",
                    v31);
                *((_BYTE *)this + 1692) = 1;
                (*(void (__fastcall **)(AppleUSBEHCI *, _QWORD))(*(_QWORD *)this + 1456LL))(this, 0LL);
                return (unsigned int)v4;
              }
              v4 = 0;
              v29 = 0LL;
              while ( 1 )
              {
                LODWORD(v30) = thread_call_allocate(AppleUSBEHCI::RHResumePortTimerEntry, this);
                *((_QWORD *)this + v29 + 245) = v30;
                if ( !v30 )
                  break;
                ++v29;
                if ( (signed int)v29 >= *((_BYTE *)this + 505) )
                  goto LABEL_51;
              }
            }
          }
        }
        goto LABEL_9;
      }
      KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBEHCI:: unable to add filter event source: 0x%x");
    }
    else
    {
      KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBEHCI:: unable to get filterInterruptEventSource");
    }
  }
  else
  {
    KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBEHCI::UIMInitialize - unable to get device memory");
    v7 = (char *)this + 1608;
  }
  v4 = -536870210;
LABEL_9:
  KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBEHCI::UIMInitialize - Error occurred (0x%x)");
  (*(void (__fastcall **)(AppleUSBEHCI *, signed __int64))(*(_QWORD *)this + 2144LL))(this, 1431519814LL);
  if ( *(_QWORD *)v7 )
    (*(void (__cdecl **)(_QWORD))(**(_QWORD **)v7 + 40LL))(*(_QWORD *)v7);
  return (unsigned int)v4;
}
// 16000: using guessed type _QWORD off_16000[27];
// 2DB30: using guessed type int __fastcall IOSleep(_QWORD);
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);
// 2DEC8: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);
// 2E200: using guessed type int __fastcall AppleUSBDiagnostics::createDiagnostics(_QWORD, _QWORD, _QWORD);
// 2E238: using guessed type int __fastcall IOFilterInterruptEventSource::filterInterruptEventSource(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 2E9E8: using guessed type int __fastcall thread_call_allocate(_QWORD, _QWORD);

//----- (000000000000FDFA) ----------------------------------------------------
__int16 __fastcall AppleUSBEHCI::SetVendorInfo(AppleUSBEHCI *this)
{
  OSMetaClassBase *v1; // rax@1
  const OSMetaClassBase *v2; // r14@1
  __int64 v3; // rsi@1
  const OSMetaClass *v4; // rdx@1
  __int64 v5; // rax@1
  __int64 v6; // rax@2
  OSMetaClassBase *v7; // rax@3
  const OSMetaClass *v8; // rdx@3
  __int64 v9; // rax@3
  __int64 v10; // rax@4
  OSMetaClassBase *v11; // rax@5
  const OSMetaClass *v12; // rdx@5
  __int64 v13; // rax@5

  LODWORD(v1) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 61) + 696LL))(
                  *((_QWORD *)this + 61),
                  "vendor-id");
  v2 = *(const OSMetaClassBase **)off_16050[0];
  v3 = *(_QWORD *)off_16050[0];
  v5 = OSMetaClassBase::safeMetaCast(v1, *(const OSMetaClassBase **)off_16050[0], v4);
  if ( v5 )
  {
    LODWORD(v6) = (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v5 + 376LL))(v5, v3);
    *((_WORD *)this + 344) = *(_WORD *)v6;
  }
  LODWORD(v7) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 61) + 696LL))(
                  *((_QWORD *)this + 61),
                  "device-id");
  v9 = OSMetaClassBase::safeMetaCast(v7, v2, v8);
  if ( v9 )
  {
    LODWORD(v10) = (*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v9 + 376LL))(v9, v2);
    *((_WORD *)this + 345) = *(_WORD *)v10;
  }
  LODWORD(v11) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 61) + 696LL))(
                   *((_QWORD *)this + 61),
                   "revision-id");
  v13 = OSMetaClassBase::safeMetaCast(v11, v2, v12);
  if ( v13 )
  {
    LODWORD(v13) = (*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v13 + 376LL))(v13, v2);
    LOWORD(v13) = *(_WORD *)v13;
    *((_WORD *)this + 346) = v13;
  }
  return v13;
}
// 16050: using guessed type _QWORD off_16050[17];
// 2DEC8: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000000FECA) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::AcquireOSOwnership(AppleUSBEHCI *this)
{
  int v1; // eax@1
  unsigned __int64 v2; // rbx@1
  signed int v3; // er15@1
  int v4; // eax@2
  unsigned __int64 v5; // r15@3
  signed int v6; // ebx@3
  __int64 v7; // rax@6

  v1 = *(_DWORD *)(*((_QWORD *)this + 87) + 8LL);
  v2 = BYTE1(v1);
  v3 = 0;
  if ( BYTE1(v1) >= 0x40u )
  {
    v4 = IOPCIDevice::extendedConfigRead32(*((IOPCIDevice **)this + 61), BYTE1(v1));
    if ( (unsigned __int8)v4 == 1 )
    {
      v5 = v2;
      IOPCIDevice::extendedConfigWrite32(*((IOPCIDevice **)this + 61), v2, v4 | 0x1000000);
      v6 = 0;
      do
      {
        if ( !(IOPCIDevice::extendedConfigRead32(*((IOPCIDevice **)this + 61), v5) & 0x10000) )
          break;
        IOSleep(10LL);
        ++v6;
      }
      while ( v6 < 25 );
      v7 = IOPCIDevice::extendedConfigRead32(*((IOPCIDevice **)this + 61), v5);
      v3 = 0;
      if ( v7 & 0x10000 )
      {
        KernelDebugLogInternal(1LL, 1431519814LL, "EHCI controller unable to take control from BIOS");
        v3 = -536870210;
      }
    }
  }
  return (unsigned int)v3;
}
// 2DB30: using guessed type int __fastcall IOSleep(_QWORD);
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (000000000000FF8E) ----------------------------------------------------
int __fastcall AppleUSBEHCI::CheckForSharedXHCIController(AppleUSBEHCI *this)
{
  AppleUSBEHCI *v1; // rbx@1
  __int64 v2; // rax@1
  __int64 v3; // r14@2
  int v4; // er15@3
  __int64 v5; // r14@4
  __int64 v6; // rax@5
  __int64 v7; // rax@6
  __int64 v8; // r15@7
  OSMetaClassBase *v9; // rax@11
  OSMetaClassBase *v10; // r14@11
  signed __int64 v11; // rsi@12
  __int64 v12; // rax@13
  const char *v13; // rax@13
  const char *v14; // r15@13
  int v15; // ecx@14
  __int64 v16; // rdx@22
  __int64 v17; // rdi@26
  __int64 v19; // [sp+0h] [bp-50h]@7
  __int64 v20; // [sp+8h] [bp-48h]@7
  __int64 v21; // [sp+10h] [bp-40h]@13
  char v22; // [sp+18h] [bp-38h]@7
  int v23; // [sp+24h] [bp-2Ch]@1

  v1 = this;
  v23 = 0;
  LODWORD(v2) = IOService::isInactive(this);
  if ( (_BYTE)v2 )
    return v2;
  *((_QWORD *)this + 5002) = 0LL;
  v2 = IOUSBController::CopyACPIDevice(this, *((IORegistryEntry **)this + 61));
  v3 = v2;
  if ( !v2 )
    return v2;
  v4 = (*(int (__fastcall **)(__int64, _QWORD, int *, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v2 + 2256LL))(
         v2,
         "XHCN",
         &v23,
         0LL,
         0LL,
         0LL);
  LODWORD(v2) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v3 + 40LL))(v3);
  if ( v4 )
    return v2;
  LODWORD(v2) = IOService::serviceMatching("AppleUSBXHCI", 0LL);
  v5 = v2;
  if ( !v2 )
    return v2;
  v6 = OSArray::withCapacity((OSArray *)((char *)&dword_0 + 1), 0);
  *((_QWORD *)this + 5003) = v6;
  if ( !v6 )
  {
    v16 = (__int64)"AppleUSBEHCI::CheckForSharedXHCIController failed to allocated array";
LABEL_24:
    LODWORD(v2) = KernelDebugLogInternal(1LL, 1431519814LL, v16);
    return v2;
  }
  LODWORD(v7) = IOService::addMatchingNotification(
                  *(_QWORD *)off_160A8[0],
                  v5,
                  AppleUSBEHCI::XHCIControllerMatchingNotifcationHandler,
                  this,
                  0LL,
                  0LL);
  if ( !v7 )
  {
    v16 = (__int64)"AppleUSBEHCI::CheckForSharedXHCIController could not set up matching notification";
    goto LABEL_24;
  }
  v19 = v7;
  v20 = v5;
  IOUSBWorkLoop::CloseGate(*((IOUSBWorkLoop **)this + 17));
  v22 = 0;
  v8 = 0LL;
  while ( 1 )
  {
    do
    {
      if ( (*(int (**)(void))(**((_QWORD **)this + 5003) + 304LL))() )
        goto LABEL_11;
    }
    while ( (unsigned int)IOUSBWorkLoop::SleepWithTimeout(
                            *((IOUSBWorkLoop **)this + 17),
                            (char *)this + 40016,
                            0x2540BE400uLL) != 1 );
    KernelDebugLogInternal(
      1LL,
      1431519814LL,
      "AppleUSBEHCI::CheckForSharedXHCIController timed out waiting for muxed XHCI controller");
LABEL_11:
    LODWORD(v9) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 5003) + 488LL))(
                    *((_QWORD *)this + 5003),
                    0LL);
    v10 = v9;
    if ( !v9 )
      break;
    (*(void (__fastcall **)(OSMetaClassBase *))(*(_QWORD *)v9 + 32LL))(v9);
    (*(void (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 5003) + 472LL))(*((_QWORD *)this + 5003), 0LL);
    v11 = (signed __int64)"AppleUSBXHCI";
    if ( OSMetaClassBase::metaCast(v10, "AppleUSBXHCI") )
    {
      v21 = v8;
      LODWORD(v12) = (*(int (__fastcall **)(OSMetaClassBase *, _QWORD))(*(_QWORD *)v10 + 792LL))(
                       v10,
                       *(_QWORD *)off_160B0[0]);
      LODWORD(v13) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v12 + 904LL))(v12, 0LL);
      v14 = v13;
      v11 = (signed __int64)"XHC";
      if ( !strncmp(v13, "XHC", 3uLL) && (v15 = v14[3] - 49, (unsigned int)v15 <= 9) )
        v8 = (1 << v15) | (unsigned int)v21;
      else
        v8 = v21;
      if ( ((unsigned int)v8 & v23) == v23 )
      {
        *((_QWORD *)this + 5002) = v10;
        (*(void (__fastcall **)(OSMetaClassBase *, _QWORD))(*(_QWORD *)v10 + 32LL))(v10, "XHC");
        v22 = 1;
      }
      (*(void (__fastcall **)(OSMetaClassBase *, _QWORD))(*(_QWORD *)v10 + 40LL))(v10, "XHC");
    }
    if ( v22 & 1 )
      goto LABEL_26;
  }
  v11 = 1431519814LL;
  KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBEHCI::CheckForSharedXHCIController error getting XHCI controller");
LABEL_26:
  IOUSBWorkLoop::OpenGate(*((IOUSBWorkLoop **)this + 17));
  (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v19 + 280LL))(v19, v11);
  v17 = *((_QWORD *)this + 5003);
  if ( v17 )
  {
    (*(void (**)(void))(*(_QWORD *)v17 + 344LL))();
    (*(void (**)(void))(**((_QWORD **)v1 + 5003) + 40LL))();
    *((_QWORD *)v1 + 5003) = 0LL;
  }
  LODWORD(v2) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v20 + 40LL))(v20);
  if ( !(v23 & (unsigned int)v8) )
    LODWORD(v2) = KernelDebugLogInternal(
                    1LL,
                    1431519814LL,
                    "AppleUSBEHCI::CheckForSharedXHCIController - unable to find the correct XHCI xhciBitmap(0x%08x) assertVal(0x%08x)");
  return v2;
}
// 0: using guessed type int dword_0;
// 160A8: using guessed type __int64 off_160A8[6];
// 160B0: using guessed type __int64 off_160B0[5];
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);
// 2E440: using guessed type int __fastcall IOService::serviceMatching(_QWORD, _QWORD);
// 2E6A8: using guessed type int __fastcall IOService::addMatchingNotification(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000010290) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::EnablePrefetchRegister(AppleUSBEHCI *this, IOPCIDevice *a2)
{
  __int64 result; // rax@1

  result = IOPCIDevice::extendedConfigRead8(this, 0x84uLL);
  if ( result & 0x10 )
    result = IOPCIDevice::extendedConfigWrite8(this, 0x84uLL, result & 0xEF);
  return result;
}

//----- (00000000000102C6) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::InterruptInitialize(AppleUSBEHCI *this, __int64 a2, __int64 a3, __int64 a4, unsigned __int64 a5)
{
  __int64 v5; // rax@1
  int v6; // ebx@2
  signed __int64 v7; // rsi@3
  __int64 v8; // rax@5
  __int64 v9; // rax@5
  __int64 v10; // r15@5
  signed __int64 v11; // rsi@7
  int v12; // er12@10
  __int64 v13; // rax@12
  __int64 v14; // r15@13
  __int64 v15; // rax@15
  __int64 v16; // rbx@15
  __int64 v17; // rax@17
  __int64 v18; // rcx@17
  int v20; // [sp+1Ch] [bp-34h]@1
  int v21; // [sp+20h] [bp-30h]@10
  int v22; // [sp+24h] [bp-2Ch]@10
  __int64 v23; // [sp+28h] [bp-28h]@1

  v23 = 0LL;
  v20 = 1;
  v5 = IOBufferMemoryDescriptor::inTaskWithPhysicalMask(
         *(IOBufferMemoryDescriptor **)off_160D0,
         (task *)((char *)&dword_0 + 3),
         0x1000u,
         0xFFFFF000uLL,
         a5);
  *((_QWORD *)this + 100) = v5;
  if ( v5 )
  {
    v6 = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v5 + 496LL))(v5, 0LL);
    if ( v6 )
    {
      v7 = 1431519814LL;
      KernelDebugLogInternal(
        1LL,
        1431519814LL,
        "AppleUSBEHCI::InterruptInitialize - could not prepare buffer err(0x%x)");
LABEL_32:
      (*(void (__fastcall **)(_QWORD, signed __int64))(**((_QWORD **)this + 100) + 40LL))(*((_QWORD *)this + 100), v7);
      *((_QWORD *)this + 100) = 0LL;
      return (unsigned int)v6;
    }
    LODWORD(v8) = (*(int (**)(void))(**((_QWORD **)this + 100) + 736LL))();
    *((_QWORD *)this + 101) = v8;
    LODWORD(v9) = IODMACommand::withSpecification(off_16008[0], 32LL, 4096LL, 64LL, 0LL, 1LL);
    v10 = v9;
    if ( v9 )
    {
      v6 = (*(int (__fastcall **)(__int64, _QWORD, signed __int64))(*(_QWORD *)v9 + 296LL))(
             v9,
             *((_QWORD *)this + 100),
             1LL);
      if ( v6 )
      {
        v11 = 1431519814LL;
        KernelDebugLogInternal(
          1LL,
          1431519814LL,
          "AppleUSBEHCI::InterruptInitialize - setMemoryDescriptor returned err (0x%x)");
LABEL_31:
        (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v10 + 40LL))(v10, v11);
        v7 = 0LL;
        (*(void (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 100) + 504LL))(*((_QWORD *)this + 100), 0LL);
        goto LABEL_32;
      }
      v12 = (*(int (__fastcall **)(__int64, __int64 *, int *, int *))(*(_QWORD *)v10 + 344LL))(v10, &v23, &v21, &v20);
      if ( v22 != 4096 || v20 != 1 || v12 != 0 )
      {
        KernelDebugLogInternal(
          1LL,
          1431519814LL,
          "AppleUSBEHCI::InterruptInitialize - could not generate segments err (0x%x) numSegments (%d) fLength (%d)");
        v6 = -536870199;
        if ( v12 )
          v6 = v12;
        v11 = 1LL;
        (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v10 + 304LL))(v10, 1LL);
        goto LABEL_31;
      }
      *((_DWORD *)this + 450) = v21;
      _mm_mfence();
      (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v10 + 304LL))(v10, 1LL);
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v10 + 40LL))(v10);
      LODWORD(v13) = IOMalloc(0x2000LL);
      *((_QWORD *)this + 102) = v13;
      if ( v13 )
      {
        v14 = 0LL;
        while ( 1 )
        {
          if ( (signed int)v14 > 31 )
          {
            v16 = *((_QWORD *)this + (signed int)v14 % 32 + 103);
          }
          else
          {
            v15 = AppleUSBEHCI::MakeEmptyIntEndPoint(this, 0LL, 0, 8u, 2u, 0, 0, 1u);
            v16 = v15;
            if ( !v15 )
            {
              KernelDebugLogInternal(
                1LL,
                1431519814LL,
                "AppleUSBEHCI::InterruptInitialize - could not create empty endpoint");
              v6 = -536870210;
              return (unsigned int)v6;
            }
            if ( *(_QWORD *)(v15 + 40) )
            {
              *(_DWORD *)(AppleEHCIQueueHead::GetSharedLogical((AppleEHCIQueueHead *)v15) + 16) = 1;
              v17 = *(_QWORD *)(v15 + 40);
              *(_QWORD *)(v17 + 32) = 0LL;
              v18 = *((_QWORD *)this + 95);
              if ( v18 )
              {
                *(_QWORD *)(v18 + 32) = v17;
                *((_QWORD *)this + 95) = v17;
              }
              else
              {
                *((_QWORD *)this + 95) = v17;
                *((_QWORD *)this + 90) = v17;
              }
              *(_QWORD *)(v16 + 40) = 0LL;
              *(_QWORD *)(v16 + 48) = 0LL;
            }
            *(_WORD *)(v16 + 64) = 0;
            *(_BYTE *)(v16 + 74) = 10;
            *(_WORD *)(v16 + 78) = 512;
            (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v16 + 280LL))(v16, 1LL);
            *((_QWORD *)this + v14 + 103) = v16;
          }
          *(_QWORD *)(*((_QWORD *)this + 102) + 8 * v14) = v16;
          if ( v16 )
            *(_DWORD *)(*((_QWORD *)this + 101) + 4 * v14) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v16 + 296LL))(v16);
          else
            *(_DWORD *)(*((_QWORD *)this + 101) + 4 * v14) = 1;
          _mm_mfence();
          ++v14;
          v6 = 0;
          if ( (signed int)v14 >= 1024 )
            return (unsigned int)v6;
        }
      }
    }
    else
    {
      KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBEHCI::InterruptInitialize - could not get IODMACommand");
    }
    (*(void (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 100) + 504LL))(*((_QWORD *)this + 100), 0LL);
    (*(void (__cdecl **)(_QWORD, _QWORD))(**((_QWORD **)this + 100) + 40LL))(*((_QWORD *)this + 100), 0LL);
    *((_QWORD *)this + 100) = 0LL;
    v6 = -536870211;
  }
  else
  {
    KernelDebugLogInternal(
      1LL,
      1431519814LL,
      "AppleUSBEHCI::InterruptInitialize - IOBufferMemoryDescriptor::inTaskWithPhysicalMask failed");
    v6 = -536870211;
  }
  return (unsigned int)v6;
}
// 0: using guessed type int dword_0;
// 16008: using guessed type __int64 off_16008[26];
// 160D0: using guessed type __int64 off_160D0;
// 2DB00: using guessed type int __fastcall IOMalloc(_QWORD);
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);
// 2DBE8: using guessed type int __fastcall IODMACommand::withSpecification(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000010696) ----------------------------------------------------
char __fastcall AppleUSBEHCI::XHCIControllerMatchingNotifcationHandler(AppleUSBEHCI *this, void *a2, IOService *a3)
{
  IOService *v3; // r14@1
  AppleUSBEHCI *v4; // rbx@1
  __int64 v5; // rdi@2

  v3 = a3;
  v4 = this;
  IOUSBWorkLoop::CloseGate(*((IOUSBWorkLoop **)this + 17));
  if ( v3 )
  {
    v5 = *((_QWORD *)this + 5003);
    if ( v5 )
      (*(void (__fastcall **)(__int64, IOService *))(*(_QWORD *)v5 + 440LL))(v5, v3);
  }
  IOUSBWorkLoop::Wakeup(*((IOUSBWorkLoop **)v4 + 17), (char *)v4 + 40016, 1);
  IOUSBWorkLoop::OpenGate(*((IOUSBWorkLoop **)v4 + 17));
  return 1;
}

//----- (00000000000106F8) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::AsyncInitialize(AppleUSBEHCI *this)
{
  *((_QWORD *)this + 217) = 0LL;
  *((_QWORD *)this + 218) = 0LL;
  return 0LL;
}

//----- (0000000000010716) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::DeallocateTD(__int64 a1, __int64 a2)
{
  __int64 v2; // rax@1

  *(_QWORD *)(a2 + 32) = 0LL;
  v2 = *(_QWORD *)(a1 + 760);
  if ( v2 )
  {
    *(_QWORD *)(v2 + 32) = a2;
    *(_QWORD *)(a1 + 760) = a2;
  }
  else
  {
    *(_QWORD *)(a1 + 760) = a2;
    *(_QWORD *)(a1 + 720) = a2;
  }
  return 0LL;
}

//----- (000000000001074E) ----------------------------------------------------
int __fastcall AppleUSBEHCI::SetPeriodicListEntry(AppleUSBEHCI *this, int a2, IOUSBControllerListElement *a3)
{
  __int64 v3; // rax@2

  *(_QWORD *)(*((_QWORD *)this + 102) + 8LL * a2) = a3;
  if ( a3 )
  {
    LODWORD(v3) = (*(int (__fastcall **)(IOUSBControllerListElement *))(*(_QWORD *)a3 + 296LL))(a3);
    *(_DWORD *)(*((_QWORD *)this + 101) + 4LL * a2) = v3;
  }
  else
  {
    v3 = *((_QWORD *)this + 101);
    *(_DWORD *)(v3 + 4LL * a2) = 1;
  }
  _mm_mfence();
  return v3;
}

//----- (000000000001079C) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::UIMFinalize(AppleUSBEHCI *this)
{
  uintptr_t v1; // r15@1
  __int64 v2; // rdi@1
  unsigned __int8 v3; // al@4
  const OSMetaClass *v4; // rdx@6
  __int64 v5; // rax@7
  signed int v6; // ebx@11
  int v7; // eax@12
  __int64 v8; // rdx@14
  signed int v9; // ebx@15
  signed int v10; // er14@21
  signed int v11; // ebx@24
  __int64 v12; // rdi@28
  AppleEHCItdMemoryBlock *v13; // rbx@30
  __int64 v14; // r14@32
  AppleEHCIitdMemoryBlock *v15; // rbx@33
  __int64 v16; // r14@35
  __int64 i; // rbx@36
  __int64 v18; // rbx@38
  __int64 v19; // rdi@39
  AppleEHCIedMemoryBlock *v20; // rbx@42
  __int64 v21; // r14@44
  __int64 v22; // rdi@45
  __int64 v23; // rdi@47
  __int64 v24; // rdi@49
  __int64 v25; // rdi@52

  v1 = (uintptr_t)this;
  IOSleep(2LL);
  v2 = *((_QWORD *)this + 261);
  if ( v2 )
  {
    (*(void (__cdecl **)(__int64))(*(_QWORD *)v2 + 280LL))(v2);
    *(_QWORD *)(v1 + 2088) = 0LL;
  }
  if ( *(_BYTE *)off_160C0[0] & 2 )
  {
    v3 = IOService::isInactive((IOService *)v1);
    if ( *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D5018u, v1, v3, *(_QWORD *)(v1 + 704), *(_QWORD *)(v1 + 488), 0LL);
  }
  if ( !(unsigned __int8)IOService::isInactive((IOService *)v1) )
  {
    v5 = *(_QWORD *)(v1 + 704);
    if ( v5 )
    {
      if ( *(_QWORD *)(v1 + 488) )
      {
        *(_DWORD *)(v5 + 8) = 0;
        _mm_mfence();
        if ( *(_BYTE *)(v1 + 1695) )
          *(_DWORD *)(*(_QWORD *)(v1 + 704) + 16LL) = 0;
        **(_DWORD **)(v1 + 704) = 0;
        _mm_mfence();
        v6 = 0;
        while ( 1 )
        {
          v7 = *(_DWORD *)(*(_QWORD *)(v1 + 704) + 4LL);
          if ( BYTE1(v7) & 0x10 )
            break;
          IOSleep(1LL);
          ++v6;
          if ( v6 >= 100 )
          {
            v8 = (__int64)"AppleUSBEHCI::UIMFinalize - could not get chip to halt within 100 ms";
LABEL_21:
            KernelDebugLogInternal(1LL, 1431519814LL, v8);
            v10 = -536870199;
            goto LABEL_54;
          }
        }
        *(_BYTE *)(v1 + 440) = 0;
        **(_DWORD **)(v1 + 704) = 2;
        _mm_mfence();
        v9 = 0;
        while ( **(_DWORD **)(v1 + 704) & 2 )
        {
          IOSleep(1LL);
          ++v9;
          if ( v9 >= 100 )
            goto LABEL_20;
        }
        if ( v9 >= 100 )
        {
LABEL_20:
          v8 = (__int64)"AppleUSBEHCI::UIMFinalize - could not get chip to come out of reset within 100 ms";
          goto LABEL_21;
        }
        *(_DWORD *)(*(_QWORD *)(v1 + 704) + 64LL) = 0;
        _mm_mfence();
        if ( *(_BYTE *)(*(_QWORD *)(v1 + 672) + 209LL) & 4 && *(_DWORD *)(*(_QWORD *)(v1 + 704) + 64LL) )
        {
          v11 = 1;
          do
          {
            KernelDebugLogInternal(
              1LL,
              1431519814LL,
              "EHCI driver: UIMFinalize - ConfigFlag bit not sticking. Retrying.");
            *(_DWORD *)(*(_QWORD *)(v1 + 704) + 64LL) = 0;
            _mm_mfence();
            if ( (unsigned int)v11 > 9 )
              break;
            ++v11;
          }
          while ( *(_DWORD *)(*(_QWORD *)(v1 + 704) + 64LL) );
        }
        IOPCIDevice::extendedConfigWrite16(*(IOPCIDevice **)(v1 + 488), 4uLL, 2u);
        *(_DWORD *)(*(_QWORD *)(v1 + 704) + 20LL) = 0;
        *(_DWORD *)(*(_QWORD *)(v1 + 704) + 24LL) = 0;
        _mm_mfence();
      }
    }
  }
  v12 = *(_QWORD *)(v1 + 40016);
  if ( v12 )
  {
    (*(void (__cdecl **)(__int64))(*(_QWORD *)v12 + 40LL))(v12);
    *(_QWORD *)(v1 + 40016) = 0LL;
  }
  v13 = *(AppleEHCItdMemoryBlock **)(v1 + 1760);
  if ( v13 )
  {
    *(_QWORD *)(v1 + 1760) = 0LL;
    do
    {
      v14 = AppleEHCItdMemoryBlock::GetNextBlock(v13);
      (*(void (__fastcall **)(AppleEHCItdMemoryBlock *))(*(_QWORD *)v13 + 40LL))(v13);
      v13 = (AppleEHCItdMemoryBlock *)v14;
    }
    while ( v14 );
  }
  v15 = *(AppleEHCIitdMemoryBlock **)(v1 + 1768);
  if ( v15 )
  {
    *(_QWORD *)(v1 + 1768) = 0LL;
    do
    {
      v16 = AppleEHCIitdMemoryBlock::GetNextBlock(v15);
      (*(void (__fastcall **)(AppleEHCIitdMemoryBlock *))(*(_QWORD *)v15 + 40LL))(v15);
      v15 = (AppleEHCIitdMemoryBlock *)v16;
    }
    while ( v16 );
  }
  for ( i = *(_QWORD *)(v1 + 752); i; i = *(_QWORD *)(v1 + 752) )
  {
    *(_QWORD *)(v1 + 752) = OSMetaClassBase::safeMetaCast(
                              *(OSMetaClassBase **)(i + 32),
                              (const OSMetaClassBase *)AppleEHCIQueueHead::metaClass,
                              v4);
    (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)i + 40LL))(i, AppleEHCIQueueHead::metaClass);
  }
  v18 = 0LL;
  do
  {
    v19 = *(_QWORD *)(v1 + 8 * v18 + 824);
    if ( v19 )
      (*(void (__cdecl **)(__int64))(*(_QWORD *)v19 + 40LL))(v19);
    ++v18;
  }
  while ( v18 != 32 );
  v20 = *(AppleEHCIedMemoryBlock **)(v1 + 1752);
  if ( v20 )
  {
    *(_QWORD *)(v1 + 1752) = 0LL;
    do
    {
      v21 = AppleEHCIedMemoryBlock::GetNextBlock(v20);
      (*(void (__fastcall **)(AppleEHCIedMemoryBlock *))(*(_QWORD *)v20 + 40LL))(v20);
      v20 = (AppleEHCIedMemoryBlock *)v21;
    }
    while ( v21 );
  }
  v22 = *(_QWORD *)(v1 + 800);
  if ( v22 )
  {
    (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v22 + 504LL))(v22, 0LL);
    (*(void (__cdecl **)(_QWORD))(**(_QWORD **)(v1 + 800) + 40LL))(*(_QWORD *)(v1 + 800));
    *(_QWORD *)(v1 + 800) = 0LL;
  }
  v23 = *(_QWORD *)(v1 + 816);
  if ( v23 )
  {
    IOFree(v23, 0x2000LL);
    *(_QWORD *)(v1 + 816) = 0LL;
  }
  v24 = *(_QWORD *)(v1 + 2792);
  if ( v24 )
  {
    (*(void (__cdecl **)(__int64))(*(_QWORD *)v24 + 40LL))(v24);
    *(_QWORD *)(v1 + 2792) = 0LL;
  }
  v10 = 0;
  if ( *(_QWORD *)(v1 + 1608) )
  {
    v25 = *(_QWORD *)(v1 + 136);
    if ( v25 )
    {
      (*(void (__cdecl **)(__int64))(*(_QWORD *)v25 + 328LL))(v25);
      (*(void (__cdecl **)(_QWORD))(**(_QWORD **)(v1 + 1608) + 40LL))(*(_QWORD *)(v1 + 1608));
      *(_QWORD *)(v1 + 1608) = 0LL;
    }
  }
LABEL_54:
  *(_BYTE *)(v1 + 1692) = 0;
  return (unsigned int)v10;
}
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];
// 165C0: using guessed type _QWORD AppleEHCIQueueHead::metaClass;
// 2DAC8: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// 2DB30: using guessed type int __fastcall IOSleep(_QWORD);
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);
// 2DEC8: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000010B7E) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::GetBandwidthAvailable(AppleUSBEHCI *this)
{
  char *v1; // rdi@1
  __int64 result; // rax@1
  __int64 v3; // r8@1
  signed __int64 v4; // rdx@2
  char *v5; // rsi@2
  signed int v6; // ecx@3

  v1 = (char *)this + 1080;
  LODWORD(result) = 6000;
  v3 = 0LL;
  do
  {
    v4 = 8LL;
    v5 = v1;
    do
    {
      v6 = result;
      result = 6000 - (unsigned int)*(_WORD *)v5;
      if ( (signed int)result > v6 )
        result = (unsigned int)v6;
      v5 += 2;
      --v4;
    }
    while ( v4 );
    ++v3;
    v1 += 16;
  }
  while ( v3 != 32 );
  return result;
}

//----- (0000000000010BC4) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::GetFrameNumber32(uintptr_t arg1)
{
  __int64 v1; // rcx@1
  int v2; // edx@1
  unsigned int v3; // ebx@1
  __int64 v4; // rcx@6
  unsigned int v5; // ebx@6

  v1 = *(_QWORD *)(arg1 + 704);
  v2 = *(_DWORD *)(v1 + 4);
  v3 = 0;
  if ( v2 != -1 )
  {
    if ( BYTE1(v2) & 0x10 )
    {
      if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      {
        v3 = 0;
        kernel_debug(0x52D501Cu, arg1, *(_DWORD *)(v1 + 4), 0x1000uLL, 0LL, 0LL);
      }
    }
    else
    {
      do
      {
        do
        {
          v4 = *(_QWORD *)(arg1 + 1704);
          v5 = *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 12LL);
          _mm_mfence();
        }
        while ( (_DWORD)v4 != (unsigned int)*(_QWORD *)(arg1 + 1704) );
      }
      while ( !v5 );
      v3 = v4 + (v5 >> 3);
    }
  }
  return v3;
}
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];

//----- (0000000000010C4E) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::GetFrameNumber(uintptr_t arg1)
{
  __int64 v1; // rcx@1
  int v2; // edx@1
  __int64 v3; // rbx@1
  __int64 v4; // rcx@6
  unsigned int v5; // ebx@6

  v1 = *(_QWORD *)(arg1 + 704);
  v2 = *(_DWORD *)(v1 + 4);
  v3 = 0LL;
  if ( v2 != -1 )
  {
    if ( BYTE1(v2) & 0x10 )
    {
      v3 = 0LL;
      if ( *(_BYTE *)off_160C0[0] & 2 )
      {
        v3 = 0LL;
        if ( *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
        {
          v3 = 0LL;
          kernel_debug(0x52D5020u, arg1, *(_DWORD *)(v1 + 4), 0x1000uLL, 0LL, 0LL);
        }
      }
    }
    else
    {
      do
      {
        do
        {
          v4 = *(_QWORD *)(arg1 + 1704);
          v5 = *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 12LL);
        }
        while ( v4 != *(_QWORD *)(arg1 + 1704) );
      }
      while ( !v5 );
      v3 = v4 + (v5 >> 3);
    }
  }
  return v3;
}
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];

//----- (0000000000010CDA) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::GetMicroFrameNumber(AppleUSBEHCI *this)
{
  __int64 v1; // rcx@1
  __int64 v2; // rdx@1

  do
  {
    do
    {
      v1 = *((_QWORD *)this + 213);
      v2 = *(_DWORD *)(*((_QWORD *)this + 88) + 12LL);
    }
    while ( v1 != *((_QWORD *)this + 213) );
  }
  while ( !(_DWORD)v2 );
  return v2 + 8 * v1;
}

//----- (0000000000010D02) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::AllocateQH(uintptr_t arg1, unsigned __int64 a2, const OSMetaClass *a3)
{
  __int64 v3; // r15@1
  __int64 v4; // rax@2
  AppleEHCIedMemoryBlock *v5; // r13@2
  unsigned int v6; // er12@3
  __int64 v7; // rbx@3
  __int64 v8; // r15@3
  unsigned __int64 v9; // rax@3
  __int64 v10; // rax@3
  unsigned int v11; // ebx@4
  __int64 v12; // r15@5
  unsigned __int64 v13; // rax@5
  __int64 v14; // rax@15

  v3 = *(_QWORD *)(arg1 + 752);
  if ( v3 )
  {
LABEL_15:
    v14 = OSMetaClassBase::safeMetaCast(
            *(OSMetaClassBase **)(v3 + 32),
            (const OSMetaClassBase *)AppleEHCIQueueHead::metaClass,
            a3);
    *(_QWORD *)(arg1 + 752) = v14;
    if ( !v14 )
      *(_QWORD *)(arg1 + 792) = 0LL;
    *(_QWORD *)(v3 + 32) = 0LL;
    return v3;
  }
  v4 = AppleEHCIedMemoryBlock::NewMemoryBlock((AppleEHCIedMemoryBlock *)arg1, a2);
  v5 = (AppleEHCIedMemoryBlock *)v4;
  if ( v4 )
  {
    AppleEHCIedMemoryBlock::SetNextBlock((AppleEHCIedMemoryBlock *)v4, *(AppleEHCIedMemoryBlock **)(arg1 + 1752));
    *(_QWORD *)(arg1 + 1752) = v5;
    v6 = AppleEHCIedMemoryBlock::NumEDs(v5);
    v7 = 0LL;
    v8 = AppleEHCIedMemoryBlock::GetLogicalPtr(v5, 0);
    v9 = AppleEHCIedMemoryBlock::GetPhysicalPtr(v5, 0);
    v10 = AppleEHCIQueueHead::WithSharedMemory(v8, v9);
    *(_QWORD *)(arg1 + 792) = v10;
    *(_QWORD *)(arg1 + 752) = v10;
    if ( v6 >= 2 )
    {
      v11 = 1;
      while ( 1 )
      {
        v12 = AppleEHCIedMemoryBlock::GetLogicalPtr(v5, v11);
        v13 = AppleEHCIedMemoryBlock::GetPhysicalPtr(v5, v11);
        v3 = AppleEHCIQueueHead::WithSharedMemory(v12, v13);
        if ( !v3 )
          break;
        *(_QWORD *)(v3 + 32) = *(_QWORD *)(arg1 + 752);
        *(_QWORD *)(arg1 + 752) = v3;
        ++v11;
        if ( v11 >= v6 )
          goto LABEL_15;
      }
      if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D5024u, arg1, 0LL, 0LL, 2uLL, 0LL);
      v3 = *(_QWORD *)(arg1 + 752);
      v7 = 0LL;
      if ( v3 )
        goto LABEL_15;
    }
  }
  else
  {
    v7 = 0LL;
    if ( *(_BYTE *)off_160C0[0] & 2 )
    {
      v7 = 0LL;
      if ( *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      {
        v7 = 0LL;
        kernel_debug(0x52D5024u, arg1, 0LL, 0LL, 1uLL, 0LL);
      }
    }
  }
  return v7;
}
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];
// 165C0: using guessed type _QWORD AppleEHCIQueueHead::metaClass;
// 2DEC8: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000010EAE) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::DeallocateED(AppleUSBEHCI *this, AppleEHCIQueueHead *a2)
{
  __int64 v2; // rax@1

  *((_QWORD *)a2 + 4) = 0LL;
  (*(void (__fastcall **)(AppleEHCIQueueHead *, signed __int64))(*(_QWORD *)a2 + 280LL))(a2, 4275878552LL);
  v2 = *((_QWORD *)this + 99);
  if ( v2 )
  {
    *(_QWORD *)(v2 + 32) = a2;
    *((_QWORD *)this + 99) = a2;
  }
  else
  {
    *((_QWORD *)this + 99) = a2;
    *((_QWORD *)this + 94) = a2;
  }
  return 0LL;
}

//----- (0000000000010F02) ----------------------------------------------------
AppleEHCItdMemoryBlock *__fastcall AppleUSBEHCI::AllocateTD(AppleUSBEHCI *this, unsigned __int64 a2)
{
  AppleEHCItdMemoryBlock *v2; // rax@1
  __int64 v3; // rax@2
  AppleEHCItdMemoryBlock *v4; // r15@2
  unsigned int v5; // er12@3
  AppleEHCItdMemoryBlock *v6; // rbx@3
  __int64 v7; // rcx@9

  v2 = (AppleEHCItdMemoryBlock *)*((_QWORD *)this + 90);
  if ( v2 )
    goto LABEL_9;
  v3 = AppleEHCItdMemoryBlock::NewMemoryBlock(this, a2);
  v4 = (AppleEHCItdMemoryBlock *)v3;
  if ( !v3 )
  {
    v6 = 0LL;
    KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBEHCI::AllocateTD - unable to allocate a new memory block!");
    return v6;
  }
  AppleEHCItdMemoryBlock::SetNextBlock((AppleEHCItdMemoryBlock *)v3, *((AppleEHCItdMemoryBlock **)this + 220));
  *((_QWORD *)this + 220) = v4;
  v5 = AppleEHCItdMemoryBlock::NumTDs(v4);
  v6 = 0LL;
  *((_QWORD *)this + 95) = AppleEHCItdMemoryBlock::GetTD(v4, 0);
  if ( v5 )
  {
    while ( 1 )
    {
      v2 = AppleEHCItdMemoryBlock::GetTD(v4, (unsigned int)v6);
      if ( !v2 )
        break;
      *((_QWORD *)v2 + 4) = *((_QWORD *)this + 90);
      *((_QWORD *)this + 90) = v2;
      LODWORD(v6) = (_DWORD)v6 + 1;
      if ( (unsigned int)v6 >= v5 )
        goto LABEL_9;
    }
    v6 = 0LL;
    KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBEHCI::AllocateTD - hmm. ran out of TDs in a memory block");
    v2 = (AppleEHCItdMemoryBlock *)*((_QWORD *)this + 90);
    if ( v2 )
    {
LABEL_9:
      v7 = *((_QWORD *)v2 + 4);
      *((_QWORD *)this + 90) = v7;
      if ( !v7 )
        *((_QWORD *)this + 95) = 0LL;
      *((_QWORD *)v2 + 4) = 0LL;
      *((_QWORD *)v2 + 6) = 0LL;
      *((_DWORD *)v2 + 14) = 0;
      *((_QWORD *)v2 + 1) = 0LL;
      *((_BYTE *)v2 + 25) = 0;
      *((_BYTE *)v2 + 26) = 0;
      *((_BYTE *)v2 + 27) = 0;
      *((_DWORD *)v2 + 15) = 0;
      v6 = v2;
    }
  }
  return v6;
}
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (0000000000011032) ----------------------------------------------------
AppleEHCIIsochTransferDescriptor *__fastcall AppleUSBEHCI::AllocateITD(AppleUSBEHCI *this, unsigned __int64 a2, const OSMetaClass *a3)
{
  __int64 v3; // r12@1
  __int64 v4; // rax@2
  AppleEHCIitdMemoryBlock *v5; // r13@2
  AppleEHCIIsochTransferDescriptor *v6; // r15@3
  __int64 v7; // r12@3
  unsigned __int64 v8; // rax@3
  __int64 v9; // rax@3
  unsigned int v10; // ebx@4
  __int64 v11; // r15@5
  unsigned __int64 v12; // rax@5
  __int64 v13; // rax@10
  __int64 v14; // rax@13
  unsigned int v16; // [sp+0h] [bp-2Ch]@3

  v3 = *((_QWORD *)this + 91);
  if ( v3 )
  {
LABEL_10:
    v13 = OSMetaClassBase::safeMetaCast(
            *(OSMetaClassBase **)(v3 + 32),
            (const OSMetaClassBase *)AppleEHCIIsochTransferDescriptor::metaClass,
            a3);
    *((_QWORD *)this + 91) = v13;
    *(_QWORD *)(v3 + 32) = 0LL;
    if ( !v13 )
      *((_QWORD *)this + 96) = 0LL;
    v6 = (AppleEHCIIsochTransferDescriptor *)v3;
LABEL_13:
    v14 = AppleEHCIIsochTransferDescriptor::GetSharedLogical(v6);
    bzero((void *)(v14 + 4), 0x5CuLL);
    return v6;
  }
  v4 = AppleEHCIitdMemoryBlock::NewMemoryBlock(this, a2);
  v5 = (AppleEHCIitdMemoryBlock *)v4;
  if ( v4 )
  {
    AppleEHCIitdMemoryBlock::SetNextBlock((AppleEHCIitdMemoryBlock *)v4, *((AppleEHCIitdMemoryBlock **)this + 221));
    *((_QWORD *)this + 221) = v5;
    v16 = AppleEHCIitdMemoryBlock::NumTDs(v5);
    v6 = 0LL;
    v7 = AppleEHCIitdMemoryBlock::GetLogicalPtr(v5, 0);
    v8 = AppleEHCIitdMemoryBlock::GetPhysicalPtr(v5, 0);
    v9 = AppleEHCIIsochTransferDescriptor::WithSharedMemory(v7, v8);
    *((_QWORD *)this + 96) = v9;
    *((_QWORD *)this + 91) = v9;
    if ( v16 < 2 )
      goto LABEL_13;
    v10 = 1;
    while ( 1 )
    {
      v11 = AppleEHCIitdMemoryBlock::GetLogicalPtr(v5, v10);
      v12 = AppleEHCIitdMemoryBlock::GetPhysicalPtr(v5, v10);
      v3 = AppleEHCIIsochTransferDescriptor::WithSharedMemory(v11, v12);
      if ( !v3 )
        break;
      *(_QWORD *)(v3 + 32) = *((_QWORD *)this + 91);
      *((_QWORD *)this + 91) = v3;
      ++v10;
      if ( v10 >= v16 )
        goto LABEL_10;
    }
    v6 = 0LL;
    KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBEHCI::AllocateTD - hmm. ran out of TDs in a memory block");
    v3 = *((_QWORD *)this + 91);
    if ( !v3 )
      goto LABEL_13;
    goto LABEL_10;
  }
  v6 = 0LL;
  KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBEHCI::AllocateITD - unable to allocate a new memory block!");
  return v6;
}
// 16818: using guessed type _QWORD AppleEHCIIsochTransferDescriptor::metaClass;
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);
// 2DEC8: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (00000000000111B2) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::DeallocateITD(AppleUSBEHCI *this, AppleEHCIIsochTransferDescriptor *a2)
{
  __int64 v2; // rax@1

  *((_QWORD *)a2 + 4) = 0LL;
  v2 = *((_QWORD *)this + 96);
  if ( v2 )
  {
    *(_QWORD *)(v2 + 32) = a2;
    *((_QWORD *)this + 96) = a2;
  }
  else
  {
    *((_QWORD *)this + 96) = a2;
    *((_QWORD *)this + 91) = a2;
  }
  return 0LL;
}

//----- (00000000000111EA) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::AllocateSITD(AppleUSBEHCI *this, unsigned __int64 a2, const OSMetaClass *a3)
{
  __int64 v3; // r15@1
  __int64 v4; // rax@2
  AppleEHCIsitdMemoryBlock *v5; // r13@2
  unsigned int v6; // er12@3
  __int64 v7; // rbx@3
  __int64 v8; // r15@3
  unsigned __int64 v9; // rax@3
  __int64 v10; // rax@3
  unsigned int v11; // ebx@4
  __int64 v12; // r15@5
  unsigned __int64 v13; // rax@5
  __int64 v14; // rax@10

  v3 = *((_QWORD *)this + 92);
  if ( v3 )
    goto LABEL_10;
  v4 = AppleEHCIsitdMemoryBlock::NewMemoryBlock(this, a2);
  v5 = (AppleEHCIsitdMemoryBlock *)v4;
  if ( !v4 )
  {
    v7 = 0LL;
    KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBEHCI::AllocateTD - unable to allocate a new memory block!");
    return v7;
  }
  AppleEHCIsitdMemoryBlock::SetNextBlock((AppleEHCIsitdMemoryBlock *)v4, *((AppleEHCIsitdMemoryBlock **)this + 222));
  *((_QWORD *)this + 222) = v5;
  v6 = AppleEHCIsitdMemoryBlock::NumTDs(v5);
  v7 = 0LL;
  v8 = AppleEHCIsitdMemoryBlock::GetLogicalPtr(v5, 0);
  v9 = AppleEHCIsitdMemoryBlock::GetPhysicalPtr(v5, 0);
  v10 = AppleEHCISplitIsochTransferDescriptor::WithSharedMemory(v8, v9);
  *((_QWORD *)this + 97) = v10;
  *((_QWORD *)this + 92) = v10;
  if ( v6 >= 2 )
  {
    v11 = 1;
    while ( 1 )
    {
      v12 = AppleEHCIsitdMemoryBlock::GetLogicalPtr(v5, v11);
      v13 = AppleEHCIsitdMemoryBlock::GetPhysicalPtr(v5, v11);
      v3 = AppleEHCISplitIsochTransferDescriptor::WithSharedMemory(v12, v13);
      if ( !v3 )
        break;
      *(_QWORD *)(v3 + 32) = *((_QWORD *)this + 92);
      *((_QWORD *)this + 92) = v3;
      ++v11;
      if ( v11 >= v6 )
        goto LABEL_10;
    }
    v7 = 0LL;
    KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBEHCI::AllocateTD - hmm. ran out of TDs in a memory block");
    v3 = *((_QWORD *)this + 92);
    if ( v3 )
    {
LABEL_10:
      v14 = OSMetaClassBase::safeMetaCast(
              *(OSMetaClassBase **)(v3 + 32),
              (const OSMetaClassBase *)AppleEHCISplitIsochTransferDescriptor::metaClass,
              a3);
      *((_QWORD *)this + 92) = v14;
      if ( !v14 )
        *((_QWORD *)this + 97) = 0LL;
      *(_QWORD *)(v3 + 32) = 0LL;
      *(_BYTE *)(v3 + 112) = 0;
      v7 = v3;
    }
  }
  return v7;
}
// 16A78: using guessed type _QWORD AppleEHCISplitIsochTransferDescriptor::metaClass;
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);
// 2DEC8: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000011352) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::DeallocateSITD(AppleUSBEHCI *this, AppleEHCISplitIsochTransferDescriptor *a2)
{
  __int64 v2; // rbx@1
  __int64 v3; // rax@1
  __int64 v4; // rax@2
  __int64 v5; // rax@4
  __int64 v6; // rbx@8
  unsigned __int64 v7; // r14@9
  unsigned __int64 v8; // rax@9
  __int64 v9; // rax@10
  __int64 v10; // rcx@10

  *((_QWORD *)a2 + 4) = 0LL;
  v2 = *((_QWORD *)a2 + 11);
  LODWORD(v3) = (*(int (__cdecl **)(AppleUSBEHCI *))(*(_QWORD *)this + 2456LL))(this);
  if ( v2 == v3 )
  {
    v4 = *((_QWORD *)this + 98);
    if ( v4 )
    {
      *(_QWORD *)(v4 + 32) = a2;
      *((_QWORD *)this + 98) = a2;
    }
    else
    {
      *((_QWORD *)this + 98) = a2;
      *((_QWORD *)this + 93) = a2;
    }
  }
  else
  {
    v5 = *((_QWORD *)this + 97);
    if ( v5 )
    {
      *(_QWORD *)(v5 + 32) = a2;
      *((_QWORD *)this + 97) = a2;
    }
    else
    {
      *((_QWORD *)this + 97) = a2;
      *((_QWORD *)this + 92) = a2;
    }
  }
  v6 = *((_QWORD *)this + 93);
  if ( v6 )
  {
    while ( 1 )
    {
      v7 = *(_QWORD *)(v6 + 88);
      LODWORD(v8) = (*(int (__fastcall **)(AppleUSBEHCI *))(*(_QWORD *)this + 2456LL))(this);
      if ( v7 >= v8 )
        break;
      v9 = *(_QWORD *)(v6 + 32);
      *(_QWORD *)(v6 + 32) = 0LL;
      v10 = *((_QWORD *)this + 97);
      if ( v10 )
      {
        *(_QWORD *)(v10 + 32) = v6;
        *((_QWORD *)this + 97) = v6;
      }
      else
      {
        *((_QWORD *)this + 97) = v6;
        *((_QWORD *)this + 92) = v6;
      }
      *((_QWORD *)this + 93) = v9;
      v6 = v9;
      if ( !v9 )
      {
        *((_QWORD *)this + 98) = 0LL;
        return 0LL;
      }
    }
  }
  return 0LL;
}

//----- (0000000000011448) ----------------------------------------------------
int AppleUSBEHCI::doCallback()
{
  return KernelDebugLogInternal(1LL, 1431519814LL, "AppleUSBEHCI::doCallback unimemented *************");
}
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (0000000000011466) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::EnableAsyncSchedule(uintptr_t arg1, char a2)
{
  __int64 v2; // rax@1
  signed int v3; // er14@2
  __int64 v4; // rcx@3
  bool v5; // zf@3
  int v6; // ecx@3
  __int64 v7; // rax@4
  int v8; // ecx@5
  signed int v9; // ebx@9
  int v10; // eax@10

  v2 = *(_QWORD *)(arg1 + 704);
  if ( *(_DWORD *)(v2 + 24) )
  {
    v3 = 0;
    if ( !(*(_DWORD *)v2 & 0x20) )
    {
      v4 = *(_QWORD *)(*(_QWORD *)(arg1 + 672) + 208LL);
      v5 = (BYTE1(v4) & 1) == 0;
      v6 = *(_DWORD *)v2;
      if ( v5 )
      {
        *(_DWORD *)v2 = v6 | 0x20;
      }
      else
      {
        *(_DWORD *)v2 = v6 & 0xFFFFFFFE;
        v7 = *(_QWORD *)(arg1 + 704);
        do
          v8 = *(_DWORD *)(v7 + 4);
        while ( !(BYTE1(v8) & 0x10) );
        *(_DWORD *)v7 |= 0x21u;
      }
      if ( a2 )
      {
        _mm_mfence();
        v3 = 0;
        v9 = 0;
        while ( 1 )
        {
          v10 = *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 4LL);
          if ( BYTE1(v10) & 0x80 )
            break;
          IOSleep(1LL);
          ++v9;
          if ( v9 >= 100 )
          {
            KernelDebugLogInternal(
              1LL,
              1431519814LL,
              "AppleUSBEHCI::EnableAsyncSchedule: ERROR: USBCMD and USBSTS won't synchronize ON - cannot enable USB list processing");
            if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
              kernel_debug(0x52D5028u, arg1, 0xFFFFFFFFE00002C9LL, 0LL, 0LL, 0LL);
            goto LABEL_15;
          }
        }
      }
    }
  }
  else
  {
LABEL_15:
    v3 = -536870199;
  }
  return (unsigned int)v3;
}
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];
// 2DB30: using guessed type int __fastcall IOSleep(_QWORD);
// 2DB38: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD);

//----- (0000000000011556) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::DisableAsyncSchedule(uintptr_t arg1, char a2)
{
  signed int v2; // er14@1
  __int64 v3; // rax@3
  signed int v4; // ebx@5
  int v5; // eax@6
  __int64 v6; // r15@10

  v2 = 0;
  if ( !(unsigned __int8)IOService::isInactive((IOService *)arg1) )
  {
    if ( *(_BYTE *)(arg1 + 444) )
    {
      v3 = *(_QWORD *)(arg1 + 704);
      if ( *(_DWORD *)v3 & 0x20 )
      {
        *(_DWORD *)v3 &= 0xFFFFFFDF;
        if ( a2 )
        {
          _mm_mfence();
          v4 = 0;
          while ( 1 )
          {
            v5 = *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 4LL);
            if ( !(BYTE1(v5) & 0x80) )
              break;
            IOSleep(1LL);
            ++v4;
            if ( v4 >= 100 )
              goto LABEL_10;
          }
          v2 = 0;
          if ( v4 < 100 )
            return (unsigned int)v2;
LABEL_10:
          v6 = off_160C0[0];
          if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
            kernel_debug(
              0x52D502Cu,
              arg1,
              **(_DWORD **)(arg1 + 704),
              *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 4LL),
              0xFFFFFFFFE00002C9LL,
              0LL);
          v2 = -536870199;
          if ( *(_BYTE *)v6 & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
            kernel_debug(0x52D502Cu, arg1, 0xFFFFFFFFE00002C9LL, 0LL, 0LL, 0LL);
        }
      }
    }
  }
  return (unsigned int)v2;
}
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];
// 2DB30: using guessed type int __fastcall IOSleep(_QWORD);

//----- (0000000000011658) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::EnablePeriodicSchedule(AppleUSBEHCI *this, IOPCIDevice *a2)
{
  signed int v2; // er14@1
  __int64 v3; // rax@2
  signed int v4; // ebx@4
  int v5; // eax@5
  __int64 v6; // r15@7

  v2 = 0;
  if ( !*((_BYTE *)this + 1696) )
  {
    v3 = *((_QWORD *)this + 88);
    if ( !(*(_DWORD *)v3 & 0x10) )
    {
      *(_DWORD *)v3 |= 0x10u;
      if ( (_BYTE)a2 )
      {
        _mm_mfence();
        v4 = 0;
        while ( 1 )
        {
          v5 = *(_DWORD *)(*((_QWORD *)this + 88) + 4LL);
          if ( BYTE1(v5) & 0x40 )
            break;
          IOSleep(1LL);
          ++v4;
          if ( v4 >= 100 )
          {
            v6 = off_160C0[0];
            if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
              kernel_debug(
                0x52D5030u,
                (uintptr_t)this,
                **((_DWORD **)this + 88),
                *(_DWORD *)(*((_QWORD *)this + 88) + 4LL),
                0xFFFFFFFFE00002C9LL,
                0LL);
            v2 = -536870199;
            if ( *(_BYTE *)v6 & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
              kernel_debug(0x52D5030u, (uintptr_t)this, 0xFFFFFFFFE00002C9LL, 0LL, 0LL, 0LL);
            return (unsigned int)v2;
          }
        }
      }
    }
    if ( *(_BYTE *)(*((_QWORD *)this + 84) + 209LL) & 0x10 && !*(_DWORD *)(*((_QWORD *)this + 21) + 188LL) )
      AppleUSBEHCI::EnablePrefetchRegister(*((AppleUSBEHCI **)this + 61), a2);
  }
  return (unsigned int)v2;
}
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];
// 2DB30: using guessed type int __fastcall IOSleep(_QWORD);

//----- (0000000000011776) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::DisablePeriodicSchedule(uintptr_t arg1, char a2)
{
  char v2; // r15@1
  __int64 v3; // rsi@1
  signed int v4; // er14@1
  signed int v5; // ebx@5
  int v6; // eax@6
  __int64 v7; // r15@10

  v2 = a2;
  v3 = *(_QWORD *)(arg1 + 704);
  v4 = 0;
  if ( *(_DWORD *)v3 & 0x10 )
  {
    if ( *(_BYTE *)(*(_QWORD *)(arg1 + 672) + 209LL) & 0x10 )
      AppleUSBEHCI::DisablePrefetchRegister(*(IOPCIDevice **)(arg1 + 488), v3);
    **(_DWORD **)(arg1 + 704) &= 0xFFFFFFEF;
    if ( v2 )
    {
      _mm_mfence();
      v5 = 0;
      while ( 1 )
      {
        v6 = *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 4LL);
        if ( !(BYTE1(v6) & 0x40) )
          break;
        IOSleep(1LL);
        ++v5;
        if ( v5 >= 100 )
          goto LABEL_10;
      }
      v4 = 0;
      if ( v5 < 100 )
        return (unsigned int)v4;
LABEL_10:
      v7 = off_160C0[0];
      if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
        kernel_debug(
          0x52D5034u,
          arg1,
          **(_DWORD **)(arg1 + 704),
          *(_DWORD *)(*(_QWORD *)(arg1 + 704) + 4LL),
          0xFFFFFFFFE00002C9LL,
          0LL);
      v4 = -536870199;
      if ( *(_BYTE *)v7 & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D5034u, arg1, 0xFFFFFFFFE00002C9LL, 0LL, 0LL, 0LL);
    }
  }
  return (unsigned int)v4;
}
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];
// 2DB30: using guessed type int __fastcall IOSleep(_QWORD);

//----- (0000000000011882) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::DisablePrefetchRegister(IOPCIDevice *this, __int64 a2)
{
  __int64 result; // rax@1
  int v3; // ecx@2

  result = IOPCIDevice::extendedConfigRead8(this, 0x84uLL);
  if ( !(result & 0x10) )
  {
    v3 = *(_DWORD *)(a2 + 4);
    if ( !(BYTE1(v3) & 0x10) )
    {
      while ( *(_DWORD *)(a2 + 12) & 4 )
        ;
    }
    result = IOPCIDevice::extendedConfigWrite8(this, 0x84uLL, (unsigned __int8)result | 0x10u);
  }
  return result;
}

//----- (00000000000118C8) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::GetPeriodicListLogicalEntry(AppleUSBEHCI *this, int a2)
{
  return *(_QWORD *)(*((_QWORD *)this + 102) + 8LL * a2);
}

//----- (00000000000118DC) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::GetPeriodicListPhysicalEntry(AppleUSBEHCI *this, int a2)
{
  return *(_DWORD *)(*((_QWORD *)this + 101) + 4LL * a2);
}

//----- (00000000000118F0) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::message(AppleUSBEHCI *this, const char *a2, IOService *a3, void *a4)
{
  char *v4; // r15@1
  IOService *v5; // r12@1
  int v6; // er13@1
  __int64 v7; // r12@6
  __int64 v8; // rax@18
  OSMetaClassBase *v9; // rax@18
  AppleUSBEHCI *v10; // rsi@18
  const OSMetaClass *v11; // rdx@18
  char *v12; // rbx@18
  __int64 v13; // r13@18
  char *v14; // rax@21

  v4 = (char *)a4;
  v5 = a3;
  v6 = (*(int (__cdecl **)(AppleUSBEHCI *))(off_16068[0] + 1856))(this);
  if ( (_DWORD)a2 == -536854512 )
  {
    v8 = IORegistryEntry::getPlane("IOUSB", a2);
    LODWORD(v9) = (*(int (__fastcall **)(char *, __int64))(*(_QWORD *)v4 + 792LL))(v4, v8);
    v10 = *(AppleUSBEHCI **)off_16020[0];
    v12 = (char *)OSMetaClassBase::safeMetaCast(v9, *(const OSMetaClassBase **)off_16020[0], v11);
    (*(void (__fastcall **)(char *, AppleUSBEHCI *))(*(_QWORD *)v4 + 32LL))(v4, v10);
    v13 = off_160C0[0];
    if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    {
      v10 = this;
      kernel_debug(0x52D5038u, (uintptr_t)this, (uintptr_t)v5, (uintptr_t)v4, 0xE0004010uLL, 0LL);
    }
    v14 = (char *)*((_QWORD *)this + 19);
    if ( v12 == v14 || v4 == v14 && !v12 )
    {
      if ( *(_BYTE *)v13 & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
      {
        v10 = this;
        kernel_debug(0x52D5038u, (uintptr_t)this, 0LL, 0LL, 0LL, 0LL);
      }
      *((_BYTE *)this + 2097) = 1;
    }
    (*(void (__fastcall **)(char *, AppleUSBEHCI *))(*(_QWORD *)v4 + 40LL))(v4, v10);
    goto LABEL_29;
  }
  if ( (_DWORD)a2 == -536854507 )
  {
    if ( v5 && OSMetaClassBase::metaCast(v5, "IOUSBControllerUserClient") )
    {
      if ( (unsigned __int16)v4 == 3 )
      {
        v7 = off_160C0[0];
        if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
          kernel_debug(
            0x52D50C0u,
            (uintptr_t)this,
            *((_QWORD *)this + 217),
            *(_DWORD *)(*((_QWORD *)this + 88) + 24LL),
            1uLL,
            0LL);
        AppleUSBEHCI::printAsyncQueue(
          (uintptr_t)this,
          5,
          "message",
          ((unsigned int)v4 & 0x10000) != 0LL,
          ((unsigned int)v4 & 0x20000) != 0LL);
        IOSleep(10LL);
        if ( *(_BYTE *)v7 & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
          kernel_debug(0x52D50C0u, (uintptr_t)this, *((_QWORD *)this + 218), 0LL, 2uLL, 0LL);
        AppleUSBEHCI::printInactiveQueue(this, 5u, "message");
        IOSleep(10LL);
        if ( *(_BYTE *)v7 & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
          kernel_debug(0x52D50C0u, (uintptr_t)this, 0LL, 0LL, 3uLL, 0LL);
        AppleUSBEHCI::printPeriodicList(this, 5LL, "message");
        v6 = 0;
      }
      if ( v4 == (_BYTE *)&dword_0 + 2 )
      {
        IOUSBController::DumpUSBACPI(this, *((IORegistryEntry **)this + 61));
LABEL_29:
        v6 = 0;
        return (unsigned int)v6;
      }
    }
  }
  else if ( (_DWORD)a2 == -536854501 )
  {
    AppleUSBEHCI::EHCIMuxedPortDeviceDisconnected(this, v4);
  }
  return (unsigned int)v6;
}
// 0: using guessed type int dword_0;
// 16020: using guessed type _QWORD off_16020[23];
// 16068: using guessed type __int64 off_16068[14];
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];
// 2DB30: using guessed type int __fastcall IOSleep(_QWORD);
// 2DEC8: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000011BB4) ----------------------------------------------------
IOUSBControllerIsochEndpoint *__fastcall AppleUSBEHCI::AllocateIsochEP(AppleUSBEHCI *this, unsigned __int64 a2)
{
  IOUSBControllerIsochEndpoint *v2; // rbx@1

  v2 = (IOUSBControllerIsochEndpoint *)OSObject::operator new((OSObject *)&stru_68.flags, a2);
  AppleEHCIIsochEndpoint::AppleEHCIIsochEndpoint(v2);
  if ( v2 && !(unsigned __int8)(*(int (__fastcall **)(IOUSBControllerIsochEndpoint *))(*(_QWORD *)v2 + 136LL))(v2) )
  {
    (*(void (__fastcall **)(IOUSBControllerIsochEndpoint *))(*(_QWORD *)v2 + 40LL))(v2);
    v2 = 0LL;
  }
  return v2;
}
// 68: using guessed type section_64 stru_68;

//----- (0000000000011BFA) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::ReturnIsochDoneQueue(AppleUSBEHCI *this, IOUSBControllerIsochEndpoint *a2)
{
  __int64 result; // rax@1

  (*(void (__fastcall **)(AppleUSBEHCI *, IOUSBControllerIsochEndpoint *))(off_16068[0] + 2856))(this, a2);
  result = *((_QWORD *)this + 21);
  if ( !*(_DWORD *)(result + 188) )
  {
    *((_WORD *)this + 906) = 1025;
    result = *((_QWORD *)this + 84);
    if ( *(_BYTE *)(result + 209) & 0x10 )
      result = AppleUSBEHCI::EnablePrefetchRegister(*((AppleUSBEHCI **)this + 61), a2);
  }
  return result;
}
// 16068: using guessed type __int64 off_16068[14];

//----- (0000000000011C52) ----------------------------------------------------
int __fastcall AppleUSBEHCI::GetNewDMACommand(AppleUSBEHCI *this)
{
  char v1; // al@1

  v1 = 64;
  if ( !*((_BYTE *)this + 1695) )
    v1 = 32;
  return IODMACommand::withSpecification(off_16010[0], (unsigned __int8)v1, 0LL, 0LL, 0LL, 1LL);
}
// 16010: using guessed type __int64 off_16010[25];
// 2DBE8: using guessed type int __fastcall IODMACommand::withSpecification(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000011C9A) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::GetLowLatencyOptionsAndPhysicalMask(uintptr_t arg1, unsigned int *a2, unsigned __int64 *a3)
{
  unsigned __int64 *v3; // r15@1
  __int64 v4; // r12@1

  v3 = a3;
  v4 = off_160C0[0];
  if ( *(_BYTE *)off_160C0[0] & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D50C9u, arg1, 0LL, 0LL, 0LL, 0LL);
  (*(void (__fastcall **)(uintptr_t, unsigned int *, unsigned __int64 *))(off_16068[0] + 2872))(arg1, a2, v3);
  if ( *(_BYTE *)v4 & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D50C8u, arg1, *a2, *v3, 0LL, 0LL);
  if ( *(_BYTE *)(arg1 + 1695) )
    *v3 = -4096LL;
  if ( *(_BYTE *)v4 & 2 && *(_DWORD *)off_160C8[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D50CAu, arg1, *a2, *v3, 0LL, 0LL);
  return 0LL;
}
// 16068: using guessed type __int64 off_16068[14];
// 160C0: using guessed type __int64 off_160C0[3];
// 160C8: using guessed type __int64 off_160C8[2];

//----- (0000000000011D72) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCI::MetaClass::~MetaClass(AppleUSBEHCI::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000011D80) ----------------------------------------------------
__int64 `global constructor keyed to'_a_5()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(&AppleUSBEHCI::gMetaClass, "AppleUSBEHCI", off_16018[0], 40032LL);
  result = (__int64)off_18130;
  AppleUSBEHCI::gMetaClass = off_18130;
  return result;
}
// 16018: using guessed type _QWORD off_16018[24];
// 18130: using guessed type __int64 (__fastcall *off_18130[2])(AppleUSBEHCI::MetaClass *__hidden this);
// 18AA0: using guessed type _QWORD AppleUSBEHCI::gMetaClass;
// 2DBC8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000011DC0) ----------------------------------------------------
__int64 `global destructor keyed to'_a_5()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&AppleUSBEHCI::gMetaClass);
}
// 18AA0: using guessed type _QWORD AppleUSBEHCI::gMetaClass;

//----- (0000000000011DE0) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCIHubInfo::MetaClass::MetaClass(AppleUSBEHCIHubInfo::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "AppleUSBEHCIHubInfo", off_16060[0], 40LL);
  result = (__int64)off_18360;
  *(_QWORD *)this = off_18360;
  return result;
}
// 16060: using guessed type _QWORD off_16060[15];
// 18360: using guessed type __int64 (__fastcall *off_18360[2])(AppleUSBEHCIHubInfo::MetaClass *__hidden this);
// 2DBC8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000011E12) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCIHubInfo::MetaClass::~MetaClass(AppleUSBEHCIHubInfo::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000011E1C) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCIHubInfo::AppleUSBEHCIHubInfo(__int64 a1)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1);
  result = (__int64)off_18230;
  *(_QWORD *)a1 = off_18230;
  return result;
}
// 18230: using guessed type __int64 (__fastcall *off_18230[2])(AppleUSBEHCIHubInfo *__hidden this);
// 2E330: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000011E3C) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCIHubInfo::AppleUSBEHCIHubInfo(__int64 a1)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1);
  result = (__int64)off_18230;
  *(_QWORD *)a1 = off_18230;
  return result;
}
// 18230: using guessed type __int64 (__fastcall *off_18230[2])(AppleUSBEHCIHubInfo *__hidden this);
// 2E330: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000011E5C) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCIHubInfo::~AppleUSBEHCIHubInfo(AppleUSBEHCIHubInfo *this)
{
  return OSObject::~OSObject(this);
}

//----- (0000000000011E66) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCIHubInfo::~AppleUSBEHCIHubInfo(AppleUSBEHCIHubInfo *this)
{
  return OSObject::~OSObject(this);
}

//----- (0000000000011E70) ----------------------------------------------------
void __fastcall AppleUSBEHCIHubInfo::~AppleUSBEHCIHubInfo(AppleUSBEHCIHubInfo *this)
{
  OSObject::~OSObject(this);
  OSObject::operator delete((void *)this);
}

//----- (0000000000011E92) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCIHubInfo::getMetaClass(AppleUSBEHCIHubInfo *this)
{
  return (__int64)&AppleUSBEHCIHubInfo::gMetaClass;
}
// 18AC8: using guessed type _QWORD AppleUSBEHCIHubInfo::gMetaClass;

//----- (0000000000011EA0) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCIHubInfo::MetaClass::MetaClass(AppleUSBEHCIHubInfo::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "AppleUSBEHCIHubInfo", off_16060[0], 40LL);
  result = (__int64)off_18360;
  *(_QWORD *)this = off_18360;
  return result;
}
// 16060: using guessed type _QWORD off_16060[15];
// 18360: using guessed type __int64 (__fastcall *off_18360[2])(AppleUSBEHCIHubInfo::MetaClass *__hidden this);
// 2DBC8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000011ED2) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCIHubInfo::MetaClass::alloc(AppleUSBEHCIHubInfo::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)stru_20.segname, a2);
  OSObject::OSObject(v2);
  *(_QWORD *)v2 = off_18230;
  OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUSBEHCIHubInfo::gMetaClass);
  return v2;
}
// 20: using guessed type segment_command_64 stru_20;
// 18230: using guessed type __int64 (__fastcall *off_18230[2])(AppleUSBEHCIHubInfo *__hidden this);
// 18AC8: using guessed type _QWORD AppleUSBEHCIHubInfo::gMetaClass;
// 2E330: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000011F12) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCIHubInfo::AppleUSBEHCIHubInfo(__int64 a1)
{
  OSObject::OSObject(a1);
  *(_QWORD *)a1 = off_18230;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUSBEHCIHubInfo::gMetaClass);
}
// 18230: using guessed type __int64 (__fastcall *off_18230[2])(AppleUSBEHCIHubInfo *__hidden this);
// 18AC8: using guessed type _QWORD AppleUSBEHCIHubInfo::gMetaClass;
// 2E330: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000011F42) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCIHubInfo::AppleUSBEHCIHubInfo(__int64 a1)
{
  OSObject::OSObject(a1);
  *(_QWORD *)a1 = off_18230;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUSBEHCIHubInfo::gMetaClass);
}
// 18230: using guessed type __int64 (__fastcall *off_18230[2])(AppleUSBEHCIHubInfo *__hidden this);
// 18AC8: using guessed type _QWORD AppleUSBEHCIHubInfo::gMetaClass;
// 2E330: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000011F72) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCIHubInfo::AddHubInfo(AppleUSBEHCIHubInfo *this, AppleUSBEHCIHubInfo **a2, char a3)
{
  char v3; // r12@1
  __int64 v4; // r14@1
  __int64 v5; // rbx@1

  v3 = a3;
  v4 = *(_QWORD *)this;
  v5 = OSObject::operator new((OSObject *)stru_20.segname, (unsigned __int64)a2);
  OSObject::OSObject(v5);
  *(_QWORD *)v5 = off_18230;
  OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUSBEHCIHubInfo::gMetaClass);
  if ( v5 )
  {
    *(_BYTE *)(v5 + 32) = v3 & 1;
    *(_BYTE *)(v5 + 33) = (_BYTE)a2;
    *(_QWORD *)(v5 + 16) = v4;
    *(_QWORD *)(v5 + 24) = 0LL;
    *(_QWORD *)this = v5;
  }
  return v5;
}
// 20: using guessed type segment_command_64 stru_20;
// 18230: using guessed type __int64 (__fastcall *off_18230[2])(AppleUSBEHCIHubInfo *__hidden this);
// 18AC8: using guessed type _QWORD AppleUSBEHCIHubInfo::gMetaClass;
// 2E330: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000011FF2) ----------------------------------------------------
AppleUSBEHCIHubInfo *__fastcall AppleUSBEHCIHubInfo::FindHubInfo(AppleUSBEHCIHubInfo *this, AppleUSBEHCIHubInfo *a2)
{
  AppleUSBEHCIHubInfo *result; // rax@1

  result = 0LL;
  if ( this )
  {
    result = 0LL;
    while ( *((_BYTE *)this + 33) != (unsigned __int16)a2 )
    {
      this = (AppleUSBEHCIHubInfo *)*((_QWORD *)this + 2);
      if ( !this )
        return result;
    }
    result = this;
  }
  return result;
}

//----- (000000000001201A) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCIHubInfo::DeleteHubInfo(AppleUSBEHCIHubInfo *this, AppleUSBEHCIHubInfo **a2)
{
  AppleUSBEHCIHubInfo *v2; // r14@1
  __int64 v3; // r15@1
  __int64 result; // rax@1
  __int64 v5; // rdi@3
  __int64 v6; // rbx@4
  __int64 v7; // rbx@5
  __int64 v8; // r13@6
  __int64 v9; // rbx@8
  __int64 v10; // rdi@10
  __int64 v11; // r14@11
  AppleUSBEHCIHubInfo *v12; // [sp+0h] [bp-30h]@6

  v2 = this;
  v3 = *(_QWORD *)this;
  result = 3758097097LL;
  if ( *(_QWORD *)this )
  {
    if ( *(_BYTE *)(v3 + 33) == (unsigned __int16)a2 )
    {
      v5 = *(_QWORD *)(v3 + 24);
      if ( v5 )
      {
        do
        {
          v6 = *(_QWORD *)(v5 + 16);
          (*(void (__cdecl **)(__int64))(*(_QWORD *)v5 + 40LL))(v5);
          v5 = v6;
        }
        while ( v6 );
      }
      v7 = *(_QWORD *)(v3 + 16);
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 40LL))(v3);
      v3 = v7;
    }
    else
    {
      v12 = this;
      v8 = *(_QWORD *)this;
      while ( 1 )
      {
        v9 = *(_QWORD *)(v8 + 16);
        if ( !v9 )
          break;
        if ( *(_BYTE *)(v9 + 33) == (unsigned __int16)a2 )
        {
          *(_QWORD *)(v8 + 16) = *(_QWORD *)(v9 + 16);
          v10 = *(_QWORD *)(v9 + 24);
          if ( v10 )
          {
            do
            {
              v11 = *(_QWORD *)(v10 + 16);
              (*(void (**)(void))(*(_QWORD *)v10 + 40LL))();
              v10 = v11;
            }
            while ( v11 );
          }
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v9 + 40LL))(v9);
        }
        else
        {
          v8 = *(_QWORD *)(v8 + 16);
        }
      }
      v2 = v12;
    }
    *(_QWORD *)v2 = v3;
    result = 0LL;
  }
  return result;
}

//----- (00000000000120DE) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCIHubInfo::GetTTInfo(AppleUSBEHCIHubInfo *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1
  char v3; // al@1
  __int64 v4; // rax@9

  v2 = *((_QWORD *)this + 3);
  v3 = *((_BYTE *)this + 32);
  if ( v3 && v2 )
  {
    while ( *(_BYTE *)(v2 + 800) != (_DWORD)a2 )
    {
      v2 = *(_QWORD *)(v2 + 16);
      if ( !v2 )
        goto LABEL_7;
    }
  }
  if ( !v2 )
  {
LABEL_7:
    v2 = 0LL;
    if ( !v3 )
      a2 = 0LL;
    v4 = AppleUSBEHCITTInfo::NewTTInfo((AppleUSBEHCITTInfo *)(unsigned int)a2, a2);
    if ( v4 )
    {
      *(_QWORD *)(v4 + 16) = *((_QWORD *)this + 3);
      *((_QWORD *)this + 3) = v4;
      v2 = v4;
    }
  }
  return v2;
}

//----- (000000000001213E) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCITTInfo::NewTTInfo(AppleUSBEHCITTInfo *this, unsigned __int64 a2)
{
  __int64 v2; // r12@1
  signed __int64 v3; // rax@2
  __int64 v4; // rbx@2
  __int64 v5; // rax@4
  void *v6; // rcx@4
  __int64 v7; // rax@5
  signed __int64 v8; // rbx@8
  __int64 v9; // rdi@9
  __int64 v10; // rdi@11
  __int64 v11; // rdi@14

  v2 = OSObject::operator new((OSObject *)&qword_4B8[22], a2);
  OSObject::OSObject(v2);
  *(_QWORD *)v2 = off_18460;
  OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUSBEHCITTInfo::gMetaClass);
  if ( v2 )
  {
    *(_QWORD *)(v2 + 16) = 0LL;
    *(_BYTE *)(v2 + 800) = (_BYTE)this;
    *(_WORD *)(v2 + 802) = 1;
    v3 = 67LL;
    v4 = 0LL;
    do
    {
      *(_QWORD *)(v2 + 8 * v3) = 0LL;
      *(_QWORD *)(v2 + 8 * v3++ - 256) = 0LL;
    }
    while ( v3 != 99 );
    while ( 1 )
    {
      v5 = AppleUSBEHCISplitPeriodicEndpoint::NewSplitPeriodicEndpoint(
             (AppleUSBEHCISplitPeriodicEndpoint *)v2,
             (AppleUSBEHCITTInfo *)((char *)&dword_0 + 3),
             0LL,
             (OSObject *)&stru_20.cmdsize,
             32);
      if ( !v5 )
        break;
      *(_BYTE *)(v5 + 56) = v4;
      *(_WORD *)(v5 + 52) = 0;
      *(_QWORD *)(v2 + 8 * v4 + 280) = v5;
      v7 = AppleUSBEHCISplitPeriodicEndpoint::NewSplitPeriodicEndpoint(
             (AppleUSBEHCISplitPeriodicEndpoint *)v2,
             (AppleUSBEHCITTInfo *)((char *)&dword_0 + 1),
             0LL,
             (OSObject *)&stru_20.cmdsize,
             32);
      if ( !v7 )
        break;
      *(_BYTE *)(v7 + 56) = v4;
      *(_WORD *)(v7 + 52) = 0;
      *(_QWORD *)(v2 + 8 * v4 + 536) = v7;
      *(_WORD *)(v2 + 2 * v4++ + 804) = 36;
      if ( (signed int)v4 >= 32 )
      {
        *(_QWORD *)(v2 + 792) = OSOrderedSet::withCapacity(
                                  (OSOrderedSet *)&dword_10,
                                  (unsigned __int64)CompareSPEs,
                                  (int (__cdecl *)(const OSMetaClassBase *, const OSMetaClassBase *, void *))v2,
                                  v6);
        return v2;
      }
    }
    *(_QWORD *)(v2 + 792) = OSOrderedSet::withCapacity(
                              (OSOrderedSet *)&dword_10,
                              (unsigned __int64)CompareSPEs,
                              (int (__cdecl *)(const OSMetaClassBase *, const OSMetaClassBase *, void *))v2,
                              v6);
    v8 = -32LL;
    do
    {
      v9 = *(_QWORD *)(v2 + 8 * v8 + 536);
      if ( v9 )
        (*(void (__fastcall **)(__int64, __int64 (__fastcall *)(const AppleUSBEHCISplitPeriodicEndpoint *, const AppleUSBEHCISplitPeriodicEndpoint *, const AppleUSBEHCITTInfo *)))(*(_QWORD *)v9 + 40LL))(
          v9,
          CompareSPEs);
      v10 = *(_QWORD *)(v2 + 8 * v8 + 792);
      if ( v10 )
        (*(void (__fastcall **)(__int64, __int64 (__fastcall *)(const AppleUSBEHCISplitPeriodicEndpoint *, const AppleUSBEHCISplitPeriodicEndpoint *, const AppleUSBEHCITTInfo *)))(*(_QWORD *)v10 + 40LL))(
          v10,
          CompareSPEs);
      ++v8;
    }
    while ( v8 );
    v11 = *(_QWORD *)(v2 + 792);
    if ( v11 )
      (*(void (__fastcall **)(__int64, __int64 (__fastcall *)(const AppleUSBEHCISplitPeriodicEndpoint *, const AppleUSBEHCISplitPeriodicEndpoint *, const AppleUSBEHCITTInfo *)))(*(_QWORD *)v11 + 40LL))(
        v11,
        CompareSPEs);
    (*(void (__fastcall **)(__int64, __int64 (__fastcall *)(const AppleUSBEHCISplitPeriodicEndpoint *, const AppleUSBEHCISplitPeriodicEndpoint *, const AppleUSBEHCITTInfo *)))(*(_QWORD *)v2 + 40LL))(
      v2,
      CompareSPEs);
    v2 = 0LL;
  }
  return v2;
}
// 0: using guessed type int dword_0;
// 10: using guessed type int;
// 20: using guessed type segment_command_64 stru_20;
// 4B8: using guessed type __int64 qword_4B8[221];
// 18460: using guessed type __int64 (__fastcall *off_18460[2])(AppleUSBEHCITTInfo *__hidden this);
// 18AF0: using guessed type _QWORD AppleUSBEHCITTInfo::gMetaClass;
// 2DC60: using guessed type _QWORD __cdecl OSOrderedSet::withCapacity(OSOrderedSet *__hidden this, unsigned int, int (__cdecl *)(const OSMetaClassBase *, const OSMetaClassBase *, void *), void *);
// 2E330: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (00000000000122D2) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCITTInfo::MetaClass::MetaClass(AppleUSBEHCITTInfo::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "AppleUSBEHCITTInfo", off_16060[0], 1384LL);
  result = (__int64)off_18590;
  *(_QWORD *)this = off_18590;
  return result;
}
// 16060: using guessed type _QWORD off_16060[15];
// 18590: using guessed type __int64 (__fastcall *off_18590[2])(AppleUSBEHCITTInfo::MetaClass *__hidden this);
// 2DBC8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000012304) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCITTInfo::MetaClass::~MetaClass(AppleUSBEHCITTInfo::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000001230E) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCITTInfo::AppleUSBEHCITTInfo(__int64 a1)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1);
  result = (__int64)off_18460;
  *(_QWORD *)a1 = off_18460;
  return result;
}
// 18460: using guessed type __int64 (__fastcall *off_18460[2])(AppleUSBEHCITTInfo *__hidden this);
// 2E330: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (000000000001232E) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCITTInfo::AppleUSBEHCITTInfo(__int64 a1)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1);
  result = (__int64)off_18460;
  *(_QWORD *)a1 = off_18460;
  return result;
}
// 18460: using guessed type __int64 (__fastcall *off_18460[2])(AppleUSBEHCITTInfo *__hidden this);
// 2E330: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (000000000001234E) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCITTInfo::~AppleUSBEHCITTInfo(AppleUSBEHCITTInfo *this)
{
  return OSObject::~OSObject(this);
}

//----- (0000000000012358) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCITTInfo::~AppleUSBEHCITTInfo(AppleUSBEHCITTInfo *this)
{
  return OSObject::~OSObject(this);
}

//----- (0000000000012362) ----------------------------------------------------
void __fastcall AppleUSBEHCITTInfo::~AppleUSBEHCITTInfo(AppleUSBEHCITTInfo *this)
{
  OSObject::~OSObject(this);
  OSObject::operator delete((void *)this);
}

//----- (0000000000012384) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCITTInfo::getMetaClass(AppleUSBEHCITTInfo *this)
{
  return (__int64)&AppleUSBEHCITTInfo::gMetaClass;
}
// 18AF0: using guessed type _QWORD AppleUSBEHCITTInfo::gMetaClass;

//----- (0000000000012392) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCITTInfo::MetaClass::MetaClass(AppleUSBEHCITTInfo::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "AppleUSBEHCITTInfo", off_16060[0], 1384LL);
  result = (__int64)off_18590;
  *(_QWORD *)this = off_18590;
  return result;
}
// 16060: using guessed type _QWORD off_16060[15];
// 18590: using guessed type __int64 (__fastcall *off_18590[2])(AppleUSBEHCITTInfo::MetaClass *__hidden this);
// 2DBC8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000123C4) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCITTInfo::MetaClass::alloc(AppleUSBEHCITTInfo::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&qword_4B8[22], a2);
  OSObject::OSObject(v2);
  *(_QWORD *)v2 = off_18460;
  OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUSBEHCITTInfo::gMetaClass);
  return v2;
}
// 4B8: using guessed type __int64[221];
// 18460: using guessed type __int64 (__fastcall *off_18460[2])(AppleUSBEHCITTInfo *__hidden this);
// 18AF0: using guessed type _QWORD AppleUSBEHCITTInfo::gMetaClass;
// 2E330: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000012404) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCITTInfo::AppleUSBEHCITTInfo(__int64 a1)
{
  OSObject::OSObject(a1);
  *(_QWORD *)a1 = off_18460;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUSBEHCITTInfo::gMetaClass);
}
// 18460: using guessed type __int64 (__fastcall *off_18460[2])(AppleUSBEHCITTInfo *__hidden this);
// 18AF0: using guessed type _QWORD AppleUSBEHCITTInfo::gMetaClass;
// 2E330: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000012434) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCITTInfo::AppleUSBEHCITTInfo(__int64 a1)
{
  OSObject::OSObject(a1);
  *(_QWORD *)a1 = off_18460;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUSBEHCITTInfo::gMetaClass);
}
// 18460: using guessed type __int64 (__fastcall *off_18460[2])(AppleUSBEHCITTInfo *__hidden this);
// 18AF0: using guessed type _QWORD AppleUSBEHCITTInfo::gMetaClass;
// 2E330: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000012464) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCISplitPeriodicEndpoint::NewSplitPeriodicEndpoint(AppleUSBEHCISplitPeriodicEndpoint *this, AppleUSBEHCITTInfo *a2, OSMetaClassBase *a3, OSObject *a4, char a5)
{
  __int16 v5; // r14@1
  __int64 v6; // rbx@1
  const OSMetaClass *v7; // rdx@2
  __int64 v8; // rax@3
  __int64 v9; // rax@7
  OSMetaClassBase *v11; // [sp+8h] [bp-38h]@1
  char v12; // [sp+14h] [bp-2Ch]@1

  v12 = a5;
  v5 = (signed __int16)a4;
  v11 = a3;
  v6 = OSObject::operator new((OSObject *)&stru_20.fileoff, (unsigned __int64)a2);
  OSObject::OSObject(v6);
  *(_QWORD *)v6 = off_18690;
  OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUSBEHCISplitPeriodicEndpoint::gMetaClass);
  if ( v6 )
  {
    (*(void (__fastcall **)(AppleUSBEHCISplitPeriodicEndpoint *, _QWORD *))(*(_QWORD *)this + 32LL))(
      this,
      &AppleUSBEHCISplitPeriodicEndpoint::gMetaClass);
    *(_QWORD *)(v6 + 40) = this;
    *(_WORD *)(v6 + 48) = (_WORD)a2;
    *(_WORD *)(v6 + 50) = v5;
    *(_BYTE *)(v6 + 55) = v12;
    if ( (unsigned __int16)a2 == 1 )
    {
      v8 = OSMetaClassBase::safeMetaCast(v11, (const OSMetaClassBase *)AppleEHCIIsochEndpoint::metaClass, v7);
      *(_QWORD *)(v6 + 32) = v8;
      if ( v8 )
        *(_BYTE *)(v6 + 54) = *(_BYTE *)(v8 + 128);
      *(_QWORD *)(v6 + 24) = 0LL;
    }
    else
    {
      if ( (unsigned __int16)a2 != 3 )
      {
        (*(void (__fastcall **)(AppleUSBEHCISplitPeriodicEndpoint *))(*(_QWORD *)this + 40LL))(this);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v6 + 40LL))(v6);
        return 0LL;
      }
      v9 = OSMetaClassBase::safeMetaCast(v11, (const OSMetaClassBase *)AppleEHCIQueueHead::metaClass, v7);
      *(_QWORD *)(v6 + 24) = v9;
      if ( v9 )
        *(_BYTE *)(v6 + 54) = *(_BYTE *)(v9 + 70);
      *(_QWORD *)(v6 + 32) = 0LL;
    }
    *(_QWORD *)(v6 + 16) = 0LL;
    *(_BYTE *)(v6 + 56) = 0;
    *(_WORD *)(v6 + 52) = 0;
    *(_BYTE *)(v6 + 57) = 0;
    *(_BYTE *)(v6 + 58) = 0;
    *(_BYTE *)(v6 + 59) = 0;
    *(_DWORD *)(v6 + 60) = 0;
    *(_BYTE *)(v6 + 64) = 0;
  }
  return v6;
}
// 20: using guessed type segment_command_64 stru_20;
// 165C0: using guessed type _QWORD AppleEHCIQueueHead::metaClass;
// 16CD8: using guessed type _QWORD AppleEHCIIsochEndpoint::metaClass;
// 18690: using guessed type __int64 (__fastcall *off_18690[2])(AppleUSBEHCISplitPeriodicEndpoint *__hidden this);
// 18B18: using guessed type _QWORD AppleUSBEHCISplitPeriodicEndpoint::gMetaClass;
// 2DEC8: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);
// 2E330: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000012596) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCISplitPeriodicEndpoint::SetStartFrameAndStartTime(AppleUSBEHCISplitPeriodicEndpoint *this, char a2, __int16 a3)
{
  *((_BYTE *)this + 56) = a2;
  *((_WORD *)this + 26) = a3;
  return 0LL;
}

//----- (00000000000125A6) ----------------------------------------------------
__int64 __fastcall CompareSPEs(const AppleUSBEHCISplitPeriodicEndpoint *this, const AppleUSBEHCISplitPeriodicEndpoint *a2, const AppleUSBEHCITTInfo *a3)
{
  __int64 result; // rax@1
  unsigned int *v4; // r15@3
  int v5; // eax@3
  unsigned int v6; // ecx@8
  unsigned int v7; // edx@8

  result = 0LL;
  if ( this && a2 )
  {
    v4 = (unsigned int *)off_16098[0];
    AppleUSBEHCISplitPeriodicEndpoint::print(this, *(_DWORD *)off_16098[0]);
    AppleUSBEHCISplitPeriodicEndpoint::print(a2, *v4);
    v5 = *((_WORD *)this + 24);
    if ( v5 == 3 )
    {
      result = 0xFFFFFFFFLL;
      if ( *((_WORD *)a2 + 24) == 1 )
        return result;
    }
    else if ( (unsigned __int16)v5 == 1 )
    {
      result = 1LL;
      if ( *((_WORD *)a2 + 24) == 3 )
        return result;
    }
    v6 = *((_WORD *)a2 + 26);
    v7 = *((_WORD *)this + 26);
    result = 1LL;
    if ( v6 <= v7 )
    {
      result = 0xFFFFFFFFLL;
      if ( (unsigned __int16)v7 <= (unsigned int)(unsigned __int16)v6 )
        result = 0LL;
    }
  }
  return result;
}
// 16098: using guessed type __int64 off_16098[8];

//----- (0000000000012640) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCITTInfo::ReserveHSSplitINBytes(AppleUSBEHCITTInfo *this, unsigned int a2, unsigned int a3, unsigned __int16 a4)
{
  __int64 result; // rax@1

  result = 0LL;
  if ( a4 )
  {
    result = 3758097090LL;
    if ( a4 <= 0xBCu && a2 <= 0x20 && a3 <= 8 )
    {
      *((_WORD *)this + 8 * (signed int)a2 + (signed int)a3 + 434) += a4;
      result = 0LL;
    }
  }
  return result;
}

//----- (000000000001267E) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCITTInfo::ReleaseHSSplitINBytes(AppleUSBEHCITTInfo *this, unsigned int a2, unsigned int a3, unsigned __int16 a4)
{
  __int64 result; // rax@1
  unsigned int v5; // er8@2
  __int64 v6; // r9@5
  char *v7; // rdi@5
  unsigned int v8; // edx@5
  __int16 v9; // si@5
  __int16 v10; // cx@5

  result = 0LL;
  if ( a4 )
  {
    v5 = a4;
    result = 3758097090LL;
    if ( a4 <= 0xBCu && a2 <= 0x20 && a3 <= 8 )
    {
      v6 = (signed int)a3;
      v7 = (char *)this + 16 * (signed int)a2;
      v8 = *(_WORD *)&v7[2 * a3 + 868];
      v9 = v8 - a4;
      result = 0LL;
      v10 = 0;
      if ( v8 >= v5 )
        v10 = v9;
      *(_WORD *)&v7[2 * v6 + 868] = v10;
    }
  }
  return result;
}

//----- (00000000000126D8) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCITTInfo::ReserveFSBusBytes(AppleUSBEHCITTInfo *this, unsigned int a2, unsigned __int16 a3)
{
  __int64 result; // rax@1
  unsigned __int16 v4; // dx@4

  result = 0LL;
  if ( a3 )
  {
    result = 3758097090LL;
    if ( a3 <= 0x485u && a2 <= 0x20 )
    {
      v4 = *((_WORD *)this + (signed int)a2 + 402) + a3;
      *((_WORD *)this + (signed int)a2 + 402) = v4;
      result = 3758097132LL;
      if ( v4 <= 0x485u )
        result = 0LL;
    }
  }
  return result;
}

//----- (000000000001271E) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCITTInfo::ReleaseFSBusBytes(AppleUSBEHCITTInfo *this, unsigned int a2, unsigned __int16 a3)
{
  __int64 result; // rax@1
  __int64 v4; // r8@4
  unsigned int v5; // er9@4
  __int16 v6; // si@4
  __int16 v7; // cx@4

  result = 0LL;
  if ( a3 )
  {
    result = 3758097090LL;
    if ( a3 <= 0x485u && a2 <= 0x20 )
    {
      v4 = (signed int)a2;
      v5 = *((_WORD *)this + (signed int)a2 + 402);
      v6 = *((_WORD *)this + (signed int)a2 + 402) - a3;
      result = 0LL;
      v7 = 0;
      if ( v5 >= a3 )
        v7 = v6;
      *((_WORD *)this + v4 + 402) = v7;
    }
  }
  return result;
}

//----- (0000000000012768) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCITTInfo::AllocatePeriodicBandwidth(AppleUSBEHCITTInfo *this, AppleUSBEHCISplitPeriodicEndpoint *a2)
{
  __int64 result; // rax@2
  signed int v3; // er13@4
  AppleUSBEHCISplitPeriodicEndpoint *v4; // r14@6
  __int64 v5; // r12@7
  bool v6; // zf@7
  AppleUSBEHCISplitPeriodicEndpoint *v7; // rax@7
  AppleUSBEHCISplitPeriodicEndpoint *v8; // rbx@9
  __int64 v9; // rbx@14
  AppleUSBEHCISplitPeriodicEndpoint *v10; // rax@15
  unsigned __int16 v11; // ax@27
  unsigned int v12; // [sp+4h] [bp-3Ch]@3
  __int64 v13; // [sp+8h] [bp-38h]@7

  if ( a2 )
  {
    result = AppleUSBEHCISplitPeriodicEndpoint::FindStartFrameAndStartTime(a2);
    if ( !(_DWORD)result )
    {
      v12 = *((_BYTE *)a2 + 56);
      result = 0LL;
      if ( v12 <= 0x1F )
      {
        v3 = *((_BYTE *)a2 + 56);
        do
        {
          if ( *((_WORD *)a2 + 24) == 1 )
          {
            v4 = (AppleUSBEHCISplitPeriodicEndpoint *)*((_QWORD *)this + v3 + 67);
            if ( !v4 )
              goto LABEL_33;
            v13 = v3;
            v5 = *((_QWORD *)v4 + 2);
            v6 = v5 == 0;
            v7 = (AppleUSBEHCISplitPeriodicEndpoint *)*((_QWORD *)v4 + 2);
            while ( 1 )
            {
              v8 = 0LL;
              if ( v6 )
                break;
              v8 = v7;
              if ( !(unsigned int)AppleUSBEHCISplitPeriodicEndpoint::CheckPlacementBefore(a2, v7) )
                break;
              v7 = (AppleUSBEHCISplitPeriodicEndpoint *)*((_QWORD *)v8 + 2);
              v6 = v7 == 0LL;
              v4 = v8;
            }
            if ( v8 == a2 )
              goto LABEL_27;
            if ( (unsigned int)*((_WORD *)a2 + 25) >= 0x244 )
            {
              *((_QWORD *)this + v3 + 3) = a2;
              goto LABEL_27;
            }
            if ( v3 == v12 )
              *((_QWORD *)a2 + 2) = v8;
            while ( v5 && (AppleUSBEHCISplitPeriodicEndpoint *)v5 != a2 )
              v5 = *(_QWORD *)(v5 + 16);
            if ( v5 == (_QWORD)a2 )
              goto LABEL_27;
          }
          else
          {
            v9 = *((_QWORD *)this + v3 + 35);
            if ( !v9 )
              goto LABEL_33;
            do
            {
              v4 = (AppleUSBEHCISplitPeriodicEndpoint *)v9;
              v9 = *(_QWORD *)(v9 + 16);
              v10 = 0LL;
              if ( !v9 )
                break;
              v6 = (unsigned int)AppleUSBEHCISplitPeriodicEndpoint::CheckPlacementBefore(
                                   a2,
                                   (AppleUSBEHCISplitPeriodicEndpoint *)v9) == 0;
              v10 = (AppleUSBEHCISplitPeriodicEndpoint *)v9;
            }
            while ( !v6 );
            v13 = v3;
            if ( v10 == a2 )
              goto LABEL_27;
            if ( v3 == v12 )
              *((_QWORD *)a2 + 2) = v10;
          }
          *((_QWORD *)v4 + 2) = a2;
LABEL_27:
          v11 = *((_WORD *)a2 + 25);
          if ( v11 && v11 <= 0x485u && (unsigned int)v3 <= 0x20 )
            *((_WORD *)this + v13 + 402) += v11;
          v3 += *((_BYTE *)a2 + 55);
          result = 0LL;
        }
        while ( v3 < 32 );
      }
    }
  }
  else
  {
LABEL_33:
    result = 3758097097LL;
  }
  return result;
}

//----- (00000000000128F4) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCITTInfo::ShowPeriodicBandwidthUsed(AppleUSBEHCITTInfo *this, __int64 a2, const char *a3)
{
  return 0LL;
}

//----- (00000000000128FC) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCISplitPeriodicEndpoint::FindStartFrameAndStartTime(AppleUSBEHCISplitPeriodicEndpoint *this)
{
  __int64 v1; // r14@1
  __int64 v2; // r10@1
  signed __int16 v3; // r12@2
  __int64 v4; // r15@2
  signed __int16 v5; // ax@2
  char v6; // r11@2
  signed __int16 v7; // r13@2
  __int64 v8; // rdi@4
  unsigned int v9; // er14@4
  unsigned __int16 v10; // si@4
  signed __int16 v11; // r8@4
  __int64 v12; // rbx@4
  unsigned __int16 v13; // cx@5
  int v14; // er9@8
  signed __int16 v15; // cx@9
  unsigned int v16; // edx@9
  char v17; // r8@14
  char v18; // r9@14
  signed __int16 v19; // dx@22
  bool v20; // cf@26
  signed __int16 v21; // cx@28
  AppleUSBEHCISplitPeriodicEndpoint *v22; // rax@34
  char v23; // cl@34
  __int64 result; // rax@35
  __int64 v25; // rcx@38
  AppleUSBEHCISplitPeriodicEndpoint *v26; // [sp+8h] [bp-88h]@1
  char v27; // [sp+10h] [bp-80h]@2
  signed __int16 v28; // [sp+1Ch] [bp-74h]@2
  signed __int16 v29; // [sp+1Eh] [bp-72h]@2
  unsigned __int16 v30[32]; // [sp+20h] [bp-70h]@1
  __int64 v31; // [sp+60h] [bp-30h]@1

  v26 = this;
  v1 = off_16090[0];
  v31 = *(_QWORD *)off_16090[0];
  AppleUSBEHCISplitPeriodicEndpoint::CalculateAllFrameStartTimes(this, v30);
  v2 = *((_BYTE *)this + 55);
  if ( !*((_BYTE *)this + 55) )
    goto LABEL_41;
  v29 = 32;
  v3 = 36;
  v4 = 0LL;
  v5 = 0;
  v27 = 0;
  v6 = 0;
  v28 = 32;
  v7 = 36;
  do
  {
    if ( (signed int)v4 > 31 )
    {
      v15 = 0;
      v10 = 36;
LABEL_14:
      v17 = 1;
      v18 = 1;
      if ( v6 & 1 )
        v18 = v6;
      if ( !(v6 & 1) )
        v3 = v10 + 1;
      if ( v27 & 1 )
        v17 = v27;
      if ( !(v27 & 1) )
        v7 = v15 + 1;
      v19 = v28;
      if ( v10 < (unsigned int)(unsigned __int16)v3 )
        v19 = v5;
      v28 = v19;
      if ( v10 < (unsigned int)(unsigned __int16)v3 )
        v3 = v10;
      v20 = (unsigned __int16)v15 < (unsigned int)(unsigned __int16)v7;
      if ( (unsigned __int16)v15 < (unsigned int)(unsigned __int16)v7 )
        v7 = v15;
      v21 = v29;
      if ( v20 )
        v21 = v5;
      v29 = v21;
      v6 = v18;
      v27 = v17;
    }
    else
    {
      v8 = *((_QWORD *)v26 + 5);
      v9 = *((_WORD *)v26 + 25);
      v10 = 36;
      v11 = 0;
      v12 = v4;
      while ( 1 )
      {
        v13 = v9 + *(_WORD *)(v8 + 2 * v12 + 804);
        if ( v9 >= 0x244 )
        {
          if ( *(_QWORD *)(v8 + 8 * v4 + 24) )
            break;
        }
        if ( v13 > 0x485u )
          break;
        v14 = v30[v12];
        if ( (signed int)(v9 + v14) > 1157 )
          break;
        v15 = v11 + v13;
        v16 = v10;
        v10 = v30[v12];
        if ( (unsigned __int16)v14 <= v16 )
          v10 = v16;
        v12 += v2;
        v11 = v15;
        if ( (signed int)v12 >= 32 )
          goto LABEL_14;
      }
    }
    ++v4;
    ++v5;
  }
  while ( (signed int)v4 < (signed int)v2 );
  v1 = off_16090[0];
  if ( v6 & 1 )
  {
    if ( (unsigned __int16)v3 <= (unsigned int)(unsigned __int16)v7 )
    {
      v22 = v26;
      *((_WORD *)v26 + 26) = v3;
      v23 = v28;
    }
    else
    {
      v22 = v26;
      *((_WORD *)v26 + 26) = v7;
      v23 = v29;
    }
    *((_BYTE *)v22 + 56) = v23;
    result = 0LL;
  }
  else
  {
LABEL_41:
    *((_WORD *)v26 + 26) = 0;
    *((_BYTE *)v26 + 56) = 32;
    result = 3758097132LL;
  }
  v25 = *(_QWORD *)v1;
  return result;
}
// 16090: using guessed type __int64 off_16090[9];
// 128FC: using guessed type unsigned __int16 var_70[32];

//----- (0000000000012AE4) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCISplitPeriodicEndpoint::CheckPlacementBefore(AppleUSBEHCISplitPeriodicEndpoint *this, AppleUSBEHCISplitPeriodicEndpoint *a2)
{
  __int64 result; // rax@1
  int v3; // eax@4
  unsigned int v4; // eax@5
  unsigned int v5; // ecx@5
  bool v6; // cf@5
  bool v7; // zf@5

  result = 3758096385LL;
  if ( (unsigned int)*((_WORD *)this + 25) <= 0x242 )
  {
    result = 0LL;
    if ( a2 )
    {
      if ( a2 != this )
      {
        v3 = *((_WORD *)this + 24);
        if ( v3 == 1 )
        {
          v4 = *((_BYTE *)this + 55);
          v5 = *((_BYTE *)a2 + 55);
          v6 = v5 < v4;
          v7 = v5 == v4;
          result = 3758096385LL;
          if ( v6 || v7 )
            result = 0LL;
        }
        else
        {
          v7 = (unsigned __int16)v3 == 3;
          result = 3758096385LL;
          if ( v7 )
          {
            result = 3758096385LL;
            if ( *((_BYTE *)a2 + 55) < (unsigned int)*((_BYTE *)this + 55) )
              result = 0LL;
          }
        }
      }
    }
  }
  return result;
}

//----- (0000000000012B48) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCITTInfo::DeallocatePeriodicBandwidth(AppleUSBEHCITTInfo *this, AppleUSBEHCISplitPeriodicEndpoint *a2)
{
  signed int v2; // ecx@2
  __int64 result; // rax@2
  char *v4; // rax@5
  __int64 v5; // rdx@8
  __int64 v6; // rax@9
  unsigned __int16 v7; // dx@13
  __int16 v8; // ax@16

  if ( a2 )
  {
    v2 = *((_BYTE *)a2 + 56);
    result = 0LL;
    if ( (unsigned int)v2 <= 0x1F )
    {
      do
      {
        if ( *((AppleUSBEHCISplitPeriodicEndpoint **)this + v2 + 3) == a2 )
        {
          *((_QWORD *)this + v2 + 3) = 0LL;
        }
        else
        {
          if ( *((_WORD *)a2 + 24) == 1 )
            v4 = (char *)this + 8 * v2 + 536;
          else
            v4 = (char *)this + 8 * v2 + 280;
          v5 = *(_QWORD *)v4;
          if ( !*(_QWORD *)v4 )
            goto LABEL_21;
          do
          {
            v6 = v5;
            v5 = *(_QWORD *)(v5 + 16);
          }
          while ( (AppleUSBEHCISplitPeriodicEndpoint *)v5 != a2 && v5 );
          if ( (AppleUSBEHCISplitPeriodicEndpoint *)v5 == a2 )
            *(_QWORD *)(v6 + 16) = *((_QWORD *)a2 + 2);
        }
        v7 = *((_WORD *)a2 + 25);
        if ( v7 && v7 <= 0x485u && (unsigned int)v2 <= 0x20 )
        {
          v8 = *((_WORD *)this + v2 + 402) - v7;
          if ( *((_WORD *)this + v2 + 402) < (unsigned int)v7 )
            v8 = 0;
          *((_WORD *)this + v2 + 402) = v8;
        }
        v2 += *((_BYTE *)a2 + 55);
        result = 0LL;
      }
      while ( v2 < 32 );
    }
  }
  else
  {
LABEL_21:
    result = 3758097097LL;
  }
  return result;
}

//----- (0000000000012C12) ----------------------------------------------------
signed __int64 __fastcall AppleUSBEHCITTInfo::CalculateSPEsToAdjustAfterChange(AppleUSBEHCITTInfo *this, AppleUSBEHCISplitPeriodicEndpoint *a2, char a3)
{
  char v3; // r14@1
  int v4; // ecx@1
  signed __int64 result; // rax@1
  __int64 v6; // r13@2
  __int64 j; // rbx@3
  __int64 k; // rbx@8
  __int64 v9; // r13@15
  __int64 v10; // rbx@16
  __int64 i; // rbx@30
  __int64 v12; // rbx@37

  v3 = a3;
  v4 = (*(int (__cdecl **)(_QWORD))(**((_QWORD **)this + 99) + 304LL))(*((_QWORD *)this + 99));
  result = 3758097097LL;
  if ( !v4 )
  {
    v6 = 0LL;
    if ( (unsigned int)*((_WORD *)a2 + 25) < 0x243 )
    {
      v9 = 0LL;
      if ( *((_WORD *)a2 + 24) == 1 )
      {
        do
        {
          v10 = *(_QWORD *)(*((_QWORD *)this + v9 + 67) + 16LL);
          if ( v3 )
          {
            while ( v10 )
            {
              if ( (unsigned int)AppleUSBEHCISplitPeriodicEndpoint::CheckPlacementBefore(
                                   a2,
                                   (AppleUSBEHCISplitPeriodicEndpoint *)v10) )
              {
                do
                {
                  if ( !(unsigned __int8)(*(int (__fastcall **)(_QWORD, __int64))(**((_QWORD **)this + 99) + 456LL))(
                                           *((_QWORD *)this + 99),
                                           v10) )
                    (*(void (__fastcall **)(_QWORD, __int64))(**((_QWORD **)this + 99) + 424LL))(
                      *((_QWORD *)this + 99),
                      v10);
                  v10 = *(_QWORD *)(v10 + 16);
                }
                while ( v10 );
                break;
              }
              v10 = *(_QWORD *)(v10 + 16);
            }
          }
          else
          {
            while ( v10 )
            {
              if ( (AppleUSBEHCISplitPeriodicEndpoint *)v10 != a2
                && *(_WORD *)(v10 + 52) >= (unsigned int)*((_WORD *)a2 + 26)
                && !(unsigned __int8)(*(int (__fastcall **)(_QWORD, __int64))(**((_QWORD **)this + 99) + 456LL))(
                                       *((_QWORD *)this + 99),
                                       v10) )
                (*(void (__fastcall **)(_QWORD, __int64))(**((_QWORD **)this + 99) + 424LL))(
                  *((_QWORD *)this + 99),
                  v10);
              v10 = *(_QWORD *)(v10 + 16);
            }
          }
          for ( i = *(_QWORD *)(*((_QWORD *)this + v9 + 35) + 16LL); i; i = *(_QWORD *)(i + 16) )
          {
            if ( !(unsigned __int8)(*(int (__fastcall **)(_QWORD, __int64))(**((_QWORD **)this + 99) + 456LL))(
                                     *((_QWORD *)this + 99),
                                     i) )
              (*(void (__fastcall **)(_QWORD, __int64))(**((_QWORD **)this + 99) + 424LL))(*((_QWORD *)this + 99), i);
          }
          ++v9;
          result = 0LL;
        }
        while ( v9 != 32 );
      }
      else
      {
        do
        {
          v12 = *(_QWORD *)(*((_QWORD *)this + v9 + 35) + 16LL);
          if ( v3 )
          {
            while ( v12 )
            {
              if ( !(unsigned int)AppleUSBEHCISplitPeriodicEndpoint::CheckPlacementBefore(
                                    a2,
                                    (AppleUSBEHCISplitPeriodicEndpoint *)v12) )
              {
                do
                {
                  if ( (AppleUSBEHCISplitPeriodicEndpoint *)v12 != a2
                    && !(unsigned __int8)(*(int (__fastcall **)(_QWORD, __int64))(**((_QWORD **)this + 99) + 456LL))(
                                           *((_QWORD *)this + 99),
                                           v12) )
                    (*(void (__fastcall **)(_QWORD, __int64))(**((_QWORD **)this + 99) + 424LL))(
                      *((_QWORD *)this + 99),
                      v12);
                  v12 = *(_QWORD *)(v12 + 16);
                }
                while ( v12 );
                break;
              }
              v12 = *(_QWORD *)(v12 + 16);
            }
          }
          else
          {
            while ( v12 )
            {
              if ( (AppleUSBEHCISplitPeriodicEndpoint *)v12 != a2
                && *(_WORD *)(v12 + 52) >= (unsigned int)*((_WORD *)a2 + 26)
                && !(unsigned __int8)(*(int (__fastcall **)(_QWORD, __int64))(**((_QWORD **)this + 99) + 456LL))(
                                       *((_QWORD *)this + 99),
                                       v12) )
                (*(void (__fastcall **)(_QWORD, __int64))(**((_QWORD **)this + 99) + 424LL))(
                  *((_QWORD *)this + 99),
                  v12);
              v12 = *(_QWORD *)(v12 + 16);
            }
          }
          ++v9;
          result = 0LL;
        }
        while ( v9 != 32 );
      }
    }
    else
    {
      do
      {
        for ( j = *(_QWORD *)(*((_QWORD *)this + v6 + 67) + 16LL); j; j = *(_QWORD *)(j + 16) )
        {
          if ( !(unsigned __int8)(*(int (__fastcall **)(_QWORD, __int64))(**((_QWORD **)this + 99) + 456LL))(
                                   *((_QWORD *)this + 99),
                                   j) )
            (*(void (__fastcall **)(_QWORD, __int64))(**((_QWORD **)this + 99) + 424LL))(*((_QWORD *)this + 99), j);
        }
        for ( k = *(_QWORD *)(*((_QWORD *)this + v6 + 35) + 16LL); k; k = *(_QWORD *)(k + 16) )
        {
          if ( !(unsigned __int8)(*(int (__fastcall **)(_QWORD, __int64))(**((_QWORD **)this + 99) + 456LL))(
                                   *((_QWORD *)this + 99),
                                   k) )
            (*(void (__fastcall **)(_QWORD, __int64))(**((_QWORD **)this + 99) + 424LL))(*((_QWORD *)this + 99), k);
        }
        ++v6;
        result = 0LL;
      }
      while ( v6 != 32 );
    }
  }
  return result;
}

//----- (0000000000012EE2) ----------------------------------------------------
int __fastcall AppleUSBEHCITTInfo::release(AppleUSBEHCITTInfo *this)
{
  AppleUSBEHCITTInfo *v1; // r15@1
  int v2; // er14@1
  int result; // eax@1
  signed __int64 v4; // rbx@2
  __int64 v5; // rdi@3
  __int64 v6; // rdi@5

  v1 = this;
  v2 = (*(int (__cdecl **)(AppleUSBEHCITTInfo *))(*(_QWORD *)this + 24LL))(this);
  result = (*(int (__cdecl **)(AppleUSBEHCITTInfo *))(off_16088[0] + 56))(this);
  if ( v2 == 65 )
  {
    (*(void (__cdecl **)(_QWORD))(**((_QWORD **)this + 99) + 304LL))(*((_QWORD *)this + 99));
    result = (*(int (__cdecl **)(_QWORD))(**((_QWORD **)this + 99) + 40LL))(*((_QWORD *)this + 99));
    v4 = -32LL;
    do
    {
      v5 = *((_QWORD *)v1 + v4 + 67);
      if ( v5 )
        result = (*(int (__cdecl **)(__int64))(*(_QWORD *)v5 + 40LL))(v5);
      v6 = *((_QWORD *)v1 + v4 + 99);
      if ( v6 )
        result = (*(int (__cdecl **)(__int64))(*(_QWORD *)v6 + 40LL))(v6);
      ++v4;
    }
    while ( v4 );
  }
  return result;
}
// 16088: using guessed type __int64 off_16088[10];

//----- (0000000000012F66) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCITTInfo::ShowHSSplitTimeUsed(AppleUSBEHCITTInfo *this, __int64 a2, const char *a3)
{
  return 0LL;
}

//----- (0000000000012F6E) ----------------------------------------------------
int __fastcall AppleUSBEHCITTInfo::print(AppleUSBEHCITTInfo *this, unsigned int a2, const char *a3)
{
  AppleUSBEHCITTInfo *v3; // r14@1
  __int64 v4; // r13@1
  __int64 v5; // rbx@1
  AppleUSBEHCISplitPeriodicEndpoint *v6; // rdi@2
  int result; // eax@3
  __int64 v8; // r12@5
  __int64 v9; // rbx@6
  __int64 v10; // rbx@10

  v3 = this;
  v4 = 0LL;
  v5 = 0LL;
  do
  {
    v6 = (AppleUSBEHCISplitPeriodicEndpoint *)*((_QWORD *)v3 + v5 + 3);
    if ( v6 )
      result = AppleUSBEHCISplitPeriodicEndpoint::print(v6, a2);
    ++v5;
  }
  while ( v5 != 32 );
  v8 = 0LL;
  do
  {
    v9 = *((_QWORD *)v3 + v4 + 67);
    if ( v9 && *(_QWORD *)(v9 + 16) )
    {
      do
      {
        result = AppleUSBEHCISplitPeriodicEndpoint::print((AppleUSBEHCISplitPeriodicEndpoint *)v9, a2);
        v9 = *(_QWORD *)(v9 + 16);
      }
      while ( v9 );
    }
    ++v4;
  }
  while ( v4 != 32 );
  do
  {
    v10 = *((_QWORD *)v3 + v8 + 35);
    if ( v10 && *(_QWORD *)(v10 + 16) )
    {
      do
      {
        result = AppleUSBEHCISplitPeriodicEndpoint::print((AppleUSBEHCISplitPeriodicEndpoint *)v10, a2);
        v10 = *(_QWORD *)(v10 + 16);
      }
      while ( v10 );
    }
    ++v8;
  }
  while ( v8 != 32 );
  return result;
}

//----- (0000000000013016) ----------------------------------------------------
int __fastcall AppleUSBEHCISplitPeriodicEndpoint::print(AppleUSBEHCISplitPeriodicEndpoint *this, unsigned int a2)
{
  int result; // eax@1

  result = LODWORD(off_160B8[0]);
  if ( *(_DWORD *)off_160B8[0] >= a2 && (*((_QWORD *)this + 3) || *((_QWORD *)this + 4) || *((_WORD *)this + 26)) )
    result = IOSleep(1LL);
  return result;
}
// 160B8: using guessed type __int64 off_160B8[4];
// 2DB30: using guessed type int __fastcall IOSleep(_QWORD);

//----- (0000000000013048) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCISplitPeriodicEndpoint::MetaClass::MetaClass(AppleUSBEHCISplitPeriodicEndpoint::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "AppleUSBEHCISplitPeriodicEndpoint", off_16060[0], 72LL);
  result = (__int64)off_187C0;
  *(_QWORD *)this = off_187C0;
  return result;
}
// 16060: using guessed type _QWORD off_16060[15];
// 187C0: using guessed type __int64 (__fastcall *off_187C0[2])(AppleUSBEHCISplitPeriodicEndpoint::MetaClass *__hidden this);
// 2DBC8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001307A) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCISplitPeriodicEndpoint::MetaClass::~MetaClass(AppleUSBEHCISplitPeriodicEndpoint::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000013084) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCISplitPeriodicEndpoint::AppleUSBEHCISplitPeriodicEndpoint(__int64 a1)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1);
  result = (__int64)off_18690;
  *(_QWORD *)a1 = off_18690;
  return result;
}
// 18690: using guessed type __int64 (__fastcall *off_18690[2])(AppleUSBEHCISplitPeriodicEndpoint *__hidden this);
// 2E330: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (00000000000130A4) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCISplitPeriodicEndpoint::AppleUSBEHCISplitPeriodicEndpoint(__int64 a1)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1);
  result = (__int64)off_18690;
  *(_QWORD *)a1 = off_18690;
  return result;
}
// 18690: using guessed type __int64 (__fastcall *off_18690[2])(AppleUSBEHCISplitPeriodicEndpoint *__hidden this);
// 2E330: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (00000000000130C4) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCISplitPeriodicEndpoint::~AppleUSBEHCISplitPeriodicEndpoint(AppleUSBEHCISplitPeriodicEndpoint *this)
{
  return OSObject::~OSObject(this);
}

//----- (00000000000130CE) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCISplitPeriodicEndpoint::~AppleUSBEHCISplitPeriodicEndpoint(AppleUSBEHCISplitPeriodicEndpoint *this)
{
  return OSObject::~OSObject(this);
}

//----- (00000000000130D8) ----------------------------------------------------
void __fastcall AppleUSBEHCISplitPeriodicEndpoint::~AppleUSBEHCISplitPeriodicEndpoint(AppleUSBEHCISplitPeriodicEndpoint *this)
{
  OSObject::~OSObject(this);
  OSObject::operator delete((void *)this);
}

//----- (00000000000130FA) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCISplitPeriodicEndpoint::getMetaClass(AppleUSBEHCISplitPeriodicEndpoint *this)
{
  return (__int64)&AppleUSBEHCISplitPeriodicEndpoint::gMetaClass;
}
// 18B18: using guessed type _QWORD AppleUSBEHCISplitPeriodicEndpoint::gMetaClass;

//----- (0000000000013108) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCISplitPeriodicEndpoint::MetaClass::MetaClass(AppleUSBEHCISplitPeriodicEndpoint::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "AppleUSBEHCISplitPeriodicEndpoint", off_16060[0], 72LL);
  result = (__int64)off_187C0;
  *(_QWORD *)this = off_187C0;
  return result;
}
// 16060: using guessed type _QWORD off_16060[15];
// 187C0: using guessed type __int64 (__fastcall *off_187C0[2])(AppleUSBEHCISplitPeriodicEndpoint::MetaClass *__hidden this);
// 2DBC8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001313A) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCISplitPeriodicEndpoint::MetaClass::alloc(AppleUSBEHCISplitPeriodicEndpoint::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&stru_20.fileoff, a2);
  OSObject::OSObject(v2);
  *(_QWORD *)v2 = off_18690;
  OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUSBEHCISplitPeriodicEndpoint::gMetaClass);
  return v2;
}
// 20: using guessed type segment_command_64 stru_20;
// 18690: using guessed type __int64 (__fastcall *off_18690[2])(AppleUSBEHCISplitPeriodicEndpoint *__hidden this);
// 18B18: using guessed type _QWORD AppleUSBEHCISplitPeriodicEndpoint::gMetaClass;
// 2E330: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (000000000001317A) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCISplitPeriodicEndpoint::AppleUSBEHCISplitPeriodicEndpoint(__int64 a1)
{
  OSObject::OSObject(a1);
  *(_QWORD *)a1 = off_18690;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUSBEHCISplitPeriodicEndpoint::gMetaClass);
}
// 18690: using guessed type __int64 (__fastcall *off_18690[2])(AppleUSBEHCISplitPeriodicEndpoint *__hidden this);
// 18B18: using guessed type _QWORD AppleUSBEHCISplitPeriodicEndpoint::gMetaClass;
// 2E330: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (00000000000131AA) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCISplitPeriodicEndpoint::AppleUSBEHCISplitPeriodicEndpoint(__int64 a1)
{
  OSObject::OSObject(a1);
  *(_QWORD *)a1 = off_18690;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUSBEHCISplitPeriodicEndpoint::gMetaClass);
}
// 18690: using guessed type __int64 (__fastcall *off_18690[2])(AppleUSBEHCISplitPeriodicEndpoint *__hidden this);
// 18B18: using guessed type _QWORD AppleUSBEHCISplitPeriodicEndpoint::gMetaClass;
// 2E330: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (00000000000131DA) ----------------------------------------------------
int __fastcall AppleUSBEHCISplitPeriodicEndpoint::release(AppleUSBEHCISplitPeriodicEndpoint *this)
{
  if ( (*(int (__cdecl **)(AppleUSBEHCISplitPeriodicEndpoint *))(*(_QWORD *)this + 24LL))(this) == 1 )
    (*(void (__cdecl **)(_QWORD))(**((_QWORD **)this + 5) + 40LL))(*((_QWORD *)this + 5));
  return (*(int (__fastcall **)(AppleUSBEHCISplitPeriodicEndpoint *))(off_16088[0] + 56))(this);
}
// 16088: using guessed type __int64 off_16088[10];

//----- (000000000001320C) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCISplitPeriodicEndpoint::CalculateAllFrameStartTimes(AppleUSBEHCISplitPeriodicEndpoint *this, unsigned __int16 *a2)
{
  __int64 v2; // r13@1
  __int64 v3; // rax@2
  signed __int64 v4; // rax@3
  __int64 v5; // rbx@5
  __int64 result; // rax@5
  AppleUSBEHCISplitPeriodicEndpoint *v7; // r12@6
  AppleUSBEHCISplitPeriodicEndpoint *v8; // rcx@6
  int v9; // eax@7

  v2 = 0LL;
  do
  {
    v3 = *((_QWORD *)this + 5);
    if ( *((_WORD *)this + 24) == 3 )
      v4 = v3 + 8 * v2 + 280;
    else
      v4 = v3 + 8 * v2 + 536;
    v5 = *(_QWORD *)v4;
    result = 3758097097LL;
    if ( !v5 )
      break;
    do
    {
      v7 = (AppleUSBEHCISplitPeriodicEndpoint *)v5;
      v5 = *(_QWORD *)(v5 + 16);
      v8 = 0LL;
      if ( !v5 )
        break;
      v9 = AppleUSBEHCISplitPeriodicEndpoint::CheckPlacementBefore(this, (AppleUSBEHCISplitPeriodicEndpoint *)v5);
      v8 = (AppleUSBEHCISplitPeriodicEndpoint *)v5;
    }
    while ( v9 );
    a2[v2] = AppleUSBEHCISplitPeriodicEndpoint::CalculateStartTime(this, v2, v7, v8);
    ++v2;
    result = 0LL;
  }
  while ( (signed int)v2 < 32 );
  return result;
}

//----- (00000000000132A2) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCISplitPeriodicEndpoint::CalculateStartTime(AppleUSBEHCISplitPeriodicEndpoint *this, unsigned __int16 a2, AppleUSBEHCISplitPeriodicEndpoint *a3, AppleUSBEHCISplitPeriodicEndpoint *a4)
{
  __int16 v4; // bx@2
  unsigned __int16 v5; // bx@4
  __int64 v6; // rax@6
  __int64 v7; // rcx@6
  __int64 v8; // rdx@12
  __int64 v9; // rsi@12
  __int64 v10; // rax@13

  if ( !a3 )
    return 0;
  v4 = *((_WORD *)this + 24);
  if ( a4 )
  {
    if ( v4 == 1 )
    {
      v5 = *((_WORD *)a4 + 26) + *((_WORD *)a4 + 25);
      AppleUSBEHCISplitPeriodicEndpoint::print(a3, *(_DWORD *)off_16098[0]);
      return v5;
    }
    v6 = a2;
    v7 = *((_QWORD *)this + 5);
  }
  else
  {
    v6 = a2;
    v7 = *((_QWORD *)this + 5);
    if ( v4 == 1 )
    {
      a3 = *(AppleUSBEHCISplitPeriodicEndpoint **)(v7 + 8LL * a2 + 24);
      if ( !a3 )
        return (unsigned __int16)(*(_WORD *)(*(_QWORD *)(v7 + 8LL * a2 + 536) + 52LL)
                                + *(_WORD *)(*(_QWORD *)(v7 + 8LL * a2 + 536) + 50LL));
LABEL_11:
      return (unsigned __int16)(*((_WORD *)a3 + 26) + *((_WORD *)a3 + 25));
    }
  }
  if ( *(AppleUSBEHCISplitPeriodicEndpoint **)(v7 + 8 * v6 + 280) != a3 )
    goto LABEL_11;
  v8 = *(_QWORD *)(v7 + 8 * v6 + 536);
  v9 = *(_QWORD *)(v8 + 16);
  if ( !v9 )
  {
    v10 = *(_QWORD *)(v7 + 8 * v6 + 24);
    if ( v10 )
      v8 = v10;
    v9 = v8;
  }
  return (unsigned __int16)(*(_WORD *)(v9 + 52) + *(_WORD *)(v9 + 50));
}
// 16098: using guessed type __int64 off_16098[8];

//----- (0000000000013356) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCISplitPeriodicEndpoint::CalculateNewStartTimeFromChange(AppleUSBEHCISplitPeriodicEndpoint *this, AppleUSBEHCISplitPeriodicEndpoint *a2)
{
  unsigned int *v2; // r15@1
  signed int v3; // er14@3
  signed __int16 v4; // r15@3
  __int64 v5; // rcx@5
  signed __int64 v6; // rax@6
  __int64 v7; // rax@8
  AppleUSBEHCISplitPeriodicEndpoint *v8; // rdx@9
  signed __int16 v9; // ax@10

  v2 = (unsigned int *)off_16098[0];
  AppleUSBEHCISplitPeriodicEndpoint::print(this, *(_DWORD *)off_16098[0]);
  if ( a2 )
    AppleUSBEHCISplitPeriodicEndpoint::print(a2, *v2);
  v3 = *((_BYTE *)this + 56);
  v4 = 36;
  if ( (unsigned int)v3 <= 0x1F )
  {
    v4 = 36;
    do
    {
      v5 = *((_QWORD *)this + 5);
      if ( *((_WORD *)this + 24) == 1 )
        v6 = v5 + 8LL * v3 + 536;
      else
        v6 = v5 + 8LL * v3 + 280;
      v7 = *(_QWORD *)v6;
      do
      {
        v8 = (AppleUSBEHCISplitPeriodicEndpoint *)v7;
        v7 = *(_QWORD *)(v7 + 16);
      }
      while ( (AppleUSBEHCISplitPeriodicEndpoint *)v7 != this );
      v9 = AppleUSBEHCISplitPeriodicEndpoint::CalculateStartTime(
             this,
             v3,
             v8,
             *((AppleUSBEHCISplitPeriodicEndpoint **)this + 2));
      if ( (unsigned __int16)v9 > (unsigned int)(unsigned __int16)v4 )
        v4 = v9;
      v3 += *((_BYTE *)this + 55);
    }
    while ( v3 < 32 );
  }
  return (unsigned __int16)v4;
}
// 16098: using guessed type __int64 off_16098[8];

//----- (0000000000013406) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCIHubInfo::MetaClass::~MetaClass(AppleUSBEHCIHubInfo::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000013410) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCITTInfo::MetaClass::~MetaClass(AppleUSBEHCITTInfo::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000001341A) ----------------------------------------------------
__int64 __fastcall AppleUSBEHCISplitPeriodicEndpoint::MetaClass::~MetaClass(AppleUSBEHCISplitPeriodicEndpoint::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000013430) ----------------------------------------------------
__int64 `global constructor keyed to'_a_6()
{
  __int64 v0; // rbx@1
  __int64 result; // rax@1

  v0 = off_16060[0];
  OSMetaClass::OSMetaClass(&AppleUSBEHCIHubInfo::gMetaClass, "AppleUSBEHCIHubInfo", off_16060[0], 40LL);
  AppleUSBEHCIHubInfo::gMetaClass = off_18360;
  OSMetaClass::OSMetaClass(&AppleUSBEHCITTInfo::gMetaClass, "AppleUSBEHCITTInfo", v0, 1384LL);
  AppleUSBEHCITTInfo::gMetaClass = off_18590;
  OSMetaClass::OSMetaClass(
    &AppleUSBEHCISplitPeriodicEndpoint::gMetaClass,
    "AppleUSBEHCISplitPeriodicEndpoint",
    v0,
    72LL);
  result = (__int64)off_187C0;
  AppleUSBEHCISplitPeriodicEndpoint::gMetaClass = off_187C0;
  return result;
}
// 16060: using guessed type _QWORD off_16060[15];
// 18360: using guessed type __int64 (__fastcall *off_18360[2])(AppleUSBEHCIHubInfo::MetaClass *__hidden this);
// 18590: using guessed type __int64 (__fastcall *off_18590[2])(AppleUSBEHCITTInfo::MetaClass *__hidden this);
// 187C0: using guessed type __int64 (__fastcall *off_187C0[2])(AppleUSBEHCISplitPeriodicEndpoint::MetaClass *__hidden this);
// 18AC8: using guessed type _QWORD AppleUSBEHCIHubInfo::gMetaClass;
// 18AF0: using guessed type _QWORD AppleUSBEHCITTInfo::gMetaClass;
// 18B18: using guessed type _QWORD AppleUSBEHCISplitPeriodicEndpoint::gMetaClass;
// 2DBC8: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000134C0) ----------------------------------------------------
__int64 `global destructor keyed to'_a_6()
{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&AppleUSBEHCISplitPeriodicEndpoint::gMetaClass);
  OSMetaClass::~OSMetaClass((OSMetaClass *)&AppleUSBEHCITTInfo::gMetaClass);
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&AppleUSBEHCIHubInfo::gMetaClass);
}
// 18AC8: using guessed type _QWORD AppleUSBEHCIHubInfo::gMetaClass;
// 18AF0: using guessed type _QWORD AppleUSBEHCITTInfo::gMetaClass;
// 18B18: using guessed type _QWORD AppleUSBEHCISplitPeriodicEndpoint::gMetaClass;

//----- (00000000000134E9) ----------------------------------------------------
int _start()
{
  int result; // eax@2

  if ( _realmain )
    result = _realmain();
  else
    result = 0;
  return result;
}
// 18B40: using guessed type int (*_realmain)(void);

//----- (0000000000013503) ----------------------------------------------------
__int64 *OSKextGetCurrentIdentifier()
{
  return &kmod_info + 2;
}
// 18898: using guessed type __int64 kmod_info;

//----- (0000000000013514) ----------------------------------------------------
__int64 *OSKextGetCurrentVersionString()
{
  return &kmod_info + 10;
}
// 18898: using guessed type __int64 kmod_info;

//----- (0000000000013525) ----------------------------------------------------
__int64 OSKextGetCurrentLoadTag()
{
  return *((_DWORD *)&kmod_info + 3);
}
// 18898: using guessed type __int64 kmod_info;

//----- (0000000000013535) ----------------------------------------------------
int _stop()
{
  int result; // eax@2

  if ( _antimain )
    result = _antimain();
  else
    result = 0;
  return result;
}
// 18B48: using guessed type int (*_antimain)(void);

// ALL OK, 442 function(s) have been successfully decompiled
