/* This file has been generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2014 Hex-Rays <info@hex-rays.com>

   Detected compiler: GNU C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

__int64 __fastcall IOUSBBus::MetaClass::MetaClass(IOUSBBus::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBBus::MetaClass::~MetaClass(IOUSBBus::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBBus::IOUSBBus(__int64 a1);
__int64 __fastcall IOUSBBus::IOUSBBus(__int64 a1);
__int64 __fastcall IOUSBBus::~IOUSBBus(IOUSBBus *__hidden this); // idb
__int64 __fastcall IOUSBBus::~IOUSBBus(IOUSBBus *__hidden this); // idb
void __fastcall IOUSBBus::~IOUSBBus(IOUSBBus *this);
__int64 __fastcall IOUSBBus::getMetaClass(IOUSBBus *__hidden this); // idb
__int64 __fastcall IOUSBBus::MetaClass::MetaClass(IOUSBBus::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBBus::MetaClass::alloc(IOUSBBus::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBBus::MetaClass::~MetaClass(IOUSBBus::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a();
__int64 `global destructor keyed to'_a();
int __fastcall USBGlobals::USBGlobals(USBGlobals *this);
int __fastcall USBGlobals::~USBGlobals(USBGlobals *this);
int __fastcall USBSysctl(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall USBGlobals::USBGlobals(__int64 a1);
int __fastcall USBGlobals::~USBGlobals(USBGlobals *this);
void __fastcall USBGlobals::~USBGlobals(USBGlobals *this);
int __fastcall IOUSBController_ExtraCurrentIOLockClass::IOUSBController_ExtraCurrentIOLockClass(__int64 a1);
int __fastcall IOUSBController_ExtraCurrentIOLockClass::~IOUSBController_ExtraCurrentIOLockClass(IOUSBController_ExtraCurrentIOLockClass *this);
// void __usercall IOUSBSyncCompletion(void *a1@<rdi>, void *a2@<rsi>, char a3@<al>, unsigned int a4@<edx>, unsigned int a5@<ecx>, __int64 a6@<r8>, __int64 a7@<r9>);
__int64 __fastcall IOUSBController::GetCommandGate(IOUSBController *__hidden this); // idb
// void __usercall IOUSBSyncIsoCompletion(char a1@<al>, int a2@<edx>, __int64 a3@<rcx>, uintptr_t a4@<rdi>, __int64 a5@<r8>, __int64 a6@<r9>);
__int64 __fastcall IOUSBController::MetaClass::MetaClass(IOUSBController::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBController::MetaClass::~MetaClass(IOUSBController::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBController::IOUSBController(__int64 a1);
__int64 __fastcall IOUSBController::~IOUSBController(IOUSBController *__hidden this); // idb
__int64 __fastcall IOUSBController::~IOUSBController(IOUSBController *__hidden this); // idb
void __fastcall IOUSBController::~IOUSBController(IOUSBController *this);
__int64 __fastcall IOUSBController::getMetaClass(IOUSBController *__hidden this); // idb
__int64 __fastcall IOUSBController::MetaClass::MetaClass(IOUSBController::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBController::MetaClass::alloc(IOUSBController::MetaClass *__hidden this); // idb
char __fastcall IOUSBController::init(IOUSBController *this, OSDictionary *a2);
// char __usercall IOUSBController::start@<al>(IOUSBController *this@<rdi>, IOService *a2@<rsi>, char a3@<al>, const OSMetaClass *a4@<rdx>);
// int __usercall IOUSBController::WatchdogTimer@<eax>(const OSMetaClass *a1@<rdx>, OSMetaClassBase *a2@<rdi>, __int64 a3@<rsi>, char a4);
__int64 __fastcall IOUSBController::getWorkLoop(IOUSBController *__hidden this); // idb
signed __int64 __fastcall IOUSBController::CreateDevice(IOUSBController *this, IOUSBDevice *a2, unsigned int a3, unsigned int a4, unsigned int a5, unsigned int a6);
int __fastcall IOUSBController::DeviceRequest(__int64 a1);
int __fastcall IOUSBController::DeviceRequest(__int64 a1);
__int64 __fastcall IOUSBController::GetNewAddress(uintptr_t arg1); // idb
__int64 __fastcall IOUSBController::ControlTransaction(uintptr_t arg1, IOUSBCommand *this); // idb
__int64 __fastcall IOUSBController::ControlPacketHandler(IOUSBController *this, OSObject *a2, void *a3, int a4);
// int __usercall IOUSBController::Complete@<eax>(uintptr_t arg1@<rdi>, uintptr_t arg2@<rcx>, unsigned int a3@<edx>, unsigned int a4@<esi>, __int64 a5, uintptr_t arg2a, __int64 a7);
__int64 __fastcall IOUSBController::InterruptTransaction(uintptr_t arg1, IOUSBCommand *this); // idb
__int64 __fastcall IOUSBController::InterruptPacketHandler(IOUSBController *this, OSObject *a2, void *a3, int a4);
// int __usercall IOUSBController::CompleteWithTimeStamp@<eax>(uintptr_t arg1@<rdi>, uintptr_t arg2@<rcx>, unsigned int a3@<edx>, unsigned int a4@<esi>, __int64 a5, uintptr_t arg2a, __int64 a7);
__int64 __fastcall IOUSBController::BulkTransaction(uintptr_t arg1, IOUSBCommand *this); // idb
__int64 __fastcall IOUSBController::BulkPacketHandler(IOUSBController *this, OSObject *a2, void *a3, int a4);
__int64 __fastcall IOUSBController::DoIsocTransfer(IOUSBController *this, OSObject *, void *, void *, void *, void *); // idb
__int64 __fastcall IOUSBController::IsocTransaction(IOUSBController *this, IOUSBIsocCommand *); // idb
int __fastcall IOUSBController::DoAbortEP(IOUSBController *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6);
__int64 __fastcall IOUSBController::DoLowLatencyIsocTransfer(IOUSBController *__hidden this, OSObject *, void *, void *, void *, void *); // idb
int __fastcall IOUSBController::IsocCompletionHandler(OSMetaClassBase *a1, __int64 a2, const OSMetaClass *a3, __int64 a4);
__int64 __fastcall IOUSBController::LowLatencyIsocTransaction(IOUSBController *__hidden this, IOUSBIsocCommand *); // idb
__int64 __fastcall IOUSBController::DoIOTransfer(uintptr_t arg1, OSObject *this, void *, void *, void *, void *); // idb
__int64 __fastcall IOUSBController::DoControlTransfer(uintptr_t arg1, OSObject *this, void *, void *, void *, void *); // idb
int __fastcall IOUSBController::DoDeleteEP(IOUSBController *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6);
int __fastcall IOUSBController::DoClearEPStall(IOUSBController *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6);
int __fastcall IOUSBController::DoCreateEP(IOUSBController *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6);
// __int64 __usercall IOUSBController::ProtectedDevZeroLock@<rax>(uintptr_t arg1@<rdi>, OSObject *a2@<rsi>, void *a3@<rdx>, void *a4@<rcx>, void *a5@<r8>, void *a6@<r9>, __int64 a7@<rax>);
__int64 __fastcall IOUSBController::AcquireDeviceZero(uintptr_t arg1); // idb
void __fastcall IOUSBController::ReleaseDeviceZero(uintptr_t arg1);
void __fastcall IOUSBController::WaitForReleaseDeviceZero(uintptr_t arg1);
int __fastcall IOUSBController::ConfigureDeviceZero(IOUSBController *this, __int16 a2, __int64 a3);
int __fastcall IOUSBController::GetDeviceZeroDescriptor(__int64 a1, __int64 a2, __int16 a3);
int __fastcall IOUSBController::SetDeviceZeroAddress(IOUSBController *this, __int16 a2);
__int64 __fastcall IOUSBController::MakeDevice(uintptr_t arg1, unsigned __int16 *a2, const OSMetaClass *a3);
__int64 __fastcall IOUSBController::MakeHubDevice(uintptr_t arg1, unsigned __int16 *); // idb
// int __usercall IOUSBController::PolledRead@<eax>(IOUSBController *this@<rdi>, char a2@<dl>, IOMemoryDescriptor *a3@<rcx>, __int16 a4@<si>, char a5@<r8b>, __int64 a6, __int64 a7, __int64 a8);
__int64 __fastcall IOUSBController::IncreaseCommandPool(IOUSBController *this, __int64 a2, const OSMetaClass *a3);
signed __int64 __fastcall IOUSBController::message(IOUSBController *this, int a2, IOService *a3, void *a4);
void __fastcall IOUSBController::didTerminate(IOUSBController *this, IOService *a2, __int64 a3, bool *a4);
int __fastcall IOUSBController::stop(IOUSBController *this, IOService *a2);
char __fastcall IOUSBController::finalize(IOUSBController *this);
__int64 __fastcall IOUSBController::IncreaseIsocCommandPool(IOUSBController *this, __int64 a2, const OSMetaClass *a3);
int __fastcall IOUSBController::ReturnUSBCommand(IOUSBController *this, IOUSBCommand *a2);
void __fastcall IOUSBController::TerminatePCCard(IOUSBController *this, OSObject *a2);
__int64 __fastcall IOUSBController::ValueOfHexDigit(IOUSBController *this, int a2);
char __fastcall IOUSBController::ParsePCILocation(IOUSBController *this, const char *a2, int *a3, int *a4);
void __fastcall IOUSBController::UIMCheckForTimeouts(IOUSBController *this);
int __fastcall IOUSBController::UIMCreateControlTransfer(IOUSBController *this, unsigned int a2, unsigned int a3, IOUSBCommand *a4, void *a5, __int64 a6, unsigned int a7);
int __fastcall IOUSBController::UIMCreateControlTransfer(IOUSBController *this, unsigned int a2, unsigned int a3, IOUSBCommand *a4, IOMemoryDescriptor *a5, __int64 a6, unsigned int a7);
int __fastcall IOUSBController::UIMCreateBulkTransfer(IOUSBController *this, IOUSBCommand *a2);
int __fastcall IOUSBController::UIMCreateInterruptTransfer(IOUSBController *this, IOUSBCommand *a2);
__int64 __fastcall IOUSBController::DeviceRequest(uintptr_t arg1, IOMemoryDescriptor *this, __int64 a3, __int16 a4, char a5, int a6, int a7);
__int64 __fastcall IOUSBController::DeviceRequest(IOUSBController *this, IOMemoryDescriptor *a2, __int64 a3, __int16 a4, char a5, int a6, int a7);
void __fastcall IOUSBController::free(IOUSBController *this);
__int64 __fastcall IOUSBController::CreateRootHubDevice(IOUSBController *this, IOService *, IOUSBRootHubDevice **); // idb
signed __int64 IOUSBController::UIMCreateIsochTransfer();
int __fastcall IOUSBController::UIMCreateIsochTransfer(IOUSBController *this, IOUSBIsocCommand *a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
OSMetaClassBase *__fastcall IOUSBController::CopyACPIDevice(IOUSBController *this, IORegistryEntry *a2);
__int64 __fastcall DecodeUSBConnectorType(signed int a1);
__int64 __fastcall IOUSBController::calculateUSBDepth(IOUSBController *__hidden this, unsigned int); // idb
__int64 __fastcall IOUSBController::calculateACPIDepth(IOUSBController *__hidden this, int); // idb
char __fastcall IOUSBController::HasExpressCard(IOUSBController *this, IORegistryEntry *a2, unsigned int *a3);
char __fastcall IOUSBController::DumpUSBACPI(IOUSBController *this, IORegistryEntry *a2);
// __int64 __usercall IOUSBController::ExpressCardPort@<rax>(IOUSBController *this@<rdi>, IORegistryEntry *a2@<rsi>, __int64 a3@<rax>);
char __fastcall IOUSBController::IsPortMuxed(IOUSBController *this, IORegistryEntry *a2, int a3, unsigned int a4, char *a5);
char __fastcall IOUSBController::CheckACPIUPCTableForMuxedMethods(IOUSBController *this, IORegistryEntry *a2, int a3, unsigned int a4, char *a5);
char __fastcall IOUSBController::IsPortMapped(IOUSBController *this, IORegistryEntry *a2, int a3, unsigned int a4, unsigned int *a5);
char __fastcall IOUSBController::CheckACPIForPortMapping(IOUSBController *this, IORegistryEntry *a2, int a3, unsigned int a4, unsigned int *a5);
bool __fastcall IOUSBController::IsPortInternal(IOUSBController *this, IORegistryEntry *a2, int a3, unsigned int a4);
bool __fastcall IOUSBController::CheckACPIUPCTable(IOUSBController *this, IORegistryEntry *a2, int a3, unsigned int a4);
__int64 __fastcall IOUSBController::CheckACPIUPCTable(IOUSBController *this, IORegistryEntry *a2, int a3, unsigned int a4, unsigned __int8 *a5);
char __fastcall IOUSBController::CheckACPIUPCTableForInternalHubErrataBits(IOUSBController *this, IORegistryEntry *a2, int a3, unsigned int a4, unsigned int *a5);
bool __fastcall IOUSBController::IsControllerMuxed(IOUSBController *this, IORegistryEntry *a2);
__int64 __fastcall IOUSBController::_RESERVEDIOUSBController19(IOUSBController *__hidden this); // idb
int __fastcall IOUSBController_ExtraCurrentIOLockClass::IOUSBController_ExtraCurrentIOLockClass(__int64 a1);
int __fastcall IOUSBController_ExtraCurrentIOLockClass::~IOUSBController_ExtraCurrentIOLockClass(IOUSBController_ExtraCurrentIOLockClass *this);
void __fastcall IOUSBController_ExtraCurrentIOLockClass::~IOUSBController_ExtraCurrentIOLockClass(IOUSBController_ExtraCurrentIOLockClass *this);
__int64 __fastcall IOUSBController::MetaClass::~MetaClass(IOUSBController::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_0();
int `global destructor keyed to'_a_0();
__int64 __fastcall IOUSBController::GetErrataBits(IOUSBController *this);
__int64 __fastcall CopyIOPCIDeviceParent(IOPCIDevice *); // idb
__int64 __fastcall GetDataPropertyValue(IORegistryEntry *, const char *, unsigned int *); // idb
__int64 __fastcall IOUSBControllerV3::GetErrata64Bits(IOUSBControllerV3 *this, unsigned __int16 a2, int a3, unsigned int a4);
int __fastcall IOUSBController::OpenPipe(__int64 a1, unsigned int a2, unsigned int a3, __int64 a4);
int __fastcall IOUSBController::ClosePipe(__int64 a1, unsigned int a2, __int64 a3);
int __fastcall IOUSBController::AbortPipe(__int64 a1, unsigned int a2, __int64 a3);
int __fastcall IOUSBController::ResetPipe(__int64 a1, unsigned int a2, __int64 a3);
int __fastcall IOUSBController::ClearPipeStall(__int64 a1, unsigned int a2, __int64 a3);
__int64 __fastcall IOUSBController::CheckForDisjointDescriptor(IOUSBController *this, IOUSBCommand *a2, unsigned __int16 a3);
void __fastcall DisjointCompletion(uintptr_t arg1, IOUSBCommand *this, unsigned int a3, unsigned int a4, __int64 a5, __int64 a6);
int __fastcall IOUSBController::Read(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5);
int __fastcall IOUSBController::Read(__int64 a1, __int64 a2, unsigned __int16 a3, __int64 a4, __int64 a5, unsigned int a6);
__int64 __fastcall IOUSBController::Read(IOUSBController *this, IOMemoryDescriptor *a2, __int16 a3, __int64 a4, __int64 a5, int a6, int a7, __int64 a8);
int __fastcall IOUSBController::Write(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5);
int __fastcall IOUSBController::Write(__int64 a1, __int64 a2, unsigned __int16 a3, __int64 a4, __int64 a5, unsigned int a6);
__int64 __fastcall IOUSBController::Write(IOUSBController *this, IOMemoryDescriptor *a2, __int16 a3, __int64 a4, __int64 a5, int a6, int a7, __int64 a8);
__int64 __fastcall IOUSBController::IsocIO(IOUSBController *this, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int16 a6, __int64 a7, __int64 a8);
__int64 __fastcall IOUSBController::IsocIO(IOUSBController *this, __int64 a2, __int64 a3, int a4, __int64 a5, __int16 a6, __int64 a7, __int64 a8, int a9);
__int64 __fastcall IOUSBInterface::MetaClass::MetaClass(IOUSBInterface::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBInterface::MetaClass::~MetaClass(IOUSBInterface::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBInterface::IOUSBInterface(__int64 a1);
__int64 __fastcall IOUSBInterface::IOUSBInterface(__int64 a1);
__int64 __fastcall IOUSBInterface::~IOUSBInterface(IOUSBInterface *__hidden this); // idb
__int64 __fastcall IOUSBInterface::~IOUSBInterface(IOUSBInterface *__hidden this); // idb
void __fastcall IOUSBInterface::~IOUSBInterface(IOUSBInterface *this);
__int64 __fastcall IOUSBInterface::getMetaClass(IOUSBInterface *__hidden this); // idb
__int64 __fastcall IOUSBInterface::MetaClass::MetaClass(IOUSBInterface::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBInterface::MetaClass::alloc(IOUSBInterface::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall IOUSBInterface::IOUSBInterface(__int64 a1);
__int64 __fastcall IOUSBInterface::IOUSBInterface(__int64 a1);
char __fastcall IOUSBInterface::start(IOUSBInterface *this, IOService *a2, const OSMetaClass *a3);
char __fastcall IOUSBInterface::open(IOUSBInterface *this, IOService *a2, unsigned int a3, void *a4);
__int64 __fastcall IOUSBInterface::CallSuperOpen(IOUSBInterface *__hidden this, OSObject *, void *, void *, void *, void *); // idb
// char __usercall IOUSBInterface::handleOpen@<al>(IOUSBInterface *this@<rdi>, IOService *a2@<rsi>, void *a3@<rcx>, char a4@<al>, unsigned int a5@<edx>);
int __fastcall IOUSBInterface::close(IOUSBInterface *this, IOService *a2, unsigned int a3);
int __fastcall IOUSBInterface::_AbortPipes(IOUSBInterface *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6);
__int64 __fastcall IOUSBInterface::CallSuperClose(IOUSBInterface *__hidden this, OSObject *, void *, void *, void *, void *); // idb
__int64 __fastcall IOUSBInterface::handleClose(IOUSBInterface *this, IOService *a2, unsigned int a3);
char __fastcall IOUSBInterface::handleIsOpen(IOUSBInterface *this, const IOService *a2);
__int64 __fastcall IOUSBInterface::message(IOUSBInterface *this, signed int a2, IOService *a3, void *a4);
int __fastcall IOUSBInterface::_ResetPipes(IOUSBInterface *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6);
int __fastcall IOUSBInterface::terminate(IOUSBInterface *this, unsigned int a2);
void __fastcall IOUSBInterface::stop(IOUSBInterface *this, IOService *a2);
void __fastcall IOUSBInterface::finalize(IOUSBInterface *this);
void __fastcall IOUSBInterface::free(IOUSBInterface *this);
int __fastcall IOUSBInterface::joinPMtree(IOUSBInterface *this, IOService *a2);
__int64 __fastcall IOUSBInterface::withDescriptors(__int64 a1, unsigned __int64 a2);
__int64 __fastcall IOUSBInterface::hex2char(IOUSBInterface *this);
char __fastcall IOUSBInterface::init(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBInterface::SetProperties(IOUSBInterface *__hidden this); // idb
int __fastcall IOUSBInterface::ClosePipes(IOUSBInterface *this);
__int64 __fastcall IOUSBInterface::_ClosePipes(IOUSBInterface *__hidden this, OSObject *, void *, void *, void *, void *); // idb
int __fastcall IOUSBInterface::UnlinkPipes(IOUSBInterface *this);
int __fastcall IOUSBInterface::ResetPipes(IOUSBInterface *this, __int64 a2, const OSMetaClass *a3);
int __fastcall IOUSBInterface::AbortPipesGated(IOUSBInterface *this, __int64 a2, const OSMetaClass *a3);
__int64 __fastcall IOUSBInterface::ClosePipesGated(IOUSBInterface *this, char a2, const OSMetaClass *a3);
__int64 __fastcall IOUSBInterface::_ReopenPipes(IOUSBInterface *__hidden this, OSObject *, void *, void *, void *, void *); // idb
__int64 __fastcall IOUSBInterface::ReopenPipesGated(IOUSBInterface *this, __int64 a2, const OSMetaClass *a3);
int __fastcall IOUSBInterface::ReopenPipes(IOUSBInterface *this);
// __int64 __usercall IOUSBInterface::CreatePipes@<rax>(IOUSBInterface *this@<rdi>, char a2@<al>);
__int64 __fastcall IOUSBInterface::FindNextAltInterface(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBInterface::FindNextPipe(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBInterface::FindNextPipe(__int64 a1, __int64 a2, __int64 a3, unsigned __int8 a4);
__int64 __fastcall IOUSBInterface::_FindNextPipe(IOUSBInterface *__hidden this, OSObject *, void *, void *, void *, void *); // idb
__int64 __fastcall IOUSBInterface::FindNextPipeGated(__int64 a1, __int64 a2, const OSMetaClass *a3, char a4);
const void *__fastcall IOUSBInterface::FindNextAssociatedDescriptor(IOUSBInterface *this, const void *a2, unsigned __int8 a3);
int __fastcall IOUSBInterface::SetAlternateInterface(IOUSBInterface *this, IOService *a2, unsigned __int16 a3);
char __fastcall IOUSBInterface::matchPropertyTable(IOUSBInterface *this, OSDictionary *a2, int *a3);
__int64 __fastcall IOUSBInterface::GetPipeObj(IOUSBInterface *__hidden this, unsigned __int8); // idb
__int64 __fastcall IOUSBInterface::_GetPipeObj(IOUSBInterface *__hidden this, OSObject *, void *, void *, void *, void *); // idb
__int64 __fastcall IOUSBInterface::GetPipeObjGated(IOUSBInterface *this, unsigned int a2);
__int64 __fastcall IOUSBInterface::GetConfigValue(IOUSBInterface *__hidden this); // idb
__int64 __fastcall IOUSBInterface::GetDevice(IOUSBInterface *__hidden this); // idb
__int64 __fastcall IOUSBInterface::GetInterfaceNumber(IOUSBInterface *__hidden this); // idb
__int64 __fastcall IOUSBInterface::GetAlternateSetting(IOUSBInterface *__hidden this); // idb
__int64 __fastcall IOUSBInterface::GetNumEndpoints(IOUSBInterface *__hidden this); // idb
__int64 __fastcall IOUSBInterface::GetInterfaceClass(IOUSBInterface *__hidden this); // idb
__int64 __fastcall IOUSBInterface::GetInterfaceSubClass(IOUSBInterface *__hidden this); // idb
__int64 __fastcall IOUSBInterface::GetInterfaceProtocol(IOUSBInterface *__hidden this); // idb
__int64 __fastcall IOUSBInterface::GetInterfaceStringIndex(IOUSBInterface *__hidden this); // idb
int __fastcall IOUSBInterface::DeviceRequest(__int64 a1);
int __fastcall IOUSBInterface::DeviceRequest(__int64 a1);
int __fastcall IOUSBInterface::GetEndpointProperties(IOUSBInterface *this, char a2, char a3, char a4, unsigned __int8 *a5, unsigned __int16 *a6, unsigned __int8 *a7);
__int64 __fastcall IOUSBInterface::RememberStreams(IOUSBInterface *__hidden this); // idb
__int64 __fastcall IOUSBInterface::_RememberStreams(IOUSBInterface *__hidden this, OSObject *, void *, void *, void *, void *); // idb
int __fastcall IOUSBInterface::RememberStreamsGated(IOUSBInterface *this, __int64 a2, const OSMetaClass *a3);
__int64 __fastcall IOUSBInterface::RecreateStreams(IOUSBInterface *__hidden this); // idb
int __fastcall IOUSBInterface::_RecreateStreams(IOUSBInterface *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6);
int __fastcall IOUSBInterface::RecreateStreamsGated(IOUSBInterface *this, __int64 a2, const OSMetaClass *a3);
__int64 __fastcall IOUSBInterface::CalculateFullMaxPacketSize(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBInterface::GetEndpointPropertiesV3(__int64 a1, __int64 a2);
int __fastcall IOUSBInterface::GetInterfaceStatus(IOUSBInterface *this, unsigned __int16 *a2);
int __fastcall IOUSBInterface::SetFunctionSuspendFeature(IOUSBInterface *this, __int16 a2);
// __int64 __usercall IOUSBInterface::EnableRemoteWake@<rax>(IOUSBInterface *this@<rdi>, __int64 a2@<rax>, unsigned __int8 a3@<sil>);
__int64 __fastcall IOUSBInterface::_RESERVEDIOUSBInterface10(IOUSBInterface *__hidden this); // idb
__int64 __fastcall IOUSBInterface::_RESERVEDIOUSBInterface11(IOUSBInterface *__hidden this); // idb
__int64 __fastcall IOUSBInterface::_RESERVEDIOUSBInterface12(IOUSBInterface *__hidden this); // idb
__int64 __fastcall IOUSBInterface::_RESERVEDIOUSBInterface13(IOUSBInterface *__hidden this); // idb
__int64 __fastcall IOUSBInterface::_RESERVEDIOUSBInterface14(IOUSBInterface *__hidden this); // idb
__int64 __fastcall IOUSBInterface::_RESERVEDIOUSBInterface15(IOUSBInterface *__hidden this); // idb
__int64 __fastcall IOUSBInterface::_RESERVEDIOUSBInterface16(IOUSBInterface *__hidden this); // idb
__int64 __fastcall IOUSBInterface::_RESERVEDIOUSBInterface17(IOUSBInterface *__hidden this); // idb
__int64 __fastcall IOUSBInterface::_RESERVEDIOUSBInterface18(IOUSBInterface *__hidden this); // idb
__int64 __fastcall IOUSBInterface::_RESERVEDIOUSBInterface19(IOUSBInterface *__hidden this); // idb
__int64 __fastcall IOUSBInterface::MetaClass::~MetaClass(IOUSBInterface::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_1();
__int64 `global destructor keyed to'_a_1();
__int64 __fastcall IOUSBNub::MetaClass::MetaClass(IOUSBNub::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBNub::MetaClass::~MetaClass(IOUSBNub::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBNub::IOUSBNub(__int64 a1);
__int64 __fastcall IOUSBNub::IOUSBNub(__int64 a1);
__int64 __fastcall IOUSBNub::~IOUSBNub(IOUSBNub *__hidden this); // idb
__int64 __fastcall IOUSBNub::~IOUSBNub(IOUSBNub *__hidden this); // idb
void __fastcall IOUSBNub::~IOUSBNub(IOUSBNub *this);
__int64 __fastcall IOUSBNub::getMetaClass(IOUSBNub *__hidden this); // idb
__int64 __fastcall IOUSBNub::MetaClass::MetaClass(IOUSBNub::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBNub::initialize(IOUSBNub *this, const char *a2);
__int64 __fastcall IOUSBNub::MetaClass::alloc(IOUSBNub::MetaClass *__hidden this); // idb
char __fastcall IOUSBNub::USBCompareProperty(IOUSBNub *this, OSDictionary *a2, const OSSymbol *a3);
char __fastcall IOUSBNub::USBComparePropertyInArray(IOUSBNub *this, OSDictionary *a2, const char *a3, const char *a4, unsigned int *a5);
char __fastcall IOUSBNub::USBComparePropertyInArrayWithMask(IOUSBNub *this, OSDictionary *a2, const char *a3, const char *a4, const char *a5, unsigned int *a6);
int __fastcall IOUSBNub::IsWildCardMatch(IOUSBNub *this, OSDictionary *a2, const char *a3);
bool __fastcall IOUSBNub::USBComparePropertyWithMask(IOUSBNub *this, OSDictionary *a2, const char *a3, const char *a4);
__int64 __fastcall IOUSBNub::MetaClass::~MetaClass(IOUSBNub::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_2();
__int64 `global destructor keyed to'_a_2();
__int64 __fastcall IOUSBPipe::MetaClass::MetaClass(IOUSBPipe::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBPipe::MetaClass::~MetaClass(IOUSBPipe::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBPipe::IOUSBPipe(__int64 a1);
__int64 __fastcall IOUSBPipe::IOUSBPipe(__int64 a1);
__int64 __fastcall IOUSBPipe::~IOUSBPipe(IOUSBPipe *__hidden this); // idb
__int64 __fastcall IOUSBPipe::~IOUSBPipe(IOUSBPipe *__hidden this); // idb
void __fastcall IOUSBPipe::~IOUSBPipe(IOUSBPipe *this);
__int64 __fastcall IOUSBPipe::getMetaClass(IOUSBPipe *__hidden this); // idb
__int64 __fastcall IOUSBPipe::MetaClass::MetaClass(IOUSBPipe::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBPipe::MetaClass::alloc(IOUSBPipe::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall IOUSBPipe::IOUSBPipe(__int64 a1);
__int64 __fastcall IOUSBPipe::IOUSBPipe(__int64 a1);
char __fastcall IOUSBPipe::InitToEndpoint(uintptr_t arg1, uintptr_t arg2, unsigned __int8 a3, unsigned __int16 a4, __int64 a5, __int64 a6, __int64 a7);
__int64 __fastcall IOUSBPipe::ToEndpoint(__int64 a1, unsigned __int64 a2, __int64 a3, __int64 a4);
int __fastcall IOUSBPipe::free(IOUSBPipe *this);
__int64 __fastcall IOUSBPipe::Abort(uintptr_t arg1, __int64 a2, const OSMetaClass *a3);
int __fastcall IOUSBPipe::Reset(IOUSBPipe *this);
int __fastcall IOUSBPipe::ClosePipe(IOUSBPipe *this);
int __fastcall IOUSBPipe::ClearStall(IOUSBPipe *this);
__int64 __fastcall IOUSBPipe::ClearPipeStall(uintptr_t arg1, unsigned __int8 a2);
int __fastcall IOUSBPipe::SetPipePolicy(IOUSBPipe *this, unsigned __int16 a2, unsigned __int8 a3);
int __fastcall IOUSBPipe::Read(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall IOUSBPipe::Read(__int64 a1, __int64 a2, unsigned int a3, unsigned int a4, __int64 a5);
__int64 __fastcall IOUSBPipe::Read(uintptr_t arg1, __int64 a2, const OSMetaClass *a3, unsigned int a4, uintptr_t a5, __int64 a6, __int64 a7);
__int64 __fastcall IOUSBPipe::Read(uintptr_t arg1, __int64 a2, const OSMetaClass *a3, unsigned int a4, uintptr_t a5, __int64 a6, __int64 a7);
int __fastcall IOUSBPipe::Write(__int64 a1, __int64 a2, __int64 a3);
int __fastcall IOUSBPipe::Write(__int64 a1, __int64 a2, unsigned int a3, unsigned int a4, __int64 a5);
__int64 __fastcall IOUSBPipe::Write(uintptr_t arg1, __int64 a2, const OSMetaClass *a3, unsigned int a4, uintptr_t a5, __int64 a6);
__int64 __fastcall IOUSBPipe::Read(uintptr_t arg1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
__int64 __fastcall IOUSBPipe::Write(uintptr_t arg1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
__int64 __fastcall IOUSBPipe::Read(uintptr_t arg1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
__int64 __fastcall IOUSBPipe::Write(uintptr_t arg1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
int __fastcall IOUSBPipe::ControlRequest(__int64 a1, __int64 a2, __int64 a3);
signed int __fastcall IOUSBPipe::ControlRequest(uintptr_t arg1, __int64 a2, unsigned int a3, __int64 a4, __int64 a5);
int __fastcall IOUSBPipe::ControlRequest(__int64 a1, __int64 a2, __int64 a3);
signed int __fastcall IOUSBPipe::ControlRequest(uintptr_t arg1, __int64 a2, unsigned int a3, __int64 a4, __int64 a5);
char *__fastcall IOUSBPipe::GetEndpoint(IOUSBPipe *this);
__int64 __fastcall IOUSBPipe::GetEndpointDescriptor(IOUSBPipe *__hidden this); // idb
__int64 __fastcall IOUSBPipe::GetDirection(IOUSBPipe *__hidden this); // idb
__int64 __fastcall IOUSBPipe::GetType(IOUSBPipe *__hidden this); // idb
__int64 __fastcall IOUSBPipe::GetEndpointNumber(IOUSBPipe *__hidden this); // idb
__int64 __fastcall IOUSBPipe::GetAddress(IOUSBPipe *__hidden this); // idb
__int64 __fastcall IOUSBPipe::GetMaxPacketSize(IOUSBPipe *__hidden this); // idb
__int64 __fastcall IOUSBPipe::GetInterval(IOUSBPipe *__hidden this); // idb
__int64 __fastcall IOUSBPipe::GetStatus(IOUSBPipe *__hidden this); // idb
__int64 __fastcall IOUSBPipe::GetPipeStatus(IOUSBPipe *__hidden this); // idb
__int64 __fastcall IOUSBPipe::GetUsageType(IOUSBPipe *__hidden this); // idb
__int64 __fastcall IOUSBPipe::GetSyncType(IOUSBPipe *__hidden this); // idb
__int64 IOUSBPipe::InitToEndpoint();
__int64 IOUSBPipe::ToEndpoint();
__int64 IOUSBPipe::ToEndpoint();
__int64 __fastcall IOUSBPipe::_RESERVEDIOUSBPipe15(IOUSBPipe *__hidden this); // idb
__int64 __fastcall IOUSBPipe::_RESERVEDIOUSBPipe16(IOUSBPipe *__hidden this); // idb
__int64 __fastcall IOUSBPipe::_RESERVEDIOUSBPipe17(IOUSBPipe *__hidden this); // idb
__int64 __fastcall IOUSBPipe::_RESERVEDIOUSBPipe18(IOUSBPipe *__hidden this); // idb
__int64 __fastcall IOUSBPipe::_RESERVEDIOUSBPipe19(IOUSBPipe *__hidden this); // idb
__int64 __fastcall IOUSBPipe::MetaClass::~MetaClass(IOUSBPipe::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_3();
__int64 `global destructor keyed to'_a_3();
__int64 __fastcall IOUSBRootHubDevice::MetaClass::MetaClass(IOUSBRootHubDevice::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBRootHubDevice::MetaClass::~MetaClass(IOUSBRootHubDevice::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBRootHubDevice::IOUSBRootHubDevice(__int64 a1);
__int64 __fastcall IOUSBRootHubDevice::IOUSBRootHubDevice(__int64 a1);
__int64 __fastcall IOUSBRootHubDevice::~IOUSBRootHubDevice(IOUSBRootHubDevice *__hidden this); // idb
__int64 __fastcall IOUSBRootHubDevice::~IOUSBRootHubDevice(IOUSBRootHubDevice *__hidden this); // idb
void __fastcall IOUSBRootHubDevice::~IOUSBRootHubDevice(IOUSBRootHubDevice *this);
__int64 __fastcall IOUSBRootHubDevice::getMetaClass(IOUSBRootHubDevice *__hidden this); // idb
__int64 __fastcall IOUSBRootHubDevice::MetaClass::MetaClass(IOUSBRootHubDevice::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBRootHubDevice::MetaClass::alloc(IOUSBRootHubDevice::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall IOUSBRootHubDevice::IOUSBRootHubDevice(__int64 a1);
__int64 __fastcall IOUSBRootHubDevice::IOUSBRootHubDevice(__int64 a1);
__int64 __fastcall IOUSBRootHubDevice::NewRootHubDevice(IOUSBRootHubDevice *this, unsigned __int64 a2);
char __fastcall IOUSBRootHubDevice::init(IOUSBRootHubDevice *this);
char __fastcall IOUSBRootHubDevice::InitializeCharacteristics(IOUSBRootHubDevice *this);
char __fastcall IOUSBRootHubDevice::start(IOUSBRootHubDevice *this, IOService *a2, const OSMetaClass *a3);
void __fastcall IOUSBRootHubDevice::stop(IOUSBRootHubDevice *this, IOService *a2);
void __fastcall IOUSBRootHubDevice::free(IOUSBRootHubDevice *this);
__int64 __fastcall IOUSBRootHubDevice::GatedDeviceRequest(IOUSBRootHubDevice *__hidden this, OSObject *, void *, void *, void *, void *); // idb
__int64 __fastcall IOUSBRootHubDevice::DeviceRequestWorker(__int64 a1, __int64 a2);
int __fastcall IOUSBRootHubDevice::DeviceRequest(__int64 a1, __int64 a2, __int64 a3);
signed __int64 __fastcall IOUSBRootHubDevice::DeviceRequest(__int64 a1, __int64 a2, unsigned int a3, unsigned int a4, __int64 a5);
char __fastcall IOUSBRootHubDevice::IsRootHub(IOUSBRootHubDevice *this);
__int64 __fastcall IOUSBRootHubDevice::RequestExtraPower(IOUSBRootHubDevice *this, signed __int64 a2, int a3);
__int64 __fastcall IOUSBRootHubDevice::RequestExtraWakePower(IOUSBRootHubDevice *this, int a2, int a3, bool *a4);
__int64 __fastcall IOUSBRootHubDevice::ReturnExtraPower(IOUSBRootHubDevice *this, int a2, int a3);
int __fastcall IOUSBRootHubDevice::ReturnExtraWakePower(IOUSBRootHubDevice *this, int a2, int a3);
void __fastcall IOUSBRootHubDevice::InitializeExtraPower(IOUSBRootHubDevice *this);
void __fastcall IOUSBRootHubDevice::SetSleepCurrent(IOUSBRootHubDevice *this);
void __fastcall IOUSBRootHubDevice::GetSleepCurrent(IOUSBRootHubDevice *this);
__int64 __fastcall IOUSBRootHubDevice::RequestSleepPower(IOUSBRootHubDevice *this, int a2);
int __fastcall IOUSBRootHubDevice::ReturnSleepPower(IOUSBRootHubDevice *this, unsigned int a2);
__int64 __fastcall IOUSBRootHubDevice::GetDeviceInformation(IOUSBRootHubDevice *__hidden this, unsigned int *); // idb
int __fastcall IOUSBRootHubDevice::SendExtraPowerMessage(IOUSBRootHubDevice *this, int a2, OSDictionary *a3);
__int64 __fastcall IOUSBRootHubDevice::MetaClass::~MetaClass(IOUSBRootHubDevice::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_4();
int `global destructor keyed to'_a_4();
__int64 __fastcall IOUSBCommand::MetaClass::MetaClass(IOUSBCommand::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBCommand::MetaClass::~MetaClass(IOUSBCommand::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBCommand::IOUSBCommand(IOCommand *a1, const OSMetaClass *a2);
__int64 __fastcall IOUSBCommand::IOUSBCommand(IOCommand *a1, const OSMetaClass *a2);
__int64 __fastcall IOUSBCommand::~IOUSBCommand(IOUSBCommand *__hidden this); // idb
__int64 __fastcall IOUSBCommand::~IOUSBCommand(IOUSBCommand *__hidden this); // idb
void __fastcall IOUSBCommand::~IOUSBCommand(IOUSBCommand *this);
__int64 __fastcall IOUSBCommand::getMetaClass(IOUSBCommand *__hidden this); // idb
__int64 __fastcall IOUSBCommand::MetaClass::MetaClass(IOUSBCommand::MetaClass *__hidden this); // idb
IOCommand *__fastcall IOUSBCommand::MetaClass::alloc(IOUSBCommand::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall IOUSBCommand::IOUSBCommand(IOCommand *a1);
__int64 __fastcall IOUSBCommand::IOUSBCommand(IOCommand *a1);
__int64 __fastcall IOUSBIsocCommand::MetaClass::MetaClass(IOUSBIsocCommand::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBIsocCommand::MetaClass::~MetaClass(IOUSBIsocCommand::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBIsocCommand::IOUSBIsocCommand(IOCommand *a1, const OSMetaClass *a2);
__int64 __fastcall IOUSBIsocCommand::IOUSBIsocCommand(IOCommand *a1, const OSMetaClass *a2);
__int64 __fastcall IOUSBIsocCommand::~IOUSBIsocCommand(IOUSBIsocCommand *__hidden this); // idb
__int64 __fastcall IOUSBIsocCommand::~IOUSBIsocCommand(IOUSBIsocCommand *__hidden this); // idb
void __fastcall IOUSBIsocCommand::~IOUSBIsocCommand(IOUSBIsocCommand *this);
__int64 __fastcall IOUSBIsocCommand::getMetaClass(IOUSBIsocCommand *__hidden this); // idb
__int64 __fastcall IOUSBIsocCommand::MetaClass::MetaClass(IOUSBIsocCommand::MetaClass *__hidden this); // idb
IOCommand *__fastcall IOUSBIsocCommand::MetaClass::alloc(IOUSBIsocCommand::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall IOUSBIsocCommand::IOUSBIsocCommand(IOCommand *a1);
__int64 __fastcall IOUSBIsocCommand::IOUSBIsocCommand(IOCommand *a1);
IOCommand *__fastcall IOUSBCommand::NewCommand(IOUSBCommand *this, unsigned __int64 a2);
char __fastcall IOUSBCommand::init(IOUSBCommand *this);
int __fastcall IOUSBCommand::free(IOUSBCommand *this);
void __fastcall IOUSBCommand::SetSelector(__int64 a1, int a2);
void __fastcall IOUSBCommand::SetRequest(__int64 a1, __int64 a2);
void __fastcall IOUSBCommand::SetAddress(IOUSBCommand *this, __int16 a2);
void __fastcall IOUSBCommand::SetEndpoint(IOUSBCommand *this, char a2);
void __fastcall IOUSBCommand::SetDirection(IOUSBCommand *this, char a2);
void __fastcall IOUSBCommand::SetType(IOUSBCommand *this, char a2);
void __fastcall IOUSBCommand::SetBufferRounding(IOUSBCommand *this, char a2);
void __fastcall IOUSBCommand::SetBuffer(IOUSBCommand *this, IOMemoryDescriptor *a2);
// __int64 __usercall IOUSBCommand::SetUSLCompletion@<rax>(__int64 a1@<rdi>, __int64 a2, __int64 a3, __int64 a4);
// __int64 __usercall IOUSBCommand::SetClientCompletion@<rax>(__int64 a1@<rdi>, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall IOUSBCommand::SetDataRemaining(IOUSBCommand *this, int a2);
__int64 __fastcall IOUSBCommand::SetStage(IOUSBCommand *this, char a2);
__int64 __fastcall IOUSBCommand::SetStatus(IOUSBCommand *__hidden this, int); // idb
void __fastcall IOUSBCommand::SetOrigBuffer(IOUSBCommand *this, IOMemoryDescriptor *a2);
// __int64 __usercall IOUSBCommand::SetDisjointCompletion@<rax>(__int64 a1@<rdi>, __int64 a2, __int64 a3, __int64 a4);
void __fastcall IOUSBCommand::SetDblBufLength(IOUSBCommand *this, __int64 a2);
void __fastcall IOUSBCommand::SetNoDataTimeout(IOUSBCommand *this, int a2);
void __fastcall IOUSBCommand::SetCompletionTimeout(IOUSBCommand *this, int a2);
void __fastcall IOUSBCommand::SetUIMScratch(IOUSBCommand *this, unsigned int a2, int a3);
void __fastcall IOUSBCommand::SetUIMScratch64(IOUSBCommand *this, unsigned int a2, __int64 a3);
__int64 __fastcall IOUSBCommand::SetBT(IOUSBCommand *__hidden this, unsigned int, void *); // idb
__int64 __fastcall IOUSBCommand::SetReqCount(IOUSBCommand *this, __int64 a2);
__int64 __fastcall IOUSBCommand::SetRequestMemoryDescriptor(IOUSBCommand *this, IOMemoryDescriptor *a2);
__int64 __fastcall IOUSBCommand::SetBufferMemoryDescriptor(IOUSBCommand *this, IOMemoryDescriptor *a2);
__int64 __fastcall IOUSBCommand::SetMultiTransferTransaction(IOUSBCommand *this, char a2);
__int64 __fastcall IOUSBCommand::SetFinalTransferInTransaction(IOUSBCommand *this, char a2);
__int64 __fastcall IOUSBCommand::SetUseTimeStamp(IOUSBCommand *this, char a2);
__int64 __fastcall IOUSBCommand::SetTimeStamp(IOUSBCommand *this, __int64 a2);
__int64 __fastcall IOUSBCommand::SetIsSyncTransfer(IOUSBCommand *this, char a2);
__int64 __fastcall IOUSBCommand::SetBufferUSBCommand(IOUSBCommand *__hidden this, IOUSBCommand *); // idb
__int64 __fastcall IOUSBCommand::GetSelector(IOUSBCommand *__hidden this); // idb
__int64 __fastcall IOUSBCommand::GetRequest(IOUSBCommand *__hidden this); // idb
__int64 __fastcall IOUSBCommand::GetAddress(IOUSBCommand *__hidden this); // idb
__int64 __fastcall IOUSBCommand::GetEndpoint(IOUSBCommand *__hidden this); // idb
__int64 __fastcall IOUSBCommand::GetDirection(IOUSBCommand *__hidden this); // idb
__int64 __fastcall IOUSBCommand::GetType(IOUSBCommand *__hidden this); // idb
char __fastcall IOUSBCommand::GetBufferRounding(IOUSBCommand *this);
__int64 __fastcall IOUSBCommand::GetBuffer(IOUSBCommand *__hidden this); // idb
IOUSBCommand *__fastcall IOUSBCommand::GetUSLCompletion(IOUSBCommand *this, __int64 a2);
IOUSBCommand *__fastcall IOUSBCommand::GetClientCompletion(IOUSBCommand *this, __int64 a2);
__int64 __fastcall IOUSBCommand::GetDataRemaining(IOUSBCommand *__hidden this); // idb
__int64 __fastcall IOUSBCommand::GetStage(IOUSBCommand *__hidden this); // idb
__int64 __fastcall IOUSBCommand::GetStatus(IOUSBCommand *__hidden this); // idb
__int64 __fastcall IOUSBCommand::GetOrigBuffer(IOUSBCommand *__hidden this); // idb
IOUSBCommand *__fastcall IOUSBCommand::GetDisjointCompletion(IOUSBCommand *this, __int64 a2);
__int64 __fastcall IOUSBCommand::GetDblBufLength(IOUSBCommand *__hidden this); // idb
__int64 __fastcall IOUSBCommand::GetNoDataTimeout(IOUSBCommand *__hidden this); // idb
__int64 __fastcall IOUSBCommand::GetCompletionTimeout(IOUSBCommand *__hidden this); // idb
__int64 __fastcall IOUSBCommand::GetUIMScratch(IOUSBCommand *__hidden this, unsigned int); // idb
__int64 __fastcall IOUSBCommand::GetUIMScratch64(IOUSBCommand *__hidden this, unsigned int); // idb
__int64 __fastcall IOUSBCommand::GetReqCount(IOUSBCommand *__hidden this); // idb
__int64 __fastcall IOUSBCommand::GetRequestMemoryDescriptor(IOUSBCommand *__hidden this); // idb
__int64 __fastcall IOUSBCommand::GetBufferMemoryDescriptor(IOUSBCommand *__hidden this); // idb
char __fastcall IOUSBCommand::GetMultiTransferTransaction(IOUSBCommand *this);
char __fastcall IOUSBCommand::GetFinalTransferInTransaction(IOUSBCommand *this);
char __fastcall IOUSBCommand::GetUseTimeStamp(IOUSBCommand *this);
__int64 __fastcall IOUSBCommand::GetTimeStamp(IOUSBCommand *__hidden this); // idb
char __fastcall IOUSBCommand::GetIsSyncTransfer(IOUSBCommand *this);
IOCommand *__fastcall IOUSBIsocCommand::NewCommand(IOUSBIsocCommand *this, unsigned __int64 a2);
char __fastcall IOUSBIsocCommand::init(IOUSBIsocCommand *this);
int __fastcall IOUSBIsocCommand::free(IOUSBIsocCommand *this);
__int64 __fastcall IOUSBCommandPool::MetaClass::MetaClass(IOUSBCommandPool::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBCommandPool::MetaClass::~MetaClass(IOUSBCommandPool::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBCommandPool::IOUSBCommandPool(IOCommandPool *a1, const OSMetaClass *a2);
__int64 __fastcall IOUSBCommandPool::IOUSBCommandPool(IOCommandPool *a1, const OSMetaClass *a2);
__int64 __fastcall IOUSBCommandPool::~IOUSBCommandPool(IOUSBCommandPool *__hidden this); // idb
__int64 __fastcall IOUSBCommandPool::~IOUSBCommandPool(IOUSBCommandPool *__hidden this); // idb
void __fastcall IOUSBCommandPool::~IOUSBCommandPool(IOUSBCommandPool *this);
__int64 __fastcall IOUSBCommandPool::getMetaClass(IOUSBCommandPool *__hidden this); // idb
__int64 __fastcall IOUSBCommandPool::MetaClass::MetaClass(IOUSBCommandPool::MetaClass *__hidden this); // idb
IOCommandPool *__fastcall IOUSBCommandPool::MetaClass::alloc(IOUSBCommandPool::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall IOUSBCommandPool::IOUSBCommandPool(IOCommandPool *a1);
__int64 __fastcall IOUSBCommandPool::IOUSBCommandPool(IOCommandPool *a1);
IOCommandPool *__fastcall IOUSBCommandPool::withWorkLoop(IOUSBCommandPool *this, IOWorkLoop *a2);
int __fastcall IOUSBCommandPool::gatedGetCommand(IOUSBCommandPool *this, IOCommand **a2, unsigned __int8 a3);
__int64 __fastcall IOUSBCommandPool::gatedReturnCommand(IOUSBCommandPool *this, IOCommand *a2, const OSMetaClass *a3);
__int64 __fastcall IOUSBCommand::MetaClass::~MetaClass(IOUSBCommand::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBIsocCommand::MetaClass::~MetaClass(IOUSBIsocCommand::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBCommandPool::MetaClass::~MetaClass(IOUSBCommandPool::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_5();
__int64 `global destructor keyed to'_a_5();
__int64 __fastcall IOUSBInterfaceIterator::MetaClass::MetaClass(IOUSBInterfaceIterator::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceIterator::MetaClass::~MetaClass(IOUSBInterfaceIterator::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceIterator::IOUSBInterfaceIterator(__int64 a1);
__int64 __fastcall IOUSBInterfaceIterator::IOUSBInterfaceIterator(__int64 a1);
__int64 __fastcall IOUSBInterfaceIterator::~IOUSBInterfaceIterator(IOUSBInterfaceIterator *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceIterator::~IOUSBInterfaceIterator(IOUSBInterfaceIterator *__hidden this); // idb
void __fastcall IOUSBInterfaceIterator::~IOUSBInterfaceIterator(IOUSBInterfaceIterator *this);
__int64 __fastcall IOUSBInterfaceIterator::getMetaClass(IOUSBInterfaceIterator *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceIterator::MetaClass::MetaClass(IOUSBInterfaceIterator::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceIterator::MetaClass::alloc(IOUSBInterfaceIterator::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall IOUSBInterfaceIterator::IOUSBInterfaceIterator(__int64 a1);
__int64 __fastcall IOUSBInterfaceIterator::IOUSBInterfaceIterator(__int64 a1);
char __fastcall IOUSBInterfaceIterator::init(__int64 a1, __int64 a2, __int64 a3);
int __fastcall IOUSBInterfaceIterator::free(IOUSBInterfaceIterator *this);
int __fastcall IOUSBInterfaceIterator::reset(IOUSBInterfaceIterator *this);
char __fastcall IOUSBInterfaceIterator::isValid(IOUSBInterfaceIterator *this);
__int64 __fastcall IOUSBInterfaceIterator::getNextObject(IOUSBInterfaceIterator *__hidden this); // idb
__int64 __fastcall IOUSBDevice::MetaClass::MetaClass(IOUSBDevice::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBDevice::MetaClass::~MetaClass(IOUSBDevice::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBDevice::IOUSBDevice(__int64 a1);
__int64 __fastcall IOUSBDevice::IOUSBDevice(__int64 a1);
__int64 __fastcall IOUSBDevice::~IOUSBDevice(IOUSBDevice *__hidden this); // idb
__int64 __fastcall IOUSBDevice::~IOUSBDevice(IOUSBDevice *__hidden this); // idb
void __fastcall IOUSBDevice::~IOUSBDevice(IOUSBDevice *this);
__int64 __fastcall IOUSBDevice::getMetaClass(IOUSBDevice *__hidden this); // idb
__int64 __fastcall IOUSBDevice::MetaClass::MetaClass(IOUSBDevice::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBDevice::MetaClass::alloc(IOUSBDevice::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall IOUSBDevice::IOUSBDevice(__int64 a1);
__int64 __fastcall IOUSBDevice::IOUSBDevice(__int64 a1);
void __fastcall IOUSBDevice::init(IOUSBDevice *this);
char __fastcall IOUSBDevice::start(IOUSBDevice *this, uintptr_t arg2);
int __fastcall IOUSBDevice::DoMessageClientsEntry(IOUSBDevice *this, OSObject *a2, void *a3);
int __fastcall IOUSBDevice::ProcessPortReEnumerateEntry(IOUSBDevice *this, OSObject *a2, void *a3);
char __fastcall IOUSBDevice::handleIsOpen(IOUSBDevice *this, const IOService *a2, const OSMetaClass *a3);
char __fastcall IOUSBDevice::handleOpen(IOUSBDevice *this, IOService *a2, const OSMetaClass *a3, void *a4);
int __fastcall IOUSBDevice::handleClose(IOUSBDevice *this, IOService *a2, const OSMetaClass *a3);
char __fastcall IOUSBDevice::terminate(IOUSBDevice *this, unsigned int a2);
int __fastcall IOUSBDevice::TerminateInterfaces(IOUSBDevice *this, char a2);
void __fastcall IOUSBDevice::requestTerminate(IOUSBDevice *this, IOService *a2);
__int64 __fastcall IOUSBDevice::message(IOUSBDevice *this, __int64 a2, IOService *a3, void *a4);
void __fastcall IOUSBDevice::stop(IOUSBDevice *this, IOService *a2);
void __fastcall IOUSBDevice::finalize(IOUSBDevice *this);
void __fastcall IOUSBDevice::free(IOUSBDevice *this);
int __fastcall IOUSBDevice::joinPMtree(IOUSBDevice *this, IOService *a2);
__int64 __fastcall IOUSBDevice::NewDevice(IOUSBDevice *this, unsigned __int64 a2);
char __fastcall IOUSBDevice::init(IOUSBDevice *this, __int16 a2, int a3, char a4, char a5);
__int64 __fastcall IOUSBDevice::SetProperties(IOUSBDevice *__hidden this); // idb
__int64 __fastcall IOUSBDevice::GetInterfacePowerParent(IOUSBDevice *__hidden this); // idb
__int64 __fastcall IOUSBDevice::GetChildLocationID(IOUSBDevice *this, unsigned int a2, char a3);
__int64 __fastcall IOUSBDevice::ResetDevice(IOUSBDevice *__hidden this); // idb
__int64 __fastcall IOUSBDevice::_ResetDevice(IOUSBDevice *__hidden this, OSObject *, void *, void *, void *, void *); // idb
__int64 __fastcall IOUSBDevice::ReEnumerateDevice(IOUSBDevice *this, int a2);
__int64 __fastcall IOUSBDevice::_ReEnumerateDevice(IOUSBDevice *__hidden this, OSObject *, void *, void *, void *, void *); // idb
uintptr_t __fastcall IOUSBDevice::FindConfig(uintptr_t arg1, unsigned __int8 a2, unsigned __int8 *a3);
__int64 __fastcall IOUSBDevice::FindNextDescriptor(uintptr_t arg1, const void *, unsigned __int8); // idb
__int64 __fastcall IOUSBDevice::FindNextInterfaceDescriptor(uintptr_t a1, uintptr_t a2, uintptr_t a3, __int64 a4, __int64 a5);
__int64 __fastcall IOUSBDevice::FindNextInterface(__int64 a1, OSMetaClassBase *a2, const OSMetaClass *a3);
__int64 __fastcall IOUSBDevice::CreateInterfaceIterator(__int64 a1, unsigned __int64 a2);
uintptr_t __fastcall IOUSBDevice::GetFullConfigurationDescriptor(IOUSBDevice *this, unsigned __int8 a2);
__int64 __fastcall IOUSBDevice::TakeGetConfigLock(IOUSBDevice *this); // idb
__int64 __fastcall IOUSBDevice::ReleaseGetConfigLock(IOUSBDevice *this); // idb
__int64 __fastcall IOUSBDevice::GetDeviceDescriptor(uintptr_t arg1, __int64 a2, unsigned int a3);
__int64 __fastcall IOUSBDevice::GetConfigDescriptor(uintptr_t arg1, __int16 a2, void *a3, unsigned int a4);
int __fastcall IOUSBDevice::RegisterInterfaces(IOUSBDevice *this);
int __fastcall IOUSBDevice::SetConfiguration(IOUSBDevice *this, IOService *a2, __int64 a3, unsigned __int8 a4);
__int64 __fastcall IOUSBDevice::SetConfiguration(IOUSBDevice *this, IOService *a2, unsigned __int8 a3, unsigned __int8 a4, char a5);
__int64 __fastcall IOUSBDevice::SetFeature(uintptr_t arg1, __int16 a2);
__int64 __fastcall IOUSBDevice::SetIsochDelay(uintptr_t arg1, __int16 a2);
__int64 __fastcall IOUSBDevice::GetInterface(__int64 a1, __int64 a2);
int __fastcall IOUSBDevice::OpenOrCloseAllInterfacePipes(IOUSBDevice *this, char a2);
__int64 __fastcall IOUSBDevice::GetConfigurationDescriptor(IOUSBDevice *this, unsigned __int8 a2, void *a3, unsigned int a4);
__int64 __fastcall IOUSBDevice::matchPropertyTable(IOUSBDevice *this, OSDictionary *, int *); // idb
signed __int64 __fastcall IOUSBDevice::DeviceRequest(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBDevice::_DeviceRequest(IOUSBDevice *__hidden this, OSObject *, void *, void *, void *, void *); // idb
signed __int64 __fastcall IOUSBDevice::DeviceRequest(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBDevice::_DeviceRequestDesc(IOUSBDevice *__hidden this, OSObject *, void *, void *, void *, void *); // idb
__int64 __fastcall IOUSBDevice::GetConfiguration(IOUSBDevice *__hidden this, unsigned __int8 *); // idb
__int64 __fastcall IOUSBDevice::_GetConfiguration(IOUSBDevice *__hidden this, OSObject *, void *, void *, void *, void *); // idb
__int64 __fastcall IOUSBDevice::GetDeviceStatus(IOUSBDevice *__hidden this, unsigned __int16 *); // idb
__int64 __fastcall IOUSBDevice::_GetDeviceStatus(IOUSBDevice *__hidden this, OSObject *, void *, void *, void *, void *); // idb
__int64 __fastcall IOUSBDevice::GetStringDescriptor(IOUSBDevice *this, unsigned __int8 a2, char *a3, signed int a4, __int16 a5);
unsigned __int64 __fastcall IOUSBDevice::SwapUniWords(IOUSBDevice *this, unsigned __int16 **a2, unsigned int a3);
__int64 __fastcall IOUSBDevice::TrimStringDescriptor(IOUSBDevice *__hidden this, unsigned __int16 **, int *); // idb
__int64 __fastcall IOUSBDevice::SimpleUnicodeToUTF8(IOUSBDevice *this, unsigned int a2, unsigned __int8 *a3);
int __fastcall IOUSBDevice::DisplayNotEnoughPowerNotice(IOUSBDevice *this);
// int __usercall IOUSBDevice::DisplayUserNotificationForDevice@<eax>(IOUSBDevice *this@<rdi>, __int64 a2@<rax>, unsigned __int8 a3@<dl>, int a4@<esi>);
__int64 __fastcall IOUSBDevice::ChangeGetConfigLock(IOUSBDevice *__hidden this, OSObject *, void *, void *, void *, void *); // idb
signed __int64 __fastcall IOUSBDevice::DeviceRequest(__int64 a1, __int64 a2, unsigned int a3, unsigned int a4, __int64 a5);
__int64 __fastcall IOUSBDevice::_DeviceRequestWithTimeout(IOUSBDevice *__hidden this, OSObject *, void *, void *, void *, void *); // idb
signed __int64 __fastcall IOUSBDevice::DeviceRequest(__int64 a1, __int64 a2, unsigned int a3, unsigned int a4, __int64 a5);
__int64 __fastcall IOUSBDevice::_DeviceRequestDescWithTimeout(IOUSBDevice *__hidden this, OSObject *, void *, void *, void *, void *); // idb
__int64 __fastcall IOUSBDevice::SuspendDevice(IOUSBDevice *this, uintptr_t a2);
void __fastcall IOUSBDevice::ProcessPortReEnumerate(uintptr_t arg1, unsigned int a2);
int __fastcall IOUSBDevice::DisplayUserNotification(IOUSBDevice *this, unsigned int a2);
// int __usercall IOUSBDevice::SetHubParent@<eax>(IOUSBDevice *this@<rdi>, IOUSBHubPolicyMaker *a2@<rsi>, __int64 a3@<rax>);
__int64 __fastcall IOUSBDevice::GetHubParent(IOUSBDevice *__hidden this); // idb
// __int64 __usercall IOUSBDevice::GetDeviceInformation@<rax>(IOUSBDevice *this@<rdi>, unsigned int *a2@<rsi>, __int64 a3@<rax>);
char __fastcall IOUSBDevice::IsDeviceInternal(IOUSBDevice *this);
// __int64 __usercall IOUSBDevice::RequestExtraPower@<rax>(IOUSBDevice *this@<rdi>, __int64 a2@<rax>, unsigned int a3@<edx>, unsigned int a4@<esi>);
__int64 __fastcall IOUSBDevice::ReturnExtraPower(IOUSBDevice *__hidden this, unsigned int, unsigned int); // idb
__int64 __fastcall IOUSBDevice::GetExtraPowerAllocated(IOUSBDevice *this, int a2);
char __fastcall IOUSBDevice::DoLocationOverrideAndModelMatch(IOUSBDevice *this);
int __fastcall IOUSBDevice::DoMessageClients(IOUSBDevice *this, void *a2);
void __fastcall IOUSBDevice::SetPort(IOUSBDevice *this, void *a2);
int __fastcall IOUSBDevice::SetAddress(IOUSBDevice *this, unsigned int a2);
__int64 __fastcall IOUSBDevice::GetAddress(IOUSBDevice *__hidden this); // idb
__int64 __fastcall IOUSBDevice::GetSpeed(IOUSBDevice *__hidden this); // idb
__int64 __fastcall IOUSBDevice::GetBus(IOUSBDevice *__hidden this); // idb
__int64 __fastcall IOUSBDevice::GetBusPowerAvailable(IOUSBDevice *__hidden this); // idb
int __fastcall IOUSBDevice::SetBusPowerAvailable(IOUSBDevice *this, unsigned int a2);
__int64 __fastcall IOUSBDevice::GetDevicePowerParent(IOUSBDevice *__hidden this); // idb
__int64 __fastcall IOUSBDevice::GetMaxPacketSize(IOUSBDevice *__hidden this); // idb
__int64 __fastcall IOUSBDevice::GetVendorID(IOUSBDevice *__hidden this); // idb
__int64 __fastcall IOUSBDevice::GetProductID(IOUSBDevice *__hidden this); // idb
__int64 __fastcall IOUSBDevice::GetDeviceRelease(IOUSBDevice *__hidden this); // idb
__int64 __fastcall IOUSBDevice::GetbcdUSB(IOUSBDevice *__hidden this); // idb
__int64 __fastcall IOUSBDevice::GetNumConfigurations(IOUSBDevice *__hidden this); // idb
__int64 __fastcall IOUSBDevice::GetDeviceClass(IOUSBDevice *__hidden this); // idb
__int64 __fastcall IOUSBDevice::GetDeviceSubClass(IOUSBDevice *__hidden this); // idb
__int64 __fastcall IOUSBDevice::GetProtocol(IOUSBDevice *__hidden this); // idb
__int64 __fastcall IOUSBDevice::GetManufacturerStringIndex(IOUSBDevice *__hidden this); // idb
__int64 __fastcall IOUSBDevice::GetProductStringIndex(IOUSBDevice *__hidden this); // idb
__int64 __fastcall IOUSBDevice::GetSerialNumberStringIndex(IOUSBDevice *__hidden this); // idb
__int64 __fastcall IOUSBDevice::GetLocationID(IOUSBDevice *__hidden this); // idb
__int64 __fastcall IOUSBDevice::GetPipeZero(IOUSBDevice *__hidden this); // idb
__int64 IOUSBDevice::MakePipe();
int __fastcall IOUSBDevice::MakePipe(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBDevice::MakePipe(__int64 a1, __int64 a2, unsigned __int64 a3, __int64 a4);
__int64 __fastcall IOUSBDevice::GetIsochDelay(IOUSBDevice *__hidden this); // idb
__int64 __fastcall IOUSBDevice::_RESERVEDIOUSBDevice18(IOUSBDevice *__hidden this); // idb
__int64 __fastcall IOUSBDevice::_RESERVEDIOUSBDevice19(IOUSBDevice *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceIterator::MetaClass::~MetaClass(IOUSBInterfaceIterator::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBDevice::MetaClass::~MetaClass(IOUSBDevice::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_6();
__int64 `global destructor keyed to'_a_6();
__int64 __fastcall IOUSBWorkLoop::MetaClass::MetaClass(IOUSBWorkLoop::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBWorkLoop::MetaClass::~MetaClass(IOUSBWorkLoop::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBWorkLoop::IOUSBWorkLoop(__int64 a1);
__int64 __fastcall IOUSBWorkLoop::IOUSBWorkLoop(__int64 a1);
__int64 __fastcall IOUSBWorkLoop::~IOUSBWorkLoop(IOUSBWorkLoop *__hidden this); // idb
__int64 __fastcall IOUSBWorkLoop::~IOUSBWorkLoop(IOUSBWorkLoop *__hidden this); // idb
void __fastcall IOUSBWorkLoop::~IOUSBWorkLoop(IOUSBWorkLoop *this);
__int64 __fastcall IOUSBWorkLoop::getMetaClass(IOUSBWorkLoop *__hidden this); // idb
__int64 __fastcall IOUSBWorkLoop::MetaClass::MetaClass(IOUSBWorkLoop::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBWorkLoop::MetaClass::alloc(IOUSBWorkLoop::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall IOUSBWorkLoop::IOUSBWorkLoop(__int64 a1);
__int64 __fastcall IOUSBWorkLoop::IOUSBWorkLoop(__int64 a1);
IOUSBWorkLoop *__fastcall IOUSBWorkLoop::workLoop(IOUSBWorkLoop *this, const char *a2);
int __fastcall IOUSBWorkLoop::init(IOUSBWorkLoop *this, const char *a2);
int __fastcall IOUSBWorkLoop::free(IOUSBWorkLoop *this);
int __fastcall IOUSBWorkLoop::closeGate(IOUSBWorkLoop *this, __int64 a2);
int __fastcall IOUSBWorkLoop::tryCloseGate(IOUSBWorkLoop *this);
__int64 __fastcall IOUSBWorkLoop::sleep(IOUSBWorkLoop *this, void *a2, __int64 a3, __int64 a4);
__int64 __fastcall IOUSBWorkLoop::wake(IOUSBWorkLoop *this, void *a2, __int64 a3, __int64 a4);
int __fastcall IOUSBWorkLoop::SleepWithTimeout(IOUSBWorkLoop *this, void *a2, unsigned int a3, __int64 a4, __int64 a5, __int64 a6);
int __fastcall IOUSBWorkLoop::Wakeup(IOUSBWorkLoop *this, void *a2, unsigned __int8 a3);
int __fastcall IOUSBWorkLoop::CloseGate(IOUSBWorkLoop *this);
int __fastcall IOUSBWorkLoop::OpenGate(IOUSBWorkLoop *this);
__int64 __fastcall IOUSBWorkLoop::MetaClass::~MetaClass(IOUSBWorkLoop::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_7();
__int64 `global destructor keyed to'_a_7();
__int64 __fastcall IOUSBControllerUserClient::MetaClass::MetaClass(IOUSBControllerUserClient::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBControllerUserClient::MetaClass::~MetaClass(IOUSBControllerUserClient::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBControllerUserClient::IOUSBControllerUserClient(__int64 a1);
__int64 __fastcall IOUSBControllerUserClient::IOUSBControllerUserClient(__int64 a1);
__int64 __fastcall IOUSBControllerUserClient::~IOUSBControllerUserClient(IOUSBControllerUserClient *__hidden this); // idb
__int64 __fastcall IOUSBControllerUserClient::~IOUSBControllerUserClient(IOUSBControllerUserClient *__hidden this); // idb
void __fastcall IOUSBControllerUserClient::~IOUSBControllerUserClient(IOUSBControllerUserClient *this);
__int64 __fastcall IOUSBControllerUserClient::getMetaClass(IOUSBControllerUserClient *__hidden this); // idb
__int64 __fastcall IOUSBControllerUserClient::MetaClass::MetaClass(IOUSBControllerUserClient::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBControllerUserClient::MetaClass::alloc(IOUSBControllerUserClient::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall IOUSBControllerUserClient::IOUSBControllerUserClient(__int64 a1);
__int64 __fastcall IOUSBControllerUserClient::IOUSBControllerUserClient(__int64 a1);
__int64 __fastcall IOUSBControllerUserClient::SetExternalMethodVectors(IOUSBControllerUserClient *__hidden this); // idb
signed __int64 __fastcall IOUSBControllerUserClient::getTargetAndMethodForIndex(IOUSBControllerUserClient *this, IOService **a2, unsigned int a3);
int __fastcall IOUSBControllerUserClient::initWithTask(IOUSBControllerUserClient *this, task *a2, void *a3, unsigned int a4, OSDictionary *a5);
char __fastcall IOUSBControllerUserClient::start(IOUSBControllerUserClient *this, IOService *a2, const OSMetaClass *a3);
__int64 __fastcall IOUSBControllerUserClient::open(uintptr_t arg1, unsigned __int8 a2);
__int64 __fastcall IOUSBControllerUserClient::close(IOUSBControllerUserClient *__hidden this); // idb
__int64 __fastcall IOUSBControllerUserClient::EnableKernelLogger(IOUSBControllerUserClient *this, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall IOUSBControllerUserClient::SetDebuggingLevel(IOUSBControllerUserClient *this, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBControllerUserClient::SetDebuggingType(IOUSBControllerUserClient *this, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBControllerUserClient::GetDebuggingLevel(IOUSBControllerUserClient *this, unsigned int *a2, __int64 a3, __int64 a4);
__int64 __fastcall IOUSBControllerUserClient::GetDebuggingType(IOUSBControllerUserClient *this, unsigned int *a2, __int64 a3, __int64 a4);
int __fastcall IOUSBControllerUserClient::SetTestMode(IOUSBControllerUserClient *this, unsigned int a2, const OSMetaClass *a3);
__int64 __fastcall IOUSBControllerUserClient::ReadRegister(uintptr_t arg1, uintptr_t a2, int a3, void *a4);
__int64 __fastcall IOUSBControllerUserClient::WriteRegister(uintptr_t arg1, int a2, int a3, int a4);
int __fastcall IOUSBControllerUserClient::MessageController(IOUSBControllerUserClient *this, unsigned int a2, const OSMetaClass *a3);
int __fastcall IOUSBControllerUserClient::GatedMessage(IOUSBControllerUserClient *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6);
int __fastcall IOUSBControllerUserClient::stop(IOUSBControllerUserClient *this, IOService *a2);
__int64 __fastcall IOUSBControllerUserClient::clientClose(IOUSBControllerUserClient *__hidden this); // idb
__int64 __fastcall IOUSBControllerUserClient::MetaClass::~MetaClass(IOUSBControllerUserClient::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_8();
__int64 `global destructor keyed to'_a_8();
int __fastcall KernelDebugEnable(unsigned __int8 a1, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall KernelDebugFindKernelLogger(__int64 a1, __int64 a2, OSDictionary *a3);
int __fastcall KernelDebugSetLevel(int a1, __int64 a2, __int64 a3);
__int64 __fastcall KernelDebugGetLevel(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
__int64 __fastcall KernelDebugGetOutputType(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall KernelDebugSetOutputType(int a1, __int64 a2, __int64 a3);
__int64 __fastcall KernelDebugLogInternal(unsigned int a1, unsigned int a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6, char a7);
// __int64 __usercall KernelDebugLogDataInternal@<rax>(signed __int64 a1@<rdx>, int a2@<ecx>, unsigned int a3@<edi>, unsigned int a4@<esi>, char a5@<r8b>, char a6);
int __fastcall armor(signed __int64 a1, int a2);
__int64 __fastcall IOUSBLog::MetaClass::MetaClass(IOUSBLog::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBLog::MetaClass::~MetaClass(IOUSBLog::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBLog::IOUSBLog(__int64 a1);
__int64 __fastcall IOUSBLog::IOUSBLog(__int64 a1);
__int64 __fastcall IOUSBLog::~IOUSBLog(IOUSBLog *__hidden this); // idb
__int64 __fastcall IOUSBLog::~IOUSBLog(IOUSBLog *__hidden this); // idb
void __fastcall IOUSBLog::~IOUSBLog(IOUSBLog *this);
__int64 __fastcall IOUSBLog::getMetaClass(IOUSBLog *__hidden this); // idb
__int64 __fastcall IOUSBLog::MetaClass::MetaClass(IOUSBLog::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBLog::MetaClass::alloc(IOUSBLog::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall IOUSBLog::IOUSBLog(__int64 a1);
__int64 __fastcall IOUSBLog::IOUSBLog(__int64 a1);
int __fastcall IOUSBLog::init(IOUSBLog *this, OSDictionary *a2);
__int64 __fastcall IOUSBLog::usblog(IOUSBLog *this, unsigned __int64 a2);
__int64 __fastcall IOUSBLog::USBLogPrintf(IOUSBLog *this, __int64 a2, char *a3, __int64 a4, __int64 a5, __int64 a6);
void __fastcall IOUSBLog::AddStatusLevel(IOUSBLog *this, __int64 a2, __int64 a3, char *a4);
void __fastcall IOUSBLog::AddStatus(IOUSBLog *this, char *a2);
void __fastcall IOUSBLog::AddStatus(IOUSBLog *this, __int64 a2, char *a3);
const char *__fastcall IOUSBLog::strstr(IOUSBLog *this, const char *a2, const char *a3);
int __fastcall IOUSBLog::stringFromReturn(IOUSBLog *this, unsigned int a2);
__int64 __fastcall IOUSBLog::MetaClass::~MetaClass(IOUSBLog::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_9();
__int64 `global destructor keyed to'_a_9();
__int64 __fastcall IOUSBControllerV2::MetaClass::MetaClass(IOUSBControllerV2::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBControllerV2::MetaClass::~MetaClass(IOUSBControllerV2::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBControllerV2::IOUSBControllerV2(__int64 a1);
__int64 __fastcall IOUSBControllerV2::~IOUSBControllerV2(IOUSBControllerV2 *__hidden this); // idb
__int64 __fastcall IOUSBControllerV2::~IOUSBControllerV2(IOUSBControllerV2 *__hidden this); // idb
void __fastcall IOUSBControllerV2::~IOUSBControllerV2(IOUSBControllerV2 *this);
__int64 __fastcall IOUSBControllerV2::getMetaClass(IOUSBControllerV2 *__hidden this); // idb
__int64 __fastcall IOUSBControllerV2::MetaClass::MetaClass(IOUSBControllerV2::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBControllerV2::MetaClass::alloc(IOUSBControllerV2::MetaClass *__hidden this); // idb
char __fastcall IOUSBControllerV2::init(IOUSBControllerV2 *this, OSDictionary *a2);
// char __usercall IOUSBControllerV2::start@<al>(IOUSBControllerV2 *this@<rdi>, IOService *a2@<rsi>, char a3@<al>);
int __fastcall IOUSBControllerV2::ReturnIsochDoneQueueEntry(IOUSBControllerV2 *this, OSObject *a2, void *a3);
void __fastcall IOUSBControllerV2::free(IOUSBControllerV2 *this);
// void __usercall IOUSBControllerV2::clearTTHandler(uintptr_t arg1@<rdi>, OSObject *this@<rsi>, void *a3@<rdx>, char a4@<al>, unsigned int a5@<ecx>);
void __fastcall IOUSBControllerV2::ClearTT(uintptr_t arg1, unsigned __int16 a2, unsigned __int8 a3, unsigned __int64 a4);
int __fastcall IOUSBControllerV2::OpenPipe(__int64 a1, unsigned int a2, unsigned int a3, __int64 a4);
__int64 __fastcall IOUSBControllerV2::DoCreateEP(uintptr_t arg1, OSObject *, void *, void *, void *, void *); // idb
int __fastcall IOUSBControllerV2::OpenSSPipe(__int64 a1, unsigned int a2, unsigned int a3, __int64 a4, int a5, int a6);
__int64 __fastcall IOUSBControllerV2::CreateDevice(IOUSBControllerV2 *this, IOUSBDevice *a2, unsigned int a3, unsigned __int8 a4, unsigned __int8 a5, unsigned int a6, unsigned __int16 a7, int a8);
char __fastcall IOUSBControllerV2::UpdateTopology(IOUSBControllerV2 *this, unsigned __int16 a2, unsigned int a3, unsigned __int16 a4, char a5);
int __fastcall IOUSBControllerV2::ConfigureDeviceZero(IOUSBControllerV2 *this, unsigned __int8 a2, unsigned __int8 a3, unsigned int a4, char a5);
__int64 __fastcall IOUSBControllerV2::UpdateDeviceAddress(IOUSBControllerV2 *this, unsigned __int16 a2, unsigned __int16 a3, unsigned __int8 a4, unsigned int a5, char a6);
int __fastcall IOUSBControllerV2::DOHSHubMaintenance(IOUSBControllerV2 *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6);
int __fastcall IOUSBControllerV2::DOSetTestMode(IOUSBControllerV2 *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6);
int __fastcall IOUSBControllerV2::AddHSHub(IOUSBControllerV2 *this, unsigned int a2, unsigned int a3);
__int64 __fastcall IOUSBControllerV2::UIMHubMaintenance(IOUSBControllerV2 *this);
int __fastcall IOUSBControllerV2::RemoveHSHub(IOUSBControllerV2 *this, unsigned int a2);
int __fastcall IOUSBControllerV2::SetTestMode(IOUSBControllerV2 *this, unsigned int a2, unsigned int a3);
__int64 __fastcall IOUSBControllerV2::UIMSetTestMode(IOUSBControllerV2 *this);
__int64 __fastcall IOUSBControllerV2::GetMicroFrameNumber(IOUSBControllerV2 *__hidden this); // idb
__int64 __fastcall IOUSBControllerV2::ReadV2(IOUSBController *this, IOMemoryDescriptor *a2, __int16 a3, __int64 a4, __int64 a5, int a6, int a7, __int64 a8);
// int __usercall IOUSBControllerV2::UIMCreateIsochEndpoint@<eax>(IOUSBControllerV2 *this@<rdi>, int a2, unsigned __int8 a3);
__int64 __fastcall IOUSBControllerV2::AllocateIsochEP(IOUSBControllerV2 *this, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
__int64 __fastcall IOUSBControllerV2::DeallocateIsochEP(IOUSBControllerV2 *this, IOUSBControllerIsochEndpoint *a2);
__int64 __fastcall IOUSBControllerV2::FindIsochronousEndpoint(IOUSBControllerV2 *this, int a2, unsigned __int16 a3, __int16 a4, IOUSBControllerIsochEndpoint **a5);
__int64 __fastcall IOUSBControllerV2::CreateIsochronousEndpoint(IOUSBControllerV2 *this, __int16 a2, __int16 a3, char a4);
__int64 __fastcall IOUSBControllerV2::PutTDonToDoList(IOUSBControllerV2 *this, IOUSBControllerIsochEndpoint *a2, IOUSBControllerIsochListElement *a3);
__int64 __fastcall IOUSBControllerV2::GetTDfromToDoList(IOUSBControllerV2 *this, IOUSBControllerIsochEndpoint *a2, const OSMetaClass *a3);
void __fastcall IOUSBControllerV2::PutTDonDoneQueue(uintptr_t arg1, uintptr_t arg2, uintptr_t arg3, unsigned __int8 a4);
int __fastcall IOUSBControllerV2::GetTDfromDoneQueue(IOUSBControllerV2 *this, IOUSBControllerIsochEndpoint *a2, const OSMetaClass *a3);
__int64 __fastcall IOUSBControllerV2::GatedGetTDfromDoneQueue(IOUSBControllerV2 *__hidden this, OSObject *, void *, void *, void *, void *); // idb
__int64 __fastcall IOUSBControllerV2::PutTDonDeferredQueue(IOUSBControllerV2 *this, IOUSBControllerIsochEndpoint *a2, IOUSBControllerIsochListElement *a3);
__int64 __fastcall IOUSBControllerV2::GetTDfromDeferredQueue(IOUSBControllerV2 *this, IOUSBControllerIsochEndpoint *a2, const OSMetaClass *a3);
void __fastcall IOUSBControllerV2::ReturnIsochDoneQueue(IOUSBControllerV2 *this, uintptr_t arg2);
int __fastcall IOUSBControllerV2::GetNewDMACommand(IOUSBControllerV2 *this);
__int64 __fastcall IOUSBControllerV2::GetLowLatencyOptionsAndPhysicalMask(IOUSBControllerV2 *__hidden this, unsigned int *, unsigned __int64 *); // idb
__int64 __fastcall IOUSBControllerV2::GetFrameNumberWithTime(IOUSBControllerV2 *__hidden this, unsigned __int64 *, unsigned __int64 *); // idb
__int64 __fastcall IOUSBControllerV2::ReadStream(IOUSBController *this, __int64 a2, IOMemoryDescriptor *a3, __int16 a4, __int64 a5, __int64 a6, int a7, int a8, __int64 a9);
__int64 __fastcall IOUSBControllerV2::WriteStream(IOUSBController *this, __int64 a2, IOMemoryDescriptor *a3, __int16 a4, __int64 a5, __int64 a6, int a7, int a8, __int64 a9);
__int64 __fastcall IOUSBControllerV2::_RESERVEDIOUSBControllerV227(IOUSBControllerV2 *__hidden this); // idb
__int64 __fastcall IOUSBControllerV2::_RESERVEDIOUSBControllerV228(IOUSBControllerV2 *__hidden this); // idb
__int64 __fastcall IOUSBControllerV2::_RESERVEDIOUSBControllerV229(IOUSBControllerV2 *__hidden this); // idb
__int64 __fastcall IOUSBControllerV2::MetaClass::~MetaClass(IOUSBControllerV2::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_10();
__int64 `global destructor keyed to'_a_10();
__int64 __fastcall IOUSBControllerListElement::MetaClass::MetaClass(IOUSBControllerListElement::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBControllerListElement::MetaClass::~MetaClass(IOUSBControllerListElement::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBControllerListElement::IOUSBControllerListElement(__int64 a1);
__int64 __fastcall IOUSBControllerListElement::~IOUSBControllerListElement(IOUSBControllerListElement *__hidden this); // idb
__int64 __fastcall IOUSBControllerListElement::~IOUSBControllerListElement(IOUSBControllerListElement *__hidden this); // idb
void __fastcall IOUSBControllerListElement::~IOUSBControllerListElement(IOUSBControllerListElement *this);
__int64 __fastcall IOUSBControllerListElement::getMetaClass(IOUSBControllerListElement *__hidden this); // idb
__int64 __fastcall IOUSBControllerListElement::MetaClass::MetaClass(IOUSBControllerListElement::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBControllerListElement::MetaClass::alloc(IOUSBControllerListElement::MetaClass *__hidden this); // idb
void __fastcall IOUSBControllerListElement::print(IOUSBControllerListElement *this);
__int64 __fastcall IOUSBControllerIsochListElement::MetaClass::MetaClass(IOUSBControllerIsochListElement::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBControllerIsochListElement::MetaClass::~MetaClass(IOUSBControllerIsochListElement::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBControllerIsochListElement::IOUSBControllerIsochListElement(__int64 a1);
__int64 __fastcall IOUSBControllerIsochListElement::~IOUSBControllerIsochListElement(IOUSBControllerIsochListElement *__hidden this); // idb
__int64 __fastcall IOUSBControllerIsochListElement::~IOUSBControllerIsochListElement(IOUSBControllerIsochListElement *__hidden this); // idb
void __fastcall IOUSBControllerIsochListElement::~IOUSBControllerIsochListElement(IOUSBControllerIsochListElement *this);
__int64 __fastcall IOUSBControllerIsochListElement::getMetaClass(IOUSBControllerIsochListElement *__hidden this); // idb
__int64 __fastcall IOUSBControllerIsochListElement::MetaClass::MetaClass(IOUSBControllerIsochListElement::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBControllerIsochListElement::MetaClass::alloc(IOUSBControllerIsochListElement::MetaClass *__hidden this); // idb
void __fastcall IOUSBControllerIsochListElement::print(IOUSBControllerIsochListElement *this);
__int64 __fastcall IOUSBControllerIsochEndpoint::MetaClass::MetaClass(IOUSBControllerIsochEndpoint::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBControllerIsochEndpoint::MetaClass::~MetaClass(IOUSBControllerIsochEndpoint::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBControllerIsochEndpoint::IOUSBControllerIsochEndpoint(__int64 a1);
__int64 __fastcall IOUSBControllerIsochEndpoint::IOUSBControllerIsochEndpoint(__int64 a1);
__int64 __fastcall IOUSBControllerIsochEndpoint::~IOUSBControllerIsochEndpoint(IOUSBControllerIsochEndpoint *__hidden this); // idb
__int64 __fastcall IOUSBControllerIsochEndpoint::~IOUSBControllerIsochEndpoint(IOUSBControllerIsochEndpoint *__hidden this); // idb
void __fastcall IOUSBControllerIsochEndpoint::~IOUSBControllerIsochEndpoint(IOUSBControllerIsochEndpoint *this);
__int64 __fastcall IOUSBControllerIsochEndpoint::getMetaClass(IOUSBControllerIsochEndpoint *__hidden this); // idb
__int64 __fastcall IOUSBControllerIsochEndpoint::MetaClass::MetaClass(IOUSBControllerIsochEndpoint::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBControllerIsochEndpoint::MetaClass::alloc(IOUSBControllerIsochEndpoint::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall IOUSBControllerIsochEndpoint::IOUSBControllerIsochEndpoint(__int64 a1);
__int64 __fastcall IOUSBControllerIsochEndpoint::IOUSBControllerIsochEndpoint(__int64 a1);
char __fastcall IOUSBControllerIsochEndpoint::init(IOUSBControllerIsochEndpoint *this);
__int64 __fastcall IOUSBControllerListElement::MetaClass::~MetaClass(IOUSBControllerListElement::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBControllerIsochListElement::MetaClass::~MetaClass(IOUSBControllerIsochListElement::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBControllerIsochEndpoint::MetaClass::~MetaClass(IOUSBControllerIsochEndpoint::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_11();
__int64 `global destructor keyed to'_a_11();
__int64 __fastcall IOUSBHubDevice::MetaClass::MetaClass(IOUSBHubDevice::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBHubDevice::MetaClass::~MetaClass(IOUSBHubDevice::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBHubDevice::IOUSBHubDevice(__int64 a1);
__int64 __fastcall IOUSBHubDevice::IOUSBHubDevice(__int64 a1);
__int64 __fastcall IOUSBHubDevice::~IOUSBHubDevice(IOUSBHubDevice *__hidden this); // idb
__int64 __fastcall IOUSBHubDevice::~IOUSBHubDevice(IOUSBHubDevice *__hidden this); // idb
void __fastcall IOUSBHubDevice::~IOUSBHubDevice(IOUSBHubDevice *this);
__int64 __fastcall IOUSBHubDevice::getMetaClass(IOUSBHubDevice *__hidden this); // idb
__int64 __fastcall IOUSBHubDevice::MetaClass::MetaClass(IOUSBHubDevice::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBHubDevice::MetaClass::alloc(IOUSBHubDevice::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall IOUSBHubDevice::IOUSBHubDevice(__int64 a1);
__int64 __fastcall IOUSBHubDevice::IOUSBHubDevice(__int64 a1);
__int64 __fastcall IOUSBHubDevice::NewHubDevice(IOUSBHubDevice *this, unsigned __int64 a2);
char __fastcall IOUSBHubDevice::init(IOUSBHubDevice *this);
int __fastcall IOUSBHubDevice::start(IOUSBHubDevice *this, IOService *a2);
char __fastcall IOUSBHubDevice::InitializeCharacteristics(IOUSBHubDevice *this);
void __fastcall IOUSBHubDevice::stop(IOUSBHubDevice *this, IOService *a2);
void __fastcall IOUSBHubDevice::free(IOUSBHubDevice *this);
void __fastcall IOUSBHubDevice::SetHubCharacteristics(IOUSBHubDevice *this, int a2);
__int64 __fastcall IOUSBHubDevice::GetHubCharacteristics(IOUSBHubDevice *__hidden this); // idb
__int64 __fastcall IOUSBHubDevice::GetMaxProvidedPower(IOUSBHubDevice *__hidden this); // idb
__int64 __fastcall IOUSBHubDevice::RequestProvidedPower(IOUSBHubDevice *__hidden this, unsigned int); // idb
void __fastcall IOUSBHubDevice::SetPolicyMaker(IOUSBHubDevice *this, IOUSBHubPolicyMaker *a2);
__int64 __fastcall IOUSBHubDevice::GetPolicyMaker(IOUSBHubDevice *__hidden this); // idb
// __int64 __usercall IOUSBHubDevice::RequestExtraPower@<rax>(IOUSBHubDevice *this@<rdi>, __int64 a2@<rax>, unsigned int a3@<edx>, unsigned int a4@<esi>);
__int64 __fastcall IOUSBHubDevice::RequestExtraWakePowerGated(IOUSBHubDevice *this, __int64 a2, unsigned __int64 a3, unsigned __int64 *a4);
__int64 __fastcall IOUSBHubDevice::ReturnExtraPower(IOUSBHubDevice *__hidden this, unsigned int, unsigned int); // idb
__int64 __fastcall IOUSBHubDevice::ReturnExtraWakePowerGated(IOUSBHubDevice *this, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBHubDevice::RequestSleepPower(IOUSBHubDevice *__hidden this, unsigned int); // idb
__int64 __fastcall IOUSBHubDevice::RequestSleepPowerGated(IOUSBHubDevice *__hidden this, unsigned __int64, unsigned __int64 *); // idb
int __fastcall IOUSBHubDevice::ReturnSleepPower(IOUSBHubDevice *this, unsigned int a2);
__int64 __fastcall IOUSBHubDevice::ReturnSleepPowerGated(IOUSBHubDevice *__hidden this, unsigned __int64); // idb
// int __usercall IOUSBHubDevice::InitializeExtraPower@<eax>(IOUSBHubDevice *this@<rdi>, __int64 a2@<rax>, int a3@<edx>, int a4@<ecx>, int a5@<esi>, int a6@<r8d>);
// int __usercall IOUSBHubDevice::SendExtraPowerMessage@<eax>(IOUSBHubDevice *this@<rdi>, __int64 a2@<rax>, int a3@<edx>, const char *a4@<rsi>);
__int64 __fastcall IOUSBHubDevice::UpdateUnconnectedExternalPorts(IOUSBHubDevice *__hidden this, int); // idb
__int64 __fastcall IOUSBHubDevice::UpdateUnconnectedExternalPortsGated(IOUSBHubDevice *this, signed int a2, int *a3);
int __fastcall IOUSBHubDevice::SetTotalSleepCurrent(IOUSBHubDevice *this);
int __fastcall IOUSBHubDevice::GetTotalSleepCurrent(IOUSBHubDevice *this);
__int64 __fastcall IOUSBHubDevice::SetSleepCurrent(IOUSBHubDevice *this, int a2);
__int64 __fastcall IOUSBHubDevice::GetSleepCurrent(IOUSBHubDevice *__hidden this); // idb
void __fastcall IOUSBHubDevice::InitializeExtraPower(IOUSBHubDevice *this);
__int64 __fastcall IOUSBHubDevice::RequestExtraPower(IOUSBHubDevice *this);
void __fastcall IOUSBHubDevice::ReturnExtraPower(IOUSBHubDevice *this);
__int64 __fastcall IOUSBHubDevice::_RESERVEDIOUSBHubDevice7(IOUSBHubDevice *__hidden this); // idb
__int64 __fastcall IOUSBHubDevice::_RESERVEDIOUSBHubDevice8(IOUSBHubDevice *__hidden this); // idb
__int64 __fastcall IOUSBHubDevice::_RESERVEDIOUSBHubDevice9(IOUSBHubDevice *__hidden this); // idb
__int64 __fastcall IOUSBHubDevice::_RESERVEDIOUSBHubDevice10(IOUSBHubDevice *__hidden this); // idb
__int64 __fastcall IOUSBHubDevice::_RESERVEDIOUSBHubDevice11(IOUSBHubDevice *__hidden this); // idb
__int64 __fastcall IOUSBHubDevice::_RESERVEDIOUSBHubDevice12(IOUSBHubDevice *__hidden this); // idb
__int64 __fastcall IOUSBHubDevice::_RESERVEDIOUSBHubDevice13(IOUSBHubDevice *__hidden this); // idb
__int64 __fastcall IOUSBHubDevice::_RESERVEDIOUSBHubDevice14(IOUSBHubDevice *__hidden this); // idb
__int64 __fastcall IOUSBHubDevice::_RESERVEDIOUSBHubDevice15(IOUSBHubDevice *__hidden this); // idb
__int64 __fastcall IOUSBHubDevice::MetaClass::~MetaClass(IOUSBHubDevice::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_12();
__int64 `global destructor keyed to'_a_12();
__int64 __fastcall IOUSBHubPolicyMaker::MetaClass::MetaClass(IOUSBHubPolicyMaker::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBHubPolicyMaker::MetaClass::~MetaClass(IOUSBHubPolicyMaker::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBHubPolicyMaker::IOUSBHubPolicyMaker(__int64 a1);
__int64 __fastcall IOUSBHubPolicyMaker::~IOUSBHubPolicyMaker(IOUSBHubPolicyMaker *__hidden this); // idb
__int64 __fastcall IOUSBHubPolicyMaker::~IOUSBHubPolicyMaker(IOUSBHubPolicyMaker *__hidden this); // idb
void __fastcall IOUSBHubPolicyMaker::~IOUSBHubPolicyMaker(IOUSBHubPolicyMaker *this);
__int64 __fastcall IOUSBHubPolicyMaker::getMetaClass(IOUSBHubPolicyMaker *__hidden this); // idb
__int64 __fastcall IOUSBHubPolicyMaker::MetaClass::MetaClass(IOUSBHubPolicyMaker::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBHubPolicyMaker::MetaClass::alloc(IOUSBHubPolicyMaker::MetaClass *__hidden this); // idb
int __fastcall IOUSBHubPolicyMaker::stop(IOUSBHubPolicyMaker *this, IOService *a2);
// char __usercall IOUSBHubPolicyMaker::start@<al>(IOUSBHubPolicyMaker *this@<rdi>, IOService *a2@<rsi>, char a3@<al>, const OSMetaClass *a4@<rdx>);
// int __usercall IOUSBHubPolicyMaker::AllocateExtraPower@<eax>(IOUSBHubPolicyMaker *this@<rdi>, int result@<eax>);
int __fastcall IOUSBHubPolicyMaker::powerStateForDomainState(IOUSBHubPolicyMaker *this);
int __fastcall IOUSBHubPolicyMaker::maxCapabilityForDomainState(IOUSBHubPolicyMaker *this);
int __fastcall IOUSBHubPolicyMaker::powerStateWillChangeTo(IOUSBHubPolicyMaker *this, __int64 a2, __int64 a3, IOService *a4);
int __fastcall IOUSBHubPolicyMaker::setPowerState(uintptr_t arg1, unsigned __int64 a2, IOService *a3);
int __fastcall IOUSBHubPolicyMaker::powerStateDidChangeTo(IOUSBHubPolicyMaker *this, __int64 a2, __int64 a3, IOService *a4);
int __fastcall IOUSBHubPolicyMaker::powerChangeDone(IOUSBHubPolicyMaker *this, __int64 a2);
__int64 __fastcall IOUSBHubPolicyMaker::EnsureUsability(IOUSBHubPolicyMaker *__hidden this); // idb
int __fastcall IOUSBHubPolicyMaker::RequestExtraPower(IOUSBHubPolicyMaker *this, __int64 a2, unsigned int a3, unsigned int a4);
int __fastcall IOUSBHubPolicyMaker::ReturnExtraPower(IOUSBHubPolicyMaker *this, __int64 a2, unsigned int a3, unsigned int a4);
__int64 __fastcall IOUSBHubPolicyMaker::GetExtraPortPower(IOUSBHubPolicyMaker *this, __int64 a2, unsigned int *a3);
__int64 __fastcall IOUSBHubPolicyMaker::ReturnExtraPortPower(IOUSBHubPolicyMaker *this);
__int64 __fastcall IOUSBHubPolicyMaker::GetPortInformation(IOUSBHubPolicyMaker *this, __int64 a2, unsigned int *a3);
__int64 __fastcall IOUSBHubPolicyMaker::ResetPort(IOUSBHubPolicyMaker *this);
__int64 __fastcall IOUSBHubPolicyMaker::SuspendPort(IOUSBHubPolicyMaker *this);
__int64 __fastcall IOUSBHubPolicyMaker::ReEnumeratePort(IOUSBHubPolicyMaker *this);
signed __int64 __fastcall IOUSBHubPolicyMaker::ProcessUSBNotification(IOUSBHubPolicyMaker *this, __int64 a2, IOUSBNotification *a3);
int __fastcall IOUSBHubPolicyMaker::GetMinimumIdlePowerState(IOUSBHubPolicyMaker *this, __int64 a2, const OSMetaClass *a3);
__int64 __fastcall IOUSBHubPolicyMaker::GetPowerExitLatencies(uintptr_t arg1, uintptr_t arg3, const OSMetaClass *a3);
__int64 __fastcall IOUSBHubPolicyMaker::_RESERVEDIOUSBHubPolicyMaker9(IOUSBHubPolicyMaker *__hidden this); // idb
__int64 __fastcall IOUSBHubPolicyMaker::_RESERVEDIOUSBHubPolicyMaker10(IOUSBHubPolicyMaker *__hidden this); // idb
__int64 __fastcall IOUSBHubPolicyMaker::_RESERVEDIOUSBHubPolicyMaker11(IOUSBHubPolicyMaker *__hidden this); // idb
__int64 __fastcall IOUSBHubPolicyMaker::_RESERVEDIOUSBHubPolicyMaker12(IOUSBHubPolicyMaker *__hidden this); // idb
__int64 __fastcall IOUSBHubPolicyMaker::_RESERVEDIOUSBHubPolicyMaker13(IOUSBHubPolicyMaker *__hidden this); // idb
__int64 __fastcall IOUSBHubPolicyMaker::_RESERVEDIOUSBHubPolicyMaker14(IOUSBHubPolicyMaker *__hidden this); // idb
__int64 __fastcall IOUSBHubPolicyMaker::_RESERVEDIOUSBHubPolicyMaker15(IOUSBHubPolicyMaker *__hidden this); // idb
__int64 __fastcall IOUSBHubPolicyMaker::_RESERVEDIOUSBHubPolicyMaker16(IOUSBHubPolicyMaker *__hidden this); // idb
__int64 __fastcall IOUSBHubPolicyMaker::_RESERVEDIOUSBHubPolicyMaker17(IOUSBHubPolicyMaker *__hidden this); // idb
__int64 __fastcall IOUSBHubPolicyMaker::_RESERVEDIOUSBHubPolicyMaker18(IOUSBHubPolicyMaker *__hidden this); // idb
__int64 __fastcall IOUSBHubPolicyMaker::_RESERVEDIOUSBHubPolicyMaker19(IOUSBHubPolicyMaker *__hidden this); // idb
__int64 __fastcall IOUSBHubPolicyMaker::MetaClass::~MetaClass(IOUSBHubPolicyMaker::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_13();
__int64 `global destructor keyed to'_a_13();
__int64 __fastcall IOUSBControllerV3::MetaClass::MetaClass(IOUSBControllerV3::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBControllerV3::MetaClass::~MetaClass(IOUSBControllerV3::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBControllerV3::IOUSBControllerV3(__int64 a1);
__int64 __fastcall IOUSBControllerV3::~IOUSBControllerV3(IOUSBControllerV3 *__hidden this); // idb
__int64 __fastcall IOUSBControllerV3::~IOUSBControllerV3(IOUSBControllerV3 *__hidden this); // idb
void __fastcall IOUSBControllerV3::~IOUSBControllerV3(IOUSBControllerV3 *this);
__int64 __fastcall IOUSBControllerV3::getMetaClass(IOUSBControllerV3 *__hidden this); // idb
__int64 __fastcall IOUSBControllerV3::MetaClass::MetaClass(IOUSBControllerV3::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBControllerV3::MetaClass::alloc(IOUSBControllerV3::MetaClass *__hidden this); // idb
char __fastcall IOUSBControllerV3::init(IOUSBControllerV3 *this, OSDictionary *a2);
char __fastcall IOUSBControllerV3::start(IOUSBControllerV3 *this, IOService *a2, const OSMetaClass *a3);
int __fastcall IOUSBControllerV3::RootHubTimerFired(OSMetaClassBase *a1, __int64 a2, const OSMetaClass *a3);
int __fastcall IOUSBControllerV3::UpdateThunderboltExtraCurrentiVars(IOUSBControllerV3 *this);
void __fastcall IOUSBControllerV3::stop(IOUSBControllerV3 *this, IOService *a2);
__int64 __fastcall IOUSBControllerV3::WakeUpCheckPowerModeThreadsGated(uintptr_t arg1, uintptr_t arg2); // idb
void __fastcall IOUSBControllerV3::willTerminate(IOUSBControllerV3 *this, IOService *a2);
void __fastcall IOUSBControllerV3::didTerminate(IOUSBControllerV3 *this, IOService *a2, __int64 a3, bool *a4);
char __fastcall IOUSBControllerV3::GetPMCSR(uintptr_t arg1, unsigned __int16 *a2);
uintptr_t __fastcall IOUSBControllerV3::maxCapabilityForDomainState(uintptr_t arg1, uintptr_t arg2);
void __fastcall IOUSBControllerV3::initialPowerStateForDomainState(IOUSBControllerV3 *this);
void __fastcall IOUSBControllerV3::powerStateWillChangeTo(uintptr_t arg1, uintptr_t arg2, __int64 a3, IOService *a4);
// __int64 __usercall IOUSBControllerV3::setPowerState@<rax>(uintptr_t arg1@<rdi>, uintptr_t arg3@<rsi>, IOService *this@<rdx>, char a4@<al>);
void __fastcall IOUSBControllerV3::powerStateDidChangeTo(uintptr_t arg1, uintptr_t arg2, uintptr_t arg3, uintptr_t a4);
void __fastcall IOUSBControllerV3::powerChangeDone(IOUSBControllerV3 *this, uintptr_t arg2);
unsigned __int64 __fastcall computeDeltaTimeMS(const unsigned __int64 *a1);
int __fastcall IOUSBControllerV3::systemWillShutdown(IOUSBControllerV3 *this, int a2);
void __fastcall IOUSBControllerV3::free(IOUSBControllerV3 *this);
__int64 __fastcall IOUSBControllerV3::CheckForEHCIController(IOUSBControllerV3 *this, IOService *a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6);
__int64 __fastcall IOUSBControllerV3::AllocatePowerStateArray(uintptr_t arg1); // idb
__int64 __fastcall IOUSBControllerV3::InitForPM(IOUSBControllerV3 *this); // idb
int __fastcall IOUSBControllerV3::CheckPowerModeBeforeGatedCall(IOUSBControllerV3 *this, char *a2);
// __int64 __usercall IOUSBControllerV3::CheckPowerModeBeforeGatedCall@<rax>(IOUSBControllerV3 *this@<rdi>, char *a2@<rsi>, OSObject *a3@<rdx>, __int64 a4@<rax>, unsigned int a5@<ecx>);
__int64 __fastcall IOUSBControllerV3::WaitForPCIPauseToFinish(uintptr_t arg1); // idb
int __fastcall IOUSBControllerV3::DoEnableAddressEndpoints(IOUSBControllerV3 *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6);
int __fastcall IOUSBControllerV3::EnableAddressEndpoints(IOUSBControllerV3 *this, unsigned int a2, unsigned __int8 a3);
int __fastcall IOUSBControllerV3::DoEnableAllEndpoints(IOUSBControllerV3 *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6);
int __fastcall IOUSBControllerV3::EnableAllEndpoints(IOUSBControllerV3 *this, unsigned __int8 a2);
int __fastcall IOUSBControllerV3::ControllerOff(IOUSBControllerV3 *this);
int __fastcall IOUSBControllerV3::ControllerRestart(IOUSBControllerV3 *this);
int __fastcall IOUSBControllerV3::ControllerSleep(IOUSBControllerV3 *this);
int __fastcall IOUSBControllerV3::ControllerDoze(IOUSBControllerV3 *this);
// void __usercall IOUSBControllerV3::ControllerOn(IOUSBControllerV3 *this@<rdi>, __int64 a2@<rax>);
char __fastcall IOUSBControllerV3::IsControllerAvailable(IOUSBControllerV3 *this);
__int64 __fastcall IOUSBControllerV3::GatedPowerChange(IOUSBControllerV3 *this, uintptr_t arg2, void *, void *, void *, void *); // idb
__int64 __fastcall IOUSBControllerV3::ChangeExternalDeviceCount(IOUSBControllerV3 *__hidden this, OSObject *, void *, void *, void *, void *); // idb
int __fastcall IOUSBControllerV3::HandlePowerChange(IOUSBControllerV3 *this, __int64 a2);
__int64 __fastcall IOUSBControllerV3::EnableBusMastering(uintptr_t arg1, char a2);
__int64 __fastcall IOUSBControllerV3::EnsureUsability(IOUSBControllerV3 *__hidden this); // idb
void __fastcall IOUSBControllerV3::RHCompleteTransaction(uintptr_t arg1, __int64 a2, __int16 a3, __int64 a4, unsigned __int8 a5);
__int64 __fastcall IOUSBControllerV3::CheckForRootHubChanges(uintptr_t arg1); // idb
// __int64 __usercall IOUSBControllerV3::RHQueueTransaction@<rax>(int a1@<edx>, __int64 a2@<rcx>, __int64 a3@<rdi>, __int64 a4@<rsi>, __int64 a5, __int64 a6, __int64 a7);
// __int64 __usercall IOUSBControllerV3::RootHubQueueInterruptRead@<rax>(uintptr_t arg1@<rdi>, uintptr_t arg2@<rsi>, uintptr_t arg3@<rdx>, __int64 a4, __int64 a5, __int64 a6);
uintptr_t __fastcall IOUSBControllerV3::RHAbortTransaction(uintptr_t arg1, __int64 a2);
__int64 __fastcall IOUSBControllerV3::RootHubAbortInterruptRead(uintptr_t arg1); // idb
__int64 __fastcall IOUSBControllerV3::RootHubStartTimer(IOUSBControllerV3 *this);
__int64 __fastcall IOUSBControllerV3::RootHubStartTimer32(uintptr_t arg1, uintptr_t arg2); // idb
__int64 __fastcall IOUSBControllerV3::RootHubStopTimer(uintptr_t arg1); // idb
__int64 __fastcall IOUSBControllerV3::AllocateExtraRootHubPortPower(IOUSBControllerV3 *this);
void __fastcall IOUSBControllerV3::ReturnExtraRootHubPortPower(IOUSBControllerV3 *this);
int __fastcall IOUSBControllerV3::CheckPMAssertions(IOUSBControllerV3 *this, IOUSBDevice *a2, unsigned __int8 a3);
signed __int64 __fastcall IOUSBControllerV3::GetRootHubBOSDescriptor(IOUSBControllerV3 *this, OSData *a2);
signed __int64 IOUSBControllerV3::GetRootHub3Descriptor();
__int64 __fastcall IOUSBControllerV3::GetRootHubPortErrorCount(IOUSBControllerV3 *this, __int64 a2, unsigned __int16 *a3);
__int64 __fastcall IOUSBControllerV3::UIMDeviceToBeReset(IOUSBControllerV3 *this);
// int __usercall IOUSBControllerV3::UIMAbortStream@<eax>(IOUSBControllerV3 *this@<rdi>, char a2@<al>, __int16 a3@<dx>, __int16 a4@<cx>, unsigned int a5@<esi>, __int16 a6@<r8w>);
__int64 __fastcall IOUSBControllerV3::UIMMaxSupportedStream(IOUSBControllerV3 *__hidden this); // idb
int __fastcall IOUSBControllerV3::GetActualDeviceAddress(IOUSBControllerV3 *this, unsigned int a2, unsigned __int16 *a3);
__int64 __fastcall IOUSBControllerV3::DoGetActualDeviceAddress(IOUSBControllerV3 *__hidden this, OSObject *, void *, void *, void *, void *); // idb
int __fastcall IOUSBControllerV3::CreateStreams(IOUSBControllerV3 *this, unsigned int a2, unsigned int a3, unsigned int a4, unsigned int a5);
int __fastcall IOUSBControllerV3::DoCreateStreams(IOUSBControllerV3 *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6);
signed __int64 IOUSBControllerV3::GetRootHubPowerExitLatencies();
__int64 __fastcall IOUSBControllerV3::AcquireDeviceZero(IOUSBControllerV3 *__hidden this); // idb
int __fastcall IOUSBControllerV3::ReleaseDeviceZero(IOUSBControllerV3 *this);
__int64 __fastcall IOUSBControllerV3::DeviceRequest(IOService *this, __int64 a2, __int64 a3, unsigned __int16 a4, unsigned __int8 a5, unsigned int a6);
__int64 __fastcall IOUSBControllerV3::DeviceRequest(IOService *this, __int64 a2, __int64 a3, unsigned __int16 a4, unsigned __int8 a5, unsigned int a6);
int __fastcall IOUSBControllerV3::ClosePipe(__int64 a1);
int __fastcall IOUSBControllerV3::AbortPipe(__int64 a1, unsigned int a2, __int64 a3);
int __fastcall IOUSBControllerV3::AbortPipe(__int64 a1, unsigned int a2, unsigned __int16 a3, __int64 a4);
int __fastcall IOUSBControllerV3::DoAbortStream(IOUSBControllerV3 *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6);
int __fastcall IOUSBControllerV3::ResetPipe(__int64 a1);
int __fastcall IOUSBControllerV3::ClearPipeStall(__int64 a1);
int __fastcall IOUSBControllerV3::Read(__int64 a1, __int64 a2, unsigned int a3, __int64 a4, __int64 a5);
int __fastcall IOUSBControllerV3::Read(__int64 a1, int a2, __int64 a3);
int __fastcall IOUSBControllerV3::Write(__int64 a1, __int64 a2, unsigned int a3, __int64 a4, __int64 a5);
int __fastcall IOUSBControllerV3::Write(__int64 a1, int a2, __int64 a3);
// int __usercall IOUSBControllerV3::IsocIO@<eax>(__int64 a1@<rdi>, __int64 a2@<rsi>, __int64 a3);
// int __usercall IOUSBControllerV3::IsocIO@<eax>(__int64 a1@<rdi>, __int64 a2@<rsi>, __int64 a3);
int __fastcall IOUSBControllerV3::OpenPipe(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
int __fastcall IOUSBControllerV3::OpenPipe(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5, int a6);
int __fastcall IOUSBControllerV3::AddHSHub(IOUSBControllerV3 *this);
int __fastcall IOUSBControllerV3::RemoveHSHub(IOUSBControllerV3 *this);
int __fastcall IOUSBControllerV3::SetTestMode(IOUSBControllerV3 *this);
int __fastcall IOUSBControllerV3::ReadV2(__int64 a1);
char __fastcall IOUSBControllerV3::GetInternalHubErrataBits(IOUSBControllerV3 *this, IORegistryEntry *a2, int a3, unsigned int a4, unsigned int *a5);
__int64 __fastcall IOUSBControllerV3::GetConnectorType(IOUSBControllerV3 *this, IORegistryEntry *, unsigned int, unsigned int, unsigned __int8 *); // idb
void __fastcall IOUSBControllerV3::FixupNECControllerConfigRegisters(uintptr_t arg1);
char __fastcall IOUSBControllerV3::CanControllerMuxOverToEHCI(IOUSBControllerV3 *this, IORegistryEntry *a2);
__int64 __fastcall IOUSBControllerV3::UIMGetActualDeviceAddress(IOUSBControllerV3 *this);
__int64 __fastcall IOUSBControllerV3::UIMCreateSSBulkEndpoint(IOUSBControllerV3 *this);
__int64 __fastcall IOUSBControllerV3::UIMCreateSSInterruptEndpoint(IOUSBControllerV3 *this);
__int64 __fastcall IOUSBControllerV3::UIMCreateSSIsochEndpoint(IOUSBControllerV3 *this);
__int64 __fastcall IOUSBControllerV3::UIMCreateStreams(IOUSBControllerV3 *this);
__int64 __fastcall IOUSBControllerV3::GetBandwidthAvailableForDevice(IOUSBControllerV3 *__hidden this, IOUSBDevice *, unsigned int *); // idb
__int64 __fastcall IOUSBControllerV3::GetMinimumIdlePowerState(uintptr_t arg1); // idb
// void __usercall IOUSBControllerV3::PMEHandler(uintptr_t arg1@<rdi>, char a2@<al>, __int64 a3@<rsi>);
char __fastcall IOUSBControllerV3::DoNotPowerOffPortsOnStop(IOUSBControllerV3 *this);
__int64 __fastcall IOUSBControllerV3::_RESERVEDIOUSBControllerV325(IOUSBControllerV3 *__hidden this); // idb
__int64 __fastcall IOUSBControllerV3::_RESERVEDIOUSBControllerV326(IOUSBControllerV3 *__hidden this); // idb
__int64 __fastcall IOUSBControllerV3::_RESERVEDIOUSBControllerV327(IOUSBControllerV3 *__hidden this); // idb
__int64 __fastcall IOUSBControllerV3::_RESERVEDIOUSBControllerV328(IOUSBControllerV3 *__hidden this); // idb
__int64 __fastcall IOUSBControllerV3::_RESERVEDIOUSBControllerV329(IOUSBControllerV3 *__hidden this); // idb
__int64 __fastcall IOUSBControllerV3::MetaClass::~MetaClass(IOUSBControllerV3::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_14();
__int64 `global destructor keyed to'_a_14();
__int64 __fastcall IOUSBInterfaceUserClientV2::MetaClass::MetaClass(IOUSBInterfaceUserClientV2::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceUserClientV2::MetaClass::~MetaClass(IOUSBInterfaceUserClientV2::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceUserClientV2::IOUSBInterfaceUserClientV2(__int64 a1);
__int64 __fastcall IOUSBInterfaceUserClientV2::IOUSBInterfaceUserClientV2(__int64 a1);
__int64 __fastcall IOUSBInterfaceUserClientV2::~IOUSBInterfaceUserClientV2(IOUSBInterfaceUserClientV2 *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceUserClientV2::~IOUSBInterfaceUserClientV2(IOUSBInterfaceUserClientV2 *__hidden this); // idb
void __fastcall IOUSBInterfaceUserClientV2::~IOUSBInterfaceUserClientV2(IOUSBInterfaceUserClientV2 *this);
__int64 __fastcall IOUSBInterfaceUserClientV2::getMetaClass(IOUSBInterfaceUserClientV2 *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceUserClientV2::MetaClass::MetaClass(IOUSBInterfaceUserClientV2::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceUserClientV2::MetaClass::alloc(IOUSBInterfaceUserClientV2::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall IOUSBInterfaceUserClientV2::IOUSBInterfaceUserClientV2(__int64 a1);
__int64 __fastcall IOUSBInterfaceUserClientV2::IOUSBInterfaceUserClientV2(__int64 a1);
__int64 __fastcall IOUSBLowLatencyCommand::MetaClass::MetaClass(IOUSBLowLatencyCommand::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBLowLatencyCommand::MetaClass::~MetaClass(IOUSBLowLatencyCommand::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBLowLatencyCommand::IOUSBLowLatencyCommand(IOCommand *a1, const OSMetaClass *a2);
__int64 __fastcall IOUSBLowLatencyCommand::IOUSBLowLatencyCommand(IOCommand *a1, const OSMetaClass *a2);
__int64 __fastcall IOUSBLowLatencyCommand::~IOUSBLowLatencyCommand(IOUSBLowLatencyCommand *__hidden this); // idb
__int64 __fastcall IOUSBLowLatencyCommand::~IOUSBLowLatencyCommand(IOUSBLowLatencyCommand *__hidden this); // idb
void __fastcall IOUSBLowLatencyCommand::~IOUSBLowLatencyCommand(IOUSBLowLatencyCommand *this);
__int64 __fastcall IOUSBLowLatencyCommand::getMetaClass(IOUSBLowLatencyCommand *__hidden this); // idb
__int64 __fastcall IOUSBLowLatencyCommand::MetaClass::MetaClass(IOUSBLowLatencyCommand::MetaClass *__hidden this); // idb
IOCommand *__fastcall IOUSBLowLatencyCommand::MetaClass::alloc(IOUSBLowLatencyCommand::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall IOUSBLowLatencyCommand::IOUSBLowLatencyCommand(IOCommand *a1);
__int64 __fastcall IOUSBLowLatencyCommand::IOUSBLowLatencyCommand(IOCommand *a1);
signed __int64 __fastcall IOUSBInterfaceUserClientV2::_open(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBInterfaceUserClientV2::_close(IOService *this); // idb
__int64 __fastcall IOUSBInterfaceUserClientV2::_GetDevice(__int64 a1, __int64 a2, __int64 a3);
signed __int64 __fastcall IOUSBInterfaceUserClientV2::_SetAlternateInterface(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBInterfaceUserClientV2::_GetFrameNumber(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBInterfaceUserClientV2::_GetPipeProperties(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBInterfaceUserClientV2::_ReadPipe(uintptr_t arg1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBInterfaceUserClientV2::_WritePipe(uintptr_t arg1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBInterfaceUserClientV2::_GetPipeStatus(__int64 a1, __int64 a2, __int64 a3);
signed __int64 __fastcall IOUSBInterfaceUserClientV2::_AbortPipe(__int64 a1, __int64 a2, __int64 a3);
signed __int64 __fastcall IOUSBInterfaceUserClientV2::_ResetPipe(__int64 a1, __int64 a2, __int64 a3);
signed __int64 __fastcall IOUSBInterfaceUserClientV2::_ClearPipeStall(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBInterfaceUserClientV2::_ControlRequestOut(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBInterfaceUserClientV2::_ControlRequestIn(__int64 a1, __int64 a2, __int64 a3);
signed __int64 __fastcall IOUSBInterfaceUserClientV2::_SetPipePolicy(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBInterfaceUserClientV2::_GetBandwidthAvailable(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBInterfaceUserClientV2::_GetEndpointProperties(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBInterfaceUserClientV2::_LowLatencyPrepareBuffer(IOService *this, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBInterfaceUserClientV2::_LowLatencyReleaseBuffer(IOService *this, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBInterfaceUserClientV2::_GetMicroFrameNumber(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBInterfaceUserClientV2::_GetFrameListTime(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBInterfaceUserClientV2::_GetFrameNumberWithTime(__int64 a1, __int64 a2, __int64 a3);
int __fastcall IOUSBInterfaceUserClientV2::_SetAsyncPort(__int64 a1, __int64 a2, __int64 a3);
signed __int64 __fastcall IOUSBInterfaceUserClientV2::_ReadIsochPipe(__int64 a1, __int64 a2, __int64 a3);
signed __int64 __fastcall IOUSBInterfaceUserClientV2::_WriteIsochPipe(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBInterfaceUserClientV2::_LowLatencyReadIsochPipe(IOService *this, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBInterfaceUserClientV2::_LowLatencyWriteIsochPipe(IOService *this, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBInterfaceUserClientV2::_GetConfigDescriptor(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBInterfaceUserClientV2::_GetPipePropertiesV2(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBInterfaceUserClientV2::_GetPipePropertiesV3(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBInterfaceUserClientV2::_GetEndpointPropertiesV3(__int64 a1, __int64 a2, __int64 a3);
int IOUSBInterfaceUserClientV2::externalMethod();
signed __int64 __fastcall IOUSBInterfaceUserClientV2::SetAsyncPort(__int64 a1, __int64 a2);
__int64 __fastcall IOUSBInterfaceUserClientV2::ReqComplete(IOUSBInterfaceUserClientV2 *this, void *a2, void *a3, unsigned int a4);
__int64 __fastcall IOUSBInterfaceUserClientV2::IsoReqComplete(OSMetaClassBase *a1, __int64 a2, const OSMetaClass *a3);
__int64 __fastcall IOUSBInterfaceUserClientV2::LowLatencyIsoReqComplete(OSMetaClassBase *a1, __int64 a2, const OSMetaClass *a3);
char __fastcall IOUSBInterfaceUserClientV2::initWithTask(IOUSBInterfaceUserClientV2 *this, task *a2, void *a3, unsigned int a4, OSDictionary *a5);
// char __usercall IOUSBInterfaceUserClientV2::start@<al>(IOUSBInterfaceUserClientV2 *this@<rdi>, IOService *a2@<rsi>, char a3@<al>);
__int64 __fastcall IOUSBInterfaceUserClientV2::open(IOUSBInterfaceUserClientV2 *this, unsigned __int8 a2);
int __fastcall IOUSBInterfaceUserClientV2::closeGated(IOUSBInterfaceUserClientV2 *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6);
__int64 __fastcall IOUSBInterfaceUserClientV2::close(IOUSBInterfaceUserClientV2 *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceUserClientV2::SetAlternateInterface(IOUSBInterfaceUserClientV2 *this, unsigned __int8); // idb
__int64 __fastcall IOUSBInterfaceUserClientV2::GetDevice(IOUSBInterfaceUserClientV2 *this, unsigned __int64 *); // idb
__int64 __fastcall IOUSBInterfaceUserClientV2::GetFrameNumber(IOService *this, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBInterfaceUserClientV2::GetMicroFrameNumber(IOService *this, __int64 a2, __int64 a3);
int __fastcall IOUSBInterfaceUserClientV2::GetFrameNumberWithTime(IOService *this, __int64 a2, __int64 a3);
// __int64 __usercall IOUSBInterfaceUserClientV2::GetBandwidthAvailable@<rax>(IOUSBInterfaceUserClientV2 *this@<rdi>, unsigned __int64 *a2@<rsi>, __int64 a3@<rax>);
__int64 __fastcall IOUSBInterfaceUserClientV2::GetFrameListTime(IOUSBInterfaceUserClientV2 *this, unsigned __int64 *); // idb
__int64 __fastcall IOUSBInterfaceUserClientV2::GetEndpointProperties(IOUSBInterfaceUserClientV2 *this, unsigned __int8, unsigned __int8, unsigned __int8, unsigned __int64 *, unsigned __int64 *, unsigned __int64 *); // idb
__int64 __fastcall IOUSBInterfaceUserClientV2::GetEndpointPropertiesV3(IOService *this, char a2, char a3, char a4, char a5, __int64 a6, __int64 a7);
__int64 __fastcall IOUSBInterfaceUserClientV2::GetConfigDescriptor(IOService *this, unsigned __int8 a2, void *a3, unsigned int *a4);
__int64 __fastcall IOUSBInterfaceUserClientV2::GetConfigDescriptor(IOUSBInterfaceUserClientV2 *this, unsigned __int8, IOMemoryDescriptor *, unsigned int *); // idb
__int64 __fastcall IOUSBInterfaceUserClientV2::ReadPipe(IOService *this, unsigned __int8 a2, unsigned int a3, unsigned int a4, uintptr_t a5, unsigned __int64 a6, __int64 a7);
__int64 __fastcall IOUSBInterfaceUserClientV2::ReadPipe(IOUSBInterfaceUserClientV2 *this, unsigned __int8, unsigned int, unsigned int, void *, unsigned int *); // idb
__int64 __fastcall IOUSBInterfaceUserClientV2::ReadPipe(IOUSBInterfaceUserClientV2 *this, unsigned __int8, unsigned int, unsigned int, IOMemoryDescriptor *, unsigned __int64 *); // idb
__int64 __fastcall IOUSBInterfaceUserClientV2::WritePipe(IOService *this, unsigned __int8 a2, unsigned int a3, unsigned int a4, uintptr_t a5, unsigned __int64 a6, __int64 a7);
__int64 __fastcall IOUSBInterfaceUserClientV2::WritePipe(IOUSBInterfaceUserClientV2 *this, unsigned __int8, unsigned int, unsigned int, const void *, unsigned int); // idb
__int64 __fastcall IOUSBInterfaceUserClientV2::WritePipe(IOUSBInterfaceUserClientV2 *this, unsigned __int8, unsigned int, unsigned int, IOMemoryDescriptor *); // idb
__int64 __fastcall IOUSBInterfaceUserClientV2::GetPipeProperties(IOUSBInterfaceUserClientV2 *this, unsigned __int8, unsigned __int64 *, unsigned __int64 *, unsigned __int64 *, unsigned __int64 *, unsigned __int64 *); // idb
__int64 __fastcall IOUSBInterfaceUserClientV2::GetPipePropertiesV2(IOUSBInterfaceUserClientV2 *this, unsigned __int8, unsigned __int64 *, unsigned __int64 *, unsigned __int64 *, unsigned __int64 *, unsigned __int64 *, unsigned __int64 *, unsigned __int64 *, unsigned __int64 *); // idb
__int64 __fastcall IOUSBInterfaceUserClientV2::GetPipePropertiesV3(IOService *this, unsigned __int8 a2, char a3, __int64 a4, __int64 a5);
__int64 __fastcall IOUSBInterfaceUserClientV2::GetPipeStatus(IOUSBInterfaceUserClientV2 *this, unsigned __int8); // idb
__int64 __fastcall IOUSBInterfaceUserClientV2::AbortPipe(IOUSBInterfaceUserClientV2 *this, unsigned __int8); // idb
__int64 __fastcall IOUSBInterfaceUserClientV2::ResetPipe(IOUSBInterfaceUserClientV2 *this, unsigned __int8); // idb
__int64 __fastcall IOUSBInterfaceUserClientV2::ClearPipeStall(IOUSBInterfaceUserClientV2 *this, unsigned __int8 a2, unsigned __int8 a3);
__int64 __fastcall IOUSBInterfaceUserClientV2::SetPipePolicy(IOUSBInterfaceUserClientV2 *this, unsigned __int8, unsigned __int16, unsigned __int8); // idb
__int64 __fastcall IOUSBInterfaceUserClientV2::ControlRequestOut(IOService *this, uintptr_t arg3, IOMemoryDescriptor *a3, unsigned __int8 a4, unsigned __int16 a5, int a6, __int64 arg3a, task *a8, unsigned int a9, unsigned int a10, task *a11);
__int64 __fastcall IOUSBInterfaceUserClientV2::ControlRequestOut(IOUSBInterfaceUserClientV2 *this, IOUSBInterfaceUserClientV2 *a2, char a3, char a4, __int16 a5, int a6, unsigned int a7, unsigned int a8, const void *a9, unsigned int a10);
__int64 __fastcall IOUSBInterfaceUserClientV2::ControlRequestOut(IOUSBInterfaceUserClientV2 *this, IOUSBInterfaceUserClientV2 *a2, char a3, char a4, __int16 a5, int a6, unsigned int a7, unsigned int a8, IOMemoryDescriptor *a9);
__int64 __fastcall IOUSBInterfaceUserClientV2::ControlRequestIn(IOService *this, uintptr_t arg3, IOMemoryDescriptor *a3, unsigned __int8 a4, unsigned __int16 a5, int a6, __int64 arg3a, task *a8, unsigned int a9, unsigned int a10, task *a11);
__int64 __fastcall IOUSBInterfaceUserClientV2::ControlRequestIn(IOUSBInterfaceUserClientV2 *this, IOUSBInterfaceUserClientV2 *a2, char a3, char a4, __int16 a5, int a6, unsigned int a7, unsigned int a8, void *a9, unsigned int *a10);
__int64 __fastcall IOUSBInterfaceUserClientV2::ControlRequestIn(IOUSBInterfaceUserClientV2 *this, IOUSBInterfaceUserClientV2 *a2, char a3, char a4, __int16 a5, int a6, unsigned int a7, unsigned int a8, IOMemoryDescriptor *a9, unsigned int *a10);
__int64 __fastcall IOUSBInterfaceUserClientV2::DoIsochPipeAsync(IOService *this, __int64 a2, const void *a3, int a4, unsigned int a5);
int __fastcall IOUSBInterfaceUserClientV2::DoLowLatencyIsochPipeAsyncGated(IOUSBInterfaceUserClientV2 *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6);
__int64 __fastcall IOUSBInterfaceUserClientV2::DoLowLatencyIsochPipeAsync(IOService *this, __int64 a2, __int64 a3, uintptr_t a4);
int __fastcall IOUSBInterfaceUserClientV2::LowLatencyPrepareBufferGated(IOUSBInterfaceUserClientV2 *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6);
__int64 __fastcall IOUSBInterfaceUserClientV2::LowLatencyPrepareBuffer(IOService *this, __int64 a2, __int64 a3);
int __fastcall IOUSBInterfaceUserClientV2::LowLatencyReleaseBufferGated(IOUSBInterfaceUserClientV2 *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6);
__int64 __fastcall IOUSBInterfaceUserClientV2::LowLatencyReleaseBuffer(IOService *this, __int64 a2);
int __fastcall IOUSBInterfaceUserClientV2::LowLatencyReleaseKernelBufferInfo(__int64 a1, __int64 a2);
__int64 __fastcall IOUSBInterfaceUserClientV2::AddDataBufferToList(__int64 a1, __int64 a2);
__int64 __fastcall IOUSBInterfaceUserClientV2::FindBufferCookieInListV2(IOUSBInterfaceUserClientV2 *this, __int64 a2);
char __fastcall IOUSBInterfaceUserClientV2::RemoveDataBufferFromList(__int64 a1, __int64 a2);
// int __usercall IOUSBInterfaceUserClientV2::DecrementOutstandingIO@<eax>(IOUSBInterfaceUserClientV2 *this@<rdi>, __int64 a2@<rax>);
__int64 __fastcall IOUSBInterfaceUserClientV2::ChangeOutstandingIO(IOUSBInterfaceUserClientV2 *__hidden this, OSObject *, void *, void *, void *, void *); // idb
int __fastcall IOUSBInterfaceUserClientV2::ReleaseWorkLoopAndGate(IOUSBInterfaceUserClientV2 *this);
int __fastcall IOUSBInterfaceUserClientV2::IncrementOutstandingIO(IOUSBInterfaceUserClientV2 *this);
__int64 __fastcall IOUSBInterfaceUserClientV2::GetOutstandingIO(IOUSBInterfaceUserClientV2 *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceUserClientV2::GetGatedOutstandingIO(IOUSBInterfaceUserClientV2 *__hidden this, OSObject *, void *, void *, void *, void *); // idb
int __fastcall IOUSBInterfaceUserClientV2::IncreaseCommandPool(IOUSBInterfaceUserClientV2 *this, unsigned __int64 a2);
IOCommand *__fastcall IOUSBLowLatencyCommand::NewCommand(IOUSBLowLatencyCommand *this, unsigned __int64 a2);
int __fastcall IOUSBInterfaceUserClientV2::ReleasePreparedDescriptors(IOUSBInterfaceUserClientV2 *this);
__int64 __fastcall IOUSBInterfaceUserClientV2::GetPipeObj(IOUSBInterfaceUserClientV2 *this, unsigned __int8); // idb
__int64 __fastcall IOUSBInterfaceUserClientV2::clientClose(IOUSBInterfaceUserClientV2 *this); // idb
int __fastcall IOUSBInterfaceUserClientV2::ClientCloseEntry(IOUSBInterfaceUserClientV2 *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6);
__int64 __fastcall IOUSBInterfaceUserClientV2::ClientCloseGated(IOUSBInterfaceUserClientV2 *this); // idb
int __fastcall IOUSBInterfaceUserClientV2::clientDied(IOUSBInterfaceUserClientV2 *this);
int __fastcall IOUSBInterfaceUserClientV2::stop(IOUSBInterfaceUserClientV2 *this, IOService *a2);
int __fastcall IOUSBInterfaceUserClientV2::free(IOUSBInterfaceUserClientV2 *this);
int __fastcall IOUSBInterfaceUserClientV2::finalize(IOUSBInterfaceUserClientV2 *this);
int __fastcall IOUSBInterfaceUserClientV2::willTerminate(IOUSBInterfaceUserClientV2 *this, IOService *a2, unsigned int a3);
int __fastcall IOUSBInterfaceUserClientV2::didTerminate(IOUSBInterfaceUserClientV2 *this, IOService *a2, unsigned int a3, bool *a4);
int __fastcall IOUSBInterfaceUserClientV2::terminate(IOUSBInterfaceUserClientV2 *this);
__int64 __fastcall IOUSBInterfaceUserClientV2::message(IOUSBInterfaceUserClientV2 *this, __int64 a2, IOService *a3, void *a4);
void IOUSBInterfaceUserClientV2::PrintExternalMethodArgs();
signed __int64 IOUSBInterfaceUserClientV2::DoIsochPipeAsync();
signed __int64 IOUSBInterfaceUserClientV2::DoLowLatencyIsochPipeAsync();
__int64 IOUSBInterfaceUserClientV2::RemoveDataBufferFromList();
__int64 __fastcall IOUSBInterfaceUserClientV2::FindBufferCookieInList(IOUSBInterfaceUserClientV2 *this);
void IOUSBInterfaceUserClientV2::AddDataBufferToList();
signed __int64 IOUSBInterfaceUserClientV2::LowLatencyReleaseBuffer();
signed __int64 IOUSBInterfaceUserClientV2::LowLatencyPrepareBuffer();
signed __int64 IOUSBInterfaceUserClientV2::DoLowLatencyIsochPipeAsync();
void IOUSBInterfaceUserClientV2::AddDataBufferToList();
__int64 __fastcall IOUSBInterfaceUserClientV2::FindBufferCookieInList(IOUSBInterfaceUserClientV2 *this);
__int64 IOUSBInterfaceUserClientV2::RemoveDataBufferFromList();
__int64 __fastcall IOUSBInterfaceUserClientV2::_RESERVEDIOUSBInterfaceUserClientV216(IOUSBInterfaceUserClientV2 *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceUserClientV2::_RESERVEDIOUSBInterfaceUserClientV217(IOUSBInterfaceUserClientV2 *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceUserClientV2::_RESERVEDIOUSBInterfaceUserClientV218(IOUSBInterfaceUserClientV2 *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceUserClientV2::_RESERVEDIOUSBInterfaceUserClientV219(IOUSBInterfaceUserClientV2 *__hidden this); // idb
char __fastcall IOUSBLowLatencyCommand::init(IOUSBLowLatencyCommand *this);
int __fastcall IOUSBLowLatencyCommand::free(IOUSBLowLatencyCommand *this);
void __fastcall IOUSBLowLatencyCommand::SetAsyncReference(IOUSBLowLatencyCommand *this, unsigned __int64 *a2);
void __fastcall IOUSBLowLatencyCommand::SetAsyncCount(IOUSBLowLatencyCommand *this, int a2);
__int64 __fastcall IOUSBLowLatencyCommand::_RESERVEDIOUSBLowLatencyCommand0(IOUSBLowLatencyCommand *__hidden this); // idb
__int64 __fastcall IOUSBLowLatencyCommand::_RESERVEDIOUSBLowLatencyCommand1(IOUSBLowLatencyCommand *__hidden this); // idb
__int64 __fastcall IOUSBLowLatencyCommand::_RESERVEDIOUSBLowLatencyCommand2(IOUSBLowLatencyCommand *__hidden this); // idb
__int64 __fastcall IOUSBLowLatencyCommand::_RESERVEDIOUSBLowLatencyCommand3(IOUSBLowLatencyCommand *__hidden this); // idb
__int64 __fastcall IOUSBLowLatencyCommand::_RESERVEDIOUSBLowLatencyCommand4(IOUSBLowLatencyCommand *__hidden this); // idb
__int64 __fastcall IOUSBLowLatencyCommand::_RESERVEDIOUSBLowLatencyCommand5(IOUSBLowLatencyCommand *__hidden this); // idb
__int64 __fastcall IOUSBLowLatencyCommand::_RESERVEDIOUSBLowLatencyCommand6(IOUSBLowLatencyCommand *__hidden this); // idb
__int64 __fastcall IOUSBLowLatencyCommand::_RESERVEDIOUSBLowLatencyCommand7(IOUSBLowLatencyCommand *__hidden this); // idb
__int64 __fastcall IOUSBLowLatencyCommand::_RESERVEDIOUSBLowLatencyCommand8(IOUSBLowLatencyCommand *__hidden this); // idb
__int64 __fastcall IOUSBLowLatencyCommand::_RESERVEDIOUSBLowLatencyCommand9(IOUSBLowLatencyCommand *__hidden this); // idb
__int64 __fastcall IOUSBLowLatencyCommand::_RESERVEDIOUSBLowLatencyCommand10(IOUSBLowLatencyCommand *__hidden this); // idb
__int64 __fastcall IOUSBLowLatencyCommand::_RESERVEDIOUSBLowLatencyCommand11(IOUSBLowLatencyCommand *__hidden this); // idb
__int64 __fastcall IOUSBLowLatencyCommand::_RESERVEDIOUSBLowLatencyCommand12(IOUSBLowLatencyCommand *__hidden this); // idb
__int64 __fastcall IOUSBLowLatencyCommand::_RESERVEDIOUSBLowLatencyCommand13(IOUSBLowLatencyCommand *__hidden this); // idb
__int64 __fastcall IOUSBLowLatencyCommand::_RESERVEDIOUSBLowLatencyCommand14(IOUSBLowLatencyCommand *__hidden this); // idb
__int64 __fastcall IOUSBLowLatencyCommand::_RESERVEDIOUSBLowLatencyCommand15(IOUSBLowLatencyCommand *__hidden this); // idb
__int64 __fastcall IOUSBLowLatencyCommand::_RESERVEDIOUSBLowLatencyCommand16(IOUSBLowLatencyCommand *__hidden this); // idb
__int64 __fastcall IOUSBLowLatencyCommand::_RESERVEDIOUSBLowLatencyCommand17(IOUSBLowLatencyCommand *__hidden this); // idb
__int64 __fastcall IOUSBLowLatencyCommand::_RESERVEDIOUSBLowLatencyCommand18(IOUSBLowLatencyCommand *__hidden this); // idb
__int64 __fastcall IOUSBLowLatencyCommand::_RESERVEDIOUSBLowLatencyCommand19(IOUSBLowLatencyCommand *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceUserClientV2::MetaClass::~MetaClass(IOUSBInterfaceUserClientV2::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBLowLatencyCommand::MetaClass::~MetaClass(IOUSBLowLatencyCommand::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_15();
__int64 `global destructor keyed to'_a_15();
__int64 __fastcall IOUSBNotification::MetaClass::MetaClass(IOUSBNotification::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBNotification::MetaClass::~MetaClass(IOUSBNotification::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBNotification::IOUSBNotification(__int64 a1);
__int64 __fastcall IOUSBNotification::IOUSBNotification(__int64 a1);
__int64 __fastcall IOUSBNotification::~IOUSBNotification(IOUSBNotification *__hidden this); // idb
__int64 __fastcall IOUSBNotification::~IOUSBNotification(IOUSBNotification *__hidden this); // idb
void __fastcall IOUSBNotification::~IOUSBNotification(IOUSBNotification *this);
__int64 __fastcall IOUSBNotification::getMetaClass(IOUSBNotification *__hidden this); // idb
__int64 __fastcall IOUSBNotification::MetaClass::MetaClass(IOUSBNotification::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBNotification::MetaClass::alloc(IOUSBNotification::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall IOUSBNotification::IOUSBNotification(__int64 a1);
__int64 __fastcall IOUSBNotification::IOUSBNotification(__int64 a1);
__int64 __fastcall IOUSBNotification::withUserClient(IOUSBNotification *this, IOUserClient *a2);
__int64 __fastcall IOUSBNotification::SendNotification(IOUSBNotification *this, __int64 a2, void *a3, __int64 a4, unsigned int a5);
__int64 __fastcall IOUSBDeviceUserClientV2::SendNotification(IOUSBDeviceUserClientV2 *this, unsigned __int64 (*a2)[8], unsigned __int64 *a3, __int64 a4, unsigned int a5);
__int64 __fastcall IOUSBDeviceUserClientV2::MetaClass::MetaClass(IOUSBDeviceUserClientV2::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBDeviceUserClientV2::MetaClass::~MetaClass(IOUSBDeviceUserClientV2::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBDeviceUserClientV2::IOUSBDeviceUserClientV2(__int64 a1);
__int64 __fastcall IOUSBDeviceUserClientV2::IOUSBDeviceUserClientV2(__int64 a1);
__int64 __fastcall IOUSBDeviceUserClientV2::~IOUSBDeviceUserClientV2(IOUSBDeviceUserClientV2 *__hidden this); // idb
__int64 __fastcall IOUSBDeviceUserClientV2::~IOUSBDeviceUserClientV2(IOUSBDeviceUserClientV2 *__hidden this); // idb
void __fastcall IOUSBDeviceUserClientV2::~IOUSBDeviceUserClientV2(IOUSBDeviceUserClientV2 *this);
__int64 __fastcall IOUSBDeviceUserClientV2::getMetaClass(IOUSBDeviceUserClientV2 *__hidden this); // idb
__int64 __fastcall IOUSBDeviceUserClientV2::MetaClass::MetaClass(IOUSBDeviceUserClientV2::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBDeviceUserClientV2::MetaClass::alloc(IOUSBDeviceUserClientV2::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall IOUSBDeviceUserClientV2::IOUSBDeviceUserClientV2(__int64 a1);
__int64 __fastcall IOUSBDeviceUserClientV2::IOUSBDeviceUserClientV2(__int64 a1);
signed __int64 __fastcall IOUSBDeviceUserClientV2::_open(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBDeviceUserClientV2::_close(IOService *this); // idb
signed __int64 __fastcall IOUSBDeviceUserClientV2::_SetConfiguration(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBDeviceUserClientV2::_GetConfiguration(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBDeviceUserClientV2::_GetConfigDescriptor(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBDeviceUserClientV2::_GetFrameNumber(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBDeviceUserClientV2::_DeviceRequestOut(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBDeviceUserClientV2::_DeviceRequestIn(__int64 a1, __int64 a2, __int64 a3);
// __int64 __usercall IOUSBDeviceUserClientV2::_CreateInterfaceIterator@<rax>(__int64 a1@<rax>, __int64 a2@<rdx>, __int64 a3@<rdi>);
signed __int64 __fastcall IOUSBDeviceUserClientV2::_ResetDevice(__int64 a1);
signed __int64 __fastcall IOUSBDeviceUserClientV2::_SuspendDevice(__int64 a1, __int64 a2, __int64 a3);
signed __int64 __fastcall IOUSBDeviceUserClientV2::_AbortPipeZero(__int64 a1);
__int64 __fastcall IOUSBDeviceUserClientV2::_ReEnumerateDevice(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBDeviceUserClientV2::_GetMicroFrameNumber(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBDeviceUserClientV2::_GetFrameNumberWithTime(__int64 a1, __int64 a2, __int64 a3);
int __fastcall IOUSBDeviceUserClientV2::_SetAsyncPort(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBDeviceUserClientV2::_GetDeviceInformation(__int64 a1, __int64 a2, __int64 a3);
signed __int64 __fastcall IOUSBDeviceUserClientV2::_RequestExtraPower(__int64 a1, __int64 a2, __int64 a3);
signed __int64 __fastcall IOUSBDeviceUserClientV2::_ReturnExtraPower(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBDeviceUserClientV2::_GetExtraPowerAllocated(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBDeviceUserClientV2::_GetBandwidthAvailableForDevice(__int64 a1, __int64 a2, __int64 a3);
signed __int64 __fastcall IOUSBDeviceUserClientV2::_SetConfigurationV2(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBDeviceUserClientV2::_RegisterForNotification(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBDeviceUserClientV2::_UnregisterNotification(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBDeviceUserClientV2::_AcknowledgeNotification(__int64 a1, __int64 a2, __int64 a3);
int IOUSBDeviceUserClientV2::externalMethod();
signed __int64 __fastcall IOUSBDeviceUserClientV2::SetAsyncPort(__int64 a1, __int64 a2);
__int64 __fastcall IOUSBDeviceUserClientV2::ReqComplete(IOUSBDeviceUserClientV2 *this, void *a2, void *a3, unsigned int a4);
char __fastcall IOUSBDeviceUserClientV2::initWithTask(IOUSBDeviceUserClientV2 *this, task *a2, void *a3, unsigned int a4, OSDictionary *a5);
char __fastcall IOUSBDeviceUserClientV2::start(IOUSBDeviceUserClientV2 *this, IOService *a2);
__int64 __fastcall IOUSBDeviceUserClientV2::open(IOUSBDeviceUserClientV2 *this, unsigned __int8 a2);
int __fastcall IOUSBDeviceUserClientV2::closeGated(IOUSBDeviceUserClientV2 *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6);
__int64 __fastcall IOUSBDeviceUserClientV2::close(IOUSBDeviceUserClientV2 *__hidden this); // idb
__int64 __fastcall IOUSBDeviceUserClientV2::DeviceRequestIn(IOService *this, uintptr_t arg2, unsigned __int8 a3, unsigned __int16 a4, __int16 a5, unsigned __int64 a6, task *arg2a, unsigned int a8, unsigned int a9, task *a10);
__int64 __fastcall IOUSBDeviceUserClientV2::DeviceRequestIn(IOUSBDeviceUserClientV2 *this, char a2, char a3, __int16 a4, __int16 a5, unsigned int a6, unsigned int a7, void *a8, unsigned int *a9);
__int64 __fastcall IOUSBDeviceUserClientV2::DeviceRequestIn(IOUSBDeviceUserClientV2 *this, char a2, char a3, __int16 a4, __int16 a5, unsigned int a6, unsigned int a7, IOMemoryDescriptor *a8, unsigned int *a9);
__int64 __fastcall IOUSBDeviceUserClientV2::DeviceRequestOut(IOService *this, uintptr_t arg2, unsigned __int8 a3, unsigned __int16 a4, __int16 a5, unsigned __int64 a6, task *arg2a, unsigned int a8, unsigned int a9, task *a10);
__int64 __fastcall IOUSBDeviceUserClientV2::DeviceRequestOut(IOUSBDeviceUserClientV2 *this, char a2, char a3, __int16 a4, __int16 a5, unsigned int a6, unsigned int a7, const void *a8, unsigned int a9);
__int64 __fastcall IOUSBDeviceUserClientV2::DeviceRequestOut(IOUSBDeviceUserClientV2 *this, char a2, char a3, __int16 a4, __int16 a5, unsigned int a6, unsigned int a7, IOMemoryDescriptor *a8);
__int64 __fastcall IOUSBDeviceUserClientV2::SetConfiguration(IOUSBDeviceUserClientV2 *this, unsigned __int8); // idb
// __int64 __usercall IOUSBDeviceUserClientV2::GetConfiguration@<rax>(IOUSBDeviceUserClientV2 *this@<rdi>, unsigned __int64 *a2@<rsi>, __int64 a3@<rax>);
__int64 __fastcall IOUSBDeviceUserClientV2::GetConfigDescriptor(IOService *this, unsigned __int8 a2, void *a3, unsigned int *a4);
__int64 __fastcall IOUSBDeviceUserClientV2::GetConfigDescriptor(IOUSBDeviceUserClientV2 *this, unsigned __int8, IOMemoryDescriptor *, unsigned int *); // idb
__int64 __fastcall IOUSBDeviceUserClientV2::SetConfigurationV2(IOUSBDeviceUserClientV2 *this, IOUSBDeviceUserClientV2 *a2, unsigned __int8 a3, unsigned int a4);
__int64 __fastcall IOUSBDeviceUserClientV2::ResetDevice(IOUSBDeviceUserClientV2 *this); // idb
__int64 __fastcall IOUSBDeviceUserClientV2::SuspendDevice(IOUSBDeviceUserClientV2 *this, unsigned __int8 a2);
__int64 __fastcall IOUSBDeviceUserClientV2::ReEnumerateDevice(IOUSBDeviceUserClientV2 *this, unsigned int); // idb
__int64 __fastcall IOUSBDeviceUserClientV2::AbortPipeZero(IOUSBDeviceUserClientV2 *this); // idb
// __int64 __usercall IOUSBDeviceUserClientV2::GetDeviceInformation@<rax>(IOUSBDeviceUserClientV2 *this@<rdi>, unsigned __int64 *a2@<rsi>, __int64 a3@<rax>);
__int64 __fastcall IOUSBDeviceUserClientV2::RequestExtraPower(IOUSBDeviceUserClientV2 *this, signed int a2, unsigned int a3, unsigned __int64 *a4);
__int64 __fastcall IOUSBDeviceUserClientV2::ReturnExtraPower(IOUSBDeviceUserClientV2 *this, signed int a2, unsigned int a3);
__int64 __fastcall IOUSBDeviceUserClientV2::GetExtraPowerAllocated(IOUSBDeviceUserClientV2 *this, signed int a2, unsigned __int64 *a3);
__int64 __fastcall IOUSBDeviceUserClientV2::GetBandwidthAvailableForDevice(IOUSBDeviceUserClientV2 *this, unsigned __int64 *); // idb
__int64 __fastcall IOUSBDeviceUserClientV2::GetFrameNumber(IOService *this, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBDeviceUserClientV2::GetMicroFrameNumber(IOService *this, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBDeviceUserClientV2::GetFrameNumberWithTime(IOService *this, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBDeviceUserClientV2::RegisterForNotification(IOUSBDeviceUserClientV2 *this, uintptr_t arg2, uintptr_t arg3, unsigned __int64 *); // idb
__int64 __fastcall IOUSBDeviceUserClientV2::UnregisterNotification(uintptr_t arg1, uintptr_t arg2); // idb
int __fastcall IOUSBDeviceUserClientV2::AcknowledgeNotification(IOUSBDeviceUserClientV2 *this, __int64 a2);
__int64 __fastcall IOUSBDeviceUserClientV2::CreateInterfaceIterator(IOService *this, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBDeviceUserClientV2::clientClose(IOUSBDeviceUserClientV2 *this); // idb
int __fastcall IOUSBDeviceUserClientV2::ClientCloseEntry(IOUSBDeviceUserClientV2 *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6);
__int64 __fastcall IOUSBDeviceUserClientV2::ClientCloseGated(IOUSBDeviceUserClientV2 *this); // idb
int __fastcall IOUSBDeviceUserClientV2::clientDied(IOUSBDeviceUserClientV2 *this);
int __fastcall IOUSBDeviceUserClientV2::stop(IOUSBDeviceUserClientV2 *this, IOService *a2);
int __fastcall IOUSBDeviceUserClientV2::ReleaseWorkLoopAndGate(IOUSBDeviceUserClientV2 *this);
int __fastcall IOUSBDeviceUserClientV2::free(IOUSBDeviceUserClientV2 *this);
int __fastcall IOUSBDeviceUserClientV2::finalize(IOUSBDeviceUserClientV2 *this);
int __fastcall IOUSBDeviceUserClientV2::willTerminate(IOUSBDeviceUserClientV2 *this, IOService *a2, unsigned int a3);
int __fastcall IOUSBDeviceUserClientV2::didTerminate(IOUSBDeviceUserClientV2 *this, IOService *a2, unsigned int a3, bool *a4);
__int64 __fastcall IOUSBDeviceUserClientV2::message(IOUSBDeviceUserClientV2 *this, __int64 a2, IOService *a3, void *a4);
// int __usercall IOUSBDeviceUserClientV2::DecrementOutstandingIO@<eax>(uintptr_t arg1@<rdi>, __int64 a2@<rax>);
__int64 __fastcall IOUSBDeviceUserClientV2::ChangeOutstandingIO(IOUSBDeviceUserClientV2 *__hidden this, OSObject *, void *, void *, void *, void *); // idb
int __fastcall IOUSBDeviceUserClientV2::IncrementOutstandingIO(uintptr_t arg1);
// __int64 __usercall IOUSBDeviceUserClientV2::GetOutstandingIO@<rax>(IOUSBDeviceUserClientV2 *this@<rdi>, __int64 a2@<rax>);
__int64 __fastcall IOUSBDeviceUserClientV2::GetGatedOutstandingIO(IOUSBDeviceUserClientV2 *__hidden this, OSObject *, void *, void *, void *, void *); // idb
void IOUSBDeviceUserClientV2::PrintExternalMethodArgs();
signed __int64 IOUSBDeviceUserClientV2::CreateInterfaceIterator();
__int64 __fastcall IOUSBDeviceUserClientV2::_RESERVEDIOUSBDeviceUserClientV27(IOUSBDeviceUserClientV2 *__hidden this); // idb
__int64 __fastcall IOUSBDeviceUserClientV2::_RESERVEDIOUSBDeviceUserClientV28(IOUSBDeviceUserClientV2 *__hidden this); // idb
__int64 __fastcall IOUSBDeviceUserClientV2::_RESERVEDIOUSBDeviceUserClientV29(IOUSBDeviceUserClientV2 *__hidden this); // idb
__int64 __fastcall IOUSBDeviceUserClientV2::_RESERVEDIOUSBDeviceUserClientV210(IOUSBDeviceUserClientV2 *__hidden this); // idb
__int64 __fastcall IOUSBDeviceUserClientV2::_RESERVEDIOUSBDeviceUserClientV211(IOUSBDeviceUserClientV2 *__hidden this); // idb
__int64 __fastcall IOUSBDeviceUserClientV2::_RESERVEDIOUSBDeviceUserClientV212(IOUSBDeviceUserClientV2 *__hidden this); // idb
__int64 __fastcall IOUSBDeviceUserClientV2::_RESERVEDIOUSBDeviceUserClientV213(IOUSBDeviceUserClientV2 *__hidden this); // idb
__int64 __fastcall IOUSBDeviceUserClientV2::_RESERVEDIOUSBDeviceUserClientV214(IOUSBDeviceUserClientV2 *__hidden this); // idb
__int64 __fastcall IOUSBDeviceUserClientV2::_RESERVEDIOUSBDeviceUserClientV215(IOUSBDeviceUserClientV2 *__hidden this); // idb
__int64 __fastcall IOUSBDeviceUserClientV2::_RESERVEDIOUSBDeviceUserClientV216(IOUSBDeviceUserClientV2 *__hidden this); // idb
__int64 __fastcall IOUSBDeviceUserClientV2::_RESERVEDIOUSBDeviceUserClientV217(IOUSBDeviceUserClientV2 *__hidden this); // idb
__int64 __fastcall IOUSBDeviceUserClientV2::_RESERVEDIOUSBDeviceUserClientV218(IOUSBDeviceUserClientV2 *__hidden this); // idb
__int64 __fastcall IOUSBDeviceUserClientV2::_RESERVEDIOUSBDeviceUserClientV219(IOUSBDeviceUserClientV2 *__hidden this); // idb
__int64 __fastcall IOUSBNotification::MetaClass::~MetaClass(IOUSBNotification::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBDeviceUserClientV2::MetaClass::~MetaClass(IOUSBDeviceUserClientV2::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_16();
__int64 `global destructor keyed to'_a_16();
__int64 __fastcall IOUSBPipeV2::MetaClass::MetaClass(IOUSBPipeV2::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBPipeV2::MetaClass::~MetaClass(IOUSBPipeV2::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBPipeV2::IOUSBPipeV2(__int64 a1);
__int64 __fastcall IOUSBPipeV2::IOUSBPipeV2(__int64 a1);
__int64 __fastcall IOUSBPipeV2::~IOUSBPipeV2(IOUSBPipeV2 *__hidden this); // idb
__int64 __fastcall IOUSBPipeV2::~IOUSBPipeV2(IOUSBPipeV2 *__hidden this); // idb
void __fastcall IOUSBPipeV2::~IOUSBPipeV2(IOUSBPipeV2 *this);
__int64 __fastcall IOUSBPipeV2::getMetaClass(IOUSBPipeV2 *__hidden this); // idb
__int64 __fastcall IOUSBPipeV2::MetaClass::MetaClass(IOUSBPipeV2::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBPipeV2::MetaClass::alloc(IOUSBPipeV2::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall IOUSBPipeV2::IOUSBPipeV2(__int64 a1);
__int64 __fastcall IOUSBPipeV2::IOUSBPipeV2(__int64 a1);
char __fastcall IOUSBPipeV2::InitToEndpoint(uintptr_t arg1, uintptr_t arg2, uintptr_t a3, unsigned __int8 a4, unsigned __int16 a5, OSMetaClassBase *a6, __int64 a7, __int64 a8);
__int64 __fastcall IOUSBPipeV2::ToEndpoint(__int64 a1, unsigned __int64 a2, __int64 a3, __int64 a4, __int64 a5);
__int64 __fastcall IOUSBPipeV2::Abort(uintptr_t arg1, uintptr_t arg4); // idb
__int64 __fastcall IOUSBPipeV2::Read(uintptr_t arg1, unsigned int a2, __int64 a3, unsigned int a4, int a5, uintptr_t a6, __int64 a7, __int64 a8);
__int64 __fastcall IOUSBPipeV2::Write(uintptr_t arg1, __int64 a2, __int64 a3, unsigned int a4, int a5, uintptr_t a6, __int64 a7);
int __fastcall IOUSBPipeV2::CreateStreams(IOUSBPipeV2 *this, unsigned int a2, const OSMetaClass *a3);
__int64 __fastcall IOUSBPipeV2::SupportsStreams(IOUSBPipeV2 *__hidden this); // idb
__int64 __fastcall IOUSBPipeV2::GetConfiguredStreams(IOUSBPipeV2 *__hidden this); // idb
__int64 __fastcall IOUSBPipeV2::GetMaxBurst(IOUSBPipeV2 *__hidden this); // idb
__int64 __fastcall IOUSBPipeV2::GetMult(IOUSBPipeV2 *__hidden this); // idb
__int64 __fastcall IOUSBPipeV2::GetBytesPerInterval(IOUSBPipeV2 *__hidden this); // idb
__int64 __fastcall IOUSBPipeV2::GetSuperSpeedEndpointCompanionDescriptor(IOUSBPipeV2 *__hidden this); // idb
__int64 __fastcall IOUSBPipeV2::SetPipePolicy(IOUSBPipeV2 *this, unsigned __int16 a2, const OSMetaClass *a3);
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV20(IOUSBPipeV2 *__hidden this); // idb
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV21(IOUSBPipeV2 *__hidden this); // idb
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV22(IOUSBPipeV2 *__hidden this); // idb
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV23(IOUSBPipeV2 *__hidden this); // idb
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV24(IOUSBPipeV2 *__hidden this); // idb
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV25(IOUSBPipeV2 *__hidden this); // idb
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV26(IOUSBPipeV2 *__hidden this); // idb
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV27(IOUSBPipeV2 *__hidden this); // idb
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV28(IOUSBPipeV2 *__hidden this); // idb
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV29(IOUSBPipeV2 *__hidden this); // idb
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV210(IOUSBPipeV2 *__hidden this); // idb
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV211(IOUSBPipeV2 *__hidden this); // idb
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV212(IOUSBPipeV2 *__hidden this); // idb
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV213(IOUSBPipeV2 *__hidden this); // idb
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV214(IOUSBPipeV2 *__hidden this); // idb
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV215(IOUSBPipeV2 *__hidden this); // idb
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV216(IOUSBPipeV2 *__hidden this); // idb
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV217(IOUSBPipeV2 *__hidden this); // idb
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV218(IOUSBPipeV2 *__hidden this); // idb
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV219(IOUSBPipeV2 *__hidden this); // idb
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV220(IOUSBPipeV2 *__hidden this); // idb
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV221(IOUSBPipeV2 *__hidden this); // idb
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV222(IOUSBPipeV2 *__hidden this); // idb
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV223(IOUSBPipeV2 *__hidden this); // idb
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV224(IOUSBPipeV2 *__hidden this); // idb
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV225(IOUSBPipeV2 *__hidden this); // idb
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV226(IOUSBPipeV2 *__hidden this); // idb
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV227(IOUSBPipeV2 *__hidden this); // idb
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV228(IOUSBPipeV2 *__hidden this); // idb
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV229(IOUSBPipeV2 *__hidden this); // idb
__int64 __fastcall IOUSBPipeV2::MetaClass::~MetaClass(IOUSBPipeV2::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_17();
__int64 `global destructor keyed to'_a_17();
__int64 __fastcall IOUSBInterfaceUserClientV3::MetaClass::MetaClass(IOUSBInterfaceUserClientV3::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceUserClientV3::MetaClass::~MetaClass(IOUSBInterfaceUserClientV3::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceUserClientV3::IOUSBInterfaceUserClientV3(__int64 a1);
__int64 __fastcall IOUSBInterfaceUserClientV3::IOUSBInterfaceUserClientV3(__int64 a1);
__int64 __fastcall IOUSBInterfaceUserClientV3::~IOUSBInterfaceUserClientV3(IOUSBInterfaceUserClientV3 *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceUserClientV3::~IOUSBInterfaceUserClientV3(IOUSBInterfaceUserClientV3 *__hidden this); // idb
void __fastcall IOUSBInterfaceUserClientV3::~IOUSBInterfaceUserClientV3(IOUSBInterfaceUserClientV3 *this);
__int64 __fastcall IOUSBInterfaceUserClientV3::getMetaClass(IOUSBInterfaceUserClientV3 *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceUserClientV3::MetaClass::MetaClass(IOUSBInterfaceUserClientV3::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceUserClientV3::MetaClass::alloc(IOUSBInterfaceUserClientV3::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall IOUSBInterfaceUserClientV3::IOUSBInterfaceUserClientV3(__int64 a1);
__int64 __fastcall IOUSBInterfaceUserClientV3::IOUSBInterfaceUserClientV3(__int64 a1);
__int64 __fastcall IOUSBInterfaceUserClientV3::_supportsStreams(__int64 a1, __int64 a2, __int64 a3);
signed __int64 __fastcall IOUSBInterfaceUserClientV3::_createStreams(__int64 a1, __int64 a2, __int64 a3);
signed __int64 __fastcall IOUSBInterfaceUserClientV3::_getConfiguredStreams(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBInterfaceUserClientV3::_ReadStreamsPipe(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBInterfaceUserClientV3::_WriteStreamsPipe(__int64 a1, __int64 a2, __int64 a3);
signed __int64 __fastcall IOUSBInterfaceUserClientV3::_AbortStreamsPipe(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBInterfaceUserClientV3::_RegisterForNotification(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBInterfaceUserClientV3::_UnregisterNotification(__int64 a1, __int64 a2, __int64 a3);
__int64 __fastcall IOUSBInterfaceUserClientV3::_AcknowledgeNotification(__int64 a1, __int64 a2, __int64 a3);
signed __int64 __fastcall IOUSBInterfaceUserClientV3::_RegisterDriver(__int64 a1);
void __fastcall IOUSBInterfaceUserClientV3::free(IOUSBInterfaceUserClientV3 *this);
char __fastcall IOUSBInterfaceUserClientV3::initWithTask(IOUSBInterfaceUserClientV3 *this, task *a2, void *a3, __int64 a4, OSDictionary *a5);
int IOUSBInterfaceUserClientV3::externalMethod();
__int64 __fastcall IOUSBInterfaceUserClientV3::SupportsStreams(IOUSBInterfaceUserClientV3 *this, unsigned __int8, unsigned __int64 *); // idb
__int64 __fastcall IOUSBInterfaceUserClientV3::CreateStreams(IOUSBInterfaceUserClientV3 *this, unsigned __int8, unsigned int); // idb
__int64 __fastcall IOUSBInterfaceUserClientV3::GetConfiguredStreams(IOUSBInterfaceUserClientV3 *this, unsigned __int8, unsigned __int64 *); // idb
int __fastcall IOUSBInterfaceUserClientV3::ReadPipe(__int64 a1, __int64 a2, unsigned int a3, unsigned int a4, __int64 a5);
int __fastcall IOUSBInterfaceUserClientV3::ReadPipe(IOUSBInterfaceUserClientV3 *this, __int64 a2, unsigned int a3, unsigned int a4, void *a5, unsigned int *a6);
int __fastcall IOUSBInterfaceUserClientV3::ReadPipe(IOUSBInterfaceUserClientV3 *this, __int64 a2, unsigned int a3, unsigned int a4, IOMemoryDescriptor *a5, unsigned __int64 *a6);
int __fastcall IOUSBInterfaceUserClientV3::WritePipe(__int64 a1, __int64 a2, unsigned int a3, unsigned int a4, __int64 a5);
int __fastcall IOUSBInterfaceUserClientV3::WritePipe(IOUSBInterfaceUserClientV3 *this, __int64 a2, unsigned int a3, unsigned int a4, const void *a5);
int __fastcall IOUSBInterfaceUserClientV3::WritePipe(IOUSBInterfaceUserClientV3 *this, __int64 a2, unsigned int a3, unsigned int a4, IOMemoryDescriptor *a5);
void __fastcall IOUSBInterfaceUserClientV3::ClientCloseGated(IOUSBInterfaceUserClientV3 *this);
__int64 __fastcall IOUSBInterfaceUserClientV3::ReadStreamsPipe(IOService *this, unsigned __int8 a2, unsigned int a3, unsigned int a4, unsigned int a5, IOMemoryDescriptor *a6, unsigned __int64 a7, __int64 a8);
__int64 __fastcall IOUSBInterfaceUserClientV3::ReadStreamsPipe(IOUSBInterfaceUserClientV3 *this, unsigned __int8, unsigned int, unsigned int, unsigned int, void *, unsigned int *); // idb
__int64 __fastcall IOUSBInterfaceUserClientV3::ReadStreamsPipe(IOUSBInterfaceUserClientV3 *this, unsigned __int8 a2, int a3, unsigned int a4, unsigned int a5, IOMemoryDescriptor *a6, unsigned __int64 *a7);
__int64 __fastcall IOUSBInterfaceUserClientV3::WriteStreamsPipe(IOService *this, unsigned __int8 a2, unsigned int a3, unsigned int a4, unsigned int a5, IOMemoryDescriptor *a6, unsigned __int64 a7, __int64 a8);
__int64 __fastcall IOUSBInterfaceUserClientV3::WriteStreamsPipe(IOUSBInterfaceUserClientV3 *this, void *, unsigned int, unsigned int, unsigned int, const void *, unsigned int); // idb
__int64 __fastcall IOUSBInterfaceUserClientV3::WriteStreamsPipe(IOUSBInterfaceUserClientV3 *this, unsigned __int8 a2, int a3, unsigned int a4, unsigned int a5, IOMemoryDescriptor *a6);
__int64 __fastcall IOUSBInterfaceUserClientV3::AbortStreamsPipe(IOUSBInterfaceUserClientV3 *this, unsigned __int8, unsigned int); // idb
__int64 __fastcall IOUSBInterfaceUserClientV3::RegisterForNotification(IOUSBInterfaceUserClientV3 *this, uintptr_t arg2, unsigned __int64 (*)[8], unsigned __int64 *); // idb
__int64 __fastcall IOUSBInterfaceUserClientV3::UnregisterNotification(uintptr_t arg1, uintptr_t arg2); // idb
int __fastcall IOUSBInterfaceUserClientV3::AcknowledgeNotification(IOUSBInterfaceUserClientV3 *this, __int64 a2);
__int64 __fastcall IOUSBInterfaceUserClientV3::RegisterDriver(IOUSBInterfaceUserClientV3 *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceUserClientV3::_RESERVEDIOUSBInterfaceUserClientV34(IOUSBInterfaceUserClientV3 *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceUserClientV3::_RESERVEDIOUSBInterfaceUserClientV35(IOUSBInterfaceUserClientV3 *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceUserClientV3::_RESERVEDIOUSBInterfaceUserClientV36(IOUSBInterfaceUserClientV3 *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceUserClientV3::_RESERVEDIOUSBInterfaceUserClientV37(IOUSBInterfaceUserClientV3 *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceUserClientV3::_RESERVEDIOUSBInterfaceUserClientV38(IOUSBInterfaceUserClientV3 *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceUserClientV3::_RESERVEDIOUSBInterfaceUserClientV39(IOUSBInterfaceUserClientV3 *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceUserClientV3::_RESERVEDIOUSBInterfaceUserClientV310(IOUSBInterfaceUserClientV3 *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceUserClientV3::_RESERVEDIOUSBInterfaceUserClientV311(IOUSBInterfaceUserClientV3 *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceUserClientV3::_RESERVEDIOUSBInterfaceUserClientV312(IOUSBInterfaceUserClientV3 *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceUserClientV3::_RESERVEDIOUSBInterfaceUserClientV313(IOUSBInterfaceUserClientV3 *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceUserClientV3::_RESERVEDIOUSBInterfaceUserClientV314(IOUSBInterfaceUserClientV3 *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceUserClientV3::_RESERVEDIOUSBInterfaceUserClientV315(IOUSBInterfaceUserClientV3 *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceUserClientV3::_RESERVEDIOUSBInterfaceUserClientV316(IOUSBInterfaceUserClientV3 *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceUserClientV3::_RESERVEDIOUSBInterfaceUserClientV317(IOUSBInterfaceUserClientV3 *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceUserClientV3::_RESERVEDIOUSBInterfaceUserClientV318(IOUSBInterfaceUserClientV3 *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceUserClientV3::_RESERVEDIOUSBInterfaceUserClientV319(IOUSBInterfaceUserClientV3 *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceUserClientV3::_RESERVEDIOUSBInterfaceUserClientV320(IOUSBInterfaceUserClientV3 *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceUserClientV3::_RESERVEDIOUSBInterfaceUserClientV321(IOUSBInterfaceUserClientV3 *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceUserClientV3::_RESERVEDIOUSBInterfaceUserClientV322(IOUSBInterfaceUserClientV3 *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceUserClientV3::_RESERVEDIOUSBInterfaceUserClientV323(IOUSBInterfaceUserClientV3 *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceUserClientV3::_RESERVEDIOUSBInterfaceUserClientV324(IOUSBInterfaceUserClientV3 *__hidden this); // idb
__int64 __fastcall IOUSBInterfaceUserClientV3::MetaClass::~MetaClass(IOUSBInterfaceUserClientV3::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_18();
__int64 `global destructor keyed to'_a_18();
__int64 __fastcall AppleUSBDiagnostics::MetaClass::MetaClass(AppleUSBDiagnostics::MetaClass *__hidden this); // idb
__int64 __fastcall AppleUSBDiagnostics::MetaClass::~MetaClass(AppleUSBDiagnostics::MetaClass *__hidden this); // idb
__int64 __fastcall AppleUSBDiagnostics::AppleUSBDiagnostics(__int64 a1);
__int64 __fastcall AppleUSBDiagnostics::AppleUSBDiagnostics(__int64 a1);
__int64 __fastcall AppleUSBDiagnostics::~AppleUSBDiagnostics(AppleUSBDiagnostics *__hidden this); // idb
__int64 __fastcall AppleUSBDiagnostics::~AppleUSBDiagnostics(AppleUSBDiagnostics *__hidden this); // idb
void __fastcall AppleUSBDiagnostics::~AppleUSBDiagnostics(AppleUSBDiagnostics *this);
__int64 __fastcall AppleUSBDiagnostics::getMetaClass(AppleUSBDiagnostics *__hidden this); // idb
__int64 __fastcall AppleUSBDiagnostics::MetaClass::MetaClass(AppleUSBDiagnostics::MetaClass *__hidden this); // idb
__int64 __fastcall AppleUSBDiagnostics::MetaClass::alloc(AppleUSBDiagnostics::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall AppleUSBDiagnostics::AppleUSBDiagnostics(__int64 a1);
__int64 __fastcall AppleUSBDiagnostics::AppleUSBDiagnostics(__int64 a1);
int __fastcall AppleUSBDiagnostics::createDiagnostics(__int64 a1, unsigned __int64 a2, __int64 a3);
__int64 __fastcall AppleUSBDiagnostics::initDiagnostics(__int64 a1, __int64 a2, void *a3, __int64 a4, __int64 a5);
int __fastcall AppleUSBDiagnostics::serializePort(__int64 a1, __int64 a2, __int64 a3, __int64 a4);
char __fastcall AppleUSBDiagnostics::serialize(__int64 a1, __int64 a2);
int __fastcall AppleUSBDiagnostics::UpdateNumberEntry(AppleUSBDiagnostics *this, OSDictionary *a2, unsigned int a3, const char *a4);
__int64 __fastcall AppleUSBDiagnostics::MetaClass::~MetaClass(AppleUSBDiagnostics::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a_19();
__int64 `global destructor keyed to'_a_19();
int _start();
__int64 *OSKextGetCurrentIdentifier();
__int64 *OSKextGetCurrentVersionString();
__int64 OSKextGetCurrentLoadTag();
int _stop();
// int __fastcall IOFindNameForValue(_QWORD, _QWORD); weak
// int __fastcall IOFree(_QWORD, _QWORD); weak
// int __cdecl IOLockAlloc(_QWORD); weak
// int __fastcall IOLockFree(_QWORD); weak
// int __fastcall IOLockLock(_QWORD); weak
// int __fastcall IOLockUnlock(_QWORD); weak
// int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall IOLogv(_QWORD, _QWORD); weak
// int __fastcall IOMalloc(_QWORD); weak
// int __fastcall IORecursiveLockAllocWithLockGroup(_QWORD); weak
// int __fastcall IORecursiveLockLock(_QWORD); weak
// int __fastcall IORecursiveLockSleepDeadline(_QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall IORecursiveLockWakeup(_QWORD, _QWORD, _QWORD); weak
// int __fastcall IOSleep(_QWORD); weak
// unsigned int __cdecl OSBacktrace(void **bt, unsigned int maxAddrs);
// int __fastcall OSCompareAndSwap(_QWORD, _QWORD, _QWORD); weak
// int __fastcall OSDecrementAtomic(_QWORD); weak
// int __fastcall OSIncrementAtomic(_QWORD); weak
// int __fastcall PEGetModelName(_QWORD, _QWORD); weak
// int __fastcall PE_parse_boot_argn(_QWORD, _QWORD, _QWORD); weak
// int __cdecl IOWorkLoop::IOWorkLoop(_QWORD); weak
// _QWORD __cdecl IOWorkLoop::~IOWorkLoop(IOWorkLoop *__hidden this); idb
// int __cdecl OSIterator::OSIterator(_QWORD); weak
// _QWORD __cdecl OSIterator::~OSIterator(OSIterator *__hidden this); idb
// _QWORD __cdecl IOPCIDevice::extendedConfigRead16(IOPCIDevice *__hidden this, unsigned __int64); idb
// _QWORD __cdecl IOPCIDevice::extendedConfigRead32(IOPCIDevice *__hidden this, unsigned __int64); idb
// _QWORD __cdecl IOPCIDevice::extendedConfigWrite16(IOPCIDevice *__hidden this, unsigned __int64, unsigned __int16); idb
// _QWORD __cdecl IOPCIDevice::extendedConfigWrite32(IOPCIDevice *__hidden this, unsigned __int64, unsigned int); idb
// int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD); weak
// _QWORD __cdecl OSMetaClass::~OSMetaClass(OSMetaClass *__hidden this); idb
// int __fastcall IODMACommand::withSpecification(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD); weak
// _QWORD __cdecl IOUserClient::sendAsyncResult64(IOUserClient *__hidden this, unsigned __int64 *, int, unsigned __int64 *, unsigned int); idb
// _QWORD __cdecl IOUserClient::clientHasPrivilege(IOUserClient *__hidden this, void *, const char *); idb
// _QWORD __cdecl IOUserClient::copyClientEntitlement(IOUserClient *__hidden this, task *, const char *); idb
// _QWORD __cdecl IOUserClient::clientHasAuthorization(IOUserClient *__hidden this, task *, IOService *); weak
// _QWORD __cdecl IOUserClient::releaseAsyncReference64(IOUserClient *__hidden this, unsigned __int64 *); idb
// int __cdecl IOUserClient::releaseNotificationPort(_QWORD); weak
// int __cdecl IOUserClient::IOUserClient(_QWORD); weak
// _QWORD __cdecl IOUserClient::~IOUserClient(IOUserClient *__hidden this); idb
// _QWORD __cdecl OSDictionary::withCapacity(OSDictionary *__hidden this, unsigned int); idb
// _QWORD __cdecl IOCommandGate::commandGate(IOCommandGate *__hidden this, OSObject *, int (__cdecl *)(OSObject *, void *, void *, void *, void *)); idb
// _QWORD __cdecl IOCommandPool::IOCommandPool(IOCommandPool *__hidden this, const OSMetaClass *); idb
// _QWORD __cdecl IOCommandPool::~IOCommandPool(IOCommandPool *__hidden this); idb
// _QWORD __cdecl IOPMrootDomain::createPMAssertion(IOPMrootDomain *__hidden this, unsigned __int64, unsigned int, IOService *, const char *); weak
// _QWORD __cdecl IOPMrootDomain::releasePMAssertion(IOPMrootDomain *__hidden this, unsigned __int64); idb
// _QWORD __cdecl IOPMrootDomain::setPMAssertionLevel(IOPMrootDomain *__hidden this, unsigned __int64, unsigned int); idb
// _QWORD IORegistryEntry::getRegistryRoot(IORegistryEntry *__hidden this); idb
// _QWORD IORegistryEntry::getRegistryEntryID(IORegistryEntry *__hidden this); idb
// int __fastcall IORegistryEntry::fromPath(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD); weak
// _QWORD __cdecl IORegistryEntry::getPlane(IORegistryEntry *__hidden this, const char *); idb
// _QWORD __cdecl IORegistryEntry::makePlane(IORegistryEntry *__hidden this, const char *); idb
// _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *); weak
// _QWORD __cdecl IOMemoryDescriptor::withAddress(IOMemoryDescriptor *__hidden this, void *, unsigned __int64, unsigned int); idb
// _QWORD __cdecl IOMemoryDescriptor::withAddressRange(IOMemoryDescriptor *__hidden this, unsigned __int64, unsigned __int64, unsigned int, task *); idb
// _QWORD __cdecl IOMemoryDescriptor::createMappingInTask(IOMemoryDescriptor *__hidden this, task *, unsigned __int64, unsigned int, unsigned __int64, unsigned __int64); idb
// int __fastcall IORegistryIterator::iterateOver(_QWORD, _QWORD, _QWORD); weak
// int __fastcall IOTimerEventSource::timerEventSource(_QWORD, _QWORD); weak
// int __fastcall OSCollectionIterator::withCollection(_QWORD, _QWORD); weak
// _QWORD __cdecl IOSubMemoryDescriptor::withSubRange(IOSubMemoryDescriptor *__hidden this, IOMemoryDescriptor *, unsigned __int64, unsigned __int64, unsigned int); idb
// int __fastcall IOInterruptEventSource::interruptEventSource(_QWORD, _QWORD, _QWORD, _QWORD); weak
// _QWORD __cdecl IOBufferMemoryDescriptor::withOptions(IOBufferMemoryDescriptor *__hidden this, unsigned int, unsigned __int64, unsigned __int64); idb
// _QWORD __cdecl IOBufferMemoryDescriptor::withCapacity(IOBufferMemoryDescriptor *__hidden this, unsigned __int64, unsigned int, bool); idb
// _QWORD __cdecl IOBufferMemoryDescriptor::inTaskWithPhysicalMask(IOBufferMemoryDescriptor *__hidden this, task *, unsigned int, unsigned __int64, unsigned __int64); idb
// _QWORD __cdecl IOBufferMemoryDescriptor::withBytes(IOBufferMemoryDescriptor *__hidden this, const void *, unsigned __int64, unsigned int, bool); idb
// _QWORD __cdecl OSSet::withCapacity(OSSet *__hidden this, unsigned int); idb
// _QWORD __cdecl OSData::withCapacity(OSData *__hidden this, unsigned int); idb
// _QWORD __cdecl OSArray::withCapacity(OSArray *__hidden this, unsigned int); idb
// _QWORD __cdecl OSArray::withArray(OSArray *__hidden this, const OSArray *, unsigned int); idb
// _QWORD __cdecl OSNumber::withNumber(OSNumber *__hidden this, unsigned __int64, unsigned int); idb
// int __cdecl OSObject::OSObject(_QWORD); weak
// _QWORD __cdecl OSObject::~OSObject(OSObject *__hidden this); idb
// void __cdecl OSObject::operator delete(void *); idb
// _QWORD __cdecl OSObject::operator new(OSObject *__hidden this, unsigned __int64); idb
// _QWORD __cdecl OSString::withCString(OSString *__hidden this, const char *); idb
// _QWORD __cdecl OSSymbol::withCString(OSSymbol *__hidden this, const char *); idb
// _QWORD __cdecl IOCommand::IOCommand(IOCommand *__hidden this, const OSMetaClass *); idb
// _QWORD __cdecl IOCommand::~IOCommand(IOCommand *__hidden this); idb
// _QWORD IOService::makeUsable(IOService *__hidden this); idb
// _QWORD IOService::getPlatform(IOService *__hidden this); idb
// _QWORD IOService::getPowerState(IOService *__hidden this); idb
// _QWORD IOService::getServiceRoot(IOService *__hidden this); idb
// _QWORD IOService::getPMRootDomain(IOService *__hidden this); idb
// _QWORD __cdecl IOService::serviceMatching(IOService *__hidden this, const char *, OSDictionary *); idb
// _QWORD __cdecl IOService::changePowerStateTo(IOService *__hidden this, unsigned __int64); idb
// _QWORD IOService::getResourceService(IOService *__hidden this); idb
// _QWORD __cdecl IOService::requireMaxBusStall(IOService *__hidden this, unsigned int); idb
// _QWORD __cdecl IOService::getMatchingServices(IOService *__hidden this, OSDictionary *); idb
// _QWORD IOService::powerOverrideOnPriv(IOService *__hidden this); idb
// _QWORD IOService::powerOverrideOffPriv(IOService *__hidden this); idb
// _QWORD __cdecl IOService::changePowerStateToPriv(IOService *__hidden this, unsigned __int64); idb
// _QWORD __cdecl IOService::waitForMatchingService(IOService *__hidden this, OSDictionary *, unsigned __int64); idb
// _QWORD __cdecl IOService::registerInterestedDriver(IOService *__hidden this, IOService *); idb
// _QWORD __cdecl IOService::requireMaxInterruptDelay(IOService *__hidden this, unsigned int); idb
// _QWORD __cdecl IOService::deRegisterInterestedDriver(IOService *__hidden this, IOService *); idb
// int __cdecl IOService::IOService(_QWORD); weak
// _QWORD __cdecl IOService::~IOService(IOService *__hidden this); idb
// _QWORD __cdecl OSMetaClass::reservedCalled(OSMetaClass *__hidden this, int); idb
// _QWORD OSMetaClass::instanceConstructed(OSMetaClass *__hidden this); idb
// _QWORD __cdecl OSMetaClassBase::metaCast(OSMetaClassBase *__hidden this, const char *); idb
// _QWORD IOService::isInactive(IOService *__hidden this); idb
// void __cdecl operator delete(void *); idb
// int __fastcall __bzero(_QWORD, _QWORD); weak
// int __fastcall absolutetime_to_nanoseconds(_QWORD, _QWORD); weak
// void __cdecl bcopy(const void *, void *, size_t);
// void __cdecl bzero(void *, size_t);
// int __fastcall clock_get_uptime(_QWORD); weak
// int __fastcall clock_interval_to_deadline(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD); weak
// void __cdecl kernel_debug(uint32_t debugid, uintptr_t arg1, uintptr_t arg2, uintptr_t arg3, uintptr_t arg4, uintptr_t arg5);
// int __fastcall lck_grp_alloc_init(_QWORD, _QWORD); weak
// int __cdecl lck_grp_free(_QWORD); weak
// uint64_t mach_absolute_time(void);
// int __cdecl memcmp(const void *, const void *, size_t);
// void panic(const char *, ...);
// int snprintf(char *, size_t, const char *, ...);
// size_t __cdecl strlcat(char *, const char *, size_t);
// size_t __cdecl strlcpy(char *, const char *, size_t);
// size_t __cdecl strlen(const char *);
// int __cdecl strncmp(const char *, const char *, size_t);
// unsigned __int64 __cdecl strtoul(const char *, char **, int);
// int __fastcall sysctl_register_oid(_QWORD); weak
// int __fastcall sysctl_unregister_oid(_QWORD); weak
// int __fastcall thread_call_allocate(_QWORD, _QWORD); weak
// int __fastcall thread_call_cancel(_QWORD); weak
// int __fastcall thread_call_enter1(_QWORD, _QWORD); weak
// int __fastcall thread_call_free(_QWORD); weak
// int __cdecl vsnprintf(char *, size_t, const char *, va_list);

//-------------------------------------------------------------------------
// Data declarations

int dword_0 = 4277009103; // weak
int dword_8 = 3; // weak
int dword_C = 11; // weak
int dword_10 = 8; // weak
segment_command_64 stru_20 = { 25u, 312u, "__TEXT", 0uLL, 241664uLL, 0uLL, 241664uLL, 7, 5, 3u, 0u }; // weak
section_64 stru_68 =
{
  {
    '_',
    '_',
    't',
    'e',
    'x',
    't',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0'
  },
  "__TEXT",
  2224uLL,
  222375uLL,
  2224u,
  4u,
  0u,
  0u,
  2147484672u,
  0u,
  0u,
  0u
}; // weak
section_64 stru_B8 =
{
  {
    '_',
    '_',
    'c',
    's',
    't',
    'r',
    'i',
    'n',
    'g',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0'
  },
  "__TEXT",
  224599uLL,
  15024uLL,
  224599u,
  0u,
  0u,
  0u,
  2u,
  0u,
  0u,
  0u
}; // weak
section_64 stru_108 =
{
  {
    '_',
    '_',
    'c',
    'o',
    'n',
    's',
    't',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0'
  },
  "__TEXT",
  239632uLL,
  2020uLL,
  239632u,
  4u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u
}; // weak
section_64 stru_1A0 =
{
  {
    '_',
    '_',
    'g',
    'o',
    't',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0',
    '\0'
  },
  "__DATA",
  241664uLL,
  272uLL,
  241664u,
  3u,
  0u,
  0u,
  0u,
  0u,
  0u,
  0u
}; // weak
segment_command_64 stru_3D0 =
{
  25u,
  72u,
  "__LINKEDIT",
  303104uLL,
  212992uLL,
  303104uLL,
  209424uLL,
  7,
  1,
  0u,
  0u
}; // weak
void *__ptr32 off_1ADE4[9] =
{
  (void *__ptr32 )0xFFFFFCA2LL,
  (void *__ptr32 )0xFFFFFD13LL,
  (void *__ptr32 )0xFFFFFDAELL,
  (void *__ptr32 )0xFFFFFFF3LL,
  (void *__ptr32 )0xFFFFFFF3LL,
  (void *__ptr32 )0xFFFFFE1FLL,
  (void *__ptr32 )0xFFFFFE64LL,
  (void *__ptr32 )0xFFFFFEC6LL,
  (void *__ptr32 )0xFFFFFF1ALL
}; // weak
void *__ptr32 off_1EDF4[4] =
{
  (void *__ptr32 )0xFFFFFD20LL,
  (void *__ptr32 )0xFFFFFD64LL,
  (void *__ptr32 )0xFFFFFDD8LL,
  (void *__ptr32 )0xFFFFFE21LL
}; // weak
void *__ptr32 off_25764[4] =
{
  (void *__ptr32 )0xFFFFFE91LL,
  (void *__ptr32 )0xFFFFFF0CLL,
  (void *__ptr32 )0xFFFFFF5DLL,
  (void *__ptr32 )0xFFFFFFAELL
}; // weak
void *__ptr32 off_25A9C[4] =
{
  (void *__ptr32 )0xFFFFFF09LL,
  (void *__ptr32 )0xFFFFFF3ELL,
  (void *__ptr32 )0xFFFFFF7ELL,
  (void *__ptr32 )0xFFFFFFBELL
}; // weak
__int64 qword_3A818[177] =
{
  7LL,
  8725727639834693LL,
  8LL,
  -281473500245567LL,
  112LL,
  -281473500180031LL,
  112LL,
  -281474975068053LL,
  80LL,
  1642603LL,
  32LL,
  -281474974216085LL,
  112LL,
  -281474972577685LL,
  80LL,
  -281474973233101LL,
  1552LL,
  -281474962026445LL,
  1040LL,
  13511005399224625LL,
  128LL,
  4785149095252417LL,
  256LL,
  1125913435078790LL,
  2156544LL,
  1125913435144326LL,
  2156544LL,
  1125913435209862LL,
  2156544LL,
  1125913435275398LL,
  2156544LL,
  1125913435340934LL,
  18432LL,
  71776119707697286LL,
  2156544LL,
  71776119707762822LL,
  2156544LL,
  71776119707828358LL,
  2156544LL,
  71776119707893894LL,
  2156544LL,
  71776119707959430LL,
  18432LL,
  71776119728668806LL,
  2156544LL,
  71776119728734342LL,
  2156544LL,
  71776119728799878LL,
  2156544LL,
  71776119728865414LL,
  2156544LL,
  71776119728930950LL,
  22528LL,
  71776119735484550LL,
  2156544LL,
  71776119735550086LL,
  2156544LL,
  71776119735615622LL,
  2156544LL,
  71776119735746694LL,
  2156544LL,
  71776119735812230LL,
  2156544LL,
  71776119735877766LL,
  18432LL,
  71776119736139910LL,
  18432LL,
  71776121226821766LL,
  59392LL,
  71776121226887302LL,
  59392LL,
  71776121226952838LL,
  59392LL,
  71776121227018374LL,
  18432LL,
  71776119239872734LL,
  1376256LL,
  71776119240069342LL,
  1376256LL,
  71776119239807198LL,
  131072LL,
  71776119239938270LL,
  131072LL,
  71776120037736582LL,
  2156544LL,
  71776120037802118LL,
  2156544LL,
  71776120037867654LL,
  2156544LL,
  71776120037933190LL,
  2156544LL,
  71776120037998726LL,
  2156544LL,
  71776120038064262LL,
  2156544LL,
  71776120038129798LL,
  18432LL,
  71776120038260870LL,
  18432LL,
  71776120054644870LL,
  4194304LL,
  71776120054710406LL,
  4194304LL,
  71776120054775942LL,
  4194304LL,
  71776120054841478LL,
  4194304LL,
  71776120054972550LL,
  4194304LL,
  71776120055169158LL,
  4194304LL,
  71776120055234694LL,
  4194304LL,
  71776120054513798LL,
  4194304LL,
  71776120055038086LL,
  4194304LL,
  71776119289614558LL,
  8388608LL,
  71776119289549022LL,
  8388608LL,
  71776119533568134LL,
  4194304LL,
  71776119533633670LL,
  4194304LL,
  71776119533699206LL,
  4194304LL,
  71776119533764742LL,
  4194304LL,
  71776119533895814LL,
  4194304LL,
  71776119534026886LL,
  4194304LL,
  71776119534092422LL,
  4194304LL,
  71776119533502598LL,
  4194304LL,
  71776119533961350LL,
  4194304LL,
  71776119567122566LL,
  4194304LL,
  71776119567188102LL,
  4194304LL,
  71776119567253638LL,
  4194304LL,
  71776119567319174LL,
  4194304LL,
  71776119567450246LL,
  4194304LL,
  71776119567581318LL,
  4194304LL,
  71776119567646854LL,
  4194304LL,
  71776119567057030LL,
  71303168LL,
  71776119567515782LL,
  71303168LL,
  71776119567777926LL,
  565627060224LL,
  71776121413271686LL,
  706824110080LL,
  71776121681707142LL,
  706824110080LL,
  71776121690095750LL,
  422902109306880LL,
  71776119329659763LL,
  134217728LL,
  4222124935879539LL,
  1720134402048LL,
  71776188065913715LL,
  136891345141760LL,
  71776119061224225LL,
  549755813888LL,
  71776119061224307LL,
  549755813888LL,
  71776119087697971LL,
  0LL
}; // weak
_QWORD IOUSBControllerUserClient::sMethods = 0LL; // weak
_QWORD (__cdecl *off_3B000)(void *, void *, int, unsigned int) = &IOUSBSyncCompletion; // weak
__int64 (__fastcall *off_3B008[4])() =
{
  &IOUSBSyncIsoCompletion,
  &IOWorkLoop::gMetaClass,
  &OSIterator::gMetaClass,
  &IOPCIDevice::metaClass
}; // weak
_QWORD *off_3B010[9] =
{
  &IOWorkLoop::gMetaClass,
  &OSIterator::gMetaClass,
  &IOPCIDevice::metaClass,
  &IODMACommand::OutputHost64,
  &IOUserClient::gMetaClass,
  &IOCommandPool::gMetaClass,
  &IOPCI2PCIBridge::metaClass,
  &IORegistryEntry::metaClass,
  &IOBufferMemoryDescriptor::metaClass
}; // weak
_QWORD *off_3B018[8] =
{
  &OSIterator::gMetaClass,
  &IOPCIDevice::metaClass,
  &IODMACommand::OutputHost64,
  &IOUserClient::gMetaClass,
  &IOCommandPool::gMetaClass,
  &IOPCI2PCIBridge::metaClass,
  &IORegistryEntry::metaClass,
  &IOBufferMemoryDescriptor::metaClass
}; // weak
_QWORD *off_3B020[7] =
{
  &IOPCIDevice::metaClass,
  &IODMACommand::OutputHost64,
  &IOUserClient::gMetaClass,
  &IOCommandPool::gMetaClass,
  &IOPCI2PCIBridge::metaClass,
  &IORegistryEntry::metaClass,
  &IOBufferMemoryDescriptor::metaClass
}; // weak
__int64 *off_3B028[6] =
{
  &IODMACommand::OutputHost64,
  &IOUserClient::gMetaClass,
  &IOCommandPool::gMetaClass,
  &IOPCI2PCIBridge::metaClass,
  &IORegistryEntry::metaClass,
  &IOBufferMemoryDescriptor::metaClass
}; // weak
_QWORD *off_3B030[5] =
{
  &IOUserClient::gMetaClass,
  &IOCommandPool::gMetaClass,
  &IOPCI2PCIBridge::metaClass,
  &IORegistryEntry::metaClass,
  &IOBufferMemoryDescriptor::metaClass
}; // weak
_QWORD *off_3B038[4] =
{
  &IOCommandPool::gMetaClass,
  &IOPCI2PCIBridge::metaClass,
  &IORegistryEntry::metaClass,
  &IOBufferMemoryDescriptor::metaClass
}; // weak
_QWORD *off_3B040[3] =
{
  &IOPCI2PCIBridge::metaClass,
  &IORegistryEntry::metaClass,
  &IOBufferMemoryDescriptor::metaClass
}; // weak
_QWORD *off_3B048[2] = { &IORegistryEntry::metaClass, &IOBufferMemoryDescriptor::metaClass }; // weak
_QWORD *off_3B050 = &IOBufferMemoryDescriptor::metaClass; // weak
void *off_3B058 = &IOUSBInterfaceUserClientV2::IsoReqComplete; // weak
void *off_3B060 = &IOUSBInterfaceUserClientV2::LowLatencyIsoReqComplete; // weak
_QWORD off_3B068[21] =
{
  514256LL,
  514272LL,
  514296LL,
  514304LL,
  514496LL,
  514512LL,
  514544LL,
  515728LL,
  516344LL,
  516352LL,
  516360LL,
  516368LL,
  516376LL,
  516384LL,
  516392LL,
  516432LL,
  516480LL,
  516488LL,
  516496LL,
  516504LL,
  516520LL
}; // weak
_QWORD off_3B070[20] =
{
  514272LL,
  514296LL,
  514304LL,
  514496LL,
  514512LL,
  514544LL,
  515728LL,
  516344LL,
  516352LL,
  516360LL,
  516368LL,
  516376LL,
  516384LL,
  516392LL,
  516432LL,
  516480LL,
  516488LL,
  516496LL,
  516504LL,
  516520LL
}; // weak
_QWORD off_3B078[19] =
{
  514296LL,
  514304LL,
  514496LL,
  514512LL,
  514544LL,
  515728LL,
  516344LL,
  516352LL,
  516360LL,
  516368LL,
  516376LL,
  516384LL,
  516392LL,
  516432LL,
  516480LL,
  516488LL,
  516496LL,
  516504LL,
  516520LL
}; // weak
_QWORD off_3B080[18] =
{
  514304LL,
  514496LL,
  514512LL,
  514544LL,
  515728LL,
  516344LL,
  516352LL,
  516360LL,
  516368LL,
  516376LL,
  516384LL,
  516392LL,
  516432LL,
  516480LL,
  516488LL,
  516496LL,
  516504LL,
  516520LL
}; // weak
_QWORD off_3B088[17] =
{
  514496LL,
  514512LL,
  514544LL,
  515728LL,
  516344LL,
  516352LL,
  516360LL,
  516368LL,
  516376LL,
  516384LL,
  516392LL,
  516432LL,
  516480LL,
  516488LL,
  516496LL,
  516504LL,
  516520LL
}; // weak
_QWORD off_3B090[16] =
{
  514512LL,
  514544LL,
  515728LL,
  516344LL,
  516352LL,
  516360LL,
  516368LL,
  516376LL,
  516384LL,
  516392LL,
  516432LL,
  516480LL,
  516488LL,
  516496LL,
  516504LL,
  516520LL
}; // weak
_QWORD off_3B098[15] =
{
  514544LL,
  515728LL,
  516344LL,
  516352LL,
  516360LL,
  516368LL,
  516376LL,
  516384LL,
  516392LL,
  516432LL,
  516480LL,
  516488LL,
  516496LL,
  516504LL,
  516520LL
}; // weak
_QWORD off_3B0A0[14] =
{
  515728LL,
  516344LL,
  516352LL,
  516360LL,
  516368LL,
  516376LL,
  516384LL,
  516392LL,
  516432LL,
  516480LL,
  516488LL,
  516496LL,
  516504LL,
  516520LL
}; // weak
__int64 off_3B0A8[13] =
{
  516344LL,
  516352LL,
  516360LL,
  516368LL,
  516376LL,
  516384LL,
  516392LL,
  516432LL,
  516480LL,
  516488LL,
  516496LL,
  516504LL,
  516520LL
}; // weak
__int64 off_3B0B0[12] =
{
  516352LL,
  516360LL,
  516368LL,
  516376LL,
  516384LL,
  516392LL,
  516432LL,
  516480LL,
  516488LL,
  516496LL,
  516504LL,
  516520LL
}; // weak
__int64 off_3B0B8[11] =
{
  516360LL,
  516368LL,
  516376LL,
  516384LL,
  516392LL,
  516432LL,
  516480LL,
  516488LL,
  516496LL,
  516504LL,
  516520LL
}; // weak
__int64 off_3B0C0[10] =
{
  516368LL,
  516376LL,
  516384LL,
  516392LL,
  516432LL,
  516480LL,
  516488LL,
  516496LL,
  516504LL,
  516520LL
}; // weak
__int64 off_3B0C8[9] =
{
  516376LL,
  516384LL,
  516392LL,
  516432LL,
  516480LL,
  516488LL,
  516496LL,
  516504LL,
  516520LL
}; // weak
__int64 off_3B0D0[8] =
{
  516384LL,
  516392LL,
  516432LL,
  516480LL,
  516488LL,
  516496LL,
  516504LL,
  516520LL
}; // weak
__int64 off_3B0D8[7] = { 516392LL, 516432LL, 516480LL, 516488LL, 516496LL, 516504LL, 516520LL }; // weak
__int64 off_3B0E0[6] = { 516432LL, 516480LL, 516488LL, 516496LL, 516504LL, 516520LL }; // weak
__int64 off_3B0E8[5] = { 516480LL, 516488LL, 516496LL, 516504LL, 516520LL }; // weak
__int64 off_3B0F0[4] = { 516488LL, 516496LL, 516504LL, 516520LL }; // weak
__int64 off_3B0F8[3] = { 516496LL, 516504LL, 516520LL }; // weak
__int64 off_3B100[2] = { 516504LL, 516520LL }; // weak
__int64 off_3B108 = 516520LL; // weak
__int64 `vtable for'IOUSBBus[2] = { 0LL, 0LL }; // weak
__int64 (__fastcall *off_3B280[2])(IOUSBBus *__hidden this) = { &IOUSBBus::~IOUSBBus, &IOUSBBus::~IOUSBBus }; // weak
__int64 (__fastcall *off_3BAF0[2])(IOUSBBus::MetaClass *__hidden this) = { &IOUSBBus::MetaClass::~MetaClass, &IOUSBBus::MetaClass::~MetaClass }; // weak
__int64 (__fastcall *off_3BBE0[2])(USBGlobals *__hidden this) = { &USBGlobals::~USBGlobals, &USBGlobals::~USBGlobals }; // weak
_QWORD IOUSBController::metaClass = 300424LL; // weak
__int64 `vtable for'IOUSBController[2] = { 0LL, 0LL }; // weak
__int64 (__fastcall *off_3BC20[2])(IOUSBController *__hidden this) = { &IOUSBController::~IOUSBController, &IOUSBController::~IOUSBController }; // weak
__int64 (__fastcall *off_3C690[2])(IOUSBController::MetaClass *__hidden this) =
{
  &IOUSBController::MetaClass::~MetaClass,
  &IOUSBController::MetaClass::~MetaClass
}; // weak
__int64 (__fastcall *off_3C780[2])(IOUSBController_ExtraCurrentIOLockClass *__hidden this) =
{
  &IOUSBController_ExtraCurrentIOLockClass::~IOUSBController_ExtraCurrentIOLockClass,
  &IOUSBController_ExtraCurrentIOLockClass::~IOUSBController_ExtraCurrentIOLockClass
}; // weak
_QWORD IOUSBInterface::metaClass = 300464LL; // weak
__int64 (__fastcall *off_3C7C0[2])(IOUSBInterface *__hidden this) = { &IOUSBInterface::~IOUSBInterface, &IOUSBInterface::~IOUSBInterface }; // weak
__int64 (__fastcall *off_3D170[2])(IOUSBInterface::MetaClass *__hidden this) =
{
  &IOUSBInterface::MetaClass::~MetaClass,
  &IOUSBInterface::MetaClass::~MetaClass
}; // weak
__int64 `vtable for'IOUSBNub[2] = { 0LL, 0LL }; // weak
__int64 (__fastcall *off_3D270[2])(IOUSBNub *__hidden this) = { &IOUSBNub::~IOUSBNub, &IOUSBNub::~IOUSBNub }; // weak
__int64 (__fastcall *off_3DAE0[2])(IOUSBNub::MetaClass *__hidden this) = { &IOUSBNub::MetaClass::~MetaClass, &IOUSBNub::MetaClass::~MetaClass }; // weak
_QWORD IOUSBPipe::metaClass = 300640LL; // weak
__int64 `vtable for'IOUSBPipe[2] = { 0LL, 0LL }; // weak
__int64 (__fastcall *off_3DBE0[2])(IOUSBPipe *__hidden this) = { &IOUSBPipe::~IOUSBPipe, &IOUSBPipe::~IOUSBPipe }; // weak
__int64 (__fastcall *off_3DE50[2])(IOUSBPipe::MetaClass *__hidden this) = { &IOUSBPipe::MetaClass::~MetaClass, &IOUSBPipe::MetaClass::~MetaClass }; // weak
_QWORD IOUSBRootHubDevice::metaClass = 300696LL; // weak
__int64 (__fastcall *off_3DF50[2])(IOUSBRootHubDevice *__hidden this) =
{
  &IOUSBRootHubDevice::~IOUSBRootHubDevice,
  &IOUSBRootHubDevice::~IOUSBRootHubDevice
}; // weak
__int64 (__fastcall *off_3EA50[2])(IOUSBRootHubDevice::MetaClass *__hidden this) =
{
  &IOUSBRootHubDevice::MetaClass::~MetaClass,
  &IOUSBRootHubDevice::MetaClass::~MetaClass
}; // weak
__int64 (__fastcall *off_3EB50[2])(IOUSBCommand *__hidden this) = { &IOUSBCommand::~IOUSBCommand, &IOUSBCommand::~IOUSBCommand }; // weak
__int64 (__fastcall *off_3EC80[2])(IOUSBCommand::MetaClass *__hidden this) = { &IOUSBCommand::MetaClass::~MetaClass, &IOUSBCommand::MetaClass::~MetaClass }; // weak
__int64 (__fastcall *off_3ED80[2])(IOUSBIsocCommand *__hidden this) = { &IOUSBIsocCommand::~IOUSBIsocCommand, &IOUSBIsocCommand::~IOUSBIsocCommand }; // weak
__int64 (__fastcall *off_3EEB0[2])(IOUSBIsocCommand::MetaClass *__hidden this) =
{
  &IOUSBIsocCommand::MetaClass::~MetaClass,
  &IOUSBIsocCommand::MetaClass::~MetaClass
}; // weak
__int64 (__fastcall *off_3EFB0[2])(IOUSBCommandPool *__hidden this) = { &IOUSBCommandPool::~IOUSBCommandPool, &IOUSBCommandPool::~IOUSBCommandPool }; // weak
__int64 (__fastcall *off_3F150[2])(IOUSBCommandPool::MetaClass *__hidden this) =
{
  &IOUSBCommandPool::MetaClass::~MetaClass,
  &IOUSBCommandPool::MetaClass::~MetaClass
}; // weak
__int64 (__fastcall *off_3F250[2])(IOUSBInterfaceIterator *__hidden this) =
{
  &IOUSBInterfaceIterator::~IOUSBInterfaceIterator,
  &IOUSBInterfaceIterator::~IOUSBInterfaceIterator
}; // weak
__int64 (__fastcall *off_3F3C0[2])(IOUSBInterfaceIterator::MetaClass *__hidden this) =
{
  &IOUSBInterfaceIterator::MetaClass::~MetaClass,
  &IOUSBInterfaceIterator::MetaClass::~MetaClass
}; // weak
_QWORD IOUSBDevice::metaClass = 300896LL; // weak
__int64 `vtable for'IOUSBDevice[2] = { 0LL, 0LL }; // weak
__int64 (__fastcall *off_3F4C0[2])(IOUSBDevice *__hidden this) = { &IOUSBDevice::~IOUSBDevice, &IOUSBDevice::~IOUSBDevice }; // weak
__int64 (__fastcall *off_3FEF0[2])(IOUSBDevice::MetaClass *__hidden this) = { &IOUSBDevice::MetaClass::~MetaClass, &IOUSBDevice::MetaClass::~MetaClass }; // weak
__int64 (__fastcall *off_3FFF0[2])(IOUSBWorkLoop *__hidden this) = { &IOUSBWorkLoop::~IOUSBWorkLoop, &IOUSBWorkLoop::~IOUSBWorkLoop }; // weak
__int64 (__fastcall *off_40210[2])(IOUSBWorkLoop::MetaClass *__hidden this) = { &IOUSBWorkLoop::MetaClass::~MetaClass, &IOUSBWorkLoop::MetaClass::~MetaClass }; // weak
__int64 (__fastcall *off_40310[2])(IOUSBControllerUserClient *__hidden this) =
{
  &IOUSBControllerUserClient::~IOUSBControllerUserClient,
  &IOUSBControllerUserClient::~IOUSBControllerUserClient
}; // weak
__int64 (__fastcall *off_40CF0[2])(IOUSBControllerUserClient::MetaClass *__hidden this) =
{
  &IOUSBControllerUserClient::MetaClass::~MetaClass,
  &IOUSBControllerUserClient::MetaClass::~MetaClass
}; // weak
__int64 (__fastcall *off_40DF0[2])(IOUSBLog *__hidden this) = { &IOUSBLog::~IOUSBLog, &IOUSBLog::~IOUSBLog }; // weak
__int64 (__fastcall *off_41680[2])(IOUSBLog::MetaClass *__hidden this) = { &IOUSBLog::MetaClass::~MetaClass, &IOUSBLog::MetaClass::~MetaClass }; // weak
__int64 IOUSBLog::stringFromReturn(int)::USBReturn_values = 3758112865LL; // weak
_QWORD IOUSBControllerV2::metaClass = 301064LL; // weak
__int64 `vtable for'IOUSBControllerV2[2] = { 0LL, 0LL }; // weak
__int64 (__fastcall *off_419E0[2])(IOUSBControllerV2 *__hidden this) =
{
  &IOUSBControllerV2::~IOUSBControllerV2,
  &IOUSBControllerV2::~IOUSBControllerV2
}; // weak
__int64 (__fastcall *off_42570[2])(IOUSBControllerV2::MetaClass *__hidden this) =
{
  &IOUSBControllerV2::MetaClass::~MetaClass,
  &IOUSBControllerV2::MetaClass::~MetaClass
}; // weak
__int64 (__fastcall *off_42670[2])(IOUSBControllerListElement *__hidden this) =
{
  &IOUSBControllerListElement::~IOUSBControllerListElement,
  &IOUSBControllerListElement::~IOUSBControllerListElement
}; // weak
__int64 (__fastcall *off_427C0[2])(IOUSBControllerListElement::MetaClass *__hidden this) =
{
  &IOUSBControllerListElement::MetaClass::~MetaClass,
  &IOUSBControllerListElement::MetaClass::~MetaClass
}; // weak
_QWORD IOUSBControllerIsochListElement::metaClass = 301144LL; // weak
__int64 (__fastcall *off_428C0[2])(IOUSBControllerIsochListElement *__hidden this) =
{
  &IOUSBControllerIsochListElement::~IOUSBControllerIsochListElement,
  &IOUSBControllerIsochListElement::~IOUSBControllerIsochListElement
}; // weak
__int64 (__fastcall *off_42A20[2])(IOUSBControllerIsochListElement::MetaClass *__hidden this) =
{
  &IOUSBControllerIsochListElement::MetaClass::~MetaClass,
  &IOUSBControllerIsochListElement::MetaClass::~MetaClass
}; // weak
__int64 (__fastcall *off_42B20[2])(IOUSBControllerIsochEndpoint *__hidden this) =
{
  &IOUSBControllerIsochEndpoint::~IOUSBControllerIsochEndpoint,
  &IOUSBControllerIsochEndpoint::~IOUSBControllerIsochEndpoint
}; // weak
__int64 (__fastcall *off_42C50[2])(IOUSBControllerIsochEndpoint::MetaClass *__hidden this) =
{
  &IOUSBControllerIsochEndpoint::MetaClass::~MetaClass,
  &IOUSBControllerIsochEndpoint::MetaClass::~MetaClass
}; // weak
_QWORD IOUSBHubDevice::metaClass = 301224LL; // weak
__int64 `vtable for'IOUSBHubDevice[2] = { 0LL, 0LL }; // weak
__int64 (__fastcall *off_42D50[2])(IOUSBHubDevice *__hidden this) = { &IOUSBHubDevice::~IOUSBHubDevice, &IOUSBHubDevice::~IOUSBHubDevice }; // weak
__int64 (__fastcall *off_43850[2])(IOUSBHubDevice::MetaClass *__hidden this) =
{
  &IOUSBHubDevice::MetaClass::~MetaClass,
  &IOUSBHubDevice::MetaClass::~MetaClass
}; // weak
__int64 (__fastcall *off_43950[2])(IOUSBHubPolicyMaker *__hidden this) =
{
  &IOUSBHubPolicyMaker::~IOUSBHubPolicyMaker,
  &IOUSBHubPolicyMaker::~IOUSBHubPolicyMaker
}; // weak
__int64 (__fastcall *off_44270[2])(IOUSBHubPolicyMaker::MetaClass *__hidden this) =
{
  &IOUSBHubPolicyMaker::MetaClass::~MetaClass,
  &IOUSBHubPolicyMaker::MetaClass::~MetaClass
}; // weak
_QWORD IOUSBControllerV3::metaClass = 301312LL; // weak
__int64 (__fastcall *off_44370[2])(IOUSBControllerV3 *__hidden this) =
{
  &IOUSBControllerV3::~IOUSBControllerV3,
  &IOUSBControllerV3::~IOUSBControllerV3
}; // weak
__int64 (__fastcall *off_450E0[2])(IOUSBControllerV3::MetaClass *__hidden this) =
{
  &IOUSBControllerV3::MetaClass::~MetaClass,
  &IOUSBControllerV3::MetaClass::~MetaClass
}; // weak
__int64 `vtable for'IOUSBInterfaceUserClientV2[2] = { 0LL, 0LL }; // weak
__int64 (__fastcall *off_451E0[2])(IOUSBInterfaceUserClientV2 *__hidden this) =
{
  &IOUSBInterfaceUserClientV2::~IOUSBInterfaceUserClientV2,
  &IOUSBInterfaceUserClientV2::~IOUSBInterfaceUserClientV2
}; // weak
__int64 (__fastcall *off_45D60[2])(IOUSBInterfaceUserClientV2::MetaClass *__hidden this) =
{
  &IOUSBInterfaceUserClientV2::MetaClass::~MetaClass,
  &IOUSBInterfaceUserClientV2::MetaClass::~MetaClass
}; // weak
__int64 (__fastcall *off_45E60[2])(IOUSBLowLatencyCommand *__hidden this) =
{
  &IOUSBLowLatencyCommand::~IOUSBLowLatencyCommand,
  &IOUSBLowLatencyCommand::~IOUSBLowLatencyCommand
}; // weak
__int64 (__fastcall *off_46040[2])(IOUSBLowLatencyCommand::MetaClass *__hidden this) =
{
  &IOUSBLowLatencyCommand::MetaClass::~MetaClass,
  &IOUSBLowLatencyCommand::MetaClass::~MetaClass
}; // weak
__int64 (__fastcall *off_46430[2])(IOUSBNotification *__hidden this) =
{
  &IOUSBNotification::~IOUSBNotification,
  &IOUSBNotification::~IOUSBNotification
}; // weak
__int64 (__fastcall *off_46560[2])(IOUSBNotification::MetaClass *__hidden this) =
{
  &IOUSBNotification::MetaClass::~MetaClass,
  &IOUSBNotification::MetaClass::~MetaClass
}; // weak
__int64 (__fastcall *off_46660[2])(IOUSBDeviceUserClientV2 *__hidden this) =
{
  &IOUSBDeviceUserClientV2::~IOUSBDeviceUserClientV2,
  &IOUSBDeviceUserClientV2::~IOUSBDeviceUserClientV2
}; // weak
__int64 (__fastcall *off_47160[2])(IOUSBDeviceUserClientV2::MetaClass *__hidden this) =
{
  &IOUSBDeviceUserClientV2::MetaClass::~MetaClass,
  &IOUSBDeviceUserClientV2::MetaClass::~MetaClass
}; // weak
_QWORD IOUSBPipeV2::metaClass = 301512LL; // weak
__int64 (__fastcall *off_474C0[2])(IOUSBPipeV2 *__hidden this) = { &IOUSBPipeV2::~IOUSBPipeV2, &IOUSBPipeV2::~IOUSBPipeV2 }; // weak
__int64 (__fastcall *off_47870[2])(IOUSBPipeV2::MetaClass *__hidden this) = { &IOUSBPipeV2::MetaClass::~MetaClass, &IOUSBPipeV2::MetaClass::~MetaClass }; // weak
__int64 (__fastcall *off_47970[2])(IOUSBInterfaceUserClientV3 *__hidden this) =
{
  &IOUSBInterfaceUserClientV3::~IOUSBInterfaceUserClientV3,
  &IOUSBInterfaceUserClientV3::~IOUSBInterfaceUserClientV3
}; // weak
__int64 (__fastcall *off_48600[2])(IOUSBInterfaceUserClientV3::MetaClass *__hidden this) =
{
  &IOUSBInterfaceUserClientV3::MetaClass::~MetaClass,
  &IOUSBInterfaceUserClientV3::MetaClass::~MetaClass
}; // weak
__int64 (__fastcall *off_48AE0[2])(AppleUSBDiagnostics *__hidden this) =
{
  &AppleUSBDiagnostics::~AppleUSBDiagnostics,
  &AppleUSBDiagnostics::~AppleUSBDiagnostics
}; // weak
__int64 (__fastcall *off_48C30[2])(AppleUSBDiagnostics::MetaClass *__hidden this) =
{
  &AppleUSBDiagnostics::MetaClass::~MetaClass,
  &AppleUSBDiagnostics::MetaClass::~MetaClass
}; // weak
int gEHCIBandwidthLogLevel = 7; // weak
int gEHCIRLvalue = 15; // weak
__int64 *sysctl__debug_USB = &sysctl__debug_children; // weak
char gSleepCurrentInfo[] = "iMac8,1"; // idb
int gKernelDebugLevel = 1; // weak
int gKernelDebugOutputType = 1; // weak
_QWORD ourPowerStates = 1LL; // weak
__int64 kmod_info = 0LL; // weak
_QWORD IOUSBBus::gMetaClass; // weak
int gUSBStackDebugFlags; // weak
int gXHCIEPlimit; // weak
_QWORD IOUSBController::_log; // weak
_QWORD IOUSBController::gIOUSBPlane; // weak
_QWORD IOUSBController::gUsedBusIDs; // weak
_QWORD IOUSBController::gExtraCurrentPropertiesInitialized; // weak
_QWORD IOUSBController::gExternalNonSSPortsUsingExtraCurrent; // weak
_QWORD IOUSBController::gMetaClass; // weak
_QWORD IOUSBInterface::gMetaClass; // weak
__int64 gUSBVendorID; // weak
__int64 gUSBProductID; // weak
__int64 gUSBInterfaceNumber; // weak
__int64 gUSBConfigurationValue; // weak
__int64 gUSBDeviceReleaseNumber; // weak
__int64 gUSBInterfaceClass; // weak
__int64 gUSBInterfaceSubClass; // weak
__int64 gUSBInterfaceProtocol; // weak
__int64 gUSBProductIDMask; // weak
__int64 gUSBDeviceClass; // weak
__int64 gUSBDeviceSubClass; // weak
__int64 gUSBDeviceProtocol; // weak
_QWORD IOUSBNub::gMetaClass; // weak
_QWORD IOUSBPipe::gMetaClass; // weak
__int64 gExtraCurrentIOLockClass; // weak
__int64 qword_49690; // weak
_QWORD IOUSBRootHubDevice::gMetaClass; // weak
_QWORD IOUSBCommand::gMetaClass; // weak
_QWORD IOUSBIsocCommand::gMetaClass; // weak
_QWORD IOUSBCommandPool::gMetaClass; // weak
_QWORD IOUSBInterfaceIterator::gMetaClass; // weak
_QWORD IOUSBDevice::gMetaClass; // weak
_QWORD IOUSBWorkLoop::gMetaClass; // weak
_QWORD IOUSBControllerUserClient::gMetaClass; // weak
__int64 gKernelLogger; // weak
_QWORD IOUSBLog::gMetaClass; // weak
_QWORD IOUSBControllerV2::gMetaClass; // weak
_QWORD IOUSBControllerListElement::gMetaClass; // weak
_QWORD IOUSBControllerIsochListElement::gMetaClass; // weak
_QWORD IOUSBControllerIsochEndpoint::gMetaClass; // weak
_QWORD IOUSBHubDevice::gMetaClass; // weak
_QWORD IOUSBHubPolicyMaker::gMetaClass; // weak
_QWORD IOUSBControllerV3::_gHibernateState; // weak
_QWORD IOUSBControllerV3::gMetaClass; // weak
_QWORD IOUSBInterfaceUserClientV2::gMetaClass; // weak
_QWORD IOUSBLowLatencyCommand::gMetaClass; // weak
_QWORD IOUSBNotification::gMetaClass; // weak
_QWORD IOUSBDeviceUserClientV2::gMetaClass; // weak
_QWORD IOUSBPipeV2::gMetaClass; // weak
_QWORD IOUSBInterfaceUserClientV3::gMetaClass; // weak
_QWORD AppleUSBDiagnostics::gMetaClass; // weak
int (*_realmain)(void); // weak
int (*_antimain)(void); // weak
_QWORD gUSBStackGlobals; // weak
_QWORD gExtraCurrentIOLockClass; // weak
__int64 qword_49A60; // weak


//----- (00000000000008B0) ----------------------------------------------------
__int64 __fastcall IOUSBBus::MetaClass::MetaClass(IOUSBBus::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBBus", off_3B098[0], 136LL);
  result = (__int64)off_3BAF0;
  *(_QWORD *)this = off_3BAF0;
  return result;
}
// 3B098: using guessed type _QWORD off_3B098[15];
// 3BAF0: using guessed type __int64 (__fastcall *off_3BAF0[2])(IOUSBBus::MetaClass *__hidden this);
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000008E2) ----------------------------------------------------
__int64 __fastcall IOUSBBus::MetaClass::~MetaClass(IOUSBBus::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (00000000000008EC) ----------------------------------------------------
__int64 __fastcall IOUSBBus::IOUSBBus(__int64 a1)
{
  __int64 result; // rax@1

  IOService::IOService(a1);
  result = (__int64)off_3B280;
  *(_QWORD *)a1 = off_3B280;
  return result;
}
// 3B280: using guessed type __int64 (__fastcall *off_3B280[2])(IOUSBBus *__hidden this);
// 7DEA0: using guessed type int __cdecl IOService::IOService(_QWORD);

//----- (000000000000090C) ----------------------------------------------------
__int64 __fastcall IOUSBBus::IOUSBBus(__int64 a1)
{
  __int64 result; // rax@1

  IOService::IOService(a1);
  result = (__int64)off_3B280;
  *(_QWORD *)a1 = off_3B280;
  return result;
}
// 3B280: using guessed type __int64 (__fastcall *off_3B280[2])(IOUSBBus *__hidden this);
// 7DEA0: using guessed type int __cdecl IOService::IOService(_QWORD);

//----- (000000000000092C) ----------------------------------------------------
__int64 __fastcall IOUSBBus::~IOUSBBus(IOUSBBus *this)
{
  return IOService::~IOService(this);
}

//----- (0000000000000936) ----------------------------------------------------
__int64 __fastcall IOUSBBus::~IOUSBBus(IOUSBBus *this)
{
  return IOService::~IOService(this);
}

//----- (0000000000000940) ----------------------------------------------------
void __fastcall IOUSBBus::~IOUSBBus(IOUSBBus *this)
{
  IOService::~IOService(this);
  OSObject::operator delete((void *)this);
}

//----- (0000000000000962) ----------------------------------------------------
__int64 __fastcall IOUSBBus::getMetaClass(IOUSBBus *this)
{
  return (__int64)&IOUSBBus::gMetaClass;
}
// 49430: using guessed type _QWORD IOUSBBus::gMetaClass;

//----- (0000000000000970) ----------------------------------------------------
__int64 __fastcall IOUSBBus::MetaClass::MetaClass(IOUSBBus::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBBus", off_3B098[0], 136LL);
  result = (__int64)off_3BAF0;
  *(_QWORD *)this = off_3BAF0;
  return result;
}
// 3B098: using guessed type _QWORD off_3B098[15];
// 3BAF0: using guessed type __int64 (__fastcall *off_3BAF0[2])(IOUSBBus::MetaClass *__hidden this);
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000009A2) ----------------------------------------------------
__int64 __fastcall IOUSBBus::MetaClass::alloc(IOUSBBus::MetaClass *this)
{
  return 0LL;
}

//----- (00000000000009AA) ----------------------------------------------------
__int64 __fastcall IOUSBBus::MetaClass::~MetaClass(IOUSBBus::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (00000000000009C0) ----------------------------------------------------
__int64 `global constructor keyed to'_a()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(&IOUSBBus::gMetaClass, "IOUSBBus", off_3B098[0], 136LL);
  result = (__int64)off_3BAF0;
  IOUSBBus::gMetaClass = off_3BAF0;
  return result;
}
// 3B098: using guessed type _QWORD off_3B098[15];
// 3BAF0: using guessed type __int64 (__fastcall *off_3BAF0[2])(IOUSBBus::MetaClass *__hidden this);
// 49430: using guessed type _QWORD IOUSBBus::gMetaClass;
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000000A00) ----------------------------------------------------
__int64 `global destructor keyed to'_a()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&IOUSBBus::gMetaClass);
}
// 49430: using guessed type _QWORD IOUSBBus::gMetaClass;

//----- (0000000000000A20) ----------------------------------------------------
int __fastcall USBGlobals::USBGlobals(USBGlobals *this)
{
  return USBGlobals::USBGlobals((__int64)this);
}

//----- (0000000000000A2A) ----------------------------------------------------
int __fastcall USBGlobals::~USBGlobals(USBGlobals *this)
{
  *(_QWORD *)this = off_3BBE0;
  return sysctl_unregister_oid(&sysctl__debug_USB);
}
// 3BBE0: using guessed type __int64 (__fastcall *off_3BBE0[2])(USBGlobals *__hidden this);
// 48D18: using guessed type __int64 *sysctl__debug_USB;
// 7E218: using guessed type int __fastcall sysctl_unregister_oid(_QWORD);

//----- (0000000000000A45) ----------------------------------------------------
int __fastcall USBSysctl(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // rbx@1
  int result; // eax@1
  int v6; // [sp+8h] [bp-18h]@1
  int v7; // [sp+Ch] [bp-14h]@3
  int v8; // [sp+10h] [bp-10h]@4

  v4 = a4;
  result = (*(int (__fastcall **)(__int64, int *, signed __int64))(a4 + 72))(a4, &v6, 12LL);
  if ( !result )
  {
    result = 0;
    if ( v6 == 1431519812 )
    {
      if ( v7 == 1 )
      {
        gUSBStackDebugFlags = v8;
      }
      else if ( !v7 )
      {
        v8 = gUSBStackDebugFlags;
        result = (*(int (__fastcall **)(__int64, int *, signed __int64))(v4 + 40))(v4, &v6, 12LL);
      }
    }
  }
  return result;
}
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (0000000000000AA6) ----------------------------------------------------
int __fastcall USBGlobals::USBGlobals(__int64 a1)
{
  int v2; // [sp+Ch] [bp-4h]@1

  *(_QWORD *)a1 = off_3BBE0;
  if ( PE_parse_boot_argn("usb", &v2, 4LL) )
    gUSBStackDebugFlags = v2;
  if ( PE_parse_boot_argn("ehciBWlogs", &v2, 4LL) && v2 <= 7 )
    gEHCIBandwidthLogLevel = v2;
  if ( PE_parse_boot_argn("ehciRL", &v2, 4LL) && v2 <= 15 )
    gEHCIRLvalue = v2;
  if ( PE_parse_boot_argn("xhcieps", &v2, 4LL) && v2 >= 96 )
    gXHCIEPlimit = v2;
  return sysctl_register_oid(&sysctl__debug_USB);
}
// 3BBE0: using guessed type __int64 (__fastcall *off_3BBE0[2])(USBGlobals *__hidden this);
// 48D10: using guessed type int gEHCIBandwidthLogLevel;
// 48D14: using guessed type int gEHCIRLvalue;
// 48D18: using guessed type __int64 *sysctl__debug_USB;
// 49460: using guessed type int gUSBStackDebugFlags;
// 49464: using guessed type int gXHCIEPlimit;
// 7D2A8: using guessed type int __fastcall PE_parse_boot_argn(_QWORD, _QWORD, _QWORD);
// 7E210: using guessed type int __fastcall sysctl_register_oid(_QWORD);

//----- (0000000000000B62) ----------------------------------------------------
int __fastcall USBGlobals::~USBGlobals(USBGlobals *this)
{
  *(_QWORD *)this = off_3BBE0;
  return sysctl_unregister_oid(&sysctl__debug_USB);
}
// 3BBE0: using guessed type __int64 (__fastcall *off_3BBE0[2])(USBGlobals *__hidden this);
// 48D18: using guessed type __int64 *sysctl__debug_USB;
// 7E218: using guessed type int __fastcall sysctl_unregister_oid(_QWORD);

//----- (0000000000000B7E) ----------------------------------------------------
void __fastcall USBGlobals::~USBGlobals(USBGlobals *this)
{
  *(_QWORD *)this = off_3BBE0;
  sysctl_unregister_oid(&sysctl__debug_USB);
  operator delete((void *)this);
}
// 3BBE0: using guessed type __int64 (__fastcall *off_3BBE0[2])(USBGlobals *__hidden this);
// 48D18: using guessed type __int64 *sysctl__debug_USB;
// 7E218: using guessed type int __fastcall sysctl_unregister_oid(_QWORD);

//----- (0000000000000BAC) ----------------------------------------------------
int __fastcall IOUSBController_ExtraCurrentIOLockClass::IOUSBController_ExtraCurrentIOLockClass(__int64 a1)
{
  __int64 v1; // rax@1

  *(_QWORD *)a1 = off_3C780;
  LODWORD(v1) = IOLockAlloc(a1);
  *(_QWORD *)(a1 + 8) = v1;
  return v1;
}
// 3C780: using guessed type __int64 (__fastcall *off_3C780[2])(IOUSBController_ExtraCurrentIOLockClass *__hidden this);
// 7D220: using guessed type int __cdecl IOLockAlloc(_QWORD);

//----- (0000000000000BD0) ----------------------------------------------------
int __fastcall IOUSBController_ExtraCurrentIOLockClass::~IOUSBController_ExtraCurrentIOLockClass(IOUSBController_ExtraCurrentIOLockClass *this)
{
  *(_QWORD *)this = off_3C780;
  return IOLockFree(*((_QWORD *)this + 1));
}
// 3C780: using guessed type __int64 (__fastcall *off_3C780[2])(IOUSBController_ExtraCurrentIOLockClass *__hidden this);
// 7D228: using guessed type int __fastcall IOLockFree(_QWORD);

//----- (0000000000000BE8) ----------------------------------------------------
void __usercall IOUSBSyncCompletion(void *a1@<rdi>, void *a2@<rsi>, char a3@<al>, unsigned int a4@<edx>, unsigned int a5@<ecx>, __int64 a6@<r8>, __int64 a7@<r9>)
{
  unsigned int v7; // er13@1
  __int64 v8; // rcx@1
  uintptr_t v9; // r14@2
  __int64 v10; // r15@3
  unsigned int v11; // ST04_4@7
  uintptr_t v12; // rsi@15
  uintptr_t v13; // r8@15

  v7 = a5;
  v8 = a4;
  if ( !a1 )
  {
    KernelDebugLogInternal(
      1u,
      0x55534246u,
      (__int64)"IOUSBController::IOUSBSyncCompletion syncTarget is NULL",
      a4,
      a6,
      a7,
      a3);
    if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
      return;
    v12 = 0LL;
    v13 = 0LL;
LABEL_22:
    kernel_debug(0x52D00B4u, v12, 0LL, 0LL, v13, 0LL);
    return;
  }
  v9 = *(_QWORD *)a1;
  if ( !*(_QWORD *)a1 )
  {
    KernelDebugLogInternal(
      1u,
      0x55534246u,
      (__int64)"IOUSBController::IOUSBSyncCompletion controller is NULL",
      a4,
      a6,
      a7,
      a3);
    if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
      return;
    v13 = 1LL;
    v12 = (uintptr_t)a1;
    goto LABEL_22;
  }
  v10 = *(_QWORD *)(v9 + 144);
  if ( !v10 )
  {
    KernelDebugLogInternal(
      1u,
      0x55534246u,
      (__int64)"IOUSBController::IOUSBSyncCompletion commandGate is NULL",
      a4,
      a6,
      a7,
      a3);
    if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
      return;
    v13 = 2LL;
    v12 = v9;
    goto LABEL_22;
  }
  if ( a2 )
  {
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      v11 = a4;
      kernel_debug(0x52D00B4u, v9, *(_DWORD *)a2, v7, 3uLL, 0LL);
      v8 = v11;
    }
    *(_DWORD *)a2 -= v7;
  }
  if ( gUSBStackDebugFlags & 2 )
  {
    if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D00B4u, v9, *((_QWORD *)a1 + 1), (signed int)v8, 4uLL, 0LL);
  }
  (*(void (__fastcall **)(__int64, _QWORD, signed __int64, __int64))(*(_QWORD *)v10 + 488LL))(
    v10,
    *((_QWORD *)a1 + 1),
    1LL,
    v8);
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (0000000000000DC2) ----------------------------------------------------
__int64 __fastcall IOUSBController::GetCommandGate(IOUSBController *this)
{
  return *((_QWORD *)this + 18);
}

//----- (0000000000000DCF) ----------------------------------------------------
void __usercall IOUSBSyncIsoCompletion(char a1@<al>, int a2@<edx>, __int64 a3@<rcx>, uintptr_t a4@<rdi>, __int64 a5@<r8>, __int64 a6@<r9>)
{
  uintptr_t v6; // r14@2
  __int64 v7; // r15@3
  uintptr_t v8; // rsi@10
  uintptr_t v9; // r8@10

  if ( !a4 )
  {
    KernelDebugLogInternal(
      1u,
      0x55534246u,
      (__int64)"IOUSBController::IOUSBSyncIsoCompletion syncTarget is NULL",
      a3,
      a5,
      a6,
      a1);
    if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
      return;
    v8 = 0LL;
    v9 = 0LL;
LABEL_17:
    kernel_debug(0x52D00B4u, v8, 0LL, 0LL, v9, 0LL);
    return;
  }
  v6 = *(_QWORD *)a4;
  if ( !*(_QWORD *)a4 )
  {
    KernelDebugLogInternal(
      1u,
      0x55534246u,
      (__int64)"IOUSBController::IOUSBSyncIsoCompletion controller is NULL",
      a3,
      a5,
      a6,
      a1);
    if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
      return;
    v9 = 1LL;
    v8 = a4;
    goto LABEL_17;
  }
  v7 = *(_QWORD *)(v6 + 144);
  if ( !v7 )
  {
    KernelDebugLogInternal(
      1u,
      0x55534246u,
      (__int64)"IOUSBController::IOUSBSyncIsoCompletion commandGate is NULL",
      a3,
      a5,
      a6,
      a1);
    if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
      return;
    v9 = 2LL;
    v8 = v6;
    goto LABEL_17;
  }
  if ( gUSBStackDebugFlags & 2 )
  {
    if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D00B4u, *(_QWORD *)a4, *(_QWORD *)(a4 + 8), a2, 4uLL, 0LL);
  }
  (*(void (__fastcall **)(__int64, _QWORD, signed __int64))(*(_QWORD *)v7 + 488LL))(v7, *(_QWORD *)(a4 + 8), 1LL);
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (0000000000000F4C) ----------------------------------------------------
__int64 __fastcall IOUSBController::MetaClass::MetaClass(IOUSBController::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBController", &IOUSBBus::gMetaClass, 176LL);
  result = (__int64)off_3C690;
  *(_QWORD *)this = off_3C690;
  return result;
}
// 3C690: using guessed type __int64 (__fastcall *off_3C690[2])(IOUSBController::MetaClass *__hidden this);
// 49430: using guessed type _QWORD IOUSBBus::gMetaClass;
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000000F7E) ----------------------------------------------------
__int64 __fastcall IOUSBController::MetaClass::~MetaClass(IOUSBController::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000000F88) ----------------------------------------------------
__int64 __fastcall IOUSBController::IOUSBController(__int64 a1)
{
  __int64 result; // rax@1

  IOUSBBus::IOUSBBus(a1);
  result = (__int64)off_3BC20;
  *(_QWORD *)a1 = off_3BC20;
  return result;
}
// 3BC20: using guessed type __int64 (__fastcall *off_3BC20[2])(IOUSBController *__hidden this);

//----- (0000000000000FA8) ----------------------------------------------------
__int64 __fastcall IOUSBController::~IOUSBController(IOUSBController *this)
{
  return IOUSBBus::~IOUSBBus(this);
}

//----- (0000000000000FB2) ----------------------------------------------------
__int64 __fastcall IOUSBController::~IOUSBController(IOUSBController *this)
{
  return IOUSBBus::~IOUSBBus(this);
}

//----- (0000000000000FBC) ----------------------------------------------------
void __fastcall IOUSBController::~IOUSBController(IOUSBController *this)
{
  IOUSBBus::~IOUSBBus(this);
  OSObject::operator delete((void *)this);
}

//----- (0000000000000FDE) ----------------------------------------------------
__int64 __fastcall IOUSBController::getMetaClass(IOUSBController *this)
{
  return (__int64)&IOUSBController::gMetaClass;
}
// 49588: using guessed type _QWORD IOUSBController::gMetaClass;

//----- (0000000000000FEC) ----------------------------------------------------
__int64 __fastcall IOUSBController::MetaClass::MetaClass(IOUSBController::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBController", &IOUSBBus::gMetaClass, 176LL);
  result = (__int64)off_3C690;
  *(_QWORD *)this = off_3C690;
  return result;
}
// 3C690: using guessed type __int64 (__fastcall *off_3C690[2])(IOUSBController::MetaClass *__hidden this);
// 49430: using guessed type _QWORD IOUSBBus::gMetaClass;
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000000101E) ----------------------------------------------------
__int64 __fastcall IOUSBController::MetaClass::alloc(IOUSBController::MetaClass *this)
{
  return 0LL;
}

//----- (0000000000001026) ----------------------------------------------------
char __fastcall IOUSBController::init(IOUSBController *this, OSDictionary *a2)
{
  __int64 v2; // rax@2
  void *v3; // rax@3

  if ( (unsigned __int8)((int (__fastcall *)(IOUSBController *, OSDictionary *))`vtable for'IOUSBBus[75])(this, a2) )
  {
    v2 = *((_QWORD *)this + 21);
    if ( v2 )
    {
LABEL_5:
      *(_BYTE *)(v2 + 25) = 0;
      *(_BYTE *)(v2 + 40) = 1;
      *(_QWORD *)(v2 + 216) = 0LL;
      return 1;
    }
    LODWORD(v3) = IOMalloc(256LL);
    *((_QWORD *)this + 21) = v3;
    if ( v3 )
    {
      bzero(v3, 0x100uLL);
      v2 = *((_QWORD *)this + 21);
      goto LABEL_5;
    }
  }
  return 0;
}
// 3B270: using guessed type __int64 `vtable for'IOUSBBus[2];
// 7D250: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (0000000000001096) ----------------------------------------------------
char __usercall IOUSBController::start@<al>(IOUSBController *this@<rdi>, IOService *a2@<rsi>, char a3@<al>, const OSMetaClass *a4@<rdx>)
{
  uintptr_t v4; // r12@1
  __int64 v5; // r15@1
  const OSMetaClass *v6; // rdx@1
  __int64 v7; // r14@1
  char v8; // r13@6
  IOUSBWorkLoop *v9; // rax@9
  IOUSBWorkLoop *v10; // rax@9
  int (__cdecl *v11)(OSObject *, void *, void *, void *, void *); // rdx@9
  IOWorkLoop *v12; // rax@10
  IOWorkLoop *v13; // rsi@11
  char v14; // r13@12
  __int64 v15; // rax@12
  __int64 v16; // r8@12
  __int64 v17; // r9@12
  __int64 v18; // rcx@12
  __int64 v19; // rdx@12
  __int64 v20; // rax@14
  __int64 v21; // rax@15
  unsigned __int64 v22; // rsi@16
  __int64 v23; // rax@20
  int v24; // ebx@21
  __int64 v25; // rax@22
  __int64 v26; // r14@22
  __int64 v27; // rdi@23
  int v28; // ebx@28
  __int64 v29; // rax@29
  __int64 v30; // r14@29
  __int64 v31; // rdi@30
  __int64 v32; // rdi@36
  __int64 v33; // rdi@39
  __int64 v34; // rdi@40
  __int64 v35; // rax@42
  __int64 v36; // rdi@44
  __int64 v37; // rdi@47
  IOCommandPool *v39; // rax@51
  IOCommandPool *v40; // rax@52
  __int64 v41; // rax@53
  __int64 v42; // rax@55
  __int64 v43; // r8@55
  __int64 v44; // r9@55
  __int64 v45; // rcx@55
  __int64 v46; // rdx@55
  __int64 v47; // rax@56
  __int64 v48; // rax@57
  __int64 v49; // rax@59
  __int64 v50; // rcx@59
  IOUSBCommand *v51; // rdi@62
  signed int v52; // er13@62
  IOCommand *v53; // rbx@63
  __int64 v54; // rax@65
  signed int v55; // ebx@68
  IOCommand *v56; // r13@69
  __int64 v57; // rax@71
  __int64 v58; // rax@76
  __int64 v59; // r8@76
  __int64 v60; // r9@76
  int v61; // ebx@78
  __int64 v62; // rax@83
  char v63; // [sp-8h] [bp-30h]@1

  v63 = a3;
  v4 = (uintptr_t)this;
  v5 = OSMetaClassBase::safeMetaCast(this, (const OSMetaClassBase *)IOUSBControllerV2::metaClass, a4);
  v7 = OSMetaClassBase::safeMetaCast(this, (const OSMetaClassBase *)IOUSBControllerV3::metaClass, v6);
  if ( !(unsigned __int8)((int (__fastcall *)(IOUSBController *, IOService *))`vtable for'IOUSBBus[186])(this, a2) )
    return 0;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D0005u, (uintptr_t)a2, 0LL, 0LL, 0LL, 0LL);
  *(_QWORD *)(*((_QWORD *)this + 21) + 192LL) = a2;
  if ( !a2 )
    return 0;
  v8 = 0;
  if ( (unsigned __int8)(*(int (__fastcall **)(IOService *, IOUSBController *, _QWORD, _QWORD))(*(_QWORD *)a2 + 1488LL))(
                          a2,
                          this,
                          0LL,
                          0LL) )
  {
    if ( !IOUSBController::_log )
      IOUSBController::_log = IOUSBLog::usblog(a2, (unsigned __int64)this);
    LODWORD(v9) = (*(int (__fastcall **)(IOService *, _QWORD))(*(_QWORD *)a2 + 952LL))(a2, 0LL);
    v10 = IOUSBWorkLoop::workLoop(v9, 0LL);
    *((_QWORD *)this + 17) = v10;
    if ( !v10 )
    {
      v14 = 0;
      LODWORD(v20) = (*(int (__fastcall **)(IOUSBController *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
      v18 = v20;
      v19 = (__int64)"%s::start unable to create workloop";
      goto LABEL_16;
    }
    v12 = (IOWorkLoop *)IOCommandGate::commandGate(this, 0LL, v11);
    *((_QWORD *)this + 18) = v12;
    if ( !v12 )
    {
      v14 = 0;
      LODWORD(v21) = (*(int (__fastcall **)(IOUSBController *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
      v18 = v21;
      v19 = (__int64)"%s::start unable to create command gate";
      goto LABEL_16;
    }
    v13 = v12;
    if ( (*(int (__fastcall **)(_QWORD, IOWorkLoop *))(**((_QWORD **)this + 17) + 320LL))(*((_QWORD *)this + 17), v12) )
    {
      v14 = 0;
      LODWORD(v15) = (*(int (__fastcall **)(IOUSBController *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
      v18 = v15;
      v19 = (__int64)"%s::start unable to add command gate";
LABEL_16:
      v22 = 1431519814LL;
      KernelDebugLogInternal(1u, 0x55534246u, v19, v18, v16, v17, v63);
      goto LABEL_17;
    }
    v39 = IOUSBCommandPool::withWorkLoop(*((IOUSBCommandPool **)this + 17), v13);
    **((_QWORD **)this + 21) = v39;
    if ( !v39
      || (v40 = IOUSBCommandPool::withWorkLoop(*((IOUSBCommandPool **)this + 17), v13),
          (*(_QWORD *)(*((_QWORD *)this + 21) + 8LL) = v40) == 0LL) )
    {
      LODWORD(v47) = (*(int (__fastcall **)(IOUSBController *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
      v45 = v47;
      v46 = (__int64)"%s::start unable to create free command pool";
      goto LABEL_58;
    }
    LODWORD(v41) = IOTimerEventSource::timerEventSource(this, IOUSBController::WatchdogTimer);
    *(_QWORD *)(*((_QWORD *)this + 21) + 16LL) = v41;
    if ( !v41 )
    {
      LODWORD(v48) = (*(int (__fastcall **)(IOUSBController *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
      v45 = v48;
      v46 = (__int64)"%s::start - no watchdog timer";
      goto LABEL_58;
    }
    if ( (*(int (__fastcall **)(_QWORD, __int64))(**((_QWORD **)this + 17) + 320LL))(*((_QWORD *)this + 17), v41) )
    {
      LODWORD(v42) = (*(int (__fastcall **)(IOUSBController *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
      v45 = v42;
      v46 = (__int64)"%s::start - unable to add watchdog timer event source";
LABEL_58:
      v22 = 1431519814LL;
      KernelDebugLogInternal(1u, 0x55534246u, v46, v45, v43, v44, v63);
      v14 = 1;
LABEL_17:
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        v22 = v4;
        kernel_debug(0x52D0006u, v4, 0LL, 0LL, 2uLL, 0LL);
      }
      v23 = *(_QWORD *)(v4 + 168);
      if ( *(_DWORD *)(v23 + 32) > 0 )
      {
        v24 = 0;
        do
        {
          v22 = 0LL;
          LODWORD(v25) = (*(int (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)v23 + 296LL))(*(_QWORD *)v23, 0LL);
          v26 = v25;
          if ( v25 )
          {
            v27 = *(_QWORD *)(*(_QWORD *)(v25 + 216) + 48LL);
            if ( v27 )
            {
              (*(void (__cdecl **)(__int64))(*(_QWORD *)v27 + 40LL))(v27);
              *(_QWORD *)(*(_QWORD *)(v26 + 216) + 48LL) = 0LL;
            }
            (*(void (__fastcall **)(__int64))(*(_QWORD *)v26 + 40LL))(v26);
          }
          ++v24;
          v23 = *(_QWORD *)(v4 + 168);
        }
        while ( v24 < *(_DWORD *)(v23 + 32) );
      }
      if ( *(_DWORD *)(v23 + 36) > 0 )
      {
        v28 = 0;
        do
        {
          v22 = 0LL;
          LODWORD(v29) = (*(int (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(v23 + 8) + 296LL))(
                           *(_QWORD *)(v23 + 8),
                           0LL);
          v30 = v29;
          if ( v29 )
          {
            v31 = *(_QWORD *)(*(_QWORD *)(v29 + 104) + 24LL);
            if ( v31 )
            {
              (*(void (__cdecl **)(__int64))(*(_QWORD *)v31 + 40LL))(v31);
              *(_QWORD *)(*(_QWORD *)(v30 + 104) + 24LL) = 0LL;
            }
            (*(void (__fastcall **)(__int64))(*(_QWORD *)v30 + 40LL))(v30);
          }
          ++v28;
          v23 = *(_QWORD *)(v4 + 168);
        }
        while ( v28 < *(_DWORD *)(v23 + 36) );
      }
      if ( *(_QWORD *)v23 )
      {
        (*(void (__fastcall **)(_QWORD, unsigned __int64))(**(_QWORD **)v23 + 40LL))(*(_QWORD *)v23, v22);
        v23 = *(_QWORD *)(v4 + 168);
        *(_QWORD *)v23 = 0LL;
      }
      v32 = *(_QWORD *)(v23 + 8);
      if ( v32 )
      {
        (*(void (__fastcall **)(__int64, unsigned __int64))(*(_QWORD *)v32 + 40LL))(v32, v22);
        v23 = *(_QWORD *)(v4 + 168);
        *(_QWORD *)(v23 + 8) = 0LL;
      }
      if ( v23 )
      {
        v33 = *(_QWORD *)(v23 + 16);
        if ( v33 )
        {
          *(_BYTE *)(v23 + 25) = 0;
          (*(void (__fastcall **)(__int64, unsigned __int64))(*(_QWORD *)v33 + 536LL))(v33, v22);
          v34 = *(_QWORD *)(v4 + 136);
          if ( v34 )
          {
            v22 = *(_QWORD *)(*(_QWORD *)(v4 + 168) + 16LL);
            (*(void (__fastcall **)(__int64, unsigned __int64))(*(_QWORD *)v34 + 328LL))(v34, v22);
          }
        }
      }
      v35 = *(_QWORD *)(v4 + 144);
      if ( v35 )
      {
        if ( v14 )
        {
          v36 = *(_QWORD *)(v4 + 136);
          if ( v36 )
          {
            v22 = *(_QWORD *)(v4 + 144);
            (*(void (__fastcall **)(__int64, unsigned __int64))(*(_QWORD *)v36 + 328LL))(v36, v22);
            v35 = *(_QWORD *)(v4 + 144);
          }
        }
        (*(void (__fastcall **)(__int64, unsigned __int64))(*(_QWORD *)v35 + 40LL))(v35, v22);
        *(_QWORD *)(v4 + 144) = 0LL;
      }
      v37 = *(_QWORD *)(v4 + 136);
      if ( v37 )
      {
        (*(void (__fastcall **)(__int64, unsigned __int64))(*(_QWORD *)v37 + 40LL))(v37, v22);
        *(_QWORD *)(v4 + 136) = 0LL;
      }
      (*(void (__fastcall **)(uintptr_t, unsigned __int64))(*(_QWORD *)v4 + 1944LL))(v4, v22);
      v8 = 0;
      (*(void (__fastcall **)(_QWORD, uintptr_t, _QWORD))(**(_QWORD **)(*(_QWORD *)(v4 + 168) + 192LL) + 1496LL))(
        *(_QWORD *)(*(_QWORD *)(v4 + 168) + 192LL),
        v4,
        0LL);
      return v8;
    }
    v49 = *((_QWORD *)this + 21);
    v50 = 0LL;
    do
      *(_BYTE *)(v49 + v50++ + 57) = 0;
    while ( v50 != 127 );
    (*(void (__fastcall **)(IOUSBController *))(*(_QWORD *)this + 1936LL))(this);
    (*(void (__fastcall **)(_QWORD, IOUSBController *))(**(_QWORD **)(*((_QWORD *)this + 21) + 192LL) + 1952LL))(
      *(_QWORD *)(*((_QWORD *)this + 21) + 192LL),
      this);
    v22 = *(_QWORD *)(*((_QWORD *)this + 21) + 192LL);
    v14 = 1;
    if ( (*(int (__fastcall **)(IOUSBController *, unsigned __int64))(*(_QWORD *)this + 2136LL))(this, v22) )
      goto LABEL_17;
    v51 = (IOUSBCommand *)*((_QWORD *)this + 17);
    (*(void (**)(void))(*(_QWORD *)v51 + 352LL))();
    v52 = 50;
    do
    {
      v53 = IOUSBCommand::NewCommand(v51, v22);
      if ( v53 )
      {
        if ( v5 )
        {
          LODWORD(v54) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v5 + 2848LL))(v5);
          *(_QWORD *)(*((_QWORD *)v53 + 27) + 48LL) = v54;
        }
        v51 = (IOUSBCommand *)**(_QWORD **)(v4 + 168);
        v22 = (unsigned __int64)v53;
        (*(void (__fastcall **)(IOUSBCommand *, IOCommand *))(*(_QWORD *)v51 + 304LL))(v51, v53);
      }
      --v52;
    }
    while ( v52 );
    *(_DWORD *)(*(_QWORD *)(v4 + 168) + 32LL) = 50;
    v55 = 50;
    do
    {
      v56 = IOUSBIsocCommand::NewCommand(v51, v22);
      if ( v56 )
      {
        if ( v5 )
        {
          LODWORD(v57) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v5 + 2848LL))(v5);
          *(_QWORD *)(*((_QWORD *)v56 + 13) + 24LL) = v57;
        }
        v51 = *(IOUSBCommand **)(*(_QWORD *)(v4 + 168) + 8LL);
        v22 = (unsigned __int64)v56;
        (*(void (__fastcall **)(IOUSBCommand *, IOCommand *))(*(_QWORD *)v51 + 304LL))(v51, v56);
      }
      --v55;
    }
    while ( v55 );
    *(_DWORD *)(*(_QWORD *)(v4 + 168) + 36LL) = 50;
    *(_DWORD *)(v4 + 160) = 0;
    if ( !IOUSBController::gIOUSBPlane )
    {
      IOUSBController::gIOUSBPlane = IORegistryEntry::makePlane("IOUSB", (const char *)v22);
      if ( !IOUSBController::gIOUSBPlane )
      {
        LODWORD(v58) = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)v4 + 904LL))(v4, 0LL);
        KernelDebugLogInternal(1u, 0x55534246u, (__int64)"%s::start unable to create IOUSB plane", v58, v59, v60, v63);
      }
    }
    if ( !v7 )
    {
      v22 = *(_QWORD *)(*(_QWORD *)(v4 + 168) + 192LL);
      v61 = (*(int (__fastcall **)(uintptr_t, unsigned __int64, signed __int64))(*(_QWORD *)v4 + 2568LL))(
              v4,
              v22,
              v4 + 152);
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        v22 = v4;
        kernel_debug(0x52D0004u, v4, v61, 0LL, 0LL, 0LL);
      }
      v14 = 1;
      if ( v61 )
        goto LABEL_17;
      IOService::makeUsable((IOService *)v4);
      (*(void (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(v4 + 152) + 1456LL))(*(_QWORD *)(v4 + 152), 0LL);
    }
    v62 = *(_QWORD *)(v4 + 168);
    *(_BYTE *)(v62 + 25) = 1;
    *(_DWORD *)(v62 + 232) = 1000;
    (*(void (__fastcall **)(_QWORD, signed __int64))(**(_QWORD **)(v62 + 16) + 464LL))(*(_QWORD *)(v62 + 16), 1000LL);
    v8 = 1;
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D0006u, v4, 0LL, 0LL, 1uLL, 0LL);
  }
  return v8;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 3B270: using guessed type __int64 `vtable for'IOUSBBus[2];
// 419C0: using guessed type _QWORD IOUSBControllerV2::metaClass;
// 44350: using guessed type _QWORD IOUSBControllerV3::metaClass;
// 49460: using guessed type int gUSBStackDebugFlags;
// 49468: using guessed type _QWORD IOUSBController::_log;
// 49470: using guessed type _QWORD IOUSBController::gIOUSBPlane;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);
// 7D878: using guessed type int __fastcall IOTimerEventSource::timerEventSource(_QWORD, _QWORD);

//----- (0000000000001788) ----------------------------------------------------
int __usercall IOUSBController::WatchdogTimer@<eax>(const OSMetaClass *a1@<rdx>, OSMetaClassBase *a2@<rdi>, __int64 a3@<rsi>, char a4)
{
  __int64 v4; // rax@1
  __int64 v5; // rbx@1
  int v6; // er14@4
  __int64 v7; // rax@5
  __int64 v8; // r9@5

  v4 = OSMetaClassBase::safeMetaCast(a2, (const OSMetaClassBase *)&IOUSBController::gMetaClass, a1);
  v5 = v4;
  if ( v4 && a3 )
  {
    v4 = *(_QWORD *)(v4 + 168);
    if ( *(_BYTE *)(v4 + 25) )
    {
      v6 = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)a3 + 464LL))(a3, *(_DWORD *)(v4 + 232));
      if ( v6 )
      {
        LODWORD(v7) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v5 + 904LL))(v5, 0LL);
        LODWORD(v4) = KernelDebugLogInternal(
                        1u,
                        0x55534246u,
                        (__int64)"%s::WatchdogTime: error 0x%08x",
                        v7,
                        (unsigned int)v6,
                        v8,
                        a4);
      }
      else
      {
        *(_BYTE *)(*(_QWORD *)(v5 + 168) + 25LL) = 1;
        LODWORD(v4) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v5 + 2488LL))(v5);
      }
    }
  }
  else if ( v4 )
  {
    v4 = *(_QWORD *)(v4 + 168);
    if ( v4 )
      *(_BYTE *)(v4 + 25) = 0;
  }
  return v4;
}
// 49588: using guessed type _QWORD IOUSBController::gMetaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000001838) ----------------------------------------------------
__int64 __fastcall IOUSBController::getWorkLoop(IOUSBController *this)
{
  return *((_QWORD *)this + 17);
}

//----- (0000000000001846) ----------------------------------------------------
signed __int64 __fastcall IOUSBController::CreateDevice(IOUSBController *this, IOUSBDevice *a2, unsigned int a3, unsigned int a4, unsigned int a5, unsigned int a6)
{
  __int64 v6; // r14@1

  v6 = a3;
  *(_BYTE *)(*((_QWORD *)this + 21) + a3 + 56LL) = 1;
  if ( (unsigned __int8)(*(int (__fastcall **)(IOUSBDevice *, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a2 + 2168LL))(
                          a2,
                          a3,
                          a6,
                          a5,
                          a4)
    && (unsigned __int8)(*(int (__fastcall **)(IOUSBDevice *, IOUSBController *))(*(_QWORD *)a2 + 1648LL))(a2, this) )
  {
    if ( (unsigned __int8)(*(int (__fastcall **)(IOUSBDevice *, IOUSBController *))(*(_QWORD *)a2 + 1472LL))(a2, this) )
    {
      *(_BYTE *)(*((_QWORD *)this + 21) + v6 + 56) = 0;
      return 0LL;
    }
    (*(void (__fastcall **)(IOUSBDevice *, IOUSBController *))(*(_QWORD *)a2 + 1656LL))(a2, this);
  }
  *(_BYTE *)(*((_QWORD *)this + 21) + v6 + 56) = 0;
  return 3758097085LL;
}

//----- (00000000000018E8) ----------------------------------------------------
int __fastcall IOUSBController::DeviceRequest(__int64 a1)
{
  return (*(int (__cdecl **)(__int64))(*(_QWORD *)a1 + 2528LL))(a1);
}

//----- (0000000000001916) ----------------------------------------------------
int __fastcall IOUSBController::DeviceRequest(__int64 a1)
{
  return (*(int (__cdecl **)(__int64))(*(_QWORD *)a1 + 2536LL))(a1);
}

//----- (0000000000001944) ----------------------------------------------------
__int64 __fastcall IOUSBController::GetNewAddress(uintptr_t arg1)
{
  __int64 v1; // rax@1
  __int64 v2; // r12@1
  OSMetaClassBase *v3; // rax@2
  const OSMetaClass *v4; // rdx@2
  __int64 v5; // r13@3
  uintptr_t v6; // rsi@4
  __int64 v7; // rbx@4
  unsigned __int16 v8; // ax@6
  __int64 v9; // rbx@12
  signed __int64 v10; // r15@12
  __int64 v11; // r12@12
  signed __int64 v12; // r13@13
  uintptr_t v13; // rdx@23
  uintptr_t v14; // r8@23
  uintptr_t v15; // rsi@23
  __int64 result; // rax@29
  char v17; // [sp+0h] [bp-C0h]@1
  char v18[143]; // [sp+1h] [bp-BFh]@17
  __int64 v19; // [sp+90h] [bp-30h]@1

  v19 = *(_QWORD *)off_3B0E0[0];
  bzero(&v17, 0x82uLL);
  LODWORD(v1) = (*(int (__fastcall **)(uintptr_t, signed __int64))(*(_QWORD *)arg1 + 1704LL))(arg1, 130LL);
  v2 = v1;
  if ( v1 )
  {
    LODWORD(v3) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v1 + 296LL))(v1);
    if ( v3 )
    {
      v5 = off_3B100[0];
      do
      {
        v6 = IOUSBDevice::metaClass;
        v7 = OSMetaClassBase::safeMetaCast(v3, (const OSMetaClassBase *)IOUSBDevice::metaClass, v4);
        if ( v7 )
        {
          if ( gUSBStackDebugFlags & 2 )
          {
            v8 = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v7 + 2248LL))(v7, IOUSBDevice::metaClass);
            if ( *(_DWORD *)v5 & 0xFFFFFFF7 )
            {
              v6 = arg1;
              kernel_debug(0x52D000Cu, arg1, v8, 0LL, 3uLL, 0LL);
            }
          }
          if ( (unsigned __int16)(*(int (__fastcall **)(__int64, uintptr_t))(*(_QWORD *)v7 + 2248LL))(v7, v6) < 0x80u )
            *(&v17 + (unsigned __int16)(*(int (__fastcall **)(__int64))(*(_QWORD *)v7 + 2248LL))(v7)) = 1;
        }
        LODWORD(v3) = (*(int (__fastcall **)(__int64, uintptr_t))(*(_QWORD *)v2 + 296LL))(v2, v6);
      }
      while ( v3 );
    }
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 40LL))(v2);
  }
  v9 = 0LL;
  v10 = 1LL;
  v11 = off_3B100[0];
  do
  {
    v12 = v9 + 1;
    if ( *(_BYTE *)(*(_QWORD *)(arg1 + 168) + v9 + 57) )
    {
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)v11 & 0xFFFFFFF7 )
        kernel_debug(0x52D000Cu, arg1, v9 + 1, 0LL, 4uLL, 0LL);
      v18[v9] = 1;
    }
    ++v9;
  }
  while ( v12 != 127 );
  while ( *(&v17 + v10) )
  {
    ++v10;
    if ( (signed int)v10 > 127 )
    {
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)v11 & 0xFFFFFFF7 )
      {
        LOWORD(v10) = 0;
        v13 = 0LL;
        v14 = 6LL;
        v15 = arg1;
LABEL_27:
        kernel_debug(0x52D000Cu, v15, v13, 0LL, v14, 0LL);
        goto LABEL_29;
      }
      LOWORD(v10) = 0;
      goto LABEL_29;
    }
  }
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)v11 & 0xFFFFFFF7 )
  {
    v14 = 5LL;
    v15 = arg1;
    v13 = v10;
    goto LABEL_27;
  }
LABEL_29:
  result = *(_QWORD *)off_3B0E0[0];
  if ( *(_QWORD *)off_3B0E0[0] == v19 )
    result = (unsigned __int16)v10;
  return result;
}
// 3B0E0: using guessed type __int64 off_3B0E0[6];
// 3B100: using guessed type __int64 off_3B100[2];
// 3F498: using guessed type _QWORD IOUSBDevice::metaClass;
// 49460: using guessed type int gUSBStackDebugFlags;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);
// 1944: using guessed type char var_BF[143];

//----- (0000000000001B52) ----------------------------------------------------
__int64 __fastcall IOUSBController::ControlTransaction(uintptr_t arg1, IOUSBCommand *this)
{
  IOUSBCommand *v2; // r13@1
  uintptr_t v3; // r15@1
  __int64 v4; // rax@1
  unsigned __int8 v5; // r12@1
  __int64 v6; // rax@1
  IOUSBCommand *v7; // rdi@1
  __int64 v8; // rax@2
  int v9; // ebx@4
  unsigned __int16 v10; // r14@4
  unsigned __int8 v11; // al@4
  __int64 v12; // rbx@7
  __int64 v13; // r14@8
  __int64 v14; // r15@8
  unsigned __int16 v15; // cx@10
  int v16; // eax@12
  __int64 v17; // rdx@12
  __int64 v18; // ST20_8@13
  int (__fastcall *v19)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD); // rbx@13
  __int16 v20; // r15@13
  int v21; // ST00_4@13
  signed __int64 v22; // rsi@13
  uintptr_t v23; // r15@13
  unsigned __int16 v24; // r12@13
  int v25; // er14@13
  __int64 v26; // r12@16
  __int64 v27; // rax@17
  __int64 v28; // rax@20
  __int64 v29; // rax@20
  __int64 v30; // r15@23
  __int64 v31; // rax@24
  __int64 v32; // rax@26
  __int64 v33; // rsi@29
  __int64 v34; // rdi@33
  __int64 v35; // rax@34
  __int64 v36; // r14@34
  unsigned __int64 v37; // rax@35
  __int64 v38; // rdx@35
  signed __int64 v39; // rcx@35
  int v40; // er14@38
  unsigned __int16 v41; // r12@38
  unsigned __int8 v42; // bl@38
  uintptr_t v43; // rax@38
  int (__fastcall *v44)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD); // ST40_8@40
  __int16 v45; // r14@40
  __int64 v46; // rax@40
  char v47; // al@41
  int (__fastcall *v48)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD); // r14@41
  __int16 v49; // ax@41
  __int64 v50; // rax@42
  __int64 v51; // r8@42
  __int64 v52; // r9@42
  __int64 result; // rax@46
  char v54; // [sp+0h] [bp-C0h]@0
  unsigned __int8 v55; // [sp+1Fh] [bp-A1h]@7
  IOUSBCommand *v56; // [sp+28h] [bp-98h]@2
  unsigned __int8 v57; // [sp+37h] [bp-89h]@1
  uintptr_t arg1a; // [sp+38h] [bp-88h]@8
  __int64 v59; // [sp+40h] [bp-80h]@1
  __int64 v60; // [sp+48h] [bp-78h]@4
  __int64 v61; // [sp+68h] [bp-58h]@7
  __int64 v62; // [sp+70h] [bp-50h]@7
  __int64 v63; // [sp+78h] [bp-48h]@8
  uintptr_t arg3; // [sp+80h] [bp-40h]@37
  uintptr_t arg4; // [sp+88h] [bp-38h]@37
  __int64 v66; // [sp+90h] [bp-30h]@1

  v2 = this;
  v3 = arg1;
  v66 = *(_QWORD *)off_3B0E0[0];
  v4 = IOUSBCommand::GetRequest(this);
  v59 = v4;
  v5 = *(_BYTE *)v4 >> 7;
  v57 = IOUSBCommand::GetEndpoint(this);
  v6 = *((_QWORD *)this + 27);
  v7 = *(IOUSBCommand **)(v6 + 56);
  if ( v7 )
  {
    v56 = *(IOUSBCommand **)(v6 + 56);
    v8 = IOUSBCommand::GetReqCount(v7);
  }
  else
  {
    v56 = 0LL;
    v8 = 0LL;
  }
  v60 = v8;
  v9 = *(_DWORD *)(*(_QWORD *)(v3 + 168) + 28LL);
  v10 = IOUSBCommand::GetAddress(this);
  v11 = IOUSBCommand::GetEndpoint(this);
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(
      0x52D006Du,
      v3,
      (v5 << 24) | (v9 << 16) | (v10 << 8) | (unsigned int)v11,
      *(_WORD *)(v59 + 2) | (*(_BYTE *)(v59 + 1) << 16) | (*(_BYTE *)v59 << 24),
      *(_WORD *)(v59 + 6) | (*(_WORD *)(v59 + 4) << 16),
      0LL);
  v55 = v5;
  IOUSBCommand::GetUSLCompletion((IOUSBCommand *)&v61, (__int64)this);
  v12 = v62;
  if ( v62 )
  {
    arg1a = v3;
    v13 = v61;
    v14 = v63;
  }
  else
  {
    v12 = (__int64)IOUSBController::ControlPacketHandler;
    v13 = v3;
    arg1a = v3;
    v14 = (__int64)this;
  }
  v15 = v60;
  if ( (_WORD)v60 && *(_QWORD *)(v59 + 8) && (v16 = IOUSBCommand::GetSelector(this), v15 = v60, v16 != 6) )
  {
    v23 = arg1a;
    LODWORD(v50) = (*(int (__fastcall **)(uintptr_t, _QWORD, __int64, __int64))(*(_QWORD *)arg1a + 904LL))(
                     arg1a,
                     0LL,
                     v17,
                     v60);
    KernelDebugLogInternal(
      1u,
      0x55534246u,
      (__int64)"%s::ControlTransaction - have a wLength but not a BUFFERCOMMAND",
      v50,
      v51,
      v52,
      v54);
    v25 = -536870206;
  }
  else
  {
    IOUSBCommand::SetDataRemaining(this, v15);
    IOUSBCommand::SetStage(this, 1);
    IOUSBCommand::SetUSLCompletion((__int64)this, v13, v12, v14);
    IOUSBCommand::SetStatus(this, 0);
    v18 = IOUSBCommand::GetRequestMemoryDescriptor(this);
    IOUSBCommand::SetMultiTransferTransaction(this, 1);
    IOUSBCommand::SetFinalTransferInTransaction(this, 0);
    v19 = *(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)arg1a + 2504LL);
    v20 = IOUSBCommand::GetAddress(this);
    v21 = IOUSBCommand::GetReqCount(this);
    v22 = (unsigned int)v20;
    v23 = arg1a;
    v24 = v57;
    v25 = v19(arg1a, v22, v57, v2, v18, 1LL);
    if ( v25 )
    {
      if ( v56 && IOUSBCommand::GetBufferMemoryDescriptor(v56) )
      {
        v26 = *(_QWORD *)(*((_QWORD *)v56 + 27) + 48LL);
        if ( v26 )
        {
          LODWORD(v27) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v26 + 312LL))(v26);
          if ( v27 )
            (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v26 + 304LL))(v26, 1LL);
        }
        if ( !(unsigned int)IOUSBCommand::GetSelector(v56) )
        {
          v28 = IOUSBCommand::GetBufferMemoryDescriptor(v56);
          (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v28 + 504LL))(v28, 0LL);
          v29 = IOUSBCommand::GetBufferMemoryDescriptor(v56);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v29 + 40LL))(v29);
        }
        v22 = 0LL;
        IOUSBCommand::SetBufferMemoryDescriptor(v56, 0LL);
      }
      if ( IOUSBCommand::GetRequestMemoryDescriptor(v2) )
      {
        v30 = *(_QWORD *)(*((_QWORD *)v2 + 27) + 48LL);
        if ( v30 )
        {
          LODWORD(v31) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v30 + 312LL))(v30, v22);
          if ( v31 )
          {
            v22 = 1LL;
            (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v30 + 304LL))(v30, 1LL);
          }
        }
        v32 = IOUSBCommand::GetRequestMemoryDescriptor(v2);
        (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v32 + 40LL))(v32, v22);
        IOUSBCommand::SetRequestMemoryDescriptor(v2, 0LL);
        v23 = arg1a;
      }
    }
    else
    {
      if ( !(_WORD)v60 || !*(_QWORD *)(v59 + 8) )
        goto LABEL_50;
      v33 = (unsigned __int8)IOUSBCommand::GetStage(v2) | 2u;
      IOUSBCommand::SetStage(v2, v33);
      if ( gUSBStackDebugFlags & 2 )
      {
        if ( !v55 )
        {
          if ( v56 )
          {
            if ( IOUSBCommand::GetBufferMemoryDescriptor(v56) )
            {
              v34 = *(_QWORD *)(*((_QWORD *)v56 + 27) + 48LL);
              if ( v34 )
              {
                LODWORD(v35) = (*(int (__cdecl **)(__int64, __int64))(*(_QWORD *)v34 + 312LL))(v34, v33);
                v36 = v35;
                if ( v35 )
                {
                  LODWORD(v37) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v35 + 456LL))(v35);
                  v39 = 16LL;
                  if ( v37 <= 0x10 )
                    v39 = (unsigned int)(*(int (__fastcall **)(__int64, __int64, __int64, signed __int64))(*(_QWORD *)v36 + 456LL))(
                                          v36,
                                          v33,
                                          v38,
                                          16LL);
                  arg4 = 0LL;
                  arg3 = 0LL;
                  (*(void (__fastcall **)(__int64, _QWORD, uintptr_t *, signed __int64))(*(_QWORD *)v36 + 480LL))(
                    v36,
                    0LL,
                    &arg3,
                    v39);
                  if ( gUSBStackDebugFlags & 2 )
                  {
                    v40 = *(_DWORD *)(*(_QWORD *)(arg1a + 168) + 28LL);
                    v41 = IOUSBCommand::GetAddress(v2);
                    v42 = IOUSBCommand::GetEndpoint(v2);
                    v43 = IOUSBCommand::GetReqCount(v2);
                    if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
                      kernel_debug(0x52D006Cu, v42 | (v41 << 8) | (unsigned int)(v40 << 16), v43, arg3, arg4, 0LL);
                  }
                }
              }
            }
          }
        }
      }
      v44 = *(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)arg1a + 2504LL);
      v45 = IOUSBCommand::GetAddress(v2);
      v46 = IOUSBCommand::GetBufferMemoryDescriptor(v56);
      v24 = v57;
      v25 = v44(arg1a, (unsigned int)v45, v57, v56, v46, 1LL);
      if ( !v25 )
      {
LABEL_50:
        v47 = IOUSBCommand::GetStage(v2);
        IOUSBCommand::SetStage(v2, v47 | 4);
        IOUSBCommand::SetFinalTransferInTransaction(v2, 1);
        v48 = *(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)arg1a + 2504LL);
        v49 = IOUSBCommand::GetAddress(v2);
        v25 = v48(arg1a, (unsigned int)v49, v24, v2, 0LL, 1LL);
      }
    }
  }
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D006Eu, v23, v25, 0LL, 0LL, 0LL);
  result = *(_QWORD *)off_3B0E0[0];
  if ( *(_QWORD *)off_3B0E0[0] == v66 )
    result = (unsigned int)v25;
  return result;
}
// 3B0E0: using guessed type __int64 off_3B0E0[6];
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (0000000000002158) ----------------------------------------------------
__int64 __fastcall IOUSBController::ControlPacketHandler(IOUSBController *this, OSObject *a2, void *a3, int a4)
{
  signed int v4; // er13@1
  __int64 v5; // r12@1
  __int64 v6; // r15@1
  int v7; // ebx@1
  unsigned __int16 v8; // r14@1
  unsigned __int8 v9; // al@1
  int v10; // er14@2
  __int64 v11; // r15@5
  char v12; // bl@5
  char v13; // al@5
  unsigned __int8 v14; // r15@7
  char v15; // al@9
  char v16; // bl@12
  signed int v17; // ecx@16
  unsigned __int8 v18; // r15@18
  const OSMetaClass *v19; // rdx@18
  unsigned __int16 v20; // cx@18
  uintptr_t v21; // rax@22
  uintptr_t v22; // ST18_8@25
  __int64 v23; // rax@32
  __int64 v24; // r13@32
  __int64 v25; // r14@34
  __int64 v26; // rax@35
  __int64 v27; // rbx@35
  unsigned __int64 v28; // rax@39
  __int64 v29; // rdx@39
  signed __int64 v30; // rcx@39
  int v31; // er15@42
  unsigned __int16 v32; // r14@42
  __int64 v33; // rax@42
  __int64 v34; // rax@45
  __int64 v35; // rax@45
  __int64 v36; // r14@48
  __int64 v37; // rax@49
  __int64 v38; // rax@51
  __int64 v39; // rax@53
  __int64 v40; // r14@53
  __int64 v41; // rbx@53
  __int64 v42; // r9@53
  __int64 v43; // rax@53
  char v44; // bl@56
  unsigned int v45; // er15@56
  unsigned int v46; // er13@56
  __int64 v47; // r14@57
  char v49; // [sp+0h] [bp-D0h]@0
  unsigned __int8 v50; // [sp+28h] [bp-A8h]@18
  unsigned __int8 v51; // [sp+28h] [bp-A8h]@42
  int v52; // [sp+2Ch] [bp-A4h]@34
  int v53; // [sp+2Ch] [bp-A4h]@47
  char v54; // [sp+30h] [bp-A0h]@34
  char v55; // [sp+30h] [bp-A0h]@52
  unsigned __int16 v56; // [sp+38h] [bp-98h]@18
  signed int v57; // [sp+38h] [bp-98h]@32
  int arg4; // [sp+3Ch] [bp-94h]@1
  __int64 v59; // [sp+60h] [bp-70h]@56
  uintptr_t v60; // [sp+68h] [bp-68h]@56
  __int64 v61; // [sp+70h] [bp-60h]@56
  __int64 v62; // [sp+78h] [bp-58h]@56
  uintptr_t v63; // [sp+80h] [bp-50h]@56
  __int64 v64; // [sp+88h] [bp-48h]@56
  uintptr_t arg3; // [sp+90h] [bp-40h]@41
  uintptr_t v66; // [sp+98h] [bp-38h]@41
  __int64 v67; // [sp+A0h] [bp-30h]@1

  arg4 = a4;
  v4 = (signed int)a3;
  v5 = (__int64)a2;
  v6 = off_3B0E0[0];
  v67 = *(_QWORD *)off_3B0E0[0];
  v7 = *(_DWORD *)(*((_QWORD *)this + 21) + 28LL);
  v8 = IOUSBCommand::GetAddress(a2);
  v9 = IOUSBCommand::GetEndpoint(a2);
  if ( !a2 )
    return *(_QWORD *)v6;
  v10 = (v7 << 16) | (v8 << 8) | v9;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
  {
    a2 = this;
    kernel_debug(0x52D0009u, (uintptr_t)this, (unsigned int)v10, v4, (unsigned int)arg4, 0LL);
  }
  v11 = IOUSBCommand::GetRequest((IOUSBCommand *)v5);
  v12 = 16 * (unsigned __int64)IOUSBCommand::GetStage((IOUSBCommand *)v5);
  v13 = v12 ^ (unsigned __int64)IOUSBCommand::GetStage((IOUSBCommand *)v5);
  if ( v13 & 0x10 )
  {
    a2 = (OSObject *)((unsigned __int8)IOUSBCommand::GetStage((IOUSBCommand *)v5) | 0x10u);
    IOUSBCommand::SetStage((IOUSBCommand *)v5, (char)a2);
  }
  else
  {
    if ( v13 & 0x20 )
    {
      v15 = IOUSBCommand::GetStage((IOUSBCommand *)v5);
      IOUSBCommand::SetStage((IOUSBCommand *)v5, v15 | 0x20);
      a2 = (OSObject *)(unsigned int)arg4;
      IOUSBCommand::SetDataRemaining((IOUSBCommand *)v5, arg4);
      v14 = *(_BYTE *)v11 >> 7;
      goto LABEL_12;
    }
    if ( v13 & 0x40 )
    {
      a2 = (OSObject *)((unsigned __int8)IOUSBCommand::GetStage((IOUSBCommand *)v5) | 0x40u);
      IOUSBCommand::SetStage((IOUSBCommand *)v5, (char)a2);
      v14 = (*(_BYTE *)v11 >> 7) ^ 1;
      goto LABEL_12;
    }
  }
  v14 = 0;
LABEL_12:
  v16 = v12 ^ IOUSBCommand::GetStage((IOUSBCommand *)v5) & 0xF0;
  if ( (unsigned int)(v4 + 536854448) >= 2 && v4 != -536870165 )
  {
    v17 = 0;
    if ( v4 )
    {
      v50 = v14;
      v56 = IOUSBCommand::GetAddress((IOUSBCommand *)v5);
      v18 = IOUSBCommand::GetEndpoint((IOUSBCommand *)v5);
      IOUSBCommand::SetStatus((IOUSBCommand *)v5, v4);
      v20 = v56;
      if ( v4 == -536854453 )
      {
        if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          kernel_debug(0x52D0008u, (uintptr_t)this, 0xFFFFFFFFE000404BLL, 0LL, 0LL, 0LL);
        v21 = OSMetaClassBase::safeMetaCast(this, (const OSMetaClassBase *)IOUSBControllerV2::metaClass, v19);
        v4 = -536870163;
        if ( v21 )
        {
          if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          {
            v22 = v21;
            kernel_debug(0x52D0008u, (uintptr_t)this, 0xFFFFFFFFE000404BLL, v21, 1uLL, 0LL);
            v21 = v22;
          }
          (*(void (__fastcall **)(uintptr_t, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v21 + 2736LL))(v21, v56, v18, v50);
          v20 = v56;
        }
        else
        {
          v20 = v56;
        }
      }
      a2 = (OSObject *)(unsigned int)(signed __int16)v20;
      (*(void (__fastcall **)(IOUSBController *, OSObject *, _QWORD, signed __int64))(*(_QWORD *)this + 2240LL))(
        this,
        a2,
        v18,
        3LL);
      v17 = v4;
      v14 = v50;
    }
    goto LABEL_31;
  }
  if ( (unsigned int)IOUSBCommand::GetStatus((IOUSBCommand *)v5) )
    goto LABEL_28;
  if ( v4 != -536854448 )
  {
    a2 = (OSObject *)(unsigned int)v4;
    IOUSBCommand::SetStatus((IOUSBCommand *)v5, v4);
LABEL_28:
    v17 = v4;
    goto LABEL_31;
  }
  a2 = (OSObject *)3758097131;
  IOUSBCommand::SetStatus((IOUSBCommand *)v5, -536870165);
  v17 = -536854448;
LABEL_31:
  if ( !(v16 & 0xF0) )
  {
    v57 = v17;
    v23 = *(_QWORD *)(v5 + 216);
    v24 = *(_QWORD *)(v23 + 56);
    if ( v24 && IOUSBCommand::GetBufferMemoryDescriptor(*(IOUSBCommand **)(v23 + 56)) )
    {
      v54 = v16;
      v52 = v10;
      v25 = *(_QWORD *)(*(_QWORD *)(v24 + 216) + 48LL);
      if ( v25 )
      {
        LODWORD(v26) = (*(int (__fastcall **)(__int64, OSObject *))(*(_QWORD *)v25 + 312LL))(v25, a2);
        v27 = v26;
        if ( v26 )
        {
          (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v25 + 304LL))(v25, 1LL);
          if ( gUSBStackDebugFlags & 2 )
          {
            if ( !v57 && !v14 )
            {
              LODWORD(v28) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v27 + 456LL))(v27);
              v30 = 16LL;
              if ( v28 <= 0x10 )
                v30 = (unsigned int)(*(int (__fastcall **)(__int64, signed __int64, __int64, signed __int64))(*(_QWORD *)v27 + 456LL))(
                                      v27,
                                      1LL,
                                      v29,
                                      16LL);
              v66 = 0LL;
              arg3 = 0LL;
              (*(void (__fastcall **)(__int64, _QWORD, uintptr_t *, signed __int64))(*(_QWORD *)v27 + 480LL))(
                v27,
                0LL,
                &arg3,
                v30);
              if ( gUSBStackDebugFlags & 2 )
              {
                v31 = *(_DWORD *)(*((_QWORD *)this + 21) + 28LL);
                v32 = IOUSBCommand::GetAddress((IOUSBCommand *)v5);
                v51 = IOUSBCommand::GetEndpoint((IOUSBCommand *)v5);
                LODWORD(v33) = (*(int (**)(void))(*(_QWORD *)v27 + 456LL))();
                if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
                  kernel_debug(
                    0x52D0090u,
                    v51 | (v32 << 8) | (unsigned int)(v31 << 16),
                    v33 - (unsigned int)arg4,
                    arg3,
                    v66,
                    0LL);
              }
            }
          }
        }
      }
      v10 = v52;
      if ( !(unsigned int)IOUSBCommand::GetSelector((IOUSBCommand *)v24) )
      {
        v34 = IOUSBCommand::GetBufferMemoryDescriptor((IOUSBCommand *)v24);
        (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v34 + 504LL))(v34, 0LL);
        v35 = IOUSBCommand::GetBufferMemoryDescriptor((IOUSBCommand *)v24);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v35 + 40LL))(v35);
      }
      a2 = 0LL;
      IOUSBCommand::SetBufferMemoryDescriptor((IOUSBCommand *)v24, 0LL);
      v16 = v54;
    }
    v53 = v10;
    if ( IOUSBCommand::GetRequestMemoryDescriptor((IOUSBCommand *)v5) )
    {
      v36 = *(_QWORD *)(*(_QWORD *)(v5 + 216) + 48LL);
      if ( v36 )
      {
        LODWORD(v37) = (*(int (__fastcall **)(__int64, OSObject *))(*(_QWORD *)v36 + 312LL))(v36, a2);
        if ( v37 )
        {
          a2 = (OSObject *)(&dword_0 + 1);
          (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v36 + 304LL))(v36, 1LL);
        }
      }
      v38 = IOUSBCommand::GetRequestMemoryDescriptor((IOUSBCommand *)v5);
      (*(void (__fastcall **)(__int64, OSObject *))(*(_QWORD *)v38 + 40LL))(v38, a2);
      IOUSBCommand::SetRequestMemoryDescriptor((IOUSBCommand *)v5, 0LL);
    }
    v55 = v16;
    if ( IOUSBCommand::GetBufferMemoryDescriptor((IOUSBCommand *)v5) )
    {
      LODWORD(v39) = (*(int (__fastcall **)(IOUSBController *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
      v40 = v39;
      v41 = IOUSBCommand::GetBufferMemoryDescriptor((IOUSBCommand *)v5);
      KernelDebugLogInternal(
        1u,
        0x55534246u,
        (__int64)"%s::ControlPacketHandler - unexpected command BufferMemoryDescriptor(%p)",
        v40,
        v41,
        v42,
        v49);
      v43 = IOUSBCommand::GetBufferMemoryDescriptor((IOUSBCommand *)v5);
      (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v43 + 40LL))(v43, 1431519814LL);
      IOUSBCommand::SetBufferMemoryDescriptor((IOUSBCommand *)v5, 0LL);
    }
    if ( v57 == -536870169 )
      IOUSBCommand::SetStatus((IOUSBCommand *)v5, 0);
    IOUSBCommand::GetStatus((IOUSBCommand *)v5);
    v44 = IOUSBCommand::GetIsSyncTransfer((IOUSBCommand *)v5);
    IOUSBCommand::GetClientCompletion((IOUSBCommand *)&v59, v5);
    v64 = v61;
    v63 = v60;
    v62 = v59;
    v45 = IOUSBCommand::GetStatus((IOUSBCommand *)v5);
    v46 = IOUSBCommand::GetDataRemaining((IOUSBCommand *)v5);
    if ( !v44 )
    {
      v47 = *(_QWORD *)(*(_QWORD *)(v5 + 216) + 56LL);
      IOUSBCommand::SetBufferUSBCommand((IOUSBCommand *)v5, 0LL);
      (*(void (__fastcall **)(_QWORD, __int64))(***((_QWORD ***)this + 21) + 304LL))(**((_QWORD **)this + 21), v5);
      if ( v47 )
        (*(void (__fastcall **)(_QWORD, __int64))(***((_QWORD ***)this + 21) + 304LL))(**((_QWORD **)this + 21), v47);
    }
    IOUSBController::Complete((uintptr_t)this, v63, v46, v45, v62, v63, v64);
    v10 = v53;
    v16 = v55;
    v17 = v57;
  }
  v6 = off_3B0E0[0];
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D000Au, (uintptr_t)this, (unsigned int)v10, v16 & 0xF0, v17, 0LL);
  return *(_QWORD *)v6;
}
// 0: using guessed type int dword_0;
// 3B0E0: using guessed type __int64 off_3B0E0[6];
// 3B100: using guessed type __int64 off_3B100[2];
// 419C0: using guessed type _QWORD IOUSBControllerV2::metaClass;
// 49460: using guessed type int gUSBStackDebugFlags;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000002880) ----------------------------------------------------
int __usercall IOUSBController::Complete@<eax>(uintptr_t arg1@<rdi>, uintptr_t arg2@<rcx>, unsigned int a3@<edx>, unsigned int a4@<esi>, __int64 a5, uintptr_t arg2a, __int64 a7)
{
  unsigned int v7; // er14@1
  uintptr_t v8; // rax@1

  v7 = a3;
  v8 = arg2a;
  if ( arg2a )
  {
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      kernel_debug(0x52D0068u, arg1, arg2a, (signed int)a4, 2uLL, 0LL);
      v8 = arg2a;
    }
    LODWORD(v8) = ((int (__fastcall *)(__int64, __int64, _QWORD, _QWORD))v8)(a5, a7, a4, v7);
  }
  return v8;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (00000000000028FC) ----------------------------------------------------
__int64 __fastcall IOUSBController::InterruptTransaction(uintptr_t arg1, IOUSBCommand *this)
{
  IOUSBCommand *v2; // rbx@1
  uintptr_t v3; // r14@1
  __int64 v4; // rdi@1
  __int64 v5; // rax@1
  signed __int64 v6; // rsi@3
  int v7; // er12@4
  unsigned __int16 v8; // r15@4
  unsigned __int8 v9; // r13@4
  uintptr_t v10; // rax@4
  unsigned __int64 v11; // rax@9
  __int64 v12; // rdx@9
  signed __int64 v13; // rcx@9
  int v14; // er15@12
  unsigned __int16 v15; // r12@12
  unsigned __int8 v16; // r13@12
  uintptr_t v17; // rax@12
  int v18; // er15@14
  unsigned int v19; // er12@17
  unsigned int v20; // eax@17
  __int64 result; // rax@19
  unsigned __int8 v22; // [sp+1Fh] [bp-61h]@4
  __int64 v23; // [sp+20h] [bp-60h]@3
  uintptr_t arg3; // [sp+40h] [bp-40h]@11
  uintptr_t arg4; // [sp+48h] [bp-38h]@11
  __int64 v26; // [sp+50h] [bp-30h]@1

  v2 = this;
  v3 = arg1;
  v26 = *(_QWORD *)off_3B0E0[0];
  v4 = *(_QWORD *)(*((_QWORD *)this + 27) + 48LL);
  v5 = 0LL;
  if ( v4 )
    LODWORD(v5) = (*(int (**)(void))(*(_QWORD *)v4 + 312LL))();
  v23 = v5;
  IOUSBCommand::SetUSLCompletion((__int64)this, v3, (__int64)IOUSBController::InterruptPacketHandler, (__int64)this);
  v6 = 1LL;
  IOUSBCommand::SetBufferRounding(v2, 1);
  if ( gUSBStackDebugFlags & 2 )
  {
    v22 = IOUSBCommand::GetDirection(v2);
    v7 = *(_DWORD *)(*(_QWORD *)(v3 + 168) + 28LL);
    v8 = IOUSBCommand::GetAddress(v2);
    v9 = IOUSBCommand::GetEndpoint(v2);
    v10 = IOUSBCommand::GetReqCount(v2);
    if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      v6 = v3;
      kernel_debug(0x52D0071u, v3, v9 | (v8 << 8) | (v7 << 16) | ((unsigned int)v22 << 24), v10, 0LL, 0LL);
    }
  }
  if ( gUSBStackDebugFlags & 2 && v23 && !(unsigned __int8)IOUSBCommand::GetDirection(v2) )
  {
    LODWORD(v11) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v23 + 456LL))(v23, v6);
    v13 = 16LL;
    if ( v11 <= 0x10 )
      v13 = (unsigned int)(*(int (__fastcall **)(__int64, signed __int64, __int64, signed __int64))(*(_QWORD *)v23
                                                                                                  + 456LL))(
                            v23,
                            v6,
                            v12,
                            16LL);
    arg4 = 0LL;
    arg3 = 0LL;
    (*(void (__fastcall **)(__int64, _QWORD, uintptr_t *, signed __int64))(*(_QWORD *)v23 + 480LL))(
      v23,
      0LL,
      &arg3,
      v13);
    if ( gUSBStackDebugFlags & 2 )
    {
      v14 = *(_DWORD *)(*(_QWORD *)(v3 + 168) + 28LL);
      v15 = IOUSBCommand::GetAddress(v2);
      v16 = IOUSBCommand::GetEndpoint(v2);
      v17 = IOUSBCommand::GetReqCount(v2);
      if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D0070u, v16 | (v15 << 8) | (unsigned int)(v14 << 16), v17, arg3, arg4, 0LL);
    }
  }
  ++*(_DWORD *)(*(_QWORD *)(v3 + 168) + 208LL);
  v18 = (*(int (__fastcall **)(uintptr_t, IOUSBCommand *))(*(_QWORD *)v3 + 2520LL))(v3, v2);
  if ( v18 )
    --*(_DWORD *)(*(_QWORD *)(v3 + 168) + 208LL);
  if ( gUSBStackDebugFlags & 2 )
  {
    v19 = IOUSBCommand::GetCompletionTimeout(v2);
    v20 = IOUSBCommand::GetNoDataTimeout(v2);
    if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D0072u, v3, v18, v19, v20, 0LL);
  }
  result = *(_QWORD *)off_3B0E0[0];
  if ( *(_QWORD *)off_3B0E0[0] == v26 )
    result = (unsigned int)v18;
  return result;
}
// 3B0E0: using guessed type __int64 off_3B0E0[6];
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (0000000000002B82) ----------------------------------------------------
__int64 __fastcall IOUSBController::InterruptPacketHandler(IOUSBController *this, OSObject *a2, void *a3, int a4)
{
  signed int v4; // ebx@1
  IOUSBCommand *v5; // r15@1
  __int64 v6; // r14@1
  __int64 v7; // rax@1
  signed int v8; // ecx@3
  unsigned __int8 v9; // r12@7
  int v10; // ebx@7
  unsigned __int16 v11; // r13@7
  unsigned __int8 v12; // al@7
  uintptr_t v13; // rdx@8
  uintptr_t v14; // r8@8
  uintptr_t v15; // rcx@8
  uintptr_t v16; // rsi@8
  int v17; // er12@10
  int v18; // ebx@10
  uintptr_t v19; // r12@10
  uintptr_t v20; // rax@10
  __int64 v21; // rax@11
  unsigned __int64 v22; // rax@20
  __int64 v23; // rdx@20
  signed __int64 v24; // rcx@20
  int v25; // er14@23
  unsigned __int16 v26; // r12@23
  unsigned __int8 v27; // r13@23
  __int64 v28; // rax@23
  char v29; // r13@25
  __int64 v30; // r12@25
  uintptr_t v31; // r14@25
  char v32; // bl@25
  __int64 v34; // [sp+18h] [bp-C8h]@25
  int v35; // [sp+24h] [bp-BCh]@1
  __int64 v36; // [sp+28h] [bp-B8h]@3
  __int64 v37; // [sp+28h] [bp-B8h]@25
  unsigned int v38; // [sp+3Ch] [bp-A4h]@5
  char v39; // [sp+70h] [bp-70h]@25
  __int64 v40; // [sp+78h] [bp-68h]@26
  __int64 v41; // [sp+88h] [bp-58h]@25
  uintptr_t v42; // [sp+90h] [bp-50h]@25
  __int64 v43; // [sp+98h] [bp-48h]@25
  uintptr_t arg3; // [sp+A0h] [bp-40h]@22
  uintptr_t arg4; // [sp+A8h] [bp-38h]@22
  __int64 v46; // [sp+B0h] [bp-30h]@1

  v35 = a4;
  v4 = (signed int)a3;
  v5 = a2;
  v46 = *(_QWORD *)off_3B0E0[0];
  v6 = *(_QWORD *)(*((_QWORD *)a2 + 27) + 48LL);
  v7 = 0LL;
  if ( v6 )
    LODWORD(v7) = (*(int (__fastcall **)(_QWORD))(*(_QWORD *)v6 + 312LL))(*(_QWORD *)(*((_QWORD *)a2 + 27) + 48LL));
  v36 = v7;
  v8 = -536870165;
  if ( v4 != -536854448 )
    v8 = v4;
  v38 = v8;
  if ( v8 )
  {
    if ( gUSBStackDebugFlags & 2 )
    {
      v9 = IOUSBCommand::GetDirection(a2);
      v10 = *(_DWORD *)(*((_QWORD *)this + 21) + 28LL);
      v11 = IOUSBCommand::GetAddress(a2);
      v12 = IOUSBCommand::GetEndpoint(a2);
      if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        v13 = v12 | (v11 << 8) | (v10 << 16) | ((unsigned int)v9 << 24);
        v14 = (signed int)v38;
        v15 = 0LL;
        v16 = (uintptr_t)this;
LABEL_14:
        kernel_debug(0x52D0084u, v16, v13, v15, v14, 0LL);
        goto LABEL_15;
      }
    }
  }
  else if ( gUSBStackDebugFlags & 2 )
  {
    v17 = ((unsigned __int8)IOUSBCommand::GetDirection(a2) << 24) | (*(_DWORD *)(*((_QWORD *)this + 21) + 28LL) << 16);
    v18 = v17 | ((unsigned __int16)IOUSBCommand::GetAddress(a2) << 8);
    v19 = v18 | (unsigned int)(unsigned __int8)IOUSBCommand::GetEndpoint(a2);
    v20 = 0LL;
    if ( v36 )
    {
      LODWORD(v21) = (*(int (**)(void))(*(_QWORD *)v36 + 456LL))();
      v20 = v21 - (unsigned int)v35;
    }
    if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      v14 = 0LL;
      v16 = (uintptr_t)this;
      v13 = v19;
      v15 = v20;
      goto LABEL_14;
    }
  }
LABEL_15:
  IOUSBCommand::SetStatus(v5, v38);
  if ( v6 )
  {
    if ( v36 )
    {
      (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v6 + 304LL))(v6, 1LL);
      if ( gUSBStackDebugFlags & 2 )
      {
        if ( !v38 && (unsigned __int8)IOUSBCommand::GetDirection(v5) == 1 )
        {
          LODWORD(v22) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v36 + 456LL))(v36);
          v24 = 16LL;
          if ( v22 <= 0x10 )
            v24 = (unsigned int)(*(int (__fastcall **)(__int64, signed __int64, __int64, signed __int64))(*(_QWORD *)v36 + 456LL))(
                                  v36,
                                  1LL,
                                  v23,
                                  16LL);
          arg4 = 0LL;
          arg3 = 0LL;
          (*(void (__fastcall **)(__int64, _QWORD, uintptr_t *, signed __int64))(*(_QWORD *)v36 + 480LL))(
            v36,
            0LL,
            &arg3,
            v24);
          if ( gUSBStackDebugFlags & 2 )
          {
            v25 = *(_DWORD *)(*((_QWORD *)this + 21) + 28LL);
            v26 = IOUSBCommand::GetAddress(v5);
            v27 = IOUSBCommand::GetEndpoint(v5);
            LODWORD(v28) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v36 + 456LL))(v36);
            if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
              kernel_debug(
                0x52D00A0u,
                v27 | (v26 << 8) | (unsigned int)(v25 << 16),
                v28 - (unsigned int)v35,
                arg3,
                arg4,
                0LL);
          }
        }
      }
    }
  }
  v29 = IOUSBCommand::GetIsSyncTransfer(v5);
  IOUSBCommand::GetClientCompletion((IOUSBCommand *)&v41, (__int64)v5);
  v30 = v41;
  v31 = v42;
  v37 = v43;
  v34 = IOUSBCommand::GetTimeStamp(v5);
  v32 = IOUSBCommand::GetUseTimeStamp(v5);
  IOUSBCommand::GetDisjointCompletion((IOUSBCommand *)&v39, (__int64)v5);
  if ( !v29 && !v40 )
    (*(void (__fastcall **)(_QWORD, IOUSBCommand *))(***((_QWORD ***)this + 21) + 304LL))(**((_QWORD **)this + 21), v5);
  if ( v32 )
    IOUSBController::CompleteWithTimeStamp((uintptr_t)this, v34, v35, v38, v30, v31, v37);
  else
    IOUSBController::Complete((uintptr_t)this, v31, v35, v38, v30, v31, v37);
  --*(_DWORD *)(*((_QWORD *)this + 21) + 208LL);
  return *(_QWORD *)off_3B0E0[0];
}
// 3B0E0: using guessed type __int64 off_3B0E0[6];
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (0000000000002FA8) ----------------------------------------------------
int __usercall IOUSBController::CompleteWithTimeStamp@<eax>(uintptr_t arg1@<rdi>, uintptr_t arg2@<rcx>, unsigned int a3@<edx>, unsigned int a4@<esi>, __int64 a5, uintptr_t arg2a, __int64 a7)
{
  uintptr_t v7; // r14@1
  unsigned int v8; // er15@1
  uintptr_t v9; // rax@1

  v7 = arg2;
  v8 = a3;
  v9 = arg2a;
  if ( arg2a )
  {
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      kernel_debug(0x52D0068u, arg1, arg2a, (signed int)a4, 3uLL, 0LL);
      v9 = arg2a;
    }
    LODWORD(v9) = ((int (__fastcall *)(__int64, __int64, _QWORD, _QWORD, uintptr_t))v9)(a5, a7, a4, v8, v7);
  }
  return v9;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (0000000000003028) ----------------------------------------------------
__int64 __fastcall IOUSBController::BulkTransaction(uintptr_t arg1, IOUSBCommand *this)
{
  IOUSBCommand *v2; // r13@1
  __int64 v3; // rbx@1
  __int64 v4; // rdi@1
  __int64 v5; // rax@1
  signed __int64 v6; // rsi@3
  uintptr_t v7; // r12@3
  int v8; // er14@4
  unsigned __int16 v9; // r15@4
  unsigned __int8 v10; // bl@4
  uintptr_t v11; // rax@4
  uintptr_t v12; // r14@6
  unsigned __int64 v13; // rax@9
  __int64 v14; // rdx@9
  signed __int64 v15; // rcx@9
  int v16; // er15@12
  unsigned __int16 v17; // r12@12
  unsigned __int8 v18; // bl@12
  uintptr_t v19; // rax@12
  int v20; // er15@14
  unsigned int v21; // er12@15
  unsigned int v22; // eax@15
  __int64 result; // rax@17
  unsigned __int8 v24; // [sp+1Fh] [bp-61h]@4
  __int64 v25; // [sp+20h] [bp-60h]@3
  uintptr_t arg3; // [sp+40h] [bp-40h]@11
  uintptr_t arg4; // [sp+48h] [bp-38h]@11
  __int64 v28; // [sp+50h] [bp-30h]@1

  v2 = this;
  v3 = arg1;
  v28 = *(_QWORD *)off_3B0E0[0];
  v4 = *(_QWORD *)(*((_QWORD *)this + 27) + 48LL);
  v5 = 0LL;
  if ( v4 )
    LODWORD(v5) = (*(int (**)(void))(*(_QWORD *)v4 + 312LL))();
  v25 = v5;
  IOUSBCommand::SetUSLCompletion((__int64)this, v3, (__int64)IOUSBController::BulkPacketHandler, (__int64)this);
  v6 = 1LL;
  IOUSBCommand::SetBufferRounding(v2, 1);
  v7 = v3;
  if ( gUSBStackDebugFlags & 2 )
  {
    v24 = IOUSBCommand::GetDirection(v2);
    v8 = *(_DWORD *)(*(_QWORD *)(v3 + 168) + 28LL);
    v9 = IOUSBCommand::GetAddress(v2);
    v10 = IOUSBCommand::GetEndpoint(v2);
    v11 = IOUSBCommand::GetReqCount(v2);
    if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      v6 = v7;
      kernel_debug(0x52D0079u, v7, v10 | (v9 << 8) | (v8 << 16) | ((unsigned int)v24 << 24), v11, 0LL, 0LL);
    }
  }
  v12 = v7;
  if ( gUSBStackDebugFlags & 2 && v25 && !(unsigned __int8)IOUSBCommand::GetDirection(v2) )
  {
    LODWORD(v13) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v25 + 456LL))(v25, v6);
    v15 = 16LL;
    if ( v13 <= 0x10 )
      v15 = (unsigned int)(*(int (__fastcall **)(__int64, signed __int64, __int64, signed __int64))(*(_QWORD *)v25
                                                                                                  + 456LL))(
                            v25,
                            v6,
                            v14,
                            16LL);
    arg4 = 0LL;
    arg3 = 0LL;
    (*(void (__fastcall **)(__int64, _QWORD, uintptr_t *, signed __int64))(*(_QWORD *)v25 + 480LL))(
      v25,
      0LL,
      &arg3,
      v15);
    if ( gUSBStackDebugFlags & 2 )
    {
      v16 = *(_DWORD *)(*(_QWORD *)(v7 + 168) + 28LL);
      v17 = IOUSBCommand::GetAddress(v2);
      v18 = IOUSBCommand::GetEndpoint(v2);
      v19 = IOUSBCommand::GetReqCount(v2);
      if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D007Cu, v18 | (v17 << 8) | (unsigned int)(v16 << 16), v19, arg3, arg4, 0LL);
    }
  }
  v20 = (*(int (__fastcall **)(uintptr_t, IOUSBCommand *))(*(_QWORD *)v12 + 2512LL))(v12, v2);
  if ( gUSBStackDebugFlags & 2 )
  {
    v21 = IOUSBCommand::GetCompletionTimeout(v2);
    v22 = IOUSBCommand::GetNoDataTimeout(v2);
    if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D007Au, v12, v20, v21, v22, 0LL);
  }
  result = *(_QWORD *)off_3B0E0[0];
  if ( *(_QWORD *)off_3B0E0[0] == v28 )
    result = (unsigned int)v20;
  return result;
}
// 3B0E0: using guessed type __int64 off_3B0E0[6];
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (0000000000003292) ----------------------------------------------------
__int64 __fastcall IOUSBController::BulkPacketHandler(IOUSBController *this, OSObject *a2, void *a3, int a4)
{
  signed int v4; // ebx@1
  IOUSBCommand *v5; // r13@1
  __int64 v6; // r14@1
  __int64 v7; // rax@1
  signed int v8; // er12@3
  int v9; // er15@7
  unsigned __int16 v10; // bx@7
  unsigned __int8 v11; // al@7
  uintptr_t v12; // rdx@8
  uintptr_t v13; // r8@8
  uintptr_t v14; // rcx@8
  uintptr_t v15; // rsi@8
  int v16; // ebx@10
  int v17; // er15@10
  uintptr_t v18; // rbx@10
  __int64 v19; // rax@10
  unsigned __int64 v20; // rax@20
  __int64 v21; // rdx@20
  signed __int64 v22; // rcx@20
  int v23; // er14@23
  unsigned __int16 v24; // bx@23
  unsigned __int8 v25; // r15@23
  __int64 v26; // rax@23
  char v27; // bl@25
  unsigned __int8 v29; // [sp+1Bh] [bp-B5h]@7
  int v30; // [sp+1Ch] [bp-B4h]@1
  __int64 v31; // [sp+20h] [bp-B0h]@3
  char v32; // [sp+48h] [bp-88h]@25
  __int64 v33; // [sp+50h] [bp-80h]@26
  __int64 v34; // [sp+60h] [bp-70h]@25
  uintptr_t v35; // [sp+68h] [bp-68h]@25
  __int64 v36; // [sp+70h] [bp-60h]@25
  __int64 v37; // [sp+78h] [bp-58h]@25
  uintptr_t v38; // [sp+80h] [bp-50h]@25
  __int64 v39; // [sp+88h] [bp-48h]@25
  uintptr_t arg3; // [sp+90h] [bp-40h]@22
  uintptr_t arg4; // [sp+98h] [bp-38h]@22
  __int64 v42; // [sp+A0h] [bp-30h]@1

  v30 = a4;
  v4 = (signed int)a3;
  v5 = a2;
  v42 = *(_QWORD *)off_3B0E0[0];
  v6 = *(_QWORD *)(*((_QWORD *)a2 + 27) + 48LL);
  v7 = 0LL;
  if ( v6 )
    LODWORD(v7) = (*(int (__fastcall **)(_QWORD))(*(_QWORD *)v6 + 312LL))(*(_QWORD *)(*((_QWORD *)a2 + 27) + 48LL));
  v31 = v7;
  v8 = -536870165;
  if ( v4 != -536854448 )
    v8 = v4;
  if ( v8 )
  {
    if ( gUSBStackDebugFlags & 2 )
    {
      v29 = IOUSBCommand::GetDirection(a2);
      v9 = *(_DWORD *)(*((_QWORD *)this + 21) + 28LL);
      v10 = IOUSBCommand::GetAddress(a2);
      v11 = IOUSBCommand::GetEndpoint(a2);
      if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        v12 = v11 | (v10 << 8) | (v9 << 16) | ((unsigned int)v29 << 24);
        v13 = v8;
        v14 = 0LL;
        v15 = (uintptr_t)this;
LABEL_14:
        kernel_debug(0x52D0088u, v15, v12, v14, v13, 0LL);
        goto LABEL_15;
      }
    }
  }
  else if ( gUSBStackDebugFlags & 2 )
  {
    v16 = ((unsigned __int8)IOUSBCommand::GetDirection(a2) << 24) | (*(_DWORD *)(*((_QWORD *)this + 21) + 28LL) << 16);
    v17 = v16 | ((unsigned __int16)IOUSBCommand::GetAddress(a2) << 8);
    v18 = v17 | (unsigned int)(unsigned __int8)IOUSBCommand::GetEndpoint(a2);
    v19 = 0LL;
    if ( v31 )
      v19 = IOUSBCommand::GetReqCount(a2) - (unsigned int)v30;
    if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      v13 = 0LL;
      v15 = (uintptr_t)this;
      v12 = v18;
      v14 = v19;
      goto LABEL_14;
    }
  }
LABEL_15:
  if ( v6 )
  {
    if ( v31 )
    {
      (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v6 + 304LL))(v6, 1LL);
      if ( gUSBStackDebugFlags & 2 )
      {
        if ( !v8 && (unsigned __int8)IOUSBCommand::GetDirection(v5) == 1 )
        {
          LODWORD(v20) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v31 + 456LL))(v31);
          v22 = 16LL;
          if ( v20 <= 0x10 )
            v22 = (unsigned int)(*(int (__fastcall **)(__int64, signed __int64, __int64, signed __int64))(*(_QWORD *)v31 + 456LL))(
                                  v31,
                                  1LL,
                                  v21,
                                  16LL);
          arg4 = 0LL;
          arg3 = 0LL;
          (*(void (__fastcall **)(__int64, _QWORD, uintptr_t *, signed __int64))(*(_QWORD *)v31 + 480LL))(
            v31,
            0LL,
            &arg3,
            v22);
          if ( gUSBStackDebugFlags & 2 )
          {
            v23 = *(_DWORD *)(*((_QWORD *)this + 21) + 28LL);
            v24 = IOUSBCommand::GetAddress(v5);
            v25 = IOUSBCommand::GetEndpoint(v5);
            v26 = IOUSBCommand::GetReqCount(v5);
            if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
              kernel_debug(
                0x52D009Cu,
                v25 | (v24 << 8) | (unsigned int)(v23 << 16),
                v26 - (unsigned int)v30,
                arg3,
                arg4,
                0LL);
          }
        }
      }
    }
  }
  IOUSBCommand::SetStatus(v5, v8);
  v27 = IOUSBCommand::GetIsSyncTransfer(v5);
  IOUSBCommand::GetClientCompletion((IOUSBCommand *)&v34, (__int64)v5);
  v39 = v36;
  v38 = v35;
  v37 = v34;
  IOUSBCommand::GetDisjointCompletion((IOUSBCommand *)&v32, (__int64)v5);
  if ( !v27 && !v33 )
    (*(void (__fastcall **)(_QWORD, IOUSBCommand *))(***((_QWORD ***)this + 21) + 304LL))(**((_QWORD **)this + 21), v5);
  IOUSBController::Complete((uintptr_t)this, v38, v30, v8, v37, v38, v39);
  return *(_QWORD *)off_3B0E0[0];
}
// 3B0E0: using guessed type __int64 off_3B0E0[6];
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (0000000000003634) ----------------------------------------------------
__int64 __fastcall IOUSBController::DoIsocTransfer(IOUSBController *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  __int64 v6; // rax@4
  __int64 v7; // ST20_8@4
  __int64 v8; // rax@4
  __int64 result; // rax@4
  __int64 v10; // r14@5
  char v11; // [sp+0h] [bp-60h]@0
  char v12; // [sp+2Fh] [bp-31h]@4
  IOUSBController *v13; // [sp+30h] [bp-30h]@4
  char *v14; // [sp+38h] [bp-28h]@4
  __int64 v15; // [sp+40h] [bp-20h]@4
  __int64 v16; // [sp+48h] [bp-18h]@4

  if ( this && a2 )
  {
    if ( *(_BYTE *)(*((_QWORD *)a2 + 13) + 16LL) )
    {
      v12 = 1;
      v6 = *((_QWORD *)a2 + 7);
      v7 = *((_QWORD *)a2 + 8);
      v13 = this;
      v14 = &v12;
      v16 = v7;
      v15 = v6;
      *((_QWORD *)a2 + 6) = &v13;
      v8 = v15;
      *((_QWORD *)a2 + 8) = v16;
      *((_QWORD *)a2 + 7) = v8;
      result = IOUSBController::IsocTransaction(this, a2);
      if ( !(_DWORD)result )
      {
        v10 = *((_QWORD *)this + 18);
        if ( (*(int (__fastcall **)(__int64, char *, signed __int64))(*(_QWORD *)v10 + 480LL))(v10, &v12, 2LL) )
          (*(void (__fastcall **)(__int64, int (__fastcall *)(IOUSBController *, OSObject *, void *, void *, void *, void *), _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v10 + 456LL))(
            v10,
            IOUSBController::DoAbortEP,
            *((_WORD *)a2 + 18),
            *((_BYTE *)a2 + 38),
            *((_BYTE *)a2 + 39),
            0LL);
        v12 = 0;
        result = *((_DWORD *)a2 + 24);
      }
    }
    else
    {
      result = IOUSBController::IsocTransaction(this, a2);
    }
  }
  else
  {
    KernelDebugLogInternal(
      1u,
      0x55534246u,
      (__int64)"IOUSBController::DoIsocTransfer -- bad controller or command (%p,%p)",
      (__int64)this,
      (__int64)a2,
      (__int64)a6,
      v11);
    result = 3758097090LL;
  }
  return result;
}

//----- (0000000000003752) ----------------------------------------------------
__int64 __fastcall IOUSBController::IsocTransaction(IOUSBController *this, IOUSBIsocCommand *a2)
{
  IOUSBIsocCommand *v2; // r14@1
  char v3; // al@1
  unsigned int v4; // edx@3
  __int64 v5; // rax@9
  __int64 v6; // rax@9
  unsigned int v7; // esi@10
  int v8; // er15@13
  __int64 v9; // rax@14
  bool v10; // zf@14

  v2 = a2;
  v3 = gUSBStackDebugFlags;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
  {
    v4 = (*((_BYTE *)a2 + 39) << 24) | (*(_DWORD *)(*((_QWORD *)this + 21) + 28LL) << 16) | (*((_WORD *)a2 + 18) << 8) | *((_BYTE *)a2 + 38) | 0x80000000;
    if ( !*(_BYTE *)(*((_QWORD *)a2 + 13) + 56LL) )
      v4 = (*((_BYTE *)a2 + 39) << 24) | (*(_DWORD *)(*((_QWORD *)this + 21) + 28LL) << 16) | (*((_WORD *)a2 + 18) << 8) | *((_BYTE *)a2 + 38);
    kernel_debug(0x52D0081u, (uintptr_t)this, v4, *((_QWORD *)a2 + 9), *((_DWORD *)a2 + 20), 0LL);
    v3 = gUSBStackDebugFlags;
  }
  if ( v3 & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D0080u, (uintptr_t)this, **((_DWORD **)a2 + 13), 0LL, 0LL, 0LL);
  v5 = *((_QWORD *)a2 + 13);
  *(_QWORD *)(v5 + 32) = this;
  *(_QWORD *)(v5 + 40) = IOUSBController::IsocCompletionHandler;
  *(_QWORD *)(v5 + 48) = a2;
  v6 = *((_QWORD *)this + 21);
  if ( !*(_DWORD *)(v6 + 188) )
  {
    v7 = *(_DWORD *)(v6 + 204);
    if ( v7 )
    {
      IOService::requireMaxBusStall(this, v7);
      if ( OSMetaClassBase::metaCast(this, "AppleUSBUHCI") )
        IOService::requireMaxInterruptDelay(this, *(_DWORD *)(*((_QWORD *)this + 21) + 204LL));
    }
  }
  ++*(_DWORD *)(*((_QWORD *)this + 21) + 188LL);
  v8 = (*(int (__fastcall **)(IOUSBController *, IOUSBIsocCommand *))(*(_QWORD *)this + 2624LL))(this, v2);
  if ( v8 )
  {
    v9 = *((_QWORD *)this + 21);
    v10 = (*(_DWORD *)(v9 + 188))-- == 1;
    if ( v10 )
    {
      if ( *(_DWORD *)(v9 + 204) )
      {
        IOService::requireMaxBusStall(this, 0);
        if ( OSMetaClassBase::metaCast(this, "AppleUSBUHCI") )
          IOService::requireMaxInterruptDelay(this, 0);
      }
    }
  }
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D0082u, (uintptr_t)this, v8, *((_QWORD *)v2 + 11), 0LL, 0LL);
  return (unsigned int)v8;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (000000000000390A) ----------------------------------------------------
int __fastcall IOUSBController::DoAbortEP(IOUSBController *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  return (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 2224LL))(
           this,
           (unsigned int)(signed __int16)a2,
           (unsigned int)(signed __int16)a3,
           (unsigned int)(signed __int16)a4,
           a5,
           a6);
}

//----- (0000000000003924) ----------------------------------------------------
__int64 __fastcall IOUSBController::DoLowLatencyIsocTransfer(IOUSBController *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  char savedregs; // [sp+0h] [bp+0h]@0

  KernelDebugLogInternal(
    1u,
    0x55534246u,
    (__int64)"IOUSBController::DoLowLatencyIsocTransfer no longer used",
    (__int64)a4,
    (__int64)a5,
    (__int64)a6,
    savedregs);
  return 3758097087LL;
}

//----- (0000000000003948) ----------------------------------------------------
int __fastcall IOUSBController::IsocCompletionHandler(OSMetaClassBase *a1, __int64 a2, const OSMetaClass *a3, __int64 a4)
{
  __int64 v4; // r15@1
  int v5; // er12@1
  __int64 v6; // rdi@1
  __int64 v7; // rax@2
  __int64 v8; // rax@5
  char v9; // r14@5
  uintptr_t v10; // r13@5
  __int64 v11; // rdi@6
  __int64 v12; // r15@6
  __int64 v13; // ST00_8@8
  __int64 v15; // [sp+8h] [bp-38h]@6
  uintptr_t arg1; // [sp+10h] [bp-30h]@1

  v4 = a4;
  v5 = (signed int)a3;
  arg1 = OSMetaClassBase::safeMetaCast(a1, (const OSMetaClassBase *)&IOUSBController::gMetaClass, a3);
  v6 = *(_QWORD *)(*(_QWORD *)(a2 + 104) + 24LL);
  if ( v6 )
  {
    LODWORD(v7) = (*(int (__fastcall **)(__int64, _QWORD *))(*(_QWORD *)v6 + 312LL))(v6, &IOUSBController::gMetaClass);
    *(_DWORD *)(a2 + 96) = v5;
    if ( v7 )
      (*(void (__fastcall **)(_QWORD, signed __int64))(**(_QWORD **)(*(_QWORD *)(a2 + 104) + 24LL) + 304LL))(
        *(_QWORD *)(*(_QWORD *)(a2 + 104) + 24LL),
        1LL);
  }
  else
  {
    *(_DWORD *)(a2 + 96) = v5;
  }
  v8 = *(_QWORD *)(a2 + 104);
  v9 = *(_BYTE *)(v8 + 16);
  v10 = *(_QWORD *)(a2 + 56);
  if ( v10 )
  {
    v15 = v4;
    v11 = *(_QWORD *)(a2 + 48);
    v12 = *(_QWORD *)(a2 + 64);
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      v13 = *(_QWORD *)(a2 + 48);
      kernel_debug(0x52D0068u, arg1, v10, v5, 1uLL, 0LL);
      v11 = v13;
    }
    LODWORD(v8) = ((int (__fastcall *)(__int64, __int64, _QWORD, __int64))v10)(v11, v12, (unsigned int)v5, v15);
  }
  if ( !v9 )
    LODWORD(v8) = (*(int (__fastcall **)(_QWORD, __int64))(**(_QWORD **)(*(_QWORD *)(arg1 + 168) + 8LL) + 304LL))(
                    *(_QWORD *)(*(_QWORD *)(arg1 + 168) + 8LL),
                    a2);
  return v8;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 49588: using guessed type _QWORD IOUSBController::gMetaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000003A54) ----------------------------------------------------
__int64 __fastcall IOUSBController::LowLatencyIsocTransaction(IOUSBController *this, IOUSBIsocCommand *a2)
{
  __int64 v2; // rax@1
  __int64 v3; // r8@1
  __int64 v4; // r9@1
  char savedregs; // [sp+0h] [bp+0h]@0

  LODWORD(v2) = (*(int (__fastcall **)(IOUSBController *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
  KernelDebugLogInternal(
    1u,
    0x55534246u,
    (__int64)"%s::LowLatencyIsocTransaction no longer used",
    v2,
    v3,
    v4,
    savedregs);
  return 3758097087LL;
}

//----- (0000000000003A86) ----------------------------------------------------
__int64 __fastcall IOUSBController::DoIOTransfer(uintptr_t arg1, OSObject *this, void *a3, void *a4, void *a5, void *a6)
{
  uintptr_t v6; // r15@1
  __int64 v7; // r14@3
  void (__usercall *v8)(void *@<rdi>, void *@<rsi>, char@<al>, unsigned int@<edx>, unsigned int@<ecx>, __int64@<r8>, __int64@<r9>); // rbx@3
  __int64 v9; // r12@3
  __int64 result; // rax@6
  int v11; // ecx@7
  int v12; // ecx@12
  int v13; // er12@15
  unsigned __int16 v14; // bx@15
  unsigned int v15; // eax@15
  int v16; // er12@17
  int v17; // ebx@18
  int v18; // eax@18
  uintptr_t v19; // rdx@19
  uintptr_t v20; // r8@19
  uintptr_t v21; // rcx@19
  uint32_t v22; // edi@19
  int v23; // er12@23
  unsigned __int16 v24; // bx@23
  unsigned int v25; // eax@23
  int v26; // ebx@26
  int v27; // eax@26
  void (__fastcall *v28)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD); // rbx@30
  __int64 v29; // r15@30
  __int64 v30; // r12@30
  unsigned __int8 v31; // al@30
  char v32; // [sp+0h] [bp-E0h]@0
  unsigned __int8 v33; // [sp+26h] [bp-BAh]@15
  unsigned __int16 v34; // [sp+26h] [bp-BAh]@18
  unsigned __int8 v35; // [sp+26h] [bp-BAh]@23
  unsigned __int16 v36; // [sp+26h] [bp-BAh]@26
  unsigned int arg3; // [sp+28h] [bp-B8h]@15
  unsigned __int8 arg3a; // [sp+28h] [bp-B8h]@18
  unsigned int arg3b; // [sp+28h] [bp-B8h]@23
  unsigned __int8 arg3c; // [sp+28h] [bp-B8h]@26
  unsigned __int8 arg3_7; // [sp+2Fh] [bp-B1h]@15
  unsigned __int8 arg3_7a; // [sp+2Fh] [bp-B1h]@18
  unsigned __int8 arg3_7b; // [sp+2Fh] [bp-B1h]@23
  unsigned __int8 arg3_7c; // [sp+2Fh] [bp-B1h]@26
  char v45; // [sp+67h] [bp-79h]@4
  uintptr_t v46; // [sp+68h] [bp-78h]@4
  char *v47; // [sp+70h] [bp-70h]@4
  char v48; // [sp+78h] [bp-68h]@3
  __int64 v49; // [sp+80h] [bp-60h]@3
  __int64 v50; // [sp+88h] [bp-58h]@3
  char v51; // [sp+90h] [bp-50h]@3
  void (__usercall *v52)(void *@<rdi>, void *@<rsi>, char@<al>, unsigned int@<edx>, unsigned int@<ecx>, __int64@<r8>, __int64@<r9>); // [sp+98h] [bp-48h]@3
  __int64 v53; // [sp+A0h] [bp-40h]@3
  __int64 v54; // [sp+A8h] [bp-38h]@3
  __int64 v55; // [sp+B0h] [bp-30h]@3

  v6 = arg1;
  if ( !arg1 || !this )
  {
    KernelDebugLogInternal(
      1u,
      0x55534246u,
      (__int64)"IOUSBController::DoIOTransfer -- bad controller or command (%p,%p)",
      arg1,
      (__int64)this,
      (__int64)a6,
      v32);
    return 3758097090LL;
  }
  v7 = *(_QWORD *)(arg1 + 144);
  IOUSBCommand::GetClientCompletion((IOUSBCommand *)&v51, (__int64)this);
  v8 = v52;
  v9 = v53;
  IOUSBCommand::GetDisjointCompletion((IOUSBCommand *)&v48, (__int64)this);
  v55 = v50;
  v54 = v49;
  if ( IOUSBCommand::GetIsSyncTransfer(this) )
  {
    v45 = 1;
    v46 = arg1;
    v47 = &v45;
    if ( v8 == IOUSBSyncCompletion )
      IOUSBCommand::SetClientCompletion((__int64)this, (__int64)&v46, (__int64)IOUSBSyncCompletion, v9);
    else
      IOUSBCommand::SetDisjointCompletion((__int64)this, (__int64)&v46, v54, v55);
    v12 = (unsigned __int8)IOUSBCommand::GetType(this);
    if ( v12 == 2 )
    {
      result = IOUSBController::BulkTransaction(arg1, this);
      if ( (_DWORD)result )
        return result;
      if ( gUSBStackDebugFlags & 2 )
      {
        arg3_7 = IOUSBCommand::GetDirection(this);
        v13 = *(_DWORD *)(*(_QWORD *)(arg1 + 168) + 28LL);
        v14 = IOUSBCommand::GetAddress(this);
        v33 = IOUSBCommand::GetEndpoint(this);
        arg3 = IOUSBCommand::GetCompletionTimeout(this);
        v15 = IOUSBCommand::GetNoDataTimeout(this);
        if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          kernel_debug(0x52D0099u, arg1, v33 | (v14 << 8) | (v13 << 16) | ((unsigned int)arg3_7 << 24), arg3, v15, 0LL);
      }
      v16 = (*(int (__fastcall **)(__int64, char *, signed __int64))(*(_QWORD *)v7 + 480LL))(v7, &v45, 2LL);
      v45 = 0;
      if ( !(gUSBStackDebugFlags & 2) )
        goto LABEL_29;
      arg3_7a = IOUSBCommand::GetDirection(this);
      v17 = *(_DWORD *)(*(_QWORD *)(arg1 + 168) + 28LL);
      v34 = IOUSBCommand::GetAddress(this);
      arg3a = IOUSBCommand::GetEndpoint(this);
      v18 = IOUSBCommand::GetStatus(this);
      if ( !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
        goto LABEL_29;
      v19 = arg3a | (v34 << 8) | (v17 << 16) | ((unsigned int)arg3_7a << 24);
      v20 = v18;
      v21 = v16;
      v22 = 86835354;
    }
    else
    {
      result = 3758097090LL;
      if ( v12 != 3 )
        return result;
      result = IOUSBController::InterruptTransaction(arg1, this);
      if ( (_DWORD)result )
        return result;
      if ( gUSBStackDebugFlags & 2 )
      {
        arg3_7b = IOUSBCommand::GetDirection(this);
        v23 = *(_DWORD *)(*(_QWORD *)(arg1 + 168) + 28LL);
        v24 = IOUSBCommand::GetAddress(this);
        v35 = IOUSBCommand::GetEndpoint(this);
        arg3b = IOUSBCommand::GetCompletionTimeout(this);
        v25 = IOUSBCommand::GetNoDataTimeout(this);
        if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          kernel_debug(
            0x52D0095u,
            arg1,
            v35 | (v24 << 8) | (v23 << 16) | ((unsigned int)arg3_7b << 24),
            arg3b,
            v25,
            0LL);
      }
      v16 = (*(int (__fastcall **)(__int64, char *, signed __int64))(*(_QWORD *)v7 + 480LL))(v7, &v45, 2LL);
      v45 = 0;
      if ( !(gUSBStackDebugFlags & 2) )
        goto LABEL_29;
      arg3_7c = IOUSBCommand::GetDirection(this);
      v26 = *(_DWORD *)(*(_QWORD *)(arg1 + 168) + 28LL);
      v36 = IOUSBCommand::GetAddress(this);
      arg3c = IOUSBCommand::GetEndpoint(this);
      v27 = IOUSBCommand::GetStatus(this);
      if ( !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
        goto LABEL_29;
      v19 = arg3c | (v36 << 8) | (v26 << 16) | ((unsigned int)arg3_7c << 24);
      v20 = v27;
      v21 = v16;
      v22 = 86835350;
    }
    kernel_debug(v22, v6, v19, v21, v20, 0LL);
LABEL_29:
    if ( v16 )
    {
      v28 = *(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v7 + 456LL);
      v29 = (unsigned __int16)IOUSBCommand::GetAddress(this);
      v30 = (unsigned __int8)IOUSBCommand::GetEndpoint(this);
      v31 = IOUSBCommand::GetDirection(this);
      v28(v7, IOUSBController::DoAbortEP, v29, v30, v31, 0LL);
    }
    return IOUSBCommand::GetStatus(this);
  }
  v11 = (unsigned __int8)IOUSBCommand::GetType(this);
  if ( v11 == 2 )
  {
    result = IOUSBController::BulkTransaction(arg1, this);
  }
  else
  {
    result = 3758097090LL;
    if ( v11 == 3 )
      result = IOUSBController::InterruptTransaction(arg1, this);
  }
  return result;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (0000000000003F58) ----------------------------------------------------
__int64 __fastcall IOUSBController::DoControlTransfer(uintptr_t arg1, OSObject *this, void *a3, void *a4, void *a5, void *a6)
{
  void (__usercall *v6)(void *@<rdi>, void *@<rsi>, char@<al>, unsigned int@<edx>, unsigned int@<ecx>, __int64@<r8>, __int64@<r9>); // rbx@6
  __int64 v7; // r13@6
  unsigned int v8; // eax@8
  unsigned int v9; // ebx@9
  __int64 v10; // rax@11
  __int64 v11; // rax@12
  __int64 v12; // r8@12
  __int64 v13; // r9@12
  __int64 v15; // r15@21
  int v16; // ebx@24
  int (__fastcall *v17)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD); // ST28_8@28
  __int64 v18; // r13@28
  __int64 v19; // rbx@28
  unsigned __int8 v20; // al@28
  int v21; // eax@28
  char v22; // [sp+0h] [bp-D0h]@0
  __int64 v23; // [sp+20h] [bp-B0h]@11
  __int64 v24; // [sp+28h] [bp-A8h]@6
  _BYTE arg2[9]; // [sp+67h] [bp-69h]@11
  uintptr_t *v26; // [sp+70h] [bp-60h]@13
  char v27; // [sp+78h] [bp-58h]@6
  void (__usercall *v28)(void *@<rdi>, void *@<rsi>, char@<al>, unsigned int@<edx>, unsigned int@<ecx>, __int64@<r8>, __int64@<r9>); // [sp+80h] [bp-50h]@6
  __int64 v29; // [sp+88h] [bp-48h]@11
  char v30; // [sp+90h] [bp-40h]@6
  void (__usercall *v31)(void *@<rdi>, void *@<rsi>, char@<al>, unsigned int@<edx>, unsigned int@<ecx>, __int64@<r8>, __int64@<r9>); // [sp+98h] [bp-38h]@6
  __int64 v32; // [sp+A0h] [bp-30h]@6

  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D00B1u, arg1, 0LL, 0LL, 0LL, 0LL);
  if ( !arg1 || !this )
  {
    KernelDebugLogInternal(
      1u,
      0x55534246u,
      (__int64)"IOUSBController::DoControlTransfer -- bad controller or command (%p,%p)",
      arg1,
      (__int64)this,
      (__int64)a6,
      v22);
    return -536870206;
  }
  IOUSBCommand::GetClientCompletion((IOUSBCommand *)&v30, (__int64)this);
  v6 = v31;
  v24 = v32;
  IOUSBCommand::GetDisjointCompletion((IOUSBCommand *)&v27, (__int64)this);
  v7 = (__int64)v28;
  if ( v6 == IOUSBSyncCompletion || v28 == IOUSBSyncCompletion )
  {
    v23 = v29;
    arg2[0] = 1;
    LODWORD(v10) = (*(int (__fastcall **)(uintptr_t, OSObject *))(*(_QWORD *)arg1 + 1672LL))(arg1, this);
    if ( (unsigned __int8)(*(int (__fastcall **)(__int64))(*(_QWORD *)v10 + 304LL))(v10) )
    {
      LODWORD(v11) = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)arg1 + 904LL))(arg1, 0LL);
      KernelDebugLogInternal(
        1u,
        0x55534246u,
        (__int64)"%s::DoControlTransfer sync request on workloop thread.  Use async!",
        v11,
        v12,
        v13,
        v22);
      return -536854454;
    }
    *(_QWORD *)&arg2[1] = arg1;
    v26 = (uintptr_t *)arg2;
    if ( v6 == IOUSBSyncCompletion )
      IOUSBCommand::SetClientCompletion((__int64)this, (__int64)&arg2[1], (__int64)IOUSBSyncCompletion, v24);
    else
      IOUSBCommand::SetDisjointCompletion((__int64)this, (__int64)&arg2[1], v7, v23);
    v9 = IOUSBController::ControlTransaction(arg1, this);
    if ( v9 )
      goto LABEL_17;
    v15 = *(_QWORD *)(arg1 + 144);
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D00B0u, arg1, (uintptr_t)arg2, 0LL, 0LL, 0LL);
    v16 = (*(int (__fastcall **)(__int64, uintptr_t *, signed __int64))(*(_QWORD *)v15 + 480LL))(v15, arg2, 2LL);
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D00B0u, arg1, v16, 0LL, 1uLL, 0LL);
    if ( v16 )
    {
      v17 = *(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v15 + 456LL);
      v18 = (unsigned __int16)IOUSBCommand::GetAddress(this);
      v19 = (unsigned __int8)IOUSBCommand::GetEndpoint(this);
      v20 = IOUSBCommand::GetDirection(this);
      v21 = v17(v15, IOUSBController::DoAbortEP, v18, v19, v20, 0LL);
      if ( gUSBStackDebugFlags & 2 )
      {
        if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          kernel_debug(0x52D00B0u, arg1, v21, 0LL, 2uLL, 0LL);
      }
    }
    arg2[0] = 0;
    v8 = IOUSBCommand::GetStatus(this);
  }
  else
  {
    v8 = IOUSBController::ControlTransaction(arg1, this);
  }
  v9 = v8;
LABEL_17:
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D00B2u, arg1, (signed int)v9, 0LL, 0LL, 0LL);
  return v9;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (000000000000428C) ----------------------------------------------------
int __fastcall IOUSBController::DoDeleteEP(IOUSBController *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  return (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 2232LL))(
           this,
           (unsigned int)(signed __int16)a2,
           (unsigned int)(signed __int16)a3,
           (unsigned int)(signed __int16)a4,
           a5,
           a6);
}

//----- (00000000000042A6) ----------------------------------------------------
int __fastcall IOUSBController::DoClearEPStall(IOUSBController *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  return (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 2240LL))(
           this,
           (unsigned int)(signed __int16)a2,
           (unsigned int)(signed __int16)a3,
           (unsigned int)(signed __int16)a4,
           a5,
           a6);
}

//----- (00000000000042C0) ----------------------------------------------------
int __fastcall IOUSBController::DoCreateEP(IOUSBController *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  unsigned __int64 v6; // rax@1
  int result; // eax@2
  int (__fastcall *v8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD); // r9@4
  unsigned int v9; // eax@4
  __int64 v10; // r8@4
  __int64 v11; // rdx@4
  int v12; // ST00_4@8

  v6 = *((_BYTE *)a4 + 10);
  if ( v6 <= 3 )
  {
    switch ( v6 )
    {
      case 0uLL:
        v8 = *(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 2152LL);
        v9 = *((_WORD *)a4 + 6);
        a2 = (OSObject *)(unsigned __int8)a2;
        v10 = (unsigned __int8)a3;
        v11 = *((_BYTE *)a4 + 8);
        goto LABEL_6;
      case 1uLL:
        v8 = *(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 2208LL);
        v9 = *((_WORD *)a4 + 6);
        v10 = *((_BYTE *)a4 + 9);
        v11 = *((_BYTE *)a4 + 8);
        a2 = (OSObject *)(unsigned __int8)a2;
LABEL_6:
        result = v8(this, a2, v11, v9, v10);
        break;
      case 2uLL:
        result = (*(int (__fastcall **)(IOUSBController *, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this
                                                                                                  + 2176LL))(
                   this,
                   (unsigned __int8)a2,
                   *((_BYTE *)a4 + 8),
                   *((_BYTE *)a4 + 9),
                   (unsigned __int8)a3,
                   *((_BYTE *)a4 + 12));
        break;
      case 3uLL:
        v12 = *((_BYTE *)a4 + 14);
        result = (*(int (__fastcall **)(IOUSBController *, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this
                                                                                                  + 2192LL))(
                   this,
                   (unsigned __int8)a2,
                   *((_BYTE *)a4 + 8),
                   *((_BYTE *)a4 + 9),
                   (unsigned __int8)a3,
                   *((_WORD *)a4 + 6));
        break;
      default:
        goto LABEL_2;
    }
  }
  else
  {
LABEL_2:
    result = -536870206;
  }
  return result;
}

//----- (000000000000439C) ----------------------------------------------------
__int64 __usercall IOUSBController::ProtectedDevZeroLock@<rax>(uintptr_t arg1@<rdi>, OSObject *a2@<rsi>, void *a3@<rdx>, void *a4@<rcx>, void *a5@<r8>, void *a6@<r9>, __int64 a7@<rax>)
{
  __int64 v7; // r14@1
  uintptr_t v8; // r15@2
  __int64 *v9; // rax@6
  int v10; // ebx@7
  signed int v11; // er14@16
  uintptr_t v12; // rdx@18
  uintptr_t v13; // r8@18
  __int64 v15; // [sp+0h] [bp-30h]@1

  v15 = a7;
  v7 = *(_QWORD *)(arg1 + 144);
  if ( !a2 )
  {
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D008Cu, arg1, 0LL, 0LL, 8uLL, 0LL);
    *(_DWORD *)(arg1 + 160) = 0;
    (*(void (__fastcall **)(__int64, uintptr_t, signed __int64, void *, void *, void *))(*(_QWORD *)v7 + 488LL))(
      v7,
      arg1 + 160,
      1LL,
      a4,
      a5,
      a6);
    v11 = 0;
    return (unsigned int)v11;
  }
  v8 = arg1 + 160;
  if ( !*(_DWORD *)(arg1 + 160) )
  {
    if ( !(gUSBStackDebugFlags & 2)
      || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7)
      || (kernel_debug(0x52D008Cu, arg1, 0LL, 0LL, 0LL, 0LL), !*(_DWORD *)(arg1 + 160)) )
    {
LABEL_16:
      *(_DWORD *)v8 = 1;
      v11 = 0;
      if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
        return (unsigned int)v11;
      v11 = 0;
      v12 = 0LL;
      v13 = 9LL;
      goto LABEL_30;
    }
  }
  v9 = &v15;
  while ( 2 )
  {
    clock_interval_to_deadline(61LL, 1000000000LL, v9, a4, a5, a6);
    v10 = (*(int (__fastcall **)(__int64, uintptr_t, __int64, signed __int64))(*(_QWORD *)v7 + 496LL))(
            v7,
            arg1 + 160,
            v15,
            2LL);
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D008Cu, arg1, 0LL, 0LL, 1uLL, 0LL);
    if ( v10 < 0 )
    {
      if ( v10 != -536870174 )
        break;
      v11 = -536870174;
      if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
        return (unsigned int)v11;
      v12 = *(_DWORD *)(arg1 + 160);
      v13 = 5LL;
LABEL_30:
      kernel_debug(0x52D008Cu, arg1, v12, 0LL, v13, 0LL);
      return (unsigned int)v11;
    }
    switch ( v10 )
    {
      case 0:
        if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          kernel_debug(0x52D008Cu, arg1, *(_DWORD *)(arg1 + 160), 0LL, 2uLL, 0LL);
        v9 = &v15;
        if ( !*(_DWORD *)v8 )
          goto LABEL_16;
        continue;
      case 1:
        v11 = -536870186;
        if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
          return (unsigned int)v11;
        v12 = *(_DWORD *)(arg1 + 160);
        v13 = 7LL;
        goto LABEL_30;
      case 2:
        v11 = -536870174;
        if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
          return (unsigned int)v11;
        v12 = *(_DWORD *)(arg1 + 160);
        v13 = 3LL;
        goto LABEL_30;
      case 3:
        v11 = -536870174;
        if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
          return (unsigned int)v11;
        v12 = *(_DWORD *)(arg1 + 160);
        v13 = 4LL;
        goto LABEL_30;
      default:
        goto LABEL_27;
    }
  }
LABEL_27:
  v11 = -536870174;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
  {
    v12 = *(_DWORD *)(arg1 + 160);
    v13 = 6LL;
    goto LABEL_30;
  }
  return (unsigned int)v11;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 7E178: using guessed type int __fastcall clock_interval_to_deadline(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000046D0) ----------------------------------------------------
__int64 __fastcall IOUSBController::AcquireDeviceZero(uintptr_t arg1)
{
  __int64 v1; // rbx@1
  int v2; // ebx@4

  v1 = *(_QWORD *)(arg1 + 144);
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D008Cu, arg1, *(_DWORD *)(arg1 + 160), 0LL, 0xBuLL, 0LL);
  v2 = (*(int (__fastcall **)(__int64, __int64 (__usercall *)@<rax>(uintptr_t@<rdi>, OSObject *@<rsi>, void *@<rdx>, void *@<rcx>, void *@<r8>, void *@<r9>, __int64@<rax>), signed __int64, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v1 + 456LL))(
         v1,
         IOUSBController::ProtectedDevZeroLock,
         1LL,
         0LL,
         0LL,
         0LL);
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D008Cu, arg1, *(_DWORD *)(arg1 + 160), v2, 0xCuLL, 0LL);
  return (unsigned int)v2;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (000000000000477A) ----------------------------------------------------
void __fastcall IOUSBController::ReleaseDeviceZero(uintptr_t arg1)
{
  __int64 v1; // rbx@1
  int v2; // eax@4
  int v3; // eax@8

  v1 = *(_QWORD *)(arg1 + 144);
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D008Cu, arg1, *(_DWORD *)(arg1 + 160), 0LL, 0xDuLL, 0LL);
  v2 = (*(int (__fastcall **)(__int64, int (__fastcall *)(IOUSBController *, OSObject *, void *, void *, void *, void *), _QWORD, _QWORD, signed __int64, _QWORD))(*(_QWORD *)v1 + 456LL))(
         v1,
         IOUSBController::DoDeleteEP,
         0LL,
         0LL,
         3LL,
         0LL);
  if ( v2 && gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D008Cu, arg1, v2, 0LL, 0xEuLL, 0LL);
  v3 = (*(int (__fastcall **)(__int64, __int64 (__usercall *)@<rax>(uintptr_t@<rdi>, OSObject *@<rsi>, void *@<rdx>, void *@<rcx>, void *@<r8>, void *@<r9>, __int64@<rax>), _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v1 + 456LL))(
         v1,
         IOUSBController::ProtectedDevZeroLock,
         0LL,
         0LL,
         0LL,
         0LL);
  if ( gUSBStackDebugFlags & 2 )
  {
    if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D008Cu, arg1, *(_DWORD *)(arg1 + 160), v3, 0xFuLL, 0LL);
  }
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (0000000000004878) ----------------------------------------------------
void __fastcall IOUSBController::WaitForReleaseDeviceZero(uintptr_t arg1)
{
  __int64 v1; // rbx@1
  int v2; // eax@4

  v1 = *(_QWORD *)(arg1 + 144);
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D008Cu, arg1, *(_DWORD *)(arg1 + 160), 0LL, 0x10uLL, 0LL);
  v2 = (*(int (__fastcall **)(__int64, __int64 (__usercall *)@<rax>(uintptr_t@<rdi>, OSObject *@<rsi>, void *@<rdx>, void *@<rcx>, void *@<r8>, void *@<r9>, __int64@<rax>), signed __int64, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v1 + 456LL))(
         v1,
         IOUSBController::ProtectedDevZeroLock,
         1LL,
         0LL,
         0LL,
         0LL);
  if ( !v2 )
  {
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D008Cu, arg1, *(_DWORD *)(arg1 + 160), 0LL, 0x11uLL, 0LL);
    v2 = (*(int (__fastcall **)(__int64, __int64 (__usercall *)@<rax>(uintptr_t@<rdi>, OSObject *@<rsi>, void *@<rdx>, void *@<rcx>, void *@<r8>, void *@<r9>, __int64@<rax>), _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v1 + 456LL))(
           v1,
           IOUSBController::ProtectedDevZeroLock,
           0LL,
           0LL,
           0LL,
           0LL);
  }
  if ( gUSBStackDebugFlags & 2 )
  {
    if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D008Cu, arg1, *(_DWORD *)(arg1 + 160), v2, 0x12uLL, 0LL);
  }
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (000000000000497A) ----------------------------------------------------
int __fastcall IOUSBController::ConfigureDeviceZero(IOUSBController *this, __int16 a2, __int64 a3)
{
  char v4; // [sp+0h] [bp-10h]@1
  char v5; // [sp+8h] [bp-8h]@1
  char v6; // [sp+Ah] [bp-6h]@1
  __int16 v7; // [sp+Ch] [bp-4h]@1

  v5 = 0;
  v6 = 0;
  v7 = a2;
  return (*(int (__fastcall **)(IOUSBController *, _QWORD, __int64, char *))(*(_QWORD *)this + 2352LL))(
           this,
           0LL,
           a3,
           &v4);
}

//----- (00000000000049A4) ----------------------------------------------------
int __fastcall IOUSBController::GetDeviceZeroDescriptor(__int64 a1, __int64 a2, __int16 a3)
{
  int result; // eax@1
  __int64 v4; // [sp+0h] [bp-30h]@1
  void (__usercall *v5)(void *@<rdi>, void *@<rsi>, char@<al>, unsigned int@<edx>, unsigned int@<ecx>, __int64@<r8>, __int64@<r9>); // [sp+8h] [bp-28h]@1
  __int64 v6; // [sp+10h] [bp-20h]@1
  char v7; // [sp+18h] [bp-18h]@2
  char v8; // [sp+19h] [bp-17h]@2
  __int16 v9; // [sp+1Ah] [bp-16h]@2
  __int16 v10; // [sp+1Ch] [bp-14h]@2
  __int16 v11; // [sp+1Eh] [bp-12h]@2
  __int64 v12; // [sp+20h] [bp-10h]@2

  v4 = 0LL;
  v5 = IOUSBSyncCompletion;
  v6 = 0LL;
  result = -536870206;
  if ( a2 )
  {
    v7 = -128;
    v8 = 6;
    v9 = 256;
    v10 = 0;
    v11 = a3;
    v12 = a2;
    result = (*(int (__fastcall **)(__int64, char *, __int64 *, _QWORD, _QWORD))(*(_QWORD *)a1 + 2416LL))(
               a1,
               &v7,
               &v4,
               0LL,
               0LL);
  }
  return result;
}

//----- (0000000000004A0A) ----------------------------------------------------
int __fastcall IOUSBController::SetDeviceZeroAddress(IOUSBController *this, __int16 a2)
{
  __int64 v3; // [sp+0h] [bp-30h]@1
  void (__usercall *v4)(void *@<rdi>, void *@<rsi>, char@<al>, unsigned int@<edx>, unsigned int@<ecx>, __int64@<r8>, __int64@<r9>); // [sp+8h] [bp-28h]@1
  __int64 v5; // [sp+10h] [bp-20h]@1
  char v6; // [sp+18h] [bp-18h]@1
  char v7; // [sp+19h] [bp-17h]@1
  __int16 v8; // [sp+1Ah] [bp-16h]@1
  __int16 v9; // [sp+1Ch] [bp-14h]@1
  __int16 v10; // [sp+1Eh] [bp-12h]@1
  __int64 v11; // [sp+20h] [bp-10h]@1

  v3 = 0LL;
  v4 = IOUSBSyncCompletion;
  v5 = 0LL;
  v6 = 0;
  v7 = 5;
  v8 = a2;
  v9 = 0;
  v10 = 0;
  v11 = 0LL;
  return (*(int (__fastcall **)(IOUSBController *, char *, __int64 *, _QWORD, _QWORD))(*(_QWORD *)this + 2416LL))(
           this,
           &v6,
           &v3,
           0LL,
           0LL);
}

//----- (0000000000004A6A) ----------------------------------------------------
__int64 __fastcall IOUSBController::MakeDevice(uintptr_t arg1, unsigned __int16 *a2, const OSMetaClass *a3)
{
  uintptr_t *v3; // r14@1
  uintptr_t v4; // r15@1
  unsigned __int64 v5; // rsi@1
  uintptr_t v6; // r12@1
  __int64 v7; // rbx@4
  __int64 result; // rax@4
  __int16 v9; // ax@5
  char *v10; // rsi@9
  __int16 v11; // [sp+Eh] [bp-52h]@1
  __int64 v12; // [sp+10h] [bp-50h]@9
  void (__usercall *v13)(void *@<rdi>, void *@<rsi>, char@<al>, unsigned int@<edx>, unsigned int@<ecx>, __int64@<r8>, __int64@<r9>); // [sp+18h] [bp-48h]@9
  __int64 v14; // [sp+20h] [bp-40h]@9
  char v15; // [sp+28h] [bp-38h]@9
  char v16; // [sp+29h] [bp-37h]@9
  __int16 v17; // [sp+2Ah] [bp-36h]@9
  __int16 v18; // [sp+2Ch] [bp-34h]@9
  __int16 v19; // [sp+2Eh] [bp-32h]@9
  __int64 v20; // [sp+30h] [bp-30h]@9

  v3 = (uintptr_t *)a2;
  v4 = arg1;
  v11 = 0;
  v5 = IOUSBControllerV3::metaClass;
  v6 = OSMetaClassBase::safeMetaCast((OSMetaClassBase *)arg1, (const OSMetaClassBase *)IOUSBControllerV3::metaClass, a3);
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
  {
    arg1 = 86835213LL;
    v5 = v4;
    kernel_debug(0x52D000Du, v4, v6, 0LL, 0LL, 0LL);
  }
  v7 = IOUSBDevice::NewDevice((IOUSBDevice *)arg1, v5);
  result = 0LL;
  if ( v7 )
  {
    v9 = IOUSBController::GetNewAddress(v4);
    *(_WORD *)v3 = v9;
    if ( v9 )
    {
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        kernel_debug(0x52D000Cu, v4, (unsigned __int16)v9, 0LL, 7uLL, 0LL);
        v9 = *(_WORD *)v3;
      }
      v12 = 0LL;
      v13 = IOUSBSyncCompletion;
      v14 = 0LL;
      v15 = 0;
      v16 = 5;
      v17 = v9;
      v18 = 0;
      v19 = 0;
      v20 = 0LL;
      v10 = &v15;
      if ( (*(int (__fastcall **)(uintptr_t, char *, __int64 *, _QWORD, _QWORD))(*(_QWORD *)v4 + 2416LL))(
             v4,
             &v15,
             &v12,
             0LL,
             0LL) )
      {
        if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        {
          v10 = (char *)v4;
          kernel_debug(0x52D000Cu, v4, *(_WORD *)v3, 0LL, 0LL, 0LL);
        }
        *(_WORD *)v3 = 0;
        (*(void (__fastcall **)(__int64, char *))(*(_QWORD *)v7 + 40LL))(v7, v10);
        v7 = 0LL;
      }
      else if ( v6
             && !(*(int (__fastcall **)(uintptr_t, _QWORD, __int16 *))(*(_QWORD *)v6 + 3304LL))(v6, *(_WORD *)v3, &v11) )
      {
        *(_WORD *)v3 = v11;
      }
    }
    else
    {
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        v5 = v4;
        kernel_debug(0x52D000Cu, v4, 0LL, 0LL, 1uLL, 0LL);
      }
      (*(void (__fastcall **)(__int64, unsigned __int64))(*(_QWORD *)v7 + 40LL))(v7, v5);
      *(_WORD *)v3 = -2;
      v7 = 0LL;
    }
    if ( gUSBStackDebugFlags & 2 )
    {
      if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D000Eu, v4, v7, *(_WORD *)v3, 0LL, 0LL);
    }
    result = v7;
  }
  return result;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 44350: using guessed type _QWORD IOUSBControllerV3::metaClass;
// 49460: using guessed type int gUSBStackDebugFlags;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000004C72) ----------------------------------------------------
__int64 __fastcall IOUSBController::MakeHubDevice(uintptr_t arg1, unsigned __int16 *a2)
{
  uintptr_t *v2; // r14@1
  uintptr_t v3; // r15@1
  __int64 v4; // rbx@4
  __int64 result; // rax@4
  __int16 v6; // ax@5
  char *v7; // rsi@6
  int v8; // eax@6
  const OSMetaClass *v9; // rdx@6
  __int64 v10; // rax@15
  __int16 v11; // ax@16
  __int64 v12; // [sp+8h] [bp-48h]@6
  void (__usercall *v13)(void *@<rdi>, void *@<rsi>, char@<al>, unsigned int@<edx>, unsigned int@<ecx>, __int64@<r8>, __int64@<r9>); // [sp+10h] [bp-40h]@6
  __int64 v14; // [sp+18h] [bp-38h]@6
  char v15; // [sp+20h] [bp-30h]@6
  char v16; // [sp+21h] [bp-2Fh]@6
  __int16 v17; // [sp+22h] [bp-2Eh]@6
  __int16 v18; // [sp+24h] [bp-2Ch]@6
  __int16 v19; // [sp+26h] [bp-2Ah]@6
  __int64 v20; // [sp+28h] [bp-28h]@6

  v2 = (uintptr_t *)a2;
  v3 = arg1;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
  {
    arg1 = 86835217LL;
    a2 = (unsigned __int16 *)v3;
    kernel_debug(0x52D0011u, v3, 0LL, 0LL, 0LL, 0LL);
  }
  v4 = IOUSBHubDevice::NewHubDevice((IOUSBHubDevice *)arg1, (unsigned __int64)a2);
  result = 0LL;
  if ( v4 )
  {
    v6 = IOUSBController::GetNewAddress(v3);
    *(_WORD *)v2 = v6;
    if ( v6 )
    {
      v12 = 0LL;
      v13 = IOUSBSyncCompletion;
      v14 = 0LL;
      v15 = 0;
      v16 = 5;
      v17 = v6;
      v18 = 0;
      v19 = 0;
      v20 = 0LL;
      v7 = &v15;
      v8 = (*(int (__fastcall **)(uintptr_t, char *, __int64 *, _QWORD, _QWORD))(*(_QWORD *)v3 + 2416LL))(
             v3,
             &v15,
             &v12,
             0LL,
             0LL);
      if ( v8 )
      {
        if ( gUSBStackDebugFlags & 2 )
        {
          if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          {
            v7 = (char *)v3;
            kernel_debug(0x52D0010u, v3, v8, v4, *(_WORD *)v2, 0LL);
          }
        }
        *(_WORD *)v2 = 0;
        (*(void (__fastcall **)(__int64, char *))(*(_QWORD *)v4 + 40LL))(v4, v7);
        result = 0LL;
      }
      else
      {
        v10 = OSMetaClassBase::safeMetaCast(
                (OSMetaClassBase *)v3,
                (const OSMetaClassBase *)IOUSBControllerV3::metaClass,
                v9);
        if ( v10 )
        {
          v11 = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v10 + 3264LL))(v10, *(_WORD *)v2);
          if ( v11 )
            *(_WORD *)v2 = v11;
        }
        if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          kernel_debug(0x52D0012u, v3, v4, 0LL, 0LL, 0LL);
        result = v4;
      }
    }
    else
    {
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        a2 = (unsigned __int16 *)v3;
        kernel_debug(0x52D0010u, v3, 0LL, 0LL, 1uLL, 0LL);
      }
      (*(void (__fastcall **)(__int64, unsigned __int16 *))(*(_QWORD *)v4 + 40LL))(v4, a2);
      *(_WORD *)v2 = -2;
      result = 0LL;
    }
  }
  return result;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 44350: using guessed type _QWORD IOUSBControllerV3::metaClass;
// 49460: using guessed type int gUSBStackDebugFlags;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000004E34) ----------------------------------------------------
int __usercall IOUSBController::PolledRead@<eax>(IOUSBController *this@<rdi>, char a2@<dl>, IOMemoryDescriptor *a3@<rcx>, __int16 a4@<si>, char a5@<r8b>, __int64 a6, __int64 a7, __int64 a8)
{
  char v8; // bl@1
  int v9; // er12@1
  __int64 v10; // rax@1
  const OSMetaClass *v11; // rdx@1
  __int64 v12; // r15@1
  __int64 v13; // rax@2
  int result; // eax@2
  int v15; // ebx@4
  char v16; // [sp+1Ch] [bp-64h]@1
  IOMemoryDescriptor *v17; // [sp+20h] [bp-60h]@1

  v8 = a5;
  v17 = a3;
  v16 = a2;
  v9 = 0;
  LODWORD(v10) = (*(int (__fastcall **)(_QWORD, _QWORD))(***((_QWORD ***)this + 21) + 296LL))(
                   **((_QWORD **)this + 21),
                   0LL);
  v12 = v10;
  if ( v10
    || (IOUSBController::IncreaseCommandPool(this, 0LL, v11),
        LODWORD(v13) = (*(int (__fastcall **)(_QWORD, _QWORD))(***((_QWORD ***)this + 21) + 296LL))(
                         **((_QWORD **)this + 21),
                         0LL),
        v12 = v13,
        result = -536870210,
        v12) )
  {
    IOUSBCommand::SetUseTimeStamp((IOUSBCommand *)v12, 1);
    IOUSBCommand::SetSelector(v12, 1);
    IOUSBCommand::SetRequest(v12, 0LL);
    IOUSBCommand::SetAddress((IOUSBCommand *)v12, a4);
    IOUSBCommand::SetEndpoint((IOUSBCommand *)v12, v16);
    *(_DWORD *)(*(_QWORD *)(v12 + 216) + 72LL) = 0;
    IOUSBCommand::SetDirection((IOUSBCommand *)v12, 1);
    IOUSBCommand::SetType((IOUSBCommand *)v12, 3);
    IOUSBCommand::SetBuffer((IOUSBCommand *)v12, v17);
    IOUSBCommand::SetClientCompletion(v12, a6, a7, a8);
    IOUSBCommand::SetBufferRounding((IOUSBCommand *)v12, v8);
    do
    {
      v15 = 0;
      IOUSBCommand::SetUIMScratch((IOUSBCommand *)v12, v9++, 0);
    }
    while ( v9 != 10 );
    do
      IOUSBCommand::SetUIMScratch64((IOUSBCommand *)v12, v15++, 0LL);
    while ( v15 != 5 );
    IOUSBCommand::SetUSLCompletion(v12, (__int64)this, (__int64)IOUSBController::InterruptPacketHandler, v12);
    result = (*(int (__fastcall **)(IOUSBController *, __int64))(*(_QWORD *)this + 2520LL))(this, v12);
  }
  return result;
}

//----- (0000000000004FE2) ----------------------------------------------------
__int64 __fastcall IOUSBController::IncreaseCommandPool(IOUSBController *this, __int64 a2, const OSMetaClass *a3)
{
  IOUSBController *v3; // r14@1
  unsigned __int64 v4; // rsi@1
  __int64 v5; // r15@1
  signed int v6; // ebx@1
  IOCommand *v7; // r12@2
  __int64 v8; // rax@4
  __int64 result; // rax@7

  v3 = this;
  v4 = IOUSBControllerV2::metaClass;
  v5 = OSMetaClassBase::safeMetaCast(this, (const OSMetaClassBase *)IOUSBControllerV2::metaClass, a3);
  v6 = 50;
  do
  {
    v7 = IOUSBCommand::NewCommand(this, v4);
    if ( v7 )
    {
      if ( v5 )
      {
        LODWORD(v8) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v5 + 2848LL))(v5);
        *(_QWORD *)(*((_QWORD *)v7 + 27) + 48LL) = v8;
      }
      this = (IOUSBController *)**((_QWORD **)v3 + 21);
      v4 = (unsigned __int64)v7;
      (*(void (__fastcall **)(IOUSBController *, IOCommand *))(*(_QWORD *)this + 304LL))(this, v7);
    }
    --v6;
  }
  while ( v6 );
  result = *((_QWORD *)v3 + 21);
  *(_DWORD *)(result + 32) += 50;
  return result;
}
// 419C0: using guessed type _QWORD IOUSBControllerV2::metaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000005060) ----------------------------------------------------
signed __int64 __fastcall IOUSBController::message(IOUSBController *this, int a2, IOService *a3, void *a4)
{
  signed __int64 result; // rax@1

  result = 0LL;
  if ( a2 != -536870896 && a2 != -536870400 && a2 != -536870384 )
    result = 3758097095LL;
  return result;
}

//----- (0000000000005086) ----------------------------------------------------
void __fastcall IOUSBController::didTerminate(IOUSBController *this, IOService *a2, __int64 a3, bool *a4)
{
  JUMPOUT(__CS__, `vtable for'IOUSBBus[131]);
}
// 3B270: using guessed type __int64 `vtable for'IOUSBBus[2];

//----- (0000000000005098) ----------------------------------------------------
int __fastcall IOUSBController::stop(IOUSBController *this, IOService *a2)
{
  IOUSBController *v2; // r14@1
  __int64 v3; // rax@1
  __int64 v4; // rdi@2
  __int64 v5; // rdi@3
  __int64 v6; // rax@6
  __int64 v7; // rcx@6
  __int64 v8; // rcx@7
  unsigned int v9; // ebx@10
  __int64 v10; // rax@11
  __int64 v11; // r15@11
  __int64 v12; // rdi@12
  unsigned int v13; // ebx@17
  __int64 v14; // rax@18
  __int64 v15; // r15@18
  __int64 v16; // rdi@19
  __int64 v17; // rdi@25
  __int64 v18; // rdi@27

  v2 = this;
  v3 = *((_QWORD *)this + 21);
  if ( v3 )
  {
    v4 = *(_QWORD *)(v3 + 16);
    if ( v4 )
    {
      *(_BYTE *)(v3 + 25) = 0;
      (*(void (__fastcall **)(__int64, IOService *))(*(_QWORD *)v4 + 536LL))(v4, a2);
      v5 = *((_QWORD *)v2 + 17);
      if ( v5 )
      {
        a2 = *(IOService **)(*((_QWORD *)v2 + 21) + 16LL);
        (*(void (__fastcall **)(__int64, IOService *))(*(_QWORD *)v5 + 328LL))(v5, a2);
      }
      (*(void (__cdecl **)(_QWORD))(**(_QWORD **)(*((_QWORD *)v2 + 21) + 16LL) + 40LL))(*(_QWORD *)(*((_QWORD *)v2 + 21)
                                                                                                  + 16LL));
      *(_QWORD *)(*((_QWORD *)v2 + 21) + 16LL) = 0LL;
    }
  }
  (*(void (__fastcall **)(IOUSBController *, IOService *))(*(_QWORD *)v2 + 2144LL))(v2, a2);
  v6 = *((_QWORD *)v2 + 21);
  v7 = *(_DWORD *)(v6 + 28);
  if ( *(_BYTE *)(v6 + 40) == 3 )
  {
    v8 = 2 * (unsigned int)(v7 & 0x7F);
    *((_BYTE *)&IOUSBController::gUsedBusIDs + (unsigned int)(v8 + 1)) = 0;
    *((_BYTE *)&IOUSBController::gUsedBusIDs + v8) = 0;
  }
  else
  {
    *((_BYTE *)&IOUSBController::gUsedBusIDs + v7) = 0;
  }
  if ( *(_DWORD *)(v6 + 32) )
  {
    v9 = 0;
    do
    {
      LODWORD(v10) = (*(int (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)v6 + 296LL))(*(_QWORD *)v6, 0LL);
      v11 = v10;
      if ( v10 )
      {
        v12 = *(_QWORD *)(*(_QWORD *)(v10 + 216) + 48LL);
        if ( v12 )
        {
          (*(void (__cdecl **)(__int64))(*(_QWORD *)v12 + 40LL))(v12);
          *(_QWORD *)(*(_QWORD *)(v11 + 216) + 48LL) = 0LL;
        }
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v11 + 40LL))(v11);
      }
      ++v9;
      v6 = *((_QWORD *)v2 + 21);
    }
    while ( v9 < *(_DWORD *)(v6 + 32) );
  }
  if ( *(_DWORD *)(v6 + 36) )
  {
    v13 = 0;
    do
    {
      LODWORD(v14) = (*(int (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(v6 + 8) + 296LL))(*(_QWORD *)(v6 + 8), 0LL);
      v15 = v14;
      if ( v14 )
      {
        v16 = *(_QWORD *)(*(_QWORD *)(v14 + 104) + 24LL);
        if ( v16 )
        {
          (*(void (__cdecl **)(__int64))(*(_QWORD *)v16 + 40LL))(v16);
          *(_QWORD *)(*(_QWORD *)(v15 + 104) + 24LL) = 0LL;
        }
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v15 + 40LL))(v15);
      }
      ++v13;
      v6 = *((_QWORD *)v2 + 21);
    }
    while ( v13 < *(_DWORD *)(v6 + 36) );
  }
  if ( *(_QWORD *)v6 )
  {
    (*(void (__cdecl **)(_QWORD))(**(_QWORD **)v6 + 40LL))(*(_QWORD *)v6);
    v6 = *((_QWORD *)v2 + 21);
    *(_QWORD *)v6 = 0LL;
  }
  v17 = *(_QWORD *)(v6 + 8);
  if ( v17 )
  {
    (*(void (__cdecl **)(__int64))(*(_QWORD *)v17 + 40LL))(v17);
    v6 = *((_QWORD *)v2 + 21);
    *(_QWORD *)(v6 + 8) = 0LL;
  }
  v18 = *((_QWORD *)v2 + 17);
  if ( v18 && *((_QWORD *)v2 + 18) )
    LODWORD(v6) = (*(int (**)(void))(*(_QWORD *)v18 + 328LL))();
  return v6;
}
// 49480: using guessed type _QWORD IOUSBController::gUsedBusIDs;

//----- (000000000000526E) ----------------------------------------------------
char __fastcall IOUSBController::finalize(IOUSBController *this)
{
  IOUSBController *v1; // r15@1
  char v2; // r14@1
  __int64 v3; // rbx@1
  void (__fastcall *v4)(_QWORD, _QWORD, _QWORD); // r12@2
  __int64 v5; // rax@2
  __int64 v6; // rax@3
  __int64 v7; // rbx@3
  void (__fastcall *v8)(_QWORD, _QWORD, _QWORD); // r12@4
  __int64 v9; // rax@4
  __int64 v10; // rdi@5

  v1 = this;
  v2 = ((int (*)(void))`vtable for'IOUSBBus[195])();
  v3 = *((_QWORD *)this + 19);
  if ( v3 )
  {
    v4 = *(void (__fastcall **)(_QWORD, _QWORD, _QWORD))(*(_QWORD *)v3 + 864LL);
    v5 = IORegistryEntry::getRegistryRoot(this);
    v4(v3, v5, IOUSBController::gIOUSBPlane);
    this = (IOUSBController *)*((_QWORD *)this + 19);
    (*(void (**)(void))(*(_QWORD *)this + 40LL))();
    *((_QWORD *)v1 + 19) = 0LL;
  }
  v6 = *((_QWORD *)v1 + 21);
  v7 = *(_QWORD *)(v6 + 216);
  if ( v7 )
  {
    v8 = *(void (__fastcall **)(_QWORD, _QWORD, _QWORD))(*(_QWORD *)v7 + 864LL);
    v9 = IORegistryEntry::getRegistryRoot(this);
    v8(v7, v9, IOUSBController::gIOUSBPlane);
    (*(void (**)(void))(**(_QWORD **)(*((_QWORD *)v1 + 21) + 216LL) + 40LL))();
    v6 = *((_QWORD *)v1 + 21);
    *(_QWORD *)(v6 + 216) = 0LL;
  }
  v10 = *(_QWORD *)(v6 + 192);
  if ( v10 && (unsigned __int8)(*(int (__fastcall **)(__int64, IOUSBController *))(*(_QWORD *)v10 + 1504LL))(v10, v1) )
    (*(void (__fastcall **)(_QWORD, IOUSBController *, _QWORD))(**(_QWORD **)(*((_QWORD *)v1 + 21) + 192LL) + 1496LL))(
      *(_QWORD *)(*((_QWORD *)v1 + 21) + 192LL),
      v1,
      0LL);
  return v2;
}
// 3B270: using guessed type __int64 `vtable for'IOUSBBus[2];
// 49470: using guessed type _QWORD IOUSBController::gIOUSBPlane;

//----- (000000000000536C) ----------------------------------------------------
__int64 __fastcall IOUSBController::IncreaseIsocCommandPool(IOUSBController *this, __int64 a2, const OSMetaClass *a3)
{
  IOUSBController *v3; // r14@1
  unsigned __int64 v4; // rsi@1
  __int64 v5; // r15@1
  signed int v6; // ebx@1
  IOCommand *v7; // r12@2
  __int64 v8; // rax@4
  __int64 result; // rax@7

  v3 = this;
  v4 = IOUSBControllerV2::metaClass;
  v5 = OSMetaClassBase::safeMetaCast(this, (const OSMetaClassBase *)IOUSBControllerV2::metaClass, a3);
  v6 = 50;
  do
  {
    v7 = IOUSBIsocCommand::NewCommand(this, v4);
    if ( v7 )
    {
      if ( v5 )
      {
        LODWORD(v8) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v5 + 2848LL))(v5);
        *(_QWORD *)(*((_QWORD *)v7 + 13) + 24LL) = v8;
      }
      this = *(IOUSBController **)(*((_QWORD *)v3 + 21) + 8LL);
      v4 = (unsigned __int64)v7;
      (*(void (__fastcall **)(IOUSBController *, IOCommand *))(*(_QWORD *)this + 304LL))(this, v7);
    }
    --v6;
  }
  while ( v6 );
  result = *((_QWORD *)v3 + 21);
  *(_DWORD *)(result + 36) += 50;
  return result;
}
// 419C0: using guessed type _QWORD IOUSBControllerV2::metaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (00000000000053E8) ----------------------------------------------------
int __fastcall IOUSBController::ReturnUSBCommand(IOUSBController *this, IOUSBCommand *a2)
{
  return (*(int (__fastcall **)(_QWORD, IOUSBCommand *))(***((_QWORD ***)this + 21) + 304LL))(
           **((_QWORD **)this + 21),
           a2);
}

//----- (0000000000005404) ----------------------------------------------------
void __fastcall IOUSBController::TerminatePCCard(IOUSBController *this, OSObject *a2)
{
  ;
}

//----- (000000000000540A) ----------------------------------------------------
__int64 __fastcall IOUSBController::ValueOfHexDigit(IOUSBController *this, int a2)
{
  __int64 result; // rax@2

  if ( (unsigned __int8)(a2 - 48) > 9u )
  {
    if ( (unsigned __int8)(a2 - 65) > 5u )
      result = (unsigned int)(a2 - 87);
    else
      result = (unsigned int)(a2 - 55);
  }
  else
  {
    result = (unsigned int)(a2 - 48);
  }
  return result;
}

//----- (000000000000543A) ----------------------------------------------------
char __fastcall IOUSBController::ParsePCILocation(IOUSBController *this, const char *a2, int *a3, int *a4)
{
  signed int v4; // er9@1
  signed __int64 v5; // r8@1
  const char v6; // r11@2
  char result; // al@3
  unsigned __int64 v8; // rdi@3
  int v9; // er10@5
  int v10; // edi@8
  int v11; // er10@12
  unsigned __int64 v12; // rdi@13
  int v13; // er10@15

  *a4 = 0;
  *a3 = 0;
  v4 = 0;
  v5 = 270582939711LL;
  do
  {
    v6 = *a2;
    if ( (unsigned __int8)(*a2 - 48) >= 0xAu )
    {
      result = v6 - 65;
      v8 = (unsigned __int8)(v6 - 65);
      if ( (unsigned int)v8 > 0x25 || !_bittest((const unsigned __int64 *)&v5, v8) )
        break;
    }
    a2 += 2;
    v9 = 0;
    while ( 1 )
    {
      if ( (unsigned __int8)(v6 - 48) > 9u )
        v10 = (unsigned __int8)(v6 - 65) > 5u ? v6 - 87 : v6 - 55;
      else
        v10 = v6 - 48;
      v11 = v9 - v10;
      v6 = *(a2 - 1);
      if ( (unsigned __int8)(*(a2 - 1) - 48) > 9u )
      {
        result = v6 - 65;
        v12 = (unsigned __int8)(v6 - 65);
        if ( (unsigned int)v12 > 0x25 || !_bittest((const unsigned __int64 *)&v5, v12) )
          break;
      }
      v9 = 16 * v11;
      ++a2;
    }
    v13 = -v11;
    if ( v4 )
      *a4 = v13;
    else
      *a3 = v13;
    if ( !*(a2 - 1) )
      break;
    ++v4;
  }
  while ( v4 < 2 );
  return result;
}

//----- (000000000000550A) ----------------------------------------------------
void __fastcall IOUSBController::UIMCheckForTimeouts(IOUSBController *this)
{
  ;
}

//----- (0000000000005510) ----------------------------------------------------
int __fastcall IOUSBController::UIMCreateControlTransfer(IOUSBController *this, unsigned int a2, unsigned int a3, IOUSBCommand *a4, void *a5, __int64 a6, unsigned int a7)
{
  unsigned __int8 v7; // ST24_1@1
  void *v8; // ST28_8@1
  __int64 v9; // r12@1
  unsigned int v10; // er13@1
  int (__fastcall *v11)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD); // r15@1
  char v13; // [sp+0h] [bp-70h]@0
  __int64 v14; // [sp+30h] [bp-40h]@1

  v7 = a6;
  v8 = a5;
  v9 = (__int64)a4;
  v10 = a3;
  KernelDebugLogInternal(
    1u,
    0x55534246u,
    (__int64)"IOUSBController::UIMCreateControlTransfer, got into wrong one",
    (__int64)a4,
    (__int64)a5,
    a6,
    v13);
  v11 = *(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 2160LL);
  IOUSBCommand::GetUSLCompletion((IOUSBCommand *)&v14, v9);
  return v11(this, a2, v10, v8, v7, a7);
}

//----- (00000000000055AE) ----------------------------------------------------
int __fastcall IOUSBController::UIMCreateControlTransfer(IOUSBController *this, unsigned int a2, unsigned int a3, IOUSBCommand *a4, IOMemoryDescriptor *a5, __int64 a6, unsigned int a7)
{
  unsigned __int8 v7; // ST24_1@1
  IOMemoryDescriptor *v8; // ST28_8@1
  __int64 v9; // r12@1
  unsigned int v10; // er13@1
  int (__fastcall *v11)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD); // r15@1
  char v13; // [sp+0h] [bp-70h]@0
  __int64 v14; // [sp+30h] [bp-40h]@1

  v7 = a6;
  v8 = a5;
  v9 = (__int64)a4;
  v10 = a3;
  KernelDebugLogInternal(
    1u,
    0x55534246u,
    (__int64)"IOUSBController::UIMCreateControlTransfer, got into wrong one",
    (__int64)a4,
    (__int64)a5,
    a6,
    v13);
  v11 = *(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 2168LL);
  IOUSBCommand::GetUSLCompletion((IOUSBCommand *)&v14, v9);
  return v11(this, a2, v10, v8, v7, a7);
}

//----- (000000000000564C) ----------------------------------------------------
int __fastcall IOUSBController::UIMCreateBulkTransfer(IOUSBController *this, IOUSBCommand *a2)
{
  int (__fastcall *v2)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD); // ST28_8@1
  __int16 v3; // ST26_2@1
  unsigned __int8 v4; // ST25_1@1
  __int64 v5; // r13@1
  char v6; // r14@1
  unsigned int v7; // er12@1
  char v8; // al@1
  __int64 v10; // [sp+30h] [bp-40h]@1

  v2 = *(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 2184LL);
  v3 = IOUSBCommand::GetAddress(a2);
  v4 = IOUSBCommand::GetEndpoint(a2);
  IOUSBCommand::GetUSLCompletion((IOUSBCommand *)&v10, (__int64)a2);
  v5 = IOUSBCommand::GetBuffer(a2);
  v6 = IOUSBCommand::GetBufferRounding(a2);
  v7 = IOUSBCommand::GetReqCount(a2);
  v8 = IOUSBCommand::GetDirection(a2);
  return v2(this, (unsigned int)v3, v4, v5, (unsigned __int8)v6, v7);
}

//----- (0000000000005706) ----------------------------------------------------
int __fastcall IOUSBController::UIMCreateInterruptTransfer(IOUSBController *this, IOUSBCommand *a2)
{
  int (__fastcall *v2)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD); // ST28_8@1
  __int16 v3; // ST26_2@1
  unsigned __int8 v4; // ST25_1@1
  __int64 v5; // r13@1
  char v6; // r14@1
  unsigned int v7; // er12@1
  char v8; // al@1
  __int64 v10; // [sp+30h] [bp-40h]@1

  v2 = *(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 2200LL);
  v3 = IOUSBCommand::GetAddress(a2);
  v4 = IOUSBCommand::GetEndpoint(a2);
  IOUSBCommand::GetUSLCompletion((IOUSBCommand *)&v10, (__int64)a2);
  v5 = IOUSBCommand::GetBuffer(a2);
  v6 = IOUSBCommand::GetBufferRounding(a2);
  v7 = IOUSBCommand::GetReqCount(a2);
  v8 = IOUSBCommand::GetDirection(a2);
  return v2(this, (unsigned int)v3, v4, v5, (unsigned __int8)v6, v7);
}

//----- (00000000000057C0) ----------------------------------------------------
__int64 __fastcall IOUSBController::DeviceRequest(uintptr_t arg1, IOMemoryDescriptor *this, __int64 a3, __int16 a4, char a5, int a6, int a7)
{
  int v7; // er10@1
  __int16 v8; // r9@1
  __int64 v9; // r15@1
  uintptr_t v10; // r14@1
  char v11; // di@1
  void *v12; // rsi@1
  int v13; // eax@1
  __int64 v14; // ST70_8@4
  __int64 v15; // ST60_8@4
  __int16 v16; // r15@4
  char v17; // r13@4
  int v18; // ebx@4
  int v19; // ebx@6
  __int64 v20; // rbx@9
  __int64 v21; // r12@10
  __int16 v22; // cx@10
  __int64 v23; // rax@11
  __int64 v24; // r9@11
  __int64 v25; // rax@12
  __int64 v26; // r8@12
  __int64 v27; // r9@12
  __int64 v28; // rbx@13
  int v29; // eax@15
  uintptr_t v30; // rdi@16
  int v31; // er14@16
  __int64 v32; // rax@16
  __int64 v33; // r9@16
  IOUSBCommand *v34; // rbx@17
  __int64 v35; // rax@17
  const OSMetaClass *v36; // rdx@17
  __int64 v37; // rcx@17
  __int64 v38; // r13@17
  IOUSBCommand *v39; // rax@18
  __int64 v40; // r14@22
  __int64 v41; // rax@23
  __int64 v42; // r8@23
  __int64 v43; // r9@23
  __int64 v44; // rax@24
  __int64 v45; // rdx@25
  IOUSBCommand *v46; // rax@27
  __int64 v47; // rbx@32
  __int64 v48; // rdi@44
  __int64 v49; // rax@45
  __int64 v50; // rax@46
  __int64 v51; // rbx@46
  __int64 v52; // rax@46
  int v53; // ebx@47
  __int64 v54; // rax@48
  __int64 v55; // rax@49
  __int64 v56; // r8@49
  __int64 v57; // r9@49
  __int64 v58; // rbx@50
  __int64 v59; // r14@51
  __int64 v60; // rax@52
  __int64 v61; // rbx@52
  __int64 v62; // rax@53
  __int64 v63; // r14@53
  __int64 v64; // rax@53
  IOUSBCommand *v65; // r14@57
  signed __int64 v66; // rsi@57
  __int64 v67; // rbx@58
  IOUSBController *v68; // r13@61
  __int64 v69; // rcx@62
  __int64 v70; // r15@63
  IOUSBCommand *v71; // rbx@63
  __int64 v72; // r14@64
  __int64 v73; // rax@66
  IOUSBCommand *v74; // rdi@66
  __int64 v75; // r13@66
  __int64 v76; // rbx@67
  char v77; // r12@69
  __int64 v78; // rbx@73
  __int64 v79; // rax@73
  __int64 v80; // rax@76
  signed __int64 v81; // r13@84
  __int64 v83; // rax@92
  __int64 v84; // r8@92
  __int64 v85; // r9@92
  __int64 v86; // r13@96
  int v87; // ebx@96
  __int64 v88; // rax@97
  void (__usercall *v89)(void *@<rdi>, void *@<rsi>, char@<al>, unsigned int@<edx>, unsigned int@<ecx>, __int64@<r8>, __int64@<r9>); // r12@99
  int v90; // esi@100
  int v91; // er14@102
  IOUSBCommand *v92; // r15@102
  int v93; // ebx@102
  char v94; // [sp+0h] [bp-F0h]@0
  __int64 v95; // [sp+28h] [bp-C8h]@30
  __int64 v96; // [sp+30h] [bp-C0h]@45
  __int64 v97; // [sp+38h] [bp-B8h]@16
  __int64 v98; // [sp+40h] [bp-B0h]@16
  IOUSBCommand *v99; // [sp+48h] [bp-A8h]@67
  char v100; // [sp+54h] [bp-9Ch]@9
  int v101; // [sp+58h] [bp-98h]@9
  __int16 v102; // [sp+5Ch] [bp-94h]@9
  char v103; // [sp+60h] [bp-90h]@69
  IOUSBController *v104; // [sp+68h] [bp-88h]@16
  IOUSBController *v105; // [sp+68h] [bp-88h]@63
  __int64 v106; // [sp+70h] [bp-80h]@9
  int v107; // [sp+70h] [bp-80h]@16
  __int64 v108; // [sp+78h] [bp-78h]@50

  v7 = a6;
  v8 = a4;
  v9 = (__int64)this;
  v10 = arg1;
  v11 = *(_BYTE *)this;
  v12 = (void *)*((_WORD *)this + 3);
  v13 = *(_DWORD *)(v9 + 16);
  if ( v13 & 0x40000000 )
  {
    if ( gUSBStackDebugFlags & 2 )
    {
      a4 = LOWORD(off_3B100[0]);
      if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        v14 = a3;
        v15 = v9;
        v16 = v8;
        v17 = a5;
        v18 = v7;
        kernel_debug(0x52D0008u, v10, 0LL, 0LL, 4uLL, 0LL);
        v7 = v18;
        a5 = v17;
        v8 = v16;
        v9 = v15;
        a3 = v14;
        v13 = *(_DWORD *)(v15 + 16);
      }
    }
    *(_DWORD *)(v9 + 16) = v13 & 0xBFFFFFFF;
  }
  v19 = -536870199;
  if ( *(_QWORD *)(v10 + 144) )
  {
    if ( !(_WORD)v12 || (v19 = -536870206, *(_QWORD *)(v9 + 8)) )
    {
      v102 = v8;
      v100 = a5;
      v106 = a3;
      v101 = v7;
      v20 = IOMemoryDescriptor::withAddress((IOMemoryDescriptor *)v9, &dword_8, 2uLL, a4);
      if ( !v20 )
      {
        LODWORD(v25) = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)v10 + 904LL))(v10, 0LL);
        KernelDebugLogInternal(
          1u,
          0x55534246u,
          (__int64)"%s::DeviceRequest - could not create request memory descriptor",
          v25,
          v26,
          v27,
          v94);
        v19 = -536870211;
        return (unsigned int)v19;
      }
      v21 = v20;
      v19 = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v20 + 496LL))(v20, 0LL);
      if ( v19 )
      {
        LODWORD(v23) = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)v10 + 904LL))(v10, 0LL);
        KernelDebugLogInternal(
          1u,
          0x55534246u,
          (__int64)"%s::DeviceRequest - err (0x%x) trying to prepare request memory descriptor",
          v23,
          (unsigned int)v19,
          v24,
          v94);
        (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v21 + 40LL))(v21, 1431519814LL);
        return (unsigned int)v19;
      }
      v28 = 0LL;
      if ( (_WORD)v12 )
      {
        v28 = IOMemoryDescriptor::withAddress(*(IOMemoryDescriptor **)(v9 + 8), v12, (unsigned int)(v11 >= 0) + 1, v22);
        if ( !v28 )
        {
          v104 = (IOUSBController *)v10;
          v98 = 0LL;
          LODWORD(v41) = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)v10 + 904LL))(v10, 0LL);
          KernelDebugLogInternal(
            1u,
            0x55534246u,
            (__int64)"%s::DeviceRequest - could not create buffer memory descriptor",
            v41,
            v42,
            v43,
            v94);
          v107 = -536870211;
          goto LABEL_55;
        }
        v29 = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v28 + 496LL))(v28, 0LL);
        if ( v29 )
        {
          v30 = v10;
          v104 = (IOUSBController *)v10;
          v31 = v29;
          v97 = 0LL;
          LODWORD(v32) = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)v104 + 904LL))(v30, 0LL);
          v107 = v31;
          KernelDebugLogInternal(
            1u,
            0x55534246u,
            (__int64)"%s::DeviceRequest - err (0x%x) trying to prepare bufferMemoryDescriptor",
            v32,
            (unsigned int)v31,
            v33,
            v94);
          (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v28 + 40LL))(v28, 1431519814LL);
          v98 = 0LL;
LABEL_56:
          v38 = 0LL;
          v47 = v21;
          goto LABEL_57;
        }
      }
      v98 = v28;
      v34 = 0LL;
      LODWORD(v35) = (*(int (__fastcall **)(_QWORD, _QWORD))(***(_QWORD ***)(v10 + 168) + 296LL))(
                       **(_QWORD **)(v10 + 168),
                       0LL);
      v37 = (__int64)v12;
      v38 = v35;
      if ( (_WORD)v12 )
      {
        LODWORD(v39) = (*(int (__fastcall **)(_QWORD, _QWORD))(***(_QWORD ***)(v10 + 168) + 296LL))(
                         **(_QWORD **)(v10 + 168),
                         0LL);
        v37 = (__int64)v12;
        v34 = v39;
      }
      v104 = (IOUSBController *)v10;
      if ( v38 )
      {
        if ( !(_WORD)v37 || v34 )
        {
          v95 = v37;
LABEL_37:
          if ( *(_QWORD *)(*(_QWORD *)(v38 + 216) + 56LL) )
            IOUSBCommand::SetBufferUSBCommand((IOUSBCommand *)v38, 0LL);
          if ( IOUSBCommand::GetRequestMemoryDescriptor((IOUSBCommand *)v38) )
            IOUSBCommand::SetRequestMemoryDescriptor((IOUSBCommand *)v38, 0LL);
          if ( v34 && IOUSBCommand::GetBufferMemoryDescriptor(v34) )
            IOUSBCommand::SetBufferMemoryDescriptor(v34, 0LL);
          IOUSBCommand::SetBufferUSBCommand((IOUSBCommand *)v38, v34);
          v48 = *(_QWORD *)(*(_QWORD *)(v38 + 216) + 48LL);
          if ( v48 )
          {
            v96 = (__int64)v34;
            LODWORD(v49) = (*(int (__fastcall **)(__int64, IOUSBCommand *))(*(_QWORD *)v48 + 312LL))(v48, v34);
            if ( v49 )
            {
              LODWORD(v50) = (*(int (**)(void))(*(_QWORD *)v48 + 312LL))();
              v51 = v50;
              LODWORD(v52) = (*(int (__fastcall **)(IOUSBController *, _QWORD))(*(_QWORD *)v104 + 904LL))(v104, 0LL);
              KernelDebugLogInternal(
                1u,
                0x55534246u,
                (__int64)"%s::DeviceRequest - dmaCommand (%p) already had memory descriptor (%p) - clearing",
                v52,
                v48,
                v51,
                v94);
              (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v48 + 304LL))(v48, 1LL);
            }
            v53 = (*(int (__fastcall **)(__int64, __int64, signed __int64))(*(_QWORD *)v48 + 296LL))(v48, v21, 1LL);
            if ( !v53 )
            {
              v97 = v48;
              v58 = v38;
              IOUSBCommand::SetRequestMemoryDescriptor((IOUSBCommand *)v38, (IOMemoryDescriptor *)v21);
              IOUSBCommand::SetReqCount((IOUSBCommand *)v38, 8LL);
              v108 = 0LL;
              if ( v96 )
              {
                v59 = *(_QWORD *)(*(_QWORD *)(v96 + 216) + 48LL);
                if ( !v59 )
                {
                  v65 = (IOUSBCommand *)v38;
                  v108 = 0LL;
                  LODWORD(v83) = (*(int (__fastcall **)(IOUSBController *, _QWORD))(*(_QWORD *)v104 + 904LL))(v104, 0LL);
                  v66 = 1431519814LL;
                  KernelDebugLogInternal(
                    1u,
                    0x55534246u,
                    (__int64)"%s::DeviceRequest - No dmaCommand in the usb command",
                    v83,
                    v84,
                    v85,
                    v94);
                  v107 = -536870210;
                  goto LABEL_58;
                }
                LODWORD(v60) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v59 + 312LL))(v59, 8LL);
                v61 = v59;
                if ( v60 )
                {
                  LODWORD(v62) = (*(int (__fastcall **)(IOUSBController *, _QWORD))(*(_QWORD *)v104 + 904LL))(v104, 0LL);
                  v63 = v62;
                  LODWORD(v64) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v61 + 312LL))(v61);
                  v108 = v61;
                  KernelDebugLogInternal(
                    1u,
                    0x55534246u,
                    (__int64)"%s::DeviceRequest - buffer dmaCommand (%p) already had memory descriptor (%p) - clearing",
                    v63,
                    v61,
                    v64,
                    v94);
                  (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v61 + 304LL))(v61, 1LL);
                }
                else
                {
                  v108 = v59;
                }
                v58 = v38;
              }
              if ( v98 )
              {
                v86 = v58;
                v87 = (*(int (__fastcall **)(__int64, __int64, signed __int64))(*(_QWORD *)v108 + 296LL))(
                        v108,
                        v98,
                        1LL);
                if ( v87 )
                {
                  v65 = (IOUSBCommand *)v86;
                  LODWORD(v88) = (*(int (__fastcall **)(IOUSBController *, _QWORD))(*(_QWORD *)v104 + 904LL))(v104, 0LL);
                  v66 = 1431519814LL;
                  v107 = v87;
                  KernelDebugLogInternal(
                    1u,
                    0x55534246u,
                    (__int64)"%s::DeviceRequest - err (0x%x) setting buffer memory descriptor (%p) into buffer dmaCommand (%p)",
                    v88,
                    (unsigned int)v87,
                    v98,
                    v108);
                  v67 = v98;
                  goto LABEL_59;
                }
                IOUSBCommand::SetBufferMemoryDescriptor((IOUSBCommand *)v96, (IOMemoryDescriptor *)v98);
                IOUSBCommand::SetReqCount((IOUSBCommand *)v96, v95);
                IOUSBCommand::SetSelector(v96, 0);
                v58 = v86;
              }
              v89 = *(void (__usercall **)(void *@<rdi>, void *@<rsi>, char@<al>, unsigned int@<edx>, unsigned int@<ecx>, __int64@<r8>, __int64@<r9>))(v106 + 8);
              IOUSBCommand::SetIsSyncTransfer((IOUSBCommand *)v58, v89 == IOUSBSyncCompletion);
              IOUSBCommand::SetUseTimeStamp((IOUSBCommand *)v58, 0);
              if ( v96 )
                v90 = 6;
              else
                v90 = 0;
              IOUSBCommand::SetSelector(v58, v90);
              IOUSBCommand::SetRequest(v58, v9);
              IOUSBCommand::SetAddress((IOUSBCommand *)v58, v102);
              IOUSBCommand::SetEndpoint((IOUSBCommand *)v58, v100);
              *(_DWORD *)(*(_QWORD *)(v58 + 216) + 72LL) = 0;
              IOUSBCommand::SetDirection((IOUSBCommand *)v58, 3);
              v91 = 0;
              IOUSBCommand::SetType((IOUSBCommand *)v58, 0);
              IOUSBCommand::SetBuffer((IOUSBCommand *)v58, 0LL);
              IOUSBCommand::SetClientCompletion(v58, *(_QWORD *)v106, *(_QWORD *)(v106 + 8), *(_QWORD *)(v106 + 16));
              IOUSBCommand::SetNoDataTimeout((IOUSBCommand *)v58, v101);
              IOUSBCommand::SetCompletionTimeout((IOUSBCommand *)v58, a7);
              IOUSBCommand::SetUSLCompletion(v58, 0LL, 0LL, 0LL);
              IOUSBCommand::SetDisjointCompletion(v58, 0LL, 0LL, 0LL);
              IOUSBCommand::SetMultiTransferTransaction((IOUSBCommand *)v58, 0);
              IOUSBCommand::SetFinalTransferInTransaction((IOUSBCommand *)v58, 0);
              v92 = (IOUSBCommand *)v58;
              v93 = 0;
              do
                IOUSBCommand::SetUIMScratch(v92, v93++, 0);
              while ( v93 != 10 );
              do
                IOUSBCommand::SetUIMScratch64(v92, v91++, 0LL);
              while ( v91 != 5 );
              v68 = v104;
              v66 = (signed __int64)IOUSBController::DoControlTransfer;
              v19 = 0;
              v65 = v92;
              v107 = (*(int (__fastcall **)(_QWORD, __int64 (__fastcall *)(uintptr_t, OSObject *, void *, void *, void *, void *), IOUSBCommand *, _QWORD, _QWORD, _QWORD))(**((_QWORD **)v104 + 18) + 456LL))(
                       *((_QWORD *)v104 + 18),
                       IOUSBController::DoControlTransfer,
                       v92,
                       0LL,
                       0LL,
                       0LL);
              if ( !v107 )
              {
                v69 = v48;
                if ( v89 != IOUSBSyncCompletion )
                  return (unsigned int)v19;
LABEL_63:
                v105 = v68;
                v70 = 0LL;
                v71 = v65;
                if ( v65 )
                {
                  v72 = *(_QWORD *)(*((_QWORD *)v65 + 27) + 56LL);
                  v70 = IOUSBCommand::GetRequestMemoryDescriptor(v71);
                  if ( v70 )
                  {
                    v66 = 0LL;
                    IOUSBCommand::SetRequestMemoryDescriptor(v71, 0LL);
                  }
                  v73 = *((_QWORD *)v71 + 27);
                  v69 = *(_QWORD *)(v73 + 48);
                  v74 = v71;
                  v75 = 0LL;
                  if ( v72 )
                  {
                    v76 = *(_QWORD *)(v73 + 48);
                    v66 = 0LL;
                    v99 = v74;
                    IOUSBCommand::SetBufferUSBCommand(v74, 0LL);
                    v75 = IOUSBCommand::GetBufferMemoryDescriptor((IOUSBCommand *)v72);
                    if ( v75 )
                    {
                      v66 = 0LL;
                      IOUSBCommand::SetBufferMemoryDescriptor((IOUSBCommand *)v72, 0LL);
                    }
                    v108 = *(_QWORD *)(*(_QWORD *)(v72 + 216) + 48LL);
                    v103 = 1;
                    v77 = 1;
                    v69 = v76;
                  }
                  else
                  {
                    v99 = v71;
                    v103 = 1;
                    v77 = 0;
                    v72 = 0LL;
                  }
                }
                else
                {
                  v103 = 0;
                  v99 = 0LL;
                  v77 = 0;
                  v72 = 0LL;
                  v75 = 0LL;
                }
                if ( v69 )
                {
                  v78 = v69;
                  LODWORD(v79) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v69 + 312LL))(v69, v66);
                  if ( v79 )
                  {
                    v66 = 1LL;
                    (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v78 + 304LL))(v78, 1LL);
                  }
                }
                if ( v108 )
                {
                  LODWORD(v80) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v108 + 312LL))(v108, v66);
                  if ( v80 )
                    (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v108 + 304LL))(v108, 1LL);
                }
                if ( v75 )
                {
                  (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v75 + 504LL))(v75, 0LL);
                  (*(void (__fastcall **)(__int64))(*(_QWORD *)v75 + 40LL))(v75);
                }
                if ( v70 )
                {
                  (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v70 + 504LL))(v70, 0LL);
                  (*(void (__fastcall **)(__int64))(*(_QWORD *)v70 + 40LL))(v70);
                }
                if ( v77 )
                {
                  (*(void (__fastcall **)(_QWORD, __int64))(***((_QWORD ***)v105 + 21) + 304LL))(
                    **((_QWORD **)v105 + 21),
                    v72);
                  if ( !v103 )
                  {
                    v19 = v107;
                    return (unsigned int)v19;
                  }
                  v81 = (signed __int64)((char *)v105 + 168);
                  v19 = v107;
                }
                else
                {
                  v19 = v107;
                  if ( !v103 )
                    return (unsigned int)v19;
                  v81 = (signed __int64)((char *)v105 + 168);
                }
                (*(void (__fastcall **)(_QWORD, IOUSBCommand *))(***(_QWORD ***)v81 + 304LL))(**(_QWORD **)v81, v99);
                return (unsigned int)v19;
              }
LABEL_62:
              v69 = v97;
              goto LABEL_63;
            }
            LODWORD(v54) = (*(int (__fastcall **)(IOUSBController *, _QWORD))(*(_QWORD *)v104 + 904LL))(v104, 0LL);
            v97 = v48;
            v107 = v53;
            KernelDebugLogInternal(
              1u,
              0x55534246u,
              (__int64)"%s::DeviceRequest - err (0x%x) setting memory descriptor (%p) into dmaCommand (%p)",
              v54,
              (unsigned int)v53,
              v21,
              v48);
            v47 = v21;
          }
          else
          {
            v97 = 0LL;
            LODWORD(v55) = (*(int (__fastcall **)(IOUSBController *, _QWORD))(*(_QWORD *)v104 + 904LL))(v104, 0LL);
            KernelDebugLogInternal(
              1u,
              0x55534246u,
              (__int64)"%s::DeviceRequest - No dmaCommand in the usb command",
              v55,
              v56,
              v57,
              v94);
            v107 = -536870210;
            v47 = v21;
          }
LABEL_57:
          v65 = (IOUSBCommand *)v38;
          v108 = 0LL;
          v66 = 0LL;
          (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v47 + 504LL))(v47, 0LL);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v47 + 40LL))(v47);
LABEL_58:
          v67 = v98;
LABEL_59:
          if ( v67 )
          {
            v66 = 0LL;
            (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v67 + 504LL))(v67, 0LL);
            (*(void (__fastcall **)(__int64))(*(_QWORD *)v67 + 40LL))(v67);
          }
          v68 = v104;
          goto LABEL_62;
        }
        v40 = v37;
        IOUSBController::IncreaseCommandPool(v104, 0LL, v36);
      }
      else
      {
        v40 = v37;
        IOUSBController::IncreaseCommandPool(v104, 0LL, v36);
        LODWORD(v44) = (*(int (__fastcall **)(_QWORD, _QWORD))(***((_QWORD ***)v104 + 21) + 296LL))(
                         **((_QWORD **)v104 + 21),
                         0LL);
        v38 = v44;
      }
      v45 = v40;
      if ( (_WORD)v40 && !v34 )
      {
        LODWORD(v46) = (*(int (__fastcall **)(_QWORD, _QWORD))(***((_QWORD ***)v104 + 21) + 296LL))(
                         **((_QWORD **)v104 + 21),
                         0LL);
        v45 = v40;
        v34 = v46;
      }
      if ( v38 && (v34 != 0LL || (_WORD)v45 == 0) )
      {
        v95 = v45;
        goto LABEL_37;
      }
      if ( v38 )
      {
        v107 = -536870210;
        v47 = v21;
        if ( *(_QWORD *)(*(_QWORD *)(v38 + 216) + 56LL) )
          IOUSBCommand::SetBufferUSBCommand((IOUSBCommand *)v38, 0LL);
        if ( IOUSBCommand::GetRequestMemoryDescriptor((IOUSBCommand *)v38) )
        {
          v97 = 0LL;
          IOUSBCommand::SetRequestMemoryDescriptor((IOUSBCommand *)v38, 0LL);
        }
        else
        {
          v97 = 0LL;
        }
        goto LABEL_57;
      }
      v107 = -536870210;
LABEL_55:
      v97 = 0LL;
      goto LABEL_56;
    }
  }
  return (unsigned int)v19;
}
// 8: using guessed type int dword_8;
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (0000000000006350) ----------------------------------------------------
__int64 __fastcall IOUSBController::DeviceRequest(IOUSBController *this, IOMemoryDescriptor *a2, __int64 a3, __int16 a4, char a5, int a6, int a7)
{
  int v7; // er13@1
  __int16 v8; // r9@1
  __int64 v9; // r12@1
  __int64 v10; // r14@1
  int v11; // eax@1
  __int64 v12; // ST60_8@4
  unsigned __int64 v13; // ST68_8@4
  __int16 v14; // r12@4
  char v15; // r15@4
  int v16; // ebx@6
  __int64 v17; // r13@9
  __int64 v18; // rax@11
  __int64 v19; // r9@11
  __int64 v20; // rax@12
  __int64 v21; // r8@12
  __int64 v22; // r9@12
  __int64 v23; // rax@13
  const OSMetaClass *v24; // rdx@13
  __int64 v25; // rbx@13
  IOUSBCommand *v26; // rax@14
  __int64 v27; // r15@15
  IOUSBCommand *v28; // rbx@16
  __int64 v29; // rax@19
  IOUSBCommand *v30; // rax@22
  IOUSBCommand *v31; // rsi@32
  IOUSBCommand *v32; // rbx@32
  __int64 v33; // r14@32
  __int64 v34; // rax@33
  __int64 v35; // rax@34
  __int64 v36; // rbx@34
  __int64 v37; // rax@34
  __int64 v38; // r9@34
  int v39; // eax@35
  int v40; // ebx@36
  IOUSBController *v41; // r12@36
  __int64 v42; // rax@36
  __int64 v43; // r15@36
  __int64 v44; // rcx@37
  IOUSBCommand *v45; // rbx@38
  __int64 v46; // rax@42
  __int64 v47; // r8@42
  __int64 v48; // r9@42
  __int64 v49; // r15@43
  __int64 v50; // r13@43
  __int64 v51; // rax@45
  __int64 v52; // rax@46
  __int64 v53; // r13@46
  __int64 v54; // rax@46
  __int64 v55; // r14@48
  IOUSBCommand *v56; // rbx@49
  int v57; // eax@49
  IOUSBController *v58; // rbx@50
  int v59; // er14@50
  __int64 v60; // rax@50
  IOUSBController *v61; // rax@53
  __int64 v62; // r12@54
  __int64 v63; // r15@55
  __int64 v64; // r14@57
  char v65; // bl@58
  char v66; // r13@58
  __int64 v67; // rax@63
  __int64 v68; // rax@66
  __int64 v70; // rax@77
  __int64 v71; // r9@77
  int v72; // er15@78
  int v73; // ebx@78
  __int64 v74; // rax@84
  __int64 v75; // r8@84
  __int64 v76; // r9@84
  char v77; // [sp+0h] [bp-E0h]@0
  __int64 v78; // [sp+28h] [bp-B8h]@43
  int v79; // [sp+34h] [bp-ACh]@36
  IOUSBCommand *v80; // [sp+38h] [bp-A8h]@13
  IOUSBCommand *v81; // [sp+38h] [bp-A8h]@32
  IOUSBCommand *v82; // [sp+38h] [bp-A8h]@48
  IOUSBController *v83; // [sp+40h] [bp-A0h]@55
  IOUSBCommand *v84; // [sp+48h] [bp-98h]@36
  __int16 v85; // [sp+54h] [bp-8Ch]@9
  char v86; // [sp+58h] [bp-88h]@9
  int v87; // [sp+5Ch] [bp-84h]@9
  __int64 v88; // [sp+60h] [bp-80h]@9
  __int64 v89; // [sp+60h] [bp-80h]@58
  __int64 v90; // [sp+68h] [bp-78h]@10
  unsigned __int64 v91; // [sp+68h] [bp-78h]@50

  v7 = a6;
  v8 = a4;
  v9 = (__int64)a2;
  v10 = *((_WORD *)a2 + 3);
  v11 = *((_DWORD *)a2 + 4);
  if ( v11 & 0x40000000 )
  {
    if ( gUSBStackDebugFlags & 2 )
    {
      a4 = LOWORD(off_3B100[0]);
      if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        v12 = a3;
        v13 = *((_WORD *)a2 + 3);
        v14 = v8;
        v15 = a5;
        kernel_debug(0x52D0008u, (uintptr_t)this, 0LL, 0LL, 3uLL, 0LL);
        a5 = v15;
        v8 = v14;
        v9 = (__int64)a2;
        v10 = v13;
        a3 = v12;
        v11 = *((_DWORD *)a2 + 4);
      }
    }
    *(_DWORD *)(v9 + 16) = v11 & 0xBFFFFFFF;
  }
  v16 = -536870199;
  if ( *((_QWORD *)this + 18) )
  {
    if ( !(_WORD)v10 || (v16 = -536870206, *(_QWORD *)(v9 + 8)) )
    {
      v85 = v8;
      v86 = a5;
      v88 = a3;
      v87 = v7;
      v17 = IOMemoryDescriptor::withAddress((IOMemoryDescriptor *)v9, &dword_8, 2uLL, a4);
      if ( !v17 )
      {
        LODWORD(v20) = (*(int (__fastcall **)(IOUSBController *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
        KernelDebugLogInternal(
          1u,
          0x55534246u,
          (__int64)"%s::DeviceRequest - could not create request memory descriptor",
          v20,
          v21,
          v22,
          v77);
        v16 = -536870211;
        return (unsigned int)v16;
      }
      v90 = v10;
      v16 = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v17 + 496LL))(v17, 0LL);
      if ( v16 )
      {
        LODWORD(v18) = (*(int (__fastcall **)(IOUSBController *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
        KernelDebugLogInternal(
          1u,
          0x55534246u,
          (__int64)"%s::DeviceRequest - err (0x%x) trying to prepare request memory descriptor",
          v18,
          (unsigned int)v16,
          v19,
          v77);
        (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v17 + 40LL))(v17, 1431519814LL);
        return (unsigned int)v16;
      }
      v80 = 0LL;
      LODWORD(v23) = (*(int (__fastcall **)(_QWORD, _QWORD))(***((_QWORD ***)this + 21) + 296LL))(
                       **((_QWORD **)this + 21),
                       0LL);
      v25 = v23;
      if ( (_WORD)v10 )
      {
        LODWORD(v26) = (*(int (__fastcall **)(_QWORD, _QWORD))(***((_QWORD ***)this + 21) + 296LL))(
                         **((_QWORD **)this + 21),
                         0LL);
        v80 = v26;
      }
      v27 = v25;
      if ( v25 )
      {
        v28 = v80;
        if ( !(_WORD)v10 || v80 )
          goto LABEL_25;
        IOUSBController::IncreaseCommandPool(this, 0LL, v24);
      }
      else
      {
        IOUSBController::IncreaseCommandPool(this, 0LL, v24);
        LODWORD(v29) = (*(int (__fastcall **)(_QWORD, _QWORD))(***((_QWORD ***)this + 21) + 296LL))(
                         **((_QWORD **)this + 21),
                         0LL);
        v27 = v29;
        v28 = v80;
      }
      if ( (_WORD)v10 && !v28 )
      {
        LODWORD(v30) = (*(int (__fastcall **)(_QWORD, _QWORD))(***((_QWORD ***)this + 21) + 296LL))(
                         **((_QWORD **)this + 21),
                         0LL);
        v28 = v30;
      }
      if ( !v27 || v28 == 0LL && (_WORD)v10 != 0 )
      {
        v79 = -536870210;
        v44 = v27;
        v43 = 0LL;
        if ( v44 )
        {
          v45 = (IOUSBCommand *)v44;
          if ( *(_QWORD *)(*(_QWORD *)(v44 + 216) + 56LL) )
            IOUSBCommand::SetBufferUSBCommand((IOUSBCommand *)v44, 0LL);
          v41 = this;
          v43 = 0LL;
          if ( IOUSBCommand::GetRequestMemoryDescriptor(v45) )
          {
            v43 = 0LL;
            v84 = v45;
            IOUSBCommand::SetRequestMemoryDescriptor(v45, 0LL);
          }
          else
          {
            v84 = v45;
          }
        }
        else
        {
          v41 = this;
          v84 = 0LL;
        }
        goto LABEL_53;
      }
LABEL_25:
      if ( *(_QWORD *)(*(_QWORD *)(v27 + 216) + 56LL) )
        IOUSBCommand::SetBufferUSBCommand((IOUSBCommand *)v27, 0LL);
      if ( IOUSBCommand::GetRequestMemoryDescriptor((IOUSBCommand *)v27) )
        IOUSBCommand::SetRequestMemoryDescriptor((IOUSBCommand *)v27, 0LL);
      if ( v28 && IOUSBCommand::GetBufferMemoryDescriptor(v28) )
        IOUSBCommand::SetBufferMemoryDescriptor(v28, 0LL);
      v31 = v28;
      v81 = v28;
      IOUSBCommand::SetBufferUSBCommand((IOUSBCommand *)v27, v28);
      v32 = (IOUSBCommand *)v27;
      v33 = *(_QWORD *)(*(_QWORD *)(v27 + 216) + 48LL);
      if ( !v33 )
      {
        v84 = (IOUSBCommand *)v27;
        v43 = 0LL;
        v41 = this;
        LODWORD(v46) = (*(int (__fastcall **)(IOUSBController *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
        KernelDebugLogInternal(
          1u,
          0x55534246u,
          (__int64)"%s::DeviceRequest - No dmaCommand in the usb command",
          v46,
          v47,
          v48,
          v77);
        v79 = -536870210;
        goto LABEL_53;
      }
      LODWORD(v34) = (*(int (__fastcall **)(__int64, IOUSBCommand *))(*(_QWORD *)v33 + 312LL))(v33, v31);
      if ( v34 )
      {
        LODWORD(v35) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v33 + 312LL))(v33);
        v36 = v35;
        LODWORD(v37) = (*(int (__fastcall **)(IOUSBController *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
        v38 = v36;
        v32 = (IOUSBCommand *)v27;
        KernelDebugLogInternal(
          1u,
          0x55534246u,
          (__int64)"%s::DeviceRequest - dmaCommand (%p) already had memory descriptor (%p) - clearing",
          v37,
          v33,
          v38,
          v77);
        (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v33 + 304LL))(v33, 1LL);
      }
      v39 = (*(int (__fastcall **)(__int64, __int64, signed __int64))(*(_QWORD *)v33 + 296LL))(v33, v17, 1LL);
      if ( v39 )
      {
        v84 = v32;
        v40 = v39;
        v79 = v39;
        v41 = this;
        LODWORD(v42) = (*(int (__fastcall **)(IOUSBController *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
        KernelDebugLogInternal(
          1u,
          0x55534246u,
          (__int64)"%s::DeviceRequest - err (0x%x) setting memory descriptor (%p) into dmaCommand (%p)",
          v42,
          (unsigned int)v40,
          v17,
          v33);
        v43 = v33;
LABEL_53:
        v91 = 0LL;
        (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v17 + 504LL))(v17, 0LL);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v17 + 40LL))(v17);
        v61 = v41;
LABEL_54:
        v62 = 0LL;
        if ( v84 )
        {
          v83 = v61;
          v63 = *(_QWORD *)(*((_QWORD *)v84 + 27) + 56LL);
          v62 = IOUSBCommand::GetRequestMemoryDescriptor(v84);
          if ( v62 )
            IOUSBCommand::SetRequestMemoryDescriptor(v84, 0LL);
          v64 = *(_QWORD *)(*((_QWORD *)v84 + 27) + 48LL);
          if ( v63 )
          {
            IOUSBCommand::SetBufferUSBCommand(v84, 0LL);
            v91 = *(_QWORD *)(*(_QWORD *)(v63 + 216) + 48LL);
            v65 = 1;
            v66 = 1;
            v89 = v63;
          }
          else
          {
            v89 = 0LL;
            v65 = 1;
            v66 = 0;
          }
          v43 = v64;
        }
        else
        {
          v83 = v61;
          v65 = 0;
          v84 = 0LL;
          v66 = 0;
          v89 = 0LL;
        }
        if ( v43 )
        {
          LODWORD(v67) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v43 + 312LL))(v43);
          if ( v67 )
            (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v43 + 304LL))(v43, 1LL);
        }
        if ( v91 )
        {
          LODWORD(v68) = (*(int (__fastcall **)(unsigned __int64))(*(_QWORD *)v91 + 312LL))(v91);
          if ( v68 )
            (*(void (__fastcall **)(unsigned __int64, signed __int64))(*(_QWORD *)v91 + 304LL))(v91, 1LL);
        }
        if ( v62 )
        {
          (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v62 + 504LL))(v62, 0LL);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v62 + 40LL))(v62);
        }
        if ( v66 )
          (*(void (__fastcall **)(_QWORD, __int64))(***((_QWORD ***)v83 + 21) + 304LL))(**((_QWORD **)v83 + 21), v89);
        if ( v65 )
          (*(void (__fastcall **)(_QWORD, IOUSBCommand *))(***((_QWORD ***)v83 + 21) + 304LL))(
            **((_QWORD **)v83 + 21),
            v84);
        v16 = v79;
        return (unsigned int)v16;
      }
      v78 = v33;
      IOUSBCommand::SetRequestMemoryDescriptor(v32, (IOMemoryDescriptor *)v17);
      IOUSBCommand::SetReqCount(v32, 8LL);
      v49 = 0LL;
      v50 = (__int64)v81;
      if ( v81 )
      {
        v84 = v32;
        v49 = *(_QWORD *)(*((_QWORD *)v81 + 27) + 48LL);
        if ( !v49 )
        {
          v58 = this;
          v91 = 0LL;
          LODWORD(v74) = (*(int (__fastcall **)(IOUSBController *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
          KernelDebugLogInternal(
            1u,
            0x55534246u,
            (__int64)"%s::DeviceRequest - No dmaCommand in the usb command",
            v74,
            v75,
            v76,
            v77);
          v79 = -536870210;
          goto LABEL_85;
        }
        LODWORD(v51) = (*(int (__fastcall **)(_QWORD, signed __int64))(*(_QWORD *)v49 + 312LL))(
                         *(_QWORD *)(*((_QWORD *)v81 + 27) + 48LL),
                         8LL);
        if ( v51 )
        {
          LODWORD(v52) = (*(int (__fastcall **)(IOUSBController *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
          v53 = v52;
          LODWORD(v54) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v49 + 312LL))(v49);
          KernelDebugLogInternal(
            1u,
            0x55534246u,
            (__int64)"%s::DeviceRequest - buffer dmaCommand (%p) already had memory descriptor (%p) - clearing",
            v53,
            v49,
            v54,
            v77);
          (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v49 + 304LL))(v49, 1LL);
        }
        v50 = (__int64)v81;
      }
      v55 = (__int64)v32;
      v82 = *(IOUSBCommand **)(v88 + 8);
      IOUSBCommand::SetIsSyncTransfer(v32, (char *)v82 == (char *)IOUSBSyncCompletion);
      IOUSBCommand::SetUseTimeStamp(v32, 0);
      if ( v50 )
      {
        IOUSBCommand::SetBufferMemoryDescriptor((IOUSBCommand *)v50, *(IOMemoryDescriptor **)(v9 + 8));
        IOUSBCommand::SetReqCount((IOUSBCommand *)v50, v90);
        v56 = (IOUSBCommand *)v50;
        IOUSBCommand::SetSelector(v50, 5);
        IOUSBCommand::SetSelector(v55, 6);
        v57 = (*(int (__fastcall **)(__int64, _QWORD, signed __int64))(*(_QWORD *)v49 + 296LL))(
                v49,
                *(_QWORD *)(v9 + 8),
                1LL);
        if ( v57 )
        {
          v84 = (IOUSBCommand *)v55;
          v58 = this;
          v59 = v57;
          v79 = v57;
          LODWORD(v60) = (*(int (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
          v91 = v49;
          KernelDebugLogInternal(
            1u,
            0x55534246u,
            (__int64)"%s::DeviceRequest - err (0x%x) setting buffer memory descriptor (%p) into buffer dmaCommand (%p)",
            v60,
            (unsigned int)v59,
            *(_QWORD *)(v9 + 8),
            v49);
LABEL_85:
          v43 = v78;
          v61 = v58;
          goto LABEL_54;
        }
      }
      else
      {
        v56 = 0LL;
        IOUSBCommand::SetSelector(v55, 5);
        IOUSBCommand::SetBuffer((IOUSBCommand *)v55, *(IOMemoryDescriptor **)(v9 + 8));
        if ( *(_QWORD *)(v9 + 8) )
        {
          LODWORD(v70) = (*(int (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
          KernelDebugLogInternal(
            1u,
            0x55534246u,
            (__int64)"%s::DeviceRequest - expected NULL request->pData (%p)",
            v70,
            *(_QWORD *)(v9 + 8),
            v71,
            v77);
        }
      }
      v91 = v49;
      IOUSBCommand::SetRequest(v55, v9);
      IOUSBCommand::SetAddress((IOUSBCommand *)v55, v85);
      IOUSBCommand::SetEndpoint((IOUSBCommand *)v55, v86);
      *(_DWORD *)(*(_QWORD *)(v55 + 216) + 72LL) = 0;
      IOUSBCommand::SetDirection((IOUSBCommand *)v55, 3);
      v72 = 0;
      IOUSBCommand::SetType((IOUSBCommand *)v55, 0);
      IOUSBCommand::SetClientCompletion(v55, *(_QWORD *)v88, *(_QWORD *)(v88 + 8), *(_QWORD *)(v88 + 16));
      IOUSBCommand::SetNoDataTimeout((IOUSBCommand *)v55, v87);
      IOUSBCommand::SetCompletionTimeout((IOUSBCommand *)v55, a7);
      IOUSBCommand::SetBufferUSBCommand((IOUSBCommand *)v55, v56);
      IOUSBCommand::SetUSLCompletion(v55, 0LL, 0LL, 0LL);
      IOUSBCommand::SetDisjointCompletion(v55, 0LL, 0LL, 0LL);
      IOUSBCommand::SetMultiTransferTransaction((IOUSBCommand *)v55, 0);
      IOUSBCommand::SetFinalTransferInTransaction((IOUSBCommand *)v55, 0);
      v73 = 0;
      do
        IOUSBCommand::SetUIMScratch((IOUSBCommand *)v55, v73++, 0);
      while ( v73 != 10 );
      do
        IOUSBCommand::SetUIMScratch64((IOUSBCommand *)v55, v72++, 0LL);
      while ( v72 != 5 );
      v84 = (IOUSBCommand *)v55;
      v16 = 0;
      v79 = (*(int (__fastcall **)(_QWORD, __int64 (__fastcall *)(uintptr_t, OSObject *, void *, void *, void *, void *), __int64, _QWORD, _QWORD, _QWORD))(**((_QWORD **)this + 18) + 456LL))(
              *((_QWORD *)this + 18),
              IOUSBController::DoControlTransfer,
              v55,
              0LL,
              0LL,
              0LL);
      if ( v79 )
      {
        v43 = v78;
        v61 = this;
      }
      else
      {
        v43 = v78;
        v61 = this;
        if ( (char *)v82 != (char *)IOUSBSyncCompletion )
          return (unsigned int)v16;
      }
      goto LABEL_54;
    }
  }
  return (unsigned int)v16;
}
// 8: using guessed type int dword_8;
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (0000000000006DA8) ----------------------------------------------------
void __fastcall IOUSBController::free(IOUSBController *this)
{
  IOUSBController *v1; // rbx@1
  __int64 v2; // rax@1
  uintptr_t v3; // r14@1
  __int64 v4; // rdi@5
  __int64 v5; // rdi@7
  __int64 v6; // rdi@9
  __int64 v7; // rax@11

  v1 = this;
  v2 = *((_QWORD *)this + 21);
  v3 = *(_DWORD *)(v2 + 224);
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
  {
    kernel_debug(0x52D00BCu, *(_DWORD *)(v2 + 224), 0LL, 0LL, 8uLL, 0LL);
    v2 = *((_QWORD *)this + 21);
  }
  if ( v2 )
  {
    v4 = *(_QWORD *)(v2 + 16);
    if ( v4 )
    {
      (*(void (**)(void))(*(_QWORD *)v4 + 40LL))();
      *(_QWORD *)(*((_QWORD *)v1 + 21) + 16LL) = 0LL;
    }
  }
  v5 = *((_QWORD *)v1 + 18);
  if ( v5 )
  {
    (*(void (**)(void))(*(_QWORD *)v5 + 40LL))();
    *((_QWORD *)v1 + 18) = 0LL;
  }
  v6 = *((_QWORD *)v1 + 17);
  if ( v6 )
  {
    (*(void (**)(void))(*(_QWORD *)v6 + 40LL))();
    *((_QWORD *)v1 + 17) = 0LL;
  }
  v7 = *((_QWORD *)v1 + 21);
  if ( v7 )
  {
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      kernel_debug(0x52D00BCu, v3, *((_QWORD *)v1 + 21), 0LL, 9uLL, 0LL);
      v7 = *((_QWORD *)v1 + 21);
    }
    IOFree(v7, 256LL);
    *((_QWORD *)v1 + 21) = 0LL;
  }
  if ( gUSBStackDebugFlags & 2 )
  {
    if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D00BCu, v3, 0LL, 0LL, 0xAuLL, 0LL);
  }
  JUMPOUT(__CS__, `vtable for'IOUSBBus[20]);
}
// 3B100: using guessed type __int64 off_3B100[2];
// 3B270: using guessed type __int64 `vtable for'IOUSBBus[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 7D218: using guessed type int __fastcall IOFree(_QWORD, _QWORD);

//----- (0000000000006EFA) ----------------------------------------------------
__int64 __fastcall IOUSBController::CreateRootHubDevice(IOUSBController *this, IOService *a2, IOUSBRootHubDevice **a3)
{
  IOUSBRootHubDevice **v3; // r13@1
  __int64 v4; // r15@1
  const OSMetaClassBase *v5; // r14@1
  int v6; // eax@4
  const OSMetaClass *v7; // rdx@4
  __int64 v8; // rbx@4
  __int64 v9; // rax@5
  __int64 v10; // r8@5
  __int64 v11; // r9@5
  int v12; // ecx@5
  uintptr_t v13; // r13@5
  uintptr_t v14; // rdx@7
  uintptr_t v15; // r8@7
  uintptr_t v16; // rsi@7
  __int64 v17; // rax@10
  unsigned int v18; // er14@11
  int v19; // ebx@13
  int v20; // er15@13
  unsigned __int16 v21; // ax@14
  unsigned int v22; // eax@15
  __int64 v23; // rax@16
  IOUSBController *v24; // rsi@16
  __int64 v25; // r8@16
  __int64 v26; // r9@16
  unsigned __int8 v27; // al@21
  unsigned __int8 v28; // r12@21
  __int64 v29; // rax@21
  IOService *v30; // r15@21
  unsigned __int8 v31; // al@22
  const char *v32; // rax@23
  OSMetaClassBase *v33; // rax@27
  const OSMetaClass *v34; // rdx@27
  unsigned __int8 v35; // al@28
  __int64 v36; // rax@29
  OSMetaClassBase *v37; // rax@29
  const OSMetaClass *v38; // rdx@29
  __int64 v39; // rbx@29
  __int64 v40; // rax@32
  int v41; // eax@33
  unsigned int v42; // er12@33
  __int64 v43; // rax@33
  int v44; // er13@34
  __int64 v45; // r13@35
  __int64 v46; // rax@37
  __int64 v47; // r9@37
  int v48; // eax@40
  int v49; // ecx@41
  uintptr_t v50; // r13@46
  __int64 v51; // r12@47
  __int64 v52; // rax@47
  __int64 v53; // r9@47
  int v54; // edx@58
  __int64 v55; // rdx@66
  IOService *v56; // r14@68
  unsigned int v57; // ebx@68
  __int64 v58; // rax@68
  int v59; // er15@69
  IOService *v60; // r13@72
  __int64 v61; // rax@72
  __int64 v62; // rdx@72
  IOService *v63; // r15@72
  uintptr_t v64; // rbx@72
  void (__fastcall *v65)(_QWORD, _QWORD, _QWORD); // r14@72
  __int64 v66; // rax@72
  uintptr_t v67; // rbx@72
  void (__fastcall *v68)(_QWORD, _QWORD, _QWORD); // r14@72
  __int64 v69; // rax@72
  IORegistryEntry *v70; // rdi@72
  uintptr_t v71; // rbx@72
  void (__fastcall *v72)(_QWORD, _QWORD, _QWORD); // r14@72
  __int64 v73; // rax@72
  __int64 v74; // rax@72
  __int64 v75; // rbx@72
  __int64 v76; // rax@74
  __int64 v77; // rbx@74
  __int64 v78; // rax@76
  __int64 v79; // rbx@76
  __int64 v80; // rax@78
  __int64 v81; // rbx@78
  __int64 v82; // rax@80
  __int64 v83; // rbx@80
  __int64 v84; // rax@82
  __int64 v85; // rbx@82
  __int64 v86; // rax@84
  __int64 v87; // rbx@84
  __int64 v88; // r14@87
  unsigned int v89; // ebx@87
  __int64 v90; // rbx@101
  __int64 v91; // rax@102
  __int64 v92; // rax@106
  __int64 v93; // rax@109
  __int64 v94; // rax@112
  uintptr_t v95; // rbx@117
  __int64 v96; // rax@117
  void (__fastcall *v97)(_QWORD, _QWORD); // r14@117
  int v98; // eax@117
  char v100; // [sp+0h] [bp-90h]@0
  unsigned int v101; // [sp+Ch] [bp-84h]@0
  const OSMetaClassBase *v102; // [sp+10h] [bp-80h]@9
  uintptr_t *v103; // [sp+18h] [bp-78h]@0
  __int64 v104; // [sp+20h] [bp-70h]@1
  unsigned __int8 v105; // [sp+28h] [bp-68h]@1
  uintptr_t v106; // [sp+28h] [bp-68h]@68
  uintptr_t arg1; // [sp+30h] [bp-60h]@1
  int v108; // [sp+38h] [bp-58h]@1
  int v109; // [sp+3Ch] [bp-54h]@1
  char v110; // [sp+40h] [bp-50h]@4
  unsigned __int8 v111; // [sp+47h] [bp-49h]@15
  char v112; // [sp+52h] [bp-3Eh]@86
  __int64 v113; // [sp+60h] [bp-30h]@1

  v3 = a3;
  arg1 = (uintptr_t)a2;
  v4 = off_3B0E0[0];
  v113 = *(_QWORD *)off_3B0E0[0];
  v109 = 0;
  v108 = 0;
  v5 = (const OSMetaClassBase *)*off_3B020[0];
  v104 = OSMetaClassBase::safeMetaCast(a2, (const OSMetaClassBase *)*off_3B020[0], (const OSMetaClass *)a3);
  v105 = *(_BYTE *)(*((_QWORD *)this + 21) + 40LL);
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D0015u, (uintptr_t)a2, 0LL, 0LL, 0LL, 0LL);
  v6 = (*(int (__fastcall **)(IOUSBController *, char *))(*(_QWORD *)this + 2256LL))(this, &v110);
  v8 = (unsigned int)v6;
  if ( v6 )
  {
    LODWORD(v9) = (*(int (__fastcall **)(IOUSBController *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
    KernelDebugLogInternal(
      1u,
      0x55534246u,
      (__int64)"%s::CreateRootHubDevice  unable to get root hub descriptor",
      v9,
      v10,
      v11,
      v100);
    v13 = (uintptr_t)this;
    if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
      goto LABEL_121;
    v14 = 0LL;
    v15 = 1LL;
    v16 = (uintptr_t)this;
LABEL_8:
    kernel_debug(0x52D0014u, v16, v14, 0LL, v15, 0LL);
    goto LABEL_121;
  }
  v102 = v5;
  if ( OSMetaClassBase::safeMetaCast(this, (const OSMetaClassBase *)IOUSBControllerV3::metaClass, v7)
    && (v17 = *((_QWORD *)this + 21), *(_BYTE *)(v17 + 40) == 3) )
  {
    v18 = 250;
    if ( !*(_QWORD *)(v17 + 216) )
      v18 = 450;
    v19 = (*(_QWORD *)(v17 + 216) != 0LL) | 0x80;
    v105 = (*(_QWORD *)(v17 + 216) == 0LL) | 2;
    v20 = (v19 << 8) | v105;
  }
  else
  {
    v21 = IOUSBController::GetNewAddress((uintptr_t)this);
    v20 = v21;
    v18 = 250;
    v19 = v21;
  }
  v103 = (uintptr_t *)v3;
  *v3 = (IOUSBRootHubDevice *)IOUSBRootHubDevice::NewRootHubDevice(this, IOUSBControllerV3::metaClass);
  (*(void (__fastcall **)(IOUSBController *, _QWORD))(*(_QWORD *)this + 2344LL))(this, (unsigned int)v20);
  v22 = IOUSBController::CreateDevice(this, *v3, v19, v111, v105, v18);
  v8 = v22;
  if ( !v22 )
  {
    v101 = v18;
    IOLockLock(qword_49A60);
    if ( v104 )
    {
      v27 = (*(int (__fastcall **)(__int64))(*(_QWORD *)v104 + 2288LL))(v104);
      v28 = v27;
      v109 = v27;
      v29 = *(_QWORD *)v104;
      v30 = a2;
      if ( *(_BYTE *)(*((_QWORD *)this + 21) + 236LL) )
        v31 = (*(int (__fastcall **)(__int64))(v29 + 2280))(v104);
      else
        v31 = (*(int (__fastcall **)(__int64))(v29 + 2296))(v104);
      v108 = v31;
      if ( !(v31 | v28) )
      {
        LODWORD(v33) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v104 + 792LL))(v104, *(_QWORD *)off_3B0E8[0]);
        if ( OSMetaClassBase::safeMetaCast(v33, v102, v34) )
        {
          v109 = (unsigned __int8)(*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v104 + 2288LL))(
                                    v104,
                                    v102);
          v35 = (*(int (__fastcall **)(__int64))(*(_QWORD *)v104 + 2296LL))(v104);
        }
        else
        {
          LODWORD(v36) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v104 + 792LL))(
                           v104,
                           *(_QWORD *)off_3B0E8[0]);
          LODWORD(v37) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v36 + 792LL))(v36, *(_QWORD *)off_3B0E8[0]);
          v39 = OSMetaClassBase::safeMetaCast(v37, v102, v38);
          if ( !v39 )
            goto LABEL_32;
          v109 = (unsigned __int8)(*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v39 + 2288LL))(
                                    v39,
                                    v102);
          v35 = (*(int (__fastcall **)(__int64))(*(_QWORD *)v39 + 2280LL))(v39);
        }
        v108 = v35;
      }
    }
    else
    {
      v30 = a2;
      LODWORD(v32) = (*(int (__fastcall **)(IOService *, _QWORD))(*(_QWORD *)a2 + 952LL))(a2, 0LL);
      if ( v32 )
        IOUSBController::ParsePCILocation(a2, v32, &v109, &v108);
    }
LABEL_32:
    LODWORD(v104) = v105;
    LODWORD(v40) = (*(int (__fastcall **)(IOService *, _QWORD))(*(_QWORD *)v30 + 696LL))(v30, "USBBusNumber");
    if ( v40 )
    {
      v41 = (*(int (__fastcall **)(__int64))(*(_QWORD *)v40 + 328LL))(v40);
      v42 = v41;
      v43 = 2 * (v41 & 0x7Fu);
      v8 = (unsigned int)(v43 + 1);
    }
    else
    {
      v44 = 32 * (v108 & 7);
      if ( *(_BYTE *)(*((_QWORD *)this + 21) + 40LL) == 3 )
      {
        v45 = v109 & 0x1E | (unsigned int)v44;
        v42 = (unsigned int)v45 >> 1;
        v8 = (unsigned int)v45 | 1;
        if ( *((_BYTE *)&IOUSBController::gUsedBusIDs + v45) || *((_BYTE *)&IOUSBController::gUsedBusIDs + v8) )
        {
          LODWORD(v46) = (*(int (__fastcall **)(IOUSBController *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
          KernelDebugLogInternal(
            1u,
            0x55534246u,
            (__int64)"%s::CreateRootHubDevice  Bus %d already taken",
            v46,
            v42,
            v47,
            v100);
          if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
            kernel_debug(0x52D0014u, (uintptr_t)this, (unsigned int)v45 >> 1, 0LL, 3uLL, 0LL);
          v48 = v42 + 1;
          if ( v42 + 1 <= 0x7F )
          {
            v49 = (unsigned __int8)(v45 & 0xFE) + 2;
            while ( 1 )
            {
              v45 = (unsigned __int8)v49 & 0xFE;
              v8 = (unsigned int)(v45 + 1);
              if ( !*((_BYTE *)&IOUSBController::gUsedBusIDs + v45) && !*((_BYTE *)&IOUSBController::gUsedBusIDs + v8) )
                break;
              ++v48;
              LOBYTE(v49) = v49 + 2;
              if ( v48 >= 128 )
                goto LABEL_56;
            }
            v42 = v48;
          }
LABEL_56:
          if ( v48 == 128 )
          {
            v12 = v42 - 1;
            if ( ((v42 - 1) & 0x80000000) == 0 )
            {
              v54 = 2 * v42 - 2;
              v13 = (uintptr_t)this;
              while ( 1 )
              {
                v43 = (unsigned __int8)v54 & 0xFE;
                v8 = (unsigned int)(v43 + 1);
                if ( !*((_BYTE *)&IOUSBController::gUsedBusIDs + v43) && !*((_BYTE *)&IOUSBController::gUsedBusIDs + v8) )
                  goto LABEL_126;
                LOBYTE(v54) = v54 - 2;
                --v12;
                if ( v12 < 0 )
                  goto LABEL_64;
              }
            }
          }
        }
        v43 = (unsigned int)v45;
        v13 = (uintptr_t)this;
        goto LABEL_64;
      }
      v50 = v109 & 0x1F | (unsigned int)v44;
      v43 = 0LL;
      if ( *((_BYTE *)&IOUSBController::gUsedBusIDs + v50) )
      {
        v51 = 0LL;
        LODWORD(v52) = (*(int (__fastcall **)(IOUSBController *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
        KernelDebugLogInternal(
          1u,
          0x55534246u,
          (__int64)"%s::CreateRootHubDevice  Bus %d already taken",
          v52,
          (unsigned int)v50,
          v53,
          v100);
        if ( gUSBStackDebugFlags & 2 )
        {
          v51 = 0LL;
          if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          {
            v51 = 0LL;
            kernel_debug(0x52D0014u, (uintptr_t)this, v50, 0LL, 3uLL, 0LL);
          }
        }
        while ( *((_BYTE *)&IOUSBController::gUsedBusIDs + v51 + 255) )
        {
          --v51;
          v43 = 0LL;
          if ( (signed int)v51 + 256 <= 0 )
            goto LABEL_52;
        }
        v42 = v51 + 255;
        v43 = 0LL;
        v8 = 0LL;
      }
      else
      {
LABEL_52:
        v8 = 0LL;
        v42 = v50;
      }
    }
    v13 = (uintptr_t)this;
    goto LABEL_65;
  }
  LODWORD(v23) = (*(int (__fastcall **)(IOUSBController *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
  v24 = (IOUSBController *)1431519814;
  KernelDebugLogInternal(
    1u,
    0x55534246u,
    (__int64)"%s::CreateRootHubDevice  unable to create and initialize root hub device",
    v23,
    v25,
    v26,
    v100);
  v13 = (uintptr_t)this;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
  {
    v24 = this;
    kernel_debug(0x52D0014u, (uintptr_t)this, *v103, 0LL, 2uLL, 0LL);
  }
  (*(void (__fastcall **)(uintptr_t, IOUSBController *))(*(_QWORD *)*v103 + 40LL))(*v103, v24);
  *v103 = 0LL;
  v4 = off_3B0E0[0];
  while ( 1 )
  {
LABEL_121:
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D0016u, v13, (signed int)v8, 0LL, 0LL, 0LL);
    v43 = *(_QWORD *)v4;
    if ( *(_QWORD *)v4 == v113 )
      return (unsigned int)v8;
LABEL_126:
    v42 = v12;
LABEL_64:
    v30 = (IOService *)arg1;
LABEL_65:
    if ( *(_BYTE *)(*(_QWORD *)(v13 + 168) + 40LL) == 3 )
    {
      *((_BYTE *)&IOUSBController::gUsedBusIDs + v8) = 1;
      *((_BYTE *)&IOUSBController::gUsedBusIDs + v43) = 1;
      v55 = v42;
    }
    else
    {
      v55 = v42;
      *((_BYTE *)&IOUSBController::gUsedBusIDs + v42) = 1;
    }
    v56 = v30;
    (*(void (__fastcall **)(IOService *, _QWORD, __int64, signed __int64))(*(_QWORD *)v30 + 640LL))(
      v30,
      "USBBusNumber",
      v55,
      32LL);
    v57 = v42 << 25;
    v58 = *(_QWORD *)(v13 + 168);
    v106 = v13;
    if ( *(_BYTE *)(v58 + 40) == 3 )
    {
      v59 = v42 << 25;
      if ( (_DWORD)v104 == 3 )
      {
        v59 = v57 | 0x1000000;
        *(_DWORD *)(v58 + 248) = v57 | 0x1000000;
      }
    }
    else
    {
      v59 = v42 << 24;
    }
    v60 = v56;
    (*(void (__fastcall **)(IOService *, _QWORD, _QWORD, signed __int64))(*(_QWORD *)v56 + 640LL))(
      v56,
      "locationID",
      v57,
      32LL);
    v61 = *(_QWORD *)(v106 + 168);
    *(_DWORD *)(v61 + 28) = v42;
    *(_DWORD *)(v61 + 224) = v57;
    IOLockUnlock(qword_49A60);
    v62 = (unsigned int)v59;
    v63 = v56;
    (*(void (__fastcall **)(uintptr_t, _QWORD, __int64, signed __int64))(*(_QWORD *)*v103 + 640LL))(
      *v103,
      "locationID",
      v62,
      32LL);
    v64 = *v103;
    v65 = *(void (__fastcall **)(_QWORD, _QWORD, _QWORD))(*(_QWORD *)*v103 + 976LL);
    LODWORD(v66) = (*(int (__fastcall **)(IOService *, _QWORD))(*(_QWORD *)v63 + 952LL))(v63, 0LL);
    v65(v64, v66, 0LL);
    v67 = *v103;
    v68 = *(void (__fastcall **)(_QWORD, _QWORD, _QWORD))(*(_QWORD *)*v103 + 976LL);
    LODWORD(v69) = (*(int (__fastcall **)(IOService *, _QWORD))(*(_QWORD *)v63 + 952LL))(v63, 0LL);
    v70 = (IORegistryEntry *)v67;
    v68(v67, v69, IOUSBController::gIOUSBPlane);
    v71 = *v103;
    v72 = *(void (__fastcall **)(_QWORD, _QWORD, _QWORD))(*(_QWORD *)*v103 + 856LL);
    v73 = IORegistryEntry::getRegistryRoot(v70);
    v72(v71, v73, IOUSBController::gIOUSBPlane);
    LODWORD(v74) = (*(int (__fastcall **)(IOService *, _QWORD))(*(_QWORD *)v63 + 744LL))(v63, "AAPL,current-available");
    v75 = v74;
    if ( v74 )
    {
      (*(void (__fastcall **)(uintptr_t, _QWORD, __int64))(*(_QWORD *)*v103 + 616LL))(
        *v103,
        "AAPL,current-available",
        v74);
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v75 + 40LL))(v75);
    }
    LODWORD(v76) = (*(int (__fastcall **)(IOService *, _QWORD))(*(_QWORD *)v60 + 744LL))(v60, "AAPL,current-extra");
    v77 = v76;
    if ( v76 )
    {
      (*(void (__fastcall **)(uintptr_t, _QWORD, __int64))(*(_QWORD *)*v103 + 616LL))(*v103, "AAPL,current-extra", v76);
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v77 + 40LL))(v77);
    }
    LODWORD(v78) = (*(int (__fastcall **)(IOService *, _QWORD))(*(_QWORD *)v60 + 744LL))(
                     v60,
                     "AAPL,max-port-current-in-sleep");
    v79 = v78;
    v13 = v106;
    if ( v78 )
    {
      (*(void (__fastcall **)(uintptr_t, _QWORD, __int64))(*(_QWORD *)*v103 + 616LL))(
        *v103,
        "AAPL,max-port-current-in-sleep",
        v78);
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v79 + 40LL))(v79);
    }
    LODWORD(v80) = (*(int (__fastcall **)(IOService *, _QWORD))(*(_QWORD *)v63 + 744LL))(
                     v63,
                     "AAPL,current-extra-in-sleep");
    v81 = v80;
    if ( v80 )
    {
      (*(void (__fastcall **)(uintptr_t, _QWORD, __int64))(*(_QWORD *)*v103 + 616LL))(
        *v103,
        "AAPL,current-extra-in-sleep",
        v80);
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v81 + 40LL))(v81);
    }
    LODWORD(v82) = (*(int (__fastcall **)(IOService *, _QWORD))(*(_QWORD *)v63 + 744LL))(v63, "AAPL,device-internal");
    v83 = v82;
    if ( v82 )
    {
      (*(void (__fastcall **)(uintptr_t, _QWORD, __int64))(*(_QWORD *)*v103 + 616LL))(
        *v103,
        "AAPL,device-internal",
        v82);
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v83 + 40LL))(v83);
    }
    LODWORD(v84) = (*(int (__fastcall **)(IOService *, _QWORD))(*(_QWORD *)v63 + 744LL))(
                     v63,
                     "AAPL,max-port-current-in-sleep");
    v85 = v84;
    if ( v84 )
    {
      (*(void (__fastcall **)(uintptr_t, _QWORD, __int64))(*(_QWORD *)*v103 + 616LL))(
        *v103,
        "AAPL,max-port-current-in-sleep",
        v84);
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v85 + 40LL))(v85);
    }
    LODWORD(v86) = (*(int (__fastcall **)(IOService *, _QWORD))(*(_QWORD *)v63 + 744LL))(
                     v63,
                     "AAPL,current-extra-in-sleep");
    v87 = v86;
    if ( v86 )
    {
      (*(void (__fastcall **)(uintptr_t, _QWORD, __int64))(*(_QWORD *)*v103 + 616LL))(
        *v103,
        "AAPL,current-extra-in-sleep",
        v86);
      (*(void (__fastcall **)(uintptr_t, _QWORD, _QWORD, signed __int64))(*(_QWORD *)*v103 + 640LL))(
        *v103,
        "AAPL,standard-port-current-in-sleep",
        2 * v101,
        32LL);
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v87 + 40LL))(v87);
      (*(void (__fastcall **)(uintptr_t, _QWORD, _QWORD))(*(_QWORD *)v106 + 616LL))(
        v106,
        "UpdatedSleepPropertiesExists",
        **(_QWORD **)off_3B0F8[0]);
    }
    else
    {
      v101 *= 2;
      if ( PEGetModelName(&v112, 14LL) )
      {
        v88 = (__int64)gSleepCurrentInfo;
        v89 = 0;
        while ( strncmp(&v112, (const char *)v88, 0xEuLL) )
        {
          v88 += 32LL;
          ++v89;
          if ( v89 > 0x1F )
            goto LABEL_99;
        }
        (*(void (__fastcall **)(uintptr_t, _QWORD, _QWORD, signed __int64))(*(_QWORD *)*v103 + 640LL))(
          *v103,
          "AAPL,standard-port-current-in-sleep",
          v101,
          32LL);
        if ( *(_DWORD *)(v88 + 16) )
          (*(void (__fastcall **)(uintptr_t, _QWORD, _QWORD, signed __int64))(*(_QWORD *)*v103 + 640LL))(
            *v103,
            "AAPL,current-extra",
            *(_DWORD *)(v88 + 16),
            32LL);
        if ( *(_DWORD *)(v88 + 20) )
          (*(void (__fastcall **)(uintptr_t, _QWORD, _QWORD, signed __int64))(*(_QWORD *)*v103 + 640LL))(
            *v103,
            "AAPL,current-available",
            *(_DWORD *)(v88 + 20),
            32LL);
        if ( *(_DWORD *)(v88 + 24) )
          (*(void (__fastcall **)(uintptr_t, _QWORD, _QWORD, signed __int64))(*(_QWORD *)*v103 + 640LL))(
            *v103,
            "AAPL,current-extra-in-sleep",
            *(_DWORD *)(v88 + 24),
            32LL);
        if ( *(_DWORD *)(v88 + 28) )
          (*(void (__fastcall **)(uintptr_t, _QWORD, _QWORD, signed __int64))(*(_QWORD *)*v103 + 640LL))(
            *v103,
            "AAPL,max-port-current-in-sleep",
            *(_DWORD *)(v88 + 28),
            32LL);
      }
    }
LABEL_99:
    v4 = off_3B0E0[0];
    if ( !*(_BYTE *)(*(_QWORD *)(v106 + 168) + 244LL)
      && (unsigned __int8)OSCompareAndSwap(0LL, 1LL, &IOUSBController::gExtraCurrentPropertiesInitialized) )
    {
      v90 = IOService::getResourceService(0LL);
      if ( v90 )
      {
        LODWORD(v91) = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)*v103 + 696LL))(
                         *v103,
                         "AAPL,current-extra");
        if ( v91 )
          (*(void (__fastcall **)(__int64, _QWORD, __int64))(*(_QWORD *)v90 + 616LL))(v90, "AAPL,current-extra", v91);
        else
          LODWORD(IOUSBController::gExtraCurrentPropertiesInitialized) = 0;
        LODWORD(v92) = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)*v103 + 696LL))(
                         *v103,
                         "AAPL,current-available");
        if ( v92 )
          (*(void (__fastcall **)(__int64, _QWORD, __int64))(*(_QWORD *)v90 + 616LL))(
            v90,
            "AAPL,current-available",
            v92);
        else
          LODWORD(IOUSBController::gExtraCurrentPropertiesInitialized) = 0;
        LODWORD(v93) = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)*v103 + 696LL))(
                         *v103,
                         "AAPL,max-port-current-in-sleep");
        if ( v93 )
          (*(void (__fastcall **)(__int64, _QWORD, __int64))(*(_QWORD *)v90 + 616LL))(
            v90,
            "AAPL,max-port-current-in-sleep",
            v93);
        else
          LODWORD(IOUSBController::gExtraCurrentPropertiesInitialized) = 0;
        LODWORD(v94) = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)*v103 + 696LL))(
                         *v103,
                         "AAPL,current-extra-in-sleep");
        if ( v94 )
          (*(void (__fastcall **)(_QWORD, _QWORD, __int64))(*(_QWORD *)v90 + 616LL))(
            v90,
            "AAPL,current-extra-in-sleep",
            v94);
        else
          LODWORD(IOUSBController::gExtraCurrentPropertiesInitialized) = 0;
        (*(void (__fastcall **)(__int64, _QWORD, _QWORD, signed __int64))(*(_QWORD *)v90 + 640LL))(
          v90,
          "AAPL,UnconnectedSSPorts",
          0LL,
          32LL);
        (*(void (__fastcall **)(__int64, _QWORD, _QWORD, signed __int64))(*(_QWORD *)v90 + 640LL))(
          v90,
          "AAPL,ExternalSSPorts",
          0LL,
          32LL);
        (*(void (__fastcall **)(__int64, _QWORD, _QWORD, signed __int64))(*(_QWORD *)v90 + 640LL))(
          v90,
          "AAPL,revocable-extra-current",
          0LL,
          32LL);
      }
      else
      {
        LODWORD(IOUSBController::gExtraCurrentPropertiesInitialized) = 0;
      }
    }
    if ( *(_BYTE *)(*(_QWORD *)(v106 + 168) + 200LL) )
    {
      v95 = *v103;
      v96 = *(_QWORD *)*v103;
      v97 = *(void (__fastcall **)(_QWORD, _QWORD))(v96 + 2592);
      v98 = (*(int (__fastcall **)(uintptr_t))(v96 + 2616))(*v103);
      v97(v95, v98 | 4u);
      v8 = 0LL;
    }
    else
    {
      v8 = 0LL;
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        v8 = 0LL;
        v15 = 0LL;
        v16 = v106;
        v14 = (uintptr_t)v103;
        goto LABEL_8;
      }
    }
  }
}
// 3B020: using guessed type _QWORD *off_3B020[7];
// 3B0E0: using guessed type __int64 off_3B0E0[6];
// 3B0E8: using guessed type __int64 off_3B0E8[5];
// 3B0F8: using guessed type __int64 off_3B0F8[3];
// 3B100: using guessed type __int64 off_3B100[2];
// 44350: using guessed type _QWORD IOUSBControllerV3::metaClass;
// 49460: using guessed type int gUSBStackDebugFlags;
// 49470: using guessed type _QWORD IOUSBController::gIOUSBPlane;
// 49480: using guessed type _QWORD IOUSBController::gUsedBusIDs;
// 49580: using guessed type _QWORD IOUSBController::gExtraCurrentPropertiesInitialized;
// 49A60: using guessed type __int64 qword_49A60;
// 7D230: using guessed type int __fastcall IOLockLock(_QWORD);
// 7D238: using guessed type int __fastcall IOLockUnlock(_QWORD);
// 7D288: using guessed type int __fastcall OSCompareAndSwap(_QWORD, _QWORD, _QWORD);
// 7D2A0: using guessed type int __fastcall PEGetModelName(_QWORD, _QWORD);
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000007B5E) ----------------------------------------------------
signed __int64 IOUSBController::UIMCreateIsochTransfer()
{
  return 3758097095LL;
}

//----- (0000000000007B6A) ----------------------------------------------------
int __fastcall IOUSBController::UIMCreateIsochTransfer(IOUSBController *this, IOUSBIsocCommand *a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  unsigned __int8 v6; // r13@1
  __int64 v7; // rax@1
  __int64 v8; // ST90_8@1
  __int64 v9; // ST88_8@1
  __int64 v10; // ST80_8@1
  __int64 v11; // r15@1
  int v12; // er14@1
  __int64 v13; // rax@1
  int (__fastcall *v14)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD); // rax@4
  char v16; // [sp+0h] [bp-C0h]@0
  __int16 v17; // [sp+3Ah] [bp-86h]@1
  unsigned __int16 v18; // [sp+3Ch] [bp-84h]@1
  __int64 v19; // [sp+40h] [bp-80h]@1
  __int64 v20; // [sp+48h] [bp-78h]@1

  v6 = *((_BYTE *)a2 + 39);
  v17 = *((_WORD *)a2 + 18);
  v18 = *((_BYTE *)a2 + 38);
  v7 = *((_QWORD *)a2 + 13);
  v8 = *(_QWORD *)(v7 + 48);
  v9 = *(_QWORD *)(v7 + 40);
  v10 = *(_QWORD *)(v7 + 32);
  v20 = *((_QWORD *)a2 + 5);
  v19 = *((_QWORD *)a2 + 9);
  v11 = *((_QWORD *)a2 + 11);
  v12 = *(_DWORD *)v7;
  KernelDebugLogInternal(
    1u,
    0x55534246u,
    (__int64)"IOUSBController::UIMCreateIsochTransfer - shouldn't be here",
    *((_DWORD *)a2 + 20),
    a5,
    a6,
    v16);
  v13 = *((_QWORD *)a2 + 13);
  if ( *(_BYTE *)(v13 + 17) )
    v6 |= 0x80u;
  if ( *(_BYTE *)(v13 + 56) )
    v14 = *(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 2608LL);
  else
    v14 = *(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 2216LL);
  return v14(this, (unsigned int)v17, v18, v6, v19, v20);
}

//----- (0000000000007CC8) ----------------------------------------------------
OSMetaClassBase *__fastcall IOUSBController::CopyACPIDevice(IOUSBController *this, IORegistryEntry *a2)
{
  __int64 v2; // rbx@1
  OSMetaClassBase *v3; // rax@2
  const OSMetaClass *v4; // rdx@2
  OSMetaClassBase *v5; // r14@2
  __int64 v6; // rsi@3
  __int64 v7; // rax@4
  OSMetaClassBase *v8; // rax@4
  OSMetaClassBase *v9; // r15@4
  __int64 v10; // rax@7
  OSMetaClassBase *v11; // rdi@7

  v2 = 0LL;
  if ( a2 )
  {
    LODWORD(v3) = (*(int (__fastcall **)(IORegistryEntry *, _QWORD))(*(_QWORD *)a2 + 744LL))(a2, "acpi-path");
    v5 = v3;
    v2 = 0LL;
    if ( v3 )
    {
      v6 = *(_QWORD *)off_3B088[0];
      if ( !OSMetaClassBase::safeMetaCast(v3, *(const OSMetaClassBase **)off_3B088[0], v4) )
      {
        v10 = *(_QWORD *)v5;
        v11 = v5;
        goto LABEL_9;
      }
      LODWORD(v7) = (*(int (__fastcall **)(OSMetaClassBase *, __int64))(*(_QWORD *)v5 + 328LL))(v5, v6);
      v2 = 0LL;
      LODWORD(v8) = IORegistryEntry::fromPath(v7, 0LL, 0LL, 0LL, 0LL);
      v9 = v8;
      (*(void (__fastcall **)(OSMetaClassBase *))(*(_QWORD *)v5 + 40LL))(v5);
      if ( v9 )
      {
        v6 = (__int64)"IOACPIPlatformDevice";
        if ( OSMetaClassBase::metaCast(v9, "IOACPIPlatformDevice") )
          return v9;
        v10 = *(_QWORD *)v9;
        v11 = v9;
LABEL_9:
        (*(void (__fastcall **)(OSMetaClassBase *, __int64))(v10 + 40))(v11, v6);
        return 0LL;
      }
    }
  }
  return (OSMetaClassBase *)v2;
}
// 3B088: using guessed type _QWORD off_3B088[17];
// 7D800: using guessed type int __fastcall IORegistryEntry::fromPath(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD);
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000007D7E) ----------------------------------------------------
__int64 __fastcall DecodeUSBConnectorType(signed int a1)
{
  __int64 result; // rax@2

  if ( a1 > 254 )
  {
    if ( a1 == 255 )
      result = (__int64)"Proprietary connector";
    else
LABEL_6:
      result = (__int64)"Unknown/Reserved connector";
  }
  else
  {
    result = (__int64)"Type A connector";
    switch ( a1 )
    {
      case 1:
        result = (__int64)"Mini-AB connector";
        break;
      case 0:
        return result;
      case 2:
        result = (__int64)"ExpressCard";
        break;
      case 3:
        result = (__int64)"USB 3 Standard-A connector";
        break;
      case 4:
        result = (__int64)"USB 3 Standard-B connector";
        break;
      case 5:
        result = (__int64)"USB 3 Micro-B connector";
        break;
      case 6:
        result = (__int64)"USB 3 Micro-AB connector";
        break;
      case 7:
        result = (__int64)"USB 3 Power-B connector";
        break;
      default:
        goto LABEL_6;
    }
  }
  return result;
}

//----- (0000000000007E20) ----------------------------------------------------
__int64 __fastcall IOUSBController::calculateUSBDepth(IOUSBController *this, unsigned int a2)
{
  unsigned int v2; // edx@1
  __int64 result; // rax@3
  signed int v4; // ecx@3

  v2 = a2 & 0xFEFFFFFF;
  if ( *(_BYTE *)(*((_QWORD *)this + 21) + 40LL) != 3 )
    v2 = a2;
  result = 0LL;
  v4 = 20;
  do
  {
    if ( !((15 << v4) & v2) )
      break;
    result = (unsigned int)(result + 1);
    v4 -= 4;
  }
  while ( v4 >= 0 );
  return result;
}

//----- (0000000000007E58) ----------------------------------------------------
__int64 __fastcall IOUSBController::calculateACPIDepth(IOUSBController *this, int a2)
{
  __int64 v2; // r14@1
  int v3; // ebx@1
  __int64 result; // rax@11
  char v5; // [sp+Ah] [bp-26h]@4
  __int64 v6; // [sp+18h] [bp-18h]@1

  v2 = off_3B0E0[0];
  v6 = *(_QWORD *)off_3B0E0[0];
  v3 = *(_DWORD *)(*((_QWORD *)this + 21) + 240LL);
  if ( !v3 )
  {
    if ( a2 )
    {
      v3 = 2 * a2 + 6;
    }
    else
    {
      v3 = 7;
      if ( PEGetModelName(&v5, 14LL)
        && (!strncmp(&v5, "MacBookPro8,1", 0xDuLL)
         || !strncmp(&v5, "MacBookPro8,2", 0xDuLL)
         || !strncmp(&v5, "MacBookPro8,3", 0xDuLL)
         || !strncmp(&v5, "iMac12,1", 8uLL)
         || !strncmp(&v5, "iMac12,2", 8uLL)) )
        v3 = 6;
    }
  }
  result = *(_QWORD *)v2;
  if ( *(_QWORD *)v2 == v6 )
    result = (unsigned int)v3;
  return result;
}
// 3B0E0: using guessed type __int64 off_3B0E0[6];
// 7D2A0: using guessed type int __fastcall PEGetModelName(_QWORD, _QWORD);

//----- (0000000000007F4A) ----------------------------------------------------
char __fastcall IOUSBController::HasExpressCard(IOUSBController *this, IORegistryEntry *a2, unsigned int *a3)
{
  unsigned int *v3; // r12@1
  __int64 v4; // r14@1
  __int64 v5; // rax@2
  __int64 v6; // r15@2
  __int64 v7; // rax@3
  __int64 v8; // rbx@3
  char v9; // r12@4
  OSMetaClassBase *v10; // rax@5
  OSMetaClassBase *v11; // r14@5
  const char *v12; // rax@9
  const char *v13; // rax@13
  unsigned int v14; // er14@13
  const OSMetaClassBase *v15; // rsi@13
  const OSMetaClass *v16; // rdx@13
  __int64 v17; // rax@13
  OSMetaClassBase *v18; // rax@14
  const OSMetaClass *v19; // rdx@14
  __int64 v20; // rax@14
  __int64 v21; // rax@21
  const OSMetaClassBase *v23; // [sp+8h] [bp-158h]@4
  const OSMetaClassBase *v24; // [sp+10h] [bp-150h]@4
  unsigned int *v25; // [sp+18h] [bp-148h]@4
  OSMetaClassBase *v26; // [sp+20h] [bp-140h]@12
  int v27; // [sp+2Ch] [bp-134h]@7
  char v28; // [sp+30h] [bp-130h]@8
  __int64 v29; // [sp+130h] [bp-30h]@1

  v3 = a3;
  v4 = off_3B0E0[0];
  v29 = *(_QWORD *)off_3B0E0[0];
  if ( a2
    && (v5 = IORegistryEntry::getPlane("IOACPIPlane", (const char *)a2), (v6 = v5) != 0)
    && (LODWORD(v7) = IORegistryIterator::iterateOver(a2, v5, 1LL), (v8 = v7) != 0) )
  {
    v25 = v3;
    v24 = *(const OSMetaClassBase **)off_3B070[0];
    v23 = *(const OSMetaClassBase **)off_3B078[0];
    v9 = 0;
    while ( 1 )
    {
      LODWORD(v10) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v8 + 296LL))(v8);
      v11 = v10;
      if ( !v10 )
        break;
      if ( OSMetaClassBase::metaCast(v10, "IOACPIPlatformDevice") )
      {
        v27 = 254;
        if ( !(*(int (__fastcall **)(OSMetaClassBase *, _QWORD))(*(_QWORD *)v11 + 2224LL))(v11, "_EJD") )
        {
          (*(void (__fastcall **)(OSMetaClassBase *, char *, int *, __int64))(*(_QWORD *)v11 + 984LL))(
            v11,
            &v28,
            &v27,
            v6);
          v9 = 1;
          if ( v25 )
          {
            LODWORD(v12) = (*(int (__fastcall **)(OSMetaClassBase *, _QWORD))(*(_QWORD *)v11 + 952LL))(v11, 0LL);
            *v25 = strtoul(v12, 0LL, 16);
          }
        }
        if ( !(*(int (__fastcall **)(OSMetaClassBase *, _QWORD))(*(_QWORD *)v11 + 2224LL))(v11, "_UPC") && !(v9 & 1) )
        {
          v27 = 254;
          (*(void (__fastcall **)(OSMetaClassBase *, char *, int *, __int64))(*(_QWORD *)v11 + 984LL))(
            v11,
            &v28,
            &v27,
            v6);
          if ( !(*(int (__fastcall **)(OSMetaClassBase *, _QWORD, __int64 *, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v11 + 2240LL))(
                  v11,
                  "_UPC",
                  &v26,
                  0LL,
                  0LL,
                  0LL) )
          {
            LODWORD(v13) = (*(int (__fastcall **)(OSMetaClassBase *, __int64))(*(_QWORD *)v11 + 952LL))(v11, v6);
            v14 = strtoul(v13, 0LL, 16);
            v15 = v24;
            v17 = OSMetaClassBase::safeMetaCast(v26, v24, v16);
            if ( v17 )
            {
              LODWORD(v18) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v17 + 488LL))(v17, 1LL);
              v15 = v23;
              v20 = OSMetaClassBase::safeMetaCast(v18, v23, v19);
              if ( v20 )
              {
                if ( (unsigned __int8)(*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v20 + 312LL))(
                                        v20,
                                        v23) == 2 )
                {
                  *v25 = v14;
                  v9 = 1;
                }
              }
            }
            (*(void (__fastcall **)(OSMetaClassBase *, const OSMetaClassBase *))(*(_QWORD *)v26 + 40LL))(v26, v15);
          }
        }
        if ( v9 & 1 )
          break;
      }
    }
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v8 + 40LL))(v8);
    v4 = off_3B0E0[0];
  }
  else
  {
    v9 = 0;
  }
  v21 = *(_QWORD *)v4;
  if ( *(_QWORD *)v4 == v29 )
    LOBYTE(v21) = v9 & 1;
  return v21;
}
// 3B070: using guessed type _QWORD off_3B070[20];
// 3B078: using guessed type _QWORD off_3B078[19];
// 3B0E0: using guessed type __int64 off_3B0E0[6];
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);
// 7D870: using guessed type int __fastcall IORegistryIterator::iterateOver(_QWORD, _QWORD, _QWORD);

//----- (00000000000081C6) ----------------------------------------------------
char __fastcall IOUSBController::DumpUSBACPI(IOUSBController *this, IORegistryEntry *a2)
{
  __int64 v2; // r13@1
  OSMetaClassBase *v3; // r12@1
  unsigned __int64 v4; // r14@1
  const OSMetaClassBase *v5; // rax@2
  const OSMetaClassBase *v6; // r15@2
  const OSMetaClassBase *v7; // rsi@3
  __int64 v8; // rax@3
  __int64 v9; // rbx@3
  OSMetaClassBase *v10; // rax@5
  OSMetaClassBase *v11; // r15@5
  const char *v12; // rax@8
  int v13; // ST08_4@10
  const char *v14; // rax@10
  const OSMetaClass *v15; // rdx@10
  unsigned int v16; // er13@10
  const OSMetaClass *v17; // rdx@13
  __int64 v18; // r14@15
  unsigned int v19; // er13@16
  OSMetaClassBase *v20; // rax@17
  const OSMetaClass *v21; // rdx@17
  __int64 v22; // rax@17
  char v23; // al@18
  bool v24; // zf@19
  unsigned __int64 v25; // rax@19
  __int64 v26; // rax@26
  unsigned int v28; // [sp+8h] [bp-178h]@16
  const OSMetaClassBase *v29; // [sp+10h] [bp-170h]@4
  const OSMetaClassBase *v30; // [sp+18h] [bp-168h]@4
  const OSMetaClassBase *v31; // [sp+20h] [bp-160h]@4
  unsigned __int64 v32; // [sp+28h] [bp-158h]@10
  const OSMetaClassBase *v33; // [sp+30h] [bp-150h]@4
  OSMetaClassBase *v34; // [sp+38h] [bp-148h]@13
  OSMetaClassBase *v35; // [sp+40h] [bp-140h]@10
  int v36; // [sp+48h] [bp-138h]@7
  int v37; // [sp+4Ch] [bp-134h]@2
  char v38; // [sp+50h] [bp-130h]@8
  __int64 v39; // [sp+150h] [bp-30h]@1

  v2 = off_3B0E0[0];
  v39 = *(_QWORD *)off_3B0E0[0];
  v3 = IOUSBController::CopyACPIDevice(this, a2);
  LODWORD(v4) = 0;
  if ( v3 )
  {
    v37 = 0;
    (*(void (__fastcall **)(OSMetaClassBase *, _QWORD, int *, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v3 + 2256LL))(
      v3,
      "XHCN",
      &v37,
      0LL,
      0LL,
      0LL);
    v5 = (const OSMetaClassBase *)IORegistryEntry::getPlane("IOACPIPlane", "XHCN");
    v6 = v5;
    if ( v5 )
    {
      v7 = v5;
      LODWORD(v8) = IORegistryIterator::iterateOver(v3, v5, 1LL);
      v9 = v8;
      if ( v8 )
      {
        v31 = v6;
        v29 = *(const OSMetaClassBase **)off_3B070[0];
        v33 = *(const OSMetaClassBase **)off_3B078[0];
        v30 = *(const OSMetaClassBase **)off_3B088[0];
        v4 = 0LL;
        while ( 1 )
        {
          LODWORD(v10) = (*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v9 + 296LL))(v9, v7);
          v11 = v10;
          if ( !v10 )
            break;
          v7 = (const OSMetaClassBase *)"IOACPIPlatformDevice";
          if ( OSMetaClassBase::metaCast(v10, "IOACPIPlatformDevice") )
          {
            v36 = 254;
            if ( !(*(int (__fastcall **)(OSMetaClassBase *, _QWORD))(*(_QWORD *)v11 + 2224LL))(v11, "_EJD") )
            {
              (*(void (__fastcall **)(OSMetaClassBase *, char *, int *, const OSMetaClassBase *))(*(_QWORD *)v11 + 984LL))(
                v11,
                &v38,
                &v36,
                v31);
              LODWORD(v12) = (*(int (__fastcall **)(OSMetaClassBase *, _QWORD))(*(_QWORD *)v11 + 952LL))(v11, 0LL);
              v4 = strtoul(v12, 0LL, 16);
            }
            if ( (*(int (__fastcall **)(OSMetaClassBase *, _QWORD))(*(_QWORD *)v11 + 2224LL))(v11, "_UPC")
              || (v32 = v4,
                  v36 = 254,
                  (*(void (__fastcall **)(OSMetaClassBase *, char *, int *, const OSMetaClassBase *))(*(_QWORD *)v11 + 984LL))(
                    v11,
                    &v38,
                    &v36,
                    v31),
                  v13 = (*(int (__fastcall **)(OSMetaClassBase *, _QWORD, __int64 *, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v11 + 2240LL))(
                          v11,
                          "_UPC",
                          &v35,
                          0LL,
                          0LL,
                          0LL),
                  LODWORD(v14) = (*(int (__fastcall **)(OSMetaClassBase *, const OSMetaClassBase *))(*(_QWORD *)v11 + 952LL))(
                                   v11,
                                   v31),
                  v16 = strtoul(v14, 0LL, 16),
                  v13) )
            {
              v2 = off_3B0E0[0];
            }
            else
            {
              v18 = OSMetaClassBase::safeMetaCast(v35, v29, v15);
              if ( (*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v18 + 304LL))(v18, v29) )
              {
                v28 = v16;
                v19 = 0;
                do
                {
                  LODWORD(v20) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v18 + 488LL))(v18, v19);
                  v22 = OSMetaClassBase::safeMetaCast(v20, v33, v21);
                  if ( v22 )
                  {
                    v23 = (*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v22 + 312LL))(v22, v33);
                    if ( v19 == 1 )
                    {
                      v24 = v23 == 2;
                      v25 = v32;
                      if ( v24 )
                        v25 = v28;
                      v32 = v25;
                    }
                  }
                  ++v19;
                }
                while ( v19 < (*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v18 + 304LL))(
                                v18,
                                v33) );
              }
              (*(void (**)(void))(*(_QWORD *)v35 + 40LL))();
              v2 = off_3B0E0[0];
              v4 = v32;
            }
            v7 = (const OSMetaClassBase *)"MUXS";
            if ( !(*(int (__fastcall **)(OSMetaClassBase *, _QWORD))(*(_QWORD *)v11 + 2224LL))(v11, "MUXS") )
            {
              v7 = (const OSMetaClassBase *)"MUXS";
              if ( !(*(int (__fastcall **)(OSMetaClassBase *, _QWORD, __int64 *, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v11 + 2240LL))(
                      v11,
                      "MUXS",
                      &v34,
                      0LL,
                      0LL,
                      0LL) )
              {
                v7 = v30;
                OSMetaClassBase::safeMetaCast(v34, v30, v17);
                (*(void (__fastcall **)(OSMetaClassBase *, const OSMetaClassBase *))(*(_QWORD *)v34 + 40LL))(v34, v30);
              }
            }
          }
        }
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v9 + 40LL))(v9);
      }
    }
    (*(void (__fastcall **)(OSMetaClassBase *))(*(_QWORD *)v3 + 40LL))(v3);
    LOBYTE(v4) = (_DWORD)v4 != 0;
  }
  v26 = *(_QWORD *)v2;
  if ( *(_QWORD *)v2 == v39 )
    LOBYTE(v26) = v4;
  return v26;
}
// 3B070: using guessed type _QWORD off_3B070[20];
// 3B078: using guessed type _QWORD off_3B078[19];
// 3B088: using guessed type _QWORD off_3B088[17];
// 3B0E0: using guessed type __int64 off_3B0E0[6];
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);
// 7D870: using guessed type int __fastcall IORegistryIterator::iterateOver(_QWORD, _QWORD, _QWORD);

//----- (000000000000853A) ----------------------------------------------------
__int64 __usercall IOUSBController::ExpressCardPort@<rax>(IOUSBController *this@<rdi>, IORegistryEntry *a2@<rsi>, __int64 a3@<rax>)
{
  IORegistryEntry *v3; // rbx@1
  __int64 result; // rax@1
  __int64 v5; // [sp-4h] [bp-10h]@1

  v5 = a3;
  HIDWORD(v5) = 0;
  v3 = IOUSBController::CopyACPIDevice(this, a2);
  result = 0LL;
  if ( v3 )
  {
    IOUSBController::HasExpressCard(this, v3, (unsigned int *)&v5 + 1);
    (*(void (__fastcall **)(IORegistryEntry *, IORegistryEntry *))(*(_QWORD *)v3 + 40LL))(v3, v3);
    result = HIDWORD(v5);
  }
  return result;
}

//----- (0000000000008576) ----------------------------------------------------
char __fastcall IOUSBController::IsPortMuxed(IOUSBController *this, IORegistryEntry *a2, int a3, unsigned int a4, char *a5)
{
  char *v5; // r14@1
  unsigned int v6; // er15@1
  int v7; // er12@1
  IORegistryEntry *v8; // rax@1
  IORegistryEntry *v9; // rbx@1
  IORegistryEntry *v10; // rsi@2
  char v11; // r14@2

  v5 = a5;
  v6 = a4;
  v7 = a3;
  v8 = IOUSBController::CopyACPIDevice(this, a2);
  v9 = v8;
  if ( v8 )
  {
    v10 = v8;
    v11 = IOUSBController::CheckACPIUPCTableForMuxedMethods(this, v8, v7, v6, v5);
    (*(void (__fastcall **)(IORegistryEntry *, IORegistryEntry *))(*(_QWORD *)v9 + 40LL))(v9, v10);
  }
  else
  {
    v11 = 0;
  }
  return v11;
}

//----- (00000000000085D4) ----------------------------------------------------
char __fastcall IOUSBController::CheckACPIUPCTableForMuxedMethods(IOUSBController *this, IORegistryEntry *a2, int a3, unsigned int a4, char *a5)
{
  char *v5; // r12@1
  __int64 v6; // r15@1
  __int64 v7; // rax@2
  __int64 v8; // r14@3
  __int64 v9; // rax@3
  __int64 v10; // r13@3
  __int64 v11; // rbx@4
  OSMetaClassBase *v12; // rax@6
  OSMetaClassBase *v13; // r15@6
  unsigned int v14; // eax@8
  int v15; // esi@10
  signed int v16; // ecx@10
  int v17; // er12@13
  int v18; // ebx@14
  const char *v19; // rax@14
  const OSMetaClass *v20; // rdx@16
  void *v21; // rsi@17
  __int64 v22; // r15@17
  __int64 v23; // rax@18
  const char *v24; // rax@19
  const char *v25; // rbx@19
  int v26; // eax@19
  __int64 v27; // rax@26
  const OSMetaClassBase *v29; // [sp+0h] [bp-170h]@4
  char *v30; // [sp+8h] [bp-168h]@5
  __int64 v31; // [sp+10h] [bp-160h]@5
  int v32; // [sp+18h] [bp-158h]@1
  unsigned int v33; // [sp+2Ch] [bp-144h]@1
  OSMetaClassBase *v34; // [sp+30h] [bp-140h]@16
  int v35; // [sp+3Ch] [bp-134h]@8
  char v36; // [sp+40h] [bp-130h]@14
  __int64 v37; // [sp+140h] [bp-30h]@1

  v5 = a5;
  v33 = a4;
  v32 = a3;
  v6 = off_3B0E0[0];
  v37 = *(_QWORD *)off_3B0E0[0];
  if ( a2
    && (v7 = IORegistryEntry::getPlane("IOACPIPlane", (const char *)a2)) != 0
    && (v8 = v7, LODWORD(v9) = IORegistryIterator::iterateOver(a2, v7, 1LL), (v10 = v9) != 0) )
  {
    v29 = *(const OSMetaClassBase **)off_3B088[0];
    v11 = 0LL;
    do
    {
      v31 = v11;
      v30 = v5;
      while ( 1 )
      {
        LODWORD(v12) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v10 + 296LL))(v10);
        v13 = v12;
        if ( !v12 )
        {
          LOBYTE(v11) = v31;
          goto LABEL_25;
        }
        if ( OSMetaClassBase::metaCast(v12, "IOACPIPlatformDevice") )
        {
          v35 = 254;
          v14 = v33;
          if ( *(_BYTE *)(*((_QWORD *)this + 21) + 40LL) == 3 )
            v14 = v33 & 0xFEFFFFFF;
          v15 = 0;
          v16 = 20;
          do
          {
            if ( !((15 << v16) & v14) )
              break;
            ++v15;
            v16 -= 4;
          }
          while ( v16 >= 0 );
          v17 = IOUSBController::calculateACPIDepth(this, v15);
          if ( !(*(int (__fastcall **)(OSMetaClassBase *, _QWORD))(*(_QWORD *)v13 + 2224LL))(v13, "MUXS") )
          {
            v35 = 254;
            (*(void (__fastcall **)(OSMetaClassBase *, char *, int *, __int64))(*(_QWORD *)v13 + 984LL))(
              v13,
              &v36,
              &v35,
              v8);
            v18 = (*(int (__fastcall **)(OSMetaClassBase *, __int64))(*(_QWORD *)v13 + 848LL))(v13, v8);
            LODWORD(v19) = (*(int (__fastcall **)(OSMetaClassBase *, __int64))(*(_QWORD *)v13 + 952LL))(v13, v8);
            if ( (unsigned int)strtoul(v19, 0LL, 16) == v32
              && v18 == v17
              && !(*(int (__fastcall **)(OSMetaClassBase *, _QWORD, __int64 *, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v13 + 2240LL))(
                    v13,
                    "MUXS",
                    &v34,
                    0LL,
                    0LL,
                    0LL) )
              break;
          }
        }
      }
      v21 = (void *)v29;
      v22 = OSMetaClassBase::safeMetaCast(v34, v29, v20);
      v5 = v30;
      if ( v22 )
      {
        v23 = (unsigned int)((*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v22 + 304LL))(
                               v22,
                               v29)
                           + 1);
        if ( (unsigned int)v23 > 5 )
        {
          LOBYTE(v23) = 1;
          v31 = v23;
        }
        else
        {
          LOBYTE(v23) = 1;
          v31 = v23;
          LODWORD(v24) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v22 + 328LL))(v22);
          v25 = v24;
          v26 = (*(int (__fastcall **)(__int64))(*(_QWORD *)v22 + 304LL))(v22);
          v21 = (void *)v25;
          strlcpy(v30, v25, (unsigned int)(v26 + 1));
        }
      }
      (*(void (__fastcall **)(OSMetaClassBase *, void *))(*(_QWORD *)v34 + 40LL))(v34, v21);
      v11 = v31;
    }
    while ( !(v31 & 1) );
LABEL_25:
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v10 + 40LL))(v10);
    v6 = off_3B0E0[0];
  }
  else
  {
    LOBYTE(v11) = 0;
  }
  v27 = *(_QWORD *)v6;
  if ( *(_QWORD *)v6 == v37 )
    LOBYTE(v27) = v11 & 1;
  return v27;
}
// 3B088: using guessed type _QWORD off_3B088[17];
// 3B0E0: using guessed type __int64 off_3B0E0[6];
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);
// 7D870: using guessed type int __fastcall IORegistryIterator::iterateOver(_QWORD, _QWORD, _QWORD);

//----- (000000000000887A) ----------------------------------------------------
char __fastcall IOUSBController::IsPortMapped(IOUSBController *this, IORegistryEntry *a2, int a3, unsigned int a4, unsigned int *a5)
{
  unsigned int *v5; // r14@1
  unsigned int v6; // er15@1
  int v7; // er12@1
  IORegistryEntry *v8; // rax@1
  IORegistryEntry *v9; // rbx@1
  IORegistryEntry *v10; // rsi@2
  char v11; // r14@2

  v5 = a5;
  v6 = a4;
  v7 = a3;
  v8 = IOUSBController::CopyACPIDevice(this, a2);
  v9 = v8;
  if ( v8 )
  {
    v10 = v8;
    v11 = IOUSBController::CheckACPIForPortMapping(this, v8, v7, v6, v5);
    (*(void (__fastcall **)(IORegistryEntry *, IORegistryEntry *))(*(_QWORD *)v9 + 40LL))(v9, v10);
  }
  else
  {
    v11 = 0;
  }
  return v11;
}

//----- (00000000000088D8) ----------------------------------------------------
char __fastcall IOUSBController::CheckACPIForPortMapping(IOUSBController *this, IORegistryEntry *a2, int a3, unsigned int a4, unsigned int *a5)
{
  unsigned int *v5; // rbx@1
  IOUSBController *v6; // r12@1
  __int64 v7; // r13@1
  const OSMetaClassBase *v8; // rax@2
  const OSMetaClassBase *v9; // r15@2
  IORegistryEntry *v10; // rdi@3
  const OSMetaClassBase *v11; // rsi@3
  __int64 v12; // rax@3
  __int64 v13; // r14@3
  OSMetaClassBase *v14; // rax@5
  OSMetaClassBase *v15; // r13@5
  unsigned int v16; // eax@7
  int v17; // esi@9
  signed int v18; // ecx@9
  const char *v19; // rax@14
  int v20; // er13@14
  const OSMetaClass *v21; // rdx@14
  __int64 v22; // rax@14
  bool v23; // zf@15
  char result; // al@20
  const OSMetaClassBase *v25; // [sp+0h] [bp-160h]@4
  char v26; // [sp+10h] [bp-150h]@4
  int v27; // [sp+18h] [bp-148h]@2
  unsigned int v28; // [sp+1Ch] [bp-144h]@1
  OSMetaClassBase *v29; // [sp+20h] [bp-140h]@13
  int v30; // [sp+2Ch] [bp-134h]@7
  char v31; // [sp+30h] [bp-130h]@13
  __int64 v32; // [sp+130h] [bp-30h]@1

  v5 = a5;
  v28 = a4;
  v6 = this;
  v7 = off_3B0E0[0];
  v32 = *(_QWORD *)off_3B0E0[0];
  *a5 = 0;
  if ( a2
    && (v27 = a3,
        v8 = (const OSMetaClassBase *)IORegistryEntry::getPlane("IOACPIPlane", (const char *)a2),
        (v9 = v8) != 0LL)
    && (v10 = a2, v11 = v8, LODWORD(v12) = IORegistryIterator::iterateOver(v10, v8, 1LL), (v13 = v12) != 0) )
  {
    v25 = *(const OSMetaClassBase **)off_3B078[0];
    v26 = 0;
    while ( 1 )
    {
      LODWORD(v14) = (*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v13 + 296LL))(v13, v11);
      v15 = v14;
      if ( !v14 )
        break;
      v11 = (const OSMetaClassBase *)"IOACPIPlatformDevice";
      if ( OSMetaClassBase::metaCast(v14, "IOACPIPlatformDevice") )
      {
        v30 = 254;
        v16 = v28;
        if ( *(_BYTE *)(*((_QWORD *)v6 + 21) + 40LL) == 3 )
          v16 = v28 & 0xFEFFFFFF;
        v17 = 0;
        v18 = 20;
        do
        {
          if ( !((15 << v18) & v16) )
            break;
          ++v17;
          v18 -= 4;
        }
        while ( v18 >= 0 );
        IOUSBController::calculateACPIDepth(v6, v17);
        v11 = (const OSMetaClassBase *)"XHCP";
        if ( !(*(int (__fastcall **)(OSMetaClassBase *, _QWORD))(*(_QWORD *)v15 + 2224LL))(v15, "XHCP") )
        {
          v30 = 254;
          (*(void (__fastcall **)(OSMetaClassBase *, char *, int *, const OSMetaClassBase *))(*(_QWORD *)v15 + 984LL))(
            v15,
            &v31,
            &v30,
            v9);
          (*(void (__fastcall **)(OSMetaClassBase *, const OSMetaClassBase *))(*(_QWORD *)v15 + 848LL))(v15, v9);
          v11 = (const OSMetaClassBase *)"XHCP";
          if ( !(*(int (__fastcall **)(OSMetaClassBase *, _QWORD, __int64 *, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v15 + 2240LL))(
                  v15,
                  "XHCP",
                  &v29,
                  0LL,
                  0LL,
                  0LL) )
          {
            LODWORD(v19) = (*(int (__fastcall **)(OSMetaClassBase *, const OSMetaClassBase *))(*(_QWORD *)v15 + 952LL))(
                             v15,
                             v9);
            v20 = strtoul(v19, 0LL, 16);
            v11 = v25;
            v22 = OSMetaClassBase::safeMetaCast(v29, v25, v21);
            if ( v22 )
            {
              v23 = v20 == v27;
              v7 = off_3B0E0[0];
              if ( v23 )
              {
                *v5 = (*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v22 + 328LL))(v22, v25);
                v26 = 1;
              }
            }
            else
            {
              v7 = off_3B0E0[0];
            }
            (*(void (__fastcall **)(OSMetaClassBase *, const OSMetaClassBase *))(*(_QWORD *)v29 + 40LL))(v29, v25);
            if ( v26 & 1 )
              goto LABEL_22;
          }
        }
      }
    }
    v7 = off_3B0E0[0];
LABEL_22:
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v13 + 40LL))(v13);
    result = v26;
  }
  else
  {
    result = 0;
  }
  if ( *(_QWORD *)v7 == v32 )
    result &= 1u;
  return result;
}
// 3B078: using guessed type _QWORD off_3B078[19];
// 3B0E0: using guessed type __int64 off_3B0E0[6];
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);
// 7D870: using guessed type int __fastcall IORegistryIterator::iterateOver(_QWORD, _QWORD, _QWORD);

//----- (0000000000008B3C) ----------------------------------------------------
bool __fastcall IOUSBController::IsPortInternal(IOUSBController *this, IORegistryEntry *a2, int a3, unsigned int a4)
{
  unsigned int v4; // er14@1
  int v5; // er15@1
  IORegistryEntry *v6; // rax@1
  IORegistryEntry *v7; // r12@1
  IORegistryEntry *v8; // rsi@2
  int v9; // eax@2
  bool v10; // bl@2
  unsigned __int8 v12; // [sp+Fh] [bp-21h]@2

  v4 = a4;
  v5 = a3;
  v6 = IOUSBController::CopyACPIDevice(this, a2);
  v7 = v6;
  if ( v6 )
  {
    v12 = -2;
    v8 = v6;
    v9 = IOUSBController::CheckACPIUPCTable(this, v6, v5, v4, &v12);
    v10 = v9 == 0 && v12 == 255;
    (*(void (__fastcall **)(IORegistryEntry *, IORegistryEntry *))(*(_QWORD *)v7 + 40LL))(v7, v8);
  }
  else
  {
    v10 = 0;
  }
  return v10;
}

//----- (0000000000008BAC) ----------------------------------------------------
bool __fastcall IOUSBController::CheckACPIUPCTable(IOUSBController *this, IORegistryEntry *a2, int a3, unsigned int a4)
{
  bool v4; // cl@1
  unsigned __int8 v6; // [sp+Fh] [bp-1h]@1

  v6 = -2;
  v4 = (unsigned int)IOUSBController::CheckACPIUPCTable(this, a2, a3, a4, &v6) == 0;
  return v4 && v6 == 255;
}

//----- (0000000000008BDA) ----------------------------------------------------
__int64 __fastcall IOUSBController::CheckACPIUPCTable(IOUSBController *this, IORegistryEntry *a2, int a3, unsigned int a4, unsigned __int8 *a5)
{
  unsigned __int8 *v5; // r14@1
  int v6; // er13@1
  __int64 v7; // r12@1
  __int64 result; // rax@1
  __int64 v9; // rax@2
  __int64 v10; // rbx@3
  __int64 v11; // rax@3
  __int64 v12; // r15@3
  bool v13; // zf@3
  OSMetaClassBase *v14; // rax@6
  OSMetaClassBase *v15; // r12@6
  unsigned int v16; // eax@8
  int v17; // esi@10
  signed int v18; // ecx@10
  int v19; // er13@13
  int v20; // er14@14
  const char *v21; // rax@15
  const OSMetaClass *v22; // rdx@15
  __int64 v23; // r12@15
  OSMetaClassBase *v24; // rax@19
  const OSMetaClass *v25; // rdx@19
  __int64 v26; // rax@19
  OSMetaClassBase *v27; // rax@21
  const OSMetaClass *v28; // rdx@21
  __int64 v29; // rax@21
  OSMetaClassBase *v30; // rax@24
  const OSMetaClass *v31; // rdx@24
  __int64 v32; // rax@24
  unsigned __int8 v33; // al@25
  __int64 v34; // rcx@37
  int v35; // [sp+8h] [bp-188h]@15
  const OSMetaClassBase *v36; // [sp+10h] [bp-180h]@4
  const OSMetaClassBase *v37; // [sp+18h] [bp-178h]@4
  char v38; // [sp+20h] [bp-170h]@4
  unsigned __int8 *v39; // [sp+28h] [bp-168h]@5
  int v40; // [sp+34h] [bp-15Ch]@5
  signed int v41; // [sp+38h] [bp-158h]@4
  unsigned int v42; // [sp+4Ch] [bp-144h]@1
  OSMetaClassBase *v43; // [sp+50h] [bp-140h]@14
  int v44; // [sp+5Ch] [bp-134h]@8
  char v45; // [sp+60h] [bp-130h]@14
  __int64 v46; // [sp+160h] [bp-30h]@1

  v5 = a5;
  v42 = a4;
  v6 = a3;
  v7 = off_3B0E0[0];
  v46 = *(_QWORD *)off_3B0E0[0];
  result = 3758097090LL;
  if ( a2 )
  {
    v9 = IORegistryEntry::getPlane("IOACPIPlane", (const char *)a2);
    if ( !v9 )
    {
      result = 3758097090LL;
      goto LABEL_37;
    }
    v10 = v9;
    LODWORD(v11) = IORegistryIterator::iterateOver(a2, v9, 1LL);
    v12 = v11;
    v13 = v11 == 0;
    result = 3758097090LL;
    if ( !v13 )
    {
      v37 = *(const OSMetaClassBase **)off_3B070[0];
      v36 = *(const OSMetaClassBase **)off_3B078[0];
      v41 = -536870206;
      v38 = 0;
      while ( 2 )
      {
        v40 = v6;
        v39 = v5;
        while ( 1 )
        {
          LODWORD(v14) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v12 + 296LL))(v12);
          v15 = v14;
          if ( !v14 )
          {
            v7 = off_3B0E0[0];
            goto LABEL_35;
          }
          if ( OSMetaClassBase::metaCast(v14, "IOACPIPlatformDevice") )
          {
            v44 = 254;
            v16 = v42;
            if ( *(_BYTE *)(*((_QWORD *)this + 21) + 40LL) == 3 )
              v16 = v42 & 0xFEFFFFFF;
            v17 = 0;
            v18 = 20;
            do
            {
              if ( !((15 << v18) & v16) )
                break;
              ++v17;
              v18 -= 4;
            }
            while ( v18 >= 0 );
            v19 = IOUSBController::calculateACPIDepth(this, v17);
            if ( !(*(int (__fastcall **)(OSMetaClassBase *, _QWORD))(*(_QWORD *)v15 + 2224LL))(v15, "_UPC") )
            {
              v44 = 254;
              (*(void (__fastcall **)(OSMetaClassBase *, char *, int *, __int64))(*(_QWORD *)v15 + 984LL))(
                v15,
                &v45,
                &v44,
                v10);
              v20 = (*(int (__fastcall **)(OSMetaClassBase *, __int64))(*(_QWORD *)v15 + 848LL))(v15, v10);
              if ( !(*(int (__fastcall **)(OSMetaClassBase *, _QWORD, __int64 *, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v15 + 2240LL))(
                      v15,
                      "_UPC",
                      &v43,
                      0LL,
                      0LL,
                      0LL) )
                break;
            }
          }
        }
        LODWORD(v21) = (*(int (__fastcall **)(OSMetaClassBase *, __int64))(*(_QWORD *)v15 + 952LL))(v15, v10);
        v35 = strtoul(v21, 0LL, 16);
        v23 = OSMetaClassBase::safeMetaCast(v43, v37, v22);
        if ( *(_BYTE *)(*((_QWORD *)this + 21) + 40LL) == 3 )
        {
          if ( v23 && v35 == v40 && v20 == v19 )
          {
            LODWORD(v24) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v23 + 488LL))(v23, 0LL);
            v26 = OSMetaClassBase::safeMetaCast(v24, v36, v25);
            v38 = 1;
            v5 = v39;
            v6 = v40;
            if ( v26
              && (unsigned __int8)(*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v26 + 312LL))(
                                    v26,
                                    v36) )
            {
              LODWORD(v27) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v23 + 488LL))(v23, 1LL);
              v29 = OSMetaClassBase::safeMetaCast(v27, v36, v28);
              if ( v29 )
              {
                *v39 = (*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v29 + 312LL))(v29, v36);
                v41 = 0;
              }
            }
            else
            {
              v41 = -536870208;
            }
            v7 = off_3B0E0[0];
            goto LABEL_32;
          }
        }
        else if ( v23 )
        {
          LODWORD(v30) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v23 + 488LL))(v23, 1LL);
          v32 = OSMetaClassBase::safeMetaCast(v30, v36, v31);
          if ( v32 )
          {
            v33 = (*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v32 + 312LL))(v32, v36);
            v7 = off_3B0E0[0];
            if ( v35 == v40 )
            {
              v13 = v20 == v19;
              v5 = v39;
              v6 = v40;
              if ( v13 )
              {
                *v39 = v33;
                v38 = 1;
                v41 = 0;
              }
              goto LABEL_32;
            }
            goto LABEL_29;
          }
        }
        v7 = off_3B0E0[0];
LABEL_29:
        v5 = v39;
        v6 = v40;
LABEL_32:
        (*(void (**)(void))(*(_QWORD *)v43 + 40LL))();
        if ( !(v38 & 1) )
          continue;
        break;
      }
LABEL_35:
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v12 + 40LL))(v12);
      result = (unsigned int)v41;
      goto LABEL_37;
    }
  }
LABEL_37:
  v34 = *(_QWORD *)v7;
  return result;
}
// 3B070: using guessed type _QWORD off_3B070[20];
// 3B078: using guessed type _QWORD off_3B078[19];
// 3B0E0: using guessed type __int64 off_3B0E0[6];
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);
// 7D870: using guessed type int __fastcall IORegistryIterator::iterateOver(_QWORD, _QWORD, _QWORD);

//----- (0000000000008FBC) ----------------------------------------------------
char __fastcall IOUSBController::CheckACPIUPCTableForInternalHubErrataBits(IOUSBController *this, IORegistryEntry *a2, int a3, unsigned int a4, unsigned int *a5)
{
  unsigned int *v5; // rbx@1
  __int64 v6; // r15@1
  const OSMetaClassBase *v7; // rax@2
  const OSMetaClassBase *v8; // r13@2
  IORegistryEntry *v9; // rdi@3
  const OSMetaClassBase *v10; // rsi@3
  __int64 v11; // rax@3
  __int64 v12; // r14@3
  __int64 v13; // rbx@4
  unsigned int *v14; // rax@4
  OSMetaClassBase *v15; // rax@6
  OSMetaClassBase *v16; // r15@6
  unsigned int v17; // eax@8
  int v18; // esi@10
  signed int v19; // ecx@10
  int v20; // er12@13
  int v21; // ebx@15
  const char *v22; // rax@15
  const OSMetaClass *v23; // rdx@17
  unsigned int *v24; // r12@18
  __int64 v25; // rax@19
  const OSMetaClass *v26; // rdx@22
  __int64 v27; // rax@24
  __int64 v28; // rax@25
  __int64 v29; // rax@33
  const OSMetaClassBase *v31; // [sp+10h] [bp-170h]@4
  __int64 v32; // [sp+18h] [bp-168h]@5
  unsigned int *v33; // [sp+20h] [bp-160h]@3
  unsigned int *v34; // [sp+20h] [bp-160h]@5
  int v35; // [sp+28h] [bp-158h]@1
  IOUSBController *v36; // [sp+30h] [bp-150h]@2
  unsigned int v37; // [sp+3Ch] [bp-144h]@1
  OSMetaClassBase *v38; // [sp+40h] [bp-140h]@17
  int v39; // [sp+4Ch] [bp-134h]@8
  char v40; // [sp+50h] [bp-130h]@15
  __int64 v41; // [sp+150h] [bp-30h]@1

  v5 = a5;
  v37 = a4;
  v35 = a3;
  v6 = off_3B0E0[0];
  v41 = *(_QWORD *)off_3B0E0[0];
  *a5 = 0;
  if ( a2
    && (v36 = this,
        v7 = (const OSMetaClassBase *)IORegistryEntry::getPlane("IOACPIPlane", (const char *)a2),
        (v8 = v7) != 0LL)
    && (v33 = v5, v9 = a2, v10 = v7, LODWORD(v11) = IORegistryIterator::iterateOver(v9, v7, 1LL), (v12 = v11) != 0) )
  {
    v31 = *(const OSMetaClassBase **)off_3B078[0];
    v13 = 0LL;
    v14 = v33;
    do
    {
      v32 = v13;
      v34 = v14;
      while ( 1 )
      {
        LODWORD(v15) = (*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v12 + 296LL))(v12, v10);
        v16 = v15;
        if ( !v15 )
        {
          v6 = off_3B0E0[0];
          LOBYTE(v13) = v32;
          goto LABEL_32;
        }
        v10 = (const OSMetaClassBase *)"IOACPIPlatformDevice";
        if ( OSMetaClassBase::metaCast(v15, "IOACPIPlatformDevice") )
        {
          v39 = 254;
          v17 = v37;
          if ( *(_BYTE *)(*((_QWORD *)v36 + 21) + 40LL) == 3 )
            v17 = v37 & 0xFEFFFFFF;
          v18 = 0;
          v19 = 20;
          do
          {
            if ( !((15 << v19) & v17) )
              break;
            ++v18;
            v19 -= 4;
          }
          while ( v19 >= 0 );
          v20 = IOUSBController::calculateACPIDepth(v36, v18);
          if ( !(*(int (__fastcall **)(OSMetaClassBase *, _QWORD))(*(_QWORD *)v16 + 2224LL))(v16, "HERB")
            || (v10 = (const OSMetaClassBase *)"BERT",
                !(*(int (__fastcall **)(OSMetaClassBase *, _QWORD))(*(_QWORD *)v16 + 2224LL))(v16, "BERT")) )
          {
            v39 = 254;
            (*(void (__fastcall **)(OSMetaClassBase *, char *, int *, const OSMetaClassBase *))(*(_QWORD *)v16 + 984LL))(
              v16,
              &v40,
              &v39,
              v8);
            v21 = (*(int (__fastcall **)(OSMetaClassBase *, const OSMetaClassBase *))(*(_QWORD *)v16 + 848LL))(v16, v8);
            LODWORD(v22) = (*(int (__fastcall **)(OSMetaClassBase *, const OSMetaClassBase *))(*(_QWORD *)v16 + 952LL))(
                             v16,
                             v8);
            v10 = 0LL;
            if ( (unsigned int)strtoul(v22, 0LL, 16) == v35 && v21 == v20 )
              break;
          }
        }
      }
      if ( (*(int (__fastcall **)(OSMetaClassBase *, _QWORD, __int64 *, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v16 + 2240LL))(
             v16,
             "HERB",
             &v38,
             0LL,
             0LL,
             0LL) )
      {
        v24 = v34;
        v13 = v32;
      }
      else
      {
        v25 = OSMetaClassBase::safeMetaCast(v38, v31, v23);
        v24 = v34;
        v13 = v32;
        if ( v25 )
        {
          *v34 |= (*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v25 + 328LL))(v25, v31);
          LOBYTE(v13) = 1;
        }
        (*(void (__fastcall **)(OSMetaClassBase *, const OSMetaClassBase *))(*(_QWORD *)v38 + 40LL))(v38, v31);
      }
      v10 = (const OSMetaClassBase *)"BERT";
      if ( (*(int (__fastcall **)(OSMetaClassBase *, _QWORD, OSMetaClassBase **, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v16 + 2240LL))(
             v16,
             "BERT",
             &v38,
             0LL,
             0LL,
             0LL) )
      {
        v6 = off_3B0E0[0];
      }
      else
      {
        v10 = v31;
        v27 = OSMetaClassBase::safeMetaCast(v38, v31, v26);
        v6 = off_3B0E0[0];
        if ( v27 )
        {
          *v24 |= (*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v27 + 328LL))(v27, v31);
          v28 = *((_QWORD *)v36 + 21);
          LOBYTE(v13) = 1;
          if ( *(_DWORD *)(v28 + 224) == v37 )
            *(_DWORD *)(v28 + 228) |= 1 << v35;
        }
        (*(void (__fastcall **)(OSMetaClassBase *, const OSMetaClassBase *))(*(_QWORD *)v38 + 40LL))(v38, v31);
      }
      v14 = v24;
    }
    while ( !(v13 & 1) );
LABEL_32:
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v12 + 40LL))(v12);
  }
  else
  {
    LOBYTE(v13) = 0;
  }
  v29 = *(_QWORD *)v6;
  if ( *(_QWORD *)v6 == v41 )
    LOBYTE(v29) = v13 & 1;
  return v29;
}
// 3B078: using guessed type _QWORD off_3B078[19];
// 3B0E0: using guessed type __int64 off_3B0E0[6];
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);
// 7D870: using guessed type int __fastcall IORegistryIterator::iterateOver(_QWORD, _QWORD, _QWORD);

//----- (0000000000009304) ----------------------------------------------------
bool __fastcall IOUSBController::IsControllerMuxed(IOUSBController *this, IORegistryEntry *a2)
{
  OSMetaClassBase *v2; // rbx@1
  bool v3; // r14@2
  int v5; // [sp+Ch] [bp-14h]@1

  v5 = 0;
  v2 = IOUSBController::CopyACPIDevice(this, a2);
  if ( v2 )
  {
    v3 = (*(int (__fastcall **)(OSMetaClassBase *, _QWORD, int *, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v2 + 2256LL))(
           v2,
           "XHCN",
           &v5,
           0LL,
           0LL,
           0LL) == 0;
    (*(void (__fastcall **)(OSMetaClassBase *))(*(_QWORD *)v2 + 40LL))(v2);
  }
  else
  {
    v3 = 0;
  }
  return v3;
}

//----- (0000000000009362) ----------------------------------------------------
__int64 __fastcall IOUSBController::_RESERVEDIOUSBController19(IOUSBController *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBController::gMetaClass, 19);
}
// 49588: using guessed type _QWORD IOUSBController::gMetaClass;

//----- (0000000000009378) ----------------------------------------------------
int __fastcall IOUSBController_ExtraCurrentIOLockClass::IOUSBController_ExtraCurrentIOLockClass(__int64 a1)
{
  __int64 v1; // rax@1

  *(_QWORD *)a1 = off_3C780;
  LODWORD(v1) = IOLockAlloc(a1);
  *(_QWORD *)(a1 + 8) = v1;
  return v1;
}
// 3C780: using guessed type __int64 (__fastcall *off_3C780[2])(IOUSBController_ExtraCurrentIOLockClass *__hidden this);
// 7D220: using guessed type int __cdecl IOLockAlloc(_QWORD);

//----- (000000000000939C) ----------------------------------------------------
int __fastcall IOUSBController_ExtraCurrentIOLockClass::~IOUSBController_ExtraCurrentIOLockClass(IOUSBController_ExtraCurrentIOLockClass *this)
{
  *(_QWORD *)this = off_3C780;
  return IOLockFree(*((_QWORD *)this + 1));
}
// 3C780: using guessed type __int64 (__fastcall *off_3C780[2])(IOUSBController_ExtraCurrentIOLockClass *__hidden this);
// 7D228: using guessed type int __fastcall IOLockFree(_QWORD);

//----- (00000000000093B4) ----------------------------------------------------
void __fastcall IOUSBController_ExtraCurrentIOLockClass::~IOUSBController_ExtraCurrentIOLockClass(IOUSBController_ExtraCurrentIOLockClass *this)
{
  *(_QWORD *)this = off_3C780;
  IOLockFree(*((_QWORD *)this + 1));
  operator delete((void *)this);
}
// 3C780: using guessed type __int64 (__fastcall *off_3C780[2])(IOUSBController_ExtraCurrentIOLockClass *__hidden this);
// 7D228: using guessed type int __fastcall IOLockFree(_QWORD);

//----- (00000000000093DE) ----------------------------------------------------
__int64 __fastcall IOUSBController::MetaClass::~MetaClass(IOUSBController::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (00000000000093F0) ----------------------------------------------------
__int64 `global constructor keyed to'_a_0()
{
  __int64 v0; // rax@1
  __int64 result; // rax@1

  USBGlobals::USBGlobals((__int64)&gUSBStackGlobals);
  gExtraCurrentIOLockClass = off_3C780;
  LODWORD(v0) = IOLockAlloc(&gUSBStackGlobals);
  qword_49A60 = v0;
  OSMetaClass::OSMetaClass(&IOUSBController::gMetaClass, "IOUSBController", &IOUSBBus::gMetaClass, 176LL);
  result = (__int64)off_3C690;
  IOUSBController::gMetaClass = off_3C690;
  return result;
}
// 3C690: using guessed type __int64 (__fastcall *off_3C690[2])(IOUSBController::MetaClass *__hidden this);
// 3C780: using guessed type __int64 (__fastcall *off_3C780[2])(IOUSBController_ExtraCurrentIOLockClass *__hidden this);
// 49430: using guessed type _QWORD IOUSBBus::gMetaClass;
// 49588: using guessed type _QWORD IOUSBController::gMetaClass;
// 49A50: using guessed type _QWORD gUSBStackGlobals;
// 49A58: using guessed type _QWORD gExtraCurrentIOLockClass;
// 49A60: using guessed type __int64 qword_49A60;
// 7D220: using guessed type int __cdecl IOLockAlloc(_QWORD);
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000009450) ----------------------------------------------------
int `global destructor keyed to'_a_0()
{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOUSBController::gMetaClass);
  gExtraCurrentIOLockClass = off_3C780;
  IOLockFree(qword_49A60);
  gUSBStackGlobals = off_3BBE0;
  return sysctl_unregister_oid(&sysctl__debug_USB);
}
// 3BBE0: using guessed type __int64 (__fastcall *off_3BBE0[2])(USBGlobals *__hidden this);
// 3C780: using guessed type __int64 (__fastcall *off_3C780[2])(IOUSBController_ExtraCurrentIOLockClass *__hidden this);
// 48D18: using guessed type __int64 *sysctl__debug_USB;
// 49588: using guessed type _QWORD IOUSBController::gMetaClass;
// 49A50: using guessed type _QWORD gUSBStackGlobals;
// 49A58: using guessed type _QWORD gExtraCurrentIOLockClass;
// 49A60: using guessed type __int64 qword_49A60;
// 7D228: using guessed type int __fastcall IOLockFree(_QWORD);
// 7E218: using guessed type int __fastcall sysctl_unregister_oid(_QWORD);

//----- (0000000000009496) ----------------------------------------------------
__int64 __fastcall IOUSBController::GetErrataBits(IOUSBController *this)
{
  return 0LL;
}

//----- (000000000000949E) ----------------------------------------------------
__int64 __fastcall CopyIOPCIDeviceParent(IOPCIDevice *a1)
{
  __int64 v1; // rbx@1
  __int64 v2; // r15@2
  OSMetaClassBase *v3; // rax@2
  const OSMetaClass *v4; // rdx@2
  OSMetaClassBase *v5; // r14@2
  __int64 v6; // rsi@3
  __int64 v7; // rax@3
  OSMetaClassBase *v8; // rax@4
  const OSMetaClass *v9; // rdx@4
  OSMetaClassBase *v10; // r15@4

  v1 = 0LL;
  if ( a1 )
  {
    v2 = off_3B0E8[0];
    LODWORD(v3) = (*(int (__fastcall **)(IOPCIDevice *, _QWORD))(*(_QWORD *)a1 + 304LL))(a1, *(_QWORD *)off_3B0E8[0]);
    v5 = v3;
    v1 = 0LL;
    if ( v3 )
    {
      v6 = *off_3B040[0];
      v7 = OSMetaClassBase::safeMetaCast(v3, (const OSMetaClassBase *)*off_3B040[0], v4);
      v1 = 0LL;
      if ( v7 )
      {
        v6 = *(_QWORD *)v2;
        LODWORD(v8) = (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v7 + 304LL))(v7, *(_QWORD *)v2);
        v10 = v8;
        v1 = 0LL;
        if ( v8 )
        {
          v6 = *off_3B020[0];
          v1 = OSMetaClassBase::safeMetaCast(v8, (const OSMetaClassBase *)*off_3B020[0], v9);
          if ( !v1 )
            (*(void (__fastcall **)(OSMetaClassBase *, __int64))(*(_QWORD *)v10 + 40LL))(v10, v6);
        }
      }
      (*(void (__fastcall **)(OSMetaClassBase *, __int64))(*(_QWORD *)v5 + 40LL))(v5, v6);
    }
  }
  return v1;
}
// 3B020: using guessed type _QWORD *off_3B020[7];
// 3B040: using guessed type _QWORD *off_3B040[3];
// 3B0E8: using guessed type __int64 off_3B0E8[5];
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000009538) ----------------------------------------------------
__int64 __fastcall GetDataPropertyValue(IORegistryEntry *a1, const char *a2, unsigned int *a3)
{
  unsigned int *v3; // r14@1
  OSMetaClassBase *v4; // rax@1
  const OSMetaClass *v5; // rdx@1
  OSMetaClassBase *v6; // r15@1
  signed int v7; // ebx@1
  __int64 v8; // rsi@2
  __int64 v9; // rax@2
  unsigned int *v10; // rax@3

  v3 = a3;
  LODWORD(v4) = (*(int (__fastcall **)(IORegistryEntry *, const char *))(*(_QWORD *)a1 + 744LL))(a1, a2);
  v6 = v4;
  v7 = -536870160;
  if ( v4 )
  {
    v8 = *(_QWORD *)off_3B068[0];
    v9 = OSMetaClassBase::safeMetaCast(v4, *(const OSMetaClassBase **)off_3B068[0], v5);
    v7 = -536870160;
    if ( v9 )
    {
      LODWORD(v10) = (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v9 + 376LL))(v9, v8);
      *v3 = *v10;
      v7 = 0;
    }
    (*(void (__fastcall **)(OSMetaClassBase *, __int64))(*(_QWORD *)v6 + 40LL))(v6, v8);
  }
  return (unsigned int)v7;
}
// 3B068: using guessed type _QWORD off_3B068[21];
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (00000000000095A0) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::GetErrata64Bits(IOUSBControllerV3 *this, unsigned __int16 a2, int a3, unsigned int a4)
{
  IOUSBControllerV3 *v4; // r15@1
  __int64 v5; // rax@1
  __int64 v6; // rdi@1
  int v7; // er14@1
  signed __int64 v8; // rbx@1
  __int64 v9; // rdi@9
  __int64 v10; // rax@10
  __int64 v11; // rax@12
  __int64 v12; // r12@12
  __int64 v13; // rcx@13
  __int64 v14; // rax@13
  __int64 v15; // rax@14
  __int64 v16; // rbx@14
  IOPCIDevice *v17; // rax@18
  IORegistryEntry *v18; // rbx@18
  __int64 v19; // rax@18
  bool v20; // r12@18
  signed int v21; // er13@35
  unsigned int v22; // er13@42
  unsigned int v23; // ebx@42
  __int64 v24; // rax@42
  bool v25; // zf@45
  __int64 v26; // rax@48
  signed __int64 v27; // r13@50
  __int64 v28; // rax@50
  signed __int64 v29; // r13@52
  __int64 v30; // rax@52
  signed __int64 v31; // r13@54
  IOPCIDevice *v32; // rax@55
  IOPCIDevice *v33; // rbx@55
  IORegistryEntry *v34; // rax@55
  IORegistryEntry *v35; // r12@55
  __int64 v36; // rsi@56
  __int64 v38; // [sp+0h] [bp-70h]@41
  signed __int64 v39; // [sp+8h] [bp-68h]@13
  bool v40; // [sp+17h] [bp-59h]@30
  __int64 v41; // [sp+18h] [bp-58h]@13
  __int64 v42; // [sp+18h] [bp-58h]@55
  IOPCIDevice *v43; // [sp+20h] [bp-50h]@20
  unsigned int v44; // [sp+2Ch] [bp-44h]@56
  unsigned int v45; // [sp+30h] [bp-40h]@22
  unsigned int v46; // [sp+34h] [bp-3Ch]@22
  unsigned int v47; // [sp+38h] [bp-38h]@22
  unsigned int v48; // [sp+3Ch] [bp-34h]@22
  unsigned int v49; // [sp+40h] [bp-30h]@13
  unsigned int v50; // [sp+44h] [bp-2Ch]@13

  v4 = this;
  v5 = (__int64)qword_3A818;
  v6 = 0LL;
  v7 = a2;
  a3 = (unsigned __int16)a3;
  a4 = (unsigned __int16)a4;
  v8 = 0LL;
  do
  {
    if ( *(_WORD *)(v5 - 8) == a2
      && (*(_WORD *)(v5 - 6) == a3 || (v6 & 0xFFFFFFFFFFFFFFFELL) == 86)
      && *(_WORD *)(v5 - 4) <= a4
      && *(_WORD *)(v5 - 2) >= a4 )
      v8 |= *(_QWORD *)v5;
    ++v6;
    v5 += 16LL;
  }
  while ( v6 != 93 );
  v9 = *((_QWORD *)v4 + 61);
  if ( !v9 )
    goto LABEL_65;
  *(_DWORD *)(*((_QWORD *)v4 + 21) + 240LL) = 0;
  LODWORD(v10) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v9 + 696LL))(v9, "AAPL,root-hub-depth");
  if ( v10 )
    *(_DWORD *)(*((_QWORD *)v4 + 21) + 240LL) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v10 + 328LL))(v10);
  LODWORD(v11) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)v4 + 61) + 696LL))(
                   *((_QWORD *)v4 + 61),
                   "IOPCITunnelled");
  v12 = *(_QWORD *)off_3B0F8[0];
  if ( v11 == **(_QWORD **)off_3B0F8[0] )
  {
    v41 = *(_QWORD *)off_3B0F8[0];
    v39 = v8;
    v50 = 0;
    v49 = 0;
    v13 = *((_QWORD *)v4 + 21);
    *(_BYTE *)(v13 + 244) = 1;
    *(_DWORD *)(*((_QWORD *)v4 + 84) + 300LL) = 25000;
    *(_BYTE *)(v13 + 236) = 1;
    (*(void (__fastcall **)(IOUSBControllerV3 *, _QWORD, __int64))(*(_QWORD *)v4 + 616LL))(v4, "onThunderbolt", v11);
    v14 = IOService::getServiceRoot(v4);
    if ( v14 )
    {
      LODWORD(v15) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v14 + 696LL))(v14, "board-id");
      v16 = v15;
      if ( v15 )
      {
        if ( (unsigned __int8)(*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v15 + 344LL))(
                                v15,
                                "Mac-2BD1B31983FE1663")
          || (unsigned __int8)(*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v16 + 344LL))(
                                v16,
                                "Mac-77EB7D7DAF985301") )
          *(_DWORD *)(*((_QWORD *)v4 + 84) + 300LL) = 10000;
      }
    }
    IOService::requireMaxBusStall(v4, *(_DWORD *)(*((_QWORD *)v4 + 84) + 300LL));
    v17 = (IOPCIDevice *)CopyIOPCIDeviceParent(*((IOPCIDevice **)v4 + 61));
    v18 = v17;
    v19 = CopyIOPCIDeviceParent(v17);
    v20 = v19 != 0;
    if ( v18 && v19 )
    {
      do
      {
        v43 = (IOPCIDevice *)v19;
        do
        {
          v20 = 1;
          if ( (unsigned __int8)IOService::isInactive(v4) )
            goto LABEL_40;
          v48 = 0;
          v47 = 0;
          v46 = 0;
          v45 = 0;
        }
        while ( (unsigned int)GetDataPropertyValue(v18, "vendor-id", &v48)
             || (unsigned int)GetDataPropertyValue(v18, "device-id", &v46)
             || (unsigned int)GetDataPropertyValue(v43, "vendor-id", &v47)
             || (unsigned int)GetDataPropertyValue(v43, "device-id", &v45) );
        if ( v48 == 32902
          && v47 == 32902
          && (unsigned __int16)(v46 & 0xFF00) == 5376
          && (unsigned __int16)(v45 & 0xFF00) == 5376 )
        {
          if ( !(unsigned __int8)IOService::isInactive(v4) )
          {
            v21 = -11;
            do
            {
              ++v21;
              if ( !v21
                || !(unsigned int)GetDataPropertyValue(v43, "Tunnel Endpoint Device Model ID", &v50)
                && !(unsigned int)GetDataPropertyValue(v43, "Tunnel Endpoint Device Vendor ID", &v49) )
                break;
              IOSleep(1000LL);
            }
            while ( !(unsigned __int8)IOService::isInactive(v4) );
          }
LABEL_40:
          v19 = (__int64)v43;
          v43 = v18;
          v40 = 1;
          break;
        }
        (*(void (__fastcall **)(IORegistryEntry *, _QWORD))(*(_QWORD *)v18 + 40LL))(v18, "device-id");
        v18 = v43;
        v19 = CopyIOPCIDeviceParent(v43);
        v20 = v19 != 0;
        v40 = v43 != 0LL;
      }
      while ( v43 && v19 );
    }
    else
    {
      v40 = v18 != 0LL;
      v43 = v18;
    }
    v38 = v19;
    if ( !(unsigned __int8)IOService::isInactive(v4) )
    {
      v22 = v50;
      (*(void (__fastcall **)(IOUSBControllerV3 *, _QWORD, _QWORD, signed __int64))(*(_QWORD *)v4 + 640LL))(
        v4,
        "Tunnel Endpoint Device Model ID",
        v50,
        32LL);
      v23 = v49;
      (*(void (__fastcall **)(IOUSBControllerV3 *, _QWORD, _QWORD, signed __int64))(*(_QWORD *)v4 + 640LL))(
        v4,
        "Tunnel Endpoint Device Vendor ID",
        v49,
        32LL);
      v24 = *((_QWORD *)v4 + 84);
      *(_DWORD *)(v24 + 24) = v22;
      *(_DWORD *)(v24 + 28) = v23;
    }
    if ( v40 )
      (*(void (**)(void))(*(_QWORD *)v43 + 40LL))();
    v25 = v20 == 0;
    v8 = v39;
    v12 = v41;
    if ( !v25 )
      (*(void (**)(void))(*(_QWORD *)v38 + 40LL))();
  }
  if ( *(_BYTE *)(*((_QWORD *)v4 + 21) + 244LL)
    && (v26 = *((_QWORD *)v4 + 84), *(_DWORD *)(v26 + 24) == 32770)
    && *(_DWORD *)(v26 + 28) == 1 )
  {
    v27 = gUSBStackDebugFlags & 0x10 ^ 0x10LL;
    LODWORD(v28) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)v4 + 61) + 696LL))(
                     *((_QWORD *)v4 + 61),
                     "AAPL,device-internal");
    if ( !v28 )
      (*(void (__fastcall **)(_QWORD, _QWORD, signed __int64, signed __int64))(**((_QWORD **)v4 + 61) + 640LL))(
        *((_QWORD *)v4 + 61),
        "AAPL,device-internal",
        2LL,
        8LL);
    v29 = v27 << 18;
    LODWORD(v30) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)v4 + 61) + 696LL))(
                     *((_QWORD *)v4 + 61),
                     "built-in");
    if ( !v30 )
      (*(void (__fastcall **)(_QWORD, _QWORD, _QWORD, signed __int64))(**((_QWORD **)v4 + 61) + 640LL))(
        *((_QWORD *)v4 + 61),
        "built-in",
        0LL,
        8LL);
    v31 = v8 | v29;
    if ( v8 & 0x1000000 )
    {
      v42 = v12;
      v32 = (IOPCIDevice *)CopyIOPCIDeviceParent(*((IOPCIDevice **)v4 + 61));
      v33 = v32;
      v34 = (IORegistryEntry *)CopyIOPCIDeviceParent(v32);
      v35 = v34;
      if ( v34 )
      {
        v36 = (__int64)"vendor-id";
        GetDataPropertyValue(v34, "vendor-id", &v44);
        if ( v44 == v7 )
        {
          v36 = (__int64)"IOPMPCISleepReset";
          (*(void (__fastcall **)(IORegistryEntry *, _QWORD, _QWORD))(*(_QWORD *)v35 + 616LL))(
            v35,
            "IOPMPCISleepReset",
            *(_QWORD *)v42);
        }
        (*(void (__fastcall **)(IORegistryEntry *, __int64))(*(_QWORD *)v35 + 40LL))(v35, v36);
      }
      if ( v33 )
        (*(void (__fastcall **)(IOPCIDevice *))(*(_QWORD *)v33 + 40LL))(v33);
    }
  }
  else
  {
LABEL_65:
    v31 = v8;
  }
  (*(void (__fastcall **)(IOUSBControllerV3 *, _QWORD, signed __int64, signed __int64))(*(_QWORD *)v4 + 640LL))(
    v4,
    "Errata",
    v31,
    64LL);
  return v31;
}
// 3A818: using guessed type __int64 qword_3A818[177];
// 3B0F8: using guessed type __int64 off_3B0F8[3];
// 49460: using guessed type int gUSBStackDebugFlags;
// 7D278: using guessed type int __fastcall IOSleep(_QWORD);

//----- (0000000000009AE6) ----------------------------------------------------
int __fastcall IOUSBController::OpenPipe(__int64 a1, unsigned int a2, unsigned int a3, __int64 a4)
{
  return (*(int (__fastcall **)(_QWORD, int (__fastcall *)(IOUSBController *, OSObject *, void *, void *, void *, void *), _QWORD, _QWORD, __int64, _QWORD))(**(_QWORD **)(a1 + 144) + 456LL))(
           *(_QWORD *)(a1 + 144),
           IOUSBController::DoCreateEP,
           a2,
           a3,
           a4,
           0LL);
}

//----- (0000000000009B10) ----------------------------------------------------
int __fastcall IOUSBController::ClosePipe(__int64 a1, unsigned int a2, __int64 a3)
{
  return (*(int (__fastcall **)(_QWORD, int (__fastcall *)(IOUSBController *, OSObject *, void *, void *, void *, void *), _QWORD, _QWORD, _QWORD, _QWORD))(**(_QWORD **)(a1 + 144) + 456LL))(
           *(_QWORD *)(a1 + 144),
           IOUSBController::DoDeleteEP,
           a2,
           *(_BYTE *)(a3 + 8),
           *(_BYTE *)(a3 + 9),
           0LL);
}

//----- (0000000000009B42) ----------------------------------------------------
int __fastcall IOUSBController::AbortPipe(__int64 a1, unsigned int a2, __int64 a3)
{
  return (*(int (__fastcall **)(_QWORD, int (__fastcall *)(IOUSBController *, OSObject *, void *, void *, void *, void *), _QWORD, _QWORD, _QWORD, _QWORD))(**(_QWORD **)(a1 + 144) + 456LL))(
           *(_QWORD *)(a1 + 144),
           IOUSBController::DoAbortEP,
           a2,
           *(_BYTE *)(a3 + 8),
           *(_BYTE *)(a3 + 9),
           0LL);
}

//----- (0000000000009B74) ----------------------------------------------------
int __fastcall IOUSBController::ResetPipe(__int64 a1, unsigned int a2, __int64 a3)
{
  return (*(int (__fastcall **)(_QWORD, int (__fastcall *)(IOUSBController *, OSObject *, void *, void *, void *, void *), _QWORD, _QWORD, _QWORD, _QWORD))(**(_QWORD **)(a1 + 144) + 456LL))(
           *(_QWORD *)(a1 + 144),
           IOUSBController::DoClearEPStall,
           a2,
           *(_BYTE *)(a3 + 8),
           *(_BYTE *)(a3 + 9),
           0LL);
}

//----- (0000000000009BA6) ----------------------------------------------------
int __fastcall IOUSBController::ClearPipeStall(__int64 a1, unsigned int a2, __int64 a3)
{
  return (*(int (__fastcall **)(_QWORD, int (__fastcall *)(IOUSBController *, OSObject *, void *, void *, void *, void *), _QWORD, _QWORD, _QWORD, _QWORD))(**(_QWORD **)(a1 + 144) + 456LL))(
           *(_QWORD *)(a1 + 144),
           IOUSBController::DoClearEPStall,
           a2,
           *(_BYTE *)(a3 + 8),
           *(_BYTE *)(a3 + 9),
           0LL);
}

//----- (0000000000009BD8) ----------------------------------------------------
__int64 __fastcall IOUSBController::CheckForDisjointDescriptor(IOUSBController *this, IOUSBCommand *a2, unsigned __int16 a3)
{
  unsigned __int16 v3; // r14@1
  uintptr_t v4; // r13@1
  int v5; // er12@1
  __int64 v6; // rdi@2
  __int64 v7; // rax@3
  uintptr_t v8; // rax@5
  uintptr_t v9; // rdx@9
  uintptr_t v10; // r8@9
  uintptr_t v11; // r15@11
  uintptr_t v12; // r14@11
  char v13; // al@18
  uintptr_t v14; // rax@22
  IOUSBCommand *v15; // rbx@24
  __int64 v16; // r12@24
  char v17; // al@24
  unsigned __int64 v18; // rcx@24
  IOMemoryDescriptor *v19; // r15@24
  int (__fastcall *v20)(_QWORD, _QWORD, _QWORD, _QWORD); // r12@26
  __int64 v21; // rax@26
  uintptr_t v22; // rsi@26
  __int64 v23; // rax@26
  IOMemoryDescriptor *v24; // rax@44
  __int64 v26; // [sp+28h] [bp-98h]@3
  uintptr_t arg1; // [sp+30h] [bp-90h]@1
  unsigned __int64 v28; // [sp+38h] [bp-88h]@11
  __int64 v29; // [sp+38h] [bp-88h]@25
  __int64 arg2; // [sp+40h] [bp-80h]@1
  __int64 v31; // [sp+60h] [bp-60h]@44
  __int64 v32; // [sp+68h] [bp-58h]@44
  __int64 v33; // [sp+70h] [bp-50h]@44
  uintptr_t arg3; // [sp+7Ch] [bp-44h]@12
  unsigned __int64 v35; // [sp+88h] [bp-38h]@14
  uintptr_t v36; // [sp+90h] [bp-30h]@12

  v3 = a3;
  arg1 = (uintptr_t)this;
  arg2 = IOUSBCommand::GetBuffer(a2);
  v4 = IOUSBCommand::GetReqCount(a2);
  v5 = 0;
  if ( v4 )
  {
    v6 = *(_QWORD *)(*((_QWORD *)a2 + 27) + 48LL);
    if ( v6 )
    {
      v26 = *(_QWORD *)(*((_QWORD *)a2 + 27) + 48LL);
      LODWORD(v7) = (*(int (**)(void))(*(_QWORD *)v6 + 312LL))();
      if ( v7 == arg2 )
      {
        v28 = v3;
        v11 = 0LL;
        v12 = 0LL;
        while ( 1 )
        {
          v36 = v11;
          LODWORD(arg3) = 1;
          if ( (*(int (__fastcall **)(__int64, uintptr_t *, char *, uintptr_t *))(*(_QWORD *)v6 + 344LL))(
                 v6,
                 &v36,
                 (char *)&arg3 + 4,
                 &arg3)
            || (_DWORD)arg3 != 1 )
          {
            v13 = gUSBStackDebugFlags;
            if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
            {
              kernel_debug(0x52D0048u, v36, v4, v12, 3uLL, 0LL);
              v13 = gUSBStackDebugFlags;
            }
            v5 = -536870206;
            if ( v13 & 2 )
            {
              v14 = IOUSBCommand::GetReqCount(a2);
              if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
                kernel_debug(0x52D0048u, v12, v14, (unsigned int)arg3, 4uLL, 0LL);
            }
            return (unsigned int)v5;
          }
          v12 = v35;
          v5 = 0;
          if ( v4 <= v35 )
            return (unsigned int)v5;
          if ( v35 % v28 )
            break;
          v11 += v35;
          v4 -= v35;
          v5 = -536870206;
          if ( !v4 )
            return (unsigned int)v5;
        }
        v15 = a2;
        v16 = IOUSBCommand::GetReqCount(a2);
        v17 = IOUSBCommand::GetDirection(a2);
        v19 = (IOMemoryDescriptor *)IOBufferMemoryDescriptor::withOptions(
                                      (IOBufferMemoryDescriptor *)((unsigned int)(v17 != 1) + 1),
                                      v16,
                                      1uLL,
                                      v18);
        if ( v19 )
        {
          v29 = v16;
          (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v26 + 304LL))(v26, 1LL);
          if ( (unsigned __int8)IOUSBCommand::GetDirection(a2)
            || (v20 = *(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)arg2 + 480LL),
                LODWORD(v21) = (*(int (__fastcall **)(IOMemoryDescriptor *))(*(_QWORD *)v19 + 736LL))(v19),
                v22 = 0LL,
                LODWORD(v23) = v20(arg2, 0LL, v21, v29),
                v23 == v29) )
          {
            v5 = (*(int (__fastcall **)(IOMemoryDescriptor *, _QWORD))(*(_QWORD *)v19 + 496LL))(v19, 0LL);
            if ( v5 )
            {
              if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
                kernel_debug(0x52D0048u, arg1, v5, 0LL, 7uLL, 0LL);
LABEL_39:
              (*(void (__fastcall **)(IOMemoryDescriptor *))(*(_QWORD *)v19 + 40LL))(v19);
              return (unsigned int)v5;
            }
            v5 = (*(int (__fastcall **)(__int64, IOMemoryDescriptor *, signed __int64))(*(_QWORD *)v6 + 296LL))(
                   v6,
                   v19,
                   1LL);
            if ( v5 )
            {
              if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
                kernel_debug(0x52D0048u, arg1, v5, 0LL, 8uLL, 0LL);
              (*(void (__fastcall **)(IOMemoryDescriptor *, _QWORD))(*(_QWORD *)v19 + 504LL))(v19, 0LL);
              goto LABEL_39;
            }
            v24 = (IOMemoryDescriptor *)IOUSBCommand::GetBuffer(v15);
            IOUSBCommand::SetOrigBuffer(v15, v24);
            IOUSBCommand::GetClientCompletion((IOUSBCommand *)&v31, (__int64)v15);
            IOUSBCommand::SetDisjointCompletion((__int64)v15, v31, v32, v33);
            IOUSBCommand::SetBuffer(v15, v19);
            IOUSBCommand::SetClientCompletion((__int64)v15, arg1, (__int64)DisjointCompletion, (__int64)v15);
            IOUSBCommand::SetDblBufLength(v15, v29);
            v5 = 0;
          }
          else
          {
            if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
            {
              v22 = arg1;
              kernel_debug(0x52D0048u, arg1, 0LL, 0LL, 6uLL, 0LL);
            }
            (*(void (__fastcall **)(IOMemoryDescriptor *, uintptr_t))(*(_QWORD *)v19 + 40LL))(v19, v22);
            v5 = -536870211;
          }
        }
        else
        {
          v5 = -536870211;
          if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          {
            v9 = -536870211LL;
            v10 = 5LL;
            goto LABEL_10;
          }
        }
      }
      else
      {
        v5 = -536870206;
        if ( gUSBStackDebugFlags & 2 )
        {
          LODWORD(v8) = (*(int (**)(void))(*(_QWORD *)v6 + 312LL))();
          if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
            kernel_debug(0x52D0048u, 0xFFFFFFFFE00002C2LL, arg2, v8, 2uLL, 0LL);
        }
      }
    }
    else
    {
      v5 = -536870206;
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        v9 = -536870206LL;
        v10 = 1LL;
LABEL_10:
        kernel_debug(0x52D0048u, arg1, v9, 0LL, v10, 0LL);
      }
    }
  }
  return (unsigned int)v5;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (000000000000A0C1) ----------------------------------------------------
void __fastcall DisjointCompletion(uintptr_t arg1, IOUSBCommand *this, unsigned int a3, unsigned int a4, __int64 a5, __int64 a6)
{
  unsigned int v6; // er14@1
  unsigned int v7; // ebx@1
  __int64 v8; // r15@1
  uintptr_t v9; // r12@1
  OSMetaClassBase *v10; // rax@6
  __int64 v11; // rsi@6
  const OSMetaClass *v12; // rdx@6
  uintptr_t v13; // r13@6
  __int64 v14; // r14@6
  __int64 v15; // rax@8
  __int64 v16; // rax@9
  uintptr_t v17; // rax@11
  __int64 v18; // r14@15
  void (__fastcall *v19)(_QWORD, _QWORD, _QWORD, _QWORD); // ST10_8@15
  __int64 v20; // rax@15
  __int64 v21; // ST08_8@15
  __int64 v22; // rax@15
  uintptr_t v23; // rsi@22
  uintptr_t v24; // rdx@22
  uintptr_t v25; // r8@22
  uintptr_t v26; // rcx@22
  uint32_t v27; // edi@22
  __int64 v28; // rax@25
  char v29; // [sp+0h] [bp-60h]@0
  unsigned int v30; // [sp+1Ch] [bp-44h]@6
  uintptr_t v31; // [sp+20h] [bp-40h]@16
  __int64 v32; // [sp+28h] [bp-38h]@18
  uintptr_t v33; // [sp+30h] [bp-30h]@19

  v6 = a4;
  v7 = a3;
  v8 = (__int64)this;
  v9 = arg1;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D0045u, arg1, (uintptr_t)this, (signed int)a3, a4, 0LL);
  if ( !arg1 || !this )
  {
    KernelDebugLogInternal(
      1u,
      0x55534246u,
      (__int64)"DisjointCompletion sanity check failed - me(%p) command (%p)",
      arg1,
      (__int64)this,
      a6,
      v29);
    return;
  }
  v30 = v6;
  v10 = (OSMetaClassBase *)IOUSBCommand::GetBuffer(this);
  v11 = *off_3B050;
  v13 = OSMetaClassBase::safeMetaCast(v10, (const OSMetaClassBase *)*off_3B050, v12);
  v14 = *(_QWORD *)(*(_QWORD *)(v8 + 216) + 48LL);
  if ( v14 && v13 )
  {
    LODWORD(v15) = (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v14 + 312LL))(v14, v11);
    if ( v15 )
    {
      LODWORD(v16) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v14 + 312LL))(v14);
      if ( v16 != v13 )
      {
        if ( gUSBStackDebugFlags & 2 )
        {
          LODWORD(v17) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v14 + 312LL))(v14);
          if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
            kernel_debug(0x52D0044u, arg1, v13, v17, 2uLL, 0LL);
        }
      }
      (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v14 + 304LL))(v14, 1LL);
    }
    if ( (unsigned __int8)IOUSBCommand::GetDirection((IOUSBCommand *)v8) == 1 )
    {
      v18 = IOUSBCommand::GetOrigBuffer((IOUSBCommand *)v8);
      v19 = *(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v18 + 488LL);
      LODWORD(v20) = (*(int (__fastcall **)(uintptr_t))(*(_QWORD *)v13 + 736LL))(v13);
      v21 = v20;
      v22 = IOUSBCommand::GetDblBufLength((IOUSBCommand *)v8);
      v19(v18, 0LL, v21, v22 - v30);
    }
    (*(void (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)v13 + 504LL))(v13, 0LL);
    (*(void (__fastcall **)(uintptr_t))(*(_QWORD *)v13 + 40LL))(v13);
    IOUSBCommand::SetBuffer((IOUSBCommand *)v8, 0LL);
    IOUSBCommand::GetDisjointCompletion((IOUSBCommand *)&v31, v8);
    if ( !IOUSBCommand::GetIsSyncTransfer((IOUSBCommand *)v8) )
      IOUSBController::ReturnUSBCommand((IOUSBController *)arg1, (IOUSBCommand *)v8);
    if ( v32 )
      ((void (__fastcall *)(uintptr_t, uintptr_t, _QWORD, _QWORD))v32)(v31, v33, v7, v30);
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      v23 = v31;
      v24 = v33;
      v25 = v30;
      v26 = (signed int)v7;
      v27 = 86835270;
LABEL_27:
      kernel_debug(v27, v23, v24, v26, v25, 0LL);
      return;
    }
  }
  else if ( gUSBStackDebugFlags & 2 )
  {
    v28 = IOUSBCommand::GetBuffer((IOUSBCommand *)v8);
    if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      v27 = 86835268;
      v26 = 0LL;
      v25 = 1LL;
      v23 = v9;
      v24 = v28;
      goto LABEL_27;
    }
  }
}
// 3B050: using guessed type _QWORD *off_3B050;
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000000A336) ----------------------------------------------------
int __fastcall IOUSBController::Read(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5)
{
  return (*(int (__fastcall **)(__int64, __int64, __int64, __int64, __int64, _QWORD))(*(_QWORD *)a1 + 2544LL))(
           a1,
           a2,
           a3,
           a4,
           a5,
           0LL);
}

//----- (000000000000A358) ----------------------------------------------------
int __fastcall IOUSBController::Read(__int64 a1, __int64 a2, unsigned __int16 a3, __int64 a4, __int64 a5, unsigned int a6)
{
  unsigned __int16 v6; // r13@1
  int (__fastcall *v7)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD); // ST20_8@2
  unsigned int v8; // ST1C_4@2
  __int64 v9; // r12@2
  __int64 v10; // r15@2
  int result; // eax@2

  v6 = a3;
  if ( a2 )
  {
    v7 = *(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 2576LL);
    v8 = a6;
    v9 = a5;
    v10 = a4;
    (*(void (__fastcall **)(__int64))(*(_QWORD *)a2 + 456LL))(a2);
    result = v7(a1, a2, v6, v10, v9, v8);
  }
  else
  {
    result = -536870206;
  }
  return result;
}

//----- (000000000000A3D4) ----------------------------------------------------
__int64 __fastcall IOUSBController::Read(IOUSBController *this, IOMemoryDescriptor *a2, __int16 a3, __int64 a4, __int64 a5, int a6, int a7, __int64 a8)
{
  signed int v8; // ebx@1
  __int64 v9; // r15@3
  int v10; // er12@3
  unsigned __int64 v11; // rax@3
  __int64 v12; // rdx@4
  int v13; // ecx@4
  __int64 v14; // r12@4
  int v15; // ebx@8
  __int64 v16; // rax@14
  __int64 v17; // r8@14
  __int64 v18; // r9@14
  __int64 v19; // rax@15
  const OSMetaClass *v20; // rdx@15
  int v21; // ecx@15
  __int64 v22; // rax@16
  int v23; // er13@17
  uintptr_t v24; // rbx@17
  uintptr_t v25; // rax@19
  int v26; // er15@24
  IOUSBController *v27; // r14@26
  __int64 v28; // rax@28
  int v29; // ebx@29
  __int64 v30; // rbx@35
  __int64 v31; // rax@39
  char v33; // [sp+0h] [bp-C0h]@0
  uintptr_t v34; // [sp+18h] [bp-A8h]@25
  int v35; // [sp+24h] [bp-9Ch]@17
  char v36; // [sp+34h] [bp-8Ch]@9
  __int64 v37; // [sp+38h] [bp-88h]@15
  __int16 v38; // [sp+44h] [bp-7Ch]@3
  __int64 v39; // [sp+48h] [bp-78h]@3
  char v40; // [sp+50h] [bp-70h]@43
  __int64 v41; // [sp+68h] [bp-58h]@31
  __int64 v42; // [sp+70h] [bp-50h]@31
  __int64 v43; // [sp+78h] [bp-48h]@31
  __int64 v44; // [sp+80h] [bp-40h]@28
  __int64 v45; // [sp+88h] [bp-38h]@28
  __int64 v46; // [sp+90h] [bp-30h]@28

  v8 = -536870206;
  if ( *(_BYTE *)(a4 + 9) == 1 )
  {
    if ( a2 )
    {
      v38 = a3;
      v39 = a4;
      v9 = a5;
      v10 = a6;
      LODWORD(v11) = (*(int (__fastcall **)(IOMemoryDescriptor *))(*(_QWORD *)a2 + 456LL))(a2);
      if ( v11 >= a8 )
      {
        v12 = (unsigned int)a7;
        v13 = v10;
        v14 = v9;
        if ( *(_BYTE *)(v39 + 10) == 2 || !(v13 | a7) )
        {
          v8 = -536870166;
          if ( v9 )
          {
            if ( *((_QWORD *)this + 18) )
            {
              v15 = v13;
              if ( *(_QWORD (__cdecl **)(void *, void *, int, unsigned int))(v9 + 8) == off_3B000 )
              {
                v36 = 1;
                if ( (unsigned __int8)(*(int (__fastcall **)(_QWORD, IOMemoryDescriptor *, _QWORD))(**((_QWORD **)this + 17)
                                                                                                  + 304LL))(
                                        *((_QWORD *)this + 17),
                                        a2,
                                        (unsigned int)a7) )
                {
                  LODWORD(v16) = (*(int (__fastcall **)(IOUSBController *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
                  KernelDebugLogInternal(
                    1u,
                    0x55534246u,
                    (__int64)"IOUSBController(%s)::Read sync request on workloop thread.  Use async!",
                    v16,
                    v17,
                    v18,
                    v33);
                  v8 = -536854454;
                  return (unsigned int)v8;
                }
              }
              else
              {
                v36 = 0;
              }
              LODWORD(v19) = (*(int (__fastcall **)(_QWORD, _QWORD, __int64))(***((_QWORD ***)this + 21) + 296LL))(
                               **((_QWORD **)this + 21),
                               0LL,
                               v12);
              v37 = v19;
              v21 = v15;
              if ( v19
                || (IOUSBController::IncreaseCommandPool(this, 0LL, v20),
                    LODWORD(v22) = (*(int (__fastcall **)(_QWORD, _QWORD))(***((_QWORD ***)this + 21) + 296LL))(
                                     **((_QWORD **)this + 21),
                                     0LL),
                    v21 = v15,
                    v37 = v22,
                    v8 = -536870210,
                    v22) )
              {
                v35 = v21;
                v23 = 0;
                v24 = 0LL;
                if ( a8 )
                {
                  v24 = *(_QWORD *)(*(_QWORD *)(v37 + 216) + 48LL);
                  if ( !v24 )
                  {
                    v26 = -536870210;
                    if ( gUSBStackDebugFlags & 2 )
                    {
                      v27 = this;
                      v30 = v37;
                      if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
                        kernel_debug(0x52D004Cu, (uintptr_t)this, 0xFFFFFFFFE00002BELL, 0LL, 2uLL, 0LL);
                      goto LABEL_43;
                    }
                    v27 = this;
                    goto LABEL_42;
                  }
                  LODWORD(v25) = (*(int (__fastcall **)(uintptr_t))(*(_QWORD *)v24 + 312LL))(v24);
                  if ( v25 )
                  {
                    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
                      kernel_debug(0x52D004Cu, (uintptr_t)this, v24, v25, 3uLL, 0LL);
                    (*(void (__fastcall **)(uintptr_t, signed __int64))(*(_QWORD *)v24 + 304LL))(v24, 1LL);
                  }
                  v26 = (*(int (__fastcall **)(uintptr_t, IOMemoryDescriptor *, signed __int64))(*(_QWORD *)v24 + 296LL))(
                          v24,
                          a2,
                          1LL);
                  if ( v26 )
                  {
                    v34 = v24;
                    if ( gUSBStackDebugFlags & 2 )
                    {
                      v27 = this;
                      if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
                        kernel_debug(0x52D004Cu, (uintptr_t)this, v26, 0LL, 5uLL, 0LL);
                    }
                    else
                    {
                      v27 = this;
                    }
LABEL_38:
                    if ( v34 )
                    {
                      LODWORD(v31) = (*(int (__fastcall **)(uintptr_t))(*(_QWORD *)v34 + 312LL))(v34);
                      v30 = v37;
                      if ( v31 )
                        (*(void (__fastcall **)(uintptr_t, signed __int64))(*(_QWORD *)v34 + 304LL))(v34, 1LL);
                      goto LABEL_43;
                    }
LABEL_42:
                    v30 = v37;
LABEL_43:
                    IOUSBCommand::GetDisjointCompletion((IOUSBCommand *)&v40, v30);
                    (*(void (__fastcall **)(_QWORD, __int64))(***((_QWORD ***)v27 + 21) + 304LL))(
                      **((_QWORD **)v27 + 21),
                      v30);
                    v8 = v26;
                    return (unsigned int)v8;
                  }
                }
                v34 = v24;
                IOUSBCommand::SetIsSyncTransfer((IOUSBCommand *)v37, v36);
                IOUSBCommand::SetUseTimeStamp((IOUSBCommand *)v37, 0);
                IOUSBCommand::SetSelector(v37, 1);
                IOUSBCommand::SetRequest(v37, 0LL);
                IOUSBCommand::SetAddress((IOUSBCommand *)v37, v38);
                IOUSBCommand::SetEndpoint((IOUSBCommand *)v37, *(_BYTE *)(v39 + 8));
                *(_DWORD *)(*(_QWORD *)(v37 + 216) + 72LL) = 0;
                IOUSBCommand::SetDirection((IOUSBCommand *)v37, 1);
                IOUSBCommand::SetType((IOUSBCommand *)v37, *(_BYTE *)(v39 + 10));
                IOUSBCommand::SetBuffer((IOUSBCommand *)v37, a2);
                IOUSBCommand::SetReqCount((IOUSBCommand *)v37, a8);
                v46 = *(_QWORD *)(v14 + 16);
                v28 = *(_QWORD *)v14;
                v45 = *(_QWORD *)(v14 + 8);
                v44 = v28;
                IOUSBCommand::SetClientCompletion(v37, v28, v45, v46);
                IOUSBCommand::SetNoDataTimeout((IOUSBCommand *)v37, v35);
                IOUSBCommand::SetCompletionTimeout((IOUSBCommand *)v37, a7);
                IOUSBCommand::SetMultiTransferTransaction((IOUSBCommand *)v37, 0);
                IOUSBCommand::SetFinalTransferInTransaction((IOUSBCommand *)v37, 0);
                do
                {
                  v29 = 0;
                  IOUSBCommand::SetUIMScratch((IOUSBCommand *)v37, v23++, 0);
                }
                while ( v23 != 10 );
                do
                  IOUSBCommand::SetUIMScratch64((IOUSBCommand *)v37, v29++, 0LL);
                while ( v29 != 5 );
                v41 = 0LL;
                v42 = 0LL;
                v43 = 0LL;
                IOUSBCommand::SetDisjointCompletion(v37, 0LL, 0LL, 0LL);
                v27 = this;
                v26 = (*(int (__fastcall **)(IOUSBController *, __int64, _QWORD))(*(_QWORD *)this + 2616LL))(
                        this,
                        v37,
                        *(_WORD *)(v39 + 12));
                if ( v26 )
                  goto LABEL_38;
                v8 = 0;
                v26 = (*(int (__fastcall **)(_QWORD, __int64 (__fastcall *)(uintptr_t, OSObject *, void *, void *, void *, void *), __int64, _QWORD, _QWORD, _QWORD))(**((_QWORD **)this + 18) + 456LL))(
                        *((_QWORD *)this + 18),
                        IOUSBController::DoIOTransfer,
                        v37,
                        0LL,
                        0LL,
                        0LL);
                if ( (v26 != 0) | (unsigned __int8)v36 )
                  goto LABEL_38;
              }
            }
            else
            {
              v8 = -536870199;
              if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
                kernel_debug(0x52D004Cu, (uintptr_t)this, 0xFFFFFFFFE00002C9LL, 0LL, 1uLL, 0LL);
            }
          }
        }
      }
    }
  }
  return (unsigned int)v8;
}
// 3B000: using guessed type _QWORD (__cdecl *off_3B000)(void *, void *, int, unsigned int);
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (000000000000A926) ----------------------------------------------------
int __fastcall IOUSBController::Write(__int64 a1, __int64 a2, __int64 a3, __int64 a4, __int64 a5)
{
  return (*(int (__fastcall **)(__int64, __int64, __int64, __int64, __int64, _QWORD))(*(_QWORD *)a1 + 2552LL))(
           a1,
           a2,
           a3,
           a4,
           a5,
           0LL);
}

//----- (000000000000A948) ----------------------------------------------------
int __fastcall IOUSBController::Write(__int64 a1, __int64 a2, unsigned __int16 a3, __int64 a4, __int64 a5, unsigned int a6)
{
  unsigned __int16 v6; // r13@1
  int (__fastcall *v7)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD); // ST20_8@2
  unsigned int v8; // ST1C_4@2
  __int64 v9; // r12@2
  __int64 v10; // r15@2
  int result; // eax@2

  v6 = a3;
  if ( a2 )
  {
    v7 = *(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 2584LL);
    v8 = a6;
    v9 = a5;
    v10 = a4;
    (*(void (__fastcall **)(__int64))(*(_QWORD *)a2 + 456LL))(a2);
    result = v7(a1, a2, v6, v10, v9, v8);
  }
  else
  {
    result = -536870206;
  }
  return result;
}

//----- (000000000000A9C4) ----------------------------------------------------
__int64 __fastcall IOUSBController::Write(IOUSBController *this, IOMemoryDescriptor *a2, __int16 a3, __int64 a4, __int64 a5, int a6, int a7, __int64 a8)
{
  int v8; // ebx@1
  signed int v9; // er15@1
  __int64 v10; // r13@3
  unsigned __int64 v11; // rax@3
  __int64 v12; // rdx@3
  __int64 v13; // rcx@4
  char v14; // al@9
  __int64 v15; // rax@10
  __int64 v16; // r8@10
  __int64 v17; // r9@10
  __int64 v18; // rax@11
  const OSMetaClass *v19; // rdx@11
  int v20; // er12@13
  uintptr_t v21; // rbx@13
  __int64 v22; // r15@13
  uintptr_t v23; // rax@15
  int v24; // er13@20
  __int64 v25; // r12@22
  IOUSBController *v26; // r14@22
  __int64 v27; // rax@24
  int v28; // ebx@25
  __int64 v29; // rdx@27
  __int64 v30; // rax@36
  char v32; // [sp+0h] [bp-C0h]@0
  uintptr_t v33; // [sp+20h] [bp-A0h]@21
  __int64 v34; // [sp+28h] [bp-98h]@8
  char v35; // [sp+3Ch] [bp-84h]@8
  int v36; // [sp+40h] [bp-80h]@4
  __int16 v37; // [sp+44h] [bp-7Ch]@3
  __int64 v38; // [sp+48h] [bp-78h]@3
  char v39; // [sp+50h] [bp-70h]@40
  __int64 v40; // [sp+68h] [bp-58h]@27
  __int64 v41; // [sp+70h] [bp-50h]@27
  __int64 v42; // [sp+78h] [bp-48h]@27
  __int64 v43; // [sp+80h] [bp-40h]@24
  __int64 v44; // [sp+88h] [bp-38h]@24
  __int64 v45; // [sp+90h] [bp-30h]@24

  v8 = a6;
  v9 = -536870206;
  if ( !*(_BYTE *)(a4 + 9) )
  {
    if ( a2 )
    {
      v37 = a3;
      v38 = a4;
      v10 = a5;
      LODWORD(v11) = (*(int (__fastcall **)(IOMemoryDescriptor *))(*(_QWORD *)a2 + 456LL))(a2);
      if ( v11 >= a8 )
      {
        v36 = v8;
        v13 = (unsigned int)a7;
        if ( *(_BYTE *)(v38 + 10) == 2 || !(v8 | a7) )
        {
          v9 = -536870199;
          if ( *((_QWORD *)this + 18) )
          {
            if ( *(_QWORD (__cdecl **)(void *, void *, int, unsigned int))(v10 + 8) == off_3B000 )
            {
              v34 = v10;
              v14 = (*(int (__fastcall **)(_QWORD, IOMemoryDescriptor *, __int64, _QWORD))(**((_QWORD **)this + 17)
                                                                                         + 304LL))(
                      *((_QWORD *)this + 17),
                      a2,
                      v12,
                      (unsigned int)a7);
              LOBYTE(v13) = 1;
              v35 = 1;
              if ( v14 )
              {
                LODWORD(v15) = (*(int (__fastcall **)(IOUSBController *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
                KernelDebugLogInternal(
                  1u,
                  0x55534246u,
                  (__int64)"IOUSBController(%s)::Write sync request on workloop thread.  Use async!",
                  v15,
                  v16,
                  v17,
                  v32);
                v9 = -536854454;
                return (unsigned int)v9;
              }
            }
            else
            {
              v34 = v10;
              v35 = 0;
            }
            LODWORD(v18) = (*(int (__fastcall **)(_QWORD, _QWORD, __int64, __int64))(***((_QWORD ***)this + 21) + 296LL))(
                             **((_QWORD **)this + 21),
                             0LL,
                             v12,
                             v13);
            if ( v18
              || (IOUSBController::IncreaseCommandPool(this, 0LL, v19),
                  LODWORD(v18) = (*(int (__fastcall **)(_QWORD, _QWORD))(***((_QWORD ***)this + 21) + 296LL))(
                                   **((_QWORD **)this + 21),
                                   0LL),
                  v9 = -536870210,
                  v18) )
            {
              v20 = 0;
              v21 = 0LL;
              v22 = v18;
              if ( a8 )
              {
                v21 = *(_QWORD *)(*(_QWORD *)(v18 + 216) + 48LL);
                if ( !v21 )
                {
                  v24 = -536870210;
                  if ( gUSBStackDebugFlags & 2 )
                  {
                    v26 = this;
                    if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
                      kernel_debug(0x52D0064u, (uintptr_t)this, 0xFFFFFFFFE00002BELL, 0LL, 1uLL, 0LL);
                  }
                  else
                  {
                    v26 = this;
                  }
                  goto LABEL_40;
                }
                LODWORD(v23) = (*(int (__fastcall **)(uintptr_t))(*(_QWORD *)v21 + 312LL))(v21);
                if ( v23 )
                {
                  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
                    kernel_debug(0x52D0064u, (uintptr_t)this, v21, v23, 2uLL, 0LL);
                  (*(void (__fastcall **)(uintptr_t, signed __int64))(*(_QWORD *)v21 + 304LL))(v21, 1LL);
                }
                v24 = (*(int (__fastcall **)(uintptr_t, IOMemoryDescriptor *, signed __int64))(*(_QWORD *)v21 + 296LL))(
                        v21,
                        a2,
                        1LL);
                if ( v24 )
                {
                  v33 = v21;
                  if ( gUSBStackDebugFlags & 2 )
                  {
                    v25 = v22;
                    v26 = this;
                    if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
                      kernel_debug(0x52D0064u, (uintptr_t)this, v24, 0LL, 4uLL, 0LL);
                  }
                  else
                  {
                    v25 = v22;
                    v26 = this;
                  }
                  goto LABEL_35;
                }
              }
              v33 = v21;
              IOUSBCommand::SetIsSyncTransfer((IOUSBCommand *)v22, v35);
              IOUSBCommand::SetUseTimeStamp((IOUSBCommand *)v22, 0);
              IOUSBCommand::SetSelector(v22, 2);
              IOUSBCommand::SetRequest(v22, 0LL);
              IOUSBCommand::SetAddress((IOUSBCommand *)v22, v37);
              IOUSBCommand::SetEndpoint((IOUSBCommand *)v22, *(_BYTE *)(v38 + 8));
              *(_DWORD *)(*(_QWORD *)(v22 + 216) + 72LL) = 0;
              IOUSBCommand::SetDirection((IOUSBCommand *)v22, 0);
              IOUSBCommand::SetType((IOUSBCommand *)v22, *(_BYTE *)(v38 + 10));
              IOUSBCommand::SetBuffer((IOUSBCommand *)v22, a2);
              IOUSBCommand::SetReqCount((IOUSBCommand *)v22, a8);
              v45 = *(_QWORD *)(v34 + 16);
              v27 = *(_QWORD *)v34;
              v44 = *(_QWORD *)(v34 + 8);
              v43 = v27;
              IOUSBCommand::SetClientCompletion(v22, v27, v44, v45);
              IOUSBCommand::SetNoDataTimeout((IOUSBCommand *)v22, v36);
              IOUSBCommand::SetCompletionTimeout((IOUSBCommand *)v22, a7);
              IOUSBCommand::SetMultiTransferTransaction((IOUSBCommand *)v22, 0);
              IOUSBCommand::SetFinalTransferInTransaction((IOUSBCommand *)v22, 0);
              do
              {
                v28 = 0;
                IOUSBCommand::SetUIMScratch((IOUSBCommand *)v22, v20++, 0);
              }
              while ( v20 != 10 );
              do
                IOUSBCommand::SetUIMScratch64((IOUSBCommand *)v22, v28++, 0LL);
              while ( v28 != 5 );
              v40 = 0LL;
              v41 = 0LL;
              v42 = 0LL;
              IOUSBCommand::SetDisjointCompletion(v22, 0LL, 0LL, 0LL);
              v26 = this;
              v24 = (*(int (__fastcall **)(IOUSBController *, __int64, _QWORD))(*(_QWORD *)this + 2616LL))(
                      this,
                      v22,
                      *(_WORD *)(v38 + 12));
              v29 = v22;
              if ( v24 )
              {
                v25 = v22;
                goto LABEL_35;
              }
              v9 = 0;
              v25 = v29;
              v24 = (*(int (__fastcall **)(_QWORD, __int64 (__fastcall *)(uintptr_t, OSObject *, void *, void *, void *, void *), __int64, _QWORD, _QWORD, _QWORD))(**((_QWORD **)this + 18) + 456LL))(
                      *((_QWORD *)this + 18),
                      IOUSBController::DoIOTransfer,
                      v29,
                      0LL,
                      0LL,
                      0LL);
              if ( (v24 != 0) | (unsigned __int8)v35 )
              {
LABEL_35:
                if ( v33 )
                {
                  LODWORD(v30) = (*(int (__fastcall **)(uintptr_t))(*(_QWORD *)v33 + 312LL))(v33);
                  v22 = v25;
                  if ( v30 )
                    (*(void (__fastcall **)(uintptr_t, signed __int64))(*(_QWORD *)v33 + 304LL))(v33, 1LL);
                }
                else
                {
                  v22 = v25;
                }
LABEL_40:
                IOUSBCommand::GetDisjointCompletion((IOUSBCommand *)&v39, v22);
                (*(void (__fastcall **)(_QWORD, __int64))(***((_QWORD ***)v26 + 21) + 304LL))(
                  **((_QWORD **)v26 + 21),
                  v22);
                v9 = v24;
                return (unsigned int)v9;
              }
            }
          }
        }
      }
    }
  }
  return (unsigned int)v9;
}
// 3B000: using guessed type _QWORD (__cdecl *off_3B000)(void *, void *, int, unsigned int);
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (000000000000AEAE) ----------------------------------------------------
__int64 __fastcall IOUSBController::IsocIO(IOUSBController *this, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int16 a6, __int64 a7, __int64 a8)
{
  uintptr_t v8; // rbx@1
  int v9; // er13@1
  unsigned __int8 v10; // al@3
  int v11; // er14@8
  __int64 v12; // r13@8
  char v13; // al@9
  __int64 v14; // rdx@9
  __int64 v15; // rax@10
  __int64 v16; // r8@10
  __int64 v17; // r9@10
  __int64 v18; // rax@11
  const OSMetaClass *v19; // rdx@11
  __int64 v20; // rcx@11
  __int64 v21; // rdi@13
  __int64 v22; // r10@15
  __int64 v23; // rax@22
  int v24; // ecx@22
  __int64 v25; // ST58_8@26
  __int64 v26; // ST50_8@26
  int v27; // er14@26
  __int64 v28; // r15@27
  __int64 v29; // rax@28
  char v31; // [sp+0h] [bp-90h]@0
  __int64 v32; // [sp+10h] [bp-80h]@14
  __int64 v33; // [sp+18h] [bp-78h]@14
  unsigned __int8 v34; // [sp+20h] [bp-70h]@11
  __int16 v35; // [sp+24h] [bp-6Ch]@8
  __int64 v36; // [sp+28h] [bp-68h]@8
  char v37; // [sp+34h] [bp-5Ch]@4

  v8 = (uintptr_t)this;
  v9 = -536870166;
  if ( a8 )
  {
    v9 = -536870199;
    if ( *((_QWORD *)this + 18) )
    {
      v10 = *(_BYTE *)(a7 + 9);
      if ( (v10 & 0x80u) != 0 )
      {
        v10 &= 0x7Fu;
        *(_BYTE *)(a7 + 9) = v10;
        v37 = 1;
      }
      else
      {
        v37 = 0;
      }
      v9 = -536870206;
      if ( v10 <= 1u )
      {
        if ( *(__int64 (__fastcall **)())(a8 + 8) == off_3B008[0] )
        {
          v35 = a6;
          v36 = a3;
          v11 = a4;
          v12 = a5;
          v13 = (*(int (**)(void))(**((_QWORD **)this + 17) + 304LL))();
          LOBYTE(a4) = 1;
          if ( v13 )
          {
            LODWORD(v15) = (*(int (__fastcall **)(IOUSBController *, _QWORD, __int64, __int64))(*(_QWORD *)this + 904LL))(
                             this,
                             0LL,
                             v14,
                             a4);
            KernelDebugLogInternal(
              1u,
              0x55534246u,
              (__int64)"IOUSBController(%s)::DoIsocTransfer sync request on workloop thread.  Use async!",
              v15,
              v16,
              v17,
              v31);
            v9 = -536854454;
            return (unsigned int)v9;
          }
        }
        else
        {
          v35 = a6;
          v36 = a3;
          v11 = a4;
          v12 = a5;
          LOBYTE(a4) = 0;
        }
        v34 = a4;
        LODWORD(v18) = (*(int (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(*((_QWORD *)this + 21) + 8LL) + 296LL))(
                         *(_QWORD *)(*((_QWORD *)this + 21) + 8LL),
                         0LL);
        v20 = v12;
        if ( v18
          || (IOUSBController::IncreaseIsocCommandPool(this, 0LL, v19),
              LODWORD(v18) = (*(int (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(*((_QWORD *)this + 21) + 8LL) + 296LL))(
                               *(_QWORD *)(*((_QWORD *)this + 21) + 8LL),
                               0LL),
              v20 = v12,
              v9 = -536870210,
              v18) )
        {
          v21 = *(_QWORD *)(*(_QWORD *)(v18 + 104) + 24LL);
          if ( v21 )
          {
            v33 = v18;
            v32 = v20;
            v9 = (*(int (__fastcall **)(__int64, __int64, signed __int64))(*(_QWORD *)v21 + 296LL))(v21, a2, 1LL);
            if ( v9 )
            {
              v22 = v33;
              if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
              {
                kernel_debug(0x52D0060u, v8, v9, 0LL, 2uLL, 0LL);
                v22 = v33;
              }
              (*(void (__fastcall **)(_QWORD, __int64))(**(_QWORD **)(*(_QWORD *)(v8 + 168) + 8LL) + 304LL))(
                *(_QWORD *)(*(_QWORD *)(v8 + 168) + 8LL),
                v22);
            }
            else
            {
              v23 = *(_QWORD *)(v33 + 104);
              *(_BYTE *)(v23 + 17) = v37;
              *(_BYTE *)(v23 + 16) = v34;
              v24 = *(_BYTE *)(a7 + 9);
              if ( v24 == 1 )
              {
                *(_DWORD *)(v33 + 32) = 1;
                *(_BYTE *)(v33 + 39) = 1;
              }
              else if ( !(_BYTE)v24 )
              {
                *(_DWORD *)(v33 + 32) = 2;
                *(_BYTE *)(v33 + 39) = 0;
              }
              *(_BYTE *)(v23 + 4) = 0;
              *(_WORD *)(v33 + 36) = v35;
              *(_BYTE *)(v33 + 38) = *(_BYTE *)(a7 + 8);
              *(_QWORD *)(v33 + 40) = a2;
              v25 = *(_QWORD *)(a8 + 8);
              v26 = *(_QWORD *)a8;
              *(_QWORD *)(v33 + 64) = *(_QWORD *)(a8 + 16);
              *(_QWORD *)(v33 + 56) = v25;
              *(_QWORD *)(v33 + 48) = v26;
              *(_QWORD *)(v33 + 72) = v36;
              *(_DWORD *)(v33 + 80) = v11;
              *(_QWORD *)(v33 + 88) = v32;
              *(_DWORD *)(v33 + 96) = -536870206;
              *(_BYTE *)(v23 + 56) = 0;
              v9 = 0;
              v27 = (*(int (__fastcall **)(_QWORD, __int64 (__fastcall *)(IOUSBController *, OSObject *, void *, void *, void *, void *), __int64, _QWORD, _QWORD, _QWORD))(**(_QWORD **)(v8 + 144) + 456LL))(
                      *(_QWORD *)(v8 + 144),
                      IOUSBController::DoIsocTransfer,
                      v33,
                      0LL,
                      0LL,
                      0LL);
              if ( (v27 != 0) | v34 )
              {
                v28 = *(_QWORD *)(*(_QWORD *)(v33 + 104) + 24LL);
                if ( v28 )
                {
                  LODWORD(v29) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v28 + 312LL))(v28);
                  if ( v29 )
                    (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v28 + 304LL))(v28, 1LL);
                }
                (*(void (__fastcall **)(_QWORD, __int64))(**(_QWORD **)(*(_QWORD *)(v8 + 168) + 8LL) + 304LL))(
                  *(_QWORD *)(*(_QWORD *)(v8 + 168) + 8LL),
                  v33);
                v9 = v27;
              }
            }
          }
          else
          {
            v9 = -536870210;
            if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
              kernel_debug(0x52D0060u, v8, 0xFFFFFFFFE00002BELL, 0LL, 1uLL, 0LL);
          }
        }
      }
    }
  }
  return (unsigned int)v9;
}
// 3B008: using guessed type __int64 (__fastcall *off_3B008[4])();
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (000000000000B21A) ----------------------------------------------------
__int64 __fastcall IOUSBController::IsocIO(IOUSBController *this, __int64 a2, __int64 a3, int a4, __int64 a5, __int16 a6, __int64 a7, __int64 a8, int a9)
{
  __int64 v9; // r13@1
  __int64 v10; // rbx@1
  __int64 v11; // r12@1
  uintptr_t v12; // r14@1
  unsigned __int8 v13; // al@3
  char v14; // si@4
  int v15; // ebx@5
  uintptr_t v16; // rdx@7
  uintptr_t v17; // rcx@7
  uintptr_t v18; // r8@7
  char v19; // bl@14
  __int64 v20; // rax@19
  __int64 v21; // r8@19
  __int64 v22; // r9@19
  __int64 v23; // rax@20
  const OSMetaClass *v24; // rdx@20
  __int64 v25; // rdi@22
  __int64 v26; // rax@31
  int v27; // ecx@31
  __int64 v28; // rsi@32
  __int16 v29; // cx@32
  bool v31; // zf@38
  __int64 v32; // ST68_8@40
  __int64 v33; // ST60_8@40
  int v34; // er12@40
  __int64 v35; // rbx@41
  __int64 v36; // rax@42
  char v37; // [sp+0h] [bp-A0h]@0
  char v38; // [sp+24h] [bp-7Ch]@23
  __int64 v39; // [sp+28h] [bp-78h]@23
  int v40; // [sp+30h] [bp-70h]@14
  __int16 v41; // [sp+34h] [bp-6Ch]@14
  __int64 v42; // [sp+38h] [bp-68h]@14
  char v43; // [sp+44h] [bp-5Ch]@14

  v9 = a5;
  v10 = a3;
  v11 = a2;
  v12 = (uintptr_t)this;
  if ( !a8 )
  {
    v15 = -536870166;
    if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
      return (unsigned int)v15;
    v16 = -536870166LL;
    v17 = 0LL;
    v18 = 3LL;
LABEL_36:
    kernel_debug(0x52D005Cu, v12, v16, v17, v18, 0LL);
    return (unsigned int)v15;
  }
  if ( !*((_QWORD *)this + 18) )
  {
    v15 = -536870199;
    if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
      return (unsigned int)v15;
    v16 = -536870199LL;
    v17 = 0LL;
    v18 = 4LL;
    goto LABEL_36;
  }
  v13 = *(_BYTE *)(a7 + 9);
  if ( (v13 & 0x80u) != 0 )
  {
    v13 &= 0x7Fu;
    *(_BYTE *)(a7 + 9) = v13;
    v14 = 1;
  }
  else
  {
    v14 = 0;
  }
  v16 = v13;
  if ( v13 >= 2u )
  {
    v15 = -536870206;
    if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
      return (unsigned int)v15;
    v17 = -536870206LL;
    v18 = 6LL;
    goto LABEL_36;
  }
  if ( *(__int64 (__fastcall **)())(a8 + 8) == off_3B008[0] )
  {
    v43 = v14;
    v41 = a6;
    v42 = v10;
    v40 = a4;
    v19 = 1;
    if ( (unsigned __int8)(*(int (**)(void))(**((_QWORD **)this + 17) + 304LL))() )
    {
      LODWORD(v20) = (*(int (__fastcall **)(IOUSBController *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
      KernelDebugLogInternal(
        1u,
        0x55534246u,
        (__int64)"IOUSBController(%s)::DoIsocTransfer sync request on workloop thread.  Use async!",
        v20,
        v21,
        v22,
        v37);
      v15 = -536854454;
      return (unsigned int)v15;
    }
  }
  else
  {
    v43 = v14;
    v41 = a6;
    v42 = v10;
    v40 = a4;
    v19 = 0;
  }
  LODWORD(v23) = (*(int (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(*((_QWORD *)this + 21) + 8LL) + 296LL))(
                   *(_QWORD *)(*((_QWORD *)this + 21) + 8LL),
                   0LL);
  if ( !v23 )
  {
    IOUSBController::IncreaseIsocCommandPool(this, 0LL, v24);
    LODWORD(v23) = (*(int (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(*((_QWORD *)this + 21) + 8LL) + 296LL))(
                     *(_QWORD *)(*((_QWORD *)this + 21) + 8LL),
                     0LL);
    if ( !v23 )
    {
      v15 = -536870210;
      if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
        return (unsigned int)v15;
      v16 = -536870210LL;
      v17 = 0LL;
      v18 = 5LL;
      goto LABEL_36;
    }
  }
  v25 = *(_QWORD *)(*(_QWORD *)(v23 + 104) + 24LL);
  if ( !v25 )
  {
    v15 = -536870210;
    if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
      return (unsigned int)v15;
    v16 = -536870210LL;
    v17 = 0LL;
    v18 = 1LL;
    goto LABEL_36;
  }
  v38 = v19;
  v39 = v23;
  v15 = (*(int (__fastcall **)(__int64, __int64, signed __int64))(*(_QWORD *)v25 + 296LL))(v25, v11, 1LL);
  if ( v15 )
  {
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D005Cu, v12, v15, 0LL, 2uLL, 0LL);
    (*(void (__fastcall **)(_QWORD, __int64))(**(_QWORD **)(*(_QWORD *)(v12 + 168) + 8LL) + 304LL))(
      *(_QWORD *)(*(_QWORD *)(v12 + 168) + 8LL),
      v39);
  }
  else
  {
    v26 = *(_QWORD *)(v39 + 104);
    *(_BYTE *)(v26 + 17) = v43;
    *(_BYTE *)(v26 + 16) = v38;
    v27 = *(_BYTE *)(a7 + 9);
    if ( v27 == 1 )
    {
      *(_DWORD *)(v39 + 32) = 1;
      *(_BYTE *)(v39 + 39) = 1;
      v28 = v42;
      v29 = v41;
    }
    else
    {
      v31 = (_BYTE)v27 == 0;
      v28 = v42;
      v29 = v41;
      if ( v31 )
      {
        *(_DWORD *)(v39 + 32) = 2;
        *(_BYTE *)(v39 + 39) = 0;
      }
    }
    *(_BYTE *)(v26 + 4) = 0;
    *(_WORD *)(v39 + 36) = v29;
    *(_BYTE *)(v39 + 38) = *(_BYTE *)(a7 + 8);
    *(_QWORD *)(v39 + 40) = v11;
    v32 = *(_QWORD *)(a8 + 8);
    v33 = *(_QWORD *)a8;
    *(_QWORD *)(v39 + 64) = *(_QWORD *)(a8 + 16);
    *(_QWORD *)(v39 + 56) = v32;
    *(_QWORD *)(v39 + 48) = v33;
    *(_QWORD *)(v39 + 72) = v28;
    *(_DWORD *)(v39 + 80) = v40;
    *(_QWORD *)(v39 + 88) = v9;
    *(_DWORD *)(v39 + 96) = -536870206;
    *(_DWORD *)v26 = a9;
    *(_BYTE *)(v26 + 56) = 1;
    v15 = 0;
    v34 = (*(int (__fastcall **)(_QWORD, __int64 (__fastcall *)(IOUSBController *, OSObject *, void *, void *, void *, void *), __int64, _QWORD, _QWORD, _QWORD))(**(_QWORD **)(v12 + 144) + 456LL))(
            *(_QWORD *)(v12 + 144),
            IOUSBController::DoIsocTransfer,
            v39,
            0LL,
            0LL,
            0LL);
    if ( (v34 != 0) | (unsigned __int8)v38 )
    {
      v35 = *(_QWORD *)(*(_QWORD *)(v39 + 104) + 24LL);
      if ( v35 )
      {
        LODWORD(v36) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v35 + 312LL))(v35);
        if ( v36 )
          (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v35 + 304LL))(v35, 1LL);
      }
      (*(void (__fastcall **)(_QWORD, __int64))(**(_QWORD **)(*(_QWORD *)(v12 + 168) + 8LL) + 304LL))(
        *(_QWORD *)(*(_QWORD *)(v12 + 168) + 8LL),
        v39);
      v15 = v34;
    }
  }
  return (unsigned int)v15;
}
// 3B008: using guessed type __int64 (__fastcall *off_3B008[4])();
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (000000000000B660) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::MetaClass::MetaClass(IOUSBInterface::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBInterface", &IOUSBNub::gMetaClass, 432LL);
  result = (__int64)off_3D170;
  *(_QWORD *)this = off_3D170;
  return result;
}
// 3D170: using guessed type __int64 (__fastcall *off_3D170[2])(IOUSBInterface::MetaClass *__hidden this);
// 49638: using guessed type _QWORD IOUSBNub::gMetaClass;
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000000B692) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::MetaClass::~MetaClass(IOUSBInterface::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000000B69C) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::IOUSBInterface(__int64 a1)
{
  __int64 result; // rax@1

  IOUSBNub::IOUSBNub(a1);
  result = (__int64)off_3C7C0;
  *(_QWORD *)a1 = off_3C7C0;
  return result;
}
// 3C7C0: using guessed type __int64 (__fastcall *off_3C7C0[2])(IOUSBInterface *__hidden this);

//----- (000000000000B6BC) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::IOUSBInterface(__int64 a1)
{
  __int64 result; // rax@1

  IOUSBNub::IOUSBNub(a1);
  result = (__int64)off_3C7C0;
  *(_QWORD *)a1 = off_3C7C0;
  return result;
}
// 3C7C0: using guessed type __int64 (__fastcall *off_3C7C0[2])(IOUSBInterface *__hidden this);

//----- (000000000000B6DC) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::~IOUSBInterface(IOUSBInterface *this)
{
  return IOUSBNub::~IOUSBNub(this);
}

//----- (000000000000B6E6) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::~IOUSBInterface(IOUSBInterface *this)
{
  return IOUSBNub::~IOUSBNub(this);
}

//----- (000000000000B6F0) ----------------------------------------------------
void __fastcall IOUSBInterface::~IOUSBInterface(IOUSBInterface *this)
{
  IOUSBNub::~IOUSBNub(this);
  OSObject::operator delete((void *)this);
}

//----- (000000000000B712) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::getMetaClass(IOUSBInterface *this)
{
  return (__int64)&IOUSBInterface::gMetaClass;
}
// 495B0: using guessed type _QWORD IOUSBInterface::gMetaClass;

//----- (000000000000B720) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::MetaClass::MetaClass(IOUSBInterface::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBInterface", &IOUSBNub::gMetaClass, 432LL);
  result = (__int64)off_3D170;
  *(_QWORD *)this = off_3D170;
  return result;
}
// 3D170: using guessed type __int64 (__fastcall *off_3D170[2])(IOUSBInterface::MetaClass *__hidden this);
// 49638: using guessed type _QWORD IOUSBNub::gMetaClass;
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000000B752) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::MetaClass::alloc(IOUSBInterface::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)stru_1A0.segname, a2);
  IOUSBNub::IOUSBNub(v2);
  *(_QWORD *)v2 = off_3C7C0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBInterface::gMetaClass);
  return v2;
}
// 1A0: using guessed type section_64;
// 3C7C0: using guessed type __int64 (__fastcall *off_3C7C0[2])(IOUSBInterface *__hidden this);
// 495B0: using guessed type _QWORD IOUSBInterface::gMetaClass;

//----- (000000000000B792) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::IOUSBInterface(__int64 a1)
{
  IOUSBNub::IOUSBNub(a1);
  *(_QWORD *)a1 = off_3C7C0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBInterface::gMetaClass);
}
// 3C7C0: using guessed type __int64 (__fastcall *off_3C7C0[2])(IOUSBInterface *__hidden this);
// 495B0: using guessed type _QWORD IOUSBInterface::gMetaClass;

//----- (000000000000B7C2) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::IOUSBInterface(__int64 a1)
{
  IOUSBNub::IOUSBNub(a1);
  *(_QWORD *)a1 = off_3C7C0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBInterface::gMetaClass);
}
// 3C7C0: using guessed type __int64 (__fastcall *off_3C7C0[2])(IOUSBInterface *__hidden this);
// 495B0: using guessed type _QWORD IOUSBInterface::gMetaClass;

//----- (000000000000B7F2) ----------------------------------------------------
char __fastcall IOUSBInterface::start(IOUSBInterface *this, IOService *a2, const OSMetaClass *a3)
{
  IOUSBInterface *v3; // r15@1
  __int64 v4; // r14@1
  int (__cdecl *v5)(OSObject *, void *, void *, void *, void *); // rdx@3
  __int64 v6; // rax@3
  __int64 v7; // rax@4
  __int64 v8; // rax@6
  __int64 v9; // r8@6
  __int64 v10; // r9@6
  __int64 v11; // rcx@6
  __int64 v12; // rdx@6
  __int64 v13; // rax@7
  __int64 v14; // rax@8
  char *v15; // rsi@9
  __int64 v16; // rax@10
  __int64 v17; // rdi@12
  __int16 v19; // ax@19
  OSMetaClassBase *v20; // rax@21
  OSMetaClassBase *v21; // r14@21
  __int64 v22; // rsi@21
  const OSMetaClass *v23; // rdx@21
  __int64 v24; // rax@21
  void (__fastcall *v25)(_QWORD, _QWORD, _QWORD, _QWORD); // rbx@22
  int v26; // eax@22
  char v27; // [sp+0h] [bp-30h]@9
  char v28; // [sp+1h] [bp-2Fh]@20
  __int16 v29; // [sp+2h] [bp-2Eh]@20
  __int16 v30; // [sp+4h] [bp-2Ch]@20
  __int16 v31; // [sp+6h] [bp-2Ah]@20
  __int64 v32; // [sp+8h] [bp-28h]@20

  v3 = this;
  v4 = OSMetaClassBase::safeMetaCast(a2, (const OSMetaClassBase *)IOUSBDevice::metaClass, a3);
  if ( !v4 || !(unsigned __int8)((int (__fastcall *)(IOUSBInterface *, IOService *))`vtable for'IOUSBNub[186])(this, a2) )
    return 0;
  (*(void (__fastcall **)(IOUSBInterface *))(*(_QWORD *)this + 32LL))(this);
  *((_QWORD *)this + 51) = v4;
  v6 = IOCommandGate::commandGate(this, 0LL, v5);
  **((_QWORD **)this + 53) = v6;
  if ( !v6 )
  {
    LODWORD(v13) = (*(int (__fastcall **)(IOUSBInterface *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
    v11 = v13;
    v12 = (__int64)"%s::start - unable to create command gate";
    goto LABEL_9;
  }
  LODWORD(v7) = (*(int (__fastcall **)(IOUSBInterface *, _QWORD))(*(_QWORD *)this + 1672LL))(this, 0LL);
  *(_QWORD *)(*((_QWORD *)this + 53) + 8LL) = v7;
  if ( !v7 )
  {
    LODWORD(v14) = (*(int (__fastcall **)(IOUSBInterface *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
    v11 = v14;
    v12 = (__int64)"%s::start - unable to find my workloop";
    goto LABEL_9;
  }
  (*(void (__fastcall **)(__int64))(*(_QWORD *)v7 + 32LL))(v7);
  if ( (*(int (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(*((_QWORD *)this + 53) + 8LL) + 320LL))(
         *(_QWORD *)(*((_QWORD *)this + 53) + 8LL),
         **((_QWORD **)this + 53)) )
  {
    LODWORD(v8) = (*(int (__fastcall **)(IOUSBInterface *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
    v11 = v8;
    v12 = (__int64)"%s::start - unable to add gate to work loop";
LABEL_9:
    v15 = (char *)1431519814;
    KernelDebugLogInternal(1u, 0x55534246u, v12, v11, v9, v10, v27);
LABEL_10:
    v16 = *((_QWORD *)this + 53);
    if ( *(_QWORD *)v16 )
    {
      (*(void (__fastcall **)(_QWORD, char *))(**(_QWORD **)v16 + 40LL))(*(_QWORD *)v16, v15);
      v16 = *((_QWORD *)this + 53);
      *(_QWORD *)v16 = 0LL;
    }
    v17 = *(_QWORD *)(v16 + 8);
    if ( v17 )
    {
      (*(void (__fastcall **)(__int64, char *))(*(_QWORD *)v17 + 40LL))(v17, v15);
      *(_QWORD *)(*((_QWORD *)v3 + 53) + 8LL) = 0LL;
    }
    (*(void (__fastcall **)(IOUSBInterface *, char *))(*(_QWORD *)v3 + 40LL))(v3, v15);
    return 0;
  }
  if ( *((_BYTE *)this + 419) == 8 && *((_BYTE *)this + 420) == 6 )
  {
    v19 = *((_BYTE *)this + 417);
    if ( *((_BYTE *)this + 417) )
    {
      v27 = 1;
      v28 = 11;
      v29 = v19;
      v30 = *((_BYTE *)this + 416);
      v31 = 0;
      v32 = 0LL;
      v15 = &v27;
      if ( (*(int (__fastcall **)(_QWORD, char *, _QWORD))(**((_QWORD **)this + 51) + 2360LL))(
             *((_QWORD *)this + 51),
             &v27,
             0LL) )
        goto LABEL_10;
    }
  }
  (*(void (__fastcall **)(IOUSBInterface *))(*(_QWORD *)this + 2152LL))(this);
  LODWORD(v20) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 51) + 744LL))(
                   *((_QWORD *)this + 51),
                   "locationID");
  v21 = v20;
  v22 = *(_QWORD *)off_3B078[0];
  v24 = OSMetaClassBase::safeMetaCast(v20, *(const OSMetaClassBase **)off_3B078[0], v23);
  if ( v24 )
  {
    v25 = *(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 640LL);
    v26 = (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v24 + 328LL))(v24, v22);
    v22 = (__int64)"locationID";
    v25(this, "locationID", (unsigned int)v26, 32LL);
  }
  if ( v21 )
    (*(void (__fastcall **)(OSMetaClassBase *, __int64))(*(_QWORD *)v21 + 40LL))(v21, v22);
  (*(void (__fastcall **)(IOUSBInterface *, signed __int64))(*(_QWORD *)this + 2368LL))(this, 1LL);
  (*(void (__fastcall **)(_QWORD, IOUSBInterface *, _QWORD, _QWORD))(**((_QWORD **)this + 51) + 1488LL))(
    *((_QWORD *)this + 51),
    this,
    0LL,
    0LL);
  (*(void (__fastcall **)(IOUSBInterface *))(*(_QWORD *)this + 40LL))(this);
  return 1;
}
// 3B078: using guessed type _QWORD off_3B078[19];
// 3D260: using guessed type __int64 `vtable for'IOUSBNub[2];
// 3F498: using guessed type _QWORD IOUSBDevice::metaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000000BA76) ----------------------------------------------------
char __fastcall IOUSBInterface::open(IOUSBInterface *this, IOService *a2, unsigned int a3, void *a4)
{
  unsigned int v4; // er14@1
  __int64 v5; // rax@1
  __int64 v6; // r12@2
  __int64 v7; // r13@3
  void *v8; // ST00_8@4
  char v9; // r14@4
  __int64 v10; // rax@6

  v4 = a3;
  v5 = *((_QWORD *)this + 53);
  if ( v5 && (*(_BYTE *)(v5 + 168) = 1, (v6 = *(_QWORD *)v5) != 0) && (v7 = *(_QWORD *)(v5 + 8)) != 0 )
  {
    v8 = a4;
    (*(void (__cdecl **)(IOUSBInterface *))(*(_QWORD *)this + 32LL))(this);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v7 + 32LL))(v7);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v6 + 32LL))(v6);
    v9 = (*(int (__fastcall **)(__int64, __int64 (__fastcall *)(IOUSBInterface *__hidden, OSObject *, void *, void *, void *, void *), IOService *, _QWORD, void *, _QWORD))(*(_QWORD *)v6 + 456LL))(
           v6,
           IOUSBInterface::CallSuperOpen,
           a2,
           v4,
           v8,
           0LL) == 0;
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v6 + 40LL))(v6);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v7 + 40LL))(v7);
    (*(void (__fastcall **)(IOUSBInterface *))(*(_QWORD *)this + 40LL))(this);
  }
  else
  {
    v9 = ((int (__fastcall *)(IOUSBInterface *, IOService *, _QWORD, void *))`vtable for'IOUSBNub[188])(
           this,
           a2,
           a3,
           a4);
  }
  v10 = *((_QWORD *)this + 53);
  if ( v10 )
    *(_BYTE *)(v10 + 168) = 0;
  return v9;
}
// 3D260: using guessed type __int64 `vtable for'IOUSBNub[2];

//----- (000000000000BB56) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::CallSuperOpen(IOUSBInterface *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  void *v6; // r14@1
  int v7; // er15@1
  __int64 v8; // rax@1
  signed int v9; // ecx@1
  char v10; // al@2

  v6 = a4;
  v7 = (signed int)a3;
  v8 = OSMetaClassBase::safeMetaCast(
         this,
         (const OSMetaClassBase *)&IOUSBInterface::gMetaClass,
         (const OSMetaClass *)a3);
  v9 = -536870206;
  if ( v8 )
  {
    v10 = ((int (__fastcall *)(__int64, OSObject *, _QWORD, void *))`vtable for'IOUSBNub[188])(
            v8,
            a2,
            (unsigned int)v7,
            v6);
    v9 = -536870210;
    if ( v10 )
      v9 = 0;
  }
  return (unsigned int)v9;
}
// 3D260: using guessed type __int64 `vtable for'IOUSBNub[2];
// 495B0: using guessed type _QWORD IOUSBInterface::gMetaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000000BBB2) ----------------------------------------------------
char __usercall IOUSBInterface::handleOpen@<al>(IOUSBInterface *this@<rdi>, IOService *a2@<rsi>, void *a3@<rcx>, char a4@<al>, unsigned int a5@<edx>)
{
  void *v5; // r13@1
  unsigned int v6; // er15@1
  IOService *v7; // r12@1
  IOUSBInterface *v8; // r14@1
  int v9; // ebx@1
  __int64 v10; // rsi@1
  __int64 v11; // rdi@6
  char v12; // r13@8
  __int16 v13; // bx@9
  int v14; // ebx@13
  __int64 v15; // rax@14
  __int64 v16; // r9@14
  char v18; // [sp-8h] [bp-30h]@1

  v18 = a4;
  v5 = a3;
  v6 = a5;
  v7 = a2;
  v8 = this;
  v9 = a5 & 0x20000;
  v10 = (__int64)"IOUSBInterfaceUserClientV2";
  if ( OSMetaClassBase::metaCast(v7, "IOUSBInterfaceUserClientV2") )
  {
    if ( !v9 )
      goto LABEL_6;
  }
  else
  {
    v10 = (__int64)"IOUSBInterfaceUserClientV3";
    if ( OSMetaClassBase::metaCast(v7, "IOUSBInterfaceUserClientV3") && v9 == 0 )
    {
LABEL_6:
      v11 = *(_QWORD *)(*((_QWORD *)this + 53) + 32LL);
      if ( v11
        || (v11 = OSSet::withCapacity((OSSet *)((char *)&dword_0 + 1), v10),
            (*(_QWORD *)(*((_QWORD *)v8 + 53) + 32LL) = v11) != 0LL) )
      {
        (*(void (__fastcall **)(__int64, IOService *))(*(_QWORD *)v11 + 448LL))(v11, v7);
        v12 = 1;
      }
      else
      {
        v12 = 0;
      }
      return v12;
    }
  }
  v13 = (signed __int16)v5;
  v12 = ((int (__fastcall *)(IOUSBInterface *, IOService *, _QWORD, void *))`vtable for'IOUSBNub[191])(this, v7, v6, v5);
  if ( v12 )
  {
    if ( v6 & 0x10000 )
    {
      if ( !(*(int (__fastcall **)(IOUSBInterface *, IOService *, _QWORD))(*(_QWORD *)this + 2192LL))(
              this,
              v7,
              (unsigned __int16)v13) )
        return v12;
    }
    else
    {
      v14 = (*(int (__fastcall **)(IOUSBInterface *))(*(_QWORD *)this + 2144LL))(this);
      if ( !v14 )
        return v12;
      LODWORD(v15) = (*(int (__fastcall **)(IOUSBInterface *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
      KernelDebugLogInternal(
        1u,
        0x55534246u,
        (__int64)"%s::handleOpen: CreatePipes failed (0x%x)",
        v15,
        (unsigned int)v14,
        v16,
        v18);
    }
    v12 = 0;
    (*(void (__fastcall **)(IOUSBInterface *, IOService *, _QWORD))(*(_QWORD *)this + 1496LL))(this, v7, 0LL);
  }
  return v12;
}
// 0: using guessed type int dword_0;
// 3D260: using guessed type __int64 `vtable for'IOUSBNub[2];

//----- (000000000000BD00) ----------------------------------------------------
int __fastcall IOUSBInterface::close(IOUSBInterface *this, IOService *a2, unsigned int a3)
{
  unsigned int v3; // er15@1
  IOService *v4; // r14@1
  int v5; // ebx@1
  int (__fastcall *v6)(IOUSBInterface *, OSObject *, void *, void *, void *, void *); // rsi@1
  __int64 v7; // rax@9
  __int64 v8; // rbx@10
  __int64 v9; // r13@11
  __int64 v10; // rax@13
  __int64 v11; // rbx@14
  __int64 v12; // r13@15

  v3 = a3;
  v4 = a2;
  v5 = a3 & 0x20000;
  v6 = (int (__fastcall *)(IOUSBInterface *, OSObject *, void *, void *, void *, void *))"IOUSBInterfaceUserClientV2";
  if ( OSMetaClassBase::metaCast(v4, "IOUSBInterfaceUserClientV2") )
  {
    if ( !v5 )
      goto LABEL_13;
  }
  else
  {
    v6 = (int (__fastcall *)(IOUSBInterface *, OSObject *, void *, void *, void *, void *))"IOUSBInterfaceUserClientV3";
    if ( OSMetaClassBase::metaCast(v4, "IOUSBInterfaceUserClientV3") && v5 == 0 )
      goto LABEL_13;
  }
  v6 = (int (__fastcall *)(IOUSBInterface *, OSObject *, void *, void *, void *, void *))"IOUSBInterfaceUserClientV2";
  if ( !OSMetaClassBase::metaCast(v4, "IOUSBInterfaceUserClientV2")
    && (v6 = (int (__fastcall *)(IOUSBInterface *, OSObject *, void *, void *, void *, void *))"IOUSBInterfaceUserClientV3",
        !OSMetaClassBase::metaCast(v4, "IOUSBInterfaceUserClientV3"))
    || !(unsigned __int8)IOService::isInactive(this) )
  {
    v7 = *((_QWORD *)this + 53);
    if ( v7 )
    {
      v8 = *(_QWORD *)v7;
      if ( *(_QWORD *)v7 )
      {
        v9 = *(_QWORD *)(v7 + 8);
        if ( v9 )
        {
          (*(void (__fastcall **)(IOUSBInterface *, int (__fastcall *)(IOUSBInterface *, OSObject *, void *, void *, void *, void *)))(*(_QWORD *)this + 32LL))(
            this,
            v6);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v9 + 32LL))(v9);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v8 + 32LL))(v8);
          v6 = IOUSBInterface::_AbortPipes;
          (*(void (__fastcall **)(__int64, int (__fastcall *)(IOUSBInterface *, OSObject *, void *, void *, void *, void *), _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v8 + 456LL))(
            v8,
            IOUSBInterface::_AbortPipes,
            0LL,
            0LL,
            0LL,
            0LL);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v8 + 40LL))(v8);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v9 + 40LL))(v9);
          (*(void (__fastcall **)(IOUSBInterface *))(*(_QWORD *)this + 40LL))(this);
        }
      }
    }
  }
LABEL_13:
  v10 = *((_QWORD *)this + 53);
  if ( !v10 || (v11 = *(_QWORD *)v10) == 0 || (v12 = *(_QWORD *)(v10 + 8)) == 0 )
    JUMPOUT(__CS__, `vtable for'IOUSBNub[189]);
  (*(void (__fastcall **)(IOUSBInterface *, int (__fastcall *)(IOUSBInterface *, OSObject *, void *, void *, void *, void *)))(*(_QWORD *)this + 32LL))(
    this,
    v6);
  (*(void (__fastcall **)(__int64))(*(_QWORD *)v12 + 32LL))(v12);
  (*(void (__fastcall **)(__int64))(*(_QWORD *)v11 + 32LL))(v11);
  (*(void (__fastcall **)(__int64, __int64 (__fastcall *)(IOUSBInterface *__hidden, OSObject *, void *, void *, void *, void *), IOService *, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v11 + 456LL))(
    v11,
    IOUSBInterface::CallSuperClose,
    v4,
    v3,
    0LL,
    0LL);
  (*(void (__fastcall **)(__int64))(*(_QWORD *)v11 + 40LL))(v11);
  (*(void (__fastcall **)(__int64))(*(_QWORD *)v12 + 40LL))(v12);
  return (*(int (__fastcall **)(IOUSBInterface *))(*(_QWORD *)this + 40LL))(this);
}
// 3D260: using guessed type __int64 `vtable for'IOUSBNub[2];

//----- (000000000000BEB0) ----------------------------------------------------
int __fastcall IOUSBInterface::_AbortPipes(IOUSBInterface *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  IOUSBInterface *v6; // rax@1
  const OSMetaClass *v7; // rdx@1
  int result; // eax@2

  v6 = (IOUSBInterface *)OSMetaClassBase::safeMetaCast(
                           this,
                           (const OSMetaClassBase *)&IOUSBInterface::gMetaClass,
                           (const OSMetaClass *)a3);
  if ( v6 )
    result = IOUSBInterface::AbortPipesGated(v6, (__int64)&IOUSBInterface::gMetaClass, v7);
  else
    result = -536870206;
  return result;
}
// 495B0: using guessed type _QWORD IOUSBInterface::gMetaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000000BED6) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::CallSuperClose(IOUSBInterface *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  int v6; // er14@1
  __int64 v7; // rax@1
  signed int v8; // ecx@1

  v6 = (signed int)a3;
  v7 = OSMetaClassBase::safeMetaCast(
         this,
         (const OSMetaClassBase *)&IOUSBInterface::gMetaClass,
         (const OSMetaClass *)a3);
  v8 = -536870206;
  if ( v7 )
  {
    ((void (__fastcall *)(__int64, OSObject *, _QWORD))`vtable for'IOUSBNub[189])(v7, a2, (unsigned int)v6);
    v8 = 0;
  }
  return (unsigned int)v8;
}
// 3D260: using guessed type __int64 `vtable for'IOUSBNub[2];
// 495B0: using guessed type _QWORD IOUSBInterface::gMetaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000000BF18) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::handleClose(IOUSBInterface *this, IOService *a2, unsigned int a3)
{
  unsigned int v3; // er15@1
  IOUSBInterface *v4; // r14@1
  int v5; // ebx@1
  __int64 v6; // rcx@1
  __int64 v7; // rax@4
  char *v8; // r15@6
  __int64 v9; // rdi@6
  __int64 result; // rax@9

  v3 = a3;
  v4 = this;
  v5 = a3 & 0x20000;
  if ( OSMetaClassBase::metaCast(a2, "IOUSBInterfaceUserClientV2") )
  {
    if ( !v5 )
      goto LABEL_6;
LABEL_8:
    ((void (__fastcall *)(IOUSBInterface *, IOService *, _QWORD, __int64))`vtable for'IOUSBNub[192])(this, a2, v3, v6);
    v8 = (char *)this + 424;
    goto LABEL_9;
  }
  v7 = OSMetaClassBase::metaCast(a2, "IOUSBInterfaceUserClientV3");
  LOBYTE(v6) = v5 != 0;
  if ( !v7 || (_BYTE)v6 )
    goto LABEL_8;
LABEL_6:
  v8 = (char *)this + 424;
  v9 = *(_QWORD *)(*((_QWORD *)this + 53) + 32LL);
  if ( v9 )
    (*(void (__fastcall **)(__int64, IOService *))(*(_QWORD *)v9 + 472LL))(v9, a2);
LABEL_9:
  result = *(_QWORD *)v8;
  if ( *(_QWORD *)v8 )
  {
    if ( *(_BYTE *)(result + 16) )
    {
      (*(void (__fastcall **)(_QWORD, IOUSBInterface *, _QWORD))(**((_QWORD **)v4 + 51) + 1496LL))(
        *((_QWORD *)v4 + 51),
        v4,
        0LL);
      result = *(_QWORD *)v8;
      *(_BYTE *)(*(_QWORD *)v8 + 16LL) = 0;
    }
  }
  return result;
}
// 3D260: using guessed type __int64 `vtable for'IOUSBNub[2];

//----- (000000000000BFE2) ----------------------------------------------------
char __fastcall IOUSBInterface::handleIsOpen(IOUSBInterface *this, const IOService *a2)
{
  IOUSBInterface *v2; // r14@1
  __int64 v3; // rdi@4
  char v4; // cl@5
  char result; // al@5
  __int64 v6; // rdi@7
  bool v7; // zf@8

  v2 = this;
  if ( a2 )
  {
    if ( !OSMetaClassBase::metaCast(a2, "IOUSBInterfaceUserClientV2")
      && !OSMetaClassBase::metaCast(a2, "IOUSBInterfaceUserClientV3") )
      return ((int (__fastcall *)(IOUSBInterface *, const IOService *))`vtable for'IOUSBNub[193])(v2, a2);
    v3 = *(_QWORD *)(*((_QWORD *)this + 53) + 32LL);
    if ( !v3 )
      return ((int (__fastcall *)(IOUSBInterface *, const IOService *))`vtable for'IOUSBNub[193])(v2, a2);
    v4 = (*(int (__fastcall **)(__int64, const IOService *))(*(_QWORD *)v3 + 480LL))(v3, a2);
    result = 1;
    if ( !v4 )
      return ((int (__fastcall *)(_QWORD, _QWORD))`vtable for'IOUSBNub[193])(v2, a2);
  }
  else
  {
    v6 = *(_QWORD *)(*((_QWORD *)this + 53) + 32LL);
    if ( !v6 )
      return ((int (__fastcall *)(_QWORD, _QWORD))`vtable for'IOUSBNub[193])(v2, a2);
    v7 = (*(int (**)(void))(*(_QWORD *)v6 + 304LL))() == 0;
    result = 1;
    if ( v7 )
      return ((int (__fastcall *)(_QWORD, _QWORD))`vtable for'IOUSBNub[193])(v2, a2);
  }
  return result;
}
// 3D260: using guessed type __int64 `vtable for'IOUSBNub[2];

//----- (000000000000C07A) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::message(IOUSBInterface *this, signed int a2, IOService *a3, void *a4)
{
  void *v4; // r15@1
  IOService *v5; // rbx@1
  int v6; // er14@1
  __int64 v7; // rax@8
  signed __int64 v8; // rsi@8
  signed __int64 v9; // rcx@8
  __int16 v10; // ax@11
  __int64 v11; // rdi@12
  __int64 v12; // rax@15
  __int64 v13; // r13@16
  __int64 v14; // r12@17
  __int64 v15; // rax@22
  signed __int64 v16; // rsi@22
  unsigned __int64 v17; // rsi@26
  signed __int64 v18; // rax@27
  char v20; // [sp+0h] [bp-40h]@13
  char v21; // [sp+1h] [bp-3Fh]@13
  __int16 v22; // [sp+2h] [bp-3Eh]@13
  __int16 v23; // [sp+4h] [bp-3Ch]@13
  __int16 v24; // [sp+6h] [bp-3Ah]@13
  __int64 v25; // [sp+8h] [bp-38h]@13

  v4 = a4;
  v5 = this;
  v6 = 0;
  if ( a2 > -536854302 )
  {
    if ( a2 == -536854301 )
    {
      v7 = *(_QWORD *)this;
      v8 = 3758112995LL;
      v9 = 1LL;
LABEL_9:
      (*(void (__fastcall **)(IOUSBInterface *, signed __int64, void *, signed __int64))(v7 + 1856))(this, v8, v4, v9);
    }
  }
  else if ( a2 > -536854519 )
  {
    switch ( a2 + 536854518 )
    {
      case 0:
        v10 = *((_BYTE *)this + 417);
        if ( *((_BYTE *)this + 417) )
        {
          v11 = *((_QWORD *)this + 51);
          if ( v11 )
          {
            v20 = 1;
            v21 = 11;
            v22 = v10;
            v23 = *((_BYTE *)v5 + 416);
            v24 = 0;
            v25 = 0LL;
            (*(void (__fastcall **)(__int64, char *, _QWORD))(*(_QWORD *)v11 + 2360LL))(v11, &v20, 0LL);
          }
        }
        if ( !(unsigned __int8)IOService::isInactive(v5) )
        {
          v12 = *((_QWORD *)v5 + 53);
          if ( v12 )
          {
            v13 = *(_QWORD *)v12;
            if ( *(_QWORD *)v12 )
            {
              v14 = *(_QWORD *)(v12 + 8);
              if ( v14 )
              {
                (*(void (__fastcall **)(IOService *))(*(_QWORD *)v5 + 32LL))(v5);
                (*(void (__fastcall **)(__int64))(*(_QWORD *)v14 + 32LL))(v14);
                (*(void (__fastcall **)(__int64))(*(_QWORD *)v13 + 32LL))(v13);
                v6 = (*(int (__fastcall **)(__int64, int (__fastcall *)(IOUSBInterface *, OSObject *, void *, void *, void *, void *), _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v13 + 456LL))(
                       v13,
                       IOUSBInterface::_ResetPipes,
                       0LL,
                       0LL,
                       0LL,
                       0LL);
                if ( !v6 )
                  (*(void (__fastcall **)(IOService *, signed __int64, void *, signed __int64))(*(_QWORD *)v5 + 1856LL))(
                    v5,
                    3758112778LL,
                    v4,
                    4LL);
                (*(void (__fastcall **)(__int64))(*(_QWORD *)v13 + 40LL))(v13);
                (*(void (__fastcall **)(__int64))(*(_QWORD *)v14 + 40LL))(v14);
                (*(void (__fastcall **)(IOService *))(*(_QWORD *)v5 + 40LL))(v5);
              }
            }
          }
        }
        return (unsigned int)v6;
      case 1:
        v15 = *(_QWORD *)this;
        v6 = 0;
        v16 = 3758112779LL;
        goto LABEL_32;
      case 3:
        v7 = *(_QWORD *)this;
        v8 = 3758112781LL;
        v9 = 4LL;
        goto LABEL_9;
      case 7:
        (*(void (__fastcall **)(IOUSBInterface *, signed __int64, IOService *))(*(_QWORD *)this + 2368LL))(
          this,
          1LL,
          a3);
        v15 = *(_QWORD *)this;
        v6 = 0;
        v16 = 3758112785LL;
        goto LABEL_32;
      default:
        return (unsigned int)v6;
    }
  }
  else if ( a2 > -536870065 )
  {
    if ( a2 == -536870064 )
    {
      v15 = *(_QWORD *)this;
      v6 = 0;
      v16 = 3758097232LL;
LABEL_32:
      (*(void (__fastcall **)(IOUSBInterface *, signed __int64, _QWORD, _QWORD))(v15 + 1856))(this, v16, 0LL, 0LL);
    }
  }
  else if ( a2 > -536870865 )
  {
    if ( a2 <= -536870657 )
    {
      if ( a2 != -536870864 )
        return (unsigned int)v6;
      goto LABEL_28;
    }
    v17 = (unsigned int)(a2 + 536870656);
    if ( (unsigned int)v17 <= 0x20 )
    {
      v18 = 4295032833LL;
      if ( _bittest((const unsigned __int64 *)&v18, v17) )
      {
LABEL_28:
        v6 = -536870201;
        return (unsigned int)v6;
      }
    }
  }
  else if ( a2 == -536870880 )
  {
    goto LABEL_28;
  }
  return (unsigned int)v6;
}

//----- (000000000000C2E4) ----------------------------------------------------
int __fastcall IOUSBInterface::_ResetPipes(IOUSBInterface *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  IOUSBInterface *v6; // rax@1
  const OSMetaClass *v7; // rdx@1
  int result; // eax@2

  v6 = (IOUSBInterface *)OSMetaClassBase::safeMetaCast(
                           this,
                           (const OSMetaClassBase *)&IOUSBInterface::gMetaClass,
                           (const OSMetaClass *)a3);
  if ( v6 )
    result = IOUSBInterface::ResetPipes(v6, (__int64)&IOUSBInterface::gMetaClass, v7);
  else
    result = -536870206;
  return result;
}
// 495B0: using guessed type _QWORD IOUSBInterface::gMetaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000000C30A) ----------------------------------------------------
int __fastcall IOUSBInterface::terminate(IOUSBInterface *this, unsigned int a2)
{
  __int64 v2; // rax@1
  int result; // eax@3

  v2 = *((_QWORD *)this + 53);
  if ( v2 && *(_BYTE *)(v2 + 168) )
  {
    result = 0;
  }
  else
  {
    if ( *((_QWORD *)this + 51) )
    {
      if ( (unsigned __int8)(*(int (__fastcall **)(IOUSBInterface *, _QWORD))(*(_QWORD *)this + 1504LL))(this, 0LL) )
        *(_BYTE *)(*((_QWORD *)this + 53) + 16LL) = 1;
      else
        (*(void (__fastcall **)(_QWORD, IOUSBInterface *, _QWORD))(**((_QWORD **)this + 51) + 1496LL))(
          *((_QWORD *)this + 51),
          this,
          0LL);
    }
    result = ((int (__fastcall *)(IOUSBInterface *, _QWORD))`vtable for'IOUSBNub[194])(this, a2);
  }
  return result;
}
// 3D260: using guessed type __int64 `vtable for'IOUSBNub[2];

//----- (000000000000C386) ----------------------------------------------------
void __fastcall IOUSBInterface::stop(IOUSBInterface *this, IOService *a2)
{
  IOUSBInterface *v2; // rbx@1
  __int64 v3; // rax@1
  __int64 v4; // rdi@2
  __int64 v5; // rdi@6

  v2 = this;
  (*(void (**)(void))(*(_QWORD *)this + 2136LL))();
  v3 = *((_QWORD *)this + 53);
  if ( v3 )
  {
    v4 = *(_QWORD *)(v3 + 8);
    if ( !v4 )
      goto LABEL_12;
    if ( *(_QWORD *)v3 )
    {
      (*(void (**)(void))(*(_QWORD *)v4 + 328LL))();
      v3 = *((_QWORD *)v2 + 53);
    }
    if ( v3 )
    {
LABEL_12:
      v5 = *(_QWORD *)(v3 + 32);
      if ( v5 )
      {
        if ( !(*(int (**)(void))(*(_QWORD *)v5 + 304LL))() )
        {
          (*(void (**)(void))(**(_QWORD **)(*((_QWORD *)v2 + 53) + 32LL) + 40LL))();
          *(_QWORD *)(*((_QWORD *)v2 + 53) + 32LL) = 0LL;
        }
      }
    }
  }
  JUMPOUT(__CS__, `vtable for'IOUSBNub[187]);
}
// 3D260: using guessed type __int64 `vtable for'IOUSBNub[2];

//----- (000000000000C41C) ----------------------------------------------------
void __fastcall IOUSBInterface::finalize(IOUSBInterface *this)
{
  JUMPOUT(__CS__, `vtable for'IOUSBNub[195]);
}
// 3D260: using guessed type __int64 `vtable for'IOUSBNub[2];

//----- (000000000000C42E) ----------------------------------------------------
void __fastcall IOUSBInterface::free(IOUSBInterface *this)
{
  IOUSBInterface *v1; // rbx@1
  __int64 v2; // rdi@1
  __int64 v3; // rax@4

  v1 = this;
  v2 = *((_QWORD *)this + 53);
  if ( v2 )
  {
    if ( *(_QWORD *)v2 )
    {
      (*(void (__fastcall **)(_QWORD))(**(_QWORD **)v2 + 40LL))(*(_QWORD *)v2);
      v2 = *((_QWORD *)v1 + 53);
    }
    *(_QWORD *)v2 = 0LL;
    v3 = *(_QWORD *)(v2 + 8);
    if ( v3 )
    {
      (*(void (__fastcall **)(_QWORD))(*(_QWORD *)v3 + 40LL))(*(_QWORD *)(v2 + 8));
      v2 = *((_QWORD *)v1 + 53);
    }
    *(_QWORD *)(v2 + 8) = 0LL;
    IOFree(v2, 176LL);
    *((_QWORD *)v1 + 53) = 0LL;
  }
  JUMPOUT(__CS__, `vtable for'IOUSBNub[20]);
}
// 3D260: using guessed type __int64 `vtable for'IOUSBNub[2];
// 7D218: using guessed type int __fastcall IOFree(_QWORD, _QWORD);

//----- (000000000000C4AE) ----------------------------------------------------
int __fastcall IOUSBInterface::joinPMtree(IOUSBInterface *this, IOService *a2)
{
  IOUSBInterface *v2; // rbx@1
  IOUSBDevice *v3; // rdi@1
  __int64 v4; // rax@3

  v2 = this;
  v3 = (IOUSBDevice *)*((_QWORD *)this + 51);
  if ( !v3 || !IOUSBDevice::GetInterfacePowerParent(v3) )
    JUMPOUT(__CS__, `vtable for'IOUSBNub[246]);
  v4 = IOUSBDevice::GetInterfacePowerParent(*((IOUSBDevice **)v2 + 51));
  return (*(int (__fastcall **)(_QWORD))(*(_QWORD *)v4 + 1952LL))(v4);
}
// 3D260: using guessed type __int64 `vtable for'IOUSBNub[2];

//----- (000000000000C50A) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::withDescriptors(__int64 a1, unsigned __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 result; // rax@1
  bool v4; // zf@2

  v2 = OSObject::operator new((OSObject *)stru_1A0.segname, a2);
  IOUSBNub::IOUSBNub(v2);
  *(_QWORD *)v2 = off_3C7C0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBInterface::gMetaClass);
  result = 0LL;
  if ( v2 )
  {
    v4 = (unsigned __int8)(*(int (__fastcall **)(__int64, __int64, unsigned __int64))(*(_QWORD *)v2 + 2160LL))(
                            v2,
                            a1,
                            a2) == 0;
    result = v2;
    if ( v4 )
    {
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 40LL))(v2);
      result = 0LL;
    }
  }
  return result;
}
// 1A0: using guessed type section_64 stru_1A0;
// 3C7C0: using guessed type __int64 (__fastcall *off_3C7C0[2])(IOUSBInterface *__hidden this);
// 495B0: using guessed type _QWORD IOUSBInterface::gMetaClass;

//----- (000000000000C580) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::hex2char(IOUSBInterface *this)
{
  int v1; // edi@1
  unsigned __int8 v2; // cl@1

  v1 = (unsigned __int8)this & 0xF;
  v2 = v1 + 48;
  if ( (unsigned int)v1 > 9 )
    v2 = v1 + 55;
  return v2;
}

//----- (000000000000C598) ----------------------------------------------------
char __fastcall IOUSBInterface::init(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rbx@1
  __int64 v4; // r12@1
  char v5; // r14@1
  const char *v6; // rsi@3
  void *v7; // rax@5
  __int64 v8; // rbx@7
  __int64 v9; // r12@8

  v3 = a3;
  v4 = a2;
  v5 = 0;
  if ( a3 )
  {
    if ( a2 )
    {
      v5 = 0;
      v6 = 0LL;
      if ( (unsigned __int8)((int (__fastcall *)(__int64, _QWORD))`vtable for'IOUSBNub[75])(a1, 0LL) )
      {
        if ( !*(_QWORD *)(a1 + 424) )
        {
          LODWORD(v7) = IOMalloc(176LL);
          *(_QWORD *)(a1 + 424) = v7;
          if ( !v7 )
            return 0;
          v6 = (_BYTE *)(&stru_68 + 72);
          bzero(v7, 0xB0uLL);
        }
        *(_QWORD *)(a1 + 392) = v4;
        *(_QWORD *)(a1 + 400) = v3;
        *(_BYTE *)(a1 + 416) = *(_BYTE *)(v3 + 2);
        *(_BYTE *)(a1 + 417) = *(_BYTE *)(v3 + 3);
        *(_BYTE *)(a1 + 418) = *(_BYTE *)(v3 + 4);
        *(_BYTE *)(a1 + 419) = *(_BYTE *)(v3 + 5);
        *(_BYTE *)(a1 + 420) = *(_BYTE *)(v3 + 6);
        *(_BYTE *)(a1 + 421) = *(_BYTE *)(v3 + 7);
        *(_BYTE *)(a1 + 422) = *(_BYTE *)(v3 + 8);
        v8 = OSDictionary::withCapacity((OSDictionary *)((char *)&dword_0 + 1), (unsigned int)v6);
        v5 = 1;
        if ( v8 )
        {
          v9 = OSString::withCString("IOUSBFamily.kext/Contents/PlugIns/IOUSBLib.bundle", v6);
          if ( v9 )
          {
            (*(void (__fastcall **)(__int64, _QWORD, __int64))(*(_QWORD *)v8 + 464LL))(
              v8,
              "2d9786c6-9ef3-11d4-ad51-000a27052861",
              v9);
            (*(void (__fastcall **)(__int64, _QWORD, _QWORD))(*(_QWORD *)a1 + 624LL))(
              a1,
              "IOUserClientClass",
              "IOUSBInterfaceUserClientV3");
            (*(void (__fastcall **)(__int64, _QWORD, __int64))(*(_QWORD *)a1 + 616LL))(a1, "IOCFPlugInTypes", v8);
            (*(void (__fastcall **)(__int64))(*(_QWORD *)v9 + 40LL))(v9);
          }
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v8 + 40LL))(v8);
        }
      }
    }
  }
  return v5;
}
// 0: using guessed type int;
// 68: using guessed type section_64 stru_68;
// 3D260: using guessed type __int64 `vtable for'IOUSBNub[2];
// 7D250: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (000000000000C6F6) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::SetProperties(IOUSBInterface *this)
{
  IOUSBInterface *v1; // r14@1
  __int64 v2; // r12@1
  void (__fastcall *v3)(_QWORD, _QWORD, _QWORD, _QWORD); // rbx@1
  unsigned __int16 v4; // ax@1
  void (__fastcall *v5)(_QWORD, _QWORD, _QWORD, _QWORD); // rbx@1
  unsigned __int16 v6; // ax@1
  void (__fastcall *v7)(_QWORD, _QWORD, _QWORD, _QWORD); // rbx@1
  unsigned __int16 v8; // ax@1
  unsigned int v9; // edx@1
  __int64 v10; // rbx@1
  unsigned __int16 v11; // r15@2
  unsigned __int8 v12; // al@3
  OSMetaClassBase *v13; // rax@8
  OSMetaClassBase *v14; // rbx@8
  __int64 v15; // rsi@8
  const OSMetaClass *v16; // rdx@8
  __int64 v17; // r15@8
  int v18; // er12@9
  unsigned __int16 v19; // r13@9
  unsigned __int16 v20; // bx@10
  __int64 v21; // rax@10
  __int64 v22; // r15@10
  unsigned int v23; // eax@10
  unsigned __int16 v24; // r8@14
  char *v25; // rdx@14
  signed __int64 v26; // rcx@14
  unsigned int v27; // esi@15
  char v28; // bl@15
  char *v29; // rdx@18
  signed __int64 v30; // rcx@18
  unsigned int v31; // esi@19
  char v32; // bl@19
  int v33; // er12@22
  __int64 v34; // rax@22
  __int64 v35; // rbx@25
  __int64 v36; // r13@25
  __int64 v37; // r12@25
  __int64 v38; // r15@26
  __int64 v39; // r13@26
  unsigned __int16 v40; // ax@26
  __int64 v41; // r12@27
  __int64 v42; // rbx@27
  OSMetaClassBase *v44; // [sp+8h] [bp-258h]@9
  char v45; // [sp+10h] [bp-250h]@14
  char v46; // [sp+11h] [bp-24Fh]@14
  char v47; // [sp+12h] [bp-24Eh]@14
  char v48; // [sp+13h] [bp-24Dh]@14
  char v49; // [sp+14h] [bp-24Ch]@14
  char v50; // [sp+18h] [bp-248h]@18
  char v51[12]; // [sp+1Ch] [bp-244h]@23
  char v52; // [sp+28h] [bp-238h]@24
  char v53; // [sp+110h] [bp-150h]@4
  char v54; // [sp+210h] [bp-50h]@2
  __int64 v55; // [sp+230h] [bp-30h]@1

  v1 = this;
  v2 = off_3B0E0[0];
  v55 = *(_QWORD *)off_3B0E0[0];
  (*(void (__fastcall **)(IOUSBInterface *, _QWORD, _QWORD, signed __int64))(*(_QWORD *)this + 640LL))(
    this,
    "bInterfaceNumber",
    *((_BYTE *)this + 416),
    8LL);
  (*(void (__fastcall **)(IOUSBInterface *, _QWORD, _QWORD, signed __int64))(*(_QWORD *)this + 640LL))(
    this,
    "bAlternateSetting",
    *((_BYTE *)this + 417),
    8LL);
  (*(void (__fastcall **)(IOUSBInterface *, _QWORD, _QWORD, signed __int64))(*(_QWORD *)v1 + 640LL))(
    v1,
    "bNumEndpoints",
    *((_BYTE *)v1 + 418),
    8LL);
  (*(void (__fastcall **)(IOUSBInterface *, _QWORD, _QWORD, signed __int64))(*(_QWORD *)v1 + 640LL))(
    v1,
    "bInterfaceClass",
    *((_BYTE *)v1 + 419),
    8LL);
  (*(void (__fastcall **)(IOUSBInterface *, _QWORD, _QWORD, signed __int64))(*(_QWORD *)v1 + 640LL))(
    v1,
    "bInterfaceSubClass",
    *((_BYTE *)v1 + 420),
    8LL);
  (*(void (__fastcall **)(IOUSBInterface *, _QWORD, _QWORD, signed __int64))(*(_QWORD *)v1 + 640LL))(
    v1,
    "bInterfaceProtocol",
    *((_BYTE *)v1 + 421),
    8LL);
  (*(void (__fastcall **)(IOUSBInterface *, _QWORD, _QWORD, signed __int64))(*(_QWORD *)v1 + 640LL))(
    v1,
    "iInterface",
    *((_BYTE *)v1 + 422),
    8LL);
  v3 = *(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 640LL);
  v4 = (*(int (**)(void))(**((_QWORD **)this + 51) + 2288LL))();
  v3(this, "idVendor", v4, 16LL);
  v5 = *(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 640LL);
  v6 = (*(int (**)(void))(**((_QWORD **)this + 51) + 2296LL))();
  v5(this, "idProduct", v6, 16LL);
  v7 = *(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 640LL);
  v8 = (*(int (**)(void))(**((_QWORD **)this + 51) + 2304LL))();
  v7(this, "bcdDevice", v8, 16LL);
  (*(void (__fastcall **)(IOUSBInterface *, _QWORD, _QWORD, signed __int64))(*(_QWORD *)v1 + 640LL))(
    v1,
    "bConfigurationValue",
    *(_BYTE *)(*((_QWORD *)v1 + 49) + 5LL),
    8LL);
  v10 = OSNumber::withNumber((OSNumber *)*((_BYTE *)this + 416), 8uLL, v9);
  if ( v10 )
  {
    v11 = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v10 + 320LL))(v10, 8LL);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v10 + 40LL))(v10);
    snprintf(&v54, 0x20uLL, "%x", v11);
    (*(void (__fastcall **)(IOUSBInterface *, char *, _QWORD))(*(_QWORD *)this + 976LL))(this, &v54, 0LL);
  }
  v12 = *((_BYTE *)this + 422);
  if ( v12
    && !(*(int (__fastcall **)(_QWORD, _QWORD, char *, signed __int64, signed __int64))(**((_QWORD **)this + 51) + 2392LL))(
          *((_QWORD *)this + 51),
          v12,
          &v53,
          256LL,
          1033LL)
    && v53 )
  {
    (*(void (__fastcall **)(IOUSBInterface *, char *, _QWORD))(*(_QWORD *)this + 944LL))(this, &v53, 0LL);
    (*(void (__fastcall **)(IOUSBInterface *, _QWORD, char *))(*(_QWORD *)this + 624LL))(
      this,
      "USB Interface Name",
      &v53);
  }
  if ( *((_BYTE *)this + 419) == 8 )
  {
    LODWORD(v13) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 51) + 744LL))(
                     *((_QWORD *)this + 51),
                     "USB Serial Number");
    v14 = v13;
    v15 = *(_QWORD *)off_3B088[0];
    v17 = OSMetaClassBase::safeMetaCast(v13, *(const OSMetaClassBase **)off_3B088[0], v16);
    if ( v17 )
    {
      v44 = v14;
      v18 = (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v17 + 304LL))(v17, v15);
      v19 = (*(int (**)(void))(**((_QWORD **)this + 51) + 2288LL))();
      if ( (unsigned int)v18 < 0xC )
      {
        v41 = (unsigned __int16)(*(int (**)(void))(**((_QWORD **)this + 51) + 2296LL))();
        v42 = (unsigned __int16)(*(int (**)(void))(**((_QWORD **)this + 51) + 2304LL))();
        (*(void (**)(void))(**((_QWORD **)this + 51) + 2256LL))();
        IOLog(
          "USBMSC Identifier (non-unique): 0x00000000 0x%x 0x%x 0x%x, %d\n",
          v19,
          (unsigned int)v41,
          (unsigned int)v42);
      }
      else
      {
        v20 = (*(int (**)(void))(**((_QWORD **)this + 51) + 2296LL))();
        LODWORD(v21) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v17 + 328LL))(v17);
        v22 = v21;
        v23 = 0;
        while ( (unsigned __int8)(*(_BYTE *)(v22 + v23) - 48) <= 0x16u
             && (unsigned __int8)(*(_BYTE *)(v22 + v23) - 58) >= 7u )
        {
          ++v23;
          if ( v23 >= v18 )
          {
            v24 = v20;
            v45 = 85;
            v46 = 83;
            v47 = 66;
            v48 = 58;
            v25 = &v49;
            v26 = 16LL;
            do
            {
              v26 -= 4LL;
              v27 = (v19 >> v26) & 0xF;
              v28 = v27 + 48;
              if ( v27 > 9 )
                v28 = v27 + 55;
              *v25++ = v28;
            }
            while ( v26 );
            v29 = &v50;
            v30 = 16LL;
            do
            {
              v30 -= 4LL;
              v31 = (v24 >> v30) & 0xF;
              v32 = v31 + 48;
              if ( v31 > 9 )
                v32 = v31 + 55;
              *v29++ = v32;
            }
            while ( v30 );
            v33 = v18 - 12;
            v34 = 0LL;
            do
            {
              v51[v34] = *(_BYTE *)(v22 + (unsigned int)(v33 + v34));
              ++v34;
            }
            while ( v34 != 12 );
            v52 = 0;
            (*(void (__fastcall **)(_QWORD, _QWORD, char *))(**((_QWORD **)this + 51) + 624LL))(
              *((_QWORD *)this + 51),
              "uid",
              &v45);
            break;
          }
        }
        v35 = (unsigned __int16)(*(int (**)(void))(**((_QWORD **)this + 51) + 2288LL))();
        v36 = (unsigned __int16)(*(int (**)(void))(**((_QWORD **)this + 51) + 2296LL))();
        v37 = (unsigned __int16)(*(int (**)(void))(**((_QWORD **)this + 51) + 2304LL))();
        (*(void (**)(void))(**((_QWORD **)this + 51) + 2256LL))();
        IOLog("USBMSC Identifier (non-unique): %s 0x%x 0x%x 0x%x, %d\n", v22, (unsigned int)v35, (unsigned int)v36);
      }
      v2 = off_3B0E0[0];
      v14 = v44;
    }
    else
    {
      v38 = (unsigned __int16)(*(int (__fastcall **)(_QWORD, __int64))(**((_QWORD **)this + 51) + 2288LL))(
                                *((_QWORD *)this + 51),
                                v15);
      v39 = (unsigned __int16)(*(int (**)(void))(**((_QWORD **)this + 51) + 2296LL))();
      v40 = (*(int (**)(void))(**((_QWORD **)this + 51) + 2304LL))();
      IOLog("USBMSC Identifier (non-unique): 0x%x 0x%x 0x%x\n", (unsigned int)v38, (unsigned int)v39, v40);
    }
    if ( v14 )
      (*(void (__fastcall **)(OSMetaClassBase *))(*(_QWORD *)v14 + 40LL))(v14);
  }
  return *(_QWORD *)v2;
}
// 3B088: using guessed type _QWORD off_3B088[17];
// 3B0E0: using guessed type __int64 off_3B0E0[6];
// 7D240: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD);
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);
// C6F6: using guessed type char var_244[12];

//----- (000000000000CC58) ----------------------------------------------------
int __fastcall IOUSBInterface::ClosePipes(IOUSBInterface *this)
{
  __int64 v1; // rax@1
  __int64 v2; // rbx@2
  __int64 v3; // r15@3

  v1 = *((_QWORD *)this + 53);
  if ( v1 )
  {
    v2 = *(_QWORD *)v1;
    if ( *(_QWORD *)v1 )
    {
      v3 = *(_QWORD *)(v1 + 8);
      if ( v3 )
      {
        (*(void (__cdecl **)(IOUSBInterface *))(*(_QWORD *)this + 32LL))(this);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 32LL))(v3);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 32LL))(v2);
        (*(void (__fastcall **)(__int64, __int64 (__fastcall *)(IOUSBInterface *__hidden, OSObject *, void *, void *, void *, void *), signed __int64, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v2 + 456LL))(
          v2,
          IOUSBInterface::_ClosePipes,
          1LL,
          0LL,
          0LL,
          0LL);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 40LL))(v2);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 40LL))(v3);
        LODWORD(v1) = (*(int (__fastcall **)(IOUSBInterface *))(*(_QWORD *)this + 40LL))(this);
      }
    }
  }
  return v1;
}

//----- (000000000000CCEE) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::_ClosePipes(IOUSBInterface *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  IOUSBInterface *v6; // rax@1
  const OSMetaClass *v7; // rdx@1
  signed int v8; // ecx@1

  v6 = (IOUSBInterface *)OSMetaClassBase::safeMetaCast(
                           this,
                           (const OSMetaClassBase *)&IOUSBInterface::gMetaClass,
                           (const OSMetaClass *)a3);
  v8 = -536870206;
  if ( v6 )
  {
    IOUSBInterface::ClosePipesGated(v6, a2 != 0LL, v7);
    v8 = 0;
  }
  return (unsigned int)v8;
}
// 495B0: using guessed type _QWORD IOUSBInterface::gMetaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000000CD2A) ----------------------------------------------------
int __fastcall IOUSBInterface::UnlinkPipes(IOUSBInterface *this)
{
  __int64 v1; // rax@1
  __int64 v2; // r14@3
  __int64 v3; // r15@4

  LODWORD(v1) = IOService::isInactive(this);
  if ( !(_BYTE)v1 )
  {
    v1 = *((_QWORD *)this + 53);
    if ( v1 )
    {
      v2 = *(_QWORD *)v1;
      if ( *(_QWORD *)v1 )
      {
        v3 = *(_QWORD *)(v1 + 8);
        if ( v3 )
        {
          (*(void (__cdecl **)(IOUSBInterface *))(*(_QWORD *)this + 32LL))(this);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 32LL))(v3);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 32LL))(v2);
          (*(void (__fastcall **)(__int64, __int64 (__fastcall *)(IOUSBInterface *__hidden, OSObject *, void *, void *, void *, void *), _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v2 + 456LL))(
            v2,
            IOUSBInterface::_ClosePipes,
            0LL,
            0LL,
            0LL,
            0LL);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 40LL))(v2);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 40LL))(v3);
          LODWORD(v1) = (*(int (__fastcall **)(IOUSBInterface *))(*(_QWORD *)this + 40LL))(this);
        }
      }
    }
  }
  return v1;
}

//----- (000000000000CDC6) ----------------------------------------------------
int __fastcall IOUSBInterface::ResetPipes(IOUSBInterface *this, __int64 a2, const OSMetaClass *a3)
{
  __int64 v3; // rbx@1
  __int64 v4; // rax@2
  int result; // eax@3

  v3 = 0LL;
  do
  {
    v4 = OSMetaClassBase::safeMetaCast(
           *((OSMetaClassBase **)this + v3 + 17),
           (const OSMetaClassBase *)IOUSBPipe::metaClass,
           a3);
    if ( v4 )
    {
      result = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v4 + 304LL))(v4, IOUSBPipe::metaClass);
      if ( result )
        break;
    }
    ++v3;
    result = 0;
  }
  while ( (unsigned int)v3 <= 0x1F );
  return result;
}
// 3DBC0: using guessed type _QWORD IOUSBPipe::metaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000000CE1A) ----------------------------------------------------
int __fastcall IOUSBInterface::AbortPipesGated(IOUSBInterface *this, __int64 a2, const OSMetaClass *a3)
{
  __int64 v3; // rbx@1
  __int64 v4; // rax@2
  int result; // eax@3

  v3 = 0LL;
  do
  {
    v4 = OSMetaClassBase::safeMetaCast(
           *((OSMetaClassBase **)this + v3 + 17),
           (const OSMetaClassBase *)IOUSBPipe::metaClass,
           a3);
    if ( v4 )
    {
      result = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v4 + 296LL))(v4, IOUSBPipe::metaClass);
      if ( result )
        break;
    }
    ++v3;
    result = 0;
  }
  while ( (unsigned int)v3 <= 0x1F );
  return result;
}
// 3DBC0: using guessed type _QWORD IOUSBPipe::metaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000000CE6E) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::ClosePipesGated(IOUSBInterface *this, char a2, const OSMetaClass *a3)
{
  __int64 v3; // rbx@1
  IOUSBPipe *v4; // r13@2

  v3 = 0LL;
  do
  {
    v4 = (IOUSBPipe *)OSMetaClassBase::safeMetaCast(
                        *((OSMetaClassBase **)this + v3 + 17),
                        (const OSMetaClassBase *)IOUSBPipe::metaClass,
                        a3);
    if ( v4 )
    {
      (*(void (__fastcall **)(IOUSBPipe *, _QWORD))(*(_QWORD *)v4 + 296LL))(v4, IOUSBPipe::metaClass);
      IOUSBPipe::ClosePipe(v4);
      if ( a2 )
      {
        (*(void (__fastcall **)(IOUSBPipe *))(*(_QWORD *)v4 + 40LL))(v4);
        *((_QWORD *)this + v3 + 17) = 0LL;
      }
    }
    ++v3;
  }
  while ( v3 != 32 );
  return 0LL;
}
// 3DBC0: using guessed type _QWORD IOUSBPipe::metaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000000CEF0) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::_ReopenPipes(IOUSBInterface *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  IOUSBInterface *v6; // rax@1
  const OSMetaClass *v7; // rdx@1
  signed int v8; // ecx@1

  v6 = (IOUSBInterface *)OSMetaClassBase::safeMetaCast(
                           this,
                           (const OSMetaClassBase *)&IOUSBInterface::gMetaClass,
                           (const OSMetaClass *)a3);
  v8 = -536870206;
  if ( v6 )
  {
    IOUSBInterface::ReopenPipesGated(v6, (__int64)&IOUSBInterface::gMetaClass, v7);
    v8 = 0;
  }
  return (unsigned int)v8;
}
// 495B0: using guessed type _QWORD IOUSBInterface::gMetaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000000CF18) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::ReopenPipesGated(IOUSBInterface *this, __int64 a2, const OSMetaClass *a3)
{
  signed __int64 v3; // r12@1
  __int64 v4; // rax@2
  __int64 v5; // rbx@2
  __int64 v6; // ST18_8@3
  int (__fastcall *v7)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD); // ST20_8@3
  __int64 v8; // r13@3
  unsigned __int8 v9; // r14@3
  unsigned __int16 v10; // ax@3

  v3 = 17LL;
  do
  {
    v4 = OSMetaClassBase::safeMetaCast(
           *((OSMetaClassBase **)this + v3),
           (const OSMetaClassBase *)IOUSBPipeV2::metaClass,
           a3);
    v5 = v4;
    if ( v4 )
    {
      v6 = *(_QWORD *)(v4 + 16);
      v7 = *(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v4 + 592LL);
      v8 = *(_QWORD *)(v4 + 64);
      v9 = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 51) + 2256LL))(
             *((_QWORD *)this + 51),
             IOUSBPipeV2::metaClass);
      v10 = (*(int (__cdecl **)(_QWORD, _QWORD))(**((_QWORD **)this + 51) + 2248LL))(
              *((_QWORD *)this + 51),
              IOUSBPipeV2::metaClass);
      if ( !(unsigned __int8)v7(v5, v6, v8, v9, v10, *(_QWORD *)(*((_QWORD *)this + 51) + 144LL)) )
      {
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v5 + 40LL))(v5);
        *((_QWORD *)this + v3) = 0LL;
      }
    }
    ++v3;
  }
  while ( v3 != 49 );
  return 0LL;
}
// 474A0: using guessed type _QWORD IOUSBPipeV2::metaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000000CFF2) ----------------------------------------------------
int __fastcall IOUSBInterface::ReopenPipes(IOUSBInterface *this)
{
  __int64 v1; // rax@1
  __int64 v2; // r14@3
  __int64 v3; // r15@4

  LODWORD(v1) = IOService::isInactive(this);
  if ( !(_BYTE)v1 )
  {
    v1 = *((_QWORD *)this + 53);
    if ( v1 )
    {
      v2 = *(_QWORD *)v1;
      if ( *(_QWORD *)v1 )
      {
        v3 = *(_QWORD *)(v1 + 8);
        if ( v3 )
        {
          (*(void (__cdecl **)(IOUSBInterface *))(*(_QWORD *)this + 32LL))(this);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 32LL))(v3);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 32LL))(v2);
          (*(void (__fastcall **)(__int64, __int64 (__fastcall *)(IOUSBInterface *__hidden, OSObject *, void *, void *, void *, void *), _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v2 + 456LL))(
            v2,
            IOUSBInterface::_ReopenPipes,
            0LL,
            0LL,
            0LL,
            0LL);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 40LL))(v2);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 40LL))(v3);
          LODWORD(v1) = (*(int (__fastcall **)(IOUSBInterface *))(*(_QWORD *)this + 40LL))(this);
        }
      }
    }
  }
  return v1;
}

//----- (000000000000D08E) ----------------------------------------------------
__int64 __usercall IOUSBInterface::CreatePipes@<rax>(IOUSBInterface *this@<rdi>, char a2@<al>)
{
  IOUSBInterface *v2; // r15@1
  __int64 v3; // rbx@1
  __int64 v4; // r13@1
  __int64 v5; // rax@2
  __int64 v6; // rax@4
  __int64 v7; // rdx@4
  __int64 v8; // rdi@8
  __int64 v9; // rax@9
  __int64 v10; // rax@10
  __int64 v11; // r9@10
  char v13; // [sp-8h] [bp-30h]@1

  v13 = a2;
  v2 = this;
  v3 = 0LL;
  v4 = 0LL;
  do
  {
    LODWORD(v5) = (*(int (__fastcall **)(IOUSBInterface *, __int64, signed __int64))(*(_QWORD *)v2 + 2184LL))(
                    v2,
                    v4,
                    5LL);
    v4 = v5;
    if ( !v5 )
      break;
    if ( !*((_QWORD *)v2 + v3 + 17) )
    {
      LODWORD(v6) = (*(int (__fastcall **)(IOUSBInterface *, __int64, _QWORD))(*(_QWORD *)v2 + 2184LL))(v2, v5, 0LL);
      v7 = 0LL;
      if ( v6 )
      {
        if ( *(_BYTE *)(v6 + 1) != 48 )
          v6 = 0LL;
        v7 = v6;
      }
      v8 = *((_QWORD *)v2 + 51);
      if ( *(_BYTE *)(v4 + 2) & 0xF )
      {
        LODWORD(v9) = (*(int (__fastcall **)(__int64, __int64, __int64, IOUSBInterface *))(*(_QWORD *)v8 + 2544LL))(
                        v8,
                        v4,
                        v7,
                        v2);
        *((_QWORD *)v2 + v3 + 17) = v9;
      }
      else
      {
        LODWORD(v10) = (*(int (__fastcall **)(__int64, _QWORD, __int64))(*(_QWORD *)v8 + 904LL))(v8, 0LL, v7);
        KernelDebugLogInternal(
          1u,
          0x55534246u,
          (__int64)"USB Device (%s) interface (%d) has an invalid endpoint descriptor with zero endpoint number",
          v10,
          *((_BYTE *)v2 + 416),
          v11,
          v13);
      }
    }
    ++v3;
  }
  while ( (unsigned int)v3 < 0x20 );
  return 0LL;
}

//----- (000000000000D170) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::FindNextAltInterface(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rdx@1
  bool v5; // zf@2
  __int64 result; // rax@2
  __int64 v7; // [sp+0h] [bp-20h]@1

  v3 = a3;
  v4 = a2;
  v7 = a2;
  do
  {
    v5 = (*(int (__fastcall **)(_QWORD, _QWORD, __int64, __int64, __int64 *))(**(_QWORD **)(a1 + 408) + 2192LL))(
           *(_QWORD *)(a1 + 408),
           0LL,
           v4,
           v3,
           &v7) == 0;
    result = 0LL;
    if ( !v5 )
      break;
    v4 = v7;
    result = 0LL;
    if ( !v7 )
      break;
    result = v7;
  }
  while ( *(_BYTE *)(v7 + 2) != *(_BYTE *)(a1 + 416) );
  return result;
}

//----- (000000000000D1D8) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::FindNextPipe(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rax@1
  __int64 v4; // rbx@1

  LODWORD(v3) = (*(int (__fastcall **)(__int64, __int64, __int64, signed __int64))(*(_QWORD *)a1 + 2304LL))(
                  a1,
                  a2,
                  a3,
                  1LL);
  v4 = v3;
  if ( v3 )
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 40LL))(v3);
  return v4;
}

//----- (000000000000D208) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::FindNextPipe(__int64 a1, __int64 a2, __int64 a3, unsigned __int8 a4)
{
  unsigned __int8 v4; // r12@1
  char v5; // cl@1
  __int64 result; // rax@1
  __int64 v7; // rcx@2
  __int64 v8; // r13@3
  __int64 v9; // r14@4
  __int64 v10; // [sp+8h] [bp-38h]@1
  __int64 v11; // [sp+10h] [bp-30h]@1

  v4 = a4;
  v10 = a3;
  v11 = 0LL;
  v5 = IOService::isInactive((IOService *)a1);
  result = 0LL;
  if ( !v5 )
  {
    v7 = *(_QWORD *)(a1 + 424);
    result = 0LL;
    if ( v7 )
    {
      v8 = *(_QWORD *)v7;
      result = 0LL;
      if ( *(_QWORD *)v7 )
      {
        v9 = *(_QWORD *)(v7 + 8);
        result = 0LL;
        if ( v9 )
        {
          (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v9 + 32LL))(v9);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v8 + 32LL))(v8);
          (*(void (__fastcall **)(__int64, __int64 (__fastcall *)(IOUSBInterface *__hidden, OSObject *, void *, void *, void *, void *), __int64, __int64, _QWORD, __int64 *))(*(_QWORD *)v8 + 456LL))(
            v8,
            IOUSBInterface::_FindNextPipe,
            a2,
            v10,
            v4,
            &v11);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v8 + 40LL))(v8);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v9 + 40LL))(v9);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
          result = v11;
        }
      }
    }
  }
  return result;
}

//----- (000000000000D2D0) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::_FindNextPipe(IOUSBInterface *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  void *v6; // r14@1
  void *v7; // rbx@1
  const OSMetaClass *v8; // r15@1
  __int64 v9; // rax@1
  signed int v10; // ecx@1

  v6 = a5;
  v7 = a4;
  v8 = (const OSMetaClass *)a3;
  v9 = OSMetaClassBase::safeMetaCast(
         this,
         (const OSMetaClassBase *)&IOUSBInterface::gMetaClass,
         (const OSMetaClass *)a3);
  v10 = -536870206;
  if ( v9 )
  {
    *(_QWORD *)v6 = IOUSBInterface::FindNextPipeGated(v9, (__int64)a2, v8, v7 != 0LL);
    v10 = 0;
  }
  return (unsigned int)v10;
}
// 495B0: using guessed type _QWORD IOUSBInterface::gMetaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000000D324) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::FindNextPipeGated(__int64 a1, __int64 a2, const OSMetaClass *a3, char a4)
{
  __int64 v4; // rax@1
  __int64 v5; // rbx@1
  signed int v6; // er15@2
  bool v7; // zf@6
  __int64 v8; // r12@10
  const OSMetaClass *v9; // rsi@11
  __int64 v10; // r14@11
  __int64 v11; // rax@12
  int v12; // ecx@12
  int v13; // ecx@14
  char v15; // [sp+4h] [bp-3Ch]@10
  const OSMetaClass *v16; // [sp+10h] [bp-30h]@1

  v16 = a3;
  LODWORD(v4) = 0;
  v5 = 0LL;
  if ( !a3 )
    return v5;
  v6 = *(_BYTE *)(a1 + 418);
  if ( a2 )
  {
    v4 = 0LL;
    while ( (signed int)v4 < v6 && (signed int)v4 <= 31 )
    {
      a3 = (const OSMetaClass *)(v4 + 1);
      v7 = *(_QWORD *)(a1 + 8 * v4++ + 136) == a2;
      if ( v7 )
      {
        LODWORD(v4) = (_DWORD)a3;
        break;
      }
    }
  }
  v5 = 0LL;
  if ( (signed int)v4 >= v6 || (signed int)v4 > 31 )
    return v5;
  v15 = a4;
  v8 = (signed int)v4;
  while ( 1 )
  {
    v9 = (const OSMetaClass *)IOUSBPipe::metaClass;
    v10 = OSMetaClassBase::safeMetaCast(
            *(OSMetaClassBase **)(a1 + 8 * v8 + 136),
            (const OSMetaClassBase *)IOUSBPipe::metaClass,
            a3);
    v5 = v10;
    if ( !v10 )
      goto LABEL_16;
    LODWORD(v11) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v10 + 368LL))(v10, IOUSBPipe::metaClass);
    v12 = *(_BYTE *)v16;
    if ( v12 != 255 )
    {
      a3 = (const OSMetaClass *)*(_BYTE *)(v11 + 10);
      v5 = 0LL;
      if ( (unsigned __int8)v12 != (_DWORD)a3 )
        goto LABEL_16;
    }
    v13 = *((_BYTE *)v16 + 1);
    LOBYTE(a3) = *(_BYTE *)(v11 + 9);
    if ( v13 == 3 )
      break;
    a3 = (const OSMetaClass *)(unsigned __int8)a3;
    v9 = (const OSMetaClass *)(unsigned __int8)v13;
    v5 = 0LL;
    if ( (unsigned __int8)v13 == (unsigned __int8)a3 )
      goto LABEL_20;
LABEL_16:
    ++v8;
    if ( (signed int)v8 >= v6 || (signed int)v8 >= 32 )
      goto LABEL_21;
  }
  LOBYTE(v13) = *(_BYTE *)(v11 + 9);
LABEL_20:
  v9 = v16;
  *(_BYTE *)v16 = *(_BYTE *)(v11 + 10);
  *((_BYTE *)v16 + 1) = v13;
  *((_WORD *)v16 + 1) = *(_WORD *)(v11 + 12);
  *((_BYTE *)v16 + 4) = *(_BYTE *)(v11 + 14);
  v5 = v10;
LABEL_21:
  if ( v5 && v15 == 1 )
    (*(void (__fastcall **)(__int64, const OSMetaClass *))(*(_QWORD *)v5 + 32LL))(v5, v9);
  return v5;
}
// 3DBC0: using guessed type _QWORD IOUSBPipe::metaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000000D45C) ----------------------------------------------------
const void *__fastcall IOUSBInterface::FindNextAssociatedDescriptor(IOUSBInterface *this, const void *a2, unsigned __int8 a3)
{
  unsigned __int8 v3; // bl@1
  const void *v4; // rax@1
  const void *v5; // rcx@3
  int v6; // edx@4

  v3 = a3;
  v4 = a2;
  if ( !a2 )
    v4 = (const void *)*((_QWORD *)this + 50);
  do
  {
    LODWORD(v4) = (*(int (__fastcall **)(_QWORD, const void *, _QWORD))(**((_QWORD **)this + 51) + 2408LL))(
                    *((_QWORD *)this + 51),
                    v4,
                    0LL);
    v5 = 0LL;
    if ( !v4 )
      break;
    v6 = *((_BYTE *)v4 + 1);
    v5 = 0LL;
    if ( v6 == 11 )
      break;
    if ( (unsigned __int8)v6 == 4 )
    {
      v5 = 0LL;
      if ( v3 != 4 )
        break;
      LOBYTE(v6) = 4;
      v5 = 0LL;
      if ( *((_BYTE *)v4 + 2) != *((_BYTE *)this + 416) )
        break;
    }
    if ( (unsigned __int8)v6 == v3 )
      return v4;
    v5 = v4;
  }
  while ( v3 );
  return v5;
}

//----- (000000000000D4EE) ----------------------------------------------------
int __fastcall IOUSBInterface::SetAlternateInterface(IOUSBInterface *this, IOService *a2, unsigned __int16 a3)
{
  unsigned __int16 v3; // r14@1
  char v4; // cl@1
  int result; // eax@1
  __int64 v6; // rax@2
  int v7; // er15@2
  __int64 v8; // r14@2
  int v9; // ebx@2
  __int16 v10; // ax@12
  __int16 v11; // cx@12
  char v12; // [sp+8h] [bp-38h]@12
  char v13; // [sp+9h] [bp-37h]@12
  __int16 v14; // [sp+Ah] [bp-36h]@12
  __int16 v15; // [sp+Ch] [bp-34h]@12
  __int16 v16; // [sp+Eh] [bp-32h]@12
  __int64 v17; // [sp+10h] [bp-30h]@12

  v3 = a3;
  v4 = (*(int (__fastcall **)(IOUSBInterface *, IOService *))(*(_QWORD *)this + 1504LL))(this, a2);
  result = -536870203;
  if ( v4 )
  {
    v6 = *((_QWORD *)this + 49);
    v7 = v3;
    v8 = 0LL;
    v9 = 0;
    while ( 1 )
    {
      LODWORD(v6) = (*(int (__fastcall **)(_QWORD, __int64, signed __int64))(**((_QWORD **)this + 51) + 2408LL))(
                      *((_QWORD *)this + 51),
                      v6,
                      4LL);
      if ( !v6 )
        break;
      ++v9;
      if ( *(_BYTE *)(v6 + 2) == *((_BYTE *)this + 416) )
      {
        v8 = v6;
        if ( *(_BYTE *)(v6 + 3) == v7 )
        {
          v8 = v6;
LABEL_12:
          (*(void (__fastcall **)(IOUSBInterface *))(*(_QWORD *)this + 2136LL))(this);
          *((_QWORD *)this + 50) = v8;
          v10 = *(_BYTE *)(v8 + 2);
          *((_BYTE *)this + 416) = v10;
          v11 = *(_BYTE *)(v8 + 3);
          *((_BYTE *)this + 417) = v11;
          *((_BYTE *)this + 418) = *(_BYTE *)(v8 + 4);
          *((_BYTE *)this + 419) = *(_BYTE *)(v8 + 5);
          *((_BYTE *)this + 420) = *(_BYTE *)(v8 + 6);
          *((_BYTE *)this + 421) = *(_BYTE *)(v8 + 7);
          *((_BYTE *)this + 422) = *(_BYTE *)(v8 + 8);
          v12 = 1;
          v13 = 11;
          v14 = v11;
          v15 = v10;
          v16 = 0;
          v17 = 0LL;
          result = (*(int (__fastcall **)(_QWORD, char *, _QWORD))(**((_QWORD **)this + 51) + 2360LL))(
                     *((_QWORD *)this + 51),
                     &v12,
                     0LL);
          if ( !result )
          {
            (*(void (__fastcall **)(IOUSBInterface *))(*(_QWORD *)this + 2152LL))(this);
            result = (*(int (__fastcall **)(IOUSBInterface *))(*(_QWORD *)this + 2144LL))(this);
          }
          return result;
        }
      }
    }
    result = -536854450;
    if ( *((_BYTE *)this + 419) == 7 )
    {
      *((_BYTE *)this + 420) = 1;
      if ( v7 == 1 && v9 == 1 && v8 && !*(_BYTE *)(v8 + 3) )
        goto LABEL_12;
    }
  }
  return result;
}

//----- (000000000000D682) ----------------------------------------------------
char __fastcall IOUSBInterface::matchPropertyTable(IOUSBInterface *this, OSDictionary *a2, int *a3)
{
  int *v3; // r14@1
  OSDictionary *v4; // r12@1
  __int64 v5; // rbx@1
  int v6; // er15@1
  __int64 v7; // rax@2
  __int64 v8; // rax@2
  __int64 v9; // rax@2
  __int64 v10; // rax@2
  __int64 v11; // rax@2
  __int64 v12; // rax@2
  __int64 v13; // rax@2
  __int64 v14; // rax@2
  __int64 v15; // rax@2
  OSMetaClassBase *v16; // rax@2
  const OSMetaClass *v17; // rdx@2
  unsigned __int8 v18; // r14@2
  unsigned __int8 v19; // cl@3
  char v20; // r14@4
  int v21; // eax@6
  unsigned __int8 v22; // r15@7
  int v23; // ebx@10
  int v24; // eax@10
  int v25; // ebx@14
  int v26; // eax@14
  int v27; // ebx@18
  unsigned __int8 v28; // cl@18
  int v29; // er15@18
  unsigned __int8 v30; // bl@21
  unsigned __int8 v31; // al@21
  unsigned int v32; // ebx@22
  char v33; // al@22
  bool v34; // r14@30
  signed int v35; // ecx@30
  OSMetaClassBase *v36; // rax@32
  const OSMetaClass *v37; // rdx@32
  __int64 v38; // rax@32
  __int64 v39; // r10@32
  bool v40; // r14@32
  bool v41; // cl@32
  unsigned __int8 v42; // r11@32
  bool v43; // r9@32
  int *v44; // rbx@39
  int v45; // ecx@39
  signed int v46; // eax@39
  signed __int64 v47; // rsi@39
  __int64 v48; // rdx@41
  __int64 v49; // r15@43
  int v50; // eax@43
  int v51; // eax@74
  int v52; // edx@75
  int v53; // eax@75
  OSMetaClassBase *v54; // rax@79
  const OSMetaClass *v55; // rdx@79
  __int64 v56; // rax@79
  __int64 v57; // rax@79
  __int64 v58; // rax@79
  __int64 v59; // rax@79
  __int64 v60; // rax@79
  __int64 v61; // rax@79
  __int64 v62; // rax@79
  __int64 v63; // rax@79
  __int64 v64; // rax@79
  __int64 v65; // rax@79
  __int64 v66; // rax@79
  __int64 v67; // rax@79
  __int64 v68; // rax@79
  __int64 v69; // rax@79
  __int64 v70; // r15@79
  __int64 v71; // rax@79
  __int64 v72; // rbx@79
  __int64 v73; // rax@79
  __int64 v74; // r12@79
  char v75; // r15@87
  char *v76; // rsi@87
  int v77; // eax@88
  __int64 v78; // rcx@91
  const char *v79; // rdx@91
  unsigned int v80; // er13@97
  int v81; // eax@101
  int v82; // eax@103
  int v83; // eax@105
  int v84; // eax@107
  int v85; // eax@109
  int v86; // eax@111
  int v87; // eax@113
  char *v88; // rdi@113
  char *v89; // rsi@113
  char v90; // bl@117
  int v91; // er12@118
  int v92; // eax@118
  int v93; // er14@121
  int v94; // eax@121
  int v95; // er14@124
  int v96; // eax@124
  int v97; // er14@127
  int v98; // eax@127
  int v99; // er14@130
  int v100; // eax@130
  int v101; // er14@133
  int v102; // eax@133
  int v103; // er14@136
  int v104; // eax@136
  int v105; // er14@139
  int v106; // eax@139
  __int64 v107; // rax@145
  int v109; // [sp+8h] [bp-2E8h]@30
  __int64 v110; // [sp+8h] [bp-2E8h]@87
  bool v111; // [sp+17h] [bp-2D9h]@32
  int v112; // [sp+18h] [bp-2D8h]@22
  __int64 v113; // [sp+18h] [bp-2D8h]@87
  int v114; // [sp+20h] [bp-2D0h]@18
  char v115[8]; // [sp+20h] [bp-2D0h]@87
  __int64 v116; // [sp+28h] [bp-2C8h]@2
  __int64 v117; // [sp+28h] [bp-2C8h]@79
  __int64 v118; // [sp+30h] [bp-2C0h]@2
  __int64 v119; // [sp+30h] [bp-2C0h]@79
  __int64 v120; // [sp+38h] [bp-2B8h]@2
  __int64 v121; // [sp+38h] [bp-2B8h]@79
  __int64 v122; // [sp+40h] [bp-2B0h]@2
  __int64 v123; // [sp+40h] [bp-2B0h]@79
  int v124; // [sp+48h] [bp-2A8h]@16
  __int64 v125; // [sp+48h] [bp-2A8h]@79
  __int64 v126; // [sp+50h] [bp-2A0h]@2
  __int64 v127; // [sp+50h] [bp-2A0h]@79
  int v128; // [sp+58h] [bp-298h]@12
  __int64 v129; // [sp+58h] [bp-298h]@79
  int v130; // [sp+60h] [bp-290h]@14
  __int64 v131; // [sp+60h] [bp-290h]@79
  int v132; // [sp+68h] [bp-288h]@8
  __int64 v133; // [sp+68h] [bp-288h]@79
  __int64 v134; // [sp+70h] [bp-280h]@2
  __int64 v135; // [sp+70h] [bp-280h]@39
  __int64 v136; // [sp+78h] [bp-278h]@2
  signed int v137; // [sp+78h] [bp-278h]@32
  __int64 v138; // [sp+78h] [bp-278h]@79
  signed int v139; // [sp+80h] [bp-270h]@2
  OSMetaClassBase *v140; // [sp+80h] [bp-270h]@32
  int *v141; // [sp+88h] [bp-268h]@2
  __int64 v142; // [sp+88h] [bp-268h]@79
  __int64 v143; // [sp+90h] [bp-260h]@2
  __int64 v144; // [sp+90h] [bp-260h]@79
  __int64 v145; // [sp+98h] [bp-258h]@2
  __int64 v146; // [sp+A0h] [bp-250h]@2
  unsigned int v147; // [sp+A0h] [bp-250h]@30
  char v148; // [sp+A0h] [bp-250h]@75
  int v149; // [sp+A8h] [bp-248h]@6
  __int64 v150; // [sp+A8h] [bp-248h]@79
  unsigned __int8 v151; // [sp+B4h] [bp-23Ch]@23
  char v152; // [sp+B5h] [bp-23Bh]@2
  unsigned __int8 v153; // [sp+B6h] [bp-23Ah]@2
  unsigned __int8 v154; // [sp+B7h] [bp-239h]@2
  unsigned __int8 v155; // [sp+B8h] [bp-238h]@2
  unsigned __int8 v156; // [sp+B9h] [bp-237h]@2
  unsigned __int8 v157; // [sp+BAh] [bp-236h]@2
  unsigned __int8 v158; // [sp+BAh] [bp-236h]@23
  unsigned __int8 v159; // [sp+BBh] [bp-235h]@2
  unsigned __int8 v160; // [sp+BBh] [bp-235h]@10
  char v161; // [sp+BBh] [bp-235h]@29
  unsigned int v162; // [sp+BCh] [bp-234h]@3
  char v163; // [sp+C0h] [bp-230h]@87
  char v164; // [sp+1C0h] [bp-130h]@1
  __int64 v165; // [sp+2C0h] [bp-30h]@1

  v3 = a3;
  v4 = a2;
  v5 = off_3B0E0[0];
  v165 = *(_QWORD *)off_3B0E0[0];
  v6 = *a3;
  __bzero(&v164, 256LL);
  if ( !a2 )
  {
    v20 = 0;
    goto LABEL_145;
  }
  v139 = v6;
  v141 = v3;
  LODWORD(v7) = (*(int (__fastcall **)(OSDictionary *, __int64))(*(_QWORD *)a2 + 504LL))(a2, gUSBVendorID);
  v116 = v7;
  LODWORD(v8) = (*(int (__fastcall **)(OSDictionary *, __int64))(*(_QWORD *)a2 + 504LL))(a2, gUSBProductID);
  v122 = v8;
  LODWORD(v9) = (*(int (__fastcall **)(OSDictionary *, __int64))(*(_QWORD *)a2 + 504LL))(a2, gUSBInterfaceNumber);
  v120 = v9;
  LODWORD(v10) = (*(int (__fastcall **)(OSDictionary *, __int64))(*(_QWORD *)a2 + 504LL))(a2, gUSBConfigurationValue);
  v118 = v10;
  LODWORD(v11) = (*(int (__fastcall **)(OSDictionary *, __int64))(*(_QWORD *)a2 + 504LL))(a2, gUSBDeviceReleaseNumber);
  v126 = v11;
  LODWORD(v12) = (*(int (__fastcall **)(OSDictionary *, __int64))(*(_QWORD *)a2 + 504LL))(a2, gUSBInterfaceClass);
  v136 = v12;
  LODWORD(v13) = (*(int (__fastcall **)(OSDictionary *, __int64))(*(_QWORD *)a2 + 504LL))(a2, gUSBInterfaceSubClass);
  v134 = v13;
  LODWORD(v14) = (*(int (__fastcall **)(OSDictionary *, __int64))(*(_QWORD *)a2 + 504LL))(a2, gUSBInterfaceProtocol);
  v143 = v14;
  LODWORD(v15) = (*(int (__fastcall **)(OSDictionary *, __int64))(*(_QWORD *)a2 + 504LL))(a2, gUSBProductIDMask);
  v146 = v15;
  LODWORD(v16) = (*(int (__fastcall **)(OSDictionary *, _QWORD))(*(_QWORD *)a2 + 520LL))(a2, "idProductArray");
  v145 = OSMetaClassBase::safeMetaCast(v16, *(const OSMetaClassBase **)off_3B070[0], v17);
  v152 = (*(int (__fastcall **)(IOUSBInterface *, OSDictionary *, __int64))(*(_QWORD *)this + 2128LL))(
           this,
           a2,
           gUSBVendorID);
  v159 = (*(int (__fastcall **)(IOUSBInterface *, OSDictionary *, __int64))(*(_QWORD *)this + 2128LL))(
           this,
           a2,
           gUSBProductID);
  v154 = (*(int (__fastcall **)(IOUSBInterface *, OSDictionary *, __int64))(*(_QWORD *)this + 2128LL))(
           this,
           a2,
           gUSBInterfaceNumber);
  v155 = (*(int (__fastcall **)(IOUSBInterface *, OSDictionary *, __int64))(*(_QWORD *)this + 2128LL))(
           this,
           a2,
           gUSBConfigurationValue);
  v156 = (*(int (__fastcall **)(IOUSBInterface *, OSDictionary *, __int64))(*(_QWORD *)this + 2128LL))(
           this,
           a2,
           gUSBDeviceReleaseNumber);
  v153 = (*(int (__fastcall **)(IOUSBInterface *, OSDictionary *, __int64))(*(_QWORD *)this + 2128LL))(
           this,
           a2,
           gUSBInterfaceClass);
  v157 = (*(int (__fastcall **)(IOUSBInterface *, OSDictionary *, __int64))(*(_QWORD *)this + 2128LL))(
           this,
           a2,
           gUSBInterfaceSubClass);
  v18 = (*(int (__fastcall **)(IOUSBInterface *, OSDictionary *, __int64))(*(_QWORD *)this + 2128LL))(
          this,
          a2,
          gUSBInterfaceProtocol);
  if ( v145 )
    v19 = IOUSBNub::USBComparePropertyInArray(this, a2, "idProductArray", (const char *)"idProduct", &v162);
  else
    v19 = v159;
  v149 = 0;
  v21 = 0;
  if ( !v152 )
  {
    v22 = v19;
    LOBYTE(v21) = IOUSBNub::IsWildCardMatch(this, a2, (const char *)"idVendor");
    v19 = v22;
    v152 = v21;
    v21 = (unsigned __int8)v21;
  }
  v132 = v21;
  if ( !v19 )
  {
    v19 = IOUSBNub::IsWildCardMatch(this, a2, (const char *)"idProduct");
    v149 = v19;
  }
  v160 = v19;
  v23 = 0;
  v24 = 0;
  if ( !v154 )
  {
    v154 = IOUSBNub::IsWildCardMatch(this, a2, (const char *)"bInterfaceNumber");
    v24 = v154;
  }
  v128 = v24;
  if ( !v155 )
  {
    v155 = IOUSBNub::IsWildCardMatch(this, a2, (const char *)"bConfigurationValue");
    v23 = v155;
  }
  v130 = v23;
  v25 = 0;
  v26 = 0;
  if ( !v156 )
  {
    v156 = IOUSBNub::IsWildCardMatch(this, a2, (const char *)"bcdDevice");
    v26 = v156;
  }
  v124 = v26;
  if ( !v153 )
  {
    v153 = IOUSBNub::IsWildCardMatch(this, a2, (const char *)"bInterfaceClass");
    v25 = v153;
  }
  v114 = v25;
  v27 = 0;
  v28 = v157;
  v29 = 0;
  if ( !v157 )
  {
    v28 = IOUSBNub::IsWildCardMatch(this, a2, (const char *)"bInterfaceSubClass");
    v29 = v28;
  }
  if ( !v18 )
  {
    v30 = v28;
    v31 = IOUSBNub::IsWildCardMatch(this, a2, (const char *)"bInterfaceProtocol");
    v28 = v30;
    v18 = v31;
    v27 = v31;
  }
  v112 = v27;
  v32 = 0;
  v33 = v160;
  if ( v160 )
  {
    v158 = v28;
    v151 = v18;
  }
  else
  {
    v158 = v28;
    v151 = v18;
    if ( v146 )
    {
      if ( v145 )
        v33 = IOUSBNub::USBComparePropertyInArrayWithMask(
                this,
                a2,
                "idProductArray",
                (const char *)"idProduct",
                (const char *)"idProductMask",
                &v162);
      else
        v33 = IOUSBNub::USBComparePropertyWithMask(this, a2, (const char *)"idProduct", (const char *)"idProductMask");
      LOBYTE(v32) = v33;
    }
  }
  v161 = v33;
  if ( (unsigned __int8)((int (__fastcall *)(IOUSBInterface *, OSDictionary *))`vtable for'IOUSBNub[202])(this, a2) )
  {
    v109 = v29;
    v147 = v32;
    v34 = v136 != 0;
    v35 = 9000;
    if ( v139 <= 9999 )
      v35 = v139;
    v137 = v35;
    LODWORD(v36) = (*(int (__fastcall **)(IOUSBInterface *, __int64))(*(_QWORD *)this + 728LL))(
                     this,
                     gUSBInterfaceClass);
    v140 = v36;
    v38 = OSMetaClassBase::safeMetaCast(v36, *(const OSMetaClassBase **)off_3B078[0], v37);
    v39 = v38;
    v111 = v152 == 0;
    v40 = v34 && v153 == 0;
    v41 = v134 != 0 && v158 == 0;
    v42 = v151;
    v43 = v143 != 0 && v151 == 0;
    if ( v152 != 0 && v161 != 0 && v156 && v155 && v154 && !v40 && !v41 && !v43 )
    {
      v135 = v38;
      v44 = v141;
      *v141 = 100000;
      v45 = v124 + v130 + v128 + v132 + v149;
      v46 = 100000;
      v47 = v147;
LABEL_74:
      v51 = v137 + v46;
      *v44 = v51;
      v20 = 1;
      goto LABEL_75;
    }
    v48 = v126;
    v44 = v141;
    if ( !v43 && !v41 && !v40 && v154 != 0 && v155 != 0 && v152 != 0 && v161 != 0 && (v156 != 0 || v126 == 0) )
    {
      v135 = v38;
      *v141 = 90000;
      v45 = v130 + v128 + v132 + v149;
      v46 = 90000;
      v47 = v147;
      goto LABEL_74;
    }
    if ( v38
      && (v49 = v38,
          v50 = (*(int (__fastcall **)(__int64))(*(_QWORD *)v38 + 328LL))(v38),
          v42 = v151,
          v48 = v126,
          v39 = v49,
          v50 == 255) )
    {
      v47 = v147;
      if ( !v111 && v158 != 0 && v151 && !v40 && v126 == 0 && !v122 && !v120 && !v118 )
      {
        v135 = v49;
        *v141 = 80000;
        v45 = v112 + v132 + v109;
        v46 = 80000;
        goto LABEL_74;
      }
      if ( !v111 && v158 != 0 && v143 == 0 && !v40 && !v126 && !v122 && !v120 && !v118 )
      {
        v135 = v49;
        *v141 = 70000;
        v45 = v132 + v109;
        v46 = 70000;
        goto LABEL_74;
      }
    }
    else
    {
      v47 = v147;
      if ( v158 != 0 && v153 != 0 && v42 && !v48 && !v116 && !v122 && !v120 && !v118 )
      {
        v135 = v39;
        *v141 = 60000;
        v45 = v112 + v114 + v109;
        v46 = 60000;
        goto LABEL_74;
      }
      if ( v143 == 0 && v158 != 0 && v153 != 0 && !v48 && !v116 && !v122 && !v120 && !v118 )
      {
        v135 = v39;
        *v141 = 50000;
        v45 = v114 + v109;
        v46 = 50000;
        goto LABEL_74;
      }
    }
    v135 = v39;
    *v141 = 0;
    v51 = 0;
    v20 = 0;
    v45 = 0;
LABEL_75:
    v148 = v47;
    v52 = v51 + -1000 * v45;
    v53 = v52 - 500;
    if ( !(_BYTE)v47 )
      v53 = v52;
    *v44 = v53;
    if ( v53 <= 0 )
      goto LABEL_142;
    if ( (unsigned int)gKernelDebugLevel < 5 )
      goto LABEL_142;
    LODWORD(v54) = (*(int (__fastcall **)(OSDictionary *, _QWORD))(*(_QWORD *)v4 + 520LL))(v4, "CFBundleIdentifier");
    OSMetaClassBase::safeMetaCast(v54, *(const OSMetaClassBase **)off_3B088[0], v55);
    LODWORD(v56) = (*(int (__fastcall **)(IOUSBInterface *, __int64))(*(_QWORD *)this + 680LL))(this, gUSBVendorID);
    v129 = v56;
    LODWORD(v57) = (*(int (__fastcall **)(IOUSBInterface *, __int64))(*(_QWORD *)this + 680LL))(this, gUSBProductID);
    v133 = v57;
    LODWORD(v58) = (*(int (__fastcall **)(IOUSBInterface *, __int64))(*(_QWORD *)this + 680LL))(
                     this,
                     gUSBDeviceReleaseNumber);
    v144 = v58;
    LODWORD(v59) = (*(int (__fastcall **)(IOUSBInterface *, __int64))(*(_QWORD *)this + 680LL))(
                     this,
                     gUSBConfigurationValue);
    v142 = v59;
    LODWORD(v60) = (*(int (__fastcall **)(IOUSBInterface *, __int64))(*(_QWORD *)this + 680LL))(
                     this,
                     gUSBInterfaceNumber);
    v138 = v60;
    LODWORD(v61) = (*(int (__fastcall **)(IOUSBInterface *, __int64))(*(_QWORD *)this + 680LL))(
                     this,
                     gUSBInterfaceSubClass);
    v150 = v61;
    LODWORD(v62) = (*(int (__fastcall **)(IOUSBInterface *, __int64))(*(_QWORD *)this + 680LL))(
                     this,
                     gUSBInterfaceProtocol);
    v131 = v62;
    LODWORD(v63) = (*(int (__fastcall **)(OSDictionary *, __int64))(*(_QWORD *)v4 + 504LL))(v4, gUSBVendorID);
    v125 = v63;
    LODWORD(v64) = (*(int (__fastcall **)(OSDictionary *, __int64))(*(_QWORD *)v4 + 504LL))(v4, gUSBProductID);
    v127 = v64;
    LODWORD(v65) = (*(int (__fastcall **)(OSDictionary *, __int64))(*(_QWORD *)v4 + 504LL))(v4, gUSBDeviceReleaseNumber);
    v117 = v65;
    LODWORD(v66) = (*(int (__fastcall **)(OSDictionary *, __int64))(*(_QWORD *)v4 + 504LL))(v4, gUSBConfigurationValue);
    v119 = v66;
    LODWORD(v67) = (*(int (__fastcall **)(OSDictionary *, __int64))(*(_QWORD *)v4 + 504LL))(v4, gUSBInterfaceNumber);
    v121 = v67;
    LODWORD(v68) = (*(int (__fastcall **)(OSDictionary *, __int64))(*(_QWORD *)v4 + 504LL))(v4, gUSBInterfaceClass);
    v123 = v68;
    LODWORD(v69) = (*(int (__fastcall **)(OSDictionary *, __int64))(*(_QWORD *)v4 + 504LL))(v4, gUSBInterfaceSubClass);
    v70 = v69;
    LODWORD(v71) = (*(int (__fastcall **)(OSDictionary *, __int64))(*(_QWORD *)v4 + 504LL))(v4, gUSBInterfaceProtocol);
    v72 = v71;
    v47 = gUSBProductIDMask;
    LODWORD(v73) = (*(int (__fastcall **)(OSDictionary *, __int64))(*(_QWORD *)v4 + 504LL))(v4, gUSBProductIDMask);
    v74 = v73;
    if ( !v129 || !v133 || !v144 || !v142 || !v138 || !v135 || !v150 || !v131 )
      goto LABEL_142;
    v110 = v70;
    v113 = v72;
    v115[0] = v20;
    __bzero(&v163, 256LL);
    v75 = 0;
    v76 = (_BYTE *)(&stru_B8 + 72);
    snprintf(&v164, 0x100uLL, "\tMatched: ");
    if ( v152 )
    {
      v77 = (*(int (__fastcall **)(__int64))(*(_QWORD *)v129 + 328LL))(v129);
      snprintf(&v163, 0x100uLL, "idVendor (%d) ", (unsigned int)v77);
      v76 = &v163;
      strlcat(&v164, &v163, 0x100uLL);
      v75 = 1;
    }
    if ( v161 == 0 || v145 == 0 )
    {
      if ( !v161 )
      {
LABEL_94:
        if ( v148 && v74 )
        {
          if ( v127 )
          {
            v80 = (*(int (**)(void))(*(_QWORD *)v127 + 328LL))();
          }
          else
          {
            if ( v161 == 0 || v145 == 0 )
              goto LABEL_102;
            v80 = v162;
          }
          v81 = (*(int (__fastcall **)(__int64))(*(_QWORD *)v74 + 328LL))(v74);
          snprintf(&v163, 0x100uLL, "to (%d) with mask (0x%x), ", v80, (unsigned int)v81);
          v76 = &v163;
          strlcat(&v164, &v163, 0x100uLL);
        }
LABEL_102:
        if ( v156 )
        {
          v82 = (*(int (__fastcall **)(__int64, char *))(*(_QWORD *)v144 + 328LL))(v144, v76);
          snprintf(&v163, 0x100uLL, "bcdDevice (%d) ", (unsigned int)v82);
          v76 = &v163;
          strlcat(&v164, &v163, 0x100uLL);
          v75 = 1;
        }
        if ( v155 )
        {
          v83 = (*(int (__fastcall **)(__int64, char *))(*(_QWORD *)v142 + 328LL))(v142, v76);
          snprintf(&v163, 0x100uLL, "bConfigurationValue (%d) ", (unsigned int)v83);
          v76 = &v163;
          strlcat(&v164, &v163, 0x100uLL);
          v75 = 1;
        }
        if ( v154 )
        {
          v84 = (*(int (__fastcall **)(__int64, char *))(*(_QWORD *)v138 + 328LL))(v138, v76);
          snprintf(&v163, 0x100uLL, "bInterfaceNumber (%d) ", (unsigned int)v84);
          v76 = &v163;
          strlcat(&v164, &v163, 0x100uLL);
          v75 = 1;
        }
        if ( v153 )
        {
          v85 = (*(int (__fastcall **)(__int64, char *))(*(_QWORD *)v135 + 328LL))(v135, v76);
          snprintf(&v163, 0x100uLL, "bInterfaceClass (%d) ", (unsigned int)v85);
          v76 = &v163;
          strlcat(&v164, &v163, 0x100uLL);
          v75 = 1;
        }
        if ( v158 )
        {
          v86 = (*(int (__fastcall **)(__int64, char *))(*(_QWORD *)v150 + 328LL))(v150, v76);
          snprintf(&v163, 0x100uLL, "bInterfaceSubClass (%d) ", (unsigned int)v86);
          v76 = &v163;
          strlcat(&v164, &v163, 0x100uLL);
          v75 = 1;
        }
        if ( v151 )
        {
          v87 = (*(int (__fastcall **)(__int64, char *))(*(_QWORD *)v131 + 328LL))(v131, v76);
          snprintf(&v163, 0x100uLL, "bInterfaceProtocol (%d) ", (unsigned int)v87);
          v88 = &v164;
          v89 = &v163;
        }
        else
        {
          if ( v75 )
          {
LABEL_117:
            v90 = 0;
            v47 = 256LL;
            snprintf(&v164, 0x100uLL, "\tDidn't Match: ");
            if ( v125 != 0 && v111 )
            {
              v91 = (*(int (**)(void))(*(_QWORD *)v125 + 328LL))();
              v92 = (*(int (__fastcall **)(__int64))(*(_QWORD *)v129 + 328LL))(v129);
              snprintf(&v163, 0x100uLL, "idVendor (%d,%d) ", (unsigned int)v91, (unsigned int)v92);
              v47 = (signed __int64)&v163;
              strlcat(&v164, &v163, 0x100uLL);
              v90 = 1;
            }
            if ( !v161 && v127 )
            {
              v93 = (*(int (**)(void))(*(_QWORD *)v127 + 328LL))();
              v94 = (*(int (**)(void))(*(_QWORD *)v133 + 328LL))();
              snprintf(&v163, 0x100uLL, "idProduct (%d,%d) ", (unsigned int)v93, (unsigned int)v94);
              v47 = (signed __int64)&v163;
              strlcat(&v164, &v163, 0x100uLL);
              v90 = 1;
            }
            if ( v117 && !v156 )
            {
              v95 = (*(int (**)(void))(*(_QWORD *)v117 + 328LL))();
              v96 = (*(int (**)(void))(*(_QWORD *)v144 + 328LL))();
              snprintf(&v163, 0x100uLL, "bcdDevice (%d,%d) ", (unsigned int)v95, (unsigned int)v96);
              v47 = (signed __int64)&v163;
              strlcat(&v164, &v163, 0x100uLL);
              v90 = 1;
            }
            if ( v119 && !v155 )
            {
              v97 = (*(int (**)(void))(*(_QWORD *)v119 + 328LL))();
              v98 = (*(int (**)(void))(*(_QWORD *)v142 + 328LL))();
              snprintf(&v163, 0x100uLL, "bConfigurationValue (%d,%d) ", (unsigned int)v97, (unsigned int)v98);
              v47 = (signed __int64)&v163;
              strlcat(&v164, &v163, 0x100uLL);
              v90 = 1;
            }
            if ( v121 && !v154 )
            {
              v99 = (*(int (**)(void))(*(_QWORD *)v121 + 328LL))();
              v100 = (*(int (**)(void))(*(_QWORD *)v138 + 328LL))();
              snprintf(&v163, 0x100uLL, "bInterfaceNumber (%d,%d) ", (unsigned int)v99, (unsigned int)v100);
              v47 = (signed __int64)&v163;
              strlcat(&v164, &v163, 0x100uLL);
              v90 = 1;
            }
            if ( v123 && !v153 )
            {
              v101 = (*(int (**)(void))(*(_QWORD *)v123 + 328LL))();
              v102 = (*(int (**)(void))(*(_QWORD *)v135 + 328LL))();
              snprintf(&v163, 0x100uLL, "bInterfaceClass (%d,%d) ", (unsigned int)v101, (unsigned int)v102);
              v47 = (signed __int64)&v163;
              strlcat(&v164, &v163, 0x100uLL);
              v90 = 1;
            }
            if ( v110 && !v158 )
            {
              v103 = (*(int (**)(void))(*(_QWORD *)v110 + 328LL))();
              v104 = (*(int (**)(void))(*(_QWORD *)v150 + 328LL))();
              snprintf(&v163, 0x100uLL, "bInterfaceSubClass (%d,%d) ", (unsigned int)v103, (unsigned int)v104);
              v47 = (signed __int64)&v163;
              strlcat(&v164, &v163, 0x100uLL);
              v90 = 1;
            }
            if ( !v113 || v151 )
            {
              v20 = v115[0];
              if ( !v90 )
              {
                v47 = (signed __int64)"nothing";
                strlcat(&v164, "nothing", 0x100uLL);
              }
            }
            else
            {
              v105 = (*(int (**)(void))(*(_QWORD *)v113 + 328LL))();
              v106 = (*(int (**)(void))(*(_QWORD *)v131 + 328LL))();
              snprintf(&v163, 0x100uLL, "bDeviceProtocol (%d,%d) ", (unsigned int)v105, (unsigned int)v106);
              v47 = (signed __int64)&v163;
              strlcat(&v164, &v163, 0x100uLL);
              v20 = v115[0];
            }
LABEL_142:
            if ( v140 )
              (*(void (__fastcall **)(OSMetaClassBase *, signed __int64))(*(_QWORD *)v140 + 40LL))(v140, v47);
            goto LABEL_144;
          }
          v89 = "no properties";
          v88 = &v164;
        }
        strlcat(v88, v89, 0x100uLL);
        goto LABEL_117;
      }
      v78 = (unsigned int)(*(int (**)(void))(*(_QWORD *)v133 + 328LL))();
      v79 = "idProduct (%d) ";
    }
    else
    {
      v78 = v162;
      v79 = "idProduct in array (%d) ";
    }
    snprintf(&v163, 0x100uLL, v79, v78);
    v76 = &v163;
    strlcat(&v164, &v163, 0x100uLL);
    v75 = 1;
    goto LABEL_94;
  }
  v20 = 0;
LABEL_144:
  v5 = off_3B0E0[0];
LABEL_145:
  v107 = *(_QWORD *)v5;
  if ( *(_QWORD *)v5 == v165 )
    LOBYTE(v107) = v20;
  return v107;
}
// B8: using guessed type section_64 stru_B8;
// 3B070: using guessed type _QWORD off_3B070[20];
// 3B078: using guessed type _QWORD off_3B078[19];
// 3B088: using guessed type _QWORD off_3B088[17];
// 3B0E0: using guessed type __int64 off_3B0E0[6];
// 3D260: using guessed type __int64 `vtable for'IOUSBNub[2];
// 49170: using guessed type int gKernelDebugLevel;
// 495D8: using guessed type __int64 gUSBVendorID;
// 495E0: using guessed type __int64 gUSBProductID;
// 495E8: using guessed type __int64 gUSBInterfaceNumber;
// 495F0: using guessed type __int64 gUSBConfigurationValue;
// 495F8: using guessed type __int64 gUSBDeviceReleaseNumber;
// 49600: using guessed type __int64 gUSBInterfaceClass;
// 49608: using guessed type __int64 gUSBInterfaceSubClass;
// 49610: using guessed type __int64 gUSBInterfaceProtocol;
// 49618: using guessed type __int64 gUSBProductIDMask;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);
// 7E138: using guessed type int __fastcall __bzero(_QWORD, _QWORD);

//----- (000000000000E952) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::GetPipeObj(IOUSBInterface *this, unsigned __int8 a2)
{
  __int64 v2; // rax@1
  __int64 v3; // r14@2
  __int64 v4; // r15@3
  __int64 v6; // [sp+8h] [bp-28h]@1

  v6 = 0LL;
  (*(void (**)(void))(*(_QWORD *)this + 32LL))();
  v2 = *((_QWORD *)this + 53);
  if ( v2 )
  {
    v3 = *(_QWORD *)v2;
    if ( *(_QWORD *)v2 )
    {
      v4 = *(_QWORD *)(v2 + 8);
      if ( v4 )
      {
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v4 + 32LL))(v4);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 32LL))(v3);
        (*(void (__fastcall **)(__int64, __int64 (__fastcall *)(IOUSBInterface *__hidden, OSObject *, void *, void *, void *, void *), _QWORD, __int64 *, _QWORD, _QWORD))(*(_QWORD *)v3 + 456LL))(
          v3,
          IOUSBInterface::_GetPipeObj,
          a2,
          &v6,
          0LL,
          0LL);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 40LL))(v3);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v4 + 40LL))(v4);
      }
    }
  }
  (*(void (__fastcall **)(IOUSBInterface *))(*(_QWORD *)this + 40LL))(this);
  return v6;
}

//----- (000000000000E9F2) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::_GetPipeObj(IOUSBInterface *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  void *v6; // r14@1
  IOService *v7; // rax@1
  IOService *v8; // rbx@1
  char v9; // al@2
  signed int v10; // ecx@2
  bool v11; // zf@3
  __int64 v12; // rax@3
  __int64 result; // rax@8

  v6 = a3;
  v7 = (IOService *)OSMetaClassBase::safeMetaCast(
                      this,
                      (const OSMetaClassBase *)&IOUSBInterface::gMetaClass,
                      (const OSMetaClass *)a3);
  v8 = v7;
  if ( v7 )
  {
    v9 = IOService::isInactive(v7);
    v10 = 0;
    if ( (unsigned __int8)a2 > 0x1Fu )
    {
      v12 = 0LL;
    }
    else
    {
      v11 = v9 == 1;
      v12 = 0LL;
      if ( !v11 )
        v12 = *((_QWORD *)v8 + (unsigned __int8)a2 + 17);
    }
    *(_QWORD *)v6 = v12;
  }
  else
  {
    v12 = *(_QWORD *)v6;
    v10 = -536870206;
  }
  v11 = v12 == 0;
  result = 3758097090LL;
  if ( !v11 )
    result = (unsigned int)v10;
  return result;
}
// 495B0: using guessed type _QWORD IOUSBInterface::gMetaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000000EA66) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::GetPipeObjGated(IOUSBInterface *this, unsigned int a2)
{
  unsigned __int8 v2; // cl@1
  __int64 result; // rax@1

  v2 = IOService::isInactive(this);
  result = 0LL;
  if ( a2 <= 0x1F )
  {
    if ( v2 ^ 1 )
      result = *((_QWORD *)this + (unsigned __int8)a2 + 17);
  }
  return result;
}

//----- (000000000000EA96) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::GetConfigValue(IOUSBInterface *this)
{
  return *(_BYTE *)(*((_QWORD *)this + 49) + 5LL);
}

//----- (000000000000EAA8) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::GetDevice(IOUSBInterface *this)
{
  return *((_QWORD *)this + 51);
}

//----- (000000000000EAB6) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::GetInterfaceNumber(IOUSBInterface *this)
{
  return *((_BYTE *)this + 416);
}

//----- (000000000000EAC4) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::GetAlternateSetting(IOUSBInterface *this)
{
  return *((_BYTE *)this + 417);
}

//----- (000000000000EAD2) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::GetNumEndpoints(IOUSBInterface *this)
{
  return *((_BYTE *)this + 418);
}

//----- (000000000000EAE0) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::GetInterfaceClass(IOUSBInterface *this)
{
  return *((_BYTE *)this + 419);
}

//----- (000000000000EAEE) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::GetInterfaceSubClass(IOUSBInterface *this)
{
  return *((_BYTE *)this + 420);
}

//----- (000000000000EAFC) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::GetInterfaceProtocol(IOUSBInterface *this)
{
  return *((_BYTE *)this + 421);
}

//----- (000000000000EB0A) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::GetInterfaceStringIndex(IOUSBInterface *this)
{
  return *((_BYTE *)this + 422);
}

//----- (000000000000EB18) ----------------------------------------------------
int __fastcall IOUSBInterface::DeviceRequest(__int64 a1)
{
  return (*(int (**)(void))(**(_QWORD **)(a1 + 408) + 2360LL))();
}

//----- (000000000000EB30) ----------------------------------------------------
int __fastcall IOUSBInterface::DeviceRequest(__int64 a1)
{
  return (*(int (**)(void))(**(_QWORD **)(a1 + 408) + 2368LL))();
}

//----- (000000000000EB48) ----------------------------------------------------
int __fastcall IOUSBInterface::GetEndpointProperties(IOUSBInterface *this, char a2, char a3, char a4, unsigned __int8 *a5, unsigned __int16 *a6, unsigned __int8 *a7)
{
  unsigned __int16 *v7; // r14@1
  unsigned __int8 *v8; // r15@1
  int result; // eax@1
  char v10; // cl@2
  __int64 v11; // rdx@2
  char v12; // [sp+8h] [bp-28h]@1
  char v13; // [sp+9h] [bp-27h]@1
  char v14; // [sp+Ah] [bp-26h]@1
  char v15; // [sp+Bh] [bp-25h]@1
  char v16; // [sp+Ch] [bp-24h]@2
  unsigned __int8 v17; // [sp+Fh] [bp-21h]@2
  unsigned __int16 v18; // [sp+10h] [bp-20h]@5
  unsigned __int8 v19; // [sp+14h] [bp-1Ch]@5

  v7 = a6;
  v8 = a5;
  v12 = 3;
  v13 = a2;
  v14 = a4;
  v15 = a3;
  result = (*(int (__fastcall **)(IOUSBInterface *, char *))(*(_QWORD *)this + 2344LL))(this, &v12);
  if ( !result )
  {
    *a7 = v17;
    v10 = v16;
    *v8 = v16;
    v11 = *((_QWORD *)this + 51);
    if ( v11 && *(_BYTE *)(v11 + 184) == 2 && v10 == 1 )
      *v7 = v18 * (v19 + 1);
    else
      *v7 = v18;
  }
  return result;
}

//----- (000000000000EBD0) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::RememberStreams(IOUSBInterface *this)
{
  __int64 v1; // rax@2
  __int64 v2; // r14@3
  __int64 v3; // r15@4
  int v4; // er12@5
  __int64 result; // rax@5

  if ( !(unsigned __int8)IOService::isInactive(this)
    && (v1 = *((_QWORD *)this + 53)) != 0
    && (v2 = *(_QWORD *)v1) != 0
    && (v3 = *(_QWORD *)(v1 + 8)) != 0 )
  {
    (*(void (**)(void))(*(_QWORD *)this + 32LL))();
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 32LL))(v3);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 32LL))(v2);
    v4 = (*(int (__fastcall **)(__int64, __int64 (__fastcall *)(IOUSBInterface *__hidden, OSObject *, void *, void *, void *, void *), _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v2 + 456LL))(
           v2,
           IOUSBInterface::_RememberStreams,
           0LL,
           0LL,
           0LL,
           0LL);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 40LL))(v2);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 40LL))(v3);
    (*(void (__fastcall **)(IOUSBInterface *))(*(_QWORD *)this + 40LL))(this);
    result = (unsigned int)v4;
  }
  else
  {
    result = 0LL;
  }
  return result;
}

//----- (000000000000EC6A) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::_RememberStreams(IOUSBInterface *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  IOUSBInterface *v6; // rax@1
  const OSMetaClass *v7; // rdx@1
  signed int v8; // ecx@1

  v6 = (IOUSBInterface *)OSMetaClassBase::safeMetaCast(
                           this,
                           (const OSMetaClassBase *)&IOUSBInterface::gMetaClass,
                           (const OSMetaClass *)a3);
  v8 = -536870206;
  if ( v6 )
  {
    IOUSBInterface::RememberStreamsGated(v6, (__int64)&IOUSBInterface::gMetaClass, v7);
    v8 = 0;
  }
  return (unsigned int)v8;
}
// 495B0: using guessed type _QWORD IOUSBInterface::gMetaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000000EC92) ----------------------------------------------------
int __fastcall IOUSBInterface::RememberStreamsGated(IOUSBInterface *this, __int64 a2, const OSMetaClass *a3)
{
  __int64 v3; // rbx@1
  __int64 v4; // rax@2

  v3 = 0LL;
  do
  {
    v4 = OSMetaClassBase::safeMetaCast(
           *((OSMetaClassBase **)this + v3 + 17),
           (const OSMetaClassBase *)IOUSBPipeV2::metaClass,
           a3);
    if ( v4 )
    {
      LODWORD(v4) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v4 + 640LL))(v4, IOUSBPipeV2::metaClass);
      *(_DWORD *)(*((_QWORD *)this + 53) + 4 * v3 + 40) = v4;
    }
    ++v3;
  }
  while ( v3 != 32 );
  return v4;
}
// 474A0: using guessed type _QWORD IOUSBPipeV2::metaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000000ECEC) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::RecreateStreams(IOUSBInterface *this)
{
  __int64 v1; // rax@2
  __int64 v2; // r14@3
  __int64 v3; // r15@4
  int v4; // er12@5
  __int64 result; // rax@5

  if ( !(unsigned __int8)IOService::isInactive(this)
    && (v1 = *((_QWORD *)this + 53)) != 0
    && (v2 = *(_QWORD *)v1) != 0
    && (v3 = *(_QWORD *)(v1 + 8)) != 0 )
  {
    (*(void (**)(void))(*(_QWORD *)this + 32LL))();
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 32LL))(v3);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 32LL))(v2);
    v4 = (*(int (__fastcall **)(__int64, int (__fastcall *)(IOUSBInterface *, OSObject *, void *, void *, void *, void *), _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v2 + 456LL))(
           v2,
           IOUSBInterface::_RecreateStreams,
           0LL,
           0LL,
           0LL,
           0LL);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 40LL))(v2);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 40LL))(v3);
    (*(void (__fastcall **)(IOUSBInterface *))(*(_QWORD *)this + 40LL))(this);
    result = (unsigned int)v4;
  }
  else
  {
    result = 0LL;
  }
  return result;
}

//----- (000000000000ED86) ----------------------------------------------------
int __fastcall IOUSBInterface::_RecreateStreams(IOUSBInterface *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  IOUSBInterface *v6; // rax@1
  const OSMetaClass *v7; // rdx@1
  int result; // eax@2

  v6 = (IOUSBInterface *)OSMetaClassBase::safeMetaCast(
                           this,
                           (const OSMetaClassBase *)&IOUSBInterface::gMetaClass,
                           (const OSMetaClass *)a3);
  if ( v6 )
    result = IOUSBInterface::RecreateStreamsGated(v6, (__int64)&IOUSBInterface::gMetaClass, v7);
  else
    result = -536870206;
  return result;
}
// 495B0: using guessed type _QWORD IOUSBInterface::gMetaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000000EDAC) ----------------------------------------------------
int __fastcall IOUSBInterface::RecreateStreamsGated(IOUSBInterface *this, __int64 a2, const OSMetaClass *a3)
{
  __int64 v3; // rcx@1
  __int64 v4; // rbx@1
  __int64 v5; // rax@3
  int result; // eax@4

  v3 = *((_QWORD *)this + 53);
  v4 = 0LL;
  while ( !*(_DWORD *)(v3 + 4 * v4 + 40) )
  {
LABEL_6:
    ++v4;
    result = 0;
    if ( (unsigned int)v4 >= 0x20 )
      return result;
  }
  v5 = OSMetaClassBase::safeMetaCast(
         *((OSMetaClassBase **)this + v4 + 17),
         (const OSMetaClassBase *)IOUSBPipeV2::metaClass,
         a3);
  if ( !v5
    || (result = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v5 + 624LL))(
                   v5,
                   *(_DWORD *)(*((_QWORD *)this + 53) + 4 * v4 + 40))) == 0 )
  {
    v3 = *((_QWORD *)this + 53);
    *(_DWORD *)(v3 + 4 * v4 + 40) = 0;
    goto LABEL_6;
  }
  return result;
}
// 474A0: using guessed type _QWORD IOUSBPipeV2::metaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000000EE28) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::CalculateFullMaxPacketSize(__int64 a1, __int64 a2, __int64 a3)
{
  __int16 v3; // di@2
  char v4; // r8@2
  unsigned __int8 v5; // cl@3
  signed __int16 v6; // cx@4
  signed __int16 v7; // ax@4
  unsigned __int8 v8; // si@6
  unsigned int v9; // edx@12
  unsigned int v10; // eax@12
  signed __int16 v11; // cx@12
  bool v12; // cf@12
  bool v13; // zf@12
  signed __int16 v14; // si@14

  if ( a2 )
  {
    v3 = *(_WORD *)(a2 + 4) & 0x7FF;
    v4 = *(_BYTE *)(a2 + 3) & 3;
    if ( (unsigned __int8)(v4 | 2) == 3 )
      v5 = ((unsigned int)*(_WORD *)(a2 + 4) >> 11) & 3;
    else
      v5 = 0;
    v8 = 0;
    if ( a3 )
    {
      if ( v4 )
      {
        if ( v4 == 1 )
          v8 = *(_BYTE *)(a3 + 3) & 3;
        v5 = v8;
        v8 = *(_BYTE *)(a3 + 2);
      }
      else
      {
        v5 = 0;
      }
    }
    v9 = v8;
    v10 = v5;
    v11 = v5 + 1;
    v12 = v10 < 2;
    v13 = v10 == 2;
    v7 = 3;
    if ( v12 || v13 )
      v7 = v11;
    v14 = v8 + 1;
    v6 = 16;
    if ( v9 <= 0xF )
      v6 = v14;
  }
  else
  {
    v6 = 1;
    v3 = 0;
    v7 = 1;
  }
  return (unsigned __int16)(v6 * v7 * v3);
}

//----- (000000000000EEBE) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::GetEndpointPropertiesV3(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  unsigned int v3; // er12@1
  __int64 v4; // rdi@1
  signed int v5; // er13@3
  __int64 v6; // rax@4
  __int64 v7; // r15@4
  __int64 v8; // rax@14
  char v9; // dl@14
  __int64 v10; // r13@19
  __int64 v11; // rax@20
  __int64 v12; // rax@23
  __int64 v13; // rax@26
  char v14; // cl@31
  signed __int16 v15; // ax@31
  __int64 v16; // rax@32
  unsigned __int8 v17; // al@36
  __int64 v18; // rax@41
  signed int v20; // [sp+0h] [bp-30h]@17
  char v21; // [sp+0h] [bp-30h]@26
  unsigned int v22; // [sp+4h] [bp-2Ch]@1

  v2 = a1;
  LOBYTE(v3) = *(_BYTE *)(a2 + 3) | ((*(_BYTE *)(a2 + 2) == 1) << 7);
  v4 = *(_QWORD *)(a1 + 408);
  v22 = 0;
  if ( v4 )
    v22 = *(_WORD *)(v4 + 162);
  v5 = -536870206;
  if ( *(_BYTE *)a2 == 3 )
  {
    LODWORD(v6) = (*(int (__fastcall **)(__int64, _QWORD, signed __int64))(*(_QWORD *)v4 + 2408LL))(
                    v4,
                    *(_QWORD *)(v2 + 392),
                    4LL);
    v7 = v6;
    v5 = -536854441;
    if ( v6 )
    {
      v3 = (unsigned __int8)v3;
      v5 = -536854441;
      while ( 2 )
      {
        v20 = v5;
        while ( 1 )
        {
          if ( *(_BYTE *)(v7 + 2) == *(_BYTE *)(v2 + 416) )
          {
            v10 = v7;
            if ( *(_BYTE *)(v7 + 3) == *(_BYTE *)(a2 + 1) )
              break;
          }
LABEL_23:
          LODWORD(v12) = (*(int (__fastcall **)(_QWORD, __int64, signed __int64))(**(_QWORD **)(v2 + 408) + 2408LL))(
                           *(_QWORD *)(v2 + 408),
                           v7,
                           4LL);
          v7 = v12;
          if ( !v12 )
          {
            v5 = v20;
            return (unsigned int)v5;
          }
        }
        do
        {
          LODWORD(v11) = (*(int (__fastcall **)(__int64, __int64, signed __int64))(*(_QWORD *)v2 + 2184LL))(
                           v2,
                           v10,
                           5LL);
          v10 = v11;
          if ( !v11 )
            goto LABEL_23;
        }
        while ( *(_BYTE *)(v11 + 2) != v3 );
        v9 = *(_BYTE *)(v11 + 3) & 3;
        if ( v22 < 0x300 )
        {
          if ( (unsigned __int8)(v9 | 2) == 3 )
          {
            v14 = ((unsigned int)*(_WORD *)(v11 + 4) >> 11) & 3;
            v15 = ((*(_WORD *)(v11 + 4) >> 11) & 3) + 1;
          }
          else
          {
            v15 = 1;
            v14 = 0;
          }
          *(_BYTE *)(a2 + 12) = v14;
          *(_BYTE *)(a2 + 10) = 0;
          *(_BYTE *)(a2 + 5) = 0;
          *(_BYTE *)(a2 + 11) = 0;
          *(_WORD *)(a2 + 13) = *(_WORD *)(a2 + 8) * v15;
LABEL_35:
          *(_BYTE *)(a2 + 4) = v9;
          *(_WORD *)(a2 + 8) = *(_WORD *)(v10 + 4) & 0x7FF;
          *(_BYTE *)(a2 + 7) = *(_BYTE *)(v10 + 6);
          if ( v9 == 3 )
          {
            *(_BYTE *)(a2 + 6) = 0;
            v17 = *(_BYTE *)(v10 + 3);
          }
          else
          {
            if ( v9 != 1 )
            {
              *(_BYTE *)(a2 + 6) = 0;
              *(_WORD *)(a2 + 13) = 0;
              v5 = 0;
LABEL_41:
              LODWORD(v18) = (*(int (__fastcall **)(_QWORD, __int64, signed __int64))(**(_QWORD **)(v2 + 408) + 2408LL))(
                               *(_QWORD *)(v2 + 408),
                               v7,
                               4LL);
              v7 = v18;
              if ( v18 )
                continue;
              return (unsigned int)v5;
            }
            v17 = *(_BYTE *)(v10 + 3);
            *(_BYTE *)(a2 + 6) = (*(_BYTE *)(v10 + 3) >> 2) & 3;
          }
          *(_BYTE *)(a2 + 5) = (v17 >> 4) & 3;
          v5 = 0;
          goto LABEL_41;
        }
        break;
      }
      v21 = *(_BYTE *)(v11 + 3) & 3;
      LODWORD(v13) = (*(int (__fastcall **)(__int64, __int64, _QWORD))(*(_QWORD *)v2 + 2184LL))(v2, v11, 0LL);
      if ( !v13 || *(_BYTE *)(v13 + 1) != 48 )
      {
        LODWORD(v16) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v2 + 904LL))(v2, 0LL);
        KernelDebugLogInternal(
          1u,
          0x55534246u,
          (__int64)"%s::GetEndpointPropertiesV3(alt:%d, ep=0x%x) - missing SSCD",
          v16,
          *(_BYTE *)(a2 + 1),
          v3,
          v21);
        v5 = -536854461;
        goto LABEL_41;
      }
      *(_BYTE *)(a2 + 5) = 0;
      *(_BYTE *)(a2 + 10) = *(_BYTE *)(v13 + 2);
      v9 = v21;
      if ( v21 == 1 )
      {
        *(_BYTE *)(a2 + 11) = 0;
        *(_BYTE *)(a2 + 12) = *(_BYTE *)(v13 + 3) & 3;
        goto LABEL_9;
      }
      if ( v21 == 2 )
      {
        *(_BYTE *)(a2 + 11) = *(_BYTE *)(v13 + 3) & 0x1F;
        *(_BYTE *)(a2 + 12) = 0;
      }
      else
      {
        *(_WORD *)(a2 + 11) = 0;
        if ( v21 == 3 )
        {
LABEL_9:
          *(_WORD *)(a2 + 13) = *(_WORD *)(v13 + 4);
LABEL_11:
          if ( *(_BYTE *)(v2 + 419) == 8 && *(_BYTE *)(v2 + 420) == 6 && *(_BYTE *)(v2 + 421) == 98 )
          {
            LODWORD(v8) = (*(int (__fastcall **)(__int64, __int64, _QWORD))(*(_QWORD *)v2 + 2184LL))(v2, v13, 0LL);
            v9 = v21;
            if ( v8 )
            {
              if ( *(_BYTE *)(v8 + 1) == 36 )
                *(_BYTE *)(a2 + 5) = *(_BYTE *)(v8 + 2);
            }
          }
          goto LABEL_35;
        }
      }
      *(_WORD *)(a2 + 13) = 0;
      goto LABEL_11;
    }
  }
  return (unsigned int)v5;
}

//----- (000000000000F1D8) ----------------------------------------------------
int __fastcall IOUSBInterface::GetInterfaceStatus(IOUSBInterface *this, unsigned __int16 *a2)
{
  char v3; // [sp+8h] [bp-18h]@1
  char v4; // [sp+9h] [bp-17h]@1
  __int16 v5; // [sp+Ah] [bp-16h]@1
  __int16 v6; // [sp+Ch] [bp-14h]@1
  __int16 v7; // [sp+Eh] [bp-12h]@1
  unsigned __int16 *v8; // [sp+10h] [bp-10h]@1

  v3 = -127;
  v4 = 0;
  v5 = 0;
  v6 = *((_BYTE *)this + 416);
  v7 = 2;
  v8 = a2;
  return (*(int (__fastcall **)(_QWORD, char *, _QWORD))(**((_QWORD **)this + 51) + 2360LL))(
           *((_QWORD *)this + 51),
           &v3,
           0LL);
}

//----- (000000000000F220) ----------------------------------------------------
int __fastcall IOUSBInterface::SetFunctionSuspendFeature(IOUSBInterface *this, __int16 a2)
{
  char v3; // [sp+8h] [bp-18h]@1
  char v4; // [sp+9h] [bp-17h]@1
  __int16 v5; // [sp+Ah] [bp-16h]@1
  __int16 v6; // [sp+Ch] [bp-14h]@1
  __int16 v7; // [sp+Eh] [bp-12h]@1
  __int64 v8; // [sp+10h] [bp-10h]@1

  v3 = 1;
  v4 = 3;
  v5 = 0;
  v6 = (a2 << 8) | *((_BYTE *)this + 416);
  v7 = 0;
  v8 = 0LL;
  return (*(int (__fastcall **)(_QWORD, char *, _QWORD))(**((_QWORD **)this + 51) + 2360LL))(
           *((_QWORD *)this + 51),
           &v3,
           0LL);
}

//----- (000000000000F270) ----------------------------------------------------
__int64 __usercall IOUSBInterface::EnableRemoteWake@<rax>(IOUSBInterface *this@<rdi>, __int64 a2@<rax>, unsigned __int8 a3@<sil>)
{
  IOUSBInterface *v3; // r15@1
  IOUSBDevice *v4; // rdi@1
  int v5; // ebx@1
  __int64 v7; // [sp-6h] [bp-20h]@1

  v7 = a2;
  v3 = this;
  v4 = (IOUSBDevice *)*((_QWORD *)this + 51);
  v5 = -536870201;
  if ( v4 )
  {
    if ( (unsigned __int16)IOUSBDevice::GetbcdUSB(v4) >= 0x300u )
    {
      WORD3(v7) = 0;
      v5 = (*(int (__fastcall **)(IOUSBInterface *, char *))(*(_QWORD *)v3 + 2352LL))(v3, (char *)&v7 + 6);
      if ( !v5 )
      {
        v5 = 0;
        if ( BYTE6(v7) & 1 )
        {
          v5 = (*(int (__fastcall **)(IOUSBInterface *, _QWORD))(*(_QWORD *)v3 + 2360LL))(v3, 2 * (unsigned int)a3);
          if ( !v5 )
            v5 = (*(int (__fastcall **)(IOUSBInterface *, char *))(*(_QWORD *)v3 + 2352LL))(v3, (char *)&v7 + 6);
        }
      }
    }
  }
  return (unsigned int)v5;
}

//----- (000000000000F2FC) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::_RESERVEDIOUSBInterface10(IOUSBInterface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBInterface::gMetaClass, 10);
}
// 495B0: using guessed type _QWORD IOUSBInterface::gMetaClass;

//----- (000000000000F312) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::_RESERVEDIOUSBInterface11(IOUSBInterface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBInterface::gMetaClass, 11);
}
// 495B0: using guessed type _QWORD IOUSBInterface::gMetaClass;

//----- (000000000000F328) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::_RESERVEDIOUSBInterface12(IOUSBInterface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBInterface::gMetaClass, 12);
}
// 495B0: using guessed type _QWORD IOUSBInterface::gMetaClass;

//----- (000000000000F33E) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::_RESERVEDIOUSBInterface13(IOUSBInterface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBInterface::gMetaClass, 13);
}
// 495B0: using guessed type _QWORD IOUSBInterface::gMetaClass;

//----- (000000000000F354) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::_RESERVEDIOUSBInterface14(IOUSBInterface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBInterface::gMetaClass, 14);
}
// 495B0: using guessed type _QWORD IOUSBInterface::gMetaClass;

//----- (000000000000F36A) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::_RESERVEDIOUSBInterface15(IOUSBInterface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBInterface::gMetaClass, 15);
}
// 495B0: using guessed type _QWORD IOUSBInterface::gMetaClass;

//----- (000000000000F380) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::_RESERVEDIOUSBInterface16(IOUSBInterface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBInterface::gMetaClass, 16);
}
// 495B0: using guessed type _QWORD IOUSBInterface::gMetaClass;

//----- (000000000000F396) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::_RESERVEDIOUSBInterface17(IOUSBInterface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBInterface::gMetaClass, 17);
}
// 495B0: using guessed type _QWORD IOUSBInterface::gMetaClass;

//----- (000000000000F3AC) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::_RESERVEDIOUSBInterface18(IOUSBInterface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBInterface::gMetaClass, 18);
}
// 495B0: using guessed type _QWORD IOUSBInterface::gMetaClass;

//----- (000000000000F3C2) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::_RESERVEDIOUSBInterface19(IOUSBInterface *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBInterface::gMetaClass, 19);
}
// 495B0: using guessed type _QWORD IOUSBInterface::gMetaClass;

//----- (000000000000F3D8) ----------------------------------------------------
__int64 __fastcall IOUSBInterface::MetaClass::~MetaClass(IOUSBInterface::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000000F3F0) ----------------------------------------------------
__int64 `global constructor keyed to'_a_1()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(&IOUSBInterface::gMetaClass, "IOUSBInterface", &IOUSBNub::gMetaClass, 432LL);
  result = (__int64)off_3D170;
  IOUSBInterface::gMetaClass = off_3D170;
  return result;
}
// 3D170: using guessed type __int64 (__fastcall *off_3D170[2])(IOUSBInterface::MetaClass *__hidden this);
// 495B0: using guessed type _QWORD IOUSBInterface::gMetaClass;
// 49638: using guessed type _QWORD IOUSBNub::gMetaClass;
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000000F430) ----------------------------------------------------
__int64 `global destructor keyed to'_a_1()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&IOUSBInterface::gMetaClass);
}
// 495B0: using guessed type _QWORD IOUSBInterface::gMetaClass;

//----- (000000000000F450) ----------------------------------------------------
__int64 __fastcall IOUSBNub::MetaClass::MetaClass(IOUSBNub::MetaClass *this)
{
  OSMetaClass::OSMetaClass(this, "IOUSBNub", off_3B098[0], 136LL);
  *(_QWORD *)this = off_3DAE0;
  return IOUSBNub::initialize(this, "IOUSBNub");
}
// 3B098: using guessed type _QWORD off_3B098[15];
// 3DAE0: using guessed type __int64 (__fastcall *off_3DAE0[2])(IOUSBNub::MetaClass *__hidden this);
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000000F486) ----------------------------------------------------
__int64 __fastcall IOUSBNub::MetaClass::~MetaClass(IOUSBNub::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000000F490) ----------------------------------------------------
__int64 __fastcall IOUSBNub::IOUSBNub(__int64 a1)
{
  __int64 result; // rax@1

  IOService::IOService(a1);
  result = (__int64)off_3D270;
  *(_QWORD *)a1 = off_3D270;
  return result;
}
// 3D270: using guessed type __int64 (__fastcall *off_3D270[2])(IOUSBNub *__hidden this);
// 7DEA0: using guessed type int __cdecl IOService::IOService(_QWORD);

//----- (000000000000F4B0) ----------------------------------------------------
__int64 __fastcall IOUSBNub::IOUSBNub(__int64 a1)
{
  __int64 result; // rax@1

  IOService::IOService(a1);
  result = (__int64)off_3D270;
  *(_QWORD *)a1 = off_3D270;
  return result;
}
// 3D270: using guessed type __int64 (__fastcall *off_3D270[2])(IOUSBNub *__hidden this);
// 7DEA0: using guessed type int __cdecl IOService::IOService(_QWORD);

//----- (000000000000F4D0) ----------------------------------------------------
__int64 __fastcall IOUSBNub::~IOUSBNub(IOUSBNub *this)
{
  return IOService::~IOService(this);
}

//----- (000000000000F4DA) ----------------------------------------------------
__int64 __fastcall IOUSBNub::~IOUSBNub(IOUSBNub *this)
{
  return IOService::~IOService(this);
}

//----- (000000000000F4E4) ----------------------------------------------------
void __fastcall IOUSBNub::~IOUSBNub(IOUSBNub *this)
{
  IOService::~IOService(this);
  OSObject::operator delete((void *)this);
}

//----- (000000000000F506) ----------------------------------------------------
__int64 __fastcall IOUSBNub::getMetaClass(IOUSBNub *this)
{
  return (__int64)&IOUSBNub::gMetaClass;
}
// 49638: using guessed type _QWORD IOUSBNub::gMetaClass;

//----- (000000000000F514) ----------------------------------------------------
__int64 __fastcall IOUSBNub::MetaClass::MetaClass(IOUSBNub::MetaClass *this)
{
  OSMetaClass::OSMetaClass(this, "IOUSBNub", off_3B098[0], 136LL);
  *(_QWORD *)this = off_3DAE0;
  return IOUSBNub::initialize(this, "IOUSBNub");
}
// 3B098: using guessed type _QWORD off_3B098[15];
// 3DAE0: using guessed type __int64 (__fastcall *off_3DAE0[2])(IOUSBNub::MetaClass *__hidden this);
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000000F54A) ----------------------------------------------------
__int64 __fastcall IOUSBNub::initialize(IOUSBNub *this, const char *a2)
{
  __int64 result; // rax@1

  gUSBVendorID = OSSymbol::withCString("idVendor", a2);
  gUSBProductID = OSSymbol::withCString("idProduct", a2);
  gUSBInterfaceNumber = OSSymbol::withCString("bInterfaceNumber", a2);
  gUSBConfigurationValue = OSSymbol::withCString("bConfigurationValue", a2);
  gUSBDeviceReleaseNumber = OSSymbol::withCString("bcdDevice", a2);
  gUSBInterfaceClass = OSSymbol::withCString("bInterfaceClass", a2);
  gUSBInterfaceSubClass = OSSymbol::withCString("bInterfaceSubClass", a2);
  gUSBInterfaceProtocol = OSSymbol::withCString("bInterfaceProtocol", a2);
  gUSBProductIDMask = OSSymbol::withCString("idProductMask", a2);
  gUSBDeviceClass = OSSymbol::withCString("bDeviceClass", a2);
  gUSBDeviceSubClass = OSSymbol::withCString("bDeviceSubClass", a2);
  result = OSSymbol::withCString("bDeviceProtocol", a2);
  gUSBDeviceProtocol = result;
  return result;
}
// 495D8: using guessed type __int64 gUSBVendorID;
// 495E0: using guessed type __int64 gUSBProductID;
// 495E8: using guessed type __int64 gUSBInterfaceNumber;
// 495F0: using guessed type __int64 gUSBConfigurationValue;
// 495F8: using guessed type __int64 gUSBDeviceReleaseNumber;
// 49600: using guessed type __int64 gUSBInterfaceClass;
// 49608: using guessed type __int64 gUSBInterfaceSubClass;
// 49610: using guessed type __int64 gUSBInterfaceProtocol;
// 49618: using guessed type __int64 gUSBProductIDMask;
// 49620: using guessed type __int64 gUSBDeviceClass;
// 49628: using guessed type __int64 gUSBDeviceSubClass;
// 49630: using guessed type __int64 gUSBDeviceProtocol;

//----- (000000000000F634) ----------------------------------------------------
__int64 __fastcall IOUSBNub::MetaClass::alloc(IOUSBNub::MetaClass *this)
{
  return 0LL;
}

//----- (000000000000F63C) ----------------------------------------------------
char __fastcall IOUSBNub::USBCompareProperty(IOUSBNub *this, OSDictionary *a2, const OSSymbol *a3)
{
  const OSSymbol *v3; // r14@1
  __int64 v4; // rax@1
  __int64 v5; // rbx@1
  __int64 v6; // rax@2
  __int64 v7; // r14@2
  char v8; // bl@3

  v3 = a3;
  LODWORD(v4) = (*(int (__fastcall **)(OSDictionary *, const OSSymbol *))(*(_QWORD *)a2 + 504LL))(a2, a3);
  v5 = v4;
  if ( v4
    && (LODWORD(v6) = (*(int (__fastcall **)(IOUSBNub *, const OSSymbol *))(*(_QWORD *)this + 728LL))(this, v3),
        (v7 = v6) != 0) )
  {
    v8 = (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v5 + 64LL))(v5, v6);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v7 + 40LL))(v7);
  }
  else
  {
    v8 = 0;
  }
  return v8;
}

//----- (000000000000F6A2) ----------------------------------------------------
char __fastcall IOUSBNub::USBComparePropertyInArray(IOUSBNub *this, OSDictionary *a2, const char *a3, const char *a4, unsigned int *a5)
{
  const char *v5; // r14@1
  OSMetaClassBase *v6; // rax@1
  const OSMetaClassBase *v7; // r12@1
  const OSMetaClass *v8; // rdx@1
  const OSMetaClassBase *v9; // r15@1
  OSMetaClassBase *v10; // rax@1
  __int64 v11; // rsi@1
  const OSMetaClass *v12; // rdx@1
  __int64 v13; // rbx@1
  char v14; // r13@1
  unsigned int v15; // er14@3
  OSMetaClassBase *v16; // rax@5
  const OSMetaClassBase *v17; // rsi@5
  const OSMetaClass *v18; // rdx@5
  __int64 v19; // r15@5
  unsigned int *v21; // [sp+8h] [bp-38h]@1
  const OSMetaClassBase *v22; // [sp+10h] [bp-30h]@2

  v21 = a5;
  v5 = a3;
  *a5 = 0;
  LODWORD(v6) = (*(int (__fastcall **)(IOUSBNub *, const char *))(*(_QWORD *)this + 696LL))(this, a4);
  v7 = *(const OSMetaClassBase **)off_3B078[0];
  v9 = (const OSMetaClassBase *)OSMetaClassBase::safeMetaCast(v6, *(const OSMetaClassBase **)off_3B078[0], v8);
  LODWORD(v10) = (*(int (__fastcall **)(OSDictionary *, const char *))(*(_QWORD *)a2 + 520LL))(a2, v5);
  v11 = *(_QWORD *)off_3B070[0];
  v13 = OSMetaClassBase::safeMetaCast(v10, *(const OSMetaClassBase **)off_3B070[0], v12);
  v14 = 0;
  if ( v13 )
  {
    v22 = v9;
    if ( v9 )
    {
      v15 = 0;
      v14 = 0;
      if ( (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v13 + 304LL))(v13, v11) )
      {
        v14 = 0;
        while ( 1 )
        {
          LODWORD(v16) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v13 + 488LL))(v13, v15);
          v17 = v7;
          v19 = OSMetaClassBase::safeMetaCast(v16, v7, v18);
          if ( v19 )
          {
            v17 = v22;
            v14 = (*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v19 + 360LL))(v19, v22);
            if ( v14 )
              break;
          }
          ++v15;
          if ( v15 >= (*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v13 + 304LL))(v13, v17) )
            return v14 & 1;
        }
        *v21 = (*(int (__fastcall **)(__int64))(*(_QWORD *)v19 + 328LL))(v19);
      }
    }
  }
  return v14 & 1;
}
// 3B070: using guessed type _QWORD off_3B070[20];
// 3B078: using guessed type _QWORD off_3B078[19];
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000000F7B6) ----------------------------------------------------
char __fastcall IOUSBNub::USBComparePropertyInArrayWithMask(IOUSBNub *this, OSDictionary *a2, const char *a3, const char *a4, const char *a5, unsigned int *a6)
{
  const char *v6; // ST18_8@1
  const char *v7; // r15@1
  OSDictionary *v8; // rbx@1
  OSMetaClassBase *v9; // rax@1
  const OSMetaClassBase *v10; // r12@1
  const OSMetaClass *v11; // rdx@1
  __int64 v12; // r14@1
  OSMetaClassBase *v13; // rax@1
  const OSMetaClass *v14; // rdx@1
  __int64 v15; // r13@1
  OSMetaClassBase *v16; // rax@1
  const OSMetaClass *v17; // rdx@1
  unsigned int v18; // er14@4
  OSMetaClassBase *v19; // rax@6
  const OSMetaClass *v20; // rdx@6
  __int64 v21; // r12@6
  int v22; // er15@7
  int v23; // ebx@7
  unsigned int *v25; // [sp+0h] [bp-50h]@1
  char v26; // [sp+Ch] [bp-44h]@1
  __int64 v27; // [sp+10h] [bp-40h]@3
  __int64 v28; // [sp+18h] [bp-38h]@1
  const OSMetaClassBase *v29; // [sp+20h] [bp-30h]@1

  v25 = a6;
  v6 = a5;
  v7 = a3;
  v8 = a2;
  *a6 = 0;
  LODWORD(v9) = (*(int (__fastcall **)(IOUSBNub *, const char *))(*(_QWORD *)this + 696LL))(this, a4);
  v10 = *(const OSMetaClassBase **)off_3B078[0];
  v29 = *(const OSMetaClassBase **)off_3B078[0];
  v12 = OSMetaClassBase::safeMetaCast(v9, *(const OSMetaClassBase **)off_3B078[0], v11);
  LODWORD(v13) = (*(int (__fastcall **)(OSDictionary *, const char *))(*(_QWORD *)v8 + 520LL))(v8, v7);
  v15 = OSMetaClassBase::safeMetaCast(v13, *(const OSMetaClassBase **)off_3B070[0], v14);
  LODWORD(v16) = (*(int (__fastcall **)(OSDictionary *, const char *))(*(_QWORD *)v8 + 520LL))(v8, v6);
  v28 = OSMetaClassBase::safeMetaCast(v16, v10, v17);
  v26 = 0;
  if ( v15 )
  {
    if ( v12 )
    {
      v27 = v12;
      if ( v28 )
      {
        v18 = 0;
        v26 = 0;
        if ( (*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v15 + 304LL))(v15, v10) )
        {
          v26 = 0;
          do
          {
            LODWORD(v19) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v15 + 488LL))(v15, v18);
            v21 = OSMetaClassBase::safeMetaCast(v19, v29, v20);
            if ( v21 )
            {
              v22 = (*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v27 + 328LL))(v27, v29);
              v23 = (*(int (__fastcall **)(__int64))(*(_QWORD *)v21 + 328LL))(v21);
              if ( !((*(int (**)(void))(*(_QWORD *)v28 + 328LL))() & (v22 ^ v23)) )
              {
                *v25 = v22;
                v26 = 1;
              }
            }
            ++v18;
          }
          while ( v18 < (*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v15 + 304LL))(v15, v29) );
        }
      }
    }
  }
  return v26 & 1;
}
// 3B070: using guessed type _QWORD off_3B070[20];
// 3B078: using guessed type _QWORD off_3B078[19];
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000000F91E) ----------------------------------------------------
int __fastcall IOUSBNub::IsWildCardMatch(IOUSBNub *this, OSDictionary *a2, const char *a3)
{
  OSMetaClassBase *v3; // rax@1
  const OSMetaClass *v4; // rdx@1
  __int64 v5; // rax@1
  int result; // eax@2

  LODWORD(v3) = (*(int (__fastcall **)(OSDictionary *, const char *))(*(_QWORD *)a2 + 520LL))(a2, a3);
  v5 = OSMetaClassBase::safeMetaCast(v3, *(const OSMetaClassBase **)off_3B088[0], v4);
  if ( v5 )
    result = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v5 + 344LL))(v5, "*");
  else
    result = 0;
  return result;
}
// 3B088: using guessed type _QWORD off_3B088[17];
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000000F962) ----------------------------------------------------
bool __fastcall IOUSBNub::USBComparePropertyWithMask(IOUSBNub *this, OSDictionary *a2, const char *a3, const char *a4)
{
  const char *v4; // r15@1
  const char *v5; // r14@1
  OSDictionary *v6; // rbx@1
  OSMetaClassBase *v7; // rax@1
  const OSMetaClassBase *v8; // r12@1
  const OSMetaClass *v9; // rdx@1
  __int64 v10; // r13@1
  OSMetaClassBase *v11; // rax@1
  const OSMetaClass *v12; // rdx@1
  __int64 v13; // r14@1
  OSMetaClassBase *v14; // rax@1
  const OSMetaClassBase *v15; // rsi@1
  const OSMetaClass *v16; // rdx@1
  __int64 v17; // rax@1
  __int64 v18; // r12@1
  bool v19; // r15@1
  int v20; // er15@4
  int v21; // ebx@4

  v4 = a4;
  v5 = a3;
  v6 = a2;
  LODWORD(v7) = (*(int (__fastcall **)(IOUSBNub *, const char *))(*(_QWORD *)this + 744LL))(this, a3);
  v8 = *(const OSMetaClassBase **)off_3B078[0];
  v10 = OSMetaClassBase::safeMetaCast(v7, *(const OSMetaClassBase **)off_3B078[0], v9);
  LODWORD(v11) = (*(int (__fastcall **)(OSDictionary *, const char *))(*(_QWORD *)v6 + 520LL))(v6, v5);
  v13 = OSMetaClassBase::safeMetaCast(v11, v8, v12);
  LODWORD(v14) = (*(int (__fastcall **)(OSDictionary *, const char *))(*(_QWORD *)v6 + 520LL))(v6, v4);
  v15 = v8;
  v17 = OSMetaClassBase::safeMetaCast(v14, v8, v16);
  v18 = v17;
  v19 = 0;
  if ( v10 && v13 && v17 )
  {
    v20 = (*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v10 + 328LL))(v10, v15);
    v21 = (*(int (__fastcall **)(__int64))(*(_QWORD *)v13 + 328LL))(v13);
    v19 = ((*(int (__fastcall **)(__int64))(*(_QWORD *)v18 + 328LL))(v18) & (v20 ^ v21)) == 0;
  }
  if ( v10 )
    (*(void (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v10 + 40LL))(v10, v15);
  return v19;
}
// 3B078: using guessed type _QWORD off_3B078[19];
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000000FA3E) ----------------------------------------------------
__int64 __fastcall IOUSBNub::MetaClass::~MetaClass(IOUSBNub::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000000FA50) ----------------------------------------------------
__int64 `global constructor keyed to'_a_2()
{
  OSMetaClass::OSMetaClass(&IOUSBNub::gMetaClass, "IOUSBNub", off_3B098[0], 136LL);
  IOUSBNub::gMetaClass = off_3DAE0;
  return IOUSBNub::initialize((IOUSBNub *)&IOUSBNub::gMetaClass, "IOUSBNub");
}
// 3B098: using guessed type _QWORD off_3B098[15];
// 3DAE0: using guessed type __int64 (__fastcall *off_3DAE0[2])(IOUSBNub::MetaClass *__hidden this);
// 49638: using guessed type _QWORD IOUSBNub::gMetaClass;
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000000FA90) ----------------------------------------------------
__int64 `global destructor keyed to'_a_2()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&IOUSBNub::gMetaClass);
}
// 49638: using guessed type _QWORD IOUSBNub::gMetaClass;

//----- (000000000000FAB0) ----------------------------------------------------
__int64 __fastcall IOUSBPipe::MetaClass::MetaClass(IOUSBPipe::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBPipe", off_3B080[0], 64LL);
  result = (__int64)off_3DE50;
  *(_QWORD *)this = off_3DE50;
  return result;
}
// 3B080: using guessed type _QWORD off_3B080[18];
// 3DE50: using guessed type __int64 (__fastcall *off_3DE50[2])(IOUSBPipe::MetaClass *__hidden this);
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000000FAE2) ----------------------------------------------------
__int64 __fastcall IOUSBPipe::MetaClass::~MetaClass(IOUSBPipe::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000000FAEC) ----------------------------------------------------
__int64 __fastcall IOUSBPipe::IOUSBPipe(__int64 a1)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1);
  result = (__int64)off_3DBE0;
  *(_QWORD *)a1 = off_3DBE0;
  return result;
}
// 3DBE0: using guessed type __int64 (__fastcall *off_3DBE0[2])(IOUSBPipe *__hidden this);
// 7D998: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (000000000000FB0C) ----------------------------------------------------
__int64 __fastcall IOUSBPipe::IOUSBPipe(__int64 a1)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1);
  result = (__int64)off_3DBE0;
  *(_QWORD *)a1 = off_3DBE0;
  return result;
}
// 3DBE0: using guessed type __int64 (__fastcall *off_3DBE0[2])(IOUSBPipe *__hidden this);
// 7D998: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (000000000000FB2C) ----------------------------------------------------
__int64 __fastcall IOUSBPipe::~IOUSBPipe(IOUSBPipe *this)
{
  return OSObject::~OSObject(this);
}

//----- (000000000000FB36) ----------------------------------------------------
__int64 __fastcall IOUSBPipe::~IOUSBPipe(IOUSBPipe *this)
{
  return OSObject::~OSObject(this);
}

//----- (000000000000FB40) ----------------------------------------------------
void __fastcall IOUSBPipe::~IOUSBPipe(IOUSBPipe *this)
{
  OSObject::~OSObject(this);
  OSObject::operator delete((void *)this);
}

//----- (000000000000FB62) ----------------------------------------------------
__int64 __fastcall IOUSBPipe::getMetaClass(IOUSBPipe *this)
{
  return (__int64)&IOUSBPipe::gMetaClass;
}
// 49660: using guessed type _QWORD IOUSBPipe::gMetaClass;

//----- (000000000000FB70) ----------------------------------------------------
__int64 __fastcall IOUSBPipe::MetaClass::MetaClass(IOUSBPipe::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBPipe", off_3B080[0], 64LL);
  result = (__int64)off_3DE50;
  *(_QWORD *)this = off_3DE50;
  return result;
}
// 3B080: using guessed type _QWORD off_3B080[18];
// 3DE50: using guessed type __int64 (__fastcall *off_3DE50[2])(IOUSBPipe::MetaClass *__hidden this);
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000000FBA2) ----------------------------------------------------
__int64 __fastcall IOUSBPipe::MetaClass::alloc(IOUSBPipe::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&stru_20.vmsize, a2);
  OSObject::OSObject(v2);
  *(_QWORD *)v2 = off_3DBE0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBPipe::gMetaClass);
  return v2;
}
// 20: using guessed type segment_command_64;
// 3DBE0: using guessed type __int64 (__fastcall *off_3DBE0[2])(IOUSBPipe *__hidden this);
// 49660: using guessed type _QWORD IOUSBPipe::gMetaClass;
// 7D998: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (000000000000FBE2) ----------------------------------------------------
__int64 __fastcall IOUSBPipe::IOUSBPipe(__int64 a1)
{
  OSObject::OSObject(a1);
  *(_QWORD *)a1 = off_3DBE0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBPipe::gMetaClass);
}
// 3DBE0: using guessed type __int64 (__fastcall *off_3DBE0[2])(IOUSBPipe *__hidden this);
// 49660: using guessed type _QWORD IOUSBPipe::gMetaClass;
// 7D998: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (000000000000FC12) ----------------------------------------------------
__int64 __fastcall IOUSBPipe::IOUSBPipe(__int64 a1)
{
  OSObject::OSObject(a1);
  *(_QWORD *)a1 = off_3DBE0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBPipe::gMetaClass);
}
// 3DBE0: using guessed type __int64 (__fastcall *off_3DBE0[2])(IOUSBPipe *__hidden this);
// 49660: using guessed type _QWORD IOUSBPipe::gMetaClass;
// 7D998: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (000000000000FC42) ----------------------------------------------------
char __fastcall IOUSBPipe::InitToEndpoint(uintptr_t arg1, uintptr_t arg2, unsigned __int8 a3, unsigned __int16 a4, __int64 a5, __int64 a6, __int64 a7)
{
  __int64 v7; // r13@1
  __int64 v8; // r15@1
  unsigned __int8 v9; // bl@1
  uintptr_t v10; // r12@1
  uintptr_t v11; // r14@1
  unsigned __int8 v12; // al@4
  uintptr_t v13; // rcx@4
  char v14; // r12@4
  uintptr_t v15; // r12@6
  void *v16; // rax@7
  unsigned __int8 v17; // al@9
  unsigned __int8 v18; // cl@9
  char v19; // dl@9
  unsigned int v20; // eax@12
  signed __int16 v21; // si@12
  bool v22; // zf@12
  signed __int16 v23; // ax@12
  __int64 v24; // rdx@15
  OSMetaClassBase *v25; // rax@21
  __int64 v26; // rsi@21
  const OSMetaClass *v27; // rdx@21
  __int64 v28; // rax@21
  __int64 v29; // rax@26
  int v30; // ecx@28
  unsigned int v31; // er15@30
  __int64 v32; // rdi@30
  __int64 v33; // rax@31
  __int64 v34; // r8@31
  int v35; // eax@34
  __int64 v36; // rax@36
  __int64 v37; // rdi@36
  __int64 v38; // rax@37
  __int64 v39; // rcx@37
  uintptr_t v41; // [sp+8h] [bp-38h]@9
  unsigned __int16 v42; // [sp+14h] [bp-2Ch]@1

  v7 = a6;
  v8 = a5;
  v42 = a4;
  v9 = a3;
  v10 = arg2;
  v11 = arg1;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
  {
    arg2 = arg1;
    kernel_debug(0x52D2005u, arg1, v10, a3, a4, 0LL);
  }
  v12 = (*(int (__fastcall **)(uintptr_t, uintptr_t))(off_3B0C8[0] + 152))(arg1, arg2);
  v13 = v10;
  v14 = 0;
  if ( !v13 || v12 ^ 1 )
    return v14;
  v15 = v13;
  if ( !*(_QWORD *)(arg1 + 56) )
  {
    LODWORD(v16) = IOMalloc(48LL);
    *(_QWORD *)(arg1 + 56) = v16;
    if ( !v16 )
      return 0;
    bzero(v16, 0x30uLL);
  }
  *(_QWORD *)(arg1 + 40) = v8;
  *(_QWORD *)(arg1 + 16) = v15;
  v17 = *(_BYTE *)(v15 + 2);
  v41 = arg1 + 24;
  *(_BYTE *)(arg1 + 32) = *(_BYTE *)(v15 + 2) & 0xF;
  v18 = *(_BYTE *)(v15 + 3);
  v19 = *(_BYTE *)(v15 + 3) & 3;
  *(_BYTE *)(arg1 + 34) = v19;
  if ( v19 )
    *(_BYTE *)(arg1 + 33) = v17 >> 7;
  else
    *(_BYTE *)(arg1 + 33) = 3;
  v20 = ((unsigned int)*(_WORD *)(v15 + 4) >> 11) & 3;
  v21 = v20 + 1;
  v22 = v20 == 3;
  v23 = 3;
  if ( !v22 )
    v23 = v21;
  *(_WORD *)(arg1 + 36) = (*(_WORD *)(v15 + 4) & 0x7FF) * v23;
  *(_BYTE *)(arg1 + 38) = *(_BYTE *)(v15 + 6);
  if ( v19 == 1 )
  {
    v24 = *(_QWORD *)(arg1 + 56);
    *(_BYTE *)(v24 + 41) = (v18 >> 4) & 3;
    *(_BYTE *)(v24 + 42) = (v18 >> 2) & 3;
  }
  else
  {
    if ( v19 == 3 )
    {
      v24 = *(_QWORD *)(arg1 + 56);
      *(_BYTE *)(v24 + 41) = (v18 >> 4) & 3;
    }
    else
    {
      v24 = *(_QWORD *)(arg1 + 56);
      *(_BYTE *)(v24 + 41) = 0;
    }
    *(_BYTE *)(v24 + 42) = 0;
  }
  *(_WORD *)(arg1 + 48) = v42;
  *(_BYTE *)(v24 + 16) = v9;
  *(_QWORD *)(v24 + 8) = v7;
  *(_QWORD *)(v24 + 24) = a7;
  if ( v7 )
  {
    LODWORD(v25) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v7 + 696LL))(v7, "locationID");
    v26 = *(_QWORD *)off_3B078[0];
    v28 = OSMetaClassBase::safeMetaCast(v25, *(const OSMetaClassBase **)off_3B078[0], v27);
    if ( v28 )
      *(_DWORD *)(*(_QWORD *)(arg1 + 56) + 36LL) = (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v28 + 328LL))(
                                                     v28,
                                                     v26);
  }
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D2004u, arg1, *(_QWORD *)(arg1 + 40), *(_BYTE *)(arg1 + 34), *(_WORD *)(arg1 + 36), 0LL);
  v29 = *(_QWORD *)(arg1 + 56);
  if ( *(_BYTE *)(v29 + 16) == 2 && *(_BYTE *)(arg1 + 34) == 2 )
  {
    v30 = *(_WORD *)(arg1 + 36);
    if ( v30 != 512 && !*(_BYTE *)(arg1 + 50) )
    {
      v31 = *(_BYTE *)(v15 + 2);
      v32 = *(_QWORD *)(v29 + 8);
      if ( v32 )
      {
        LODWORD(v33) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v32 + 904LL))(v32, 0LL);
        v34 = v33;
        v29 = *(_QWORD *)(v11 + 56);
        LOWORD(v30) = *(_WORD *)(v11 + 36);
      }
      else
      {
        v34 = (__int64)"Unnamed";
      }
      KernelDebugLogInternal(
        1u,
        0x55534246u,
        (__int64)"Endpoint 0x%x of the USB device \"%s\" at location 0x%x:  converting Bulk MPS from %d to 512 (USB 2.0 Spec section 5.8.3)",
        v31,
        v34,
        *(_DWORD *)(v29 + 36),
        v30);
      *(_WORD *)(v11 + 36) = 512;
    }
  }
  v35 = (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD, uintptr_t))(**(_QWORD **)(v11 + 40) + 2352LL))(
          *(_QWORD *)(v11 + 40),
          *(_WORD *)(v11 + 48),
          v9,
          v41);
  if ( v35 != -536870164 )
    goto LABEL_40;
  if ( *(_BYTE *)(v11 + 34) != 1 )
    return 0;
  v36 = *(_QWORD *)(v11 + 56);
  v37 = *(_QWORD *)(v36 + 8);
  if ( v37 )
  {
    LODWORD(v38) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v37 + 904LL))(v37, 0LL);
    v39 = v38;
    v36 = *(_QWORD *)(v11 + 56);
  }
  else
  {
    v39 = (__int64)"Unnamed";
  }
  KernelDebugLogInternal(
    1u,
    0x55534246u,
    (__int64)"There is not enough USB isochronous bandwidth to allow the device \"%s\" at location 0x%x to function in its current configuration (requested %d bytes for endpoint 0x%x )",
    v39,
    *(_DWORD *)(v36 + 36),
    *(_WORD *)(v11 + 36),
    *(_BYTE *)(v15 + 2));
  *(_WORD *)(v11 + 36) = 0;
  v35 = (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD, uintptr_t))(**(_QWORD **)(v11 + 40) + 2352LL))(
          *(_QWORD *)(v11 + 40),
          *(_WORD *)(v11 + 48),
          v9,
          v41);
LABEL_40:
  if ( v35 )
    return 0;
  v14 = 1;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D2006u, v11, 0LL, 0LL, 0LL, 0LL);
  return v14;
}
// 3B078: using guessed type _QWORD off_3B078[19];
// 3B0C8: using guessed type __int64 off_3B0C8[9];
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 7D250: using guessed type int __fastcall IOMalloc(_QWORD);
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000000FFAA) ----------------------------------------------------
__int64 __fastcall IOUSBPipe::ToEndpoint(__int64 a1, unsigned __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r13@1
  unsigned __int64 v5; // r14@1
  __int64 v6; // rbx@1
  _QWORD *v7; // rsi@1
  __int64 v8; // rax@3
  int (__fastcall *v9)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD); // r12@4
  unsigned __int8 v10; // r15@4
  unsigned __int16 v11; // ax@4
  __int64 v13; // [sp+10h] [bp-30h]@1

  v4 = a4;
  v13 = a3;
  v5 = a2;
  v6 = OSObject::operator new((OSObject *)&stru_20.vmsize, a2);
  v7 = &IOUSBPipe::gMetaClass;
  OSObject::OSObject(v6);
  *(_QWORD *)v6 = off_3DBE0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBPipe::gMetaClass);
  if ( v6 && v4 )
  {
    v7 = (_QWORD *)"Out of spec MPS OK";
    LODWORD(v8) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v4 + 696LL))(v4, "Out of spec MPS OK");
    *(_BYTE *)(v6 + 50) = v8 == **(_QWORD **)off_3B0F8[0];
  }
  v9 = *(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v6 + 528LL);
  v10 = (*(int (__fastcall **)(unsigned __int64, _QWORD *))(*(_QWORD *)v5 + 2256LL))(v5, v7);
  v11 = (*(int (__fastcall **)(unsigned __int64))(*(_QWORD *)v5 + 2248LL))(v5);
  if ( !(unsigned __int8)v9(v6, a1, v10, v11, v13, v5) )
  {
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v6 + 40LL))(v6);
    v6 = 0LL;
  }
  return v6;
}
// 20: using guessed type segment_command_64 stru_20;
// 3B0F8: using guessed type __int64 off_3B0F8[3];
// 3DBE0: using guessed type __int64 (__fastcall *off_3DBE0[2])(IOUSBPipe *__hidden this);
// 49660: using guessed type _QWORD IOUSBPipe::gMetaClass;
// 7D998: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (000000000001008C) ----------------------------------------------------
int __fastcall IOUSBPipe::free(IOUSBPipe *this)
{
  IOUSBPipe *v1; // rbx@1
  __int64 v2; // rdi@1

  v1 = this;
  v2 = *((_QWORD *)this + 7);
  if ( v2 )
  {
    IOFree(v2, 48LL);
    *((_QWORD *)v1 + 7) = 0LL;
  }
  return (*(int (__fastcall **)(IOUSBPipe *))(off_3B0C8[0] + 160))(v1);
}
// 3B0C8: using guessed type __int64 off_3B0C8[9];
// 7D218: using guessed type int __fastcall IOFree(_QWORD, _QWORD);

//----- (00000000000100C6) ----------------------------------------------------
__int64 __fastcall IOUSBPipe::Abort(uintptr_t arg1, __int64 a2, const OSMetaClass *a3)
{
  __int64 v3; // r14@1
  int v4; // eax@5
  int v5; // er14@7

  v3 = OSMetaClassBase::safeMetaCast((OSMetaClassBase *)arg1, (const OSMetaClassBase *)IOUSBPipeV2::metaClass, a3);
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D2031u, arg1, *(_WORD *)(arg1 + 48), *(_BYTE *)(arg1 + 32), *(_BYTE *)(arg1 + 34), 0LL);
  if ( v3 )
  {
    v4 = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v3 + 632LL))(v3, 0x80000000LL);
  }
  else
  {
    **(_DWORD **)(arg1 + 56) = 0;
    v4 = (*(int (__fastcall **)(_QWORD, _QWORD, uintptr_t))(**(_QWORD **)(arg1 + 40) + 2368LL))(
           *(_QWORD *)(arg1 + 40),
           *(_WORD *)(arg1 + 48),
           arg1 + 24);
  }
  v5 = v4;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D2032u, arg1, *(_WORD *)(arg1 + 48), *(_BYTE *)(arg1 + 32), v4, 0LL);
  return (unsigned int)v5;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 474A0: using guessed type _QWORD IOUSBPipeV2::metaClass;
// 49460: using guessed type int gUSBStackDebugFlags;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000010196) ----------------------------------------------------
int __fastcall IOUSBPipe::Reset(IOUSBPipe *this)
{
  **((_DWORD **)this + 7) = 0;
  return (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD))(**((_QWORD **)this + 5) + 2376LL))(
           *((_QWORD *)this + 5),
           *((_WORD *)this + 24),
           (char *)this + 24);
}

//----- (00000000000101C0) ----------------------------------------------------
int __fastcall IOUSBPipe::ClosePipe(IOUSBPipe *this)
{
  return (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD))(**((_QWORD **)this + 5) + 2360LL))(
           *((_QWORD *)this + 5),
           *((_WORD *)this + 24),
           (char *)this + 24);
}

//----- (00000000000101E0) ----------------------------------------------------
int __fastcall IOUSBPipe::ClearStall(IOUSBPipe *this)
{
  return (*(int (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)this + 488LL))(this, 0LL);
}

//----- (00000000000101F4) ----------------------------------------------------
__int64 __fastcall IOUSBPipe::ClearPipeStall(uintptr_t arg1, unsigned __int8 a2)
{
  unsigned __int8 v2; // r15@1
  uintptr_t v3; // rbx@1
  __int64 v4; // rax@1
  int v5; // er14@1
  uintptr_t v6; // rcx@12
  uintptr_t v7; // rdx@12
  uint32_t v8; // edi@12
  uintptr_t v9; // r8@12
  IOService *v10; // rdi@13
  uintptr_t v11; // rsi@21
  char *v13; // rsi@24
  uintptr_t v14; // rcx@35
  uintptr_t v15; // rdx@35
  uintptr_t v16; // r8@35
  __int64 v17; // rax@43
  __int64 v18; // rdi@44
  __int64 v19; // rax@50
  __int64 v20; // rax@51
  __int64 v21; // rax@52
  __int64 v22; // r12@53
  __int64 v23; // rdi@54
  unsigned __int8 v24; // cl@54
  signed int v25; // esi@54
  int v26; // edx@54
  int v27; // eax@56
  uintptr_t arg2; // [sp+8h] [bp-68h]@54
  __int64 v29; // [sp+10h] [bp-60h]@39
  void (__usercall *v30)(void *@<rdi>, void *@<rsi>, char@<al>, unsigned int@<edx>, unsigned int@<ecx>, __int64@<r8>, __int64@<r9>); // [sp+18h] [bp-58h]@39
  int *v31; // [sp+20h] [bp-50h]@39
  char v32; // [sp+28h] [bp-48h]@39
  char v33; // [sp+29h] [bp-47h]@39
  __int16 v34; // [sp+2Ah] [bp-46h]@39
  __int16 v35; // [sp+2Ch] [bp-44h]@39
  __int16 v36; // [sp+2Eh] [bp-42h]@39
  __int64 v37; // [sp+30h] [bp-40h]@39
  int v38; // [sp+38h] [bp-38h]@39
  int v39; // [sp+40h] [bp-30h]@54
  int v40; // [sp+44h] [bp-2Ch]@56

  v2 = a2;
  v3 = arg1;
  v4 = *(_QWORD *)(arg1 + 56);
  v5 = -536870208;
  if ( !v4 )
    return (unsigned int)v5;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
  {
    kernel_debug(0x52D202Du, arg1, *(_WORD *)(arg1 + 48), *(_BYTE *)(arg1 + 32), *(_BYTE *)(arg1 + 34), 0LL);
    v4 = *(_QWORD *)(arg1 + 56);
  }
  if ( *(_DWORD *)v4 && gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
  {
    kernel_debug(0x52D202Cu, arg1, *(_WORD *)(arg1 + 48), *(_BYTE *)(arg1 + 32), 1uLL, 0LL);
    v4 = *(_QWORD *)(arg1 + 56);
  }
  *(_DWORD *)v4 = 0;
  if ( *(_BYTE *)(arg1 + 34) == 1 )
  {
    v5 = 0;
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      v6 = *(_BYTE *)(arg1 + 32);
      v7 = *(_WORD *)(arg1 + 48);
      v5 = 0;
      v8 = 86843436;
      v9 = 2LL;
LABEL_21:
      v11 = v3;
LABEL_22:
      kernel_debug(v8, v11, v7, v6, v9, 0LL);
      return (unsigned int)v5;
    }
    return (unsigned int)v5;
  }
  v10 = *(IOService **)(v4 + 8);
  if ( !v10 )
  {
    v5 = -536870174;
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      v6 = *(_BYTE *)(v3 + 32);
      v7 = *(_WORD *)(v3 + 48);
      v8 = 86843436;
      v9 = 3LL;
      goto LABEL_21;
    }
    return (unsigned int)v5;
  }
  if ( !(unsigned __int8)IOService::isInactive(v10) )
  {
    (*(void (__fastcall **)(uintptr_t))(*(_QWORD *)v3 + 32LL))(v3);
    (*(void (**)(void))(**(_QWORD **)(*(_QWORD *)(v3 + 56) + 8LL) + 32LL))();
    v13 = (char *)*(_WORD *)(v3 + 48);
    v5 = (*(int (__fastcall **)(_QWORD, char *, signed __int64))(**(_QWORD **)(v3 + 40) + 2384LL))(
           *(_QWORD *)(v3 + 40),
           v13,
           v3 + 24);
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      v13 = (char *)v3;
      kernel_debug(0x52D202Cu, v3, *(_WORD *)(v3 + 48), v5, 5uLL, 0LL);
    }
    if ( v5 == -536854456 && gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      v13 = (char *)v3;
      kernel_debug(0x52D202Cu, v3, *(_WORD *)(v3 + 48), 0xFFFFFFFFE0004048LL, 6uLL, 0LL);
    }
    if ( (unsigned __int8)(*(int (__fastcall **)(_QWORD, char *))(**(_QWORD **)(*(_QWORD *)(v3 + 56) + 8LL) + 2256LL))(
                            *(_QWORD *)(*(_QWORD *)(v3 + 56) + 8LL),
                            v13) != 2
      && (unsigned __int8)(*(int (**)(void))(**(_QWORD **)(*(_QWORD *)(v3 + 56) + 8LL) + 2256LL))() != 3 )
    {
      if ( v5 )
        goto LABEL_43;
      if ( (unsigned __int8)(*(_BYTE *)(v3 + 34) | 2) == 2 )
      {
        v19 = *(_QWORD *)(v3 + 56);
        if ( v19 )
        {
          v20 = *(_QWORD *)(v19 + 8);
          if ( v20 )
          {
            v21 = *(_QWORD *)(v20 + 232);
            if ( v21 )
            {
              v22 = *(_QWORD *)(v21 + 16);
              if ( v22 )
              {
                (*(void (__fastcall **)(__int64))(*(_QWORD *)v22 + 32LL))(v22);
                v23 = *(_QWORD *)(*(_QWORD *)(v3 + 56) + 8LL);
                arg2 = **(_DWORD **)(v23 + 232);
                v39 = **(_DWORD **)(v23 + 232);
                v24 = (*(int (**)(void))(*(_QWORD *)v23 + 2248LL))();
                v25 = 0;
                v26 = 0;
                if ( *(_BYTE *)(v3 + 34) )
                {
                  v26 = (*(_BYTE *)(v3 + 33) == 1) << 24;
                  v25 = 0x20000;
                }
                v27 = v26 | v25 | v24 | (*(_BYTE *)(v3 + 32) << 8);
                v40 = v26 | v25 | v24 | (*(_BYTE *)(v3 + 32) << 8);
                if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
                  kernel_debug(0x52D202Cu, v3, arg2, (unsigned int)v27, 8uLL, 0LL);
                v13 = (char *)3758112780;
                (*(void (__fastcall **)(__int64, signed __int64, int *, signed __int64))(*(_QWORD *)v22 + 1856LL))(
                  v22,
                  3758112780LL,
                  &v39,
                  8LL);
                (*(void (__fastcall **)(__int64))(*(_QWORD *)v22 + 40LL))(v22);
                goto LABEL_37;
              }
            }
          }
        }
        if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        {
          v14 = *(_BYTE *)(v3 + 32);
          v15 = *(_WORD *)(v3 + 48);
          v16 = 9LL;
          goto LABEL_36;
        }
      }
    }
    else if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      v14 = *(_BYTE *)(v3 + 32);
      v15 = *(_WORD *)(v3 + 48);
      v16 = 7LL;
LABEL_36:
      v13 = (char *)v3;
      kernel_debug(0x52D202Cu, v3, v15, v14, v16, 0LL);
      goto LABEL_37;
    }
LABEL_37:
    if ( !v5 && !(v2 ^ 1) )
    {
      v29 = 0LL;
      v30 = IOUSBSyncCompletion;
      v31 = &v38;
      v32 = 2;
      v33 = 1;
      v34 = 0;
      v35 = *(_BYTE *)(v3 + 32) | (unsigned __int16)((*(_BYTE *)(v3 + 33) == 1) << 7);
      v36 = 0;
      v38 = 0;
      v37 = 0LL;
      v13 = &v32;
      v5 = (*(int (__fastcall **)(_QWORD, char *, __int64 *, _QWORD, _QWORD, signed __int64))(**(_QWORD **)(v3 + 40)
                                                                                            + 2528LL))(
             *(_QWORD *)(v3 + 40),
             &v32,
             &v29,
             *(_WORD *)(v3 + 48),
             0LL,
             5000LL);
      if ( gUSBStackDebugFlags & 2 )
      {
        if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        {
          v13 = (char *)v3;
          kernel_debug(0x52D202Cu, v3, *(_WORD *)(v3 + 48), v5, 0xAuLL, 0LL);
        }
      }
    }
LABEL_43:
    v17 = *(_QWORD *)(v3 + 56);
    if ( v17 )
    {
      v18 = *(_QWORD *)(v17 + 8);
      if ( v18 )
        (*(void (__fastcall **)(__int64, char *))(*(_QWORD *)v18 + 40LL))(v18, v13);
    }
    (*(void (__fastcall **)(uintptr_t, char *))(*(_QWORD *)v3 + 40LL))(v3, v13);
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      v9 = v5;
      v6 = *(_BYTE *)(v3 + 34);
      v7 = *(_BYTE *)(v3 + 32);
      v11 = *(_WORD *)(v3 + 48);
      v8 = 86843438;
      goto LABEL_22;
    }
    return (unsigned int)v5;
  }
  v5 = 0;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
  {
    v6 = *(_BYTE *)(v3 + 32);
    v7 = *(_WORD *)(v3 + 48);
    v5 = 0;
    v8 = 86843436;
    v9 = 4LL;
    goto LABEL_21;
  }
  return (unsigned int)v5;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (00000000000106E8) ----------------------------------------------------
int __fastcall IOUSBPipe::SetPipePolicy(IOUSBPipe *this, unsigned __int16 a2, unsigned __int8 a3)
{
  char *v3; // r14@1
  int v4; // eax@1
  signed int v5; // er15@1
  char v6; // r13@3
  __int16 v8; // r13@9
  int v9; // eax@10
  __int16 v10; // [sp+0h] [bp-2Ch]@3

  v3 = (char *)this + 24;
  v4 = *((_BYTE *)this + 34);
  v5 = -536870206;
  if ( v4 == 3 )
  {
    if ( a3 )
    {
      v10 = *((_WORD *)this + 18);
      v6 = *((_BYTE *)this + 38);
      if ( *((_BYTE *)this + 38) != a3 )
        *((_BYTE *)this + 38) = a3;
      if ( (unsigned __int16)IOUSBInterface::CalculateFullMaxPacketSize(
                               *(_QWORD *)(*((_QWORD *)this + 7) + 24LL),
                               *((_QWORD *)this + 2),
                               0LL) >= (unsigned int)a2 )
      {
        *((_WORD *)this + 18) = a2;
        v5 = 0;
        if ( (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD, char *))(**((_QWORD **)this + 5) + 2352LL))(
               *((_QWORD *)this + 5),
               *((_WORD *)this + 24),
               *(_BYTE *)(*((_QWORD *)this + 7) + 16LL),
               v3) )
        {
          *((_BYTE *)this + 38) = v6;
          *((_WORD *)this + 18) = v10;
          return (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD, char *))(**((_QWORD **)this + 5) + 2352LL))(
                   *((_QWORD *)this + 5),
                   *((_WORD *)this + 24),
                   *(_BYTE *)(*((_QWORD *)this + 7) + 16LL),
                   v3);
        }
      }
    }
  }
  else if ( v4 == 1 )
  {
    v8 = *((_WORD *)this + 18);
    if ( (unsigned __int16)IOUSBInterface::CalculateFullMaxPacketSize(
                             *(_QWORD *)(*((_QWORD *)this + 7) + 24LL),
                             *((_QWORD *)this + 2),
                             0LL) >= (unsigned int)a2 )
    {
      *((_WORD *)this + 18) = a2;
      v9 = (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD, char *))(**((_QWORD **)this + 5) + 2352LL))(
             *((_QWORD *)this + 5),
             *((_WORD *)this + 24),
             *(_BYTE *)(*((_QWORD *)this + 7) + 16LL),
             v3);
      v5 = 0;
      if ( v9 )
      {
        *((_WORD *)this + 18) = v8;
        v5 = v9;
      }
    }
  }
  return v5;
}

//----- (000000000001082C) ----------------------------------------------------
int __fastcall IOUSBPipe::Read(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  return (*(int (__fastcall **)(__int64, __int64, _QWORD, _QWORD, __int64, __int64))(*(_QWORD *)a1 + 432LL))(
           a1,
           a2,
           0LL,
           0LL,
           a3,
           a4);
}

//----- (0000000000010848) ----------------------------------------------------
int __fastcall IOUSBPipe::Read(__int64 a1, __int64 a2, unsigned int a3, unsigned int a4, __int64 a5)
{
  unsigned int v5; // er15@1
  unsigned int v6; // er13@1
  int (__fastcall *v7)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD); // ST10_8@2
  __int64 v8; // ST08_8@2
  __int64 v9; // rax@2
  int result; // eax@2

  v5 = a4;
  v6 = a3;
  if ( a2 )
  {
    v7 = *(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 464LL);
    v8 = a5;
    LODWORD(v9) = (*(int (__fastcall **)(__int64))(*(_QWORD *)a2 + 456LL))(a2);
    result = v7(a1, a2, v6, v5, v9, v8);
  }
  else
  {
    result = -536870206;
  }
  return result;
}

//----- (00000000000108BC) ----------------------------------------------------
__int64 __fastcall IOUSBPipe::Read(uintptr_t arg1, __int64 a2, const OSMetaClass *a3, unsigned int a4, uintptr_t a5, __int64 a6, __int64 a7)
{
  __int64 v7; // r13@1
  unsigned int v8; // er15@1
  unsigned int v9; // ebx@1
  __int64 v10; // r14@1
  uintptr_t v11; // rsi@1
  __int64 v12; // rax@1
  int v13; // er14@2
  __int64 v14; // r12@6
  uintptr_t v15; // rax@8
  unsigned int v16; // edx@9
  uintptr_t v17; // rcx@10
  uintptr_t v18; // rbx@12
  uintptr_t arg4; // [sp+18h] [bp-48h]@1
  __int64 v21; // [sp+20h] [bp-40h]@15
  void (__usercall *v22)(void *@<rdi>, void *@<rsi>, char@<al>, unsigned int@<edx>, unsigned int@<ecx>, __int64@<r8>, __int64@<r9>); // [sp+28h] [bp-38h]@15
  __int64 v23; // [sp+30h] [bp-30h]@15

  v7 = a6;
  arg4 = a5;
  v8 = a4;
  v9 = (unsigned int)a3;
  v10 = a2;
  v11 = IOUSBPipeV2::metaClass;
  v12 = OSMetaClassBase::safeMetaCast((OSMetaClassBase *)arg1, (const OSMetaClassBase *)IOUSBPipeV2::metaClass, a3);
  if ( v12 )
  {
    v13 = (*(int (__fastcall **)(__int64, _QWORD, __int64, _QWORD, _QWORD, uintptr_t))(*(_QWORD *)v12 + 600LL))(
            v12,
            0LL,
            v10,
            v9,
            v8,
            arg4);
    return (unsigned int)v13;
  }
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
  {
    v11 = *(_WORD *)(arg1 + 48);
    kernel_debug(0x52D2009u, v11, *(_BYTE *)(arg1 + 32), *(_BYTE *)(arg1 + 34), arg4, 0LL);
  }
  v14 = v10;
  if ( (v9 | v8) != 0 && *(_BYTE *)(arg1 + 34) != 2
    || !v10
    || (LODWORD(v15) = (*(int (__fastcall **)(__int64, uintptr_t))(*(_QWORD *)v10 + 456LL))(v10, v11), v15 < arg4) )
  {
LABEL_27:
    v13 = -536870206;
    return (unsigned int)v13;
  }
  v16 = v9;
  v13 = -536854449;
  if ( **(_DWORD **)(arg1 + 56) == -536854449 )
    return (unsigned int)v13;
  v17 = arg1 + 24;
  if ( !v7 )
  {
    if ( a7 )
      *(_QWORD *)a7 = arg4;
    v21 = 0LL;
    v22 = IOUSBSyncCompletion;
    v23 = a7;
    v18 = arg1;
    v13 = (*(int (__fastcall **)(_QWORD, __int64, _QWORD, uintptr_t, __int64 *, _QWORD))(**(_QWORD **)(arg1 + 40)
                                                                                       + 2576LL))(
            *(_QWORD *)(arg1 + 40),
            v14,
            *(_WORD *)(arg1 + 48),
            v17,
            &v21,
            v16);
    if ( v13 != -536870165 && v13 != -536854447 && v13 )
      **(_DWORD **)(arg1 + 56) = -536854449;
    goto LABEL_19;
  }
  if ( !*(_QWORD *)(v7 + 8) )
  {
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D2008u, arg1, 0xFFFFFFFFE00002C2LL, 0LL, 1uLL, 0LL);
    goto LABEL_27;
  }
  v18 = arg1;
  v13 = (*(int (__fastcall **)(_QWORD, __int64, _QWORD, uintptr_t, __int64, _QWORD))(**(_QWORD **)(arg1 + 40) + 2576LL))(
          *(_QWORD *)(arg1 + 40),
          v14,
          *(_WORD *)(arg1 + 48),
          v17,
          v7,
          v16);
LABEL_19:
  if ( v13 == -536854449 )
    **(_DWORD **)(v18 + 56) = -536854449;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D200Au, v18, *(_WORD *)(v18 + 48), *(_BYTE *)(v18 + 32), v13, 0LL);
  return (unsigned int)v13;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 474A0: using guessed type _QWORD IOUSBPipeV2::metaClass;
// 49460: using guessed type int gUSBStackDebugFlags;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000010B0A) ----------------------------------------------------
__int64 __fastcall IOUSBPipe::Read(uintptr_t arg1, __int64 a2, const OSMetaClass *a3, unsigned int a4, uintptr_t a5, __int64 a6, __int64 a7)
{
  uintptr_t v7; // r12@1
  __int64 v8; // r15@1
  uintptr_t v9; // rsi@1
  __int64 v10; // r14@1
  int v11; // er13@1
  uintptr_t v12; // rax@7
  uintptr_t v13; // rcx@9
  __int64 v15; // [sp+10h] [bp-50h]@1
  unsigned __int64 v16; // [sp+18h] [bp-48h]@1
  __int64 v17; // [sp+20h] [bp-40h]@14
  void (__usercall *v18)(void *@<rdi>, void *@<rsi>, char@<al>, unsigned int@<edx>, unsigned int@<ecx>, __int64@<r8>, __int64@<r9>); // [sp+28h] [bp-38h]@14
  __int64 v19; // [sp+30h] [bp-30h]@14

  v15 = a6;
  v7 = a5;
  v16 = __PAIR__((unsigned int)a3, a4);
  v8 = a2;
  v9 = IOUSBControllerV2::metaClass;
  v10 = OSMetaClassBase::safeMetaCast(
          *(OSMetaClassBase **)(arg1 + 40),
          (const OSMetaClassBase *)IOUSBControllerV2::metaClass,
          a3);
  v11 = -536870201;
  if ( !v10 )
    return (unsigned int)v11;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
  {
    v9 = *(_WORD *)(arg1 + 48);
    kernel_debug(0x52D2021u, v9, *(_BYTE *)(arg1 + 32), *(_BYTE *)(arg1 + 34), v7, 0LL);
  }
  if ( v16 != 0 && *(_BYTE *)(arg1 + 34) != 2
    || !v8
    || (LODWORD(v12) = (*(int (__fastcall **)(__int64, uintptr_t))(*(_QWORD *)v8 + 456LL))(v8, v9), v12 < v7) )
  {
LABEL_26:
    v11 = -536870206;
    return (unsigned int)v11;
  }
  v11 = -536854449;
  if ( **(_DWORD **)(arg1 + 56) == -536854449 )
    return (unsigned int)v11;
  v13 = arg1 + 24;
  if ( !v15 )
  {
    if ( a7 )
      *(_QWORD *)a7 = v7;
    v17 = 0LL;
    v18 = IOUSBSyncCompletion;
    v19 = a7;
    v11 = (*(int (__fastcall **)(__int64, __int64, _QWORD, uintptr_t, __int64 *, _QWORD))(*(_QWORD *)v10 + 2744LL))(
            v10,
            v8,
            *(_WORD *)(arg1 + 48),
            v13,
            &v17,
            HIDWORD(v16));
    if ( v11 != -536870165 && v11 != -536854447 && v11 )
      **(_DWORD **)(arg1 + 56) = -536854449;
    goto LABEL_18;
  }
  if ( !*(_QWORD *)(v15 + 8) )
  {
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D2020u, arg1, 0xFFFFFFFFE00002C2LL, 0LL, 0LL, 0LL);
    goto LABEL_26;
  }
  v11 = (*(int (__fastcall **)(__int64, __int64, _QWORD, uintptr_t, __int64, _QWORD))(*(_QWORD *)v10 + 2744LL))(
          v10,
          v8,
          *(_WORD *)(arg1 + 48),
          v13,
          v15,
          HIDWORD(v16));
LABEL_18:
  if ( v11 == -536854449 )
    **(_DWORD **)(arg1 + 56) = -536854449;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D2022u, arg1, *(_WORD *)(arg1 + 48), *(_BYTE *)(arg1 + 32), v11, 0LL);
  return (unsigned int)v11;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 419C0: using guessed type _QWORD IOUSBControllerV2::metaClass;
// 49460: using guessed type int gUSBStackDebugFlags;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000010D28) ----------------------------------------------------
int __fastcall IOUSBPipe::Write(__int64 a1, __int64 a2, __int64 a3)
{
  return (*(int (__fastcall **)(__int64, __int64, _QWORD, _QWORD, __int64))(*(_QWORD *)a1 + 440LL))(
           a1,
           a2,
           0LL,
           0LL,
           a3);
}

//----- (0000000000010D40) ----------------------------------------------------
int __fastcall IOUSBPipe::Write(__int64 a1, __int64 a2, unsigned int a3, unsigned int a4, __int64 a5)
{
  __int64 v5; // r14@1
  unsigned int v6; // er15@1
  unsigned int v7; // er12@1
  int (__fastcall *v8)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD); // ST00_8@2
  __int64 v9; // rax@2
  int result; // eax@2

  v5 = a5;
  v6 = a4;
  v7 = a3;
  if ( a2 )
  {
    v8 = *(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 472LL);
    LODWORD(v9) = (*(int (__fastcall **)(__int64))(*(_QWORD *)a2 + 456LL))(a2);
    result = v8(a1, a2, v7, v6, v9, v5);
  }
  else
  {
    result = -536870206;
  }
  return result;
}

//----- (0000000000010DB8) ----------------------------------------------------
__int64 __fastcall IOUSBPipe::Write(uintptr_t arg1, __int64 a2, const OSMetaClass *a3, unsigned int a4, uintptr_t a5, __int64 a6)
{
  __int64 v6; // r13@1
  unsigned int v7; // er15@1
  int v8; // ebx@1
  __int64 v9; // r14@1
  uintptr_t v10; // rsi@1
  __int64 v11; // rax@1
  int v12; // er14@2
  __int64 v13; // r12@6
  uintptr_t v14; // rax@8
  uintptr_t v15; // rcx@10
  __int64 v16; // r8@10
  uintptr_t v17; // r13@12
  uintptr_t arg4; // [sp+18h] [bp-48h]@1
  __int64 v20; // [sp+20h] [bp-40h]@13
  void (__usercall *v21)(void *@<rdi>, void *@<rsi>, char@<al>, unsigned int@<edx>, unsigned int@<ecx>, __int64@<r8>, __int64@<r9>); // [sp+28h] [bp-38h]@13
  __int64 v22; // [sp+30h] [bp-30h]@13

  v6 = a6;
  arg4 = a5;
  v7 = a4;
  v8 = (signed int)a3;
  v9 = a2;
  v10 = IOUSBPipeV2::metaClass;
  v11 = OSMetaClassBase::safeMetaCast((OSMetaClassBase *)arg1, (const OSMetaClassBase *)IOUSBPipeV2::metaClass, a3);
  if ( v11 )
  {
    v12 = (*(int (__fastcall **)(__int64, _QWORD, __int64, _QWORD, _QWORD, uintptr_t))(*(_QWORD *)v11 + 608LL))(
            v11,
            0LL,
            v9,
            (unsigned int)v8,
            v7,
            arg4);
    return (unsigned int)v12;
  }
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
  {
    v10 = *(_WORD *)(arg1 + 48);
    kernel_debug(0x52D200Du, v10, *(_BYTE *)(arg1 + 32), *(_BYTE *)(arg1 + 34), arg4, 0LL);
  }
  v13 = v9;
  if ( (v8 | v7) != 0 && *(_BYTE *)(arg1 + 34) != 2
    || !v9
    || (LODWORD(v14) = (*(int (__fastcall **)(__int64, uintptr_t))(*(_QWORD *)v9 + 456LL))(v9, v10), v14 < arg4) )
  {
LABEL_25:
    v12 = -536870206;
    return (unsigned int)v12;
  }
  v12 = -536854449;
  if ( **(_DWORD **)(arg1 + 56) == -536854449 )
    return (unsigned int)v12;
  v15 = arg1 + 24;
  v16 = v6;
  if ( !v6 )
  {
    v20 = 0LL;
    v21 = IOUSBSyncCompletion;
    v22 = 0LL;
    v17 = arg1;
    v12 = (*(int (__fastcall **)(_QWORD, __int64, _QWORD, uintptr_t, __int64 *, _QWORD))(**(_QWORD **)(arg1 + 40)
                                                                                       + 2584LL))(
            *(_QWORD *)(arg1 + 40),
            v13,
            *(_WORD *)(arg1 + 48),
            v15,
            &v20,
            (unsigned int)v8);
    if ( v12 != -536870165 && v12 != -536854447 && v12 )
      **(_DWORD **)(arg1 + 56) = -536854449;
    goto LABEL_17;
  }
  if ( !*(_QWORD *)(v6 + 8) )
  {
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D200Cu, arg1, 0xFFFFFFFFE00002C2LL, 0LL, 0LL, 0LL);
    goto LABEL_25;
  }
  v17 = arg1;
  v12 = (*(int (__fastcall **)(_QWORD, __int64, _QWORD, uintptr_t, __int64, _QWORD))(**(_QWORD **)(arg1 + 40) + 2584LL))(
          *(_QWORD *)(arg1 + 40),
          v13,
          *(_WORD *)(arg1 + 48),
          v15,
          v16,
          (unsigned int)v8);
LABEL_17:
  if ( v12 == -536854449 )
    **(_DWORD **)(v17 + 56) = -536854449;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D200Eu, v17, *(_WORD *)(v17 + 48), *(_BYTE *)(v17 + 32), v12, 0LL);
  return (unsigned int)v12;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 474A0: using guessed type _QWORD IOUSBPipeV2::metaClass;
// 49460: using guessed type int gUSBStackDebugFlags;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000010FF4) ----------------------------------------------------
__int64 __fastcall IOUSBPipe::Read(uintptr_t arg1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  uintptr_t v6; // rax@1
  signed int v7; // ebx@1
  void *v8; // rdi@4
  __int64 v9; // rbx@5
  __int64 v10; // rdi@9
  __int64 v11; // rbx@9
  __int64 v12; // r9@9
  __int64 v14; // [sp+10h] [bp-20h]@10
  void (__usercall *v15)(char@<al>, int@<edx>, __int64@<rcx>, uintptr_t@<rdi>, __int64@<r8>, __int64@<r9>); // [sp+18h] [bp-18h]@10
  __int64 v16; // [sp+20h] [bp-10h]@10

  v6 = arg1;
  v7 = -536854449;
  if ( **(_DWORD **)(arg1 + 56) != -536854449 )
  {
    v7 = -536870164;
    if ( *(_WORD *)(arg1 + 36) )
    {
      if ( !a6 )
      {
        v14 = 0LL;
        v15 = IOUSBSyncIsoCompletion;
        v16 = 0LL;
        v10 = *(_QWORD *)(arg1 + 40);
        v11 = *(_QWORD *)v10;
        v12 = *(_WORD *)(v6 + 48);
LABEL_11:
        v7 = (*(int (__fastcall **)(__int64, __int64, __int64, __int64, __int64, __int64))(v11 + 2408))(
               v10,
               a2,
               a3,
               a4,
               a5,
               v12);
        return (unsigned int)v7;
      }
      v8 = *(void **)(a6 + 8);
      if ( v8 )
      {
        v9 = *(_QWORD *)(a6 + 16);
        if ( v9 && v8 == off_3B058 && *(_BYTE *)(v9 + 123) & 0x40 )
          *(_BYTE *)(v6 + 34) |= 0x80u;
        v10 = *(_QWORD *)(v6 + 40);
        v11 = *(_QWORD *)v10;
        v12 = *(_WORD *)(v6 + 48);
        goto LABEL_11;
      }
      v7 = -536870206;
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D2010u, v6, 0xFFFFFFFFE00002C2LL, 0LL, 1uLL, 0LL);
    }
  }
  return (unsigned int)v7;
}
// 3B058: using guessed type void *off_3B058;
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (00000000000110F2) ----------------------------------------------------
__int64 __fastcall IOUSBPipe::Write(uintptr_t arg1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  uintptr_t v6; // rax@1
  signed int v7; // ebx@1
  void *v8; // rdi@4
  __int64 v9; // rbx@5
  __int64 v10; // rdi@9
  __int64 v11; // rbx@9
  __int64 v12; // r9@9
  __int64 v14; // [sp+10h] [bp-20h]@10
  void (__usercall *v15)(char@<al>, int@<edx>, __int64@<rcx>, uintptr_t@<rdi>, __int64@<r8>, __int64@<r9>); // [sp+18h] [bp-18h]@10
  __int64 v16; // [sp+20h] [bp-10h]@10

  v6 = arg1;
  v7 = -536854449;
  if ( **(_DWORD **)(arg1 + 56) != -536854449 )
  {
    v7 = -536870164;
    if ( *(_WORD *)(arg1 + 36) )
    {
      if ( !a6 )
      {
        v14 = 0LL;
        v15 = IOUSBSyncIsoCompletion;
        v16 = 0LL;
        v10 = *(_QWORD *)(arg1 + 40);
        v11 = *(_QWORD *)v10;
        v12 = *(_WORD *)(v6 + 48);
LABEL_11:
        v7 = (*(int (__fastcall **)(__int64, __int64, __int64, __int64, __int64, __int64))(v11 + 2408))(
               v10,
               a2,
               a3,
               a4,
               a5,
               v12);
        return (unsigned int)v7;
      }
      v8 = *(void **)(a6 + 8);
      if ( v8 )
      {
        v9 = *(_QWORD *)(a6 + 16);
        if ( v9 && v8 == off_3B058 && *(_BYTE *)(v9 + 123) & 0x40 )
          *(_BYTE *)(v6 + 34) |= 0x80u;
        v10 = *(_QWORD *)(v6 + 40);
        v11 = *(_QWORD *)v10;
        v12 = *(_WORD *)(v6 + 48);
        goto LABEL_11;
      }
      v7 = -536870206;
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D2014u, v6, 0xFFFFFFFFE00002C2LL, 0LL, 1uLL, 0LL);
    }
  }
  return (unsigned int)v7;
}
// 3B058: using guessed type void *off_3B058;
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (00000000000111F0) ----------------------------------------------------
__int64 __fastcall IOUSBPipe::Read(uintptr_t arg1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  uintptr_t v6; // rax@1
  signed int v7; // ebx@1
  void *v8; // rdi@4
  __int64 v9; // rbx@5
  __int64 v10; // rdi@9
  __int64 v11; // rbx@9
  __int64 v12; // r9@9
  __int64 v14; // [sp+20h] [bp-20h]@10
  void (__usercall *v15)(char@<al>, int@<edx>, __int64@<rcx>, uintptr_t@<rdi>, __int64@<r8>, __int64@<r9>); // [sp+28h] [bp-18h]@10
  __int64 v16; // [sp+30h] [bp-10h]@10

  v6 = arg1;
  v7 = -536854449;
  if ( **(_DWORD **)(arg1 + 56) != -536854449 )
  {
    v7 = -536870164;
    if ( *(_WORD *)(arg1 + 36) )
    {
      if ( !a6 )
      {
        v14 = 0LL;
        v15 = IOUSBSyncIsoCompletion;
        v16 = 0LL;
        v10 = *(_QWORD *)(arg1 + 40);
        v11 = *(_QWORD *)v10;
        v12 = *(_WORD *)(v6 + 48);
LABEL_11:
        v7 = (*(int (__fastcall **)(__int64, __int64, __int64, __int64, __int64, __int64))(v11 + 2600))(
               v10,
               a2,
               a3,
               a4,
               a5,
               v12);
        return (unsigned int)v7;
      }
      v8 = *(void **)(a6 + 8);
      if ( v8 )
      {
        v9 = *(_QWORD *)(a6 + 16);
        if ( v9 && v8 == off_3B060 && *(_BYTE *)(*(_QWORD *)(v9 + 128) + 19LL) & 0x40 )
          *(_BYTE *)(v6 + 34) |= 0x80u;
        v10 = *(_QWORD *)(v6 + 40);
        v11 = *(_QWORD *)v10;
        v12 = *(_WORD *)(v6 + 48);
        goto LABEL_11;
      }
      v7 = -536870206;
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D2018u, v6, 0xFFFFFFFFE00002C2LL, 0LL, 0LL, 0LL);
    }
  }
  return (unsigned int)v7;
}
// 3B060: using guessed type void *off_3B060;
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (0000000000011304) ----------------------------------------------------
__int64 __fastcall IOUSBPipe::Write(uintptr_t arg1, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  uintptr_t v6; // rax@1
  signed int v7; // ebx@1
  void *v8; // rdi@4
  __int64 v9; // rbx@5
  __int64 v10; // rdi@9
  __int64 v11; // rbx@9
  __int64 v12; // r9@9
  __int64 v14; // [sp+20h] [bp-20h]@10
  void (__usercall *v15)(char@<al>, int@<edx>, __int64@<rcx>, uintptr_t@<rdi>, __int64@<r8>, __int64@<r9>); // [sp+28h] [bp-18h]@10
  __int64 v16; // [sp+30h] [bp-10h]@10

  v6 = arg1;
  v7 = -536854449;
  if ( **(_DWORD **)(arg1 + 56) != -536854449 )
  {
    v7 = -536870164;
    if ( *(_WORD *)(arg1 + 36) )
    {
      if ( !a6 )
      {
        v14 = 0LL;
        v15 = IOUSBSyncIsoCompletion;
        v16 = 0LL;
        v10 = *(_QWORD *)(arg1 + 40);
        v11 = *(_QWORD *)v10;
        v12 = *(_WORD *)(v6 + 48);
LABEL_11:
        v7 = (*(int (__fastcall **)(__int64, __int64, __int64, __int64, __int64, __int64))(v11 + 2600))(
               v10,
               a2,
               a3,
               a4,
               a5,
               v12);
        return (unsigned int)v7;
      }
      v8 = *(void **)(a6 + 8);
      if ( v8 )
      {
        v9 = *(_QWORD *)(a6 + 16);
        if ( v9 && v8 == off_3B060 && *(_BYTE *)(*(_QWORD *)(v9 + 128) + 19LL) & 0x40 )
          *(_BYTE *)(v6 + 34) |= 0x80u;
        v10 = *(_QWORD *)(v6 + 40);
        v11 = *(_QWORD *)v10;
        v12 = *(_WORD *)(v6 + 48);
        goto LABEL_11;
      }
      v7 = -536870206;
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D201Cu, v6, 0xFFFFFFFFE00002C2LL, 0LL, 0LL, 0LL);
    }
  }
  return (unsigned int)v7;
}
// 3B060: using guessed type void *off_3B060;
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (0000000000011418) ----------------------------------------------------
int __fastcall IOUSBPipe::ControlRequest(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r9@1
  signed __int64 v4; // rdx@1

  v3 = a3;
  v4 = 5000LL;
  if ( *(_BYTE *)(a1 + 32) )
    v4 = 0LL;
  return (*(int (__fastcall **)(__int64, __int64, signed __int64, _QWORD, __int64))(*(_QWORD *)a1 + 456LL))(
           a1,
           a2,
           v4,
           0LL,
           v3);
}

//----- (0000000000011442) ----------------------------------------------------
signed int __fastcall IOUSBPipe::ControlRequest(uintptr_t arg1, __int64 a2, unsigned int a3, __int64 a4, __int64 a5)
{
  __int64 v5; // r14@1
  __int64 v6; // r9@1
  uintptr_t v7; // r12@1
  signed int result; // eax@1
  __int64 v9; // rdi@2
  unsigned int v10; // er13@3
  __int16 v11; // ax@3
  __int64 v12; // rdi@12
  __int64 v13; // rax@12
  __int64 v14; // r8@12
  __int64 v15; // rcx@12
  __int64 *v16; // rdx@12
  __int64 v17; // [sp+10h] [bp-40h]@13
  void (__usercall *v18)(void *@<rdi>, void *@<rsi>, char@<al>, unsigned int@<edx>, unsigned int@<ecx>, __int64@<r8>, __int64@<r9>); // [sp+18h] [bp-38h]@13
  __int64 v19; // [sp+20h] [bp-30h]@13

  v5 = a5;
  v6 = a3;
  v7 = arg1;
  result = -536870206;
  if ( a2 )
  {
    v9 = *(_QWORD *)(*(_QWORD *)(arg1 + 56) + 8LL);
    if ( v9 )
    {
      v10 = a3;
      v11 = (*(int (**)(void))(*(_QWORD *)v9 + 2288LL))();
      v6 = v10;
      if ( v11 == 1452
        && *(_BYTE *)a2 == 64
        && *(_BYTE *)(a2 + 1) == 64
        && !*(_WORD *)(a2 + 6)
        && gUSBStackDebugFlags & 2
        && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        kernel_debug(
          0x52D2024u,
          v7,
          *(_DWORD *)(*(_QWORD *)(*(_QWORD *)(*(_QWORD *)(v7 + 56) + 8LL) + 232LL) + 172LL),
          *(_WORD *)(a2 + 2) | (*(_WORD *)(a2 + 4) << 16),
          1uLL,
          0LL);
        v6 = v10;
      }
    }
    if ( !v5 )
    {
      *(_DWORD *)(a2 + 16) = *(_WORD *)(a2 + 6) | ((*(_DWORD *)(a2 + 16) == 0x40000000) << 30);
      v17 = 0LL;
      v18 = IOUSBSyncCompletion;
      v19 = a2 + 16;
      v12 = *(_QWORD *)(v7 + 40);
      v13 = *(_QWORD *)v12;
      v14 = *(_BYTE *)(v7 + 32);
      v15 = *(_WORD *)(v7 + 48);
      v16 = &v17;
      return (*(int (__fastcall **)(__int64, __int64, __int64 *, __int64, __int64, __int64))(v13 + 2528))(
               v12,
               a2,
               v16,
               v15,
               v14,
               v6);
    }
    if ( *(_QWORD *)(v5 + 8) )
    {
      v12 = *(_QWORD *)(v7 + 40);
      v13 = *(_QWORD *)v12;
      v14 = *(_BYTE *)(v7 + 32);
      v15 = *(_WORD *)(v7 + 48);
      v16 = (__int64 *)v5;
      return (*(int (__fastcall **)(__int64, __int64, __int64 *, __int64, __int64, __int64))(v13 + 2528))(
               v12,
               a2,
               v16,
               v15,
               v14,
               v6);
    }
    if ( gUSBStackDebugFlags & 2 )
    {
      if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D2028u, v7, 0xFFFFFFFFE00002C2LL, 0LL, 2uLL, 0LL);
    }
    result = -536870206;
  }
  return result;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (00000000000115EE) ----------------------------------------------------
int __fastcall IOUSBPipe::ControlRequest(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r9@1
  signed __int64 v4; // rdx@1

  v3 = a3;
  v4 = 5000LL;
  if ( *(_BYTE *)(a1 + 32) )
    v4 = 0LL;
  return (*(int (__fastcall **)(__int64, __int64, signed __int64, _QWORD, __int64))(*(_QWORD *)a1 + 448LL))(
           a1,
           a2,
           v4,
           0LL,
           v3);
}

//----- (0000000000011618) ----------------------------------------------------
signed int __fastcall IOUSBPipe::ControlRequest(uintptr_t arg1, __int64 a2, unsigned int a3, __int64 a4, __int64 a5)
{
  __int64 v5; // r14@1
  __int64 v6; // r9@1
  uintptr_t v7; // r12@1
  signed int result; // eax@1
  __int64 v9; // rdi@2
  unsigned int v10; // er13@3
  __int16 v11; // ax@3
  __int64 v12; // rdi@12
  __int64 v13; // rax@12
  __int64 v14; // r8@12
  __int64 v15; // rcx@12
  __int64 *v16; // rdx@12
  __int64 v17; // [sp+10h] [bp-40h]@13
  void (__usercall *v18)(void *@<rdi>, void *@<rsi>, char@<al>, unsigned int@<edx>, unsigned int@<ecx>, __int64@<r8>, __int64@<r9>); // [sp+18h] [bp-38h]@13
  __int64 v19; // [sp+20h] [bp-30h]@13

  v5 = a5;
  v6 = a3;
  v7 = arg1;
  result = -536870206;
  if ( a2 )
  {
    v9 = *(_QWORD *)(*(_QWORD *)(arg1 + 56) + 8LL);
    if ( v9 )
    {
      v10 = a3;
      v11 = (*(int (**)(void))(*(_QWORD *)v9 + 2288LL))();
      v6 = v10;
      if ( v11 == 1452
        && *(_BYTE *)a2 == 64
        && *(_BYTE *)(a2 + 1) == 64
        && !*(_WORD *)(a2 + 6)
        && gUSBStackDebugFlags & 2
        && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        kernel_debug(
          0x52D2024u,
          v7,
          *(_DWORD *)(*(_QWORD *)(*(_QWORD *)(*(_QWORD *)(v7 + 56) + 8LL) + 232LL) + 172LL),
          *(_WORD *)(a2 + 2) | (*(_WORD *)(a2 + 4) << 16),
          2uLL,
          0LL);
        v6 = v10;
      }
    }
    if ( !v5 )
    {
      *(_DWORD *)(a2 + 16) = *(_WORD *)(a2 + 6) | ((*(_DWORD *)(a2 + 16) == 0x40000000) << 30);
      v17 = 0LL;
      v18 = IOUSBSyncCompletion;
      v19 = a2 + 16;
      v12 = *(_QWORD *)(v7 + 40);
      v13 = *(_QWORD *)v12;
      v14 = *(_BYTE *)(v7 + 32);
      v15 = *(_WORD *)(v7 + 48);
      v16 = &v17;
      return (*(int (__fastcall **)(__int64, __int64, __int64 *, __int64, __int64, __int64))(v13 + 2536))(
               v12,
               a2,
               v16,
               v15,
               v14,
               v6);
    }
    if ( *(_QWORD *)(v5 + 8) )
    {
      v12 = *(_QWORD *)(v7 + 40);
      v13 = *(_QWORD *)v12;
      v14 = *(_BYTE *)(v7 + 32);
      v15 = *(_WORD *)(v7 + 48);
      v16 = (__int64 *)v5;
      return (*(int (__fastcall **)(__int64, __int64, __int64 *, __int64, __int64, __int64))(v13 + 2536))(
               v12,
               a2,
               v16,
               v15,
               v14,
               v6);
    }
    if ( gUSBStackDebugFlags & 2 )
    {
      if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D2028u, v7, 0xFFFFFFFFE00002C2LL, 0LL, 1uLL, 0LL);
    }
    result = -536870206;
  }
  return result;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (00000000000117C4) ----------------------------------------------------
char *__fastcall IOUSBPipe::GetEndpoint(IOUSBPipe *this)
{
  return (char *)this + 24;
}

//----- (00000000000117CE) ----------------------------------------------------
__int64 __fastcall IOUSBPipe::GetEndpointDescriptor(IOUSBPipe *this)
{
  return *((_QWORD *)this + 2);
}

//----- (00000000000117D8) ----------------------------------------------------
__int64 __fastcall IOUSBPipe::GetDirection(IOUSBPipe *this)
{
  return *((_BYTE *)this + 33);
}

//----- (00000000000117E2) ----------------------------------------------------
__int64 __fastcall IOUSBPipe::GetType(IOUSBPipe *this)
{
  return *((_BYTE *)this + 34);
}

//----- (00000000000117EC) ----------------------------------------------------
__int64 __fastcall IOUSBPipe::GetEndpointNumber(IOUSBPipe *this)
{
  return *((_BYTE *)this + 32);
}

//----- (00000000000117F6) ----------------------------------------------------
__int64 __fastcall IOUSBPipe::GetAddress(IOUSBPipe *this)
{
  return *((_WORD *)this + 24);
}

//----- (0000000000011800) ----------------------------------------------------
__int64 __fastcall IOUSBPipe::GetMaxPacketSize(IOUSBPipe *this)
{
  return *((_WORD *)this + 18);
}

//----- (000000000001180A) ----------------------------------------------------
__int64 __fastcall IOUSBPipe::GetInterval(IOUSBPipe *this)
{
  return *((_BYTE *)this + 38);
}

//----- (0000000000011814) ----------------------------------------------------
__int64 __fastcall IOUSBPipe::GetStatus(IOUSBPipe *this)
{
  return 0LL;
}

//----- (000000000001181C) ----------------------------------------------------
__int64 __fastcall IOUSBPipe::GetPipeStatus(IOUSBPipe *this)
{
  return **((_DWORD **)this + 7);
}

//----- (0000000000011828) ----------------------------------------------------
__int64 __fastcall IOUSBPipe::GetUsageType(IOUSBPipe *this)
{
  __int64 v1; // rcx@1
  signed __int64 v2; // rdx@1
  signed __int64 v3; // rcx@1

  v1 = *((_QWORD *)this + 7);
  v2 = v1 + 40;
  v3 = v1 + 41;
  if ( *((_BYTE *)this + 34) == 2 )
    v3 = v2;
  return *(_BYTE *)v3;
}

//----- (0000000000011848) ----------------------------------------------------
__int64 __fastcall IOUSBPipe::GetSyncType(IOUSBPipe *this)
{
  return *(_BYTE *)(*((_QWORD *)this + 7) + 42LL);
}

//----- (0000000000011856) ----------------------------------------------------
__int64 IOUSBPipe::InitToEndpoint()
{
  return 0LL;
}

//----- (000000000001185E) ----------------------------------------------------
__int64 IOUSBPipe::ToEndpoint()
{
  return 0LL;
}

//----- (0000000000011866) ----------------------------------------------------
__int64 IOUSBPipe::ToEndpoint()
{
  return 0LL;
}

//----- (000000000001186E) ----------------------------------------------------
__int64 __fastcall IOUSBPipe::_RESERVEDIOUSBPipe15(IOUSBPipe *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBPipe::gMetaClass, 15);
}
// 49660: using guessed type _QWORD IOUSBPipe::gMetaClass;

//----- (0000000000011884) ----------------------------------------------------
__int64 __fastcall IOUSBPipe::_RESERVEDIOUSBPipe16(IOUSBPipe *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBPipe::gMetaClass, 16);
}
// 49660: using guessed type _QWORD IOUSBPipe::gMetaClass;

//----- (000000000001189A) ----------------------------------------------------
__int64 __fastcall IOUSBPipe::_RESERVEDIOUSBPipe17(IOUSBPipe *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBPipe::gMetaClass, 17);
}
// 49660: using guessed type _QWORD IOUSBPipe::gMetaClass;

//----- (00000000000118B0) ----------------------------------------------------
__int64 __fastcall IOUSBPipe::_RESERVEDIOUSBPipe18(IOUSBPipe *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBPipe::gMetaClass, 18);
}
// 49660: using guessed type _QWORD IOUSBPipe::gMetaClass;

//----- (00000000000118C6) ----------------------------------------------------
__int64 __fastcall IOUSBPipe::_RESERVEDIOUSBPipe19(IOUSBPipe *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBPipe::gMetaClass, 19);
}
// 49660: using guessed type _QWORD IOUSBPipe::gMetaClass;

//----- (00000000000118DC) ----------------------------------------------------
__int64 __fastcall IOUSBPipe::MetaClass::~MetaClass(IOUSBPipe::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (00000000000118F0) ----------------------------------------------------
__int64 `global constructor keyed to'_a_3()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(&IOUSBPipe::gMetaClass, "IOUSBPipe", off_3B080[0], 64LL);
  result = (__int64)off_3DE50;
  IOUSBPipe::gMetaClass = off_3DE50;
  return result;
}
// 3B080: using guessed type _QWORD off_3B080[18];
// 3DE50: using guessed type __int64 (__fastcall *off_3DE50[2])(IOUSBPipe::MetaClass *__hidden this);
// 49660: using guessed type _QWORD IOUSBPipe::gMetaClass;
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000011930) ----------------------------------------------------
__int64 `global destructor keyed to'_a_3()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&IOUSBPipe::gMetaClass);
}
// 49660: using guessed type _QWORD IOUSBPipe::gMetaClass;

//----- (0000000000011950) ----------------------------------------------------
__int64 __fastcall IOUSBRootHubDevice::MetaClass::MetaClass(IOUSBRootHubDevice::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBRootHubDevice", &IOUSBHubDevice::gMetaClass, 288LL);
  result = (__int64)off_3EA50;
  *(_QWORD *)this = off_3EA50;
  return result;
}
// 3EA50: using guessed type __int64 (__fastcall *off_3EA50[2])(IOUSBRootHubDevice::MetaClass *__hidden this);
// 498A8: using guessed type _QWORD IOUSBHubDevice::gMetaClass;
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000011982) ----------------------------------------------------
__int64 __fastcall IOUSBRootHubDevice::MetaClass::~MetaClass(IOUSBRootHubDevice::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000001198C) ----------------------------------------------------
__int64 __fastcall IOUSBRootHubDevice::IOUSBRootHubDevice(__int64 a1)
{
  __int64 result; // rax@1

  IOUSBHubDevice::IOUSBHubDevice(a1);
  result = (__int64)off_3DF50;
  *(_QWORD *)a1 = off_3DF50;
  return result;
}
// 3DF50: using guessed type __int64 (__fastcall *off_3DF50[2])(IOUSBRootHubDevice *__hidden this);

//----- (00000000000119AC) ----------------------------------------------------
__int64 __fastcall IOUSBRootHubDevice::IOUSBRootHubDevice(__int64 a1)
{
  __int64 result; // rax@1

  IOUSBHubDevice::IOUSBHubDevice(a1);
  result = (__int64)off_3DF50;
  *(_QWORD *)a1 = off_3DF50;
  return result;
}
// 3DF50: using guessed type __int64 (__fastcall *off_3DF50[2])(IOUSBRootHubDevice *__hidden this);

//----- (00000000000119CC) ----------------------------------------------------
__int64 __fastcall IOUSBRootHubDevice::~IOUSBRootHubDevice(IOUSBRootHubDevice *this)
{
  return IOUSBHubDevice::~IOUSBHubDevice(this);
}

//----- (00000000000119D6) ----------------------------------------------------
__int64 __fastcall IOUSBRootHubDevice::~IOUSBRootHubDevice(IOUSBRootHubDevice *this)
{
  return IOUSBHubDevice::~IOUSBHubDevice(this);
}

//----- (00000000000119E0) ----------------------------------------------------
void __fastcall IOUSBRootHubDevice::~IOUSBRootHubDevice(IOUSBRootHubDevice *this)
{
  IOUSBHubDevice::~IOUSBHubDevice(this);
  OSObject::operator delete((void *)this);
}

//----- (0000000000011A02) ----------------------------------------------------
__int64 __fastcall IOUSBRootHubDevice::getMetaClass(IOUSBRootHubDevice *this)
{
  return (__int64)&IOUSBRootHubDevice::gMetaClass;
}
// 49698: using guessed type _QWORD IOUSBRootHubDevice::gMetaClass;

//----- (0000000000011A10) ----------------------------------------------------
__int64 __fastcall IOUSBRootHubDevice::MetaClass::MetaClass(IOUSBRootHubDevice::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBRootHubDevice", &IOUSBHubDevice::gMetaClass, 288LL);
  result = (__int64)off_3EA50;
  *(_QWORD *)this = off_3EA50;
  return result;
}
// 3EA50: using guessed type __int64 (__fastcall *off_3EA50[2])(IOUSBRootHubDevice::MetaClass *__hidden this);
// 498A8: using guessed type _QWORD IOUSBHubDevice::gMetaClass;
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000011A42) ----------------------------------------------------
__int64 __fastcall IOUSBRootHubDevice::MetaClass::alloc(IOUSBRootHubDevice::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&stru_108.segname[8], a2);
  IOUSBHubDevice::IOUSBHubDevice(v2);
  *(_QWORD *)v2 = off_3DF50;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBRootHubDevice::gMetaClass);
  return v2;
}
// 108: using guessed type section_64 stru_108;
// 3DF50: using guessed type __int64 (__fastcall *off_3DF50[2])(IOUSBRootHubDevice *__hidden this);
// 49698: using guessed type _QWORD IOUSBRootHubDevice::gMetaClass;

//----- (0000000000011A82) ----------------------------------------------------
__int64 __fastcall IOUSBRootHubDevice::IOUSBRootHubDevice(__int64 a1)
{
  IOUSBHubDevice::IOUSBHubDevice(a1);
  *(_QWORD *)a1 = off_3DF50;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBRootHubDevice::gMetaClass);
}
// 3DF50: using guessed type __int64 (__fastcall *off_3DF50[2])(IOUSBRootHubDevice *__hidden this);
// 49698: using guessed type _QWORD IOUSBRootHubDevice::gMetaClass;

//----- (0000000000011AB2) ----------------------------------------------------
__int64 __fastcall IOUSBRootHubDevice::IOUSBRootHubDevice(__int64 a1)
{
  IOUSBHubDevice::IOUSBHubDevice(a1);
  *(_QWORD *)a1 = off_3DF50;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBRootHubDevice::gMetaClass);
}
// 3DF50: using guessed type __int64 (__fastcall *off_3DF50[2])(IOUSBRootHubDevice *__hidden this);
// 49698: using guessed type _QWORD IOUSBRootHubDevice::gMetaClass;

//----- (0000000000011AE2) ----------------------------------------------------
__int64 __fastcall IOUSBRootHubDevice::NewRootHubDevice(IOUSBRootHubDevice *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 result; // rax@1
  bool v4; // zf@2

  v2 = OSObject::operator new((OSObject *)&stru_108.segname[8], a2);
  IOUSBHubDevice::IOUSBHubDevice(v2);
  *(_QWORD *)v2 = off_3DF50;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBRootHubDevice::gMetaClass);
  result = 0LL;
  if ( v2 )
  {
    v4 = (unsigned __int8)(*(int (__fastcall **)(__int64, _QWORD *))(*(_QWORD *)v2 + 136LL))(
                            v2,
                            &IOUSBRootHubDevice::gMetaClass) == 0;
    result = v2;
    if ( v4 )
    {
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 40LL))(v2);
      result = 0LL;
    }
  }
  return result;
}
// 108: using guessed type section_64 stru_108;
// 3DF50: using guessed type __int64 (__fastcall *off_3DF50[2])(IOUSBRootHubDevice *__hidden this);
// 49698: using guessed type _QWORD IOUSBRootHubDevice::gMetaClass;

//----- (0000000000011B44) ----------------------------------------------------
char __fastcall IOUSBRootHubDevice::init(IOUSBRootHubDevice *this)
{
  char v1; // r14@2
  void *v2; // rax@3

  if ( !(unsigned __int8)((int (*)(void))`vtable for'IOUSBHubDevice[19])() )
    goto LABEL_5;
  v1 = 1;
  if ( !*((_QWORD *)this + 35) )
  {
    LODWORD(v2) = IOMalloc(16LL);
    *((_QWORD *)this + 35) = v2;
    if ( v2 )
    {
      bzero(v2, 0x10uLL);
      return v1;
    }
LABEL_5:
    v1 = 0;
  }
  return v1;
}
// 42D40: using guessed type __int64 `vtable for'IOUSBHubDevice[2];
// 7D250: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (0000000000011B9C) ----------------------------------------------------
char __fastcall IOUSBRootHubDevice::InitializeCharacteristics(IOUSBRootHubDevice *this)
{
  int v1; // er15@1

  v1 = 2 * ((unsigned __int8)(*(int (__cdecl **)(IOUSBRootHubDevice *))(*(_QWORD *)this + 2256LL))(this) == 2) + 1;
  (*(int (__cdecl **)(_QWORD))(*(_QWORD *)this + 2256LL))(this);
  (*(void (__fastcall **)(IOUSBRootHubDevice *))(*(_QWORD *)this + 2592LL))(this);
  return 1;
}

//----- (0000000000011BF8) ----------------------------------------------------
char __fastcall IOUSBRootHubDevice::start(IOUSBRootHubDevice *this, IOService *a2, const OSMetaClass *a3)
{
  IOService *v3; // r14@1
  IOUSBRootHubDevice *v4; // rbx@1
  OSMetaClassBase *v5; // rax@1
  const OSMetaClass *v6; // rdx@1
  __int64 v7; // rax@2
  __int64 v8; // rcx@2
  int v9; // edx@3
  int v10; // ecx@4
  __int64 v11; // rcx@5
  __int64 v12; // rsi@5
  OSMetaClassBase *v13; // rax@9
  OSMetaClassBase *v14; // r15@9
  __int64 v15; // rsi@9
  const OSMetaClass *v16; // rdx@9
  __int64 v17; // rax@9
  int v18; // eax@10
  OSMetaClassBase *v19; // rax@14
  const OSMetaClass *v20; // rdx@14
  __int64 v21; // rax@14
  __int64 v22; // rax@16
  char result; // al@17
  __int64 v24; // rcx@19
  __int64 v25; // rdi@22

  v3 = a2;
  v4 = this;
  v5 = (OSMetaClassBase *)OSMetaClassBase::safeMetaCast(a2, (const OSMetaClassBase *)IOUSBController::metaClass, a3);
  *((_QWORD *)this + 18) = v5;
  if ( v5 )
  {
    v7 = OSMetaClassBase::safeMetaCast(v5, (const OSMetaClassBase *)IOUSBControllerV3::metaClass, v6);
    v8 = *((_QWORD *)this + 35);
    if ( !v7 )
    {
      *(_BYTE *)(v8 + 8) = 2;
      goto LABEL_13;
    }
    v9 = *(_BYTE *)(*(_QWORD *)(v7 + 168) + 40LL);
    *(_BYTE *)(v8 + 8) = v9;
    if ( v9 != 3 )
      goto LABEL_13;
    v10 = *((_BYTE *)this + 184);
    if ( v10 == 2 )
    {
      v11 = *(_QWORD *)v7;
      v12 = (__int64)"HS_StartRange";
    }
    else
    {
      if ( (unsigned __int8)v10 != 3 )
        goto LABEL_13;
      v11 = *(_QWORD *)v7;
      v12 = (__int64)"SS_StartRange";
    }
    LODWORD(v13) = (*(int (__fastcall **)(__int64, __int64))(v11 + 744))(v7, v12);
    v14 = v13;
    v15 = *(_QWORD *)off_3B078[0];
    v17 = OSMetaClassBase::safeMetaCast(v13, *(const OSMetaClassBase **)off_3B078[0], v16);
    if ( v17 )
    {
      v18 = (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v17 + 328LL))(v17, v15);
      v15 = (__int64)"PortNumberOffset";
      (*(void (__fastcall **)(IOUSBRootHubDevice *, _QWORD, _QWORD, signed __int64))(*(_QWORD *)this + 640LL))(
        this,
        "PortNumberOffset",
        (unsigned int)(v18 - 1),
        32LL);
    }
    if ( v14 )
      (*(void (__fastcall **)(OSMetaClassBase *, __int64))(*(_QWORD *)v14 + 40LL))(v14, v15);
  }
LABEL_13:
  if ( (unsigned __int8)((int (__fastcall *)(IOUSBRootHubDevice *, IOService *))`vtable for'IOUSBHubDevice[186])(
                          this,
                          v3) )
  {
    LODWORD(v19) = (*(int (__fastcall **)(IOService *, _QWORD))(*(_QWORD *)v3 + 696LL))(v3, "Card Type");
    v21 = OSMetaClassBase::safeMetaCast(v19, *(const OSMetaClassBase **)off_3B088[0], v20);
    if ( v21 && (unsigned __int8)(*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v21 + 344LL))(v21, "Built-in") )
    {
      v22 = *((_QWORD *)this + 35);
      *(_BYTE *)(v22 + 9) = 1;
      *(_BYTE *)(v22 + 10) = 1;
    }
    else
    {
      v22 = *((_QWORD *)this + 35);
      *(_BYTE *)(v22 + 9) = 0;
      *(_BYTE *)(v22 + 10) = 0;
    }
    v24 = *((_QWORD *)this + 29);
    if ( *(_BYTE *)(v24 + 209) )
    {
      if ( *(_BYTE *)(*(_QWORD *)(*(_QWORD *)(v24 + 216) + 672LL) + 344LL) )
        *(_BYTE *)(v22 + 9) = 1;
    }
    v25 = *(_QWORD *)(v24 + 104);
    *((_QWORD *)v4 + 34) = v25;
    (*(void (__cdecl **)(__int64))(*(_QWORD *)v25 + 32LL))(v25);
    result = 1;
  }
  else
  {
    result = 0;
  }
  return result;
}
// 3B078: using guessed type _QWORD off_3B078[19];
// 3B088: using guessed type _QWORD off_3B088[17];
// 3BBF8: using guessed type _QWORD IOUSBController::metaClass;
// 42D40: using guessed type __int64 `vtable for'IOUSBHubDevice[2];
// 44350: using guessed type _QWORD IOUSBControllerV3::metaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000011DAE) ----------------------------------------------------
void __fastcall IOUSBRootHubDevice::stop(IOUSBRootHubDevice *this, IOService *a2)
{
  IOUSBRootHubDevice *v2; // rbx@1
  __int64 v3; // rdi@1

  v2 = this;
  v3 = *((_QWORD *)this + 34);
  if ( v3 )
  {
    (*(void (**)(void))(*(_QWORD *)v3 + 40LL))();
    *((_QWORD *)v2 + 34) = 0LL;
  }
  JUMPOUT(__CS__, `vtable for'IOUSBHubDevice[187]);
}
// 42D40: using guessed type __int64 `vtable for'IOUSBHubDevice[2];

//----- (0000000000011DF0) ----------------------------------------------------
void __fastcall IOUSBRootHubDevice::free(IOUSBRootHubDevice *this)
{
  IOUSBRootHubDevice *v1; // rbx@1
  __int64 v2; // rdi@1

  v1 = this;
  v2 = *((_QWORD *)this + 35);
  if ( v2 )
  {
    IOFree(v2, 16LL);
    *((_QWORD *)v1 + 35) = 0LL;
  }
  JUMPOUT(__CS__, `vtable for'IOUSBHubDevice[20]);
}
// 42D40: using guessed type __int64 `vtable for'IOUSBHubDevice[2];
// 7D218: using guessed type int __fastcall IOFree(_QWORD, _QWORD);

//----- (0000000000011E30) ----------------------------------------------------
__int64 __fastcall IOUSBRootHubDevice::GatedDeviceRequest(IOUSBRootHubDevice *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  __int64 result; // rax@2

  if ( this )
    result = IOUSBRootHubDevice::DeviceRequestWorker((__int64)this, (__int64)a2);
  else
    result = 3758097133LL;
  return result;
}

//----- (0000000000011E46) ----------------------------------------------------
__int64 __fastcall IOUSBRootHubDevice::DeviceRequestWorker(__int64 a1, __int64 a2)
{
  int v2; // er14@1
  int v3; // eax@2
  int v4; // eax@4
  __int64 v5; // rax@21
  __int64 v6; // rdi@24
  __int64 v7; // rax@41
  int v8; // eax@46
  signed int v9; // eax@50
  __int64 v10; // r12@53
  unsigned __int16 v11; // ax@55
  const void *v12; // rax@57
  __int64 v13; // rdi@58
  int v14; // er15@70
  unsigned __int16 v15; // ax@72
  const void *v16; // rax@74
  int v17; // eax@81
  __int64 v18; // rax@82
  signed int v19; // er13@86
  int v20; // eax@90
  unsigned int v21; // ecx@90
  __int64 v22; // rax@101
  unsigned __int16 v23; // ax@116
  __int16 v24; // ax@117
  unsigned __int16 v25; // cx@117
  unsigned __int16 v26; // ax@124
  __int16 v27; // ax@125
  unsigned __int16 v28; // cx@125
  int v30; // [sp+8h] [bp-38h]@87

  v2 = -536870206;
  if ( !a2 )
    return (unsigned int)v2;
  v3 = *(_DWORD *)(a2 + 16);
  if ( v3 & 0x40000000 )
    *(_DWORD *)(a2 + 16) = v3 & 0xBFFFFFFF;
  v4 = (*(_BYTE *)(a2 + 1) << 8) | *(_BYTE *)a2;
  if ( v4 > 3490 )
  {
    if ( v4 != 3491 )
      goto LABEL_130;
    v6 = *(_QWORD *)(*(_QWORD *)(a1 + 232) + 216LL);
    if ( v6 && !*(_WORD *)(a2 + 2) && *(_WORD *)(a2 + 6) == 2 )
    {
      v2 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD))(*(_QWORD *)v6 + 3320LL))(
             v6,
             *(_WORD *)(a2 + 4),
             *(_QWORD *)(a2 + 8));
      *(_DWORD *)(a2 + 16) = 2;
    }
    return (unsigned int)v2;
  }
  if ( v4 > 3201 )
  {
    if ( v4 != 3202 )
      goto LABEL_130;
    goto LABEL_121;
  }
  if ( v4 > 3103 )
  {
    v2 = 0;
    if ( v4 == 3104 )
      return (unsigned int)v2;
    goto LABEL_130;
  }
  if ( v4 > 2816 )
  {
    if ( v4 != 2817 )
      goto LABEL_130;
    goto LABEL_121;
  }
  if ( v4 > 2688 )
  {
    if ( v4 != 2689 )
      goto LABEL_130;
    goto LABEL_121;
  }
  if ( v4 > 2303 )
  {
    if ( v4 != 2304 )
      goto LABEL_130;
    if ( !*(_WORD *)(a2 + 4) )
    {
      *(_WORD *)(a1 + 264) = *(_WORD *)(a2 + 2);
      v2 = 0;
    }
    return (unsigned int)v2;
  }
  if ( v4 > 2175 )
  {
    if ( v4 != 2176 )
      goto LABEL_130;
    if ( !*(_WORD *)(a2 + 4) )
    {
      v7 = *(_QWORD *)(a2 + 8);
      if ( v7 )
      {
        *(_BYTE *)v7 = *(_BYTE *)(a1 + 264);
        *(_DWORD *)(a2 + 16) = 1;
        v2 = 0;
      }
    }
    return (unsigned int)v2;
  }
  if ( v4 > 1791 )
  {
    if ( v4 != 1792 )
      goto LABEL_130;
    goto LABEL_121;
  }
  if ( v4 > 1695 )
  {
    if ( v4 != 1696 )
      goto LABEL_130;
    v8 = *(_WORD *)(a2 + 2);
    if ( v8 == 10496 && *(_QWORD *)(a2 + 8) )
    {
      v2 = (*(int (**)(void))(**(_QWORD **)(a1 + 144) + 2264LL))();
      *(_DWORD *)(a2 + 16) = 25;
    }
    else
    {
      v13 = *(_QWORD *)(*(_QWORD *)(a1 + 232) + 216LL);
      if ( v13 && (unsigned __int16)v8 == 10752 && *(_QWORD *)(a2 + 8) )
      {
        v2 = (*(int (**)(void))(*(_QWORD *)v13 + 3200LL))();
        *(_DWORD *)(a2 + 16) = 28;
      }
    }
    return (unsigned int)v2;
  }
  if ( v4 > 1663 )
  {
    if ( v4 != 1664 )
      goto LABEL_130;
    v9 = *(_BYTE *)(a2 + 3);
    if ( v9 > 14 )
    {
      if ( v9 != 15 )
        return (unsigned int)v2;
      v2 = -536870201;
      if ( !*(_QWORD *)(*(_QWORD *)(a1 + 232) + 216LL) )
        return (unsigned int)v2;
      v10 = OSData::withCapacity((OSData *)&stru_3D0.filesize, a2);
      v2 = (*(int (__fastcall **)(_QWORD, __int64))(**(_QWORD **)(*(_QWORD *)(a1 + 232) + 216LL) + 3192LL))(
             *(_QWORD *)(*(_QWORD *)(a1 + 232) + 216LL),
             v10);
      v14 = 0;
      if ( !v2 && (*(int (__fastcall **)(__int64))(*(_QWORD *)v10 + 320LL))(v10) )
      {
        v15 = (*(int (__fastcall **)(__int64))(*(_QWORD *)v10 + 320LL))(v10);
        if ( v15 < (unsigned int)*(_WORD *)(a2 + 6) )
          *(_WORD *)(a2 + 6) = v15;
        LODWORD(v16) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v10 + 376LL))(v10);
        bcopy(v16, *(void **)(a2 + 8), *(_WORD *)(a2 + 6));
        v14 = *(_WORD *)(a2 + 6);
      }
      *(_DWORD *)(a2 + 16) = v14;
    }
    else
    {
      if ( v9 == 1 )
      {
        v18 = *(_QWORD *)(a2 + 8);
        if ( *(_BYTE *)(*(_QWORD *)(a1 + 280) + 8LL) == 3 )
          *(_DWORD *)v18 = *(_BYTE *)(a1 + 184) & 3;
        v2 = (*(int (__fastcall **)(_QWORD, __int64))(**(_QWORD **)(a1 + 144) + 2256LL))(*(_QWORD *)(a1 + 144), v18);
        *(_DWORD *)(a2 + 16) = 18;
        return (unsigned int)v2;
      }
      if ( v9 == 2 )
      {
        v10 = OSData::withCapacity((OSData *)&stru_3D0.filesize, a2);
        v2 = (*(int (__fastcall **)(_QWORD, __int64))(**(_QWORD **)(a1 + 144) + 2280LL))(*(_QWORD *)(a1 + 144), v10);
        if ( v2 || !(*(int (__fastcall **)(__int64))(*(_QWORD *)v10 + 320LL))(v10) )
          goto LABEL_94;
        v11 = (*(int (__fastcall **)(_QWORD))(*(_QWORD *)v10 + 320LL))(v10);
        if ( v11 < (unsigned int)*(_WORD *)(a2 + 6) )
          *(_WORD *)(a2 + 6) = v11;
        LODWORD(v12) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v10 + 376LL))(v10);
        goto LABEL_93;
      }
      if ( v9 != 3 )
        return (unsigned int)v2;
      v10 = OSData::withCapacity((OSData *)&stru_3D0.filesize, a2);
      v19 = 0;
      if ( *(_BYTE *)(*(_QWORD *)(a1 + 280) + 8LL) == 3 )
      {
        v30 = *(_BYTE *)(a1 + 184) & 3;
        v19 = 4;
        (*(void (__fastcall **)(__int64, int *, signed __int64))(*(_QWORD *)v10 + 360LL))(v10, &v30, 4LL);
      }
      v2 = (*(int (__fastcall **)(_QWORD, _QWORD, __int64))(**(_QWORD **)(a1 + 144) + 2592LL))(
             *(_QWORD *)(a1 + 144),
             *(_BYTE *)(a2 + 2),
             v10);
      if ( !v2 && (*(int (__fastcall **)(_QWORD))(*(_QWORD *)v10 + 320LL))(v10) )
      {
        v20 = (*(int (__fastcall **)(_QWORD))(*(_QWORD *)v10 + 320LL))(v10) - v19;
        v21 = *(_WORD *)(a2 + 6);
        if ( (unsigned __int16)v20 < v21 )
        {
          *(_WORD *)(a2 + 6) = v20;
          LOWORD(v21) = v20;
        }
        LODWORD(v12) = (*(int (__fastcall **)(__int64, _QWORD, _QWORD))(*(_QWORD *)v10 + 384LL))(
                         v10,
                         (unsigned int)v19,
                         (unsigned __int16)v21);
LABEL_93:
        bcopy(v12, *(void **)(a2 + 8), *(_WORD *)(a2 + 6));
        *(_DWORD *)(a2 + 16) = *(_WORD *)(a2 + 6);
        goto LABEL_94;
      }
    }
LABEL_94:
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v10 + 40LL))(v10);
    return (unsigned int)v2;
  }
  if ( v4 > 1567 )
  {
    if ( v4 != 1568 )
      goto LABEL_130;
    if ( *(_QWORD *)(a2 + 8) )
      v2 = (*(int (**)(void))(**(_QWORD **)(a1 + 144) + 2272LL))();
  }
  else if ( v4 > 1279 )
  {
    if ( v4 != 1280 )
      goto LABEL_130;
    if ( !*(_WORD *)(a2 + 4) )
      v2 = (*(int (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(a1 + 144) + 2344LL))(
             *(_QWORD *)(a1 + 144),
             *(_WORD *)(a2 + 2));
  }
  else
  {
    if ( v4 <= 159 )
    {
      if ( (unsigned int)(v4 - 129) >= 2 )
      {
        if ( v4 == 128 )
        {
          if ( !*(_WORD *)(a2 + 2) && !*(_WORD *)(a2 + 4) )
          {
            v5 = *(_QWORD *)(a2 + 8);
            if ( v5 )
            {
              *(_WORD *)v5 = 1;
              *(_DWORD *)(a2 + 16) = 2;
              v2 = 0;
            }
          }
          return (unsigned int)v2;
        }
LABEL_130:
        v2 = -536870206;
        return (unsigned int)v2;
      }
LABEL_121:
      v2 = -536870201;
      return (unsigned int)v2;
    }
    if ( v4 <= 255 )
    {
      if ( v4 == 160 )
      {
        if ( *(_WORD *)(a2 + 2) || *(_WORD *)(a2 + 4) || !*(_QWORD *)(a2 + 8) )
          return (unsigned int)v2;
        v17 = (*(int (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(a1 + 144) + 2288LL))(
                *(_QWORD *)(a1 + 144),
                *(_QWORD *)(a2 + 8));
      }
      else
      {
        if ( v4 != 163 )
          goto LABEL_130;
        if ( *(_WORD *)(a2 + 2) )
          return (unsigned int)v2;
        v22 = *(_QWORD *)(a2 + 8);
        if ( !v22 )
          return (unsigned int)v2;
        if ( *(_BYTE *)(*(_QWORD *)(a1 + 280) + 8LL) == 3 )
          *(_DWORD *)v22 = *(_BYTE *)(a1 + 184) & 3;
        v17 = (*(int (__fastcall **)(_QWORD, __int64, _QWORD))(**(_QWORD **)(a1 + 144) + 2312LL))(
                *(_QWORD *)(a1 + 144),
                v22,
                *(_WORD *)(a2 + 4));
      }
      v2 = v17;
      *(_DWORD *)(a2 + 16) = 4;
      return (unsigned int)v2;
    }
    if ( v4 <= 287 )
    {
      if ( (unsigned int)(v4 - 257) < 2 )
        goto LABEL_121;
      if ( v4 != 256 )
        goto LABEL_130;
      goto LABEL_108;
    }
    if ( v4 > 674 )
    {
      if ( v4 > 767 )
      {
        if ( v4 > 799 )
        {
          if ( v4 != 800 )
          {
            if ( v4 != 803 )
              goto LABEL_130;
            v26 = *(_WORD *)(a2 + 2);
            if ( *(_BYTE *)(*(_QWORD *)(a1 + 280) + 8LL) == 3 )
            {
              v27 = v26 << 8;
              v28 = v27 | *(_BYTE *)(a1 + 184) & 3;
              *(_WORD *)(a2 + 2) = v27 | *(_BYTE *)(a1 + 184) & 3;
              v26 = v28;
            }
            v2 = (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD))(**(_QWORD **)(a1 + 144) + 2320LL))(
                   *(_QWORD *)(a1 + 144),
                   v26,
                   *(_WORD *)(a2 + 4));
            return (unsigned int)v2;
          }
        }
        else
        {
          if ( (unsigned int)(v4 - 769) < 2 )
            goto LABEL_121;
          if ( v4 != 768 )
            goto LABEL_130;
        }
        if ( !*(_WORD *)(a2 + 4) )
          v2 = (*(int (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(a1 + 144) + 2296LL))(
                 *(_QWORD *)(a1 + 144),
                 *(_WORD *)(a2 + 2));
        return (unsigned int)v2;
      }
      if ( v4 != 675 )
        goto LABEL_130;
      if ( !*(_WORD *)(a2 + 2) && *(_QWORD *)(a2 + 8) )
      {
        v2 = (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD))(**(_QWORD **)(a1 + 144) + 2336LL))(
               *(_QWORD *)(a1 + 144),
               *(_QWORD *)(a2 + 8),
               *(_WORD *)(a2 + 4));
        *(_DWORD *)(a2 + 16) = 1;
      }
    }
    else
    {
      if ( v4 == 288 )
      {
LABEL_108:
        if ( !*(_WORD *)(a2 + 4) )
          v2 = (*(int (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(a1 + 144) + 2304LL))(
                 *(_QWORD *)(a1 + 144),
                 *(_WORD *)(a2 + 2));
        return (unsigned int)v2;
      }
      if ( v4 != 291 )
        goto LABEL_130;
      v23 = *(_WORD *)(a2 + 2);
      if ( *(_BYTE *)(*(_QWORD *)(a1 + 280) + 8LL) == 3 )
      {
        v24 = v23 << 8;
        v25 = v24 | *(_BYTE *)(a1 + 184) & 3;
        *(_WORD *)(a2 + 2) = v24 | *(_BYTE *)(a1 + 184) & 3;
        v23 = v25;
      }
      v2 = (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD))(**(_QWORD **)(a1 + 144) + 2328LL))(
             *(_QWORD *)(a1 + 144),
             v23,
             *(_WORD *)(a2 + 4));
    }
  }
  return (unsigned int)v2;
}
// 3D0: using guessed type segment_command_64;

//----- (000000000001268A) ----------------------------------------------------
int __fastcall IOUSBRootHubDevice::DeviceRequest(__int64 a1, __int64 a2, __int64 a3)
{
  return (*(int (__fastcall **)(__int64, __int64, _QWORD, _QWORD, __int64))(*(_QWORD *)a1 + 2424LL))(
           a1,
           a2,
           0LL,
           0LL,
           a3);
}

//----- (00000000000126A2) ----------------------------------------------------
signed __int64 __fastcall IOUSBRootHubDevice::DeviceRequest(__int64 a1, __int64 a2, unsigned int a3, unsigned int a4, __int64 a5)
{
  unsigned int v5; // er12@1
  unsigned int v6; // er14@1
  __int64 v7; // rbx@1
  __int64 v8; // rax@2
  __int64 v9; // r13@3
  __int64 v10; // r15@4
  IOService *v11; // rdi@5
  IOService *v12; // rdi@6
  int v13; // er14@8
  signed __int64 result; // rax@8
  __int64 v15; // [sp+10h] [bp-30h]@1

  v15 = a5;
  v5 = a4;
  v6 = a3;
  v7 = a1;
  if ( !(unsigned __int8)IOService::isInactive((IOService *)a1)
    && (v8 = *(_QWORD *)(a1 + 232)) != 0
    && (v9 = *(_QWORD *)(v8 + 104)) != 0
    && (v10 = *(_QWORD *)(v8 + 80)) != 0 )
  {
    (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v10 + 32LL))(v10);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v9 + 32LL))(v9);
    v11 = *(IOService **)(a1 + 248);
    if ( v11 )
    {
      IOService::getPowerState(v11);
      v12 = *(IOService **)(v7 + 248);
      if ( v12 )
        IOService::getPowerState(v12);
    }
    v13 = (*(int (__fastcall **)(__int64, __int64 (__fastcall *)(IOUSBRootHubDevice *__hidden, OSObject *, void *, void *, void *, void *), __int64, _QWORD, _QWORD, __int64))(*(_QWORD *)v9 + 456LL))(
            v9,
            IOUSBRootHubDevice::GatedDeviceRequest,
            a2,
            v6,
            v5,
            v15);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v9 + 40LL))(v9);
    (*(void (**)(void))(*(_QWORD *)v10 + 40LL))();
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v7 + 40LL))(v7);
    result = (unsigned int)v13;
  }
  else
  {
    result = 3758097133LL;
  }
  return result;
}

//----- (0000000000012794) ----------------------------------------------------
char __fastcall IOUSBRootHubDevice::IsRootHub(IOUSBRootHubDevice *this)
{
  return 1;
}

//----- (000000000001279C) ----------------------------------------------------
__int64 __fastcall IOUSBRootHubDevice::RequestExtraPower(IOUSBRootHubDevice *this, signed __int64 a2, int a3)
{
  int v3; // er14@1
  __int64 v4; // rax@1
  unsigned int v5; // ebx@1
  __int64 v6; // rcx@9
  __int64 v7; // r8@9
  __int64 v8; // r9@9
  __int64 v9; // rax@12
  int v11; // [sp+Ch] [bp-34h]@9
  __int64 v12; // [sp+10h] [bp-30h]@10
  bool v13; // [sp+1Fh] [bp-21h]@1

  v3 = a3;
  v13 = 0;
  v4 = *((_QWORD *)this + 35);
  v5 = 0;
  if ( v4 && *(_BYTE *)(v4 + 9) )
  {
    if ( (unsigned int)(a2 - 6) >= 2 )
    {
      if ( !(_DWORD)a2 )
        return (*(int (__fastcall **)(IOUSBRootHubDevice *, _QWORD))(*(_QWORD *)this + 2664LL))(this, (unsigned int)a3);
      if ( (_DWORD)a2 != 1 )
      {
        if ( (a2 & 0xFFFFFFFE) != 4 )
          return v5;
        v9 = *(_QWORD *)this;
        a2 = (unsigned int)a2;
LABEL_15:
        (*(void (__fastcall **)(IOUSBRootHubDevice *, signed __int64, _QWORD))(v9 + 2704))(this, a2, (unsigned int)v3);
        return v5;
      }
    }
    v5 = IOUSBRootHubDevice::RequestExtraWakePower(this, a2, a3, &v13);
    if ( v13 && !v5 )
    {
      v11 = 0;
      (*(void (__fastcall **)(IOUSBRootHubDevice *, signed __int64, _QWORD))(*(_QWORD *)this + 2704LL))(
        this,
        2LL,
        (unsigned int)v3);
      if ( (unsigned __int8)(*(int (**)(void))(**(_QWORD **)(*((_QWORD *)this + 29) + 80LL) + 312LL))() )
      {
        clock_interval_to_deadline(100LL, 1000000LL, &v12, v6, v7, v8);
        (*(void (__fastcall **)(_QWORD, int *, __int64, signed __int64))(**((_QWORD **)this + 34) + 496LL))(
          *((_QWORD *)this + 34),
          &v11,
          v12,
          2LL);
      }
      else
      {
        IOSleep(100LL);
      }
      v13 = 0;
      v5 = IOUSBRootHubDevice::RequestExtraWakePower(this, a2, v3, &v13);
      v9 = *(_QWORD *)this;
      a2 = 4LL;
      goto LABEL_15;
    }
  }
  return v5;
}
// 7D278: using guessed type int __fastcall IOSleep(_QWORD);
// 7E178: using guessed type int __fastcall clock_interval_to_deadline(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000128F0) ----------------------------------------------------
__int64 __fastcall IOUSBRootHubDevice::RequestExtraWakePower(IOUSBRootHubDevice *this, int a2, int a3, bool *a4)
{
  int v4; // er14@1
  int v5; // er15@1
  __int64 v6; // rbx@1
  __int64 v7; // rax@1
  int v8; // er13@1
  __int64 v9; // rax@4
  __int64 v10; // rax@5
  unsigned int v11; // er14@5
  int v12; // er13@5
  int v13; // ebx@5
  int v14; // eax@5
  OSMetaClassBase *v15; // rax@6
  OSMetaClassBase *v16; // rbx@6
  const OSMetaClassBase *v17; // r14@6
  const OSMetaClass *v18; // rdx@6
  __int64 v19; // rax@6
  int v20; // ecx@6
  OSMetaClassBase *v21; // rax@10
  OSMetaClassBase *v22; // r15@10
  const OSMetaClass *v23; // rdx@10
  __int64 v24; // rax@10
  OSMetaClassBase *v25; // rax@14
  OSMetaClassBase *v26; // r15@14
  const OSMetaClass *v27; // rdx@14
  __int64 v28; // rax@14
  int v29; // ecx@14
  int v30; // ecx@19
  int v31; // eax@23
  __int64 v32; // rcx@31
  __int64 v33; // r14@32
  int v34; // ebx@35
  __int64 v35; // rax@35
  IOUSBControllerV3 *v36; // rdi@38
  int v38; // [sp+8h] [bp-48h]@8
  __int64 v39; // [sp+10h] [bp-40h]@4
  int v40; // [sp+1Ch] [bp-34h]@5
  bool *v41; // [sp+20h] [bp-30h]@1

  v41 = a4;
  v4 = a3;
  v5 = a2;
  v6 = IOService::getResourceService(this);
  v7 = *((_QWORD *)this + 35);
  v8 = 0;
  if ( v7 && *(_BYTE *)(v7 + 9) )
  {
    IOLockLock(qword_49690);
    if ( !*((_QWORD *)this + 35) )
    {
LABEL_40:
      IOLockUnlock(qword_49690);
      return (unsigned int)v8;
    }
    v39 = v6;
    v9 = *((_QWORD *)this + 29);
    if ( *(_BYTE *)(v9 + 209) )
    {
      v40 = v4;
      v10 = *(_QWORD *)(*(_QWORD *)(v9 + 216) + 672LL);
      v11 = *(_DWORD *)(v10 + 304);
      v12 = *(_DWORD *)(v10 + 312);
      v13 = *(_DWORD *)(v10 + 328);
      v14 = (unsigned __int64)IOUSBHubDevice::UpdateUnconnectedExternalPorts(this, 0)
          - *(_DWORD *)(*(_QWORD *)(*(_QWORD *)(*((_QWORD *)this + 29) + 216LL) + 672LL) + 332LL);
    }
    else
    {
      v40 = v4;
      LODWORD(v15) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v6 + 744LL))(v6, "AAPL,current-extra");
      v16 = v15;
      v17 = *(const OSMetaClassBase **)off_3B078[0];
      v19 = OSMetaClassBase::safeMetaCast(v15, *(const OSMetaClassBase **)off_3B078[0], v18);
      v20 = 0;
      if ( v19 )
        v20 = (*(int (__fastcall **)(__int64))(*(_QWORD *)v19 + 328LL))(v19);
      v38 = v20;
      if ( v16 )
        (*(void (__fastcall **)(OSMetaClassBase *))(*(_QWORD *)v16 + 40LL))(v16);
      LODWORD(v21) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v39 + 744LL))(v39, "AAPL,current-available");
      v22 = v21;
      v24 = OSMetaClassBase::safeMetaCast(v21, v17, v23);
      v12 = 0;
      if ( v24 )
        v12 = (*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v24 + 328LL))(v24, v17);
      if ( v22 )
        (*(void (__fastcall **)(OSMetaClassBase *, const OSMetaClassBase *))(*(_QWORD *)v22 + 40LL))(v22, v17);
      LODWORD(v25) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v39 + 744LL))(
                       v39,
                       "AAPL,revocable-extra-current");
      v26 = v25;
      v28 = OSMetaClassBase::safeMetaCast(v25, v17, v27);
      v29 = 0;
      if ( v28 )
        v29 = (*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v28 + 328LL))(v28, v17);
      v13 = v29;
      if ( v26 )
        (*(void (__fastcall **)(OSMetaClassBase *, const OSMetaClassBase *))(*(_QWORD *)v26 + 40LL))(v26, v17);
      v14 = IOUSBHubDevice::UpdateUnconnectedExternalPorts(this, 0)
          - IOUSBController::gExternalNonSSPortsUsingExtraCurrent;
      v5 = a2;
      v11 = v38;
    }
    v30 = 400 * v14;
    if ( v14 < 0 )
      v30 = 0;
    v8 = v12 - 500;
    if ( v8 >= (unsigned int)v40 )
      v8 = v40;
    v31 = v11 - v8;
    if ( v11 >= v8 )
    {
      if ( v5 != 1 || v13 + v11 - v8 >= v30 )
      {
        v32 = *((_QWORD *)this + 29);
        if ( *(_BYTE *)(v32 + 209) )
        {
          *(_DWORD *)(*(_QWORD *)(*(_QWORD *)(v32 + 216) + 672LL) + 304LL) = v31;
          v33 = v39;
        }
        else
        {
          v33 = v39;
          (*(void (__fastcall **)(__int64, _QWORD, _QWORD, signed __int64))(*(_QWORD *)v39 + 640LL))(
            v39,
            "AAPL,current-extra",
            (unsigned int)v31,
            32LL);
        }
        if ( v5 == 6 )
        {
          v34 = v8 + v13;
          v35 = *((_QWORD *)this + 29);
          if ( *(_BYTE *)(v35 + 209) )
            *(_DWORD *)(*(_QWORD *)(*(_QWORD *)(v35 + 216) + 672LL) + 328LL) = v34;
          else
            (*(void (__fastcall **)(__int64, _QWORD, _QWORD, signed __int64))(*(_QWORD *)v33 + 640LL))(
              v33,
              "AAPL,revocable-extra-current",
              (unsigned int)v34,
              32LL);
        }
        goto LABEL_38;
      }
      *v41 = 0;
    }
    else if ( v5 != 6 && v8 <= v11 + v13 )
    {
      *v41 = 1;
    }
    v8 = 0;
LABEL_38:
    v36 = *(IOUSBControllerV3 **)(*((_QWORD *)this + 29) + 216LL);
    if ( v36 )
      IOUSBControllerV3::UpdateThunderboltExtraCurrentiVars(v36);
    goto LABEL_40;
  }
  return (unsigned int)v8;
}
// 3B078: using guessed type _QWORD off_3B078[19];
// 49584: using guessed type _QWORD IOUSBController::gExternalNonSSPortsUsingExtraCurrent;
// 49690: using guessed type __int64 qword_49690;
// 7D230: using guessed type int __fastcall IOLockLock(_QWORD);
// 7D238: using guessed type int __fastcall IOLockUnlock(_QWORD);
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000012BE4) ----------------------------------------------------
__int64 __fastcall IOUSBRootHubDevice::ReturnExtraPower(IOUSBRootHubDevice *this, int a2, int a3)
{
  __int64 v3; // rcx@1
  __int64 result; // rax@1

  v3 = *((_QWORD *)this + 35);
  result = 0LL;
  if ( v3 && *(_BYTE *)(v3 + 9) )
  {
    if ( (unsigned int)(a2 - 6) < 2 )
      goto LABEL_14;
    if ( !a2 )
    {
      (*(void (__fastcall **)(IOUSBRootHubDevice *, _QWORD))(*(_QWORD *)this + 2672LL))(this, (unsigned int)a3);
      return 0LL;
    }
    if ( a2 == 1 )
    {
LABEL_14:
      IOUSBRootHubDevice::ReturnExtraWakePower(this, a2, a3);
      return 0LL;
    }
    result = 3758097090LL;
    if ( (a2 & 0xFFFFFFFE) == 2 )
    {
      (*(void (**)(void))(*(_QWORD *)this + 2704LL))();
      return 0LL;
    }
  }
  return result;
}

//----- (0000000000012C3E) ----------------------------------------------------
int __fastcall IOUSBRootHubDevice::ReturnExtraWakePower(IOUSBRootHubDevice *this, int a2, int a3)
{
  int v3; // er15@1
  int v4; // er12@1
  __int64 v5; // r14@1
  __int64 v6; // rax@1
  int v7; // er13@4
  __int64 v8; // rax@4
  __int64 v9; // rax@5
  int v10; // ecx@5
  OSMetaClassBase *v11; // rax@7
  OSMetaClassBase *v12; // r12@7
  const OSMetaClass *v13; // rdx@7
  __int64 v14; // rax@7
  OSMetaClassBase *v15; // rax@11
  OSMetaClassBase *v16; // r12@11
  const OSMetaClassBase *v17; // rsi@11
  const OSMetaClass *v18; // rdx@11
  __int64 v19; // rax@11
  int v20; // ecx@11
  int v21; // er13@17
  __int64 v22; // rax@17
  __int64 v23; // rdx@19
  int v24; // er13@19
  int v25; // ecx@21
  __int64 v26; // rax@21
  IOUSBControllerV3 *v27; // rdi@24
  int v29; // [sp+Ch] [bp-34h]@7
  const OSMetaClassBase *v30; // [sp+10h] [bp-30h]@7
  int v31; // [sp+10h] [bp-30h]@13

  v3 = a3;
  v4 = a2;
  v5 = IOService::getResourceService(this);
  v6 = *((_QWORD *)this + 35);
  if ( v6 && *(_BYTE *)(v6 + 9) )
  {
    IOLockLock(qword_49690);
    if ( *((_QWORD *)this + 35) )
    {
      v7 = 0;
      IOUSBHubDevice::UpdateUnconnectedExternalPorts(this, 0);
      v8 = *((_QWORD *)this + 29);
      if ( *(_BYTE *)(v8 + 209) )
      {
        v9 = *(_QWORD *)(*(_QWORD *)(v8 + 216) + 672LL);
        v7 = *(_DWORD *)(v9 + 304);
        v10 = *(_DWORD *)(v9 + 328);
      }
      else
      {
        v29 = a2;
        LODWORD(v11) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v5 + 744LL))(v5, "AAPL,current-extra");
        v12 = v11;
        v30 = *(const OSMetaClassBase **)off_3B078[0];
        v14 = OSMetaClassBase::safeMetaCast(v11, *(const OSMetaClassBase **)off_3B078[0], v13);
        if ( v14 )
          v7 = (*(int (__fastcall **)(__int64))(*(_QWORD *)v14 + 328LL))(v14);
        if ( v12 )
          (*(void (__fastcall **)(OSMetaClassBase *))(*(_QWORD *)v12 + 40LL))(v12);
        LODWORD(v15) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v5 + 744LL))(
                         v5,
                         "AAPL,revocable-extra-current");
        v16 = v15;
        v17 = v30;
        v19 = OSMetaClassBase::safeMetaCast(v15, v30, v18);
        v20 = 0;
        if ( v19 )
          v20 = (*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v19 + 328LL))(v19, v30);
        v31 = v20;
        if ( v16 )
          (*(void (__fastcall **)(OSMetaClassBase *, const OSMetaClassBase *))(*(_QWORD *)v16 + 40LL))(v16, v17);
        v4 = v29;
        v10 = v31;
      }
      if ( v3 )
      {
        v21 = v3 + v7;
        v22 = *((_QWORD *)this + 29);
        if ( *(_BYTE *)(v22 + 209) )
        {
          *(_DWORD *)(*(_QWORD *)(*(_QWORD *)(v22 + 216) + 672LL) + 304LL) = v21;
        }
        else
        {
          v23 = (unsigned int)v21;
          v24 = v10;
          (*(void (__fastcall **)(__int64, _QWORD, __int64, signed __int64))(*(_QWORD *)v5 + 640LL))(
            v5,
            "AAPL,current-extra",
            v23,
            32LL);
          v10 = v24;
        }
        if ( v4 == 6 )
        {
          v25 = v10 - v3;
          v26 = *((_QWORD *)this + 29);
          if ( *(_BYTE *)(v26 + 209) )
            *(_DWORD *)(*(_QWORD *)(*(_QWORD *)(v26 + 216) + 672LL) + 328LL) = v25;
          else
            (*(void (__fastcall **)(__int64, _QWORD, _QWORD, signed __int64))(*(_QWORD *)v5 + 640LL))(
              v5,
              "AAPL,revocable-extra-current",
              (unsigned int)v25,
              32LL);
        }
      }
      v27 = *(IOUSBControllerV3 **)(*((_QWORD *)this + 29) + 216LL);
      if ( v27 )
        IOUSBControllerV3::UpdateThunderboltExtraCurrentiVars(v27);
    }
    LODWORD(v6) = IOLockUnlock(qword_49690);
  }
  return v6;
}
// 3B078: using guessed type _QWORD off_3B078[19];
// 49690: using guessed type __int64 qword_49690;
// 7D230: using guessed type int __fastcall IOLockLock(_QWORD);
// 7D238: using guessed type int __fastcall IOLockUnlock(_QWORD);
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000012E4A) ----------------------------------------------------
void __fastcall IOUSBRootHubDevice::InitializeExtraPower(IOUSBRootHubDevice *this)
{
  ;
}

//----- (0000000000012E50) ----------------------------------------------------
void __fastcall IOUSBRootHubDevice::SetSleepCurrent(IOUSBRootHubDevice *this)
{
  JUMPOUT(__CS__, `vtable for'IOUSBHubDevice[337]);
}
// 42D40: using guessed type __int64 `vtable for'IOUSBHubDevice[2];

//----- (0000000000012E62) ----------------------------------------------------
void __fastcall IOUSBRootHubDevice::GetSleepCurrent(IOUSBRootHubDevice *this)
{
  JUMPOUT(__CS__, `vtable for'IOUSBHubDevice[338]);
}
// 42D40: using guessed type __int64 `vtable for'IOUSBHubDevice[2];

//----- (0000000000012E74) ----------------------------------------------------
__int64 __fastcall IOUSBRootHubDevice::RequestSleepPower(IOUSBRootHubDevice *this, int a2)
{
  int v2; // er14@1
  IOUSBRootHubDevice *v3; // r13@1
  __int64 v4; // r15@1
  __int64 v5; // rax@1
  int v6; // ebx@1
  unsigned int v7; // eax@4
  __int64 v8; // rax@7
  __int64 v9; // rax@8
  int v10; // er12@8
  int v11; // ebx@8
  OSMetaClassBase *v12; // rax@11
  OSMetaClassBase *v13; // rbx@11
  const OSMetaClass *v14; // rdx@11
  __int64 v15; // rax@11
  OSMetaClassBase *v16; // rax@15
  const OSMetaClass *v17; // rdx@15
  __int64 v18; // rax@15
  int v19; // er14@21
  int v20; // ebx@21
  bool v21; // cf@21
  int v22; // er12@21
  __int64 v23; // rax@22
  IOUSBControllerV3 *v24; // rdi@26
  OSMetaClassBase *v26; // [sp+8h] [bp-38h]@15
  const OSMetaClassBase *v27; // [sp+10h] [bp-30h]@11

  v2 = a2;
  v3 = this;
  v4 = IOService::getResourceService(this);
  v5 = *((_QWORD *)this + 35);
  v6 = 0;
  if ( v5 )
  {
    if ( *(_BYTE *)(v5 + 9) )
    {
      if ( a2 )
      {
        v7 = *(_DWORD *)(*((_QWORD *)this + 32) + 40LL);
        if ( v7 )
        {
          if ( v7 >= a2 )
          {
            v6 = a2;
          }
          else
          {
            IOLockLock(qword_49690);
            if ( *((_QWORD *)this + 35) )
            {
              v8 = *((_QWORD *)this + 29);
              if ( *(_BYTE *)(v8 + 209) )
              {
                v9 = *(_QWORD *)(*(_QWORD *)(v8 + 216) + 672LL);
                v10 = *(_DWORD *)(v9 + 308);
                v11 = *(_DWORD *)(v9 + 316);
              }
              else
              {
                LODWORD(v12) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v4 + 744LL))(
                                 v4,
                                 "AAPL,current-extra-in-sleep");
                v13 = v12;
                v27 = *(const OSMetaClassBase **)off_3B078[0];
                v15 = OSMetaClassBase::safeMetaCast(v12, *(const OSMetaClassBase **)off_3B078[0], v14);
                v10 = 0;
                if ( v15 )
                  v10 = (*(int (__fastcall **)(__int64))(*(_QWORD *)v15 + 328LL))(v15);
                if ( v13 )
                  (*(void (__fastcall **)(OSMetaClassBase *))(*(_QWORD *)v13 + 40LL))(v13);
                LODWORD(v16) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v4 + 744LL))(
                                 v4,
                                 "AAPL,max-port-current-in-sleep");
                v26 = v16;
                v18 = OSMetaClassBase::safeMetaCast(v16, v27, v17);
                v11 = 0;
                if ( v18 )
                  v11 = (*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v18 + 328LL))(v18, v27);
                if ( v26 )
                  (*(void (__fastcall **)(OSMetaClassBase *, const OSMetaClassBase *))(*(_QWORD *)v26 + 40LL))(v26, v27);
              }
              if ( v11 < (unsigned int)a2 )
                v2 = v11;
              v19 = v2 - *(_DWORD *)(*((_QWORD *)this + 32) + 40LL);
              v20 = 0;
              v21 = v10 < (unsigned int)v19;
              v22 = v10 - v19;
              if ( !v21 )
              {
                v23 = *((_QWORD *)this + 29);
                if ( *(_BYTE *)(v23 + 209) )
                  *(_DWORD *)(*(_QWORD *)(*(_QWORD *)(v23 + 216) + 672LL) + 308LL) = v22;
                else
                  (*(void (__fastcall **)(__int64, _QWORD, _QWORD, signed __int64))(*(_QWORD *)v4 + 640LL))(
                    v4,
                    "AAPL,current-extra-in-sleep",
                    (unsigned int)v22,
                    32LL);
                v20 = v19;
              }
              v24 = *(IOUSBControllerV3 **)(*((_QWORD *)this + 29) + 216LL);
              if ( v24 )
                IOUSBControllerV3::UpdateThunderboltExtraCurrentiVars(v24);
              IOLockUnlock(qword_49690);
              v6 = *(_DWORD *)(*((_QWORD *)v3 + 32) + 40LL) + v20;
            }
            else
            {
              IOLockUnlock(qword_49690);
            }
          }
        }
      }
    }
  }
  return (unsigned int)v6;
}
// 3B078: using guessed type _QWORD off_3B078[19];
// 49690: using guessed type __int64 qword_49690;
// 7D230: using guessed type int __fastcall IOLockLock(_QWORD);
// 7D238: using guessed type int __fastcall IOLockUnlock(_QWORD);
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000013064) ----------------------------------------------------
int __fastcall IOUSBRootHubDevice::ReturnSleepPower(IOUSBRootHubDevice *this, unsigned int a2)
{
  unsigned int v2; // er15@1
  __int64 v3; // r14@1
  __int64 v4; // rax@1
  __int64 v5; // rax@4
  int v6; // er12@5
  OSMetaClassBase *v7; // rax@7
  OSMetaClassBase *v8; // r13@7
  __int64 v9; // rsi@7
  const OSMetaClass *v10; // rdx@7
  __int64 v11; // rax@7
  unsigned int v12; // eax@11
  int v13; // er15@12
  __int64 v14; // rax@12
  IOUSBControllerV3 *v15; // rdi@15

  v2 = a2;
  v3 = IOService::getResourceService(this);
  v4 = *((_QWORD *)this + 35);
  if ( v4 && *(_BYTE *)(v4 + 9) )
  {
    IOLockLock(qword_49690);
    if ( *((_QWORD *)this + 35) )
    {
      v5 = *((_QWORD *)this + 29);
      if ( *(_BYTE *)(v5 + 209) )
      {
        v6 = *(_DWORD *)(*(_QWORD *)(*(_QWORD *)(v5 + 216) + 672LL) + 308LL);
      }
      else
      {
        LODWORD(v7) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v3 + 744LL))(
                        v3,
                        "AAPL,current-extra-in-sleep");
        v8 = v7;
        v9 = *(_QWORD *)off_3B078[0];
        v11 = OSMetaClassBase::safeMetaCast(v7, *(const OSMetaClassBase **)off_3B078[0], v10);
        v6 = 0;
        if ( v11 )
          v6 = (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v11 + 328LL))(v11, v9);
        if ( v8 )
          (*(void (__fastcall **)(OSMetaClassBase *, __int64))(*(_QWORD *)v8 + 40LL))(v8, v9);
      }
      v12 = *(_DWORD *)(*((_QWORD *)this + 32) + 40LL);
      if ( v12 < v2 )
      {
        v13 = v6 + v2 - v12;
        v14 = *((_QWORD *)this + 29);
        if ( *(_BYTE *)(v14 + 209) )
          *(_DWORD *)(*(_QWORD *)(*(_QWORD *)(v14 + 216) + 672LL) + 308LL) = v13;
        else
          (*(void (__fastcall **)(__int64, _QWORD, _QWORD, signed __int64))(*(_QWORD *)v3 + 640LL))(
            v3,
            "AAPL,current-extra-in-sleep",
            (unsigned int)v13,
            32LL);
      }
      v15 = *(IOUSBControllerV3 **)(*((_QWORD *)this + 29) + 216LL);
      if ( v15 )
        IOUSBControllerV3::UpdateThunderboltExtraCurrentiVars(v15);
    }
    LODWORD(v4) = IOLockUnlock(qword_49690);
  }
  return v4;
}
// 3B078: using guessed type _QWORD off_3B078[19];
// 49690: using guessed type __int64 qword_49690;
// 7D230: using guessed type int __fastcall IOLockLock(_QWORD);
// 7D238: using guessed type int __fastcall IOLockUnlock(_QWORD);
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (00000000000131BA) ----------------------------------------------------
__int64 __fastcall IOUSBRootHubDevice::GetDeviceInformation(IOUSBRootHubDevice *this, unsigned int *a2)
{
  __int64 v2; // rcx@1
  __int64 result; // rax@1
  bool v4; // zf@2
  unsigned int v5; // ecx@2

  *a2 = 0;
  v2 = *((_QWORD *)this + 35);
  result = 3758097088LL;
  if ( v2 )
  {
    v4 = *(_BYTE *)(v2 + 10) == 0;
    v5 = 1565;
    if ( v4 )
      v5 = 541;
    *a2 = v5;
    result = 0LL;
    if ( *(_BYTE *)(*((_QWORD *)this + 29) + 209LL) )
      *a2 = v5 | 0x2000;
  }
  return result;
}

//----- (0000000000013204) ----------------------------------------------------
int __fastcall IOUSBRootHubDevice::SendExtraPowerMessage(IOUSBRootHubDevice *this, int a2, OSDictionary *a3)
{
  IOService *v3; // rax@2
  IOService *v4; // r14@3
  __int64 v5; // rbx@4
  __int64 v6; // rax@5
  __int64 v7; // rbx@6
  __int64 v8; // rax@6
  __int64 v9; // rax@6
  __int64 v10; // r14@6
  OSMetaClassBase *v11; // rax@9
  const OSMetaClass *v12; // rdx@9
  __int64 v13; // rax@10
  IOService *v15; // [sp+10h] [bp-40h]@5
  __int64 v16; // [sp+18h] [bp-38h]@4
  int v17; // [sp+24h] [bp-2Ch]@1

  v17 = (signed int)a3;
  if ( a2 == 4 )
  {
    LODWORD(v3) = (*(int (__fastcall **)(IOUSBRootHubDevice *, signed __int64, _QWORD, _QWORD))(*(_QWORD *)this + 1856LL))(
                    this,
                    3758112792LL,
                    0LL,
                    0LL);
  }
  else
  {
    v3 = (IOService *)IOService::serviceMatching("IOUSBRootHubDevice", 0LL, a3);
    v4 = v3;
    if ( v3 )
    {
      v5 = IOService::getMatchingServices(v3, 0LL);
      v16 = v5;
      if ( v5 )
      {
        v15 = v4;
        for ( LODWORD(v6) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v5 + 296LL))(v5);
              v6;
              LODWORD(v6) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v16 + 296LL))(v16) )
        {
          v7 = off_3B0E8[0];
          LODWORD(v8) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v6 + 792LL))(v6, *(_QWORD *)off_3B0E8[0]);
          LODWORD(v9) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v8 + 800LL))(v8, *(_QWORD *)v7);
          v10 = v9;
          if ( v9 )
          {
            while ( 1 )
            {
              LODWORD(v11) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v10 + 296LL))(v10);
              if ( !v11 )
                break;
              v13 = OSMetaClassBase::safeMetaCast(v11, (const OSMetaClassBase *)IOUSBDevice::metaClass, v12);
              if ( v13 && a2 == 2 )
                (*(void (__fastcall **)(__int64, signed __int64, int *, signed __int64))(*(_QWORD *)v13 + 1856LL))(
                  v13,
                  3758112791LL,
                  &v17,
                  4LL);
            }
            (*(void (__fastcall **)(__int64))(*(_QWORD *)v10 + 40LL))(v10);
          }
          v5 = v16;
        }
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v5 + 40LL))(v5);
        v4 = v15;
      }
      LODWORD(v3) = (*(int (__fastcall **)(IOService *))(*(_QWORD *)v4 + 40LL))(v4);
    }
  }
  return (signed int)v3;
}
// 3B0E8: using guessed type __int64 off_3B0E8[5];
// 3F498: using guessed type _QWORD IOUSBDevice::metaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000001334C) ----------------------------------------------------
__int64 __fastcall IOUSBRootHubDevice::MetaClass::~MetaClass(IOUSBRootHubDevice::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000013360) ----------------------------------------------------
__int64 `global constructor keyed to'_a_4()
{
  __int64 result; // rax@1

  IOUSBController_ExtraCurrentIOLockClass::IOUSBController_ExtraCurrentIOLockClass((__int64)&gExtraCurrentIOLockClass);
  OSMetaClass::OSMetaClass(&IOUSBRootHubDevice::gMetaClass, "IOUSBRootHubDevice", &IOUSBHubDevice::gMetaClass, 288LL);
  result = (__int64)off_3EA50;
  IOUSBRootHubDevice::gMetaClass = off_3EA50;
  return result;
}
// 3EA50: using guessed type __int64 (__fastcall *off_3EA50[2])(IOUSBRootHubDevice::MetaClass *__hidden this);
// 49688: using guessed type __int64 gExtraCurrentIOLockClass;
// 49698: using guessed type _QWORD IOUSBRootHubDevice::gMetaClass;
// 498A8: using guessed type _QWORD IOUSBHubDevice::gMetaClass;
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000133A0) ----------------------------------------------------
int `global destructor keyed to'_a_4()
{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOUSBRootHubDevice::gMetaClass);
  return IOUSBController_ExtraCurrentIOLockClass::~IOUSBController_ExtraCurrentIOLockClass((IOUSBController_ExtraCurrentIOLockClass *)&gExtraCurrentIOLockClass);
}
// 49688: using guessed type __int64 gExtraCurrentIOLockClass;
// 49698: using guessed type _QWORD IOUSBRootHubDevice::gMetaClass;

//----- (00000000000133C0) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::MetaClass::MetaClass(IOUSBCommand::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBCommand", off_3B090[0], 224LL);
  result = (__int64)off_3EC80;
  *(_QWORD *)this = off_3EC80;
  return result;
}
// 3B090: using guessed type _QWORD off_3B090[16];
// 3EC80: using guessed type __int64 (__fastcall *off_3EC80[2])(IOUSBCommand::MetaClass *__hidden this);
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000133F2) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::MetaClass::~MetaClass(IOUSBCommand::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (00000000000133FC) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::IOUSBCommand(IOCommand *a1, const OSMetaClass *a2)
{
  __int64 result; // rax@1

  IOCommand::IOCommand(a1, a2);
  result = (__int64)off_3EB50;
  *(_QWORD *)a1 = off_3EB50;
  return result;
}
// 3EB50: using guessed type __int64 (__fastcall *off_3EB50[2])(IOUSBCommand *__hidden this);

//----- (000000000001341C) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::IOUSBCommand(IOCommand *a1, const OSMetaClass *a2)
{
  __int64 result; // rax@1

  IOCommand::IOCommand(a1, a2);
  result = (__int64)off_3EB50;
  *(_QWORD *)a1 = off_3EB50;
  return result;
}
// 3EB50: using guessed type __int64 (__fastcall *off_3EB50[2])(IOUSBCommand *__hidden this);

//----- (000000000001343C) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::~IOUSBCommand(IOUSBCommand *this)
{
  return IOCommand::~IOCommand(this);
}

//----- (0000000000013446) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::~IOUSBCommand(IOUSBCommand *this)
{
  return IOCommand::~IOCommand(this);
}

//----- (0000000000013450) ----------------------------------------------------
void __fastcall IOUSBCommand::~IOUSBCommand(IOUSBCommand *this)
{
  IOCommand::~IOCommand(this);
  OSObject::operator delete((void *)this);
}

//----- (0000000000013472) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::getMetaClass(IOUSBCommand *this)
{
  return (__int64)&IOUSBCommand::gMetaClass;
}
// 496C0: using guessed type _QWORD IOUSBCommand::gMetaClass;

//----- (0000000000013480) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::MetaClass::MetaClass(IOUSBCommand::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBCommand", off_3B090[0], 224LL);
  result = (__int64)off_3EC80;
  *(_QWORD *)this = off_3EC80;
  return result;
}
// 3B090: using guessed type _QWORD off_3B090[16];
// 3EC80: using guessed type __int64 (__fastcall *off_3EC80[2])(IOUSBCommand::MetaClass *__hidden this);
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000134B2) ----------------------------------------------------
IOCommand *__fastcall IOUSBCommand::MetaClass::alloc(IOUSBCommand::MetaClass *this, unsigned __int64 a2)
{
  IOCommand *v2; // rbx@1

  v2 = (IOCommand *)OSObject::operator new((OSObject *)&stru_B8.size, a2);
  IOCommand::IOCommand(v2, (const OSMetaClass *)&IOUSBCommand::gMetaClass);
  *(_QWORD *)v2 = off_3EB50;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBCommand::gMetaClass);
  return v2;
}
// B8: using guessed type section_64;
// 3EB50: using guessed type __int64 (__fastcall *off_3EB50[2])(IOUSBCommand *__hidden this);
// 496C0: using guessed type _QWORD IOUSBCommand::gMetaClass;

//----- (00000000000134F2) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::IOUSBCommand(IOCommand *a1)
{
  IOCommand::IOCommand(a1, (const OSMetaClass *)&IOUSBCommand::gMetaClass);
  *(_QWORD *)a1 = off_3EB50;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBCommand::gMetaClass);
}
// 3EB50: using guessed type __int64 (__fastcall *off_3EB50[2])(IOUSBCommand *__hidden this);
// 496C0: using guessed type _QWORD IOUSBCommand::gMetaClass;

//----- (0000000000013522) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::IOUSBCommand(IOCommand *a1)
{
  IOCommand::IOCommand(a1, (const OSMetaClass *)&IOUSBCommand::gMetaClass);
  *(_QWORD *)a1 = off_3EB50;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBCommand::gMetaClass);
}
// 3EB50: using guessed type __int64 (__fastcall *off_3EB50[2])(IOUSBCommand *__hidden this);
// 496C0: using guessed type _QWORD IOUSBCommand::gMetaClass;

//----- (0000000000013552) ----------------------------------------------------
__int64 __fastcall IOUSBIsocCommand::MetaClass::MetaClass(IOUSBIsocCommand::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBIsocCommand", off_3B090[0], 112LL);
  result = (__int64)off_3EEB0;
  *(_QWORD *)this = off_3EEB0;
  return result;
}
// 3B090: using guessed type _QWORD off_3B090[16];
// 3EEB0: using guessed type __int64 (__fastcall *off_3EEB0[2])(IOUSBIsocCommand::MetaClass *__hidden this);
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000013584) ----------------------------------------------------
__int64 __fastcall IOUSBIsocCommand::MetaClass::~MetaClass(IOUSBIsocCommand::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000001358E) ----------------------------------------------------
__int64 __fastcall IOUSBIsocCommand::IOUSBIsocCommand(IOCommand *a1, const OSMetaClass *a2)
{
  __int64 result; // rax@1

  IOCommand::IOCommand(a1, a2);
  result = (__int64)off_3ED80;
  *(_QWORD *)a1 = off_3ED80;
  return result;
}
// 3ED80: using guessed type __int64 (__fastcall *off_3ED80[2])(IOUSBIsocCommand *__hidden this);

//----- (00000000000135AE) ----------------------------------------------------
__int64 __fastcall IOUSBIsocCommand::IOUSBIsocCommand(IOCommand *a1, const OSMetaClass *a2)
{
  __int64 result; // rax@1

  IOCommand::IOCommand(a1, a2);
  result = (__int64)off_3ED80;
  *(_QWORD *)a1 = off_3ED80;
  return result;
}
// 3ED80: using guessed type __int64 (__fastcall *off_3ED80[2])(IOUSBIsocCommand *__hidden this);

//----- (00000000000135CE) ----------------------------------------------------
__int64 __fastcall IOUSBIsocCommand::~IOUSBIsocCommand(IOUSBIsocCommand *this)
{
  return IOCommand::~IOCommand(this);
}

//----- (00000000000135D8) ----------------------------------------------------
__int64 __fastcall IOUSBIsocCommand::~IOUSBIsocCommand(IOUSBIsocCommand *this)
{
  return IOCommand::~IOCommand(this);
}

//----- (00000000000135E2) ----------------------------------------------------
void __fastcall IOUSBIsocCommand::~IOUSBIsocCommand(IOUSBIsocCommand *this)
{
  IOCommand::~IOCommand(this);
  OSObject::operator delete((void *)this);
}

//----- (0000000000013604) ----------------------------------------------------
__int64 __fastcall IOUSBIsocCommand::getMetaClass(IOUSBIsocCommand *this)
{
  return (__int64)&IOUSBIsocCommand::gMetaClass;
}
// 496E8: using guessed type _QWORD IOUSBIsocCommand::gMetaClass;

//----- (0000000000013612) ----------------------------------------------------
__int64 __fastcall IOUSBIsocCommand::MetaClass::MetaClass(IOUSBIsocCommand::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBIsocCommand", off_3B090[0], 112LL);
  result = (__int64)off_3EEB0;
  *(_QWORD *)this = off_3EEB0;
  return result;
}
// 3B090: using guessed type _QWORD off_3B090[16];
// 3EEB0: using guessed type __int64 (__fastcall *off_3EEB0[2])(IOUSBIsocCommand::MetaClass *__hidden this);
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000013644) ----------------------------------------------------
IOCommand *__fastcall IOUSBIsocCommand::MetaClass::alloc(IOUSBIsocCommand::MetaClass *this, unsigned __int64 a2)
{
  IOCommand *v2; // rbx@1

  v2 = (IOCommand *)OSObject::operator new((OSObject *)&stru_68.sectname[8], a2);
  IOCommand::IOCommand(v2, (const OSMetaClass *)&IOUSBIsocCommand::gMetaClass);
  *(_QWORD *)v2 = off_3ED80;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBIsocCommand::gMetaClass);
  return v2;
}
// 68: using guessed type section_64 stru_68;
// 3ED80: using guessed type __int64 (__fastcall *off_3ED80[2])(IOUSBIsocCommand *__hidden this);
// 496E8: using guessed type _QWORD IOUSBIsocCommand::gMetaClass;

//----- (0000000000013684) ----------------------------------------------------
__int64 __fastcall IOUSBIsocCommand::IOUSBIsocCommand(IOCommand *a1)
{
  IOCommand::IOCommand(a1, (const OSMetaClass *)&IOUSBIsocCommand::gMetaClass);
  *(_QWORD *)a1 = off_3ED80;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBIsocCommand::gMetaClass);
}
// 3ED80: using guessed type __int64 (__fastcall *off_3ED80[2])(IOUSBIsocCommand *__hidden this);
// 496E8: using guessed type _QWORD IOUSBIsocCommand::gMetaClass;

//----- (00000000000136B4) ----------------------------------------------------
__int64 __fastcall IOUSBIsocCommand::IOUSBIsocCommand(IOCommand *a1)
{
  IOCommand::IOCommand(a1, (const OSMetaClass *)&IOUSBIsocCommand::gMetaClass);
  *(_QWORD *)a1 = off_3ED80;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBIsocCommand::gMetaClass);
}
// 3ED80: using guessed type __int64 (__fastcall *off_3ED80[2])(IOUSBIsocCommand *__hidden this);
// 496E8: using guessed type _QWORD IOUSBIsocCommand::gMetaClass;

//----- (00000000000136E4) ----------------------------------------------------
IOCommand *__fastcall IOUSBCommand::NewCommand(IOUSBCommand *this, unsigned __int64 a2)
{
  IOCommand *v2; // rbx@1

  v2 = (IOCommand *)OSObject::operator new((OSObject *)&stru_B8.size, a2);
  IOCommand::IOCommand(v2, (const OSMetaClass *)&IOUSBCommand::gMetaClass);
  *(_QWORD *)v2 = off_3EB50;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBCommand::gMetaClass);
  if ( v2
    && !(unsigned __int8)(*(int (__fastcall **)(IOCommand *, _QWORD *))(*(_QWORD *)v2 + 136LL))(
                           v2,
                           &IOUSBCommand::gMetaClass) )
  {
    (*(void (__fastcall **)(IOCommand *))(*(_QWORD *)v2 + 40LL))(v2);
    v2 = 0LL;
  }
  return v2;
}
// B8: using guessed type section_64 stru_B8;
// 3EB50: using guessed type __int64 (__fastcall *off_3EB50[2])(IOUSBCommand *__hidden this);
// 496C0: using guessed type _QWORD IOUSBCommand::gMetaClass;

//----- (0000000000013744) ----------------------------------------------------
char __fastcall IOUSBCommand::init(IOUSBCommand *this)
{
  char v1; // r14@2
  void *v2; // rax@3

  if ( !(unsigned __int8)(*(int (**)(void))(off_3B0D0[0] + 152))() )
    goto LABEL_5;
  v1 = 1;
  if ( !*((_QWORD *)this + 27) )
  {
    LODWORD(v2) = IOMalloc(200LL);
    *((_QWORD *)this + 27) = v2;
    if ( v2 )
    {
      bzero(v2, 0xC8uLL);
      return v1;
    }
LABEL_5:
    v1 = 0;
  }
  return v1;
}
// 3B0D0: using guessed type __int64 off_3B0D0[8];
// 7D250: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (000000000001379C) ----------------------------------------------------
int __fastcall IOUSBCommand::free(IOUSBCommand *this)
{
  IOUSBCommand *v1; // rbx@1
  __int64 v2; // rdi@1

  v1 = this;
  v2 = *((_QWORD *)this + 27);
  if ( v2 )
  {
    IOFree(v2, 200LL);
    *((_QWORD *)v1 + 27) = 0LL;
  }
  return (*(int (__fastcall **)(IOUSBCommand *))(off_3B0D0[0] + 160))(v1);
}
// 3B0D0: using guessed type __int64 off_3B0D0[8];
// 7D218: using guessed type int __fastcall IOFree(_QWORD, _QWORD);

//----- (00000000000137DC) ----------------------------------------------------
void __fastcall IOUSBCommand::SetSelector(__int64 a1, int a2)
{
  *(_DWORD *)(a1 + 32) = a2;
}

//----- (00000000000137E6) ----------------------------------------------------
void __fastcall IOUSBCommand::SetRequest(__int64 a1, __int64 a2)
{
  *(_QWORD *)(a1 + 40) = a2;
}

//----- (00000000000137F0) ----------------------------------------------------
void __fastcall IOUSBCommand::SetAddress(IOUSBCommand *this, __int16 a2)
{
  *((_WORD *)this + 24) = a2;
}

//----- (00000000000137FA) ----------------------------------------------------
void __fastcall IOUSBCommand::SetEndpoint(IOUSBCommand *this, char a2)
{
  *((_BYTE *)this + 50) = a2;
}

//----- (0000000000013804) ----------------------------------------------------
void __fastcall IOUSBCommand::SetDirection(IOUSBCommand *this, char a2)
{
  *((_BYTE *)this + 51) = a2;
}

//----- (000000000001380E) ----------------------------------------------------
void __fastcall IOUSBCommand::SetType(IOUSBCommand *this, char a2)
{
  *((_BYTE *)this + 52) = a2;
}

//----- (0000000000013818) ----------------------------------------------------
void __fastcall IOUSBCommand::SetBufferRounding(IOUSBCommand *this, char a2)
{
  *((_BYTE *)this + 53) = a2;
}

//----- (0000000000013822) ----------------------------------------------------
void __fastcall IOUSBCommand::SetBuffer(IOUSBCommand *this, IOMemoryDescriptor *a2)
{
  *((_QWORD *)this + 7) = a2;
}

//----- (000000000001382C) ----------------------------------------------------
__int64 __usercall IOUSBCommand::SetUSLCompletion@<rax>(__int64 a1@<rdi>, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 result; // rax@1

  *(_QWORD *)(a1 + 80) = a4;
  result = a2;
  *(_QWORD *)(a1 + 72) = a3;
  *(_QWORD *)(a1 + 64) = a2;
  return result;
}

//----- (000000000001384A) ----------------------------------------------------
__int64 __usercall IOUSBCommand::SetClientCompletion@<rax>(__int64 a1@<rdi>, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 result; // rax@1

  *(_QWORD *)(a1 + 104) = a4;
  result = a2;
  *(_QWORD *)(a1 + 96) = a3;
  *(_QWORD *)(a1 + 88) = a2;
  return result;
}

//----- (0000000000013868) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::SetDataRemaining(IOUSBCommand *this, int a2)
{
  __int64 result; // rax@1

  result = *(_QWORD *)(*((_QWORD *)this + 27) + 64LL);
  if ( result )
    *(_DWORD *)(result + 112) = a2;
  else
    *((_DWORD *)this + 28) = a2;
  return result;
}

//----- (0000000000013886) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::SetStage(IOUSBCommand *this, char a2)
{
  __int64 result; // rax@1

  result = *(_QWORD *)(*((_QWORD *)this + 27) + 64LL);
  if ( result )
    *(_BYTE *)(result + 116) = a2;
  else
    *((_BYTE *)this + 116) = a2;
  return result;
}

//----- (00000000000138A6) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::SetStatus(IOUSBCommand *this, int a2)
{
  __int64 result; // rax@1

  result = *(_QWORD *)(*((_QWORD *)this + 27) + 64LL);
  if ( result )
    *(_DWORD *)(result + 120) = a2;
  else
    *((_DWORD *)this + 30) = a2;
  return result;
}

//----- (00000000000138C4) ----------------------------------------------------
void __fastcall IOUSBCommand::SetOrigBuffer(IOUSBCommand *this, IOMemoryDescriptor *a2)
{
  *((_QWORD *)this + 16) = a2;
}

//----- (00000000000138D2) ----------------------------------------------------
__int64 __usercall IOUSBCommand::SetDisjointCompletion@<rax>(__int64 a1@<rdi>, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 result; // rax@1

  *(_QWORD *)(a1 + 152) = a4;
  result = a2;
  *(_QWORD *)(a1 + 144) = a3;
  *(_QWORD *)(a1 + 136) = a2;
  return result;
}

//----- (00000000000138FA) ----------------------------------------------------
void __fastcall IOUSBCommand::SetDblBufLength(IOUSBCommand *this, __int64 a2)
{
  *((_QWORD *)this + 20) = a2;
}

//----- (0000000000013908) ----------------------------------------------------
void __fastcall IOUSBCommand::SetNoDataTimeout(IOUSBCommand *this, int a2)
{
  *((_DWORD *)this + 42) = a2;
}

//----- (0000000000013914) ----------------------------------------------------
void __fastcall IOUSBCommand::SetCompletionTimeout(IOUSBCommand *this, int a2)
{
  *((_DWORD *)this + 43) = a2;
}

//----- (0000000000013920) ----------------------------------------------------
void __fastcall IOUSBCommand::SetUIMScratch(IOUSBCommand *this, unsigned int a2, int a3)
{
  __int64 v3; // rax@2

  if ( a2 <= 9 )
  {
    v3 = *(_QWORD *)(*((_QWORD *)this + 27) + 64LL);
    if ( v3 )
      *(_DWORD *)(v3 + 4LL * a2 + 176) = a3;
    else
      *((_DWORD *)this + a2 + 44) = a3;
  }
}

//----- (000000000001394E) ----------------------------------------------------
void __fastcall IOUSBCommand::SetUIMScratch64(IOUSBCommand *this, unsigned int a2, __int64 a3)
{
  __int64 v3; // rax@2
  __int64 v4; // rdi@2

  if ( a2 <= 4 )
  {
    v3 = *((_QWORD *)this + 27);
    v4 = *(_QWORD *)(v3 + 64);
    if ( v4 )
      v3 = *(_QWORD *)(v4 + 216);
    *(_QWORD *)(v3 + 8LL * a2 + 160) = a3;
  }
}

//----- (000000000001397A) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::SetBT(IOUSBCommand *this, unsigned int a2, void *a3)
{
  __int64 result; // rax@2

  if ( a2 <= 9 )
  {
    result = a2;
    *(_QWORD *)(*((_QWORD *)this + 27) + 8LL * a2 + 80) = a3;
  }
  return result;
}

//----- (0000000000013994) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::SetReqCount(IOUSBCommand *this, __int64 a2)
{
  __int64 result; // rax@1

  result = *((_QWORD *)this + 27);
  *(_QWORD *)result = a2;
  return result;
}

//----- (00000000000139A4) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::SetRequestMemoryDescriptor(IOUSBCommand *this, IOMemoryDescriptor *a2)
{
  __int64 result; // rax@1

  result = *((_QWORD *)this + 27);
  *(_QWORD *)(result + 8) = a2;
  return result;
}

//----- (00000000000139B6) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::SetBufferMemoryDescriptor(IOUSBCommand *this, IOMemoryDescriptor *a2)
{
  __int64 result; // rax@1

  result = *((_QWORD *)this + 27);
  *(_QWORD *)(result + 16) = a2;
  return result;
}

//----- (00000000000139C8) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::SetMultiTransferTransaction(IOUSBCommand *this, char a2)
{
  __int64 result; // rax@1

  result = *((_QWORD *)this + 27);
  *(_BYTE *)(result + 24) = a2;
  return result;
}

//----- (00000000000139DA) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::SetFinalTransferInTransaction(IOUSBCommand *this, char a2)
{
  __int64 result; // rax@1

  result = *((_QWORD *)this + 27);
  *(_BYTE *)(result + 25) = a2;
  return result;
}

//----- (00000000000139EC) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::SetUseTimeStamp(IOUSBCommand *this, char a2)
{
  __int64 result; // rax@1

  result = *((_QWORD *)this + 27);
  *(_BYTE *)(result + 26) = a2;
  return result;
}

//----- (00000000000139FE) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::SetTimeStamp(IOUSBCommand *this, __int64 a2)
{
  __int64 result; // rax@1

  result = *((_QWORD *)this + 27);
  *(_QWORD *)(result + 32) = a2;
  return result;
}

//----- (0000000000013A10) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::SetIsSyncTransfer(IOUSBCommand *this, char a2)
{
  __int64 result; // rax@1

  result = *((_QWORD *)this + 27);
  *(_BYTE *)(result + 40) = a2;
  return result;
}

//----- (0000000000013A22) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::SetBufferUSBCommand(IOUSBCommand *this, IOUSBCommand *a2)
{
  __int64 result; // rax@1
  __int64 v3; // rcx@3

  result = *((_QWORD *)this + 27);
  if ( a2 )
  {
    *(_QWORD *)(result + 56) = a2;
    result = *((_QWORD *)a2 + 27);
    *(_QWORD *)(result + 64) = this;
  }
  else
  {
    v3 = *(_QWORD *)(result + 56);
    if ( v3 )
      *(_QWORD *)(*(_QWORD *)(v3 + 216) + 64LL) = 0LL;
    *(_QWORD *)(result + 56) = 0LL;
  }
  return result;
}

//----- (0000000000013A66) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::GetSelector(IOUSBCommand *this)
{
  return *((_DWORD *)this + 8);
}

//----- (0000000000013A70) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::GetRequest(IOUSBCommand *this)
{
  IOUSBCommand *v1; // rax@1

  v1 = *(IOUSBCommand **)(*((_QWORD *)this + 27) + 64LL);
  if ( !v1 )
    v1 = this;
  return *((_QWORD *)v1 + 5);
}

//----- (0000000000013A8C) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::GetAddress(IOUSBCommand *this)
{
  IOUSBCommand *v1; // rax@1

  v1 = *(IOUSBCommand **)(*((_QWORD *)this + 27) + 64LL);
  if ( !v1 )
    v1 = this;
  return *((_WORD *)v1 + 24);
}

//----- (0000000000013AA8) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::GetEndpoint(IOUSBCommand *this)
{
  IOUSBCommand *v1; // rax@1

  v1 = *(IOUSBCommand **)(*((_QWORD *)this + 27) + 64LL);
  if ( !v1 )
    v1 = this;
  return *((_BYTE *)v1 + 50);
}

//----- (0000000000013AC4) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::GetDirection(IOUSBCommand *this)
{
  IOUSBCommand *v1; // rax@1

  v1 = *(IOUSBCommand **)(*((_QWORD *)this + 27) + 64LL);
  if ( !v1 )
    v1 = this;
  return *((_BYTE *)v1 + 51);
}

//----- (0000000000013AE0) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::GetType(IOUSBCommand *this)
{
  IOUSBCommand *v1; // rax@1

  v1 = *(IOUSBCommand **)(*((_QWORD *)this + 27) + 64LL);
  if ( !v1 )
    v1 = this;
  return *((_BYTE *)v1 + 52);
}

//----- (0000000000013AFC) ----------------------------------------------------
char __fastcall IOUSBCommand::GetBufferRounding(IOUSBCommand *this)
{
  return *((_BYTE *)this + 53);
}

//----- (0000000000013B06) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::GetBuffer(IOUSBCommand *this)
{
  IOUSBCommand *v1; // rax@1

  v1 = *(IOUSBCommand **)(*((_QWORD *)this + 27) + 64LL);
  if ( !v1 )
    v1 = this;
  return *((_QWORD *)v1 + 7);
}

//----- (0000000000013B22) ----------------------------------------------------
IOUSBCommand *__fastcall IOUSBCommand::GetUSLCompletion(IOUSBCommand *this, __int64 a2)
{
  __int64 v2; // rax@1
  __int64 v3; // rcx@3

  v2 = *(_QWORD *)(*(_QWORD *)(a2 + 216) + 64LL);
  if ( !v2 )
    v2 = a2;
  *((_QWORD *)this + 2) = *(_QWORD *)(v2 + 80);
  v3 = *(_QWORD *)(v2 + 64);
  *((_QWORD *)this + 1) = *(_QWORD *)(v2 + 72);
  *(_QWORD *)this = v3;
  return this;
}

//----- (0000000000013B54) ----------------------------------------------------
IOUSBCommand *__fastcall IOUSBCommand::GetClientCompletion(IOUSBCommand *this, __int64 a2)
{
  __int64 v2; // rax@1
  __int64 v3; // rcx@3

  v2 = *(_QWORD *)(*(_QWORD *)(a2 + 216) + 64LL);
  if ( !v2 )
    v2 = a2;
  *((_QWORD *)this + 2) = *(_QWORD *)(v2 + 104);
  v3 = *(_QWORD *)(v2 + 88);
  *((_QWORD *)this + 1) = *(_QWORD *)(v2 + 96);
  *(_QWORD *)this = v3;
  return this;
}

//----- (0000000000013B86) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::GetDataRemaining(IOUSBCommand *this)
{
  IOUSBCommand *v1; // rax@1

  v1 = *(IOUSBCommand **)(*((_QWORD *)this + 27) + 64LL);
  if ( !v1 )
    v1 = this;
  return *((_DWORD *)v1 + 28);
}

//----- (0000000000013BA2) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::GetStage(IOUSBCommand *this)
{
  IOUSBCommand *v1; // rax@1

  v1 = *(IOUSBCommand **)(*((_QWORD *)this + 27) + 64LL);
  if ( !v1 )
    v1 = this;
  return *((_BYTE *)v1 + 116);
}

//----- (0000000000013BBE) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::GetStatus(IOUSBCommand *this)
{
  IOUSBCommand *v1; // rax@1

  v1 = *(IOUSBCommand **)(*((_QWORD *)this + 27) + 64LL);
  if ( !v1 )
    v1 = this;
  return *((_DWORD *)v1 + 30);
}

//----- (0000000000013BDA) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::GetOrigBuffer(IOUSBCommand *this)
{
  IOUSBCommand *v1; // rax@1

  v1 = *(IOUSBCommand **)(*((_QWORD *)this + 27) + 64LL);
  if ( !v1 )
    v1 = this;
  return *((_QWORD *)v1 + 16);
}

//----- (0000000000013BFA) ----------------------------------------------------
IOUSBCommand *__fastcall IOUSBCommand::GetDisjointCompletion(IOUSBCommand *this, __int64 a2)
{
  __int64 v2; // rax@1
  __int64 v3; // rcx@3

  v2 = *(_QWORD *)(*(_QWORD *)(a2 + 216) + 64LL);
  if ( !v2 )
    v2 = a2;
  *((_QWORD *)this + 2) = *(_QWORD *)(v2 + 152);
  v3 = *(_QWORD *)(v2 + 136);
  *((_QWORD *)this + 1) = *(_QWORD *)(v2 + 144);
  *(_QWORD *)this = v3;
  return this;
}

//----- (0000000000013C36) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::GetDblBufLength(IOUSBCommand *this)
{
  IOUSBCommand *v1; // rax@1

  v1 = *(IOUSBCommand **)(*((_QWORD *)this + 27) + 64LL);
  if ( !v1 )
    v1 = this;
  return *((_QWORD *)v1 + 20);
}

//----- (0000000000013C56) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::GetNoDataTimeout(IOUSBCommand *this)
{
  IOUSBCommand *v1; // rax@1

  v1 = *(IOUSBCommand **)(*((_QWORD *)this + 27) + 64LL);
  if ( !v1 )
    v1 = this;
  return *((_DWORD *)v1 + 42);
}

//----- (0000000000013C74) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::GetCompletionTimeout(IOUSBCommand *this)
{
  IOUSBCommand *v1; // rax@1

  v1 = *(IOUSBCommand **)(*((_QWORD *)this + 27) + 64LL);
  if ( !v1 )
    v1 = this;
  return *((_DWORD *)v1 + 43);
}

//----- (0000000000013C92) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::GetUIMScratch(IOUSBCommand *this, unsigned int a2)
{
  __int64 result; // rax@1
  IOUSBCommand *v3; // rax@2

  result = 0LL;
  if ( a2 <= 9 )
  {
    v3 = *(IOUSBCommand **)(*((_QWORD *)this + 27) + 64LL);
    if ( !v3 )
      v3 = this;
    result = *((_DWORD *)v3 + a2 + 44);
  }
  return result;
}

//----- (0000000000013CBA) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::GetUIMScratch64(IOUSBCommand *this, unsigned int a2)
{
  __int64 result; // rax@1
  __int64 v3; // rax@2
  __int64 v4; // rdx@2

  result = 0LL;
  if ( a2 <= 4 )
  {
    v3 = *((_QWORD *)this + 27);
    v4 = *(_QWORD *)(v3 + 64);
    if ( v4 )
      v3 = *(_QWORD *)(v4 + 216);
    result = *(_QWORD *)(v3 + 8LL * a2 + 160);
  }
  return result;
}

//----- (0000000000013CE8) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::GetReqCount(IOUSBCommand *this)
{
  return **((_QWORD **)this + 27);
}

//----- (0000000000013CF8) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::GetRequestMemoryDescriptor(IOUSBCommand *this)
{
  __int64 v1; // rax@1
  __int64 v2; // rcx@1

  v1 = *((_QWORD *)this + 27);
  v2 = *(_QWORD *)(v1 + 64);
  if ( v2 )
    v1 = *(_QWORD *)(v2 + 216);
  return *(_QWORD *)(v1 + 8);
}

//----- (0000000000013D1A) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::GetBufferMemoryDescriptor(IOUSBCommand *this)
{
  return *(_QWORD *)(*((_QWORD *)this + 27) + 16LL);
}

//----- (0000000000013D2C) ----------------------------------------------------
char __fastcall IOUSBCommand::GetMultiTransferTransaction(IOUSBCommand *this)
{
  __int64 v1; // rax@1
  __int64 v2; // rcx@1

  v1 = *((_QWORD *)this + 27);
  v2 = *(_QWORD *)(v1 + 64);
  if ( v2 )
    v1 = *(_QWORD *)(v2 + 216);
  return *(_BYTE *)(v1 + 24) & 1;
}

//----- (0000000000013D4E) ----------------------------------------------------
char __fastcall IOUSBCommand::GetFinalTransferInTransaction(IOUSBCommand *this)
{
  __int64 v1; // rax@1
  __int64 v2; // rcx@1

  v1 = *((_QWORD *)this + 27);
  v2 = *(_QWORD *)(v1 + 64);
  if ( v2 )
    v1 = *(_QWORD *)(v2 + 216);
  return *(_BYTE *)(v1 + 25) & 1;
}

//----- (0000000000013D70) ----------------------------------------------------
char __fastcall IOUSBCommand::GetUseTimeStamp(IOUSBCommand *this)
{
  __int64 v1; // rax@1
  __int64 v2; // rcx@1

  v1 = *((_QWORD *)this + 27);
  v2 = *(_QWORD *)(v1 + 64);
  if ( v2 )
    v1 = *(_QWORD *)(v2 + 216);
  return *(_BYTE *)(v1 + 26) & 1;
}

//----- (0000000000013D92) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::GetTimeStamp(IOUSBCommand *this)
{
  __int64 v1; // rax@1
  __int64 v2; // rcx@1

  v1 = *((_QWORD *)this + 27);
  v2 = *(_QWORD *)(v1 + 64);
  if ( v2 )
    v1 = *(_QWORD *)(v2 + 216);
  return *(_QWORD *)(v1 + 32);
}

//----- (0000000000013DB4) ----------------------------------------------------
char __fastcall IOUSBCommand::GetIsSyncTransfer(IOUSBCommand *this)
{
  __int64 v1; // rax@1
  __int64 v2; // rcx@1

  v1 = *((_QWORD *)this + 27);
  v2 = *(_QWORD *)(v1 + 64);
  if ( v2 )
    v1 = *(_QWORD *)(v2 + 216);
  return *(_BYTE *)(v1 + 40) & 1;
}

//----- (0000000000013DD6) ----------------------------------------------------
IOCommand *__fastcall IOUSBIsocCommand::NewCommand(IOUSBIsocCommand *this, unsigned __int64 a2)
{
  IOCommand *v2; // rbx@1

  v2 = (IOCommand *)OSObject::operator new((OSObject *)&stru_68.sectname[8], a2);
  IOCommand::IOCommand(v2, (const OSMetaClass *)&IOUSBIsocCommand::gMetaClass);
  *(_QWORD *)v2 = off_3ED80;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBIsocCommand::gMetaClass);
  if ( v2
    && !(unsigned __int8)(*(int (__fastcall **)(IOCommand *, _QWORD *))(*(_QWORD *)v2 + 136LL))(
                           v2,
                           &IOUSBIsocCommand::gMetaClass) )
  {
    (*(void (__fastcall **)(IOCommand *))(*(_QWORD *)v2 + 40LL))(v2);
    v2 = 0LL;
  }
  return v2;
}
// 68: using guessed type section_64 stru_68;
// 3ED80: using guessed type __int64 (__fastcall *off_3ED80[2])(IOUSBIsocCommand *__hidden this);
// 496E8: using guessed type _QWORD IOUSBIsocCommand::gMetaClass;

//----- (0000000000013E36) ----------------------------------------------------
char __fastcall IOUSBIsocCommand::init(IOUSBIsocCommand *this)
{
  char v1; // r14@2
  void *v2; // rax@3

  if ( !(unsigned __int8)(*(int (**)(void))(off_3B0D0[0] + 152))() )
    goto LABEL_5;
  v1 = 1;
  if ( !*((_QWORD *)this + 13) )
  {
    LODWORD(v2) = IOMalloc(104LL);
    *((_QWORD *)this + 13) = v2;
    if ( v2 )
    {
      bzero(v2, 0x68uLL);
      return v1;
    }
LABEL_5:
    v1 = 0;
  }
  return v1;
}
// 3B0D0: using guessed type __int64 off_3B0D0[8];
// 7D250: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (0000000000013E88) ----------------------------------------------------
int __fastcall IOUSBIsocCommand::free(IOUSBIsocCommand *this)
{
  IOUSBIsocCommand *v1; // rbx@1
  __int64 v2; // rdi@1

  v1 = this;
  v2 = *((_QWORD *)this + 13);
  if ( v2 )
  {
    IOFree(v2, 104LL);
    *((_QWORD *)v1 + 13) = 0LL;
  }
  return (*(int (__fastcall **)(IOUSBIsocCommand *))(off_3B0D0[0] + 160))(v1);
}
// 3B0D0: using guessed type __int64 off_3B0D0[8];
// 7D218: using guessed type int __fastcall IOFree(_QWORD, _QWORD);

//----- (0000000000013EC2) ----------------------------------------------------
__int64 __fastcall IOUSBCommandPool::MetaClass::MetaClass(IOUSBCommandPool::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBCommandPool", off_3B038[0], 56LL);
  result = (__int64)off_3F150;
  *(_QWORD *)this = off_3F150;
  return result;
}
// 3B038: using guessed type _QWORD *off_3B038[4];
// 3F150: using guessed type __int64 (__fastcall *off_3F150[2])(IOUSBCommandPool::MetaClass *__hidden this);
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000013EF4) ----------------------------------------------------
__int64 __fastcall IOUSBCommandPool::MetaClass::~MetaClass(IOUSBCommandPool::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000013EFE) ----------------------------------------------------
__int64 __fastcall IOUSBCommandPool::IOUSBCommandPool(IOCommandPool *a1, const OSMetaClass *a2)
{
  __int64 result; // rax@1

  IOCommandPool::IOCommandPool(a1, a2);
  result = (__int64)off_3EFB0;
  *(_QWORD *)a1 = off_3EFB0;
  return result;
}
// 3EFB0: using guessed type __int64 (__fastcall *off_3EFB0[2])(IOUSBCommandPool *__hidden this);

//----- (0000000000013F1E) ----------------------------------------------------
__int64 __fastcall IOUSBCommandPool::IOUSBCommandPool(IOCommandPool *a1, const OSMetaClass *a2)
{
  __int64 result; // rax@1

  IOCommandPool::IOCommandPool(a1, a2);
  result = (__int64)off_3EFB0;
  *(_QWORD *)a1 = off_3EFB0;
  return result;
}
// 3EFB0: using guessed type __int64 (__fastcall *off_3EFB0[2])(IOUSBCommandPool *__hidden this);

//----- (0000000000013F3E) ----------------------------------------------------
__int64 __fastcall IOUSBCommandPool::~IOUSBCommandPool(IOUSBCommandPool *this)
{
  return IOCommandPool::~IOCommandPool(this);
}

//----- (0000000000013F48) ----------------------------------------------------
__int64 __fastcall IOUSBCommandPool::~IOUSBCommandPool(IOUSBCommandPool *this)
{
  return IOCommandPool::~IOCommandPool(this);
}

//----- (0000000000013F52) ----------------------------------------------------
void __fastcall IOUSBCommandPool::~IOUSBCommandPool(IOUSBCommandPool *this)
{
  IOCommandPool::~IOCommandPool(this);
  OSObject::operator delete((void *)this);
}

//----- (0000000000013F74) ----------------------------------------------------
__int64 __fastcall IOUSBCommandPool::getMetaClass(IOUSBCommandPool *this)
{
  return (__int64)&IOUSBCommandPool::gMetaClass;
}
// 49710: using guessed type _QWORD IOUSBCommandPool::gMetaClass;

//----- (0000000000013F82) ----------------------------------------------------
__int64 __fastcall IOUSBCommandPool::MetaClass::MetaClass(IOUSBCommandPool::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBCommandPool", off_3B038[0], 56LL);
  result = (__int64)off_3F150;
  *(_QWORD *)this = off_3F150;
  return result;
}
// 3B038: using guessed type _QWORD *off_3B038[4];
// 3F150: using guessed type __int64 (__fastcall *off_3F150[2])(IOUSBCommandPool::MetaClass *__hidden this);
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000013FB4) ----------------------------------------------------
IOCommandPool *__fastcall IOUSBCommandPool::MetaClass::alloc(IOUSBCommandPool::MetaClass *this, unsigned __int64 a2)
{
  IOCommandPool *v2; // rbx@1

  v2 = (IOCommandPool *)OSObject::operator new((OSObject *)&stru_20.vmaddr, a2);
  IOCommandPool::IOCommandPool(v2, (const OSMetaClass *)&IOUSBCommandPool::gMetaClass);
  *(_QWORD *)v2 = off_3EFB0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBCommandPool::gMetaClass);
  return v2;
}
// 20: using guessed type segment_command_64 stru_20;
// 3EFB0: using guessed type __int64 (__fastcall *off_3EFB0[2])(IOUSBCommandPool *__hidden this);
// 49710: using guessed type _QWORD IOUSBCommandPool::gMetaClass;

//----- (0000000000013FF4) ----------------------------------------------------
__int64 __fastcall IOUSBCommandPool::IOUSBCommandPool(IOCommandPool *a1)
{
  IOCommandPool::IOCommandPool(a1, (const OSMetaClass *)&IOUSBCommandPool::gMetaClass);
  *(_QWORD *)a1 = off_3EFB0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBCommandPool::gMetaClass);
}
// 3EFB0: using guessed type __int64 (__fastcall *off_3EFB0[2])(IOUSBCommandPool *__hidden this);
// 49710: using guessed type _QWORD IOUSBCommandPool::gMetaClass;

//----- (0000000000014024) ----------------------------------------------------
__int64 __fastcall IOUSBCommandPool::IOUSBCommandPool(IOCommandPool *a1)
{
  IOCommandPool::IOCommandPool(a1, (const OSMetaClass *)&IOUSBCommandPool::gMetaClass);
  *(_QWORD *)a1 = off_3EFB0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBCommandPool::gMetaClass);
}
// 3EFB0: using guessed type __int64 (__fastcall *off_3EFB0[2])(IOUSBCommandPool *__hidden this);
// 49710: using guessed type _QWORD IOUSBCommandPool::gMetaClass;

//----- (0000000000014054) ----------------------------------------------------
IOCommandPool *__fastcall IOUSBCommandPool::withWorkLoop(IOUSBCommandPool *this, IOWorkLoop *a2)
{
  IOCommandPool *v2; // rbx@1

  v2 = (IOCommandPool *)OSObject::operator new((OSObject *)&stru_20.vmaddr, (unsigned __int64)a2);
  IOCommandPool::IOCommandPool(v2, (const OSMetaClass *)&IOUSBCommandPool::gMetaClass);
  *(_QWORD *)v2 = off_3EFB0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBCommandPool::gMetaClass);
  if ( v2
    && !(unsigned __int8)(*(int (__fastcall **)(IOCommandPool *, IOUSBCommandPool *))(*(_QWORD *)v2 + 280LL))(v2, this) )
  {
    (*(void (__fastcall **)(IOCommandPool *))(*(_QWORD *)v2 + 40LL))(v2);
    v2 = 0LL;
  }
  return v2;
}
// 20: using guessed type segment_command_64 stru_20;
// 3EFB0: using guessed type __int64 (__fastcall *off_3EFB0[2])(IOUSBCommandPool *__hidden this);
// 49710: using guessed type _QWORD IOUSBCommandPool::gMetaClass;

//----- (00000000000140C4) ----------------------------------------------------
int __fastcall IOUSBCommandPool::gatedGetCommand(IOUSBCommandPool *this, IOCommand **a2, unsigned __int8 a3)
{
  return (*(int (__fastcall **)(IOUSBCommandPool *, IOCommand **, _QWORD))(off_3B0C0[0] + 328))(this, a2, a3);
}
// 3B0C0: using guessed type __int64 off_3B0C0[10];

//----- (00000000000140DA) ----------------------------------------------------
__int64 __fastcall IOUSBCommandPool::gatedReturnCommand(IOUSBCommandPool *this, IOCommand *a2, const OSMetaClass *a3)
{
  IOCommand *v3; // r12@1
  __int64 v4; // r14@1
  __int64 v5; // rbx@1
  signed __int64 v6; // rsi@1
  const OSMetaClass *v7; // rdx@1
  __int64 v8; // rcx@1
  __int64 v9; // r8@1
  __int64 v10; // r9@1
  __int64 v11; // r15@1
  int v12; // er13@1
  IOCommand *v13; // rax@2
  __int64 v14; // r13@7
  __int64 v15; // rax@8
  __int64 v16; // rax@9
  __int64 v17; // rcx@11
  __int64 v18; // rdx@11
  __int64 v19; // rax@14
  __int64 v20; // rcx@15
  __int64 v21; // rax@19
  __int64 v22; // rdx@21
  __int64 v23; // rcx@21
  __int64 v24; // rbx@31
  __int64 v25; // rax@32
  __int64 v26; // rax@33
  __int64 result; // rax@36
  char v28; // [sp+0h] [bp-A0h]@0
  void *bt; // [sp+30h] [bp-70h]@5
  __int64 v30; // [sp+38h] [bp-68h]@5
  __int64 v31; // [sp+40h] [bp-60h]@5
  __int64 v32; // [sp+48h] [bp-58h]@5
  __int64 v33; // [sp+70h] [bp-30h]@1

  v3 = a2;
  v4 = off_3B0E0[0];
  v33 = *(_QWORD *)off_3B0E0[0];
  v5 = OSMetaClassBase::safeMetaCast(a2, (const OSMetaClassBase *)&IOUSBCommand::gMetaClass, a3);
  v6 = (signed __int64)&IOUSBIsocCommand::gMetaClass;
  v11 = OSMetaClassBase::safeMetaCast(v3, (const OSMetaClassBase *)&IOUSBIsocCommand::gMetaClass, v7);
  v12 = -536870206;
  if ( v3 )
  {
    v13 = (IOCommand *)*((_QWORD *)v3 + 2);
    if ( v13 && ((v8 = (__int64)((char *)v3 + 16), (IOCommand *)((char *)v3 + 16) != v13) || v8 != *((_QWORD *)v3 + 3)) )
    {
      OSBacktrace(&bt, 8u);
      KernelDebugLogInternal(
        1u,
        0x55534246u,
        (__int64)"IOUSBCommandPool::gatedReturnCommand  command already in queue, not putting it back into the queue, bt: [%p][%p][%p][%p][%p][%p][%p][%p]",
        (__int64)bt,
        v30,
        v31,
        v32);
    }
    else
    {
      if ( v5 )
      {
        v14 = *(_QWORD *)(*(_QWORD *)(v5 + 216) + 48LL);
        if ( v14 )
        {
          LODWORD(v15) = (*(int (__fastcall **)(__int64, _QWORD *))(*(_QWORD *)v14 + 312LL))(
                           v14,
                           &IOUSBIsocCommand::gMetaClass);
          if ( v15 )
          {
            LODWORD(v16) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v14 + 312LL))(v14);
            v6 = 1431519814LL;
            KernelDebugLogInternal(
              1u,
              0x55534246u,
              (__int64)"IOUSBCommandPool::gatedReturnCommand - command (%p) still has dmaCommand(%p) with an active memory descriptor(%p)",
              v5,
              v14,
              v16,
              v28);
          }
        }
        else
        {
          v6 = 1431519814LL;
          KernelDebugLogInternal(
            1u,
            0x55534246u,
            (__int64)"IOUSBCommandPool::gatedReturnCommand - missing dmaCommand in IOUSBCommand",
            v8,
            v9,
            v10,
            v28);
        }
        *(_DWORD *)(v5 + 32) = 255;
        *(_QWORD *)(v5 + 40) = 3735928559LL;
        *(_WORD *)(v5 + 48) = 255;
        *(_BYTE *)(v5 + 50) = -1;
        *(_BYTE *)(v5 + 51) = -1;
        *(_BYTE *)(v5 + 52) = -1;
        *(_BYTE *)(v5 + 53) = 0;
        *(_QWORD *)(v5 + 56) = 3735928559LL;
        *(_QWORD *)(v5 + 64) = 3735928559LL;
        *(_QWORD *)(v5 + 72) = 0LL;
        *(_QWORD *)(v5 + 80) = 3735928559LL;
        *(_QWORD *)(v5 + 88) = 3735928559LL;
        *(_QWORD *)(v5 + 96) = 0LL;
        *(_QWORD *)(v5 + 104) = 3735928559LL;
        v17 = *(_QWORD *)(v5 + 216);
        v18 = *(_QWORD *)(v17 + 64);
        if ( v18 )
        {
          *(_DWORD *)(v18 + 112) = -559038737;
          *(_BYTE *)(v18 + 116) = -1;
          *(_DWORD *)(v18 + 120) = -559038737;
        }
        else
        {
          *(_DWORD *)(v5 + 112) = -559038737;
          *(_BYTE *)(v5 + 116) = -1;
          *(_DWORD *)(v5 + 120) = -559038737;
        }
        *(_QWORD *)(v5 + 128) = 3735928559LL;
        *(_QWORD *)(v5 + 136) = 3735928559LL;
        *(_QWORD *)(v5 + 144) = 0LL;
        *(_QWORD *)(v5 + 152) = 3735928559LL;
        *(_QWORD *)(v5 + 160) = 3735928559LL;
        *(_DWORD *)(v5 + 168) = -559038737;
        *(_DWORD *)(v5 + 172) = -559038737;
        *(_QWORD *)v17 = 3735928559LL;
        *(_WORD *)(v17 + 24) = 257;
        *(_BYTE *)(v17 + 26) = 1;
        *(_BYTE *)(v17 + 40) = 0;
        v19 = 0LL;
        do
        {
          v20 = *(_QWORD *)(*(_QWORD *)(v5 + 216) + 64LL);
          if ( v20 )
            *(_DWORD *)(v20 + 4 * v19 + 176) = -559038737;
          else
            *(_DWORD *)(v5 + 4 * v19 + 176) = -559038737;
          ++v19;
        }
        while ( v19 != 10 );
        v21 = *(_QWORD *)(v5 + 216);
        *(_DWORD *)(v21 + 72) = -559038737;
        if ( *(_QWORD *)(v21 + 56) )
        {
          v6 = 1431519814LL;
          KernelDebugLogInternal(
            1u,
            0x55534246u,
            (__int64)"IOUSBCommandPool::gatedReturnCommand - GetBufferUSBCommand() is not NULL",
            v20,
            v9,
            v10,
            v28);
          v21 = *(_QWORD *)(v5 + 216);
        }
        v22 = *(_QWORD *)(v21 + 64);
        v23 = v21;
        if ( v22 )
          v23 = *(_QWORD *)(v22 + 216);
        if ( *(_QWORD *)(v23 + 8) )
        {
          v6 = 1431519814LL;
          KernelDebugLogInternal(
            1u,
            0x55534246u,
            (__int64)"IOUSBCommandPool::gatedReturnCommand - GetRequestMemoryDescriptor() is not NULL",
            v23,
            v9,
            v10,
            v28);
          v21 = *(_QWORD *)(v5 + 216);
        }
        if ( *(_QWORD *)(v21 + 16) )
        {
          v6 = 1431519814LL;
          KernelDebugLogInternal(
            1u,
            0x55534246u,
            (__int64)"IOUSBCommandPool::gatedReturnCommand - GetBufferMemoryDescriptor() is not NULL",
            v23,
            v9,
            v10,
            v28);
          v21 = *(_QWORD *)(v5 + 216);
        }
        v8 = *(_QWORD *)(v21 + 56);
        if ( v8 )
        {
          v8 = *(_QWORD *)(v8 + 216);
          *(_QWORD *)(v8 + 64) = 0LL;
        }
        *(_QWORD *)(v21 + 56) = 0LL;
        *(_QWORD *)(v21 + 8) = 0LL;
        *(_QWORD *)(v21 + 16) = 0LL;
      }
      if ( v11 )
      {
        v24 = *(_QWORD *)(*(_QWORD *)(v11 + 104) + 24LL);
        if ( v24 )
        {
          LODWORD(v25) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v24 + 312LL))(v24, v6);
          if ( v25 )
          {
            LODWORD(v26) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v24 + 312LL))(v24);
            KernelDebugLogInternal(
              1u,
              0x55534246u,
              (__int64)"IOUSBCommandPool::gatedReturnCommand - isocCommand (%p) still has dmaCommand(%p) with an active memory descriptor(%p)",
              v11,
              v24,
              v26,
              v28);
          }
        }
        else
        {
          KernelDebugLogInternal(
            1u,
            0x55534246u,
            (__int64)"IOUSBCommandPool::gatedReturnCommand - missing dmaCommand in IOUSBIsocCommand",
            v8,
            v9,
            v10,
            v28);
        }
      }
      v12 = (*(int (__fastcall **)(IOUSBCommandPool *, IOCommand *))(off_3B0C0[0] + 336))(this, v3);
    }
  }
  result = *(_QWORD *)v4;
  if ( *(_QWORD *)v4 == v33 )
    result = (unsigned int)v12;
  return result;
}
// 3B0C0: using guessed type __int64 off_3B0C0[10];
// 3B0E0: using guessed type __int64 off_3B0E0[6];
// 496C0: using guessed type _QWORD IOUSBCommand::gMetaClass;
// 496E8: using guessed type _QWORD IOUSBIsocCommand::gMetaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000014488) ----------------------------------------------------
__int64 __fastcall IOUSBCommand::MetaClass::~MetaClass(IOUSBCommand::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000014492) ----------------------------------------------------
__int64 __fastcall IOUSBIsocCommand::MetaClass::~MetaClass(IOUSBIsocCommand::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000001449C) ----------------------------------------------------
__int64 __fastcall IOUSBCommandPool::MetaClass::~MetaClass(IOUSBCommandPool::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (00000000000144B0) ----------------------------------------------------
__int64 `global constructor keyed to'_a_5()
{
  __int64 v0; // rbx@1
  __int64 result; // rax@1

  v0 = off_3B090[0];
  OSMetaClass::OSMetaClass(&IOUSBCommand::gMetaClass, "IOUSBCommand", off_3B090[0], 224LL);
  IOUSBCommand::gMetaClass = off_3EC80;
  OSMetaClass::OSMetaClass(&IOUSBIsocCommand::gMetaClass, "IOUSBIsocCommand", v0, 112LL);
  IOUSBIsocCommand::gMetaClass = off_3EEB0;
  OSMetaClass::OSMetaClass(&IOUSBCommandPool::gMetaClass, "IOUSBCommandPool", off_3B038[0], 56LL);
  result = (__int64)off_3F150;
  IOUSBCommandPool::gMetaClass = off_3F150;
  return result;
}
// 3B038: using guessed type _QWORD *off_3B038[4];
// 3B090: using guessed type _QWORD off_3B090[16];
// 3EC80: using guessed type __int64 (__fastcall *off_3EC80[2])(IOUSBCommand::MetaClass *__hidden this);
// 3EEB0: using guessed type __int64 (__fastcall *off_3EEB0[2])(IOUSBIsocCommand::MetaClass *__hidden this);
// 3F150: using guessed type __int64 (__fastcall *off_3F150[2])(IOUSBCommandPool::MetaClass *__hidden this);
// 496C0: using guessed type _QWORD IOUSBCommand::gMetaClass;
// 496E8: using guessed type _QWORD IOUSBIsocCommand::gMetaClass;
// 49710: using guessed type _QWORD IOUSBCommandPool::gMetaClass;
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000014550) ----------------------------------------------------
__int64 `global destructor keyed to'_a_5()
{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOUSBCommandPool::gMetaClass);
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOUSBIsocCommand::gMetaClass);
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&IOUSBCommand::gMetaClass);
}
// 496C0: using guessed type _QWORD IOUSBCommand::gMetaClass;
// 496E8: using guessed type _QWORD IOUSBIsocCommand::gMetaClass;
// 49710: using guessed type _QWORD IOUSBCommandPool::gMetaClass;

//----- (0000000000014580) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceIterator::MetaClass::MetaClass(IOUSBInterfaceIterator::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBInterfaceIterator", off_3B018[0], 40LL);
  result = (__int64)off_3F3C0;
  *(_QWORD *)this = off_3F3C0;
  return result;
}
// 3B018: using guessed type _QWORD *off_3B018[8];
// 3F3C0: using guessed type __int64 (__fastcall *off_3F3C0[2])(IOUSBInterfaceIterator::MetaClass *__hidden this);
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000145B2) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceIterator::MetaClass::~MetaClass(IOUSBInterfaceIterator::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (00000000000145BC) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceIterator::IOUSBInterfaceIterator(__int64 a1)
{
  __int64 result; // rax@1

  OSIterator::OSIterator(a1);
  result = (__int64)off_3F250;
  *(_QWORD *)a1 = off_3F250;
  return result;
}
// 3F250: using guessed type __int64 (__fastcall *off_3F250[2])(IOUSBInterfaceIterator *__hidden this);
// 7D390: using guessed type int __cdecl OSIterator::OSIterator(_QWORD);

//----- (00000000000145DC) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceIterator::IOUSBInterfaceIterator(__int64 a1)
{
  __int64 result; // rax@1

  OSIterator::OSIterator(a1);
  result = (__int64)off_3F250;
  *(_QWORD *)a1 = off_3F250;
  return result;
}
// 3F250: using guessed type __int64 (__fastcall *off_3F250[2])(IOUSBInterfaceIterator *__hidden this);
// 7D390: using guessed type int __cdecl OSIterator::OSIterator(_QWORD);

//----- (00000000000145FC) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceIterator::~IOUSBInterfaceIterator(IOUSBInterfaceIterator *this)
{
  return OSIterator::~OSIterator(this);
}

//----- (0000000000014606) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceIterator::~IOUSBInterfaceIterator(IOUSBInterfaceIterator *this)
{
  return OSIterator::~OSIterator(this);
}

//----- (0000000000014610) ----------------------------------------------------
void __fastcall IOUSBInterfaceIterator::~IOUSBInterfaceIterator(IOUSBInterfaceIterator *this)
{
  OSIterator::~OSIterator(this);
  OSObject::operator delete((void *)this);
}

//----- (0000000000014632) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceIterator::getMetaClass(IOUSBInterfaceIterator *this)
{
  return (__int64)&IOUSBInterfaceIterator::gMetaClass;
}
// 49738: using guessed type _QWORD IOUSBInterfaceIterator::gMetaClass;

//----- (0000000000014640) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceIterator::MetaClass::MetaClass(IOUSBInterfaceIterator::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBInterfaceIterator", off_3B018[0], 40LL);
  result = (__int64)off_3F3C0;
  *(_QWORD *)this = off_3F3C0;
  return result;
}
// 3B018: using guessed type _QWORD *off_3B018[8];
// 3F3C0: using guessed type __int64 (__fastcall *off_3F3C0[2])(IOUSBInterfaceIterator::MetaClass *__hidden this);
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000014672) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceIterator::MetaClass::alloc(IOUSBInterfaceIterator::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)stru_20.segname, a2);
  OSIterator::OSIterator(v2);
  *(_QWORD *)v2 = off_3F250;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBInterfaceIterator::gMetaClass);
  return v2;
}
// 20: using guessed type segment_command_64 stru_20;
// 3F250: using guessed type __int64 (__fastcall *off_3F250[2])(IOUSBInterfaceIterator *__hidden this);
// 49738: using guessed type _QWORD IOUSBInterfaceIterator::gMetaClass;
// 7D390: using guessed type int __cdecl OSIterator::OSIterator(_QWORD);

//----- (00000000000146B2) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceIterator::IOUSBInterfaceIterator(__int64 a1)
{
  OSIterator::OSIterator(a1);
  *(_QWORD *)a1 = off_3F250;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBInterfaceIterator::gMetaClass);
}
// 3F250: using guessed type __int64 (__fastcall *off_3F250[2])(IOUSBInterfaceIterator *__hidden this);
// 49738: using guessed type _QWORD IOUSBInterfaceIterator::gMetaClass;
// 7D390: using guessed type int __cdecl OSIterator::OSIterator(_QWORD);

//----- (00000000000146E2) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceIterator::IOUSBInterfaceIterator(__int64 a1)
{
  OSIterator::OSIterator(a1);
  *(_QWORD *)a1 = off_3F250;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBInterfaceIterator::gMetaClass);
}
// 3F250: using guessed type __int64 (__fastcall *off_3F250[2])(IOUSBInterfaceIterator *__hidden this);
// 49738: using guessed type _QWORD IOUSBInterfaceIterator::gMetaClass;
// 7D390: using guessed type int __cdecl OSIterator::OSIterator(_QWORD);

//----- (0000000000014712) ----------------------------------------------------
char __fastcall IOUSBInterfaceIterator::init(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  char result; // al@2

  v3 = a3;
  if ( (unsigned __int8)(*(int (__cdecl **)(__int64))(off_3B0B0[0] + 152))(a1) )
  {
    result = 0;
    if ( a2 )
    {
      if ( v3 )
      {
        *(_QWORD *)(a1 + 24) = a2;
        (*(void (__fastcall **)(__int64))(*(_QWORD *)a2 + 32LL))(a2);
        *(_QWORD *)(a1 + 12) = *(_QWORD *)v3;
        *(_QWORD *)(a1 + 32) = 0LL;
        result = 1;
      }
    }
  }
  else
  {
    result = 0;
  }
  return result;
}
// 3B0B0: using guessed type __int64 off_3B0B0[12];

//----- (0000000000014770) ----------------------------------------------------
int __fastcall IOUSBInterfaceIterator::free(IOUSBInterfaceIterator *this)
{
  IOUSBInterfaceIterator *v1; // rbx@1
  __int64 v2; // rdi@1

  v1 = this;
  v2 = *((_QWORD *)this + 4);
  if ( v2 )
  {
    (*(void (__cdecl **)(__int64))(*(_QWORD *)v2 + 40LL))(v2);
    *((_QWORD *)v1 + 4) = 0LL;
  }
  (*(void (__cdecl **)(_QWORD))(**((_QWORD **)v1 + 3) + 40LL))(*((_QWORD *)v1 + 3));
  *((_QWORD *)v1 + 3) = 0LL;
  return (*(int (__fastcall **)(IOUSBInterfaceIterator *))(off_3B0B0[0] + 160))(v1);
}
// 3B0B0: using guessed type __int64 off_3B0B0[12];

//----- (00000000000147B8) ----------------------------------------------------
int __fastcall IOUSBInterfaceIterator::reset(IOUSBInterfaceIterator *this)
{
  IOUSBInterfaceIterator *v1; // rbx@1
  __int64 v2; // rdi@1
  int result; // eax@2

  v1 = this;
  v2 = *((_QWORD *)this + 4);
  if ( v2 )
  {
    result = (*(int (__cdecl **)(__int64))(*(_QWORD *)v2 + 40LL))(v2);
    *((_QWORD *)v1 + 4) = 0LL;
  }
  return result;
}

//----- (00000000000147E0) ----------------------------------------------------
char __fastcall IOUSBInterfaceIterator::isValid(IOUSBInterfaceIterator *this)
{
  return 1;
}

//----- (00000000000147E8) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceIterator::getNextObject(IOUSBInterfaceIterator *this)
{
  IOUSBInterfaceIterator *v1; // rbx@1
  __int64 v2; // rax@1
  __int64 v3; // r14@1
  __int64 v4; // rdi@3

  v1 = this;
  (*(void (**)(void))(*(_QWORD *)this + 32LL))();
  LODWORD(v2) = (*(int (__fastcall **)(_QWORD, _QWORD, signed __int64))(**((_QWORD **)this + 3) + 2200LL))(
                  *((_QWORD *)this + 3),
                  *((_QWORD *)v1 + 4),
                  (char *)v1 + 12);
  v3 = v2;
  if ( v2 )
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 32LL))(v2);
  v4 = *((_QWORD *)this + 4);
  if ( v4 )
    (*(void (**)(void))(*(_QWORD *)v4 + 40LL))();
  *((_QWORD *)v1 + 4) = v3;
  (*(void (__fastcall **)(IOUSBInterfaceIterator *))(*(_QWORD *)v1 + 40LL))(v1);
  return v3;
}

//----- (0000000000014842) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::MetaClass::MetaClass(IOUSBDevice::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBDevice", &IOUSBNub::gMetaClass, 240LL);
  result = (__int64)off_3FEF0;
  *(_QWORD *)this = off_3FEF0;
  return result;
}
// 3FEF0: using guessed type __int64 (__fastcall *off_3FEF0[2])(IOUSBDevice::MetaClass *__hidden this);
// 49638: using guessed type _QWORD IOUSBNub::gMetaClass;
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000014874) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::MetaClass::~MetaClass(IOUSBDevice::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000001487E) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::IOUSBDevice(__int64 a1)
{
  __int64 result; // rax@1

  IOUSBNub::IOUSBNub(a1);
  result = (__int64)off_3F4C0;
  *(_QWORD *)a1 = off_3F4C0;
  return result;
}
// 3F4C0: using guessed type __int64 (__fastcall *off_3F4C0[2])(IOUSBDevice *__hidden this);

//----- (000000000001489E) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::IOUSBDevice(__int64 a1)
{
  __int64 result; // rax@1

  IOUSBNub::IOUSBNub(a1);
  result = (__int64)off_3F4C0;
  *(_QWORD *)a1 = off_3F4C0;
  return result;
}
// 3F4C0: using guessed type __int64 (__fastcall *off_3F4C0[2])(IOUSBDevice *__hidden this);

//----- (00000000000148BE) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::~IOUSBDevice(IOUSBDevice *this)
{
  return IOUSBNub::~IOUSBNub(this);
}

//----- (00000000000148C8) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::~IOUSBDevice(IOUSBDevice *this)
{
  return IOUSBNub::~IOUSBNub(this);
}

//----- (00000000000148D2) ----------------------------------------------------
void __fastcall IOUSBDevice::~IOUSBDevice(IOUSBDevice *this)
{
  IOUSBNub::~IOUSBNub(this);
  OSObject::operator delete((void *)this);
}

//----- (00000000000148F4) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::getMetaClass(IOUSBDevice *this)
{
  return (__int64)&IOUSBDevice::gMetaClass;
}
// 49760: using guessed type _QWORD IOUSBDevice::gMetaClass;

//----- (0000000000014902) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::MetaClass::MetaClass(IOUSBDevice::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBDevice", &IOUSBNub::gMetaClass, 240LL);
  result = (__int64)off_3FEF0;
  *(_QWORD *)this = off_3FEF0;
  return result;
}
// 3FEF0: using guessed type __int64 (__fastcall *off_3FEF0[2])(IOUSBDevice::MetaClass *__hidden this);
// 49638: using guessed type _QWORD IOUSBNub::gMetaClass;
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000014934) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::MetaClass::alloc(IOUSBDevice::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&stru_B8.reloff, a2);
  IOUSBNub::IOUSBNub(v2);
  *(_QWORD *)v2 = off_3F4C0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBDevice::gMetaClass);
  return v2;
}
// B8: using guessed type section_64 stru_B8;
// 3F4C0: using guessed type __int64 (__fastcall *off_3F4C0[2])(IOUSBDevice *__hidden this);
// 49760: using guessed type _QWORD IOUSBDevice::gMetaClass;

//----- (0000000000014974) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::IOUSBDevice(__int64 a1)
{
  IOUSBNub::IOUSBNub(a1);
  *(_QWORD *)a1 = off_3F4C0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBDevice::gMetaClass);
}
// 3F4C0: using guessed type __int64 (__fastcall *off_3F4C0[2])(IOUSBDevice *__hidden this);
// 49760: using guessed type _QWORD IOUSBDevice::gMetaClass;

//----- (00000000000149A4) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::IOUSBDevice(__int64 a1)
{
  IOUSBNub::IOUSBNub(a1);
  *(_QWORD *)a1 = off_3F4C0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBDevice::gMetaClass);
}
// 3F4C0: using guessed type __int64 (__fastcall *off_3F4C0[2])(IOUSBDevice *__hidden this);
// 49760: using guessed type _QWORD IOUSBDevice::gMetaClass;

//----- (00000000000149D4) ----------------------------------------------------
void __fastcall IOUSBDevice::init(IOUSBDevice *this)
{
  JUMPOUT(__CS__, `vtable for'IOUSBNub[75]);
}
// 3D260: using guessed type __int64 `vtable for'IOUSBNub[2];

//----- (00000000000149E8) ----------------------------------------------------
char __fastcall IOUSBDevice::start(IOUSBDevice *this, uintptr_t arg2)
{
  uintptr_t v2; // r13@1
  __int64 v3; // r14@1
  int *v4; // r15@1
  const OSMetaClass *v5; // rdx@4
  const OSMetaClass *v6; // rdx@5
  __int64 v7; // rax@5
  __int64 v8; // rcx@5
  __int64 v9; // rax@8
  int (__cdecl *v10)(OSObject *, void *, void *, void *, void *); // rdx@9
  __int64 v11; // rax@9
  __int64 v12; // rcx@9
  __int64 v13; // rdi@10
  __int64 v14; // rax@11
  __int64 v15; // r8@11
  __int64 v16; // r9@11
  __int64 v17; // rcx@11
  __int64 v18; // rdx@11
  __int64 v19; // rax@12
  __int64 v20; // rax@13
  __int64 v21; // rax@14
  uintptr_t v22; // r12@15
  __int64 v23; // rax@15
  signed int v24; // er14@15
  signed int v25; // er15@15
  unsigned __int64 v26; // rsi@16
  int v27; // er13@16
  __int64 v28; // rcx@19
  signed int v29; // ebx@20
  bool v30; // zf@25
  __int64 v31; // rax@28
  __int64 v32; // r10@29
  void *v33; // rax@38
  __int64 v34; // rax@42
  __int64 v35; // rsi@42
  uintptr_t v36; // rdi@42
  char *v37; // rdx@42
  unsigned __int8 v38; // al@43
  signed int v39; // eax@47
  __int64 v40; // rax@49
  __int64 v41; // rsi@49
  unsigned __int8 v42; // al@66
  unsigned __int8 v43; // al@69
  uint64_t v44; // rax@73
  __int64 v45; // rax@73
  __int64 v46; // rax@73
  __int64 v47; // rcx@73
  char v48; // bl@75
  uintptr_t v49; // rcx@77
  uintptr_t v50; // rdx@77
  __int64 v51; // rax@78
  __int64 v52; // rdi@80
  __int64 v53; // rcx@82
  __int64 v54; // rax@82
  __int64 v55; // rdi@83
  __int64 v56; // rdi@86
  __int64 v57; // rdi@88
  __int64 v58; // rdi@90
  __int64 v59; // rax@97
  __int64 v61; // [sp+0h] [bp-150h]@0
  __int64 v62; // [sp+8h] [bp-148h]@15
  void *v63; // [sp+10h] [bp-140h]@15
  uintptr_t arg3; // [sp+18h] [bp-138h]@73
  char v65; // [sp+20h] [bp-130h]@44
  __int64 v66; // [sp+120h] [bp-30h]@1

  v2 = (uintptr_t)this;
  v3 = off_3B0E0[0];
  v66 = *(_QWORD *)off_3B0E0[0];
  v4 = &gUSBStackDebugFlags;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D083Du, (uintptr_t)this, arg2, 0LL, 0LL, 0LL);
  if ( !(unsigned __int8)((int (__fastcall *)(IOUSBDevice *, uintptr_t))`vtable for'IOUSBNub[186])(this, arg2) )
    goto LABEL_96;
  *((_QWORD *)this + 18) = OSMetaClassBase::safeMetaCast(
                             (OSMetaClassBase *)arg2,
                             (const OSMetaClassBase *)IOUSBController::metaClass,
                             v5);
  v7 = OSMetaClassBase::safeMetaCast((OSMetaClassBase *)arg2, (const OSMetaClassBase *)IOUSBControllerV3::metaClass, v6);
  v8 = *((_QWORD *)this + 29);
  *(_QWORD *)(v8 + 216) = v7;
  if ( v7 )
    *(_BYTE *)(v8 + 209) = *(_BYTE *)(*(_QWORD *)(v7 + 168) + 244LL);
  if ( !*((_QWORD *)this + 18) )
  {
LABEL_96:
    v48 = 0;
    goto LABEL_97;
  }
  LODWORD(v9) = (*(int (__fastcall **)(IOUSBDevice *, _QWORD))(*(_QWORD *)this + 1672LL))(
                  this,
                  IOUSBControllerV3::metaClass);
  *(_QWORD *)(*((_QWORD *)this + 29) + 80LL) = v9;
  if ( !v9 )
  {
    LODWORD(v19) = (*(int (__fastcall **)(IOUSBDevice *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
    v17 = v19;
    v18 = (__int64)"%s::start Couldn't get provider's workloop";
    goto LABEL_79;
  }
  (*(void (__fastcall **)(__int64))(*(_QWORD *)v9 + 32LL))(v9);
  v11 = IOCommandGate::commandGate(this, 0LL, v10);
  v12 = *((_QWORD *)this + 29);
  *(_QWORD *)(v12 + 104) = v11;
  if ( !v11 )
  {
    LODWORD(v20) = (*(int (__fastcall **)(IOUSBDevice *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
    v17 = v20;
    v18 = (__int64)"%s::start - unable to create command gate";
    goto LABEL_79;
  }
  v13 = *(_QWORD *)(v12 + 80);
  if ( (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v13 + 320LL))(v13, v11) )
  {
    LODWORD(v14) = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)v2 + 904LL))(v2, 0LL);
    v17 = v14;
    v18 = (__int64)"%s::start - unable to add command gate";
LABEL_79:
    v26 = 1431519814LL;
    KernelDebugLogInternal(1u, 0x55534246u, v18, v17, v15, v16, v61);
LABEL_80:
    v52 = *(_QWORD *)(v2 + 152);
    if ( v52 )
    {
      (*(void (__fastcall **)(__int64, unsigned __int64))(*(_QWORD *)v52 + 296LL))(v52, v26);
      IOUSBPipe::ClosePipe(*(IOUSBPipe **)(v2 + 152));
      (*(void (**)(void))(**(_QWORD **)(v2 + 152) + 40LL))();
      *(_QWORD *)(v2 + 152) = 0LL;
    }
    v53 = *(_QWORD *)(v2 + 232);
    v54 = *(_QWORD *)(v53 + 104);
    if ( v54 )
    {
      v55 = *(_QWORD *)(v53 + 80);
      if ( v55 )
      {
        v26 = *(_QWORD *)(v53 + 104);
        (*(void (__fastcall **)(__int64, __int64))(*(_QWORD *)v55 + 328LL))(v55, v54);
        v54 = *(_QWORD *)(*(_QWORD *)(v2 + 232) + 104LL);
      }
      (*(void (__fastcall **)(__int64, unsigned __int64))(*(_QWORD *)v54 + 40LL))(v54, v26);
      v53 = *(_QWORD *)(v2 + 232);
      *(_QWORD *)(v53 + 104) = 0LL;
    }
    v56 = *(_QWORD *)(v53 + 80);
    if ( v56 )
    {
      (*(void (__fastcall **)(__int64, unsigned __int64))(*(_QWORD *)v56 + 40LL))(v56, v26);
      v53 = *(_QWORD *)(v2 + 232);
      *(_QWORD *)(v53 + 80) = 0LL;
    }
    v57 = *(_QWORD *)(v53 + 136);
    if ( v57 )
    {
      thread_call_cancel(v57);
      thread_call_free(*(_QWORD *)(*(_QWORD *)(v2 + 232) + 136LL));
      v53 = *(_QWORD *)(v2 + 232);
    }
    v58 = *(_QWORD *)(v53 + 48);
    if ( v58 )
    {
      thread_call_cancel(v58);
      thread_call_free(*(_QWORD *)(*(_QWORD *)(v2 + 232) + 48LL));
    }
    if ( *(_BYTE *)v4 & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      v49 = arg3;
      v48 = 0;
      v50 = 0LL;
      goto LABEL_95;
    }
    goto LABEL_96;
  }
  LODWORD(v21) = IOLockAlloc(v13);
  *(_QWORD *)(*(_QWORD *)(v2 + 232) + 176LL) = v21;
  if ( !v21 )
  {
    LODWORD(v31) = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)v2 + 904LL))(v2, 0LL);
    v17 = v31;
    v18 = (__int64)"%s::start - unable to allocate _INTERFACEARRAYLOCK";
    goto LABEL_79;
  }
  *(_BYTE *)(v2 + 186) = 8;
  *(_WORD *)(v2 + 187) = 5;
  *(_BYTE *)(v2 + 189) = 0;
  v63 = (void *)(v2 + 160);
  *(_WORD *)(v2 + 190) = *(_BYTE *)(v2 + 167);
  *(_BYTE *)(v2 + 192) = 0;
  *(_QWORD *)(v2 + 152) = IOUSBPipeV2::ToEndpoint(v2 + 186, 0LL, v2, *(_QWORD *)(v2 + 144), 0LL);
  v22 = v2;
  LODWORD(v23) = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)v2 + 696LL))(v2, "kAllowZeroNumConfigs");
  v62 = v23;
  v61 = **(_QWORD **)off_3B0F8[0];
  v24 = 3;
  v25 = 30;
  do
  {
    bzero(v63, 0x12uLL);
    v26 = (unsigned __int64)v63;
    v27 = (*(int (__fastcall **)(uintptr_t, void *, signed __int64))(*(_QWORD *)v22 + 2160LL))(v22, v63, 18LL);
    if ( !v27 || v27 == -536870168 && (v27 = -536870168, *(_BYTE *)(v22 + 161) == 1) )
    {
      v28 = *(_WORD *)(v22 + 162);
      v27 = -536854449;
      if ( *(_WORD *)(v22 + 162) )
      {
        v2 = v22;
        v32 = *(_WORD *)(v22 + 168);
        if ( v32 == 1133 && *(_WORD *)(v22 + 170) == 2115 && *(_WORD *)(v22 + 172) == 19 )
          *(_BYTE *)(v22 + 177) = 2;
        v4 = &gUSBStackDebugFlags;
        v3 = off_3B0E0[0];
        if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        {
          v26 = *(_BYTE *)(v22 + 167) | ((unsigned __int64)*(_BYTE *)(v22 + 166) << 8) | ((unsigned __int64)*(_BYTE *)(v22 + 165) << 16) | ((unsigned __int64)*(_BYTE *)(v22 + 164) << 24) | (v28 << 32) | ((unsigned __int64)*(_BYTE *)(v22 + 161) << 48) | ((unsigned __int64)*(_BYTE *)(v22 + 160) << 56);
          kernel_debug(
            0x52D083Cu,
            v26,
            *(_BYTE *)(v22 + 175) | ((unsigned __int64)*(_BYTE *)(v22 + 174) << 8) | (v32 << 48) | ((unsigned __int64)*(_WORD *)(v22 + 170) << 32) | (*(_WORD *)(v22 + 172) << 16),
            *(_BYTE *)(v22 + 177) | ((unsigned __int64)*(_BYTE *)(v22 + 176) << 8),
            1uLL,
            0LL);
        }
        goto LABEL_36;
      }
    }
    v29 = 3;
    if ( v24 != 1 )
    {
      if ( !v24 )
        v25 = 30;
      v29 = v25;
    }
    IOSleep((unsigned int)v29);
    if ( !v27 )
      break;
    v30 = v24-- == 0;
    v25 = v29;
  }
  while ( !v30 );
  v30 = v27 == 0;
  v3 = off_3B0E0[0];
  v4 = &gUSBStackDebugFlags;
  v2 = v22;
  if ( !v30 )
    goto LABEL_80;
LABEL_36:
  if ( *(_BYTE *)(v2 + 177) || v62 == v61 )
  {
    LODWORD(v33) = IOMalloc(8LL * *(_BYTE *)(v2 + 177));
    *(_QWORD *)(v2 + 208) = v33;
    if ( !v33 )
      goto LABEL_80;
    bzero(v33, 8LL * *(_BYTE *)(v2 + 177));
  }
  if ( *(_WORD *)(v2 + 168) == 5118 && (*(_WORD *)(v2 + 170) | 0x100) == 7936 )
  {
    (*(void (__fastcall **)(uintptr_t, _QWORD, _QWORD))(*(_QWORD *)v2 + 944LL))(v2, "USB HD", 0LL);
    v34 = *(_QWORD *)v2;
    v35 = (__int64)"USB Product Name";
    v36 = v2;
    v37 = "USB HD";
LABEL_72:
    (*(void (__fastcall **)(uintptr_t, __int64, char *))(v34 + 624))(v36, v35, v37);
    goto LABEL_73;
  }
  v38 = *(_BYTE *)(v2 + 175);
  if ( v38 )
  {
    if ( !(*(int (__fastcall **)(uintptr_t, _QWORD, char *, signed __int64, signed __int64))(*(_QWORD *)v2 + 2392LL))(
            v2,
            v38,
            &v65,
            256LL,
            1033LL)
      && v65 )
    {
      (*(void (__fastcall **)(uintptr_t, char *, _QWORD))(*(_QWORD *)v2 + 944LL))(v2, &v65, 0LL);
      (*(void (__fastcall **)(uintptr_t, _QWORD, char *))(*(_QWORD *)v2 + 624LL))(v2, "USB Product Name", &v65);
    }
  }
  else
  {
    v39 = *(_BYTE *)(v2 + 164);
    if ( v39 > 219 )
    {
      if ( v39 > 253 )
      {
        if ( v39 == 254 )
        {
          v40 = *(_QWORD *)v2;
          v41 = (__int64)"ApplicationSpecific";
        }
        else
        {
          if ( v39 != 255 )
            goto LABEL_66;
          v40 = *(_QWORD *)v2;
          v41 = (__int64)"VendorSpecificDevice";
        }
      }
      else if ( v39 == 220 )
      {
        v40 = *(_QWORD *)v2;
        v41 = (__int64)"DiagnosticDevice";
      }
      else if ( v39 == 224 )
      {
        v40 = *(_QWORD *)v2;
        v41 = (__int64)"WirelessControllerDevice";
      }
      else
      {
        if ( v39 != 239 )
          goto LABEL_66;
        v40 = *(_QWORD *)v2;
        v41 = (__int64)"MiscellaneousDevice";
      }
LABEL_65:
      (*(void (__fastcall **)(uintptr_t, __int64, _QWORD))(v40 + 944))(v2, v41, 0LL);
      goto LABEL_66;
    }
    switch ( v39 )
    {
      case 0:
        v40 = *(_QWORD *)v2;
        v41 = (__int64)"CompositeDevice";
        goto LABEL_65;
      case 1:
        v40 = *(_QWORD *)v2;
        v41 = (__int64)"AudioDevice";
        goto LABEL_65;
      case 2:
        v40 = *(_QWORD *)v2;
        v41 = (__int64)"CommunicationsDevice";
        goto LABEL_65;
      case 9:
        v40 = *(_QWORD *)v2;
        v41 = (__int64)"HubDevice";
        goto LABEL_65;
      case 10:
        v40 = *(_QWORD *)v2;
        v41 = (__int64)"DataDevice";
        goto LABEL_65;
      default:
        break;
    }
  }
LABEL_66:
  v42 = *(_BYTE *)(v2 + 174);
  if ( v42
    && !(*(int (__fastcall **)(uintptr_t, _QWORD, char *, signed __int64, signed __int64))(*(_QWORD *)v2 + 2392LL))(
          v2,
          v42,
          &v65,
          256LL,
          1033LL) )
    (*(void (__fastcall **)(uintptr_t, _QWORD, char *))(*(_QWORD *)v2 + 624LL))(v2, "USB Vendor Name", &v65);
  v43 = *(_BYTE *)(v2 + 176);
  if ( v43
    && !(*(int (__fastcall **)(uintptr_t, _QWORD, char *, signed __int64, signed __int64))(*(_QWORD *)v2 + 2392LL))(
          v2,
          v43,
          &v65,
          256LL,
          1033LL) )
  {
    v34 = *(_QWORD *)v2;
    v35 = (__int64)"USB Serial Number";
    v37 = &v65;
    v36 = v2;
    goto LABEL_72;
  }
LABEL_73:
  (*(void (__fastcall **)(uintptr_t, _QWORD, _QWORD, signed __int64))(*(_QWORD *)v2 + 640LL))(
    v2,
    "bDeviceClass",
    *(_BYTE *)(v2 + 164),
    8LL);
  (*(void (__fastcall **)(uintptr_t, _QWORD, _QWORD, signed __int64))(*(_QWORD *)v2 + 640LL))(
    v2,
    "bDeviceSubClass",
    *(_BYTE *)(v2 + 165),
    8LL);
  (*(void (__fastcall **)(uintptr_t, _QWORD, _QWORD, signed __int64))(*(_QWORD *)v2 + 640LL))(
    v2,
    "bDeviceProtocol",
    *(_BYTE *)(v2 + 166),
    8LL);
  (*(void (__fastcall **)(uintptr_t, _QWORD, _QWORD, signed __int64))(*(_QWORD *)v2 + 640LL))(
    v2,
    "bMaxPacketSize0",
    *(_BYTE *)(v2 + 167),
    8LL);
  (*(void (__fastcall **)(uintptr_t, _QWORD, _QWORD, signed __int64))(*(_QWORD *)v2 + 640LL))(
    v2,
    "idVendor",
    *(_WORD *)(v2 + 168),
    16LL);
  (*(void (__fastcall **)(uintptr_t, _QWORD, _QWORD, signed __int64))(*(_QWORD *)v2 + 640LL))(
    v2,
    "idProduct",
    *(_WORD *)(v2 + 170),
    16LL);
  (*(void (__fastcall **)(uintptr_t, _QWORD, _QWORD, signed __int64))(*(_QWORD *)v2 + 640LL))(
    v2,
    "bcdDevice",
    *(_WORD *)(v2 + 172),
    16LL);
  (*(void (__fastcall **)(uintptr_t, _QWORD, _QWORD, signed __int64))(*(_QWORD *)v2 + 640LL))(
    v2,
    "iManufacturer",
    *(_BYTE *)(v2 + 174),
    8LL);
  (*(void (__fastcall **)(uintptr_t, _QWORD, _QWORD, signed __int64))(*(_QWORD *)v2 + 640LL))(
    v2,
    "iProduct",
    *(_BYTE *)(v2 + 175),
    8LL);
  (*(void (__fastcall **)(uintptr_t, _QWORD, _QWORD, signed __int64))(*(_QWORD *)v2 + 640LL))(
    v2,
    "iSerialNumber",
    *(_BYTE *)(v2 + 176),
    8LL);
  (*(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v2 + 640LL))(
    v2,
    "bNumConfigurations",
    *(_BYTE *)(v2 + 177),
    8LL);
  (*(void (__fastcall **)(uintptr_t, _QWORD, _QWORD, signed __int64))(*(_QWORD *)v2 + 640LL))(
    v2,
    "bcdUSB",
    *(_WORD *)(v2 + 162),
    16LL);
  (*(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v2 + 640LL))(
    v2,
    "Device Speed",
    *(_BYTE *)(v2 + 184),
    8LL);
  (*(void (__fastcall **)(uintptr_t, _QWORD, _QWORD, signed __int64))(*(_QWORD *)v2 + 640LL))(
    v2,
    "Bus Power Available",
    *(_DWORD *)(v2 + 180),
    32LL);
  (*(void (__fastcall **)(uintptr_t, _QWORD, _QWORD, signed __int64))(*(_QWORD *)v2 + 640LL))(
    v2,
    "USB Address",
    *(_WORD *)(v2 + 136),
    16LL);
  v44 = mach_absolute_time();
  absolutetime_to_nanoseconds(v44, &arg3);
  (*(void (__fastcall **)(uintptr_t, _QWORD, uintptr_t, signed __int64))(*(_QWORD *)v2 + 640LL))(
    v2,
    "sessionID",
    arg3,
    64LL);
  LODWORD(v45) = thread_call_allocate(IOUSBDevice::DoMessageClientsEntry, v2);
  *(_QWORD *)(*(_QWORD *)(v2 + 232) + 136LL) = v45;
  LODWORD(v46) = thread_call_allocate(IOUSBDevice::ProcessPortReEnumerateEntry, v2);
  v47 = *(_QWORD *)(v2 + 232);
  *(_QWORD *)(v47 + 48) = v46;
  if ( !*(_QWORD *)(v47 + 136) || !v46 )
  {
    LODWORD(v51) = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)v2 + 904LL))(v2, 0LL);
    v17 = v51;
    v18 = (__int64)"%s::start could not allocate all thread functions.  Aborting start";
    goto LABEL_79;
  }
  *(_QWORD *)(v47 + 184) = 0LL;
  *(_BYTE *)(v2 + 224) = 0;
  v48 = 1;
  if ( *(_BYTE *)v4 & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
  {
    v49 = arg3;
    v50 = 1LL;
LABEL_95:
    kernel_debug(0x52D083Eu, v2, v50, v49, 0LL, 0LL);
  }
LABEL_97:
  v59 = *(_QWORD *)v3;
  if ( *(_QWORD *)v3 == v66 )
    LOBYTE(v59) = v48;
  return v59;
}
// 3B0E0: using guessed type __int64 off_3B0E0[6];
// 3B0F8: using guessed type __int64 off_3B0F8[3];
// 3B100: using guessed type __int64 off_3B100[2];
// 3BBF8: using guessed type _QWORD IOUSBController::metaClass;
// 3D260: using guessed type __int64 `vtable for'IOUSBNub[2];
// 44350: using guessed type _QWORD IOUSBControllerV3::metaClass;
// 49460: using guessed type int gUSBStackDebugFlags;
// 7D220: using guessed type int __cdecl IOLockAlloc(_QWORD);
// 7D250: using guessed type int __fastcall IOMalloc(_QWORD);
// 7D278: using guessed type int __fastcall IOSleep(_QWORD);
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);
// 7E158: using guessed type int __fastcall absolutetime_to_nanoseconds(_QWORD, _QWORD);
// 7E220: using guessed type int __fastcall thread_call_allocate(_QWORD, _QWORD);
// 7E228: using guessed type int __fastcall thread_call_cancel(_QWORD);
// 7E238: using guessed type int __fastcall thread_call_free(_QWORD);

//----- (00000000000154F8) ----------------------------------------------------
int __fastcall IOUSBDevice::DoMessageClientsEntry(IOUSBDevice *this, OSObject *a2, void *a3)
{
  OSObject *v3; // r14@1
  __int64 v4; // rax@1
  __int64 v5; // rbx@1
  __int64 v6; // rsi@2
  int v8; // [sp+Ch] [bp-14h]@2

  v3 = a2;
  v4 = OSMetaClassBase::safeMetaCast(this, (const OSMetaClassBase *)&IOUSBDevice::gMetaClass, (const OSMetaClass *)a3);
  v5 = v4;
  if ( v4 )
  {
    v6 = *(_DWORD *)a2;
    v8 = *((_DWORD *)v3 + 1);
    (*(void (__fastcall **)(__int64, __int64, int *, signed __int64))(*(_QWORD *)v4 + 1856LL))(v4, v6, &v8, 4LL);
    IOFree(v3, 8LL);
    LODWORD(v4) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v5 + 40LL))(v5, 8LL);
  }
  return v4;
}
// 49760: using guessed type _QWORD IOUSBDevice::gMetaClass;
// 7D218: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000015558) ----------------------------------------------------
int __fastcall IOUSBDevice::ProcessPortReEnumerateEntry(IOUSBDevice *this, OSObject *a2, void *a3)
{
  uintptr_t v3; // rax@1
  uintptr_t v4; // rbx@1

  v3 = OSMetaClassBase::safeMetaCast(this, (const OSMetaClassBase *)&IOUSBDevice::gMetaClass, (const OSMetaClass *)a3);
  v4 = v3;
  if ( v3 )
  {
    IOUSBDevice::ProcessPortReEnumerate(v3, (unsigned int)a2);
    *(_BYTE *)(*(_QWORD *)(v4 + 232) + 56LL) = 0;
    LODWORD(v3) = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)v4 + 40LL))(v4, (unsigned int)a2);
  }
  return v3;
}
// 49760: using guessed type _QWORD IOUSBDevice::gMetaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000001559E) ----------------------------------------------------
char __fastcall IOUSBDevice::handleIsOpen(IOUSBDevice *this, const IOService *a2, const OSMetaClass *a3)
{
  IOUSBDevice *v3; // r14@1
  __int64 v4; // rdi@4
  char v5; // cl@5
  char result; // al@5
  __int64 v7; // rdi@7
  bool v8; // zf@8

  v3 = this;
  if ( a2 )
  {
    if ( !OSMetaClassBase::safeMetaCast(a2, (const OSMetaClassBase *)IOUSBInterface::metaClass, a3)
      && !OSMetaClassBase::metaCast(a2, "IOUSBDeviceUserClientV2") )
      return ((int (__fastcall *)(IOUSBDevice *, const IOService *))`vtable for'IOUSBNub[193])(v3, a2);
    v4 = *(_QWORD *)(*((_QWORD *)this + 29) + 112LL);
    if ( !v4 )
      return ((int (__fastcall *)(IOUSBDevice *, const IOService *))`vtable for'IOUSBNub[193])(v3, a2);
    v5 = (*(int (__fastcall **)(__int64, const IOService *))(*(_QWORD *)v4 + 480LL))(v4, a2);
    result = 1;
    if ( !v5 )
      return ((int (__fastcall *)(_QWORD, _QWORD))`vtable for'IOUSBNub[193])(v3, a2);
  }
  else
  {
    v7 = *(_QWORD *)(*((_QWORD *)this + 29) + 112LL);
    if ( !v7 )
      return ((int (__fastcall *)(_QWORD, _QWORD))`vtable for'IOUSBNub[193])(v3, a2);
    v8 = (*(int (**)(void))(*(_QWORD *)v7 + 304LL))() == 0;
    result = 1;
    if ( v8 )
      return ((int (__fastcall *)(_QWORD, _QWORD))`vtable for'IOUSBNub[193])(v3, a2);
  }
  return result;
}
// 3C7A0: using guessed type _QWORD IOUSBInterface::metaClass;
// 3D260: using guessed type __int64 `vtable for'IOUSBNub[2];
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000015638) ----------------------------------------------------
char __fastcall IOUSBDevice::handleOpen(IOUSBDevice *this, IOService *a2, const OSMetaClass *a3, void *a4)
{
  void *v4; // r15@1
  int v5; // er12@1
  IOService *v6; // rbx@1
  IOUSBDevice *v7; // r14@1
  __int64 v8; // rdi@4
  char result; // al@6

  v4 = a4;
  v5 = (signed int)a3;
  v6 = a2;
  v7 = this;
  LODWORD(a2) = IOUSBInterface::metaClass;
  if ( OSMetaClassBase::safeMetaCast(v6, (const OSMetaClassBase *)IOUSBInterface::metaClass, a3)
    || (a2 = (IOService *)"IOUSBDeviceUserClientV2", OSMetaClassBase::metaCast(v6, "IOUSBDeviceUserClientV2"))
    && !(v5 & 0x20000) )
  {
    v8 = *(_QWORD *)(*((_QWORD *)this + 29) + 112LL);
    if ( v8
      || (v8 = OSSet::withCapacity((OSSet *)((char *)&dword_0 + 1), (unsigned int)a2),
          (*(_QWORD *)(*((_QWORD *)v7 + 29) + 112LL) = v8) != 0LL) )
    {
      (*(void (__fastcall **)(__int64, IOService *))(*(_QWORD *)v8 + 448LL))(v8, v6);
      result = 1;
    }
    else
    {
      result = 0;
    }
  }
  else
  {
    result = ((int (__fastcall *)(IOUSBDevice *, IOService *, _QWORD, void *))`vtable for'IOUSBNub[191])(
               this,
               v6,
               (unsigned int)v5,
               v4);
  }
  return result;
}
// 0: using guessed type int dword_0;
// 3C7A0: using guessed type _QWORD IOUSBInterface::metaClass;
// 3D260: using guessed type __int64 `vtable for'IOUSBNub[2];
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (00000000000156E8) ----------------------------------------------------
int __fastcall IOUSBDevice::handleClose(IOUSBDevice *this, IOService *a2, const OSMetaClass *a3)
{
  int v3; // er14@1
  __int64 v4; // rax@4
  __int64 v5; // rdi@4

  v3 = (signed int)a3;
  if ( !OSMetaClassBase::safeMetaCast(a2, (const OSMetaClassBase *)IOUSBInterface::metaClass, a3)
    && (!OSMetaClassBase::metaCast(a2, "IOUSBDeviceUserClientV2") || v3 & 0x20000) )
    JUMPOUT(__CS__, `vtable for'IOUSBNub[192]);
  v4 = *((_QWORD *)this + 29);
  v5 = *(_QWORD *)(v4 + 112);
  if ( v5 )
    LODWORD(v4) = (*(int (__fastcall **)(__int64, IOService *))(*(_QWORD *)v5 + 472LL))(v5, a2);
  return v4;
}
// 3C7A0: using guessed type _QWORD IOUSBInterface::metaClass;
// 3D260: using guessed type __int64 `vtable for'IOUSBNub[2];
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000015784) ----------------------------------------------------
char __fastcall IOUSBDevice::terminate(IOUSBDevice *this, unsigned int a2)
{
  IOUSBDevice *v2; // r15@1
  __int64 v3; // rax@1
  __int64 v4; // rdi@1
  signed __int64 v5; // rdi@5
  __int64 v6; // rdx@8
  int v7; // eax@8
  __int64 v8; // rdi@9
  __int64 v9; // rdi@15
  __int64 v10; // rdi@21
  __int64 v11; // rdi@27
  __int64 v12; // rax@30
  char v13; // bl@32

  v2 = this;
  v3 = *((_QWORD *)this + 29);
  v4 = *(_QWORD *)(v3 + 216);
  if ( v4 )
  {
    (*(void (__fastcall **)(__int64, _QWORD, signed __int64))(*(_QWORD *)v4 + 3136LL))(v4, *((_WORD *)v2 + 68), 1LL);
    v3 = *((_QWORD *)v2 + 29);
  }
  if ( *(_BYTE *)(v3 + 208) )
  {
    *(_BYTE *)(v3 + 208) = 0;
    if ( *(_BYTE *)(v3 + 209) )
      v5 = *(_QWORD *)(*(_QWORD *)(v3 + 216) + 672LL) + 332LL;
    else
      v5 = (signed __int64)&IOUSBController::gExternalNonSSPortsUsingExtraCurrent;
    OSDecrementAtomic(v5);
  }
  v6 = *((_QWORD *)v2 + 29);
  v7 = 0;
  if ( *(_DWORD *)(v6 + 152) )
  {
    v8 = *(_QWORD *)(v6 + 144);
    if ( v8 )
    {
      if ( (*(int (__fastcall **)(__int64, _QWORD, _QWORD))(*(_QWORD *)v8 + 2192LL))(v8, *(_DWORD *)v6, 0LL) )
      {
LABEL_13:
        v7 = (*(int (__fastcall **)(IOUSBDevice *, signed __int64, _QWORD))(*(_QWORD *)v2 + 2496LL))(v2, 5LL, 0LL);
        v6 = *((_QWORD *)v2 + 29);
        goto LABEL_14;
      }
      v6 = *((_QWORD *)v2 + 29);
    }
    *(_DWORD *)(v6 + 152) = 0;
    goto LABEL_13;
  }
LABEL_14:
  if ( *(_DWORD *)(v6 + 156) )
  {
    v9 = *(_QWORD *)(v6 + 144);
    if ( v9 )
      v7 = (*(int (__fastcall **)(__int64, _QWORD, signed __int64))(*(_QWORD *)v9 + 2192LL))(v9, *(_DWORD *)v6, 1LL);
    if ( !v7 )
      *(_DWORD *)(*((_QWORD *)v2 + 29) + 156LL) = 0;
    v7 = (*(int (__fastcall **)(IOUSBDevice *, signed __int64, _QWORD))(*(_QWORD *)v2 + 2496LL))(v2, 4LL, 0LL);
    v6 = *((_QWORD *)v2 + 29);
  }
  if ( *(_DWORD *)(v6 + 200) )
  {
    v10 = *(_QWORD *)(v6 + 144);
    if ( v10 )
      v7 = (*(int (__fastcall **)(__int64, _QWORD, signed __int64))(*(_QWORD *)v10 + 2192LL))(v10, *(_DWORD *)v6, 6LL);
    if ( !v7 )
      *(_DWORD *)(*((_QWORD *)v2 + 29) + 200LL) = 0;
    v7 = (*(int (__fastcall **)(IOUSBDevice *, signed __int64, _QWORD))(*(_QWORD *)v2 + 2496LL))(v2, 4LL, 0LL);
    v6 = *((_QWORD *)v2 + 29);
  }
  if ( *(_DWORD *)(v6 + 204) )
  {
    v11 = *(_QWORD *)(v6 + 144);
    if ( v11 )
      v7 = (*(int (__fastcall **)(__int64, _QWORD, signed __int64))(*(_QWORD *)v11 + 2192LL))(v11, *(_DWORD *)v6, 7LL);
    if ( !v7 )
    {
      v12 = *((_QWORD *)v2 + 29);
      *(_DWORD *)(v12 + 204) = 0;
      *(_BYTE *)(v12 + 196) = 0;
    }
    (*(void (__fastcall **)(IOUSBDevice *, signed __int64, _QWORD))(*(_QWORD *)v2 + 2496LL))(v2, 4LL, 0LL);
  }
  v13 = ((int (__fastcall *)(IOUSBDevice *, _QWORD))`vtable for'IOUSBNub[194])(v2, a2);
  IOUSBDevice::TerminateInterfaces(v2, 0);
  return v13;
}
// 3D260: using guessed type __int64 `vtable for'IOUSBNub[2];
// 49584: using guessed type _QWORD IOUSBController::gExternalNonSSPortsUsingExtraCurrent;
// 7D290: using guessed type int __fastcall OSDecrementAtomic(_QWORD);

//----- (0000000000015984) ----------------------------------------------------
int __fastcall IOUSBDevice::TerminateInterfaces(IOUSBDevice *this, char a2)
{
  IOUSBDevice *v2; // r13@1
  __int64 v3; // rax@1
  __int64 v4; // rdi@1
  OSMetaClassBase *v5; // rax@2
  const OSMetaClass *v6; // rdx@2
  __int64 v7; // rbx@3
  void (__fastcall *v8)(_QWORD, _QWORD); // r12@3
  int v9; // eax@3
  __int64 v10; // r12@4
  __int64 v11; // rax@7
  __int64 v12; // rdi@8
  __int64 v13; // rcx@9
  __int64 v14; // r8@9
  __int64 v15; // r9@9
  int v17; // [sp+Ch] [bp-34h]@7
  __int64 v18; // [sp+10h] [bp-30h]@10

  v2 = this;
  IOLockLock(*(_QWORD *)(*((_QWORD *)this + 29) + 176LL));
  v3 = *((_QWORD *)this + 29);
  v4 = *(_QWORD *)(v3 + 184);
  if ( v4 )
  {
    for ( LODWORD(v5) = (*(int (**)(void))(*(_QWORD *)v4 + 496LL))();
          ;
          LODWORD(v5) = (*(int (**)(void))(**(_QWORD **)(*((_QWORD *)v2 + 29) + 184LL) + 496LL))() )
    {
      v10 = OSMetaClassBase::safeMetaCast(v5, (const OSMetaClassBase *)IOUSBInterface::metaClass, v6);
      if ( !v10 )
        break;
      if ( a2 && !(unsigned __int8)(*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v10 + 1536LL))(v10, 1LL) )
      {
        v17 = 0;
        v11 = *((_QWORD *)v2 + 29);
        if ( v11 && (v12 = *(_QWORD *)(v11 + 80)) != 0 && (unsigned __int8)(*(int (**)(void))(*(_QWORD *)v12 + 312LL))() )
        {
          clock_interval_to_deadline(1LL, 1000000000LL, &v18, v13, v14, v15);
          (*(void (__fastcall **)(_QWORD, int *, __int64, signed __int64))(**(_QWORD **)(*((_QWORD *)v2 + 29) + 104LL)
                                                                         + 496LL))(
            *(_QWORD *)(*((_QWORD *)v2 + 29) + 104LL),
            &v17,
            v18,
            2LL);
        }
        else
        {
          IOSleep(1000LL);
        }
        (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v10 + 1536LL))(v10, 1LL);
      }
      v7 = *(_QWORD *)(*((_QWORD *)v2 + 29) + 184LL);
      v8 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v7 + 472LL);
      v9 = (*(int (__fastcall **)(_QWORD))(*(_QWORD *)v7 + 304LL))(*(_QWORD *)(*((_QWORD *)v2 + 29) + 184LL));
      v8(v7, (unsigned int)(v9 - 1));
    }
    (*(void (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(*((_QWORD *)v2 + 29) + 184LL) + 344LL))(
      *(_QWORD *)(*((_QWORD *)v2 + 29) + 184LL),
      IOUSBInterface::metaClass);
    (*(void (**)(void))(**(_QWORD **)(*((_QWORD *)v2 + 29) + 184LL) + 40LL))();
    v3 = *((_QWORD *)v2 + 29);
    *(_QWORD *)(v3 + 184) = 0LL;
  }
  *((_BYTE *)v2 + 225) = 0;
  return IOLockUnlock(*(_QWORD *)(v3 + 176));
}
// 3C7A0: using guessed type _QWORD IOUSBInterface::metaClass;
// 7D230: using guessed type int __fastcall IOLockLock(_QWORD);
// 7D238: using guessed type int __fastcall IOLockUnlock(_QWORD);
// 7D278: using guessed type int __fastcall IOSleep(_QWORD);
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);
// 7E178: using guessed type int __fastcall clock_interval_to_deadline(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000015B2E) ----------------------------------------------------
void __fastcall IOUSBDevice::requestTerminate(IOUSBDevice *this, IOService *a2)
{
  JUMPOUT(__CS__, `vtable for'IOUSBNub[129]);
}
// 3D260: using guessed type __int64 `vtable for'IOUSBNub[2];

//----- (0000000000015B40) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::message(IOUSBDevice *this, __int64 a2, IOService *a3, void *a4)
{
  int v4; // er13@1
  __int64 v5; // rax@6
  OSMetaClassBase *v6; // r14@7
  signed __int64 v7; // rsi@8
  const OSMetaClass *v8; // rdx@8
  __int64 v9; // rax@10
  __int64 v10; // r12@10
  __int64 v11; // rax@11
  __int64 v12; // rbx@11
  unsigned __int64 v13; // rsi@18
  signed __int64 v14; // rax@19

  v4 = 0;
  if ( (signed int)a2 > -536854525 )
  {
    if ( (_DWORD)a2 == -536854524 )
    {
      v5 = *((_QWORD *)this + 29);
      v4 = -536870208;
      if ( v5 )
      {
        v6 = *(OSMetaClassBase **)(v5 + 16);
        if ( v6 )
        {
          (*(void (__fastcall **)(OSMetaClassBase *, __int64, IOService *, void *))(*(_QWORD *)v6 + 32LL))(
            v6,
            a2,
            a3,
            a4);
          v7 = IOUSBRootHubDevice::metaClass;
          if ( OSMetaClassBase::safeMetaCast(v6, (const OSMetaClassBase *)IOUSBRootHubDevice::metaClass, v8)
            || (v7 = 3758112772LL,
                (v4 = (*(int (__fastcall **)(OSMetaClassBase *, signed __int64, _QWORD, _QWORD))(*(_QWORD *)v6 + 1840LL))(
                        v6,
                        3758112772LL,
                        0LL,
                        0LL)) == 0) )
          {
            LODWORD(v9) = (*(int (__fastcall **)(OSMetaClassBase *, signed __int64))(*(_QWORD *)v6 + 1704LL))(v6, v7);
            v10 = v9;
            while ( 1 )
            {
              LODWORD(v11) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v10 + 296LL))(v10);
              v12 = v11;
              if ( !v11 )
                break;
              (*(void (__fastcall **)(__int64))(*(_QWORD *)v11 + 32LL))(v11);
              IOSleep(1LL);
              v4 = (*(int (__fastcall **)(__int64, signed __int64, IOUSBDevice *, _QWORD))(*(_QWORD *)v12 + 1840LL))(
                     v12,
                     3758112772LL,
                     this,
                     *((_QWORD *)this + 29));
              (*(void (__fastcall **)(__int64))(*(_QWORD *)v12 + 40LL))(v12);
              if ( v4 != -536870201 && v4 )
                goto LABEL_22;
            }
            v4 = 0;
LABEL_22:
            (*(void (__fastcall **)(__int64))(*(_QWORD *)v10 + 40LL))(v10);
          }
          (*(void (__fastcall **)(OSMetaClassBase *))(*(_QWORD *)v6 + 40LL))(v6);
        }
      }
    }
  }
  else
  {
    if ( (signed int)a2 <= -536870865 )
    {
      if ( (_DWORD)a2 != -536870880 )
        return (unsigned int)v4;
      goto LABEL_20;
    }
    if ( (signed int)a2 <= -536870657 )
    {
      if ( (_DWORD)a2 != -536870864 )
        return (unsigned int)v4;
      goto LABEL_20;
    }
    v13 = (unsigned int)(a2 + 536870656);
    if ( (unsigned int)v13 <= 0x20 )
    {
      v14 = 4295032833LL;
      if ( _bittest((const unsigned __int64 *)&v14, v13) )
      {
LABEL_20:
        v4 = -536870201;
        return (unsigned int)v4;
      }
    }
  }
  return (unsigned int)v4;
}
// 3DF30: using guessed type _QWORD IOUSBRootHubDevice::metaClass;
// 7D278: using guessed type int __fastcall IOSleep(_QWORD);
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000015CB4) ----------------------------------------------------
void __fastcall IOUSBDevice::stop(IOUSBDevice *this, IOService *a2)
{
  IOUSBDevice *v2; // rbx@1
  __int64 v3; // rdi@1
  __int64 v4; // rax@3
  __int64 v5; // rdi@4
  __int64 v6; // rax@6
  __int64 v7; // rdi@8

  v2 = this;
  v3 = *((_QWORD *)this + 19);
  if ( v3 )
  {
    (*(void (**)(void))(*(_QWORD *)v3 + 296LL))();
    IOUSBPipe::ClosePipe(*((IOUSBPipe **)v2 + 19));
    (*(void (**)(void))(**((_QWORD **)v2 + 19) + 40LL))();
    *((_QWORD *)v2 + 19) = 0LL;
  }
  v4 = *((_QWORD *)v2 + 29);
  if ( v4 )
  {
    v5 = *(_QWORD *)(v4 + 80);
    if ( !v5 )
      goto LABEL_14;
    if ( *(_QWORD *)(v4 + 104) )
    {
      (*(void (**)(void))(*(_QWORD *)v5 + 328LL))();
      (*(void (**)(void))(**(_QWORD **)(*((_QWORD *)v2 + 29) + 104LL) + 40LL))();
      v6 = *((_QWORD *)v2 + 29);
      *(_QWORD *)(v6 + 104) = 0LL;
      (*(void (**)(void))(**(_QWORD **)(v6 + 80) + 40LL))();
      v4 = *((_QWORD *)v2 + 29);
      *(_QWORD *)(v4 + 80) = 0LL;
    }
    if ( v4 )
    {
LABEL_14:
      v7 = *(_QWORD *)(v4 + 112);
      if ( v7 )
      {
        if ( !(*(int (**)(void))(*(_QWORD *)v7 + 304LL))() )
        {
          (*(void (**)(void))(**(_QWORD **)(*((_QWORD *)v2 + 29) + 112LL) + 40LL))();
          *(_QWORD *)(*((_QWORD *)v2 + 29) + 112LL) = 0LL;
        }
      }
    }
  }
  JUMPOUT(__CS__, `vtable for'IOUSBNub[187]);
}
// 3D260: using guessed type __int64 `vtable for'IOUSBNub[2];

//----- (0000000000015DB0) ----------------------------------------------------
void __fastcall IOUSBDevice::finalize(IOUSBDevice *this)
{
  IOUSBDevice *v1; // rbx@1
  __int64 v2; // rax@1
  __int64 v3; // rdi@2
  __int64 v4; // rdi@4

  v1 = this;
  v2 = *((_QWORD *)this + 29);
  if ( v2 )
  {
    v3 = *(_QWORD *)(v2 + 16);
    if ( v3 )
    {
      (*(void (**)(void))(*(_QWORD *)v3 + 40LL))();
      v2 = *((_QWORD *)v1 + 29);
      *(_QWORD *)(v2 + 16) = 0LL;
    }
    v4 = *(_QWORD *)(v2 + 144);
    if ( v4 )
    {
      (*(void (**)(void))(*(_QWORD *)v4 + 40LL))();
      *(_QWORD *)(*((_QWORD *)v1 + 29) + 144LL) = 0LL;
    }
  }
  JUMPOUT(__CS__, `vtable for'IOUSBNub[195]);
}
// 3D260: using guessed type __int64 `vtable for'IOUSBNub[2];

//----- (0000000000015E22) ----------------------------------------------------
void __fastcall IOUSBDevice::free(IOUSBDevice *this)
{
  IOUSBDevice *v1; // r14@1
  __int64 v2; // rdi@1
  unsigned __int8 v3; // al@2
  __int64 v4; // rbx@2
  __int64 v5; // rdi@3
  __int64 v6; // rdi@9

  v1 = this;
  v2 = *((_QWORD *)this + 26);
  if ( v2 )
  {
    v3 = *((_BYTE *)v1 + 177);
    v4 = 0LL;
    if ( v3 )
    {
      do
      {
        v5 = *(_QWORD *)(v2 + 8 * v4);
        if ( v5 )
        {
          (*(void (**)(void))(*(_QWORD *)v5 + 40LL))();
          *(_QWORD *)(*((_QWORD *)v1 + 26) + 8 * v4) = 0LL;
          v3 = *((_BYTE *)v1 + 177);
        }
        ++v4;
        v2 = *((_QWORD *)v1 + 26);
      }
      while ( (signed int)v4 < v3 );
    }
    else
    {
      v3 = 0;
    }
    IOFree(v2, 8LL * v3);
    *((_QWORD *)v1 + 26) = 0LL;
  }
  *((_BYTE *)v1 + 224) = 0;
  v6 = *((_QWORD *)v1 + 29);
  if ( v6 )
  {
    if ( *(_QWORD *)(v6 + 136) )
    {
      thread_call_cancel(*(_QWORD *)(v6 + 136));
      thread_call_free(*(_QWORD *)(*((_QWORD *)v1 + 29) + 136LL));
      v6 = *((_QWORD *)v1 + 29);
      *(_QWORD *)(v6 + 136) = 0LL;
    }
    if ( *(_QWORD *)(v6 + 48) )
    {
      thread_call_cancel(*(_QWORD *)(v6 + 48));
      thread_call_free(*(_QWORD *)(*((_QWORD *)v1 + 29) + 48LL));
      v6 = *((_QWORD *)v1 + 29);
      *(_QWORD *)(v6 + 48) = 0LL;
    }
    if ( *(_QWORD *)(v6 + 176) )
    {
      IOLockFree(*(_QWORD *)(v6 + 176));
      v6 = *((_QWORD *)v1 + 29);
      *(_QWORD *)(v6 + 176) = 0LL;
    }
    IOFree(v6, 240LL);
    *((_QWORD *)v1 + 29) = 0LL;
  }
  JUMPOUT(__CS__, `vtable for'IOUSBNub[20]);
}
// 3D260: using guessed type __int64 `vtable for'IOUSBNub[2];
// 7D218: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// 7D228: using guessed type int __fastcall IOLockFree(_QWORD);
// 7E228: using guessed type int __fastcall thread_call_cancel(_QWORD);
// 7E238: using guessed type int __fastcall thread_call_free(_QWORD);

//----- (0000000000015F66) ----------------------------------------------------
int __fastcall IOUSBDevice::joinPMtree(IOUSBDevice *this, IOService *a2)
{
  bool v2; // zf@1
  __int64 v3; // rax@1
  __int64 v4; // rdi@3

  v2 = OSMetaClassBase::metaCast(a2, "AppleUSBCompositePM") == 0LL;
  v3 = *((_QWORD *)this + 29);
  if ( !v2 )
    *(_QWORD *)(v3 + 224) = a2;
  v4 = *(_QWORD *)(v3 + 144);
  if ( !v4 )
    JUMPOUT(__CS__, `vtable for'IOUSBNub[246]);
  return (*(int (__fastcall **)(__int64, IOService *))(*(_QWORD *)v4 + 1952LL))(v4, a2);
}
// 3D260: using guessed type __int64 `vtable for'IOUSBNub[2];

//----- (0000000000015FCC) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::NewDevice(IOUSBDevice *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&stru_B8.reloff, a2);
  IOUSBNub::IOUSBNub(v2);
  *(_QWORD *)v2 = off_3F4C0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBDevice::gMetaClass);
  return v2;
}
// B8: using guessed type section_64 stru_B8;
// 3F4C0: using guessed type __int64 (__fastcall *off_3F4C0[2])(IOUSBDevice *__hidden this);
// 49760: using guessed type _QWORD IOUSBDevice::gMetaClass;

//----- (000000000001600C) ----------------------------------------------------
char __fastcall IOUSBDevice::init(IOUSBDevice *this, __int16 a2, int a3, char a4, char a5)
{
  char v5; // r15@1
  int v6; // er13@1
  __int16 v7; // r12@1
  char v8; // r14@1
  const char *v9; // rsi@1
  __int64 v10; // rax@2
  void *v11; // rax@3
  signed int v12; // edx@5
  __int64 v13; // r15@7
  __int64 v14; // r12@8
  char v16; // [sp+0h] [bp-2Ch]@1

  v16 = a5;
  v5 = a4;
  v6 = a3;
  v7 = a2;
  v8 = 0;
  v9 = 0LL;
  if ( (unsigned __int8)((int (__fastcall *)(IOUSBDevice *, _QWORD))`vtable for'IOUSBNub[75])(this, 0LL) )
  {
    v10 = *((_QWORD *)this + 29);
    if ( !v10 )
    {
      LODWORD(v11) = IOMalloc(240LL);
      *((_QWORD *)this + 29) = v11;
      if ( !v11 )
        return 0;
      v9 = (_BYTE *)(&stru_B8 + 56);
      bzero(v11, 0xF0uLL);
      v10 = *((_QWORD *)this + 29);
    }
    *((_WORD *)this + 68) = v7;
    *((_BYTE *)this + 167) = v16;
    *((_DWORD *)this + 45) = v6;
    *((_BYTE *)this + 184) = v5;
    *(_BYTE *)(v10 + 25) = 0;
    v12 = 500;
    if ( v5 == 3 )
      v12 = 900;
    *(_DWORD *)(v10 + 192) = v12;
    v13 = OSDictionary::withCapacity((OSDictionary *)((char *)&dword_0 + 1), (unsigned int)v9);
    v8 = 1;
    if ( v13 )
    {
      v14 = OSString::withCString("IOUSBFamily.kext/Contents/PlugIns/IOUSBLib.bundle", v9);
      if ( v14 )
      {
        (*(void (__fastcall **)(__int64, _QWORD, __int64))(*(_QWORD *)v13 + 464LL))(
          v13,
          "9dc7b780-9ec0-11d4-a54f-000a27052861",
          v14);
        (*(void (__fastcall **)(IOUSBDevice *, _QWORD, _QWORD))(*(_QWORD *)this + 624LL))(
          this,
          "IOUserClientClass",
          "IOUSBDeviceUserClientV2");
        (*(void (__fastcall **)(IOUSBDevice *, _QWORD, __int64))(*(_QWORD *)this + 616LL))(this, "IOCFPlugInTypes", v13);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v14 + 40LL))(v14);
      }
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v13 + 40LL))(v13);
    }
  }
  return v8;
}
// 0: using guessed type int dword_0;
// B8: using guessed type section_64 stru_B8;
// 3D260: using guessed type __int64 `vtable for'IOUSBNub[2];
// 7D250: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (0000000000016154) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::SetProperties(IOUSBDevice *this)
{
  IOUSBDevice *v1; // r12@1
  __int64 v2; // r13@1
  OSMetaClassBase *v3; // rax@1
  OSMetaClassBase *v4; // rbx@1
  const OSMetaClassBase *v5; // r14@1
  const char *v6; // rsi@1
  const OSMetaClass *v7; // rdx@1
  __int64 v8; // rax@1
  __int64 v9; // rax@5
  OSMetaClassBase *v10; // rax@6
  const OSMetaClass *v11; // rdx@6
  __int64 v12; // rax@6
  char *v13; // rbx@6
  __int64 v14; // rdi@8
  OSMetaClassBase *v15; // rax@9
  OSMetaClassBase *v16; // r15@9
  char *v17; // rsi@9
  const OSMetaClass *v18; // rdx@9
  __int64 v19; // rax@9
  int (__fastcall *v20)(_QWORD, _QWORD, _QWORD); // rbx@10
  int v21; // eax@10
  __int64 v22; // rbx@10
  __int64 v23; // rax@13
  char v25; // [sp+0h] [bp-50h]@10
  __int64 v26; // [sp+20h] [bp-30h]@1

  v1 = this;
  v2 = off_3B0E0[0];
  v26 = *(_QWORD *)off_3B0E0[0];
  LODWORD(v3) = (*(int (__fastcall **)(IOUSBDevice *, char[8]))(*(_QWORD *)this + 744LL))(this, "PortNum");
  v4 = v3;
  v5 = *(const OSMetaClassBase **)off_3B078[0];
  v6 = *(const char **)off_3B078[0];
  v8 = OSMetaClassBase::safeMetaCast(v3, *(const OSMetaClassBase **)off_3B078[0], v7);
  if ( v8 )
    **((_DWORD **)this + 29) = (*(int (__fastcall **)(__int64, const char *))(*(_QWORD *)v8 + 328LL))(v8, v6);
  if ( v4 )
    (*(void (__fastcall **)(OSMetaClassBase *, const char *))(*(_QWORD *)v4 + 40LL))(v4, v6);
  v9 = IORegistryEntry::getPlane("IOUSB", v6);
  if ( v9 )
  {
    LODWORD(v10) = (*(int (__fastcall **)(IOUSBDevice *, __int64))(*(_QWORD *)this + 792LL))(this, v9);
    v12 = OSMetaClassBase::safeMetaCast(v10, (const OSMetaClassBase *)&IOUSBDevice::gMetaClass, v11);
    v13 = (char *)this + 232;
    *(_QWORD *)(*((_QWORD *)this + 29) + 16LL) = v12;
    (*(void (__fastcall **)(__int64, _QWORD *))(*(_QWORD *)v12 + 32LL))(v12, &IOUSBDevice::gMetaClass);
  }
  else
  {
    v13 = (char *)this + 232;
  }
  v14 = *(_QWORD *)(*(_QWORD *)v13 + 16LL);
  if ( v14 )
  {
    LODWORD(v15) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v14 + 744LL))(v14, "locationID");
    v16 = v15;
    v17 = (char *)v5;
    v19 = OSMetaClassBase::safeMetaCast(v15, v5, v18);
    if ( v19 )
    {
      v20 = *(int (__fastcall **)(_QWORD, _QWORD, _QWORD))(*(_QWORD *)v1 + 2400LL);
      v21 = (*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v19 + 328LL))(v19, v5);
      v22 = (unsigned int)v20(v1, (unsigned int)v21, **((_DWORD **)v1 + 29));
      (*(void (__fastcall **)(IOUSBDevice *, _QWORD, __int64, signed __int64))(*(_QWORD *)v1 + 640LL))(
        v1,
        "locationID",
        v22,
        32LL);
      *(_DWORD *)(*((_QWORD *)v1 + 29) + 172LL) = v22;
      snprintf(&v25, 0x20uLL, "%x", (unsigned int)v22);
      v17 = &v25;
      (*(void (__fastcall **)(IOUSBDevice *, char *, _QWORD))(*(_QWORD *)v1 + 976LL))(v1, &v25, 0LL);
    }
    if ( v16 )
      (*(void (__fastcall **)(OSMetaClassBase *, char *))(*(_QWORD *)v16 + 40LL))(v16, v17);
  }
  LODWORD(v23) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)v1 + 18) + 696LL))(
                   *((_QWORD *)v1 + 18),
                   "Need contiguous memory for isoch");
  if ( v23 == **(_QWORD **)off_3B0F8[0] )
    (*(void (__fastcall **)(IOUSBDevice *, _QWORD, __int64))(*(_QWORD *)v1 + 616LL))(
      v1,
      "Need contiguous memory for isoch",
      v23);
  return *(_QWORD *)v2;
}
// 3B078: using guessed type _QWORD off_3B078[19];
// 3B0E0: using guessed type __int64 off_3B0E0[6];
// 3B0F8: using guessed type __int64 off_3B0F8[3];
// 49760: using guessed type _QWORD IOUSBDevice::gMetaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000016342) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::GetInterfacePowerParent(IOUSBDevice *this)
{
  __int64 v1; // rcx@1
  __int64 result; // rax@1

  v1 = *((_QWORD *)this + 29);
  result = 0LL;
  if ( v1 )
    result = *(_QWORD *)(v1 + 224);
  return result;
}

//----- (000000000001635E) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::GetChildLocationID(IOUSBDevice *this, unsigned int a2, char a3)
{
  signed int v3; // ecx@1

  v3 = 20;
  while ( (15 << v3) & a2 )
  {
    v3 -= 4;
    if ( v3 < 0 )
      return a2;
  }
  a2 |= (a3 & 0xF) << v3;
  return a2;
}

//----- (0000000000016384) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::ResetDevice(IOUSBDevice *this)
{
  __int64 v1; // rax@2
  __int64 v2; // r14@3
  __int64 v3; // r15@4
  int v4; // er12@5
  __int64 result; // rax@5

  if ( !(unsigned __int8)IOService::isInactive(this)
    && (v1 = *((_QWORD *)this + 29)) != 0
    && (v2 = *(_QWORD *)(v1 + 104)) != 0
    && (v3 = *(_QWORD *)(v1 + 80)) != 0 )
  {
    (*(void (**)(void))(*(_QWORD *)this + 32LL))();
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 32LL))(v3);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 32LL))(v2);
    v4 = (*(int (__fastcall **)(__int64, __int64 (__fastcall *)(IOUSBDevice *__hidden, OSObject *, void *, void *, void *, void *), _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v2 + 456LL))(
           v2,
           IOUSBDevice::_ResetDevice,
           0LL,
           0LL,
           0LL,
           0LL);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 40LL))(v2);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 40LL))(v3);
    (*(void (__fastcall **)(IOUSBDevice *))(*(_QWORD *)this + 40LL))(this);
    result = (unsigned int)v4;
  }
  else
  {
    result = 3758097088LL;
  }
  return result;
}

//----- (0000000000016422) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::_ResetDevice(IOUSBDevice *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  uintptr_t v6; // rbx@1
  int v7; // er14@2
  uintptr_t v8; // rdx@4
  uintptr_t v9; // r8@4
  __int64 v10; // rax@6
  __int64 v11; // rdi@7
  __int64 v12; // rax@12
  IOUSBPipe **v13; // r15@17
  __int64 v14; // rdi@17
  __int64 v15; // rdi@20
  char v16; // r12@22
  uintptr_t v17; // rsi@26
  __int64 v18; // rax@26
  uintptr_t v19; // rax@28
  uintptr_t v20; // r14@28
  uintptr_t v21; // rsi@31
  int v22; // eax@31

  v6 = OSMetaClassBase::safeMetaCast(this, (const OSMetaClassBase *)&IOUSBDevice::gMetaClass, (const OSMetaClass *)a3);
  if ( (unsigned __int8)IOService::isInactive((IOService *)v6) )
  {
    v7 = -536870208;
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      v8 = **(_DWORD **)(v6 + 232);
      v9 = 1LL;
LABEL_5:
      kernel_debug(0x52D080Cu, v6, v8, 0LL, v9, 0LL);
      return (unsigned int)v7;
    }
  }
  else
  {
    v10 = *(_QWORD *)(v6 + 232);
    v7 = -536870208;
    if ( v10 )
    {
      v11 = *(_QWORD *)(v10 + 80);
      if ( v11 )
      {
        if ( (unsigned __int8)(*(int (__fastcall **)(__int64, _QWORD *))(*(_QWORD *)v11 + 304LL))(
                                v11,
                                &IOUSBDevice::gMetaClass) )
        {
          v7 = -536854454;
          if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          {
            v8 = **(_DWORD **)(v6 + 232);
            v9 = 0LL;
            goto LABEL_5;
          }
        }
        else
        {
          v12 = *(_QWORD *)(v6 + 232);
          if ( *(_BYTE *)(v12 + 56) )
          {
            v7 = -536870174;
            if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
            {
              v8 = *(_DWORD *)v12;
              v9 = 2LL;
              goto LABEL_5;
            }
          }
          else
          {
            *(_BYTE *)(v12 + 56) = 1;
            if ( *(_QWORD *)(v12 + 144) )
            {
              v13 = (IOUSBPipe **)(v6 + 152);
              v14 = *(_QWORD *)(v6 + 152);
              if ( v14 )
              {
                (*(void (**)(void))(*(_QWORD *)v14 + 296LL))();
                IOUSBPipe::ClosePipe(*v13);
                (*(void (**)(void))(*(_QWORD *)*v13 + 40LL))();
                *v13 = 0LL;
              }
              if ( *(_QWORD *)(v6 + 144)
                && (v15 = *(_QWORD *)(*(_QWORD *)(v6 + 232) + 216LL)) != 0
                && !(*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v15 + 3208LL))(v15, *(_WORD *)(v6 + 136)) )
              {
                (*(void (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)v6 + 2536LL))(v6, 0LL);
                v16 = 1;
              }
              else
              {
                v16 = 0;
              }
              v7 = (*(int (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(*(_QWORD *)(v6 + 232) + 144LL) + 2160LL))(
                     *(_QWORD *)(*(_QWORD *)(v6 + 232) + 144LL),
                     **(_DWORD **)(v6 + 232));
              if ( v16 )
                (*(void (__fastcall **)(uintptr_t, signed __int64))(*(_QWORD *)v6 + 2536LL))(v6, 1LL);
            }
            else
            {
              v13 = (IOUSBPipe **)(v6 + 152);
              v7 = 0;
            }
            *(_BYTE *)(v6 + 224) = 0;
            v17 = 0LL;
            v18 = IOUSBPipeV2::ToEndpoint(v6 + 186, 0LL, v6, *(_QWORD *)(v6 + 144), 0LL);
            *v13 = (IOUSBPipe *)v18;
            if ( v18 )
            {
              if ( !v7 )
              {
                LODWORD(v19) = IOMalloc(8LL);
                v20 = v19;
                *(_QWORD *)v19 = 3758112778LL;
                if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
                {
                  v17 = v6;
                  kernel_debug(0x52D080Cu, v6, **(_DWORD **)(v6 + 232), 0xE000400AuLL, 3uLL, 0LL);
                }
                (*(void (__fastcall **)(uintptr_t, uintptr_t))(*(_QWORD *)v6 + 32LL))(v6, v17);
                v21 = v20;
                v22 = thread_call_enter1(*(_QWORD *)(*(_QWORD *)(v6 + 232) + 136LL), v20);
                v7 = 0;
                if ( v22 == 1 )
                {
                  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
                  {
                    v21 = v6;
                    kernel_debug(0x52D080Cu, v6, **(_DWORD **)(v6 + 232), 0LL, 4uLL, 0LL);
                  }
                  (*(void (__fastcall **)(uintptr_t, uintptr_t))(*(_QWORD *)v6 + 40LL))(v6, v21);
                }
              }
            }
            else
            {
              v7 = -536870211;
              if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
                kernel_debug(0x52D0808u, v6, 0xE000400AuLL, 0xFFFFFFFFE00002BDLL, 2uLL, 0LL);
            }
            if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
              kernel_debug(0x52D080Cu, v6, **(_DWORD **)(v6 + 232), v7, 5uLL, 0LL);
            *(_BYTE *)(*(_QWORD *)(v6 + 232) + 56LL) = 0;
          }
        }
      }
    }
  }
  return (unsigned int)v7;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 49760: using guessed type _QWORD IOUSBDevice::gMetaClass;
// 7D250: using guessed type int __fastcall IOMalloc(_QWORD);
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);
// 7E230: using guessed type int __fastcall thread_call_enter1(_QWORD, _QWORD);

//----- (00000000000167B0) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::ReEnumerateDevice(IOUSBDevice *this, int a2)
{
  IOUSBDevice *v2; // r14@1
  int v3; // ebx@1
  __int64 v4; // rax@2
  __int64 v5; // r13@3
  __int64 v6; // r12@4
  __int64 v7; // rax@7
  __int64 v8; // rax@8
  __int64 v9; // rdi@8
  OSMetaClassBase *v10; // rax@9
  const OSMetaClass *v11; // rdx@9
  __int64 v12; // rbx@9
  const OSMetaClassBase *v13; // r13@10
  signed int v14; // er15@10
  __int64 v15; // rax@13
  __int64 v16; // r12@13
  OSMetaClassBase *v17; // rax@16
  const OSMetaClass *v18; // rdx@16
  __int64 v19; // rax@17
  OSMetaClassBase *v20; // rax@20
  const OSMetaClass *v21; // rdx@20
  __int64 v22; // rax@22
  __int64 v23; // r15@22
  OSMetaClassBase *v24; // rax@23
  const OSMetaClass *v25; // rdx@23
  const OSMetaClassBase *v26; // r12@24
  signed __int64 v27; // rsi@25
  OSMetaClassBase *v28; // rax@25
  OSMetaClassBase *v29; // rbx@25
  __int64 v31; // [sp+0h] [bp-50h]@9
  __int64 v32; // [sp+8h] [bp-48h]@9
  __int64 v33; // [sp+8h] [bp-48h]@23
  int v34; // [sp+14h] [bp-3Ch]@9
  int v35; // [sp+14h] [bp-3Ch]@23
  int v36; // [sp+24h] [bp-2Ch]@1

  v2 = this;
  v36 = a2;
  v3 = -536870208;
  if ( !(unsigned __int8)IOService::isInactive(this) )
  {
    v4 = *((_QWORD *)this + 29);
    if ( v4 )
    {
      v5 = *(_QWORD *)(v4 + 104);
      if ( v5 )
      {
        v6 = *(_QWORD *)(v4 + 80);
        if ( v6 )
        {
          (*(void (**)(void))(*(_QWORD *)this + 32LL))();
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v6 + 32LL))(v6);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v5 + 32LL))(v5);
          v3 = (*(int (__fastcall **)(__int64, __int64 (__fastcall *)(IOUSBDevice *__hidden, OSObject *, void *, void *, void *, void *), int *, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v5 + 456LL))(
                 v5,
                 IOUSBDevice::_ReEnumerateDevice,
                 &v36,
                 0LL,
                 0LL,
                 0LL);
          if ( !v3 )
          {
            if ( v36 & 0x60000000 )
            {
              v7 = *((_QWORD *)this + 29);
              if ( v36 & 0x40000000 )
              {
                IOLockLock(*(_QWORD *)(v7 + 176));
                v8 = *((_QWORD *)this + 29);
                v9 = *(_QWORD *)(v8 + 184);
                if ( v9 )
                {
                  v31 = v5;
                  v32 = v6;
                  v34 = v3;
                  LODWORD(v10) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v9 + 488LL))(v9, 0LL);
                  v12 = OSMetaClassBase::safeMetaCast(v10, (const OSMetaClassBase *)IOUSBInterface::metaClass, v11);
                  if ( v12 )
                  {
                    v13 = *(const OSMetaClassBase **)off_3B0A0[0];
                    v14 = 1;
                    do
                    {
                      if ( (unsigned __int8)(*(int (__fastcall **)(__int64))(*(_QWORD *)v12 + 2248LL))(v12) == 8 )
                      {
                        *(_BYTE *)(*((_QWORD *)v2 + 29) + 233LL) = 1;
                      }
                      else
                      {
                        LODWORD(v15) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v12 + 1704LL))(v12);
                        v16 = v15;
                        if ( v15 )
                        {
                          while ( 1 )
                          {
                            LODWORD(v17) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v16 + 296LL))(v16);
                            if ( !v17 )
                              break;
                            v19 = OSMetaClassBase::safeMetaCast(v17, v13, v18);
                            if ( v19 )
                              (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v19 + 1536LL))(v19, 258LL);
                          }
                          (*(void (__fastcall **)(__int64))(*(_QWORD *)v16 + 40LL))(v16);
                        }
                      }
                      LODWORD(v20) = (*(int (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(*((_QWORD *)v2 + 29) + 184LL)
                                                                           + 488LL))(
                                       *(_QWORD *)(*((_QWORD *)v2 + 29) + 184LL),
                                       (unsigned int)v14);
                      v12 = OSMetaClassBase::safeMetaCast(v20, (const OSMetaClassBase *)IOUSBInterface::metaClass, v21);
                      ++v14;
                    }
                    while ( v12 );
                  }
                  v8 = *((_QWORD *)v2 + 29);
                  v3 = v34;
                  v6 = v32;
                  v5 = v31;
                }
                IOLockUnlock(*(_QWORD *)(v8 + 176));
                LODWORD(v22) = (*(int (__fastcall **)(IOUSBDevice *))(*(_QWORD *)v2 + 1704LL))(v2);
                v23 = v22;
                if ( v22 )
                {
                  v33 = v6;
                  v35 = v3;
                  LODWORD(v24) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v22 + 296LL))(v22);
                  if ( v24 )
                  {
                    v26 = *(const OSMetaClassBase **)off_3B0A0[0];
                    do
                    {
                      v27 = (signed __int64)v26;
                      v28 = (OSMetaClassBase *)OSMetaClassBase::safeMetaCast(v24, v26, v25);
                      v29 = v28;
                      if ( v28 )
                      {
                        v27 = (signed __int64)"IOUSBInterface";
                        if ( !OSMetaClassBase::metaCast(v28, "IOUSBInterface") )
                        {
                          v27 = 258LL;
                          (*(void (__fastcall **)(OSMetaClassBase *, signed __int64))(*(_QWORD *)v29 + 1536LL))(
                            v29,
                            258LL);
                        }
                      }
                      LODWORD(v24) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v23 + 296LL))(v23, v27);
                    }
                    while ( v24 );
                  }
                  (*(void (__fastcall **)(__int64))(*(_QWORD *)v23 + 40LL))(v23);
                  v3 = v35;
                  v6 = v33;
                }
              }
              else
              {
                *(_BYTE *)(v7 + 232) = 1;
                (*(void (__fastcall **)(IOUSBDevice *))(*(_QWORD *)this + 32LL))(this);
                (*(void (__fastcall **)(IOUSBDevice *, _QWORD))(*(_QWORD *)this + 1456LL))(this, 0LL);
                (*(void (__fastcall **)(IOUSBDevice *))(*(_QWORD *)this + 40LL))(this);
              }
            }
            *(_BYTE *)(*((_QWORD *)v2 + 29) + 56LL) = 0;
          }
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v5 + 40LL))(v5);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v6 + 40LL))(v6);
          (*(void (__fastcall **)(IOUSBDevice *))(*(_QWORD *)v2 + 40LL))(v2);
        }
      }
    }
  }
  return (unsigned int)v3;
}
// 3B0A0: using guessed type _QWORD off_3B0A0[14];
// 3C7A0: using guessed type _QWORD IOUSBInterface::metaClass;
// 7D230: using guessed type int __fastcall IOLockLock(_QWORD);
// 7D238: using guessed type int __fastcall IOLockUnlock(_QWORD);
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000016AA6) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::_ReEnumerateDevice(IOUSBDevice *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  OSObject *v6; // r14@1
  uintptr_t v7; // rsi@1
  uintptr_t v8; // r15@1
  signed int v9; // ebx@5
  uintptr_t v10; // rdx@7
  uintptr_t v11; // r8@7
  __int64 v12; // rax@9
  __int64 v13; // rdi@10
  __int64 v14; // rax@15
  unsigned int v15; // eax@23
  signed int v16; // er13@28
  __int64 v17; // rdi@29
  uintptr_t v18; // rsi@32

  v6 = a2;
  v7 = (uintptr_t)&IOUSBDevice::gMetaClass;
  v8 = OSMetaClassBase::safeMetaCast(this, (const OSMetaClassBase *)&IOUSBDevice::gMetaClass, (const OSMetaClass *)a3);
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
  {
    v7 = v8;
    kernel_debug(0x52D0835u, v8, *(_DWORD *)(*(_QWORD *)(v8 + 232) + 172LL), *(_DWORD *)v6, 0LL, 0LL);
  }
  if ( (unsigned __int8)IOService::isInactive((IOService *)v8) )
  {
    v9 = -536870208;
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      v10 = *(_DWORD *)(*(_QWORD *)(v8 + 232) + 172LL);
      v11 = 1LL;
LABEL_8:
      kernel_debug(0x52D0834u, v8, v10, 0LL, v11, 0LL);
      return (unsigned int)v9;
    }
  }
  else
  {
    v12 = *(_QWORD *)(v8 + 232);
    v9 = -536870208;
    if ( v12 )
    {
      v13 = *(_QWORD *)(v12 + 80);
      if ( v13 )
      {
        if ( (unsigned __int8)(*(int (__fastcall **)(__int64, uintptr_t))(*(_QWORD *)v13 + 304LL))(v13, v7) )
        {
          v9 = -536854454;
          if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          {
            v10 = *(_DWORD *)(*(_QWORD *)(v8 + 232) + 172LL);
            v11 = 0LL;
            goto LABEL_8;
          }
        }
        else
        {
          v14 = *(_QWORD *)(v8 + 232);
          if ( *(_BYTE *)(v14 + 56) )
          {
            v9 = -536870174;
            if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
            {
              v10 = *(_DWORD *)(v14 + 172);
              v11 = 2LL;
              goto LABEL_8;
            }
          }
          else
          {
            *(_BYTE *)(v14 + 56) = 1;
            if ( *(_BYTE *)(v14 + 102) )
            {
              if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
              {
                v7 = v8;
                kernel_debug(0x52D0834u, v8, *(_DWORD *)(v14 + 172), *(_DWORD *)v6, 3uLL, 0LL);
              }
              v15 = *(_DWORD *)v6 | 0x80000000;
              *(_DWORD *)v6 = v15;
            }
            else
            {
              v15 = *(_DWORD *)v6;
            }
            if ( v15 & 0x20000000 && !*(_BYTE *)(*(_QWORD *)(v8 + 232) + 233LL) )
            {
              v15 &= 0xDFFFFFFF;
              *(_DWORD *)v6 = v15;
            }
            v16 = 0;
            if ( !(v15 & 0x60000000) )
            {
              *(_BYTE *)(*(_QWORD *)(v8 + 232) + 232LL) = 0;
              v17 = *(_QWORD *)(v8 + 152);
              if ( v17 )
              {
                (*(void (__fastcall **)(__int64, uintptr_t))(*(_QWORD *)v17 + 296LL))(v17, v7);
                IOUSBPipe::ClosePipe(*(IOUSBPipe **)(v8 + 152));
                (*(void (__cdecl **)(_QWORD))(**(_QWORD **)(v8 + 152) + 40LL))(*(_QWORD *)(v8 + 152));
                *(_QWORD *)(v8 + 152) = 0LL;
              }
              IOUSBDevice::TerminateInterfaces((IOUSBDevice *)v8, 1);
              v16 = -536870208;
              if ( *(_QWORD *)(*(_QWORD *)(v8 + 232) + 144LL) )
              {
                (*(void (__fastcall **)(uintptr_t, signed __int64))(*(_QWORD *)v8 + 32LL))(v8, 1LL);
                v18 = *(_DWORD *)v6;
                v16 = 0;
                if ( thread_call_enter1(*(_QWORD *)(*(_QWORD *)(v8 + 232) + 48LL), v18) == 1 )
                {
                  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
                  {
                    v18 = v8;
                    kernel_debug(0x52D0834u, v8, *(_DWORD *)(*(_QWORD *)(v8 + 232) + 172LL), 0LL, 4uLL, 0LL);
                  }
                  (*(void (__fastcall **)(uintptr_t, uintptr_t))(*(_QWORD *)v8 + 40LL))(v8, v18);
                  v16 = -536870187;
                }
              }
            }
            if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
              kernel_debug(0x52D0836u, v8, *(_DWORD *)(*(_QWORD *)(v8 + 232) + 172LL), v16, 0LL, 0LL);
            v9 = 0;
            if ( v16 )
            {
              *(_BYTE *)(*(_QWORD *)(v8 + 232) + 56LL) = 0;
              v9 = v16;
            }
          }
        }
      }
    }
  }
  return (unsigned int)v9;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 49760: using guessed type _QWORD IOUSBDevice::gMetaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);
// 7E230: using guessed type int __fastcall thread_call_enter1(_QWORD, _QWORD);

//----- (0000000000016DCA) ----------------------------------------------------
uintptr_t __fastcall IOUSBDevice::FindConfig(uintptr_t arg1, unsigned __int8 a2, unsigned __int8 *a3)
{
  unsigned __int8 *v3; // r12@1
  signed int v4; // ebx@1
  uintptr_t v5; // r13@1
  uintptr_t v6; // rax@2

  v3 = a3;
  v4 = 0;
  v5 = 0LL;
  if ( *(_BYTE *)(arg1 + 177) )
  {
    while ( 1 )
    {
      LODWORD(v6) = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)arg1 + 2216LL))(arg1, (unsigned __int8)v4);
      v5 = v6;
      if ( v6 )
      {
        if ( *(_BYTE *)(v6 + 5) == a2 )
          break;
      }
      ++v4;
      v5 = 0LL;
      if ( v4 >= *(_BYTE *)(arg1 + 177) )
        goto LABEL_8;
    }
    if ( v3 )
      *v3 = v4;
  }
LABEL_8:
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D0838u, arg1, a2, v5, 0xCuLL, 0LL);
  return v5;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (0000000000016E80) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::FindNextDescriptor(uintptr_t arg1, const void *a2, unsigned __int8 a3)
{
  unsigned __int8 v3; // r14@1
  const void *v4; // rbx@1
  __int64 result; // rax@1
  __int64 v6; // rsi@10
  uintptr_t v7; // r15@10
  __int64 v8; // rdi@11
  unsigned __int16 v9; // ax@12
  uintptr_t v10; // rcx@12
  __int64 v11; // rsi@17
  __int64 v12; // rdi@18
  bool v13; // zf@24
  char v14; // [sp+Eh] [bp-22h]@1
  unsigned __int8 v15; // [sp+Fh] [bp-21h]@1

  v3 = a3;
  v4 = a2;
  v15 = 0;
  v14 = 0;
  result = 0LL;
  if ( !*(_QWORD *)(arg1 + 208) )
    return result;
  LOBYTE(result) = *(_BYTE *)(arg1 + 224);
  if ( !(_BYTE)result )
  {
    if ( *(_BYTE *)(*(_QWORD *)(arg1 + 232) + 25LL) )
    {
      LOBYTE(result) = 0;
    }
    else
    {
      if ( (*(int (__fastcall **)(uintptr_t, char *))(*(_QWORD *)arg1 + 2376LL))(arg1, &v14) )
      {
        LOBYTE(result) = *(_BYTE *)(arg1 + 224);
      }
      else
      {
        LOBYTE(result) = v14;
        *(_BYTE *)(arg1 + 224) = v14;
      }
      if ( !(_BYTE)result )
      {
        result = 0LL;
        if ( !*(_BYTE *)(*(_QWORD *)(arg1 + 232) + 25LL) )
          return result;
      }
    }
  }
  v6 = (unsigned __int8)result;
  v7 = IOUSBDevice::FindConfig(arg1, result, &v15);
  result = 0LL;
  if ( v7 )
  {
    v8 = *(_QWORD *)(*(_QWORD *)(arg1 + 208) + 8LL * v15);
    result = 0LL;
    if ( v8 )
    {
      v9 = (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v8 + 456LL))(v8, v6);
      LOWORD(v10) = v9;
      if ( !v4 )
      {
        v10 = v9;
        v4 = (const void *)v7;
        goto LABEL_17;
      }
      result = 0LL;
      if ( v7 <= (unsigned __int64)v4 )
      {
        v10 = (unsigned __int16)v10;
        result = 0LL;
        if ( (unsigned __int64)((char *)v4 - v7) < (unsigned __int16)v10 )
        {
LABEL_17:
          while ( 1 )
          {
            v11 = *(_BYTE *)v4;
            result = 0LL;
            if ( !*(_BYTE *)v4 )
              break;
            v12 = (__int64)((char *)v4 + v11);
            if ( !((char *)v4 + v11) )
              return 0LL;
            result = 0LL;
            if ( v4 != (const void *)v12 )
            {
              result = 0LL;
              if ( v12 - v7 < v10 )
                result = (__int64)((char *)v4 + v11);
              if ( v12 - v7 < v10 )
              {
                if ( v3 )
                {
                  v13 = *((_BYTE *)v4 + v11 + 1) == v3;
                  v4 = (char *)v4 + v11;
                  result = v12;
                  if ( !v13 )
                    continue;
                }
              }
            }
            return result;
          }
        }
      }
    }
  }
  return result;
}

//----- (0000000000016FD2) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::FindNextInterfaceDescriptor(uintptr_t a1, uintptr_t a2, uintptr_t a3, __int64 a4, __int64 a5)
{
  __int64 v5; // r14@1
  __int64 v6; // r15@1
  uintptr_t v7; // rbx@1
  unsigned __int8 v8; // al@2
  signed int v9; // er12@2
  unsigned __int64 v10; // rbx@9
  int v11; // ecx@15
  int v12; // ecx@17
  int v13; // ecx@19
  int v14; // ecx@21

  v5 = a5;
  v6 = a4;
  v7 = a3;
  if ( a2 || (v8 = *(_BYTE *)(a1 + 224), v9 = -536870206, v8) && (a2 = IOUSBDevice::FindConfig(a1, v8, 0LL)) != 0 )
  {
    v9 = -536870206;
    if ( *(_BYTE *)(a2 + 1) == 2 )
    {
      if ( v7 )
      {
        if ( v7 < a2 )
          return (unsigned int)v9;
        if ( *(_BYTE *)(v7 + 1) != 4 )
          return (unsigned int)v9;
        v9 = -536854450;
        if ( !*(_BYTE *)v7 )
          return (unsigned int)v9;
        v10 = *(_BYTE *)v7 + v7;
      }
      else
      {
        v9 = -536854450;
        if ( !*(_BYTE *)a2 )
          return (unsigned int)v9;
        v10 = *(_BYTE *)a2 + a2;
      }
      v9 = -536854450;
      if ( v10 )
      {
        while ( v10 < a2 + *(_WORD *)(a2 + 2) )
        {
          if ( *(_BYTE *)(v10 + 1) == 4 )
          {
            v11 = *(_WORD *)v6;
            if ( v11 == 0xFFFF || v11 == *(_BYTE *)(v10 + 5) )
            {
              v12 = *(_WORD *)(v6 + 2);
              if ( v12 == 0xFFFF || v12 == *(_BYTE *)(v10 + 6) )
              {
                v13 = *(_WORD *)(v6 + 4);
                if ( v13 == 0xFFFF || v13 == *(_BYTE *)(v10 + 7) )
                {
                  v14 = *(_WORD *)(v6 + 6);
                  if ( v14 == 0xFFFF || v14 == *(_BYTE *)(v10 + 3) )
                  {
                    *(_QWORD *)v5 = v10;
                    v9 = 0;
                    return (unsigned int)v9;
                  }
                }
              }
            }
          }
          if ( *(_BYTE *)v10 )
          {
            v10 += *(_BYTE *)v10;
            if ( v10 )
              continue;
          }
          return (unsigned int)v9;
        }
      }
    }
  }
  return (unsigned int)v9;
}

//----- (0000000000017106) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::FindNextInterface(__int64 a1, OSMetaClassBase *a2, const OSMetaClass *a3)
{
  const OSMetaClass *v3; // r14@1
  __int64 v4; // rbx@2
  OSMetaClassBase *v5; // rax@5
  __int64 v6; // rax@7
  __int64 v8; // [sp+0h] [bp-30h]@1

  v3 = a3;
  v8 = 0LL;
  if ( a2 )
  {
    v4 = 0LL;
    if ( OSMetaClassBase::safeMetaCast(a2, (const OSMetaClassBase *)IOUSBInterface::metaClass, a3) )
    {
      v4 = 0LL;
      while ( !(*(int (__fastcall **)(__int64, _QWORD, __int64, const OSMetaClass *, __int64 *))(*(_QWORD *)a1 + 2192LL))(
                 a1,
                 0LL,
                 v8,
                 v3,
                 &v8) )
      {
        LODWORD(v5) = (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)a1 + 2136LL))(a1, v8);
        if ( v5 == a2 )
          goto LABEL_6;
      }
    }
  }
  else
  {
    do
    {
LABEL_6:
      v4 = 0LL;
      if ( (*(int (__fastcall **)(__int64, _QWORD, __int64, const OSMetaClass *, __int64 *))(*(_QWORD *)a1 + 2192LL))(
             a1,
             0LL,
             v8,
             v3,
             &v8) )
        break;
      LODWORD(v6) = (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)a1 + 2136LL))(a1, v8);
      v4 = v6;
    }
    while ( !v6 );
  }
  return v4;
}
// 3C7A0: using guessed type _QWORD IOUSBInterface::metaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (00000000000171CE) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::CreateInterfaceIterator(__int64 a1, unsigned __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 result; // rax@1

  v2 = OSObject::operator new((OSObject *)stru_20.segname, a2);
  OSIterator::OSIterator(v2);
  *(_QWORD *)v2 = off_3F250;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBInterfaceIterator::gMetaClass);
  result = 0LL;
  if ( v2 )
  {
    if ( !(unsigned __int8)(*(int (__fastcall **)(__int64, __int64, unsigned __int64))(*(_QWORD *)v2 + 336LL))(
                             v2,
                             a1,
                             a2) )
    {
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 40LL))(v2);
      v2 = 0LL;
    }
    result = v2;
  }
  return result;
}
// 20: using guessed type segment_command_64 stru_20;
// 3F250: using guessed type __int64 (__fastcall *off_3F250[2])(IOUSBInterfaceIterator *__hidden this);
// 49738: using guessed type _QWORD IOUSBInterfaceIterator::gMetaClass;
// 7D390: using guessed type int __cdecl OSIterator::OSIterator(_QWORD);

//----- (0000000000017244) ----------------------------------------------------
uintptr_t __fastcall IOUSBDevice::GetFullConfigurationDescriptor(IOUSBDevice *this, unsigned __int8 a2)
{
  unsigned __int8 v2; // r15@1
  uintptr_t v3; // r13@1
  uintptr_t v4; // rbx@1
  uintptr_t v5; // r14@2
  __int64 v6; // rax@3
  __int64 v7; // rdi@4
  uintptr_t v8; // rcx@8
  uintptr_t v9; // r8@8
  __int64 v10; // rdi@9
  uintptr_t v11; // rax@10
  uintptr_t v12; // rsi@13
  uintptr_t v13; // rdx@13
  int v14; // eax@14
  int v16; // ebx@22
  OSMetaClassBase *v17; // rax@23
  OSMetaClassBase *v18; // r12@23
  __int64 v19; // rsi@23
  const OSMetaClass *v20; // rdx@23
  __int64 v21; // rax@23
  OSMetaClassBase *v22; // rax@27
  const OSMetaClass *v23; // rdx@27
  OSMetaClassBase *v24; // r12@27
  const void *v25; // rsi@28
  __int64 v26; // rax@28
  IOBufferMemoryDescriptor *v27; // rdx@28
  OSMetaClassBase *v28; // rax@29
  const OSMetaClass *v29; // rdx@29
  __int64 v30; // rbx@29
  IOBufferMemoryDescriptor *v31; // rax@30
  IOBufferMemoryDescriptor *v32; // ST18_8@30
  bool v33; // r8@30
  int v34; // eax@30
  __int64 v35; // rax@32
  __int64 v36; // rdi@32
  IOBufferMemoryDescriptor *v37; // rbx@32
  int v38; // eax@32
  int v39; // eax@36
  OSMetaClassBase *v40; // rax@39
  const OSMetaClass *v41; // rdx@39
  bool v42; // cl@39
  uintptr_t v43; // rbx@39
  __int64 v44; // r12@39
  uintptr_t v45; // rsi@40
  __int64 v46; // rax@40
  OSMetaClassBase *v47; // rax@41
  const OSMetaClass *v48; // rdx@41
  int v49; // eax@43
  __int64 v50; // rax@60
  __int64 v51; // r8@60
  __int64 v52; // r9@60
  __int64 v53; // rax@63
  __int64 v54; // r8@63
  __int64 v55; // r9@63
  IOBufferMemoryDescriptor *v56; // rax@66
  int (__fastcall *v57)(_QWORD, _QWORD, _QWORD, _QWORD); // ST10_8@67
  __int64 v58; // rax@67
  signed __int64 v59; // rsi@67
  int v60; // eax@67
  IOBufferMemoryDescriptor *v61; // rdi@71
  uintptr_t v62; // rdx@72
  __int64 v63; // rax@75
  __int64 v64; // rax@85
  __int64 v65; // rdi@88
  const void *v66; // rax@89
  const void *v67; // r15@89
  const void *v68; // rax@89
  __int64 v69; // rax@93
  __int64 v70; // r8@93
  __int64 v71; // r9@93
  uintptr_t v72; // rax@95
  char v73; // [sp+0h] [bp-60h]@0
  int v74; // [sp+8h] [bp-58h]@27
  __int16 v75; // [sp+Ch] [bp-54h]@22
  __int16 v76; // [sp+10h] [bp-50h]@22
  IOBufferMemoryDescriptor *v77; // [sp+18h] [bp-48h]@27
  int v78; // [sp+18h] [bp-48h]@58
  __int16 v79; // [sp+20h] [bp-40h]@58
  unsigned __int16 v80; // [sp+22h] [bp-3Eh]@62
  unsigned __int8 v81; // [sp+30h] [bp-30h]@57
  unsigned __int8 v82; // [sp+31h] [bp-2Fh]@57
  unsigned __int16 v83; // [sp+32h] [bp-2Eh]@57

  v2 = a2;
  v3 = (uintptr_t)this;
  v4 = 0LL;
  if ( !*((_QWORD *)this + 26) )
    return v4;
  v5 = a2;
  v4 = 0LL;
  if ( *((_BYTE *)this + 177) <= (unsigned int)a2 )
    return v4;
  v6 = *((_QWORD *)this + 29);
  v4 = 0LL;
  if ( !v6 )
    return v4;
  v7 = *(_QWORD *)(v6 + 80);
  v4 = 0LL;
  if ( !v7 )
    return v4;
  if ( (unsigned __int8)(*(int (**)(void))(*(_QWORD *)v7 + 304LL))() )
  {
    v4 = 0LL;
    if ( gUSBStackDebugFlags & 2 )
    {
      v4 = 0LL;
      if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        v4 = 0LL;
        v8 = 0LL;
        v9 = 5LL;
LABEL_18:
        v12 = v3;
        v13 = v2;
        goto LABEL_19;
      }
    }
    return v4;
  }
  v10 = *(_QWORD *)(*(_QWORD *)(v3 + 208) + 8LL * a2);
  if ( v10 )
  {
    LODWORD(v11) = (*(int (**)(void))(*(_QWORD *)v10 + 736LL))();
    v4 = v11;
    if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
      return v4;
    v9 = 6LL;
    goto LABEL_13;
  }
  v14 = IOUSBDevice::TakeGetConfigLock((IOUSBDevice *)v3);
  if ( !v14 )
  {
    if ( !*(_QWORD *)(*(_QWORD *)(v3 + 208) + 8LL * a2) )
    {
      v75 = *(_WORD *)(v3 + 168);
      v76 = *(_WORD *)(v3 + 170);
      v16 = 0;
      if ( !a2 )
      {
        LODWORD(v17) = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)v3 + 744LL))(v3, "OverrideConfig0MaxPower");
        v18 = v17;
        v19 = *(_QWORD *)off_3B078[0];
        v21 = OSMetaClassBase::safeMetaCast(v17, *(const OSMetaClassBase **)off_3B078[0], v20);
        v16 = 0;
        if ( v21 )
          v16 = (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v21 + 328LL))(v21, v19);
        if ( v18 )
          (*(void (__fastcall **)(OSMetaClassBase *, __int64))(*(_QWORD *)v18 + 40LL))(v18, v19);
      }
      v74 = v16;
      LODWORD(v22) = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)v3 + 744LL))(
                       v3,
                       "ConfigurationDescriptorOverride");
      v24 = v22;
      v77 = 0LL;
      if ( v22 )
      {
        v25 = *(const void **)off_3B070[0];
        v26 = OSMetaClassBase::safeMetaCast(v22, *(const OSMetaClassBase **)off_3B070[0], v23);
        v27 = 0LL;
        if ( v26 )
        {
          LODWORD(v28) = (*(int (__fastcall **)(__int64, _QWORD, _QWORD))(*(_QWORD *)v26 + 488LL))(v26, v2, 0LL);
          v25 = *(const void **)off_3B068[0];
          v30 = OSMetaClassBase::safeMetaCast(v28, *(const OSMetaClassBase **)off_3B068[0], v29);
          v27 = 0LL;
          if ( v30 )
          {
            LODWORD(v31) = (*(int (__fastcall **)(__int64, const void *, _QWORD))(*(_QWORD *)v30 + 376LL))(
                             v30,
                             v25,
                             0LL);
            v32 = v31;
            v25 = (const void *)(unsigned int)(*(int (__fastcall **)(__int64))(*(_QWORD *)v30 + 320LL))(v30);
            v27 = (IOBufferMemoryDescriptor *)IOBufferMemoryDescriptor::withBytes(v32, v25, 1uLL, 0, v33);
            v34 = gUSBStackDebugFlags & 2;
            if ( v27 )
            {
              if ( v34 )
              {
                v35 = *(_QWORD *)v30;
                v36 = v30;
                v37 = v27;
                v38 = (*(int (__fastcall **)(__int64, const void *))(v35 + 320))(v36, v25);
                v27 = v37;
                if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
                {
                  v25 = (const void *)v3;
                  kernel_debug(0x52D0810u, v3, (unsigned int)v38, 0LL, 0xAuLL, 0LL);
                  v27 = v37;
                }
              }
              *(_QWORD *)(*(_QWORD *)(v3 + 208) + 8LL * v2) = v27;
            }
            else
            {
              v27 = 0LL;
              if ( v34 )
              {
                v39 = (*(int (__fastcall **)(__int64, const void *, _QWORD))(*(_QWORD *)v30 + 320LL))(v30, v25, 0LL);
                v27 = 0LL;
                if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
                {
                  v25 = (const void *)v3;
                  kernel_debug(0x52D0810u, v3, (unsigned int)v39, 0LL, 9uLL, 0LL);
                  v27 = 0LL;
                }
              }
            }
          }
        }
        v77 = v27;
        (*(void (__fastcall **)(OSMetaClassBase *, const void *))(*(_QWORD *)v24 + 40LL))(v24, v25);
      }
      LODWORD(v40) = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)v3 + 744LL))(
                       v3,
                       "ConfigurationDescriptorVerify");
      v43 = (uintptr_t)v40;
      v44 = 0LL;
      if ( v40 )
      {
        v45 = *(_QWORD *)off_3B070[0];
        v46 = OSMetaClassBase::safeMetaCast(v40, *(const OSMetaClassBase **)off_3B070[0], v41);
        v44 = 0LL;
        if ( v46 )
        {
          LODWORD(v47) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v46 + 488LL))(v46, v2);
          v45 = *(_QWORD *)off_3B068[0];
          v44 = OSMetaClassBase::safeMetaCast(v47, *(const OSMetaClassBase **)off_3B068[0], v48);
          if ( v44 )
          {
            if ( gUSBStackDebugFlags & 2 )
            {
              v49 = (*(int (__fastcall **)(__int64, uintptr_t))(*(_QWORD *)v44 + 320LL))(v44, v45);
              if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
              {
                v45 = v3;
                kernel_debug(0x52D0810u, v3, (unsigned int)v49, v2, 0xAuLL, 0LL);
              }
            }
          }
        }
        (*(void (__fastcall **)(uintptr_t, uintptr_t))(*(_QWORD *)v43 + 40LL))(v43, v45);
      }
      if ( !*(_QWORD *)(*(_QWORD *)(v3 + 208) + 8LL * v2) )
      {
        v43 = 39LL;
        if ( v75 != 1008 || (v42 = v76, v76 != 4097) )
        {
          if ( v75 != 1221 || (v42 = v76, v76 != 4160) )
          {
            if ( v75 != 5118 || v76 != 7680 )
            {
              v81 = 0;
              v82 = 0;
              v83 = 0;
              if ( (*(int (__fastcall **)(uintptr_t, _QWORD, char *, signed __int64))(*(_QWORD *)v3 + 2152LL))(
                     v3,
                     v2,
                     &v81,
                     4LL) )
              {
                bzero(&v79, 9uLL);
                v78 = (*(int (__fastcall **)(uintptr_t, _QWORD, __int16 *, signed __int64))(*(_QWORD *)v3 + 2152LL))(
                        v3,
                        v2,
                        &v79,
                        9LL);
                if ( v78 != -536870168 && v78 )
                {
                  v4 = 0LL;
                  if ( gUSBStackDebugFlags & 2 )
                  {
                    v4 = 0LL;
                    if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
                    {
                      v4 = 0LL;
                      kernel_debug(0x52D0810u, v3, v78, 9uLL, 2uLL, 0LL);
                    }
                  }
                  goto LABEL_96;
                }
                LODWORD(v50) = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)v3 + 904LL))(v3, 0LL);
                KernelDebugLogInternal(
                  1u,
                  0x55534246u,
                  (__int64)"USB Device %s is violating Section 9.3.5 of the USB Specification -- Error in GetConfigDescriptor( wLength = 4)",
                  v50,
                  v51,
                  v52,
                  v73);
                if ( v78 == -536870168 )
                {
                  if ( v79 != 521 || !v80 )
                  {
                    v4 = 0LL;
                    if ( gUSBStackDebugFlags & 2 )
                    {
                      v4 = 0LL;
                      if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
                      {
                        v4 = 0LL;
                        kernel_debug(0x52D0810u, v81, v82, v83, 9uLL, 0LL);
                      }
                    }
                    goto LABEL_96;
                  }
                  LODWORD(v53) = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)v3 + 904LL))(v3, 0LL);
                  KernelDebugLogInternal(
                    1u,
                    0x55534246u,
                    (__int64)"USB Device %s is violating Section 9.3.5 of the USB Specification -- Error in GetConfigDescriptor( wLength = 9)",
                    v53,
                    v54,
                    v55,
                    v73);
                }
                v43 = v80;
              }
              else
              {
                v43 = v83;
              }
            }
            else
            {
              if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
                kernel_debug(0x52D0810u, v3, 0x13FEuLL, 0x1E00uLL, 1uLL, 0LL);
              v43 = 32LL;
            }
          }
        }
        v56 = (IOBufferMemoryDescriptor *)IOBufferMemoryDescriptor::withCapacity(
                                            (IOBufferMemoryDescriptor *)v43,
                                            1uLL,
                                            0,
                                            v42);
        if ( !v56 )
        {
          v62 = v43;
          v4 = 0LL;
          if ( gUSBStackDebugFlags & 2 )
          {
            v4 = 0LL;
            if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
            {
              v4 = 0LL;
              kernel_debug(0x52D0810u, v3, v62, 0LL, 3uLL, 0LL);
            }
          }
          goto LABEL_96;
        }
        v57 = *(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v3 + 2152LL);
        v77 = v56;
        LODWORD(v58) = (*(int (__fastcall **)(IOBufferMemoryDescriptor *, signed __int64))(*(_QWORD *)v56 + 736LL))(
                         v56,
                         1LL);
        v59 = v2;
        v60 = v57(v3, v2, v58, (unsigned int)v43);
        if ( v60 )
        {
          if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          {
            v59 = v3;
            kernel_debug(0x52D0810u, v3, v60, v43, 4uLL, 0LL);
          }
          v61 = v77;
LABEL_94:
          (*(void (__fastcall **)(IOBufferMemoryDescriptor *, signed __int64))(*(_QWORD *)v61 + 40LL))(v61, v59);
          v4 = 0LL;
          goto LABEL_96;
        }
        v63 = *(_QWORD *)(v3 + 208);
        if ( *(_QWORD *)(v63 + 8LL * v2) )
        {
          (*(void (__fastcall **)(IOBufferMemoryDescriptor *))(*(_QWORD *)v77 + 40LL))(v77);
        }
        else
        {
          if ( !v2 && v74 )
          {
            LODWORD(v64) = (*(int (__fastcall **)(IOBufferMemoryDescriptor *))(*(_QWORD *)v77 + 736LL))(v77);
            *(_BYTE *)(v64 + 8) = v74;
            (*(void (__fastcall **)(IOBufferMemoryDescriptor *, _QWORD, __int64, uintptr_t))(*(_QWORD *)v77 + 488LL))(
              v77,
              0LL,
              v64,
              v43);
            v63 = *(_QWORD *)(v3 + 208);
          }
          *(_QWORD *)(v63 + 8LL * v2) = v77;
        }
      }
      if ( v44 )
      {
        v65 = *(_QWORD *)(*(_QWORD *)(v3 + 208) + 8LL * v2);
        if ( v65 )
        {
          LODWORD(v66) = (*(int (**)(void))(*(_QWORD *)v65 + 736LL))();
          v67 = v66;
          LODWORD(v68) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v44 + 376LL))(v44);
          if ( memcmp(v67, v68, (signed int)v43) )
          {
            if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
              kernel_debug(0x52D0810u, v3, v5, *(_WORD *)(v3 + 170) | (*(_WORD *)(v3 + 168) << 16), 0xBuLL, 0LL);
            v4 = 0LL;
            LODWORD(v69) = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)v3 + 904LL))(v3, 0LL);
            KernelDebugLogInternal(1u, 0x55534246u, (__int64)"USB Verified ConfigDescriptor for %s", v69, v70, v71, v73);
            v59 = 1LL;
            (*(void (__fastcall **)(uintptr_t, signed __int64))(*(_QWORD *)v3 + 2448LL))(v3, 1LL);
            *(_QWORD *)(*(_QWORD *)(v3 + 208) + 8 * v5) = 0LL;
            v61 = v77;
            if ( !v77 )
              goto LABEL_96;
            goto LABEL_94;
          }
        }
      }
    }
    LODWORD(v72) = (*(int (**)(void))(**(_QWORD **)(*(_QWORD *)(v3 + 208) + 8 * v5) + 736LL))();
    v4 = v72;
LABEL_96:
    IOUSBDevice::ReleaseGetConfigLock((IOUSBDevice *)v3);
    if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
      return v4;
    v9 = 8LL;
LABEL_13:
    v12 = v3;
    v13 = v5;
    v8 = v4;
LABEL_19:
    kernel_debug(0x52D0810u, v12, v13, v8, v9, 0LL);
    return v4;
  }
  v4 = 0LL;
  if ( gUSBStackDebugFlags & 2 )
  {
    v4 = 0LL;
    if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      v8 = v14;
      v4 = 0LL;
      v9 = 7LL;
      goto LABEL_18;
    }
  }
  return v4;
}
// 3B068: using guessed type _QWORD off_3B068[21];
// 3B070: using guessed type _QWORD off_3B070[20];
// 3B078: using guessed type _QWORD off_3B078[19];
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000017ADC) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::TakeGetConfigLock(IOUSBDevice *this)
{
  uintptr_t v1; // rbx@1
  __int64 v2; // rax@2
  __int64 v3; // rdi@3
  int v4; // er14@6
  uintptr_t v5; // rdx@8
  uintptr_t v6; // rcx@8
  uintptr_t v7; // r8@8
  __int64 v8; // rax@11
  __int64 v10; // rax@15
  __int64 v11; // r12@16
  __int64 v12; // r15@17

  v1 = (uintptr_t)this;
  if ( !(unsigned __int8)IOService::isInactive(this)
    && (v2 = *((_QWORD *)this + 29)) != 0
    && (v3 = *(_QWORD *)(v2 + 80)) != 0
    && *(_QWORD *)(v2 + 104) )
  {
    if ( (unsigned __int8)(*(int (**)(void))(*(_QWORD *)v3 + 304LL))() )
    {
      v4 = -536870174;
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        v5 = 0LL;
        v6 = 0LL;
        v7 = 2LL;
LABEL_12:
        kernel_debug(0x52D0838u, v1, v5, v6, v7, 0LL);
        return (unsigned int)v4;
      }
    }
    else
    {
      v4 = -536870208;
      if ( !(unsigned __int8)IOService::isInactive((IOService *)v1) )
      {
        v10 = *(_QWORD *)(v1 + 232);
        if ( v10 )
        {
          v11 = *(_QWORD *)(v10 + 104);
          if ( v11 )
          {
            v12 = *(_QWORD *)(v10 + 80);
            if ( v12 )
            {
              (*(void (__fastcall **)(uintptr_t))(*(_QWORD *)v1 + 32LL))(v1);
              (*(void (__fastcall **)(__int64))(*(_QWORD *)v12 + 32LL))(v12);
              (*(void (__fastcall **)(__int64))(*(_QWORD *)v11 + 32LL))(v11);
              v4 = (*(int (__fastcall **)(__int64, __int64 (__fastcall *)(IOUSBDevice *__hidden, OSObject *, void *, void *, void *, void *), signed __int64, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v11 + 456LL))(
                     v11,
                     IOUSBDevice::ChangeGetConfigLock,
                     1LL,
                     0LL,
                     0LL,
                     0LL);
              (*(void (__fastcall **)(__int64))(*(_QWORD *)v11 + 40LL))(v11);
              (*(void (__fastcall **)(__int64))(*(_QWORD *)v12 + 40LL))(v12);
              (*(void (__fastcall **)(uintptr_t))(*(_QWORD *)v1 + 40LL))(v1);
            }
          }
        }
      }
    }
  }
  else
  {
    v4 = -536870174;
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      v8 = *(_QWORD *)(v1 + 232);
      v5 = *(_QWORD *)(v8 + 80);
      v6 = *(_QWORD *)(v8 + 104);
      v7 = 1LL;
      goto LABEL_12;
    }
  }
  return (unsigned int)v4;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (0000000000017C36) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::ReleaseGetConfigLock(IOUSBDevice *this)
{
  __int64 v1; // rax@2
  int v2; // er14@5
  __int64 v3; // rax@6
  __int64 v4; // r12@7
  __int64 v5; // r15@8

  if ( !(unsigned __int8)IOService::isInactive(this)
    && (v1 = *((_QWORD *)this + 29)) != 0
    && *(_QWORD *)(v1 + 80)
    && *(_QWORD *)(v1 + 104) )
  {
    v2 = -536870208;
    if ( !(unsigned __int8)IOService::isInactive(this) )
    {
      v3 = *((_QWORD *)this + 29);
      if ( v3 )
      {
        v4 = *(_QWORD *)(v3 + 104);
        if ( v4 )
        {
          v5 = *(_QWORD *)(v3 + 80);
          if ( v5 )
          {
            (*(void (__fastcall **)(IOUSBDevice *))(*(_QWORD *)this + 32LL))(this);
            (*(void (__fastcall **)(__int64))(*(_QWORD *)v5 + 32LL))(v5);
            (*(void (__fastcall **)(__int64))(*(_QWORD *)v4 + 32LL))(v4);
            v2 = (*(int (__fastcall **)(__int64, __int64 (__fastcall *)(IOUSBDevice *__hidden, OSObject *, void *, void *, void *, void *), _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v4 + 456LL))(
                   v4,
                   IOUSBDevice::ChangeGetConfigLock,
                   0LL,
                   0LL,
                   0LL,
                   0LL);
            (*(void (__fastcall **)(__int64))(*(_QWORD *)v4 + 40LL))(v4);
            (*(void (__fastcall **)(__int64))(*(_QWORD *)v5 + 40LL))(v5);
            (*(void (__fastcall **)(IOUSBDevice *))(*(_QWORD *)this + 40LL))(this);
          }
        }
      }
    }
  }
  else
  {
    v2 = -536870174;
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(
        0x52D0838u,
        (uintptr_t)this,
        *(_QWORD *)(*((_QWORD *)this + 29) + 80LL),
        *(_QWORD *)(*((_QWORD *)this + 29) + 104LL),
        3uLL,
        0LL);
  }
  return (unsigned int)v2;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (0000000000017D64) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::GetDeviceDescriptor(uintptr_t arg1, __int64 a2, unsigned int a3)
{
  unsigned int v3; // er15@1
  signed int v4; // ebx@1
  int v5; // er12@2
  unsigned __int8 v7; // [sp+8h] [bp-38h]@2
  char v8; // [sp+9h] [bp-37h]@2
  __int16 v9; // [sp+Ah] [bp-36h]@2
  __int16 v10; // [sp+Ch] [bp-34h]@2
  __int16 v11; // [sp+Eh] [bp-32h]@2
  __int64 v12; // [sp+10h] [bp-30h]@2
  uintptr_t arg3; // [sp+18h] [bp-28h]@2

  v3 = a3;
  v4 = -536870206;
  if ( a2 )
  {
    v7 = -128;
    v8 = 6;
    v9 = 256;
    v10 = 0;
    v11 = a3;
    v12 = a2;
    LODWORD(arg3) = 0;
    v4 = 0;
    v5 = (*(int (__fastcall **)(uintptr_t, char *, signed __int64, _QWORD, _QWORD))(*(_QWORD *)arg1 + 2424LL))(
           arg1,
           &v7,
           5000LL,
           0LL,
           0LL);
    if ( v5 )
    {
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D0814u, arg1, v5, v7, 0LL, 0LL);
      v4 = v5;
    }
    else if ( (_DWORD)arg3 != v3 )
    {
      v4 = -536870169;
      if ( gUSBStackDebugFlags & 2 )
      {
        if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          kernel_debug(0x52D0814u, arg1, v3, (unsigned int)arg3, 1uLL, 0LL);
      }
    }
  }
  return (unsigned int)v4;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (0000000000017E5A) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::GetConfigDescriptor(uintptr_t arg1, __int16 a2, void *a3, unsigned int a4)
{
  unsigned int v4; // er12@1
  signed int v5; // er15@1
  int v6; // ebx@1
  unsigned __int8 v8; // [sp+8h] [bp-38h]@1
  char v9; // [sp+9h] [bp-37h]@1
  __int16 v10; // [sp+Ah] [bp-36h]@1
  __int16 v11; // [sp+Ch] [bp-34h]@1
  __int16 v12; // [sp+Eh] [bp-32h]@1
  void *v13; // [sp+10h] [bp-30h]@1
  uintptr_t arg3; // [sp+18h] [bp-28h]@1

  v4 = a4;
  v8 = -128;
  v9 = 6;
  v10 = a2 | 0x200;
  v11 = 0;
  v12 = a4;
  v13 = a3;
  LODWORD(arg3) = 0;
  v5 = 0;
  v6 = (*(int (__fastcall **)(uintptr_t, char *, signed __int64, _QWORD, _QWORD))(*(_QWORD *)arg1 + 2424LL))(
         arg1,
         &v8,
         5000LL,
         0LL,
         0LL);
  if ( v6 )
  {
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D0818u, arg1, v6, v8, 0LL, 0LL);
    v5 = v6;
  }
  else if ( (_DWORD)arg3 != v4 )
  {
    v5 = -536870169;
    if ( gUSBStackDebugFlags & 2 )
    {
      if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D0818u, arg1, v4, (unsigned int)arg3, 1uLL, 0LL);
    }
  }
  return (unsigned int)v5;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (0000000000017F44) ----------------------------------------------------
int __fastcall IOUSBDevice::RegisterInterfaces(IOUSBDevice *this)
{
  __int64 v1; // rax@1
  OSArray *v2; // rbx@1
  const OSArray *v3; // rsi@2
  unsigned int v4; // edx@2
  __int64 v5; // r12@2
  int v6; // er14@2
  unsigned int v7; // ebx@3
  OSMetaClassBase *v8; // rax@4
  const OSMetaClass *v9; // rdx@4
  __int64 v10; // rax@4
  int result; // eax@7

  IOLockLock(*(_QWORD *)(*((_QWORD *)this + 29) + 176LL));
  v1 = *((_QWORD *)this + 29);
  v2 = *(OSArray **)(v1 + 184);
  if ( v2 )
  {
    v3 = (const OSArray *)(unsigned int)(*(int (__fastcall **)(OSArray *))(*(_QWORD *)v2 + 304LL))(v2);
    v5 = OSArray::withArray(v2, v3, v4);
    v6 = (*(int (__fastcall **)(__int64, const OSArray *))(*(_QWORD *)v5 + 304LL))(v5, v3);
    IOLockUnlock(*(_QWORD *)(*((_QWORD *)this + 29) + 176LL));
    if ( v6 > 0 )
    {
      v7 = 0;
      do
      {
        LODWORD(v8) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v5 + 488LL))(v5, v7);
        v10 = OSMetaClassBase::safeMetaCast(v8, (const OSMetaClassBase *)IOUSBInterface::metaClass, v9);
        if ( v10 )
          (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v10 + 1456LL))(v10, 2LL);
        ++v7;
      }
      while ( v6 != v7 );
    }
    result = (*(int (__fastcall **)(__int64))(*(_QWORD *)v5 + 40LL))(v5);
  }
  else
  {
    result = IOLockUnlock(*(_QWORD *)(v1 + 176));
  }
  return result;
}
// 3C7A0: using guessed type _QWORD IOUSBInterface::metaClass;
// 7D230: using guessed type int __fastcall IOLockLock(_QWORD);
// 7D238: using guessed type int __fastcall IOLockUnlock(_QWORD);
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000018026) ----------------------------------------------------
int __fastcall IOUSBDevice::SetConfiguration(IOUSBDevice *this, IOService *a2, __int64 a3, unsigned __int8 a4)
{
  return (*(int (__fastcall **)(IOUSBDevice *, IOService *, __int64, _QWORD, _QWORD))(*(_QWORD *)this + 2528LL))(
           this,
           a2,
           a3,
           a4,
           0LL);
}

//----- (000000000001803E) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::SetConfiguration(IOUSBDevice *this, IOService *a2, unsigned __int8 a3, unsigned __int8 a4, char a5)
{
  unsigned __int8 v5; // r13@1
  IOService *v6; // r12@1
  uintptr_t v7; // r15@1
  __int64 v8; // rax@1
  int v9; // er12@3
  __int64 v10; // rax@5
  __int64 v11; // rbx@5
  __int64 v12; // rax@5
  OSMetaClassBase *v13; // rax@5
  OSMetaClassBase *v14; // r14@5
  signed __int64 v15; // rsi@5
  const OSMetaClass *v16; // rdx@5
  __int64 v17; // rax@5
  int v18; // eax@6
  signed int v19; // ecx@6
  char v20; // al@11
  uintptr_t v21; // r14@12
  uintptr_t v22; // rax@12
  int v23; // edx@18
  void (__fastcall *v24)(_QWORD, _QWORD, _QWORD, _QWORD); // rbx@20
  uintptr_t v25; // r12@20
  __int64 v26; // rax@21
  __int64 v27; // rax@26
  __int64 v28; // rdx@26
  char v29; // bl@27
  __int64 v30; // rax@31
  __int64 v31; // rdi@32
  __int64 v32; // rax@34
  unsigned int v33; // eax@35
  unsigned int v34; // er12@35
  __int64 v35; // rax@36
  __int64 v36; // rax@37
  char *v37; // rsi@41
  __int64 v38; // rax@45
  __int64 v39; // rax@46
  __int64 v40; // r8@46
  __int64 v41; // r9@46
  __int64 v42; // rax@56
  __int64 v43; // rcx@56
  char v44; // al@57
  unsigned __int64 v45; // r13@58
  unsigned __int8 v46; // r12@58
  unsigned __int64 v47; // rax@59
  int v48; // eax@60
  bool v49; // al@62
  __int64 v50; // rbx@62
  __int64 v51; // rax@66
  bool v52; // bl@66
  __int64 v53; // rdi@66
  __int64 v54; // rax@67
  bool v55; // zf@67
  char v56; // al@67
  unsigned __int64 v57; // rax@70
  unsigned __int64 v58; // rax@81
  unsigned __int64 v59; // rsi@85
  __int64 v60; // r14@85
  __int64 v61; // rax@86
  __int64 v62; // rdi@87
  __int64 v63; // rax@88
  __int64 v64; // rdi@88
  char v65; // bl@89
  __int64 v66; // rax@96
  __int64 v67; // rdi@97
  __int64 v68; // rax@98
  __int64 v69; // rdi@98
  uintptr_t v70; // rdx@105
  uintptr_t v71; // r8@105
  uintptr_t v72; // rsi@105
  uintptr_t v73; // rcx@105
  char v75; // [sp+0h] [bp-90h]@0
  uintptr_t v76; // [sp+8h] [bp-88h]@83
  __int64 v77; // [sp+10h] [bp-80h]@58
  char *v78; // [sp+18h] [bp-78h]@27
  __int64 v79; // [sp+20h] [bp-70h]@27
  char v80; // [sp+28h] [bp-68h]@5
  char *v81; // [sp+28h] [bp-68h]@58
  unsigned __int8 v82; // [sp+34h] [bp-5Ch]@5
  __int64 v83; // [sp+38h] [bp-58h]@5
  int v84; // [sp+44h] [bp-4Ch]@32
  int v85; // [sp+48h] [bp-48h]@6
  int v86; // [sp+4Ch] [bp-44h]@8
  char v87; // [sp+50h] [bp-40h]@41
  char v88; // [sp+51h] [bp-3Fh]@41
  __int16 v89; // [sp+52h] [bp-3Eh]@41
  __int16 v90; // [sp+54h] [bp-3Ch]@41
  __int16 v91; // [sp+56h] [bp-3Ah]@41
  __int64 v92; // [sp+58h] [bp-38h]@41

  v5 = a3;
  v6 = a2;
  v7 = (uintptr_t)this;
  v8 = *((_QWORD *)this + 29);
  if ( *(_BYTE *)(v8 + 232) )
  {
    *(_BYTE *)(v8 + 232) = 0;
    if ( *((_BYTE *)this + 224) == a3 )
    {
      v9 = 0;
      if ( a4 )
      {
        (*(void (**)(void))(*(_QWORD *)this + 32LL))();
        IOUSBDevice::RegisterInterfaces(this);
        (*(void (__fastcall **)(IOUSBDevice *))(*(_QWORD *)this + 40LL))(this);
      }
      return (unsigned int)v9;
    }
  }
  v80 = a5;
  v82 = a4;
  LODWORD(v10) = (*(int (__fastcall **)(IOUSBDevice *, _QWORD))(*(_QWORD *)this + 696LL))(this, "kAllowZeroConfigValue");
  v11 = *(_QWORD *)off_3B0F8[0];
  v83 = *(_QWORD *)off_3B0F8[0];
  *(_BYTE *)(*((_QWORD *)this + 29) + 25LL) = v10 == **(_QWORD **)off_3B0F8[0];
  LODWORD(v12) = (*(int (__fastcall **)(IOUSBDevice *, _QWORD))(*(_QWORD *)this + 696LL))(this, "kNeedsExtraResetTime");
  *(_BYTE *)(*((_QWORD *)this + 29) + 102LL) = v12 == *(_QWORD *)v11;
  LODWORD(v13) = (*(int (__fastcall **)(IOUSBDevice *, _QWORD))(*(_QWORD *)this + 744LL))(
                   this,
                   "kUSBDeviceResumeRecoveryTime");
  v14 = v13;
  v15 = *(_QWORD *)off_3B078[0];
  v17 = OSMetaClassBase::safeMetaCast(v13, *(const OSMetaClassBase **)off_3B078[0], v16);
  if ( v17 )
  {
    v85 = **((_DWORD **)this + 29);
    v18 = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v17 + 328LL))(v17, v15);
    v19 = 10;
    if ( (unsigned int)v18 >= 0xA )
      v19 = v18;
    v86 = v19;
    (*(void (**)(void))(**(_QWORD **)(*((_QWORD *)this + 29) + 16LL) + 32LL))();
    v15 = 3758112786LL;
    (*(void (__fastcall **)(_QWORD, signed __int64, int *, signed __int64))(**(_QWORD **)(*((_QWORD *)this + 29) + 16LL)
                                                                          + 1856LL))(
      *(_QWORD *)(*((_QWORD *)this + 29) + 16LL),
      3758112786LL,
      &v85,
      8LL);
    (*(void (**)(void))(**(_QWORD **)(*((_QWORD *)this + 29) + 16LL) + 40LL))();
  }
  if ( v14 )
    (*(void (__fastcall **)(OSMetaClassBase *, signed __int64))(*(_QWORD *)v14 + 40LL))(v14, v15);
  v20 = (*(int (__fastcall **)(IOUSBDevice *, IOService *))(*(_QWORD *)this + 1504LL))(this, v6);
  v9 = -536870203;
  if ( v20 )
  {
    v21 = v5;
    v22 = IOUSBDevice::FindConfig((uintptr_t)this, v5, 0LL);
    if ( v5 )
    {
      v9 = -536854442;
      if ( !v22 )
        return (unsigned int)v9;
    }
    else
    {
      if ( *(_BYTE *)(*((_QWORD *)this + 29) + 25LL) )
      {
        v9 = -536854442;
        if ( !v22 )
          return (unsigned int)v9;
      }
      if ( !v22 )
      {
        v79 = 0LL;
        v78 = (char *)this + 184;
        v29 = 0;
        goto LABEL_29;
      }
    }
    v23 = 4 * *(_BYTE *)(v22 + 8);
    if ( *((_BYTE *)this + 184) != 3 )
      v23 = *(_BYTE *)(v22 + 8);
    v24 = *(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 640LL);
    v25 = (unsigned int)v23;
    if ( (unsigned int)v23 > *((_DWORD *)this + 45) )
    {
      v24(this, "Failed Requested Power", (unsigned int)v23, 32LL);
      LODWORD(v26) = (*(int (__fastcall **)(IOUSBDevice *, _QWORD))(*(_QWORD *)this + 696LL))(
                       this,
                       "Low Power Displayed");
      if ( v26 != *(_QWORD *)v83 )
      {
        (*(void (__fastcall **)(IOUSBDevice *, signed __int64))(*(_QWORD *)this + 2456LL))(this, 1LL);
        (*(void (__fastcall **)(IOUSBDevice *, _QWORD, _QWORD))(*(_QWORD *)this + 616LL))(
          this,
          "Low Power Displayed",
          *(_QWORD *)v83);
      }
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D081Cu, (uintptr_t)this, v25, *((_DWORD *)this + 45), 1uLL, 0LL);
      LODWORD(v27) = (*(int (__fastcall **)(IOUSBDevice *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
      IOLog(
        "USB Low Power Notice:  The device \"%s\" cannot be used because there is not enough power to configure it\n",
        v27,
        v28,
        v27);
      v9 = -536854435;
      return (unsigned int)v9;
    }
    v79 = v22;
    v78 = (char *)this + 184;
    v24(this, "Requested Power", (unsigned int)v23, 32LL);
    v29 = 1;
LABEL_29:
    (*(void (__fastcall **)(IOUSBDevice *, _QWORD, _QWORD))(*(_QWORD *)this + 616LL))(
      this,
      "Low Power Displayed",
      **(_QWORD **)off_3B0F0[0]);
    if ( *((_BYTE *)this + 184) == 3 && *((_DWORD *)this + 45) == 450 )
    {
      v30 = *((_QWORD *)this + 29);
      if ( !*(_BYTE *)(v30 + 196) )
      {
        v84 = 0;
        v31 = *(_QWORD *)(v30 + 144);
        if ( v31 )
        {
          if ( !(*(int (__fastcall **)(__int64, _QWORD, int *))(*(_QWORD *)v31 + 2152LL))(v31, *(_DWORD *)v30, &v84) )
          {
            v32 = v84 & 0x3000;
            if ( (_DWORD)v32 == 4096 )
            {
              v33 = IOUSBDevice::RequestExtraPower((IOUSBDevice *)v7, v32, 0x190u, 7u);
              v34 = v33;
              if ( v33 == 400 )
              {
                v35 = *(_QWORD *)(v7 + 232);
                *(_DWORD *)(v35 + 204) = 400;
                *(_BYTE *)(v35 + 196) = 1;
              }
              else
              {
                IOUSBDevice::ReturnExtraPower((IOUSBDevice *)v7, 7u, v33);
                *(_BYTE *)(*(_QWORD *)(v7 + 232) + 196LL) = 0;
                LODWORD(v36) = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)v7 + 904LL))(v7, 0LL);
                KernelDebugLogInternal(
                  1u,
                  0x55534246u,
                  (__int64)"The IOUSBFamily did not receive enough extra current for the SuperSpeed device (%s) at 0x%x, asked for 400mA but got %d mA",
                  v36,
                  *(_DWORD *)(*(_QWORD *)(v7 + 232) + 172LL),
                  v34,
                  v75);
              }
            }
          }
        }
      }
    }
    IOUSBDevice::TerminateInterfaces((IOUSBDevice *)v7, 1);
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D081Cu, v7, v5, v82, 2uLL, 0LL);
    v87 = 0;
    v88 = 9;
    v89 = v5;
    v90 = 0;
    v91 = 0;
    v92 = 0LL;
    v37 = &v87;
    v9 = (*(int (__fastcall **)(uintptr_t, char *, signed __int64, _QWORD, _QWORD))(*(_QWORD *)v7 + 2424LL))(
           v7,
           &v87,
           5000LL,
           0LL,
           0LL);
    if ( v9 )
    {
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D081Cu, v7, v5, v9, 3uLL, 0LL);
      LODWORD(v38) = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)v7 + 696LL))(v7, "ReEnumOnSetConfigFailure");
      if ( v38 == *(_QWORD *)v83 )
      {
        LODWORD(v39) = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)v7 + 904LL))(v7, 0LL);
        KernelDebugLogInternal(1u, 0x55534246u, (__int64)"USB Verified SetConfiguration for %s", v39, v40, v41, v75);
        (*(void (__fastcall **)(uintptr_t, signed __int64))(*(_QWORD *)v7 + 2448LL))(v7, 1LL);
      }
      return (unsigned int)v9;
    }
    *(_BYTE *)(v7 + 224) = v5;
    if ( (unsigned __int8)(v29 & v80) == 1 && *v78 != 3 )
    {
      if ( *(_BYTE *)(v79 + 7) & 0x20 )
      {
        v37 = (_BYTE *)(&dword_0 + 1);
        if ( (*(int (__fastcall **)(uintptr_t, signed __int64))(*(_QWORD *)v7 + 2144LL))(v7, 1LL) )
        {
          IOSleep(300LL);
          v37 = (_BYTE *)(&dword_0 + 1);
          (*(void (__fastcall **)(uintptr_t, signed __int64))(*(_QWORD *)v7 + 2144LL))(v7, 1LL);
        }
      }
    }
    if ( !v5 && !*(_BYTE *)(*(_QWORD *)(v7 + 232) + 25LL) )
      goto LABEL_115;
    if ( v29 && *(_BYTE *)(v79 + 4) )
    {
      v42 = OSArray::withCapacity((OSArray *)*(_BYTE *)(v79 + 4), (unsigned int)v37);
      v43 = *(_QWORD *)(v7 + 232);
      *(_QWORD *)(v43 + 184) = v42;
      if ( v42 )
      {
        v44 = *(_BYTE *)(v79 + 4);
        *(_BYTE *)(v7 + 225) = v44;
        if ( v44 )
        {
          v45 = 0LL;
          v46 = 0;
          v77 = 0LL;
          v81 = 0LL;
          do
          {
            v37 = (char *)v45;
            LODWORD(v47) = (*(int (__fastcall **)(uintptr_t, unsigned __int64, signed __int64))(*(_QWORD *)v7 + 2408LL))(
                             v7,
                             v45,
                             4LL);
            v45 = v47;
            if ( !v47 )
              break;
            v48 = *(_BYTE *)(v47 + 5);
            if ( v48 == 8 )
              *(_BYTE *)(*(_QWORD *)(v7 + 232) + 233LL) = 1;
            v49 = (unsigned __int8)v48 != 8;
            v50 = v77;
            if ( BYTE1(gUSBStackDebugFlags) & 0x20 || v49 || *(_BYTE *)(v45 + 6) != 6 || *(_BYTE *)(v45 + 7) != 80 )
            {
              if ( v77 & 1 )
              {
                do
                {
                  if ( *(_BYTE *)(v45 + 3) == v46 )
                    break;
                  v37 = (char *)v45;
                  LODWORD(v58) = (*(int (__fastcall **)(uintptr_t, unsigned __int64, signed __int64))(*(_QWORD *)v7 + 2408LL))(
                                   v7,
                                   v45,
                                   4LL);
                  v45 = v58;
                }
                while ( v58 );
              }
            }
            else
            {
              LODWORD(v51) = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)v7 + 696LL))(v7, "ForceBOTProtocol");
              v52 = v51 == *(_QWORD *)v83;
              v53 = *(_QWORD *)(v7 + 144);
              if ( v53 )
              {
                LODWORD(v54) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v53 + 696LL))(v53, "DisableUAS");
                v55 = v54 == *(_QWORD *)v83;
                v56 = 1;
                if ( !v55 )
                  v56 = v52;
                v52 = v56;
              }
              v37 = (char *)v45;
              LODWORD(v57) = (*(int (__fastcall **)(uintptr_t, unsigned __int64, signed __int64))(*(_QWORD *)v7 + 2408LL))(
                               v7,
                               v45,
                               4LL);
              v55 = v52 == 0;
              v50 = v77;
              if ( v55
                && *v78 == 3
                && v57
                && *(_BYTE *)(v45 + 2) == *(_BYTE *)(v57 + 2)
                && *(_BYTE *)(v57 + 5) == 8
                && *(_BYTE *)(v57 + 6) == 6
                && *(_BYTE *)(v57 + 7) == 98
                && *(_BYTE *)(v57 + 3) )
              {
                v45 = v57;
                v37 = "kHasMSCInterface";
                (*(void (__fastcall **)(uintptr_t, _QWORD, _QWORD))(*(_QWORD *)v7 + 616LL))(
                  v7,
                  "kHasMSCInterface",
                  *(_QWORD *)v83);
              }
            }
            if ( !v45 )
            {
              if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
              {
                v37 = (char *)v7;
                kernel_debug(0x52D081Cu, v7, (signed int)v81, 0LL, 0xAuLL, 0LL);
              }
              break;
            }
            v76 = v21;
            if ( !(v50 & 1) )
            {
              v46 = *(_BYTE *)(v45 + 3);
              LOBYTE(v50) = 1;
            }
            v59 = v45;
            v60 = IOUSBInterface::withDescriptors(v79, v45);
            if ( !v60 )
            {
              v9 = -536870211;
              if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
              {
                v70 = (signed int)v81;
                v71 = 9LL;
                v72 = v7;
                v73 = v45;
                goto LABEL_118;
              }
              return (unsigned int)v9;
            }
            v61 = *(_QWORD *)(v7 + 232);
            if ( v61 && (v62 = *(_QWORD *)(v61 + 176)) != 0 )
            {
              v77 = v50;
              IOLockLock(v62);
              v63 = *(_QWORD *)(v7 + 232);
              v64 = *(_QWORD *)(v63 + 184);
              if ( v64 )
              {
                v59 = (unsigned __int64)v81;
                v65 = (*(int (__fastcall **)(__int64, char *, __int64))(*(_QWORD *)v64 + 448LL))(v64, v81, v60);
                v63 = *(_QWORD *)(v7 + 232);
              }
              else
              {
                v65 = 0;
              }
              IOLockUnlock(*(_QWORD *)(v63 + 176));
            }
            else
            {
              v77 = v50;
              v65 = 0;
            }
            (*(void (__fastcall **)(__int64, unsigned __int64))(*(_QWORD *)v60 + 40LL))(v60, v59);
            if ( !v65 )
            {
              v9 = -536870210;
              if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
              {
                v73 = *(_DWORD *)(*(_QWORD *)(v7 + 232) + 172LL);
                v70 = (signed int)v81;
                v71 = 8LL;
                goto LABEL_109;
              }
              return (unsigned int)v9;
            }
            if ( !(unsigned __int8)(*(int (__fastcall **)(__int64, uintptr_t))(*(_QWORD *)v60 + 1648LL))(v60, v7) )
            {
              IOUSBDevice::TerminateInterfaces((IOUSBDevice *)v7, 0);
              v9 = -536870210;
              if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
              {
                v70 = (signed int)v81;
                v71 = 7LL;
                v72 = v7;
                v73 = v60;
                goto LABEL_118;
              }
              return (unsigned int)v9;
            }
            v37 = (char *)v7;
            if ( !(unsigned __int8)(*(int (__fastcall **)(__int64, uintptr_t))(*(_QWORD *)v60 + 1472LL))(v60, v7) )
            {
              v37 = (char *)v7;
              (*(void (__fastcall **)(__int64, uintptr_t))(*(_QWORD *)v60 + 1656LL))(v60, v7);
              v66 = *(_QWORD *)(v7 + 232);
              if ( v66 )
              {
                v67 = *(_QWORD *)(v66 + 176);
                if ( v67 )
                {
                  IOLockLock(v67);
                  v68 = *(_QWORD *)(v7 + 232);
                  v69 = *(_QWORD *)(v68 + 184);
                  if ( v69 )
                  {
                    v37 = v81;
                    (*(void (__fastcall **)(__int64, char *))(*(_QWORD *)v69 + 472LL))(v69, v81);
                    v68 = *(_QWORD *)(v7 + 232);
                  }
                  IOLockUnlock(*(_QWORD *)(v68 + 176));
                }
              }
            }
            v81 = (char *)(unsigned int)((_DWORD)v81 + 1);
            v21 = v76;
          }
          while ( (signed int)v81 < *(_BYTE *)(v79 + 4) );
        }
        if ( v82 )
        {
          (*(void (__fastcall **)(uintptr_t, char *))(*(_QWORD *)v7 + 32LL))(v7, v37);
          IOUSBDevice::RegisterInterfaces((IOUSBDevice *)v7);
          (*(void (__fastcall **)(uintptr_t))(*(_QWORD *)v7 + 40LL))(v7);
        }
LABEL_115:
        v9 = 0;
        if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
          return (unsigned int)v9;
        v73 = v82;
        v9 = 0;
        v71 = 4LL;
        v72 = v7;
        v70 = v21;
        goto LABEL_118;
      }
      v9 = -536870210;
      if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
        return (unsigned int)v9;
      v70 = *(_DWORD *)(v43 + 172);
      v73 = 0LL;
      v71 = 6LL;
LABEL_109:
      v72 = v7;
    }
    else
    {
      v9 = -536870210;
      if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
        return (unsigned int)v9;
      v70 = *(_DWORD *)(*(_QWORD *)(v7 + 232) + 172LL);
      v71 = 5LL;
      v72 = v7;
      v73 = v79;
    }
LABEL_118:
    kernel_debug(0x52D081Cu, v72, v70, v73, v71, 0LL);
  }
  return (unsigned int)v9;
}
// 0: using guessed type int dword_0;
// 3B078: using guessed type _QWORD off_3B078[19];
// 3B0F0: using guessed type __int64 off_3B0F0[4];
// 3B0F8: using guessed type __int64 off_3B0F8[3];
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 7D230: using guessed type int __fastcall IOLockLock(_QWORD);
// 7D238: using guessed type int __fastcall IOLockUnlock(_QWORD);
// 7D240: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD);
// 7D278: using guessed type int __fastcall IOSleep(_QWORD);
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000018B44) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::SetFeature(uintptr_t arg1, __int16 a2)
{
  int v2; // ebx@1
  char v4; // [sp+0h] [bp-30h]@1
  char v5; // [sp+1h] [bp-2Fh]@1
  __int16 v6; // [sp+2h] [bp-2Eh]@1
  __int16 v7; // [sp+4h] [bp-2Ch]@1
  __int16 v8; // [sp+6h] [bp-2Ah]@1
  __int64 v9; // [sp+8h] [bp-28h]@1

  v4 = 0;
  v5 = 3;
  v6 = a2;
  v7 = 0;
  v8 = 0;
  v9 = 0LL;
  v2 = (*(int (__fastcall **)(uintptr_t, char *, signed __int64, _QWORD, _QWORD))(*(_QWORD *)arg1 + 2424LL))(
         arg1,
         &v4,
         5000LL,
         0LL,
         0LL);
  if ( v2 && gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D0820u, arg1, (unsigned __int8)a2, v2, 0LL, 0LL);
  return (unsigned int)v2;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (0000000000018BD8) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::SetIsochDelay(uintptr_t arg1, __int16 a2)
{
  int v2; // ebx@1
  __int64 v3; // rax@6
  char v5; // [sp+0h] [bp-30h]@2
  char v6; // [sp+1h] [bp-2Fh]@2
  __int16 v7; // [sp+2h] [bp-2Eh]@2
  __int16 v8; // [sp+4h] [bp-2Ch]@2
  __int16 v9; // [sp+6h] [bp-2Ah]@2
  __int64 v10; // [sp+8h] [bp-28h]@2

  v2 = -536870201;
  if ( *(_BYTE *)(arg1 + 184) == 3 )
  {
    v5 = 0;
    v6 = 49;
    v7 = a2;
    v8 = 0;
    v9 = 0;
    v10 = 0LL;
    v2 = (*(int (__fastcall **)(uintptr_t, char *, signed __int64, _QWORD, _QWORD))(*(_QWORD *)arg1 + 2424LL))(
           arg1,
           &v5,
           5000LL,
           0LL,
           0LL);
    if ( v2 )
    {
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D0820u, arg1, (unsigned __int16)a2, v2, 1uLL, 0LL);
    }
    else
    {
      v3 = *(_QWORD *)(arg1 + 232);
      if ( v3 )
        *(_WORD *)(v3 + 210) = a2;
      v2 = 0;
    }
  }
  return (unsigned int)v2;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (0000000000018CA0) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::GetInterface(__int64 a1, __int64 a2)
{
  __int64 v2; // r15@1
  __int64 v3; // rax@1
  __int64 v4; // r13@1
  __int64 v5; // rdi@2
  unsigned int v6; // ebx@3
  unsigned int v7; // eax@4
  __int64 v8; // r12@4
  OSMetaClassBase *v9; // rax@6
  const OSMetaClass *v10; // rdx@6

  v2 = a1;
  v3 = *(_QWORD *)(a1 + 232);
  v4 = 0LL;
  if ( v3 )
  {
    v5 = *(_QWORD *)(v3 + 176);
    v4 = 0LL;
    if ( v5 )
    {
      v6 = 0;
      v4 = 0LL;
      if ( *(_QWORD *)(v3 + 184) )
      {
        IOLockLock(v5);
        LOBYTE(v7) = 0;
        v8 = 0LL;
        if ( *(_BYTE *)(v2 + 225) )
        {
          v6 = 0;
          while ( 1 )
          {
            LODWORD(v9) = (*(int (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(*(_QWORD *)(v2 + 232) + 184LL) + 488LL))(
                            *(_QWORD *)(*(_QWORD *)(v2 + 232) + 184LL),
                            v6);
            v8 = OSMetaClassBase::safeMetaCast(v9, (const OSMetaClassBase *)IOUSBInterface::metaClass, v10);
            if ( v8 )
            {
              if ( (unsigned __int8)(*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v8 + 2224LL))(
                                      v8,
                                      IOUSBInterface::metaClass) == *(_BYTE *)(a2 + 2)
                && (unsigned __int8)(*(int (__fastcall **)(__int64))(*(_QWORD *)v8 + 2232LL))(v8) == *(_BYTE *)(a2 + 3) )
                break;
            }
            ++v6;
            v7 = *(_BYTE *)(v2 + 225);
            if ( (signed int)v6 >= (signed int)v7 )
              goto LABEL_12;
          }
          LOBYTE(v7) = *(_BYTE *)(v2 + 225);
        }
LABEL_12:
        v4 = 0LL;
        if ( v6 != (unsigned __int8)v7 )
          v4 = v8;
        IOLockUnlock(*(_QWORD *)(*(_QWORD *)(v2 + 232) + 176LL));
      }
    }
  }
  return v4;
}
// 3C7A0: using guessed type _QWORD IOUSBInterface::metaClass;
// 7D230: using guessed type int __fastcall IOLockLock(_QWORD);
// 7D238: using guessed type int __fastcall IOLockUnlock(_QWORD);
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000018DC0) ----------------------------------------------------
int __fastcall IOUSBDevice::OpenOrCloseAllInterfacePipes(IOUSBDevice *this, char a2)
{
  IOUSBDevice *v2; // r12@1
  __int64 v3; // rax@1
  __int64 v4; // rdi@2
  __int64 v5; // rax@4
  signed int v6; // ebx@5
  OSMetaClassBase *v7; // rax@6
  const OSMetaClass *v8; // rdx@6
  __int64 v9; // r13@6

  v2 = this;
  v3 = *((_QWORD *)this + 29);
  if ( v3 )
  {
    v4 = *(_QWORD *)(v3 + 176);
    if ( v4 )
    {
      if ( *(_QWORD *)(v3 + 184) )
      {
        IOLockLock(v4);
        v5 = *((_QWORD *)v2 + 29);
        if ( *((_BYTE *)v2 + 225) )
        {
          v6 = 0;
          do
          {
            LODWORD(v7) = (*(int (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(v5 + 184) + 488LL))(
                            *(_QWORD *)(v5 + 184),
                            (unsigned int)v6);
            v9 = OSMetaClassBase::safeMetaCast(v7, (const OSMetaClassBase *)IOUSBInterface::metaClass, v8);
            if ( v9 )
            {
              if ( a2 )
              {
                (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v9 + 2336LL))(v9, IOUSBInterface::metaClass);
                (*(void (__fastcall **)(__int64))(*(_QWORD *)v9 + 2320LL))(v9);
              }
              else
              {
                (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v9 + 2312LL))(v9, IOUSBInterface::metaClass);
                (*(void (__fastcall **)(__int64))(*(_QWORD *)v9 + 2328LL))(v9);
              }
            }
            ++v6;
            v5 = *((_QWORD *)v2 + 29);
          }
          while ( v6 < *((_BYTE *)v2 + 225) );
        }
        LODWORD(v3) = IOLockUnlock(*(_QWORD *)(v5 + 176));
      }
    }
  }
  return v3;
}
// 3C7A0: using guessed type _QWORD IOUSBInterface::metaClass;
// 7D230: using guessed type int __fastcall IOLockLock(_QWORD);
// 7D238: using guessed type int __fastcall IOLockUnlock(_QWORD);
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000018ECC) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::GetConfigurationDescriptor(IOUSBDevice *this, unsigned __int8 a2, void *a3, unsigned int a4)
{
  unsigned int v4; // ebx@1
  void *v5; // r14@1
  uintptr_t v6; // rax@1
  signed int v7; // ecx@1
  unsigned int v8; // ecx@2

  v4 = a4;
  v5 = a3;
  v6 = IOUSBDevice::FindConfig((uintptr_t)this, a2, 0LL);
  v7 = -536854442;
  if ( v6 )
  {
    v8 = *(_WORD *)(v6 + 2);
    if ( v8 > v4 )
      v8 = v4;
    bcopy((const void *)v6, v5, v8);
    v7 = 0;
  }
  return (unsigned int)v7;
}

//----- (0000000000018F08) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::matchPropertyTable(IOUSBDevice *this, OSDictionary *a2, int *a3)
{
  int *v3; // r14@1
  void *v4; // r13@1
  void *v5; // r15@1
  __int64 v6; // rbx@1
  int v7; // er12@1
  char *v8; // rdi@1
  __int64 v9; // rax@2
  __int64 v10; // rax@2
  __int64 v11; // rax@2
  __int64 v12; // rax@2
  __int64 v13; // rax@2
  __int64 v14; // rax@2
  __int64 v15; // rax@2
  OSMetaClassBase *v16; // rax@2
  const OSMetaClass *v17; // rdx@2
  char v18; // r12@2
  int v19; // er14@4
  int v20; // ebx@4
  char v21; // al@7
  int v22; // eax@8
  int v23; // eax@12
  int v24; // er14@16
  char v25; // bl@17
  char v26; // al@19
  __int64 result; // rax@20
  signed int v28; // ecx@25
  OSMetaClassBase *v29; // rax@27
  const OSMetaClass *v30; // rdx@27
  int v31; // ecx@27
  bool v32; // r14@27
  bool v33; // r8@27
  bool v34; // dl@27
  int *v35; // rsi@32
  int v36; // edx@32
  signed int v37; // eax@32
  int v38; // ebx@32
  int v39; // eax@55
  int v40; // edx@63
  int v41; // eax@63
  OSMetaClassBase *v42; // rax@67
  const OSMetaClass *v43; // rdx@67
  __int64 v44; // rax@67
  __int64 v45; // rax@67
  int *v46; // rax@67
  __int64 v47; // rax@67
  void *v48; // rax@67
  __int64 v49; // rax@67
  __int64 v50; // rax@67
  __int64 v51; // rax@67
  __int64 v52; // r12@67
  __int64 v53; // rax@67
  __int64 v54; // r14@67
  __int64 v55; // rax@67
  __int64 v56; // rbx@67
  __int64 v57; // rax@67
  void *v58; // rax@67
  char v59; // r12@73
  char *v60; // rsi@73
  int v61; // eax@74
  __int64 v62; // rcx@77
  const char *v63; // rdx@77
  int v64; // eax@86
  int v65; // eax@88
  int v66; // eax@90
  int v67; // eax@92
  int v68; // eax@94
  __int64 v69; // r12@94
  bool v70; // zf@95
  char v71; // bl@97
  int v72; // eax@99
  int v73; // er14@103
  int v74; // eax@103
  int v75; // er14@107
  int v76; // eax@107
  int v77; // er14@111
  int v78; // eax@111
  int v79; // er14@115
  int v80; // eax@115
  int v81; // er14@119
  int v82; // eax@119
  char *v83; // rdi@119
  char *v84; // rsi@119
  __int64 v85; // [sp+8h] [bp-2F8h]@73
  __int64 v86; // [sp+10h] [bp-2F0h]@73
  bool v87; // [sp+1Eh] [bp-2E2h]@0
  char v88; // [sp+1Fh] [bp-2E1h]@0
  char *v89; // [sp+20h] [bp-2E0h]@32
  signed int v90; // [sp+28h] [bp-2D8h]@27
  __int64 v91; // [sp+28h] [bp-2D8h]@73
  void *v92; // [sp+30h] [bp-2D0h]@73
  __int64 v93; // [sp+38h] [bp-2C8h]@67
  int v94; // [sp+40h] [bp-2C0h]@14
  __int64 v95; // [sp+40h] [bp-2C0h]@67
  __int64 v96; // [sp+48h] [bp-2B8h]@0
  int v97; // [sp+50h] [bp-2B0h]@10
  __int64 v98; // [sp+50h] [bp-2B0h]@67
  __int64 v99; // [sp+58h] [bp-2A8h]@0
  int v100; // [sp+60h] [bp-2A0h]@14
  __int64 v101; // [sp+60h] [bp-2A0h]@67
  int v102; // [sp+68h] [bp-298h]@14
  __int64 v103; // [sp+68h] [bp-298h]@67
  int *v104; // [sp+70h] [bp-290h]@0
  char *v105; // [sp+78h] [bp-288h]@0
  __int64 v106; // [sp+80h] [bp-280h]@0
  int v107; // [sp+88h] [bp-278h]@12
  __int64 v108; // [sp+88h] [bp-278h]@67
  int v109; // [sp+94h] [bp-26Ch]@8
  int v110; // [sp+94h] [bp-26Ch]@55
  __int64 v111; // [sp+98h] [bp-268h]@0
  __int64 v112; // [sp+A0h] [bp-260h]@0
  __int64 v113; // [sp+A8h] [bp-258h]@0
  __int64 v114; // [sp+B0h] [bp-250h]@0
  __int64 v115; // [sp+B8h] [bp-248h]@0
  unsigned __int8 v116; // [sp+C7h] [bp-239h]@0
  unsigned __int8 v117; // [sp+C8h] [bp-238h]@0
  unsigned __int8 v118; // [sp+C9h] [bp-237h]@0
  unsigned __int8 v119; // [sp+CAh] [bp-236h]@0
  unsigned __int8 v120; // [sp+CBh] [bp-235h]@0
  unsigned int v121; // [sp+CCh] [bp-234h]@3
  char v122; // [sp+D0h] [bp-230h]@73
  char v123; // [sp+1D0h] [bp-130h]@1
  __int64 v124; // [sp+2D0h] [bp-30h]@1

  v3 = a3;
  v4 = (void *)a2;
  v5 = (void *)this;
  v6 = off_3B0E0[0];
  v124 = *(_QWORD *)off_3B0E0[0];
  v7 = *a3;
  v8 = &v123;
  __bzero(&v123, 256LL);
  if ( !a2 )
  {
    result = 0LL;
    goto LABEL_126;
  }
  LODWORD(v105) = v7;
  v104 = v3;
  LODWORD(v9) = (*(int (__fastcall **)(OSDictionary *, __int64))(*(_QWORD *)a2 + 504LL))(a2, gUSBVendorID);
  v96 = v9;
  LODWORD(v10) = (*(int (__fastcall **)(OSDictionary *, __int64))(*(_QWORD *)a2 + 504LL))(a2, gUSBProductID);
  v99 = v10;
  LODWORD(v11) = (*(int (__fastcall **)(OSDictionary *, __int64))(*(_QWORD *)a2 + 504LL))(a2, gUSBDeviceReleaseNumber);
  v106 = v11;
  LODWORD(v12) = (*(int (__fastcall **)(OSDictionary *, __int64))(*(_QWORD *)a2 + 504LL))(a2, gUSBDeviceClass);
  v112 = v12;
  LODWORD(v13) = (*(int (__fastcall **)(OSDictionary *, __int64))(*(_QWORD *)a2 + 504LL))(a2, gUSBDeviceSubClass);
  v111 = v13;
  LODWORD(v14) = (*(int (__fastcall **)(OSDictionary *, __int64))(*(_QWORD *)a2 + 504LL))(a2, gUSBDeviceProtocol);
  v114 = v14;
  LODWORD(v15) = (*(int (__fastcall **)(OSDictionary *, __int64))(*(_QWORD *)a2 + 504LL))(a2, gUSBProductIDMask);
  v115 = v15;
  LODWORD(v16) = (*(int (__fastcall **)(OSDictionary *, _QWORD))(*(_QWORD *)a2 + 520LL))(a2, "idProductArray");
  v113 = OSMetaClassBase::safeMetaCast(v16, *(const OSMetaClassBase **)off_3B070[0], v17);
  v116 = (*(int (__fastcall **)(void *, OSDictionary *, __int64))(*(_QWORD *)v5 + 2128LL))(v5, a2, gUSBVendorID);
  v18 = (*(int (__fastcall **)(void *, OSDictionary *, __int64))(*(_QWORD *)v5 + 2128LL))(v5, a2, gUSBProductID);
  v120 = (*(int (__fastcall **)(void *, OSDictionary *, __int64))(*(_QWORD *)v5 + 2128LL))(
           v5,
           a2,
           gUSBDeviceReleaseNumber);
  v117 = (*(int (__fastcall **)(void *, OSDictionary *, __int64))(*(_QWORD *)v5 + 2128LL))(v5, a2, gUSBDeviceClass);
  v119 = (*(int (__fastcall **)(void *, OSDictionary *, __int64))(*(_QWORD *)v5 + 2128LL))(v5, a2, gUSBDeviceSubClass);
  v118 = (*(int (__fastcall **)(void *, OSDictionary *, __int64))(*(_QWORD *)v5 + 2128LL))(v5, a2, gUSBDeviceProtocol);
  if ( v113 )
    v18 = IOUSBNub::USBComparePropertyInArray((IOUSBNub *)v5, a2, "idProductArray", (const char *)"idProduct", &v121);
  v19 = 0;
  v20 = 0;
  if ( !v116 )
  {
    v116 = IOUSBNub::IsWildCardMatch((IOUSBNub *)v5, a2, (const char *)"idVendor");
    v20 = v116;
  }
  if ( !v18 )
  {
    v21 = IOUSBNub::IsWildCardMatch((IOUSBNub *)v5, a2, (const char *)"idProduct");
    v19 = (unsigned __int8)v21;
    v18 = v21;
  }
  v109 = 0;
  v22 = 0;
  if ( !v120 )
  {
    v120 = IOUSBNub::IsWildCardMatch((IOUSBNub *)v5, a2, (const char *)"bcdDevice");
    v22 = v120;
  }
  v97 = v22;
  if ( !v117 )
  {
    v117 = IOUSBNub::IsWildCardMatch((IOUSBNub *)v5, a2, (const char *)"bDeviceClass");
    v109 = v117;
  }
  v107 = 0;
  v23 = 0;
  if ( !v119 )
  {
    v119 = IOUSBNub::IsWildCardMatch((IOUSBNub *)v5, a2, (const char *)"bDeviceSubClass");
    v23 = v119;
  }
  v94 = v23;
  v100 = v19;
  v102 = v20;
  if ( !v118 )
  {
    v118 = IOUSBNub::IsWildCardMatch((IOUSBNub *)v5, a2, (const char *)"bDeviceProtocol");
    v107 = v118;
  }
  v24 = 0;
  if ( v115 )
  {
    v25 = v18;
    if ( !v18 )
    {
      if ( v113 )
        v26 = IOUSBNub::USBComparePropertyInArrayWithMask(
                (IOUSBNub *)v5,
                a2,
                "idProductArray",
                (const char *)"idProduct",
                (const char *)"idProductMask",
                &v121);
      else
        v26 = IOUSBNub::USBComparePropertyWithMask(
                (IOUSBNub *)v5,
                a2,
                (const char *)"idProduct",
                (const char *)"idProductMask");
      v25 = v26;
      LOBYTE(v24) = v26;
    }
  }
  else
  {
    v25 = v18;
  }
  v8 = (char *)v5;
  if ( !(unsigned __int8)((int (__fastcall *)(void *, OSDictionary *))`vtable for'IOUSBNub[202])(v5, a2) )
  {
    result = 0LL;
    v6 = off_3B0E0[0];
    goto LABEL_126;
  }
  LODWORD(v115) = v24;
  v28 = 9000;
  if ( (signed int)v105 <= 9999 )
    v28 = (signed int)v105;
  v90 = v28;
  LODWORD(v29) = (*(int (__fastcall **)(void *, __int64))(*(_QWORD *)v5 + 728LL))(v5, gUSBDeviceClass);
  v105 = (char *)v29;
  v8 = (char *)OSMetaClassBase::safeMetaCast(v29, *(const OSMetaClassBase **)off_3B078[0], v30);
  v87 = v116 == 0;
  v88 = v25;
  v32 = v112 != 0 && v117 == 0;
  v33 = v111 != 0 && v119 == 0;
  v34 = v114 != 0 && v118 == 0;
  if ( v116 == 0 || v25 == 0 || !v120 || v32 || v33 || v34 )
  {
    if ( v34 || v33 || v32 || v120 == 0 && v106 != 0 || v116 == 0 || v25 == 0 )
    {
      if ( v8 && (*(int (**)(void))(*(_QWORD *)v8 + 328LL))() == 255 )
      {
        if ( v87 || v119 == 0 || !v118 || v32 || v106 != 0 || v99 )
        {
          if ( v87 || v119 == 0 || v114 != 0 || v32 || v106 || v99 )
            goto LABEL_127;
          v89 = v8;
          v35 = v104;
          *v104 = 70000;
          v31 = v102 + v94;
          v37 = 70000;
        }
        else
        {
          v89 = v8;
          v35 = v104;
          *v104 = 80000;
          v31 = v107 + v102 + v94;
          v37 = 80000;
        }
        v36 = v31;
        v38 = v115;
      }
      else
      {
        v35 = v104;
        v38 = v115;
        if ( v119 == 0 || v117 == 0 || !v118 || v106 || v96 || v99 )
        {
          if ( v114 != 0 || v119 == 0 || v117 == 0 || v106 || v96 || v99 )
          {
            v89 = v8;
            *v104 = 0;
            v39 = 0;
            v110 = 0;
            v36 = 0;
            goto LABEL_63;
          }
          v89 = v8;
          *v104 = 50000;
          v31 = v109 + v94;
          v37 = 50000;
        }
        else
        {
          v89 = v8;
          *v104 = 60000;
          v31 = v107 + v109 + v94;
          v37 = 60000;
        }
        v36 = v31;
      }
    }
    else
    {
      v89 = v8;
      v35 = v104;
      *v104 = 90000;
      v36 = v102 + v100;
      v37 = 90000;
      v38 = v115;
    }
  }
  else
  {
    v89 = v8;
    v35 = v104;
    *v104 = 100000;
    v36 = v97 + v102 + v100;
    v37 = 100000;
    v38 = v115;
  }
  v39 = v90 + v37;
  *v35 = v39;
  LOBYTE(v31) = 1;
  v110 = v31;
  while ( 1 )
  {
LABEL_63:
    LODWORD(v115) = v38;
    v40 = v39 + -1000 * v36;
    v41 = v40 - 500;
    if ( !(_BYTE)v38 )
      v41 = v40;
    *v35 = v41;
    if ( v41 <= 0 )
      goto LABEL_123;
    if ( (unsigned int)gKernelDebugLevel < 5 )
      goto LABEL_123;
    LODWORD(v42) = (*(int (__fastcall **)(void *, _QWORD))(*(_QWORD *)v4 + 520LL))(v4, "CFBundleIdentifier");
    OSMetaClassBase::safeMetaCast(v42, *(const OSMetaClassBase **)off_3B088[0], v43);
    LODWORD(v44) = (*(int (__fastcall **)(void *, __int64))(*(_QWORD *)v5 + 680LL))(v5, gUSBVendorID);
    v108 = v44;
    LODWORD(v45) = (*(int (__fastcall **)(void *, __int64))(*(_QWORD *)v5 + 680LL))(v5, gUSBProductID);
    v103 = v45;
    LODWORD(v46) = (*(int (__fastcall **)(void *, __int64))(*(_QWORD *)v5 + 680LL))(v5, gUSBDeviceReleaseNumber);
    v104 = v46;
    LODWORD(v47) = (*(int (__fastcall **)(void *, __int64))(*(_QWORD *)v5 + 680LL))(v5, gUSBDeviceSubClass);
    v101 = v47;
    LODWORD(v48) = (*(int (__fastcall **)(void *, __int64))(*(_QWORD *)v5 + 680LL))(v5, gUSBDeviceProtocol);
    v5 = v48;
    LODWORD(v49) = (*(int (__fastcall **)(void *, __int64))(*(_QWORD *)v4 + 504LL))(v4, gUSBVendorID);
    v95 = v49;
    LODWORD(v50) = (*(int (__fastcall **)(void *, __int64))(*(_QWORD *)v4 + 504LL))(v4, gUSBProductID);
    v98 = v50;
    LODWORD(v51) = (*(int (__fastcall **)(void *, __int64))(*(_QWORD *)v4 + 504LL))(v4, gUSBDeviceReleaseNumber);
    v52 = v51;
    LODWORD(v53) = (*(int (__fastcall **)(void *, __int64))(*(_QWORD *)v4 + 504LL))(v4, gUSBDeviceClass);
    v54 = v53;
    LODWORD(v55) = (*(int (__fastcall **)(void *, __int64))(*(_QWORD *)v4 + 504LL))(v4, gUSBDeviceSubClass);
    v56 = v55;
    LODWORD(v57) = (*(int (__fastcall **)(void *, __int64))(*(_QWORD *)v4 + 504LL))(v4, gUSBDeviceProtocol);
    v93 = v57;
    LODWORD(v58) = (*(int (__fastcall **)(void *, __int64))(*(_QWORD *)v4 + 504LL))(v4, gUSBProductIDMask);
    v4 = v58;
    if ( !v108 || !v103 || !v104 || !v89 || !v101 || !v5 )
      goto LABEL_123;
    v91 = v52;
    v85 = v54;
    v86 = v56;
    v92 = v5;
    __bzero(&v122, 256LL);
    v59 = 0;
    v60 = (_BYTE *)(&stru_B8 + 72);
    snprintf(&v123, 0x100uLL, "\tMatched: ");
    if ( v116 )
    {
      v61 = (*(int (**)(void))(*(_QWORD *)v108 + 328LL))();
      snprintf(&v122, 0x100uLL, "idVendor (%d) ", (unsigned int)v61);
      v60 = &v122;
      strlcat(&v123, &v122, 0x100uLL);
      v59 = 1;
    }
    if ( v88 != 0 && v113 != 0 )
    {
      v62 = v121;
      v63 = "idProduct in array (%d) ";
      goto LABEL_79;
    }
    if ( v88 )
    {
      v62 = (unsigned int)(*(int (**)(void))(*(_QWORD *)v103 + 328LL))();
      v63 = "idProduct (%d) ";
LABEL_79:
      v5 = &v122;
      snprintf(&v122, 0x100uLL, v63, v62);
      v60 = &v122;
      strlcat(&v123, &v122, 0x100uLL);
      v59 = 1;
    }
    if ( (_BYTE)v115 && v4 )
    {
      if ( v98 )
      {
        v5 = (void *)(unsigned int)(*(int (**)(void))(*(_QWORD *)v98 + 328LL))();
      }
      else
      {
        if ( v88 == 0 || v113 == 0 )
          goto LABEL_87;
        v5 = (void *)v121;
      }
      v64 = (*(int (__fastcall **)(void *))(*(_QWORD *)v4 + 328LL))(v4);
      v4 = &v122;
      snprintf(&v122, 0x100uLL, "to (%d) with mask (0x%x), ", (unsigned int)v5, (unsigned int)v64);
      v60 = &v122;
      strlcat(&v123, &v122, 0x100uLL);
    }
LABEL_87:
    if ( v120 )
    {
      v65 = (*(int (__fastcall **)(int *, char *))(*(_QWORD *)v104 + 328LL))(v104, v60);
      snprintf(&v122, 0x100uLL, "bcdDevice (%d) ", (unsigned int)v65);
      v60 = &v122;
      strlcat(&v123, &v122, 0x100uLL);
      v59 = 1;
    }
    if ( v117 )
    {
      v66 = (*(int (__fastcall **)(char *, char *))(*(_QWORD *)v89 + 328LL))(v89, v60);
      snprintf(&v122, 0x100uLL, "bDeviceClass (%d) ", (unsigned int)v66);
      v60 = &v122;
      strlcat(&v123, &v122, 0x100uLL);
      v59 = 1;
    }
    if ( v119 )
    {
      v67 = (*(int (__fastcall **)(__int64, char *))(*(_QWORD *)v101 + 328LL))(v101, v60);
      snprintf(&v122, 0x100uLL, "bDeviceSubClass (%d) ", (unsigned int)v67);
      v60 = &v122;
      strlcat(&v123, &v122, 0x100uLL);
      v59 = 1;
    }
    if ( v118 )
    {
      v68 = (*(int (__fastcall **)(void *, char *))(*(_QWORD *)v92 + 328LL))(v92, v60);
      snprintf(&v122, 0x100uLL, "bDeviceProtocol (%d) ", (unsigned int)v68);
      strlcat(&v123, &v122, 0x100uLL);
      v69 = v114;
    }
    else
    {
      v70 = v59 == 0;
      v69 = v114;
      if ( v70 )
        strlcat(&v123, "no properties", 0x100uLL);
    }
    v71 = 0;
    snprintf(&v123, 0x100uLL, "\tDidn't Match: ");
    if ( v96 && v87 && v95 != 0 )
    {
      v5 = (void *)(unsigned int)(*(int (**)(void))(*(_QWORD *)v95 + 328LL))();
      v72 = (*(int (**)(void))(*(_QWORD *)v108 + 328LL))();
      snprintf(&v122, 0x100uLL, "idVendor (%d,%d) ", (unsigned int)v5, (unsigned int)v72);
      strlcat(&v123, &v122, 0x100uLL);
      v71 = 1;
    }
    if ( v99 && !v88 && v98 )
    {
      v73 = (*(int (**)(void))(*(_QWORD *)v98 + 328LL))();
      v74 = (*(int (**)(void))(*(_QWORD *)v103 + 328LL))();
      v5 = &v122;
      snprintf(&v122, 0x100uLL, "idProduct (%d,%d) ", (unsigned int)v73, (unsigned int)v74);
      strlcat(&v123, &v122, 0x100uLL);
      v71 = 1;
    }
    if ( v106 && v91 && !v120 )
    {
      v75 = (*(int (**)(void))(*(_QWORD *)v91 + 328LL))();
      v76 = (*(int (**)(void))(*(_QWORD *)v104 + 328LL))();
      v5 = &v122;
      snprintf(&v122, 0x100uLL, "bcdDevice (%d,%d) ", (unsigned int)v75, (unsigned int)v76);
      strlcat(&v123, &v122, 0x100uLL);
      v71 = 1;
    }
    if ( v112 && v85 && !v117 )
    {
      v77 = (*(int (**)(void))(*(_QWORD *)v85 + 328LL))();
      v78 = (*(int (**)(void))(*(_QWORD *)v89 + 328LL))();
      v5 = &v122;
      snprintf(&v122, 0x100uLL, "bDeviceClass (%d,%d) ", (unsigned int)v77, (unsigned int)v78);
      strlcat(&v123, &v122, 0x100uLL);
      v71 = 1;
    }
    if ( v111 && v86 && !v119 )
    {
      v79 = (*(int (**)(void))(*(_QWORD *)v86 + 328LL))();
      v80 = (*(int (**)(void))(*(_QWORD *)v101 + 328LL))();
      v5 = &v122;
      snprintf(&v122, 0x100uLL, "bDeviceSubClass (%d,%d) ", (unsigned int)v79, (unsigned int)v80);
      strlcat(&v123, &v122, 0x100uLL);
      v71 = 1;
    }
    if ( v69 && v93 && !v118 )
    {
      v81 = (*(int (**)(void))(*(_QWORD *)v93 + 328LL))();
      v82 = (*(int (**)(void))(*(_QWORD *)v92 + 328LL))();
      v5 = &v122;
      snprintf(&v122, 0x100uLL, "bDeviceProtocol (%d,%d) ", (unsigned int)v81, (unsigned int)v82);
      v83 = &v123;
      v84 = &v122;
LABEL_122:
      strlcat(v83, v84, 0x100uLL);
      goto LABEL_123;
    }
    if ( !v71 )
    {
      v84 = "nothing";
      v83 = &v123;
      goto LABEL_122;
    }
LABEL_123:
    v8 = v105;
    if ( v105 )
      (*(void (**)(void))(*(_QWORD *)v105 + 40LL))();
    v6 = off_3B0E0[0];
    result = (unsigned int)v110;
LABEL_126:
    if ( *(_QWORD *)v6 == v124 )
      return result;
LABEL_127:
    v89 = v8;
    v35 = v104;
    *v104 = 0;
    v39 = 0;
    v110 = 0;
    v36 = 0;
    v38 = v115;
  }
}
// B8: using guessed type section_64 stru_B8;
// 3B070: using guessed type _QWORD off_3B070[20];
// 3B078: using guessed type _QWORD off_3B078[19];
// 3B088: using guessed type _QWORD off_3B088[17];
// 3B0E0: using guessed type __int64 off_3B0E0[6];
// 3D260: using guessed type __int64 `vtable for'IOUSBNub[2];
// 49170: using guessed type int gKernelDebugLevel;
// 495D8: using guessed type __int64 gUSBVendorID;
// 495E0: using guessed type __int64 gUSBProductID;
// 495F8: using guessed type __int64 gUSBDeviceReleaseNumber;
// 49618: using guessed type __int64 gUSBProductIDMask;
// 49620: using guessed type __int64 gUSBDeviceClass;
// 49628: using guessed type __int64 gUSBDeviceSubClass;
// 49630: using guessed type __int64 gUSBDeviceProtocol;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);
// 7E138: using guessed type int __fastcall __bzero(_QWORD, _QWORD);

//----- (0000000000019EA0) ----------------------------------------------------
signed __int64 __fastcall IOUSBDevice::DeviceRequest(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rax@2
  __int64 v5; // r12@3
  __int64 v6; // r13@4
  int v7; // er14@5
  signed __int64 result; // rax@5

  v3 = a3;
  if ( !(unsigned __int8)IOService::isInactive((IOService *)a1)
    && (v4 = *(_QWORD *)(a1 + 232)) != 0
    && (v5 = *(_QWORD *)(v4 + 104)) != 0
    && (v6 = *(_QWORD *)(v4 + 80)) != 0 )
  {
    (*(void (__cdecl **)(__int64))(*(_QWORD *)a1 + 32LL))(a1);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v6 + 32LL))(v6);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v5 + 32LL))(v5);
    v7 = (*(int (__fastcall **)(__int64, __int64 (__fastcall *)(IOUSBDevice *__hidden, OSObject *, void *, void *, void *, void *), __int64, __int64, _QWORD, _QWORD))(*(_QWORD *)v5 + 456LL))(
           v5,
           IOUSBDevice::_DeviceRequest,
           a2,
           v3,
           0LL,
           0LL);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v5 + 40LL))(v5);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v6 + 40LL))(v6);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
    result = (unsigned int)v7;
  }
  else
  {
    result = 3758097088LL;
  }
  return result;
}

//----- (0000000000019F58) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::_DeviceRequest(IOUSBDevice *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  void *v6; // r15@1
  uintptr_t v7; // r14@1
  __int16 v8; // bx@1
  int v9; // er15@2
  void *v10; // rdx@5
  int v11; // er13@5
  __int64 v12; // rdi@6

  v6 = a3;
  v7 = OSMetaClassBase::safeMetaCast(this, (const OSMetaClassBase *)&IOUSBDevice::gMetaClass, (const OSMetaClass *)a3);
  v8 = *((_WORD *)a2 + 1);
  if ( (unsigned __int8)IOService::isInactive((IOService *)v7) )
  {
    v9 = -536870163;
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D0824u, v7, 0xFFFFFFFFE00002EDLL, *((_WORD *)a2 + 1), 1uLL, 0LL);
  }
  else
  {
    v10 = v6;
    v11 = (*((_BYTE *)a2 + 1) << 8) | *(_BYTE *)a2;
    v9 = -536870174;
    if ( v11 != 1280 )
    {
      v12 = *(_QWORD *)(v7 + 152);
      v9 = -536854431;
      if ( v12 )
      {
        v9 = (*(int (__fastcall **)(__int64, OSObject *, void *))(*(_QWORD *)v12 + 360LL))(v12, a2, v10);
        if ( !v9 && v11 == 2304 )
        {
          *(_BYTE *)(v7 + 224) = v8;
          v9 = 0;
        }
      }
    }
  }
  return (unsigned int)v9;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 49760: using guessed type _QWORD IOUSBDevice::gMetaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000001A052) ----------------------------------------------------
signed __int64 __fastcall IOUSBDevice::DeviceRequest(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rax@2
  __int64 v5; // r12@3
  __int64 v6; // r13@4
  int v7; // er14@5
  signed __int64 result; // rax@5

  v3 = a3;
  if ( !(unsigned __int8)IOService::isInactive((IOService *)a1)
    && (v4 = *(_QWORD *)(a1 + 232)) != 0
    && (v5 = *(_QWORD *)(v4 + 104)) != 0
    && (v6 = *(_QWORD *)(v4 + 80)) != 0 )
  {
    (*(void (__cdecl **)(__int64))(*(_QWORD *)a1 + 32LL))(a1);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v6 + 32LL))(v6);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v5 + 32LL))(v5);
    v7 = (*(int (__fastcall **)(__int64, __int64 (__fastcall *)(IOUSBDevice *__hidden, OSObject *, void *, void *, void *, void *), __int64, __int64, _QWORD, _QWORD))(*(_QWORD *)v5 + 456LL))(
           v5,
           IOUSBDevice::_DeviceRequestDesc,
           a2,
           v3,
           0LL,
           0LL);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v5 + 40LL))(v5);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v6 + 40LL))(v6);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
    result = (unsigned int)v7;
  }
  else
  {
    result = 3758097088LL;
  }
  return result;
}

//----- (000000000001A10A) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::_DeviceRequestDesc(IOUSBDevice *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  void *v6; // r15@1
  uintptr_t v7; // r14@1
  __int16 v8; // bx@1
  int v9; // er15@2
  void *v10; // rdx@5
  int v11; // er13@5
  __int64 v12; // rdi@6

  v6 = a3;
  v7 = OSMetaClassBase::safeMetaCast(this, (const OSMetaClassBase *)&IOUSBDevice::gMetaClass, (const OSMetaClass *)a3);
  v8 = *((_WORD *)a2 + 1);
  if ( (unsigned __int8)IOService::isInactive((IOService *)v7) )
  {
    v9 = -536870163;
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D0824u, v7, 0xFFFFFFFFE00002EDLL, *((_WORD *)a2 + 1), 2uLL, 0LL);
  }
  else
  {
    v10 = v6;
    v11 = (*((_BYTE *)a2 + 1) << 8) | *(_BYTE *)a2;
    v9 = -536870174;
    if ( v11 != 1280 )
    {
      v12 = *(_QWORD *)(v7 + 152);
      v9 = -536854431;
      if ( v12 )
      {
        v9 = (*(int (__fastcall **)(__int64, OSObject *, void *))(*(_QWORD *)v12 + 352LL))(v12, a2, v10);
        if ( !v9 && v11 == 2304 )
        {
          *(_BYTE *)(v7 + 224) = v8;
          v9 = 0;
        }
      }
    }
  }
  return (unsigned int)v9;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 49760: using guessed type _QWORD IOUSBDevice::gMetaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000001A204) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::GetConfiguration(IOUSBDevice *this, unsigned __int8 *a2)
{
  __int64 v2; // rax@2
  __int64 v3; // r15@3
  __int64 v4; // r12@4
  int v5; // er14@5
  __int64 result; // rax@5

  if ( !(unsigned __int8)IOService::isInactive(this)
    && (v2 = *((_QWORD *)this + 29)) != 0
    && (v3 = *(_QWORD *)(v2 + 104)) != 0
    && (v4 = *(_QWORD *)(v2 + 80)) != 0 )
  {
    (*(void (**)(void))(*(_QWORD *)this + 32LL))();
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v4 + 32LL))(v4);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 32LL))(v3);
    v5 = (*(int (__fastcall **)(__int64, __int64 (__fastcall *)(IOUSBDevice *__hidden, OSObject *, void *, void *, void *, void *), unsigned __int8 *, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v3 + 456LL))(
           v3,
           IOUSBDevice::_GetConfiguration,
           a2,
           0LL,
           0LL,
           0LL);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 40LL))(v3);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v4 + 40LL))(v4);
    (*(void (__fastcall **)(IOUSBDevice *))(*(_QWORD *)this + 40LL))(this);
    result = (unsigned int)v5;
  }
  else
  {
    result = 3758097088LL;
  }
  return result;
}

//----- (000000000001A2A8) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::_GetConfiguration(IOUSBDevice *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  uintptr_t v6; // rbx@1
  signed int v7; // er14@2
  int v8; // er15@5
  unsigned __int8 v10; // [sp+0h] [bp-30h]@5
  char v11; // [sp+1h] [bp-2Fh]@5
  __int16 v12; // [sp+2h] [bp-2Eh]@5
  __int16 v13; // [sp+4h] [bp-2Ch]@5
  __int16 v14; // [sp+6h] [bp-2Ah]@5
  OSObject *v15; // [sp+8h] [bp-28h]@5

  v6 = OSMetaClassBase::safeMetaCast(this, (const OSMetaClassBase *)&IOUSBDevice::gMetaClass, (const OSMetaClass *)a3);
  if ( (unsigned __int8)IOService::isInactive((IOService *)v6) )
  {
    v7 = -536870163;
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D0828u, v6, 0xFFFFFFFFE00002EDLL, 0LL, 1uLL, 0LL);
  }
  else
  {
    v10 = -128;
    v11 = 8;
    v12 = 0;
    v13 = 0;
    v14 = 1;
    v15 = a2;
    v7 = 0;
    v8 = (*(int (__fastcall **)(uintptr_t, char *, signed __int64, _QWORD, _QWORD))(*(_QWORD *)v6 + 2424LL))(
           v6,
           &v10,
           5000LL,
           0LL,
           0LL);
    if ( v8 )
    {
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D0828u, v6, v8, v10, 0LL, 0LL);
      v7 = v8;
    }
  }
  return (unsigned int)v7;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 49760: using guessed type _QWORD IOUSBDevice::gMetaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000001A3A6) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::GetDeviceStatus(IOUSBDevice *this, unsigned __int16 *a2)
{
  __int64 v2; // rax@2
  __int64 v3; // r15@3
  __int64 v4; // r12@4
  int v5; // er14@5
  __int64 result; // rax@5

  if ( !(unsigned __int8)IOService::isInactive(this)
    && (v2 = *((_QWORD *)this + 29)) != 0
    && (v3 = *(_QWORD *)(v2 + 104)) != 0
    && (v4 = *(_QWORD *)(v2 + 80)) != 0 )
  {
    (*(void (**)(void))(*(_QWORD *)this + 32LL))();
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v4 + 32LL))(v4);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 32LL))(v3);
    v5 = (*(int (__fastcall **)(__int64, __int64 (__fastcall *)(IOUSBDevice *__hidden, OSObject *, void *, void *, void *, void *), unsigned __int16 *, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v3 + 456LL))(
           v3,
           IOUSBDevice::_GetDeviceStatus,
           a2,
           0LL,
           0LL,
           0LL);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 40LL))(v3);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v4 + 40LL))(v4);
    (*(void (__fastcall **)(IOUSBDevice *))(*(_QWORD *)this + 40LL))(this);
    result = (unsigned int)v5;
  }
  else
  {
    result = 3758097088LL;
  }
  return result;
}

//----- (000000000001A44A) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::_GetDeviceStatus(IOUSBDevice *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  uintptr_t v6; // rbx@1
  signed int v7; // er14@2
  int v8; // er15@5
  unsigned __int8 v10; // [sp+0h] [bp-30h]@5
  char v11; // [sp+1h] [bp-2Fh]@5
  __int16 v12; // [sp+2h] [bp-2Eh]@5
  __int16 v13; // [sp+4h] [bp-2Ch]@5
  __int16 v14; // [sp+6h] [bp-2Ah]@5
  OSObject *v15; // [sp+8h] [bp-28h]@5

  v6 = OSMetaClassBase::safeMetaCast(this, (const OSMetaClassBase *)&IOUSBDevice::gMetaClass, (const OSMetaClass *)a3);
  if ( (unsigned __int8)IOService::isInactive((IOService *)v6) )
  {
    v7 = -536870163;
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D082Cu, v6, 0xFFFFFFFFE00002EDLL, 0LL, 1uLL, 0LL);
  }
  else
  {
    v10 = -128;
    v11 = 0;
    v12 = 0;
    v13 = 0;
    v14 = 2;
    v15 = a2;
    v7 = 0;
    v8 = (*(int (__fastcall **)(uintptr_t, char *, signed __int64, _QWORD, _QWORD))(*(_QWORD *)v6 + 2424LL))(
           v6,
           &v10,
           5000LL,
           0LL,
           0LL);
    if ( v8 )
    {
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D082Cu, v6, v8, v10, 0LL, 0LL);
      v7 = v8;
    }
  }
  return (unsigned int)v7;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 49760: using guessed type _QWORD IOUSBDevice::gMetaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000001A548) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::GetStringDescriptor(IOUSBDevice *this, unsigned __int8 a2, char *a3, signed int a4, __int16 a5)
{
  __int16 v5; // r15@1
  __int64 v6; // rdx@1
  int v7; // er13@1
  __int64 v8; // r13@2
  __int16 *v9; // r14@2
  int v10; // eax@2
  int v11; // eax@5
  unsigned __int8 v12; // al@7
  __int64 v13; // rbx@9
  unsigned __int8 v14; // al@13
  unsigned __int8 *v15; // r15@16
  __int64 v16; // rbx@16
  int v17; // er14@16
  unsigned int v18; // eax@17
  __int64 v19; // r12@19
  __int64 result; // rax@21
  int v21; // [sp+8h] [bp-168h]@16
  signed int v22; // [sp+Ch] [bp-164h]@1
  int v23; // [sp+Ch] [bp-164h]@16
  char *v24; // [sp+10h] [bp-160h]@1
  unsigned __int16 *v25; // [sp+18h] [bp-158h]@15
  unsigned __int8 v26; // [sp+20h] [bp-150h]@16
  int v27; // [sp+24h] [bp-14Ch]@15
  char v28; // [sp+28h] [bp-148h]@2
  char v29; // [sp+29h] [bp-147h]@2
  __int16 v30; // [sp+2Ah] [bp-146h]@2
  __int16 v31; // [sp+2Ch] [bp-144h]@2
  __int16 v32; // [sp+2Eh] [bp-142h]@2
  __int16 *v33; // [sp+30h] [bp-140h]@2
  int v34; // [sp+38h] [bp-138h]@2
  __int16 v35; // [sp+40h] [bp-130h]@2
  __int16 v36[127]; // [sp+42h] [bp-12Eh]@15
  __int64 v37; // [sp+140h] [bp-30h]@1

  v5 = a5;
  v22 = a4;
  v24 = a3;
  v6 = off_3B0E0[0];
  v37 = *(_QWORD *)off_3B0E0[0];
  v7 = -536870206;
  if ( a4 >= 6 )
  {
    if ( (v8 = off_3B0E0[0],
          bzero(v24, a4),
          v28 = -128,
          v29 = 6,
          v30 = a2 | 0x300,
          v31 = v5,
          v32 = 2,
          v9 = &v35,
          bzero(&v35, 2uLL),
          v33 = &v35,
          v34 = 0,
          v10 = (*(int (__fastcall **)(IOUSBDevice *, char *, signed __int64, _QWORD, _QWORD))(*(_QWORD *)this + 2424LL))(
                  this,
                  &v28,
                  5000LL,
                  0LL,
                  0LL),
          v6 = v8,
          !v10)
      || v10 == -536870168 && HIBYTE(v35) == 3
      || (v28 = -128,
          v29 = 6,
          v30 = a2 | 0x300,
          v31 = v5,
          v32 = 256,
          bzero(&v35, 0x100uLL),
          v33 = &v35,
          v34 = 0,
          v11 = (*(int (__fastcall **)(IOUSBDevice *, char *, signed __int64, _QWORD, _QWORD))(*(_QWORD *)this + 2424LL))(
                  this,
                  &v28,
                  5000LL,
                  0LL,
                  0LL),
          v6 = v8,
          v9 = &v35,
          v7 = v11,
          v11 == -536870169)
      || !v11 )
    {
      v28 = -128;
      v29 = 6;
      v30 = a2 | 0x300;
      v31 = v5;
      v12 = v35;
      v7 = 0;
      if ( (_BYTE)v35 )
      {
        v7 = -536870167;
        if ( (unsigned __int16)(v35 & 0xFF00) == 768 )
        {
          v13 = v6;
          if ( v35 & 1 )
            LOBYTE(v35) = v35 & 0xFE;
          v32 = v12;
          bzero(v9, v12);
          v33 = v9;
          v34 = 0;
          v7 = (*(int (__fastcall **)(IOUSBDevice *, char *, signed __int64, _QWORD, _QWORD))(*(_QWORD *)this + 2424LL))(
                 this,
                 &v28,
                 5000LL,
                 0LL,
                 0LL);
          v6 = v13;
          if ( !v7 )
          {
            v7 = -536870167;
            if ( HIBYTE(v35) == 3 )
            {
              v14 = v35;
              if ( v35 & 1 )
              {
                v14 = v35 & 0xFE;
                LOBYTE(v35) = v35 & 0xFE;
              }
              v27 = v14 - 2;
              v25 = (unsigned __int16 *)v36;
              IOUSBDevice::TrimStringDescriptor(this, &v25, &v27);
              v7 = 0;
              v6 = v13;
              if ( v27 >= 2 )
              {
                v23 = v22 - 1;
                v21 = v27 / 2;
                v7 = 0;
                v15 = &v26;
                v16 = 0LL;
                v17 = 0;
                do
                {
                  v18 = IOUSBDevice::SimpleUnicodeToUTF8(this, (unsigned __int16)v36[v16], v15);
                  if ( !v18 )
                    break;
                  v17 += v18;
                  if ( v17 > v23 )
                    break;
                  v19 = v18;
                  this = (IOUSBDevice *)v15;
                  bcopy(v15, v24, v18);
                  v24 += v19;
                  v15 = &v26;
                  ++v16;
                }
                while ( (signed int)v16 < v21 );
                v6 = off_3B0E0[0];
              }
            }
          }
        }
      }
    }
  }
  result = *(_QWORD *)v6;
  if ( *(_QWORD *)v6 == v37 )
    result = (unsigned int)v7;
  return result;
}
// 3B0E0: using guessed type __int64 off_3B0E0[6];
// 1A548: using guessed type __int16 var_12E[127];

//----- (000000000001A876) ----------------------------------------------------
unsigned __int64 __fastcall IOUSBDevice::SwapUniWords(IOUSBDevice *this, unsigned __int16 **a2, unsigned int a3)
{
  unsigned __int64 result; // rax@1
  unsigned __int64 v4; // rcx@1

  result = (unsigned __int64)*a2;
  v4 = (unsigned __int64)&(*a2)[a3 >> 1];
  do
    v4 -= 2LL;
  while ( v4 >= result );
  return result;
}

//----- (000000000001A892) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::TrimStringDescriptor(IOUSBDevice *this, unsigned __int16 **a2, int *a3)
{
  size_t *v3; // r15@1
  void **v4; // r14@1
  __int64 v5; // r12@1
  __int64 v6; // rbx@2
  __int64 v7; // rax@2
  unsigned __int16 *v8; // rcx@3
  unsigned __int16 *v9; // r8@3
  char v10; // si@3
  __int16 v11; // di@4
  char *v12; // rsi@9
  signed int v13; // ecx@9
  signed int v14; // edx@10
  unsigned int v15; // edi@11
  signed int v16; // edx@13
  char v18[2]; // [sp+0h] [bp-132h]@9
  __int16 v19[132]; // [sp+2h] [bp-130h]@2
  __int64 v20; // [sp+10Ah] [bp-28h]@1

  v3 = (size_t *)a3;
  v4 = (void **)a2;
  v5 = off_3B0E0[0];
  v20 = *(_QWORD *)off_3B0E0[0];
  if ( *a3 <= 255 )
  {
    v6 = (__int64)v19;
    bzero(v19, 0x100uLL);
    LODWORD(v7) = 0;
    if ( *(_DWORD *)v3 >= 2 )
    {
      v8 = *a2;
      v9 = &(*a2)[*(_DWORD *)v3 / 2 - 1];
      v10 = 0;
      LODWORD(v7) = 0;
      do
      {
        v11 = *v8;
        if ( v10 & 1 || (unsigned __int16)v11 != 65279 && (unsigned __int16)v11 >= 0x21u )
        {
          v7 = (signed int)v7;
          v19[v7] = v11;
          LODWORD(v7) = v7 + 1;
          v10 = 1;
        }
        ++v8;
      }
      while ( v8 <= v9 );
    }
    v12 = &v18[2 * (signed int)v7];
    v13 = 2 * v7 + 2;
    while ( 1 )
    {
      v14 = 0;
      if ( (signed int)v7 <= 0 )
        break;
      LODWORD(v7) = v7 - 1;
      v15 = *(_WORD *)v12;
      v12 -= 2;
      v13 -= 2;
      if ( v15 >= 0x21 )
      {
        if ( (signed int)v7 + 1 > 0 )
        {
          v16 = -1;
          do
          {
            if ( (unsigned int)*(_WORD *)v6 <= 0x1F )
              *(_WORD *)v6 = 32;
            ++v16;
            v6 += 2LL;
          }
          while ( v16 < (signed int)v7 );
          v14 = 2;
          if ( (signed int)v7 > 0 )
            v14 = v13;
        }
        break;
      }
    }
    *(_DWORD *)v3 = v14;
    bzero(*v4, v14);
    bcopy(v19, *v4, *(_DWORD *)v3);
  }
  return *(_QWORD *)v5;
}
// 3B0E0: using guessed type __int64 off_3B0E0[6];
// 1A892: using guessed type __int16 var_130[132];
// 1A892: using guessed type char var_132[2];

//----- (000000000001A9C0) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::SimpleUnicodeToUTF8(IOUSBDevice *this, unsigned int a2, unsigned __int8 *a3)
{
  __int64 result; // rax@1
  char v4; // r8@3
  unsigned __int8 *v5; // rdi@3
  unsigned __int8 *v6; // rdi@4

  result = 0LL;
  if ( (_WORD)a2 )
  {
    if ( (unsigned __int16)a2 > 0x7Fu )
    {
      result = ((unsigned __int16)a2 > 0x7FFu) | 2u;
      v6 = &a3[result];
      v4 = -64;
      if ( (unsigned __int16)a2 >= 0x800u )
        v4 = -32;
      if ( (unsigned __int16)a2 >= 0x800u )
      {
        v6 = &a3[result - 1];
        *v6 = a2 & 0x3F | 0x80;
        a2 = (a2 & 0xFFC0) >> 6;
      }
      *(v6 - 1) = a2 & 0x3F | 0x80;
      v5 = v6 - 1;
      LOBYTE(a2) = (a2 & 0xFFC0) >> 6;
    }
    else
    {
      result = 1LL;
      v4 = 0;
      v5 = a3 + 1;
    }
    *(v5 - 1) = v4 | a2;
  }
  return result;
}

//----- (000000000001AA48) ----------------------------------------------------
int __fastcall IOUSBDevice::DisplayNotEnoughPowerNotice(IOUSBDevice *this)
{
  return (*(int (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)this + 2456LL))(this, 1LL);
}

//----- (000000000001AA5E) ----------------------------------------------------
int __usercall IOUSBDevice::DisplayUserNotificationForDevice@<eax>(IOUSBDevice *this@<rdi>, __int64 a2@<rax>, unsigned __int8 a3@<dl>, int a4@<esi>)
{
  IOUSBDevice *v4; // rbx@1
  __int64 v5; // rax@1
  __int64 v6; // rax@2
  __int64 v7; // rdx@2
  __int64 v8; // rdi@3
  __int64 v9; // rdx@4
  __int64 v10; // rdi@4
  __int64 v11; // rax@4
  signed __int64 v12; // rdx@4
  signed __int64 v13; // rsi@4
  int v14; // eax@5
  char v15; // cl@5
  unsigned int v16; // er14@7
  __int64 v17; // rax@7
  __int64 v18; // rsi@7
  __int64 v19; // rdi@8
  __int64 v20; // rax@10
  __int64 v21; // rdx@10
  __int64 v22; // rdi@11
  __int64 v23; // rdx@12
  __int64 v24; // rdi@15
  int v25; // er15@17
  char *v26; // r14@17
  __int64 v27; // rax@17
  __int64 v28; // rdi@18
  __int64 v29; // rdx@20
  __int64 v30; // rdi@21
  __int64 v31; // rdx@22
  __int64 v32; // rax@23
  __int64 v33; // rax@25
  signed __int64 v34; // rdx@25
  signed __int64 v35; // rsi@25
  __int64 v36; // rdi@32
  __int64 v38; // [sp-4h] [bp-20h]@1

  v38 = a2;
  v4 = this;
  v5 = (__int64)off_1ADE4;
  switch ( a4 )
  {
    case 1:
      LODWORD(v6) = (*(int (__fastcall **)(IOUSBDevice *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
      LODWORD(v5) = IOLog(
                      "USB Notification:  The device \"%s\" @ 0x%x cannot operate because there is not enough power available\n",
                      v6,
                      *(_DWORD *)(*((_QWORD *)this + 29) + 172LL),
                      v6);
      v7 = *((_QWORD *)this + 29);
      if ( v7 )
      {
        v8 = *(_QWORD *)(v7 + 16);
        if ( v8 )
        {
          (*(void (__cdecl **)(__int64))(*(_QWORD *)v8 + 32LL))(v8);
          v9 = *((_QWORD *)v4 + 29);
          v10 = *(_QWORD *)(v9 + 16);
          v11 = *(_QWORD *)v10;
          v12 = v9 + 172;
          v13 = 3758112788LL;
          goto LABEL_23;
        }
        v33 = *(_QWORD *)v4;
        v34 = v7 + 172;
        v35 = 3758112788LL;
        goto LABEL_37;
      }
      return v5;
    case 2:
      v14 = *(_DWORD *)(*((_QWORD *)this + 29) + 172LL);
      v15 = 24;
      do
        v15 -= 4;
      while ( v14 & (15 << v15) );
      v16 = a3;
      HIDWORD(v38) = (a3 << v15) | v14;
      LODWORD(v17) = (*(int (__fastcall **)(IOUSBDevice *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
      v18 = v17;
      IOLog(
        "USB Notification:  The hub \"%s\" @ 0x%x has reported an overcurrent condition.  Port %d has been disabled (0x%x).\n",
        v17,
        *(_DWORD *)(*((_QWORD *)this + 29) + 172LL),
        v16);
      v5 = *((_QWORD *)this + 29);
      if ( v5 )
      {
        v19 = *(_QWORD *)(v5 + 16);
        if ( v19 )
        {
          (*(void (__fastcall **)(__int64, __int64))(*(_QWORD *)v19 + 32LL))(v19, v18);
          v10 = *(_QWORD *)(*((_QWORD *)v4 + 29) + 16LL);
          v11 = *(_QWORD *)v10;
          v12 = (signed __int64)((char *)&v38 + 4);
          goto LABEL_13;
        }
        v33 = *(_QWORD *)v4;
        v34 = (signed __int64)((char *)&v38 + 4);
        goto LABEL_28;
      }
      return v5;
    case 3:
      LODWORD(v20) = (*(int (__fastcall **)(IOUSBDevice *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
      LODWORD(v5) = IOLog(
                      "USB Notification:  The device \"%s\" @ 0x%x has reported an overcurrent condition.  The port has been disabled.\n",
                      v20,
                      *(_DWORD *)(*((_QWORD *)this + 29) + 172LL),
                      v20);
      v21 = *((_QWORD *)this + 29);
      if ( v21 )
      {
        v22 = *(_QWORD *)(v21 + 16);
        if ( v22 )
        {
          (*(void (__cdecl **)(__int64))(*(_QWORD *)v22 + 32LL))(v22);
          v23 = *((_QWORD *)v4 + 29);
          v10 = *(_QWORD *)(v23 + 16);
          v11 = *(_QWORD *)v10;
          v12 = v23 + 172;
LABEL_13:
          v13 = 3758112787LL;
          goto LABEL_23;
        }
        v33 = *(_QWORD *)v4;
        v34 = v21 + 172;
LABEL_28:
        v35 = 3758112787LL;
        goto LABEL_37;
      }
      return v5;
    case 6:
      HIDWORD(v38) = a3;
      v5 = *((_QWORD *)this + 29);
      if ( v5 )
      {
        v24 = *(_QWORD *)(v5 + 16);
        if ( v24 )
        {
          (*(void (__cdecl **)(__int64))(*(_QWORD *)v24 + 32LL))(v24);
          v10 = *(_QWORD *)(*((_QWORD *)v4 + 29) + 16LL);
          v11 = *(_QWORD *)v10;
          v12 = (signed __int64)((char *)&v38 + 4);
          v13 = 3758112794LL;
          goto LABEL_23;
        }
        v33 = *(_QWORD *)v4;
        v34 = (signed __int64)((char *)&v38 + 4);
        v35 = 3758112794LL;
        goto LABEL_37;
      }
      return v5;
    case 7:
      v25 = a3;
      HIDWORD(v38) = a3;
      v26 = (char *)this + 232;
      v27 = *((_QWORD *)this + 29);
      if ( v27 )
      {
        v28 = *(_QWORD *)(v27 + 16);
        if ( v28 )
        {
          (*(void (__cdecl **)(__int64))(*(_QWORD *)v28 + 32LL))(v28);
          (*(void (__fastcall **)(_QWORD, signed __int64, char *, signed __int64))(**(_QWORD **)(*(_QWORD *)v26 + 16LL)
                                                                                 + 1856LL))(
            *(_QWORD *)(*(_QWORD *)v26 + 16LL),
            3758112793LL,
            (char *)&v38 + 4,
            4LL);
          (*(void (__cdecl **)(_QWORD))(**(_QWORD **)(*(_QWORD *)v26 + 16LL) + 40LL))(*(_QWORD *)(*(_QWORD *)v26 + 16LL));
        }
        else
        {
          (*(void (__fastcall **)(IOUSBDevice *, signed __int64, char *, signed __int64))(*(_QWORD *)v4 + 1856LL))(
            v4,
            3758112793LL,
            (char *)&v38 + 4,
            4LL);
        }
      }
      goto LABEL_31;
    case 8:
      v29 = *((_QWORD *)this + 29);
      if ( !v29 )
        return v5;
      v30 = *(_QWORD *)(v29 + 16);
      if ( !v30 )
      {
        v33 = *(_QWORD *)v4;
        v34 = v29 + 172;
        v35 = 3758112796LL;
        goto LABEL_37;
      }
      (*(void (__cdecl **)(__int64))(*(_QWORD *)v30 + 32LL))(v30);
      v31 = *((_QWORD *)v4 + 29);
      v10 = *(_QWORD *)(v31 + 16);
      v11 = *(_QWORD *)v10;
      v12 = v31 + 172;
      v13 = 3758112796LL;
LABEL_23:
      (*(void (__fastcall **)(__int64, signed __int64, signed __int64, signed __int64))(v11 + 1856))(v10, v13, v12, 4LL);
      v32 = *((_QWORD *)v4 + 29);
      goto LABEL_34;
    case 9:
      v25 = a3;
      v26 = (char *)this + 232;
LABEL_31:
      HIDWORD(v38) = v25;
      v5 = *(_QWORD *)v26;
      if ( !*(_QWORD *)v26 )
        return v5;
      v36 = *(_QWORD *)(v5 + 16);
      if ( v36 )
      {
        (*(void (__cdecl **)(__int64))(*(_QWORD *)v36 + 32LL))(v36);
        (*(void (__fastcall **)(_QWORD, signed __int64, char *, signed __int64))(**(_QWORD **)(*(_QWORD *)v26 + 16LL)
                                                                               + 1856LL))(
          *(_QWORD *)(*(_QWORD *)v26 + 16LL),
          3758112797LL,
          (char *)&v38 + 4,
          4LL);
        v32 = *(_QWORD *)v26;
LABEL_34:
        LODWORD(v5) = (*(int (__cdecl **)(_QWORD))(**(_QWORD **)(v32 + 16) + 40LL))(*(_QWORD *)(v32 + 16));
      }
      else
      {
        v33 = *(_QWORD *)v4;
        v34 = (signed __int64)((char *)&v38 + 4);
        v35 = 3758112797LL;
LABEL_37:
        LODWORD(v5) = (*(int (__fastcall **)(IOUSBDevice *, signed __int64, signed __int64, signed __int64))(v33 + 1856))(
                        v4,
                        v35,
                        v34,
                        4LL);
      }
      return v5;
    default:
      return v5;
  }
}
// 1ADE4: using guessed type void *__ptr32 off_1ADE4[9];
// 7D240: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001AE08) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::ChangeGetConfigLock(IOUSBDevice *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  uintptr_t v6; // r12@1
  signed int v7; // er13@1
  __int64 v8; // rax@2
  __int64 v9; // r15@3
  __int64 v10; // r14@4
  __int64 v11; // rcx@5
  __int64 v12; // r8@5
  __int64 v13; // r9@5
  __int64 v14; // rax@6
  __int64 *v15; // r13@7
  int *v16; // r14@7
  int *v17; // r13@8
  int v18; // eax@11
  int *v19; // rdx@12
  __int64 v20; // rsi@23
  uintptr_t v21; // rdx@27
  uintptr_t v22; // r8@27
  __int64 v24; // [sp+8h] [bp-38h]@6
  __int64 v25; // [sp+10h] [bp-30h]@7

  v6 = OSMetaClassBase::safeMetaCast(this, (const OSMetaClassBase *)&IOUSBDevice::gMetaClass, (const OSMetaClass *)a3);
  v7 = -536870208;
  if ( !(unsigned __int8)IOService::isInactive((IOService *)v6) )
  {
    v8 = *(_QWORD *)(v6 + 232);
    if ( v8 )
    {
      v9 = *(_QWORD *)(v8 + 104);
      if ( v9 )
      {
        v10 = *(_QWORD *)(v8 + 80);
        if ( v10 )
        {
          (*(void (__fastcall **)(uintptr_t, _QWORD *))(*(_QWORD *)v6 + 32LL))(v6, &IOUSBDevice::gMetaClass);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v10 + 32LL))(v10);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v9 + 32LL))(v9);
          if ( a2 )
          {
            v24 = v10;
            v14 = *(_QWORD *)(v6 + 232);
            if ( *(_BYTE *)(v14 + 166) )
            {
              v15 = &v25;
              v16 = &gUSBStackDebugFlags;
              while ( 2 )
              {
                clock_interval_to_deadline(30LL, 1000000000LL, v15, v11, v12, v13);
                v17 = v16;
                if ( *(_BYTE *)v16 & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
                  kernel_debug(0x52D0838u, v6, 0LL, 0LL, 4uLL, 0LL);
                v18 = (*(int (__fastcall **)(__int64, signed __int64, __int64, signed __int64))(*(_QWORD *)v9 + 496LL))(
                        v9,
                        *(_QWORD *)(v6 + 232) + 166LL,
                        v25,
                        2LL);
                v10 = v24;
                if ( v18 < 0 )
                {
                  v19 = v17;
                  if ( v18 == -536870174 )
                  {
                    v7 = -536870174;
                    if ( !(*(_BYTE *)v19 & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
                      goto LABEL_35;
                    v21 = 0LL;
                    v22 = 9LL;
LABEL_31:
                    kernel_debug(0x52D0838u, v6, v21, 0LL, v22, 0LL);
LABEL_35:
                    (*(void (__fastcall **)(__int64))(*(_QWORD *)v9 + 40LL))(v9);
                    (*(void (__fastcall **)(__int64))(*(_QWORD *)v10 + 40LL))(v10);
                    (*(void (__fastcall **)(uintptr_t))(*(_QWORD *)v6 + 40LL))(v6);
                    return (unsigned int)v7;
                  }
                }
                else
                {
                  v11 = (unsigned int)v18;
                  v19 = v17;
                  switch ( v18 )
                  {
                    case 0:
                      if ( *(_BYTE *)v17 & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
                        kernel_debug(0x52D0838u, v6, *(_BYTE *)(*(_QWORD *)(v6 + 232) + 166LL), 0LL, 5uLL, 0LL);
                      v14 = *(_QWORD *)(v6 + 232);
                      v15 = &v25;
                      v16 = &gUSBStackDebugFlags;
                      if ( !*(_BYTE *)(v14 + 166) )
                        goto LABEL_17;
                      continue;
                    case 1:
                      v7 = -536870174;
                      if ( !(*(_BYTE *)v19 & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
                        goto LABEL_35;
                      v21 = *(_BYTE *)(*(_QWORD *)(v6 + 232) + 166LL);
                      v22 = 6LL;
                      goto LABEL_31;
                    case 2:
                      v7 = -536870174;
                      if ( !(*(_BYTE *)v19 & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
                        goto LABEL_35;
                      v21 = *(_BYTE *)(*(_QWORD *)(v6 + 232) + 166LL);
                      v22 = 7LL;
                      goto LABEL_31;
                    case 3:
                      v7 = -536870174;
                      if ( !(*(_BYTE *)v19 & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
                        goto LABEL_35;
                      v21 = *(_BYTE *)(*(_QWORD *)(v6 + 232) + 166LL);
                      v22 = 8LL;
                      goto LABEL_31;
                    default:
                      goto LABEL_28;
                  }
                }
                break;
              }
LABEL_28:
              v7 = -536870174;
              if ( !(*(_BYTE *)v19 & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
                goto LABEL_35;
              v21 = 0LL;
              v22 = 10LL;
              goto LABEL_31;
            }
LABEL_17:
            if ( gUSBStackDebugFlags & 2 )
            {
              v10 = v24;
              if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
              {
                kernel_debug(0x52D0838u, v6, 0LL, 0LL, 0xDuLL, 0LL);
                v14 = *(_QWORD *)(v6 + 232);
              }
            }
            else
            {
              v10 = v24;
            }
            *(_BYTE *)(v14 + 166) = 1;
          }
          else
          {
            if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
              kernel_debug(0x52D0838u, v6, 0LL, 0LL, 0xBuLL, 0LL);
            v20 = *(_QWORD *)(v6 + 232);
            *(_BYTE *)(v20 + 166) = 0;
            (*(void (__fastcall **)(__int64, signed __int64, signed __int64))(*(_QWORD *)v9 + 488LL))(
              v9,
              v20 + 166,
              1LL);
          }
          v7 = 0;
          goto LABEL_35;
        }
      }
    }
  }
  return (unsigned int)v7;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 49760: using guessed type _QWORD IOUSBDevice::gMetaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);
// 7E178: using guessed type int __fastcall clock_interval_to_deadline(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001B1C4) ----------------------------------------------------
signed __int64 __fastcall IOUSBDevice::DeviceRequest(__int64 a1, __int64 a2, unsigned int a3, unsigned int a4, __int64 a5)
{
  unsigned int v5; // er12@1
  unsigned int v6; // er14@1
  __int64 v7; // rax@2
  __int64 v8; // r13@3
  __int64 v9; // ST08_8@5
  int v10; // er14@5
  signed __int64 result; // rax@5
  __int64 v12; // [sp+10h] [bp-30h]@1

  v12 = a5;
  v5 = a4;
  v6 = a3;
  if ( !(unsigned __int8)IOService::isInactive((IOService *)a1)
    && (v7 = *(_QWORD *)(a1 + 232)) != 0
    && (v8 = *(_QWORD *)(v7 + 104)) != 0
    && *(_QWORD *)(v7 + 80) )
  {
    v9 = *(_QWORD *)(v7 + 80);
    (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
    (*(void (**)(void))(*(_QWORD *)v9 + 32LL))();
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v8 + 32LL))(v8);
    v10 = (*(int (__fastcall **)(__int64, __int64 (__fastcall *)(IOUSBDevice *__hidden, OSObject *, void *, void *, void *, void *), __int64, _QWORD, _QWORD, __int64))(*(_QWORD *)v8 + 456LL))(
            v8,
            IOUSBDevice::_DeviceRequestWithTimeout,
            a2,
            v6,
            v5,
            v12);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v8 + 40LL))(v8);
    (*(void (**)(void))(*(_QWORD *)v9 + 40LL))();
    (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
    result = (unsigned int)v10;
  }
  else
  {
    result = 3758097088LL;
  }
  return result;
}

//----- (000000000001B28C) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::_DeviceRequestWithTimeout(IOUSBDevice *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  void *v6; // r15@1
  void *v7; // r13@1
  uintptr_t v8; // r14@1
  __int16 v9; // bx@1
  int v10; // er15@2
  void *v11; // rcx@5
  void *v12; // r8@5
  int v13; // er13@5
  __int64 v14; // rdi@6
  void *v16; // [sp+10h] [bp-30h]@1

  v6 = a5;
  v7 = a4;
  v16 = a3;
  v8 = OSMetaClassBase::safeMetaCast(this, (const OSMetaClassBase *)&IOUSBDevice::gMetaClass, (const OSMetaClass *)a3);
  v9 = *((_WORD *)a2 + 1);
  if ( (unsigned __int8)IOService::isInactive((IOService *)v8) )
  {
    v10 = -536870163;
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D0824u, v8, 0xFFFFFFFFE00002EDLL, *((_WORD *)a2 + 1), 3uLL, 0LL);
  }
  else
  {
    v11 = v7;
    v12 = v6;
    v13 = (*((_BYTE *)a2 + 1) << 8) | *(_BYTE *)a2;
    v10 = -536870174;
    if ( v13 != 1280 )
    {
      v14 = *(_QWORD *)(v8 + 152);
      v10 = -536854431;
      if ( v14 )
      {
        v10 = (*(int (__fastcall **)(__int64, OSObject *, void *, void *, void *))(*(_QWORD *)v14 + 456LL))(
                v14,
                a2,
                v16,
                v11,
                v12);
        if ( !v10 && v13 == 2304 )
        {
          *(_BYTE *)(v8 + 224) = v9;
          v10 = 0;
        }
      }
    }
  }
  return (unsigned int)v10;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 49760: using guessed type _QWORD IOUSBDevice::gMetaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000001B396) ----------------------------------------------------
signed __int64 __fastcall IOUSBDevice::DeviceRequest(__int64 a1, __int64 a2, unsigned int a3, unsigned int a4, __int64 a5)
{
  unsigned int v5; // er12@1
  unsigned int v6; // er14@1
  __int64 v7; // rax@2
  __int64 v8; // r13@3
  __int64 v9; // ST08_8@5
  int v10; // er14@5
  signed __int64 result; // rax@5
  __int64 v12; // [sp+10h] [bp-30h]@1

  v12 = a5;
  v5 = a4;
  v6 = a3;
  if ( !(unsigned __int8)IOService::isInactive((IOService *)a1)
    && (v7 = *(_QWORD *)(a1 + 232)) != 0
    && (v8 = *(_QWORD *)(v7 + 104)) != 0
    && *(_QWORD *)(v7 + 80) )
  {
    v9 = *(_QWORD *)(v7 + 80);
    (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
    (*(void (**)(void))(*(_QWORD *)v9 + 32LL))();
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v8 + 32LL))(v8);
    v10 = (*(int (__fastcall **)(__int64, __int64 (__fastcall *)(IOUSBDevice *__hidden, OSObject *, void *, void *, void *, void *), __int64, _QWORD, _QWORD, __int64))(*(_QWORD *)v8 + 456LL))(
            v8,
            IOUSBDevice::_DeviceRequestDescWithTimeout,
            a2,
            v6,
            v5,
            v12);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v8 + 40LL))(v8);
    (*(void (**)(void))(*(_QWORD *)v9 + 40LL))();
    (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
    result = (unsigned int)v10;
  }
  else
  {
    result = 3758097088LL;
  }
  return result;
}

//----- (000000000001B45E) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::_DeviceRequestDescWithTimeout(IOUSBDevice *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  void *v6; // r15@1
  void *v7; // r13@1
  uintptr_t v8; // r14@1
  __int16 v9; // bx@1
  int v10; // er15@2
  void *v11; // rcx@5
  void *v12; // r8@5
  int v13; // er13@5
  __int64 v14; // rdi@6
  void *v16; // [sp+10h] [bp-30h]@1

  v6 = a5;
  v7 = a4;
  v16 = a3;
  v8 = OSMetaClassBase::safeMetaCast(this, (const OSMetaClassBase *)&IOUSBDevice::gMetaClass, (const OSMetaClass *)a3);
  v9 = *((_WORD *)a2 + 1);
  if ( (unsigned __int8)IOService::isInactive((IOService *)v8) )
  {
    v10 = -536870163;
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D0824u, v8, 0xFFFFFFFFE00002EDLL, *((_WORD *)a2 + 1), 4uLL, 0LL);
  }
  else
  {
    v11 = v7;
    v12 = v6;
    v13 = (*((_BYTE *)a2 + 1) << 8) | *(_BYTE *)a2;
    v10 = -536870174;
    if ( v13 != 1280 )
    {
      v14 = *(_QWORD *)(v8 + 152);
      v10 = -536854431;
      if ( v14 )
      {
        v10 = (*(int (__fastcall **)(__int64, OSObject *, void *, void *, void *))(*(_QWORD *)v14 + 448LL))(
                v14,
                a2,
                v16,
                v11,
                v12);
        if ( !v10 && v13 == 2304 )
        {
          *(_BYTE *)(v8 + 224) = v9;
          v10 = 0;
        }
      }
    }
  }
  return (unsigned int)v10;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 49760: using guessed type _QWORD IOUSBDevice::gMetaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000001B568) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::SuspendDevice(IOUSBDevice *this, uintptr_t a2)
{
  unsigned __int8 v2; // r15@1
  uintptr_t v3; // rbx@1
  int v4; // er14@2
  __int64 v5; // rax@4
  uintptr_t v6; // rdx@4
  uintptr_t v7; // rcx@4
  uintptr_t v8; // r8@4
  __int64 v9; // rax@6
  __int64 v10; // rdi@7
  __int64 v11; // rax@11
  uintptr_t v12; // rcx@14
  __int64 v13; // rax@15
  __int64 v14; // rdi@15
  int v15; // er13@19
  bool v16; // zf@20
  uintptr_t v17; // rax@21
  uintptr_t v18; // r15@21
  uintptr_t *v19; // rax@30
  uintptr_t v20; // rdx@30

  v2 = a2;
  v3 = (uintptr_t)this;
  if ( (unsigned __int8)IOService::isInactive(this) )
  {
    v4 = -536870208;
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      v5 = *((_QWORD *)this + 29);
      v6 = *(_DWORD *)v5;
      v7 = *(_DWORD *)(v5 + 172);
      v8 = 3LL;
LABEL_5:
      kernel_debug(0x52D0830u, v3, v6, v7, v8, 0LL);
      return (unsigned int)v4;
    }
    return (unsigned int)v4;
  }
  v9 = *((_QWORD *)this + 29);
  v4 = -536870208;
  if ( !v9 )
    return (unsigned int)v4;
  v10 = *(_QWORD *)(v9 + 80);
  if ( !v10 )
    return (unsigned int)v4;
  if ( !(unsigned __int8)(*(int (__cdecl **)(__int64))(*(_QWORD *)v10 + 304LL))(v10) )
  {
    (*(void (__fastcall **)(uintptr_t))(*(_QWORD *)v3 + 32LL))(v3);
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      v12 = (unsigned __int8)a2;
      a2 = v3;
      kernel_debug(0x52D0830u, v3, *(_DWORD *)(*(_QWORD *)(v3 + 232) + 172LL), v12, 4uLL, 0LL);
    }
    v13 = *(_QWORD *)(v3 + 232);
    v14 = *(_QWORD *)(v13 + 144);
    v4 = 0;
    if ( v14 )
    {
      a2 = *(_DWORD *)v13;
      v4 = (*(int (__fastcall **)(__int64, uintptr_t, _QWORD))(*(_QWORD *)v14 + 2168LL))(v14, a2, v2);
    }
    if ( (unsigned __int8)IOService::isInactive((IOService *)v3) )
      goto LABEL_29;
    if ( v2 )
    {
      v15 = 2 * (v4 != 0) - 536854515;
    }
    else
    {
      v16 = v4 == 0;
      v15 = -536854513;
      v4 = 0;
      if ( v16 )
      {
LABEL_29:
        if ( gUSBStackDebugFlags & 2 )
        {
          v19 = *(uintptr_t **)(v3 + 232);
          v20 = 255LL;
          if ( v19 )
            v20 = *(_DWORD *)v19;
          if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          {
            a2 = v3;
            kernel_debug(0x52D0830u, v3, v20, v4, 5uLL, 0LL);
          }
        }
        (*(void (__fastcall **)(uintptr_t, uintptr_t))(*(_QWORD *)v3 + 40LL))(v3, a2);
        return (unsigned int)v4;
      }
    }
    LODWORD(v17) = IOMalloc(8LL);
    v18 = v17;
    *(_DWORD *)v17 = v15;
    *(_DWORD *)(v17 + 4) = 0;
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      a2 = v3;
      kernel_debug(0x52D0830u, v3, **(_DWORD **)(v3 + 232), (unsigned int)v15, 6uLL, 0LL);
    }
    (*(void (__fastcall **)(uintptr_t, uintptr_t))(*(_QWORD *)v3 + 32LL))(v3, a2);
    a2 = v18;
    if ( thread_call_enter1(*(_QWORD *)(*(_QWORD *)(v3 + 232) + 136LL), v18) == 1 )
    {
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        a2 = v3;
        kernel_debug(0x52D0830u, v3, **(_DWORD **)(v3 + 232), 0LL, 7uLL, 0LL);
      }
      (*(void (__fastcall **)(uintptr_t, uintptr_t))(*(_QWORD *)v3 + 40LL))(v3, a2);
    }
    goto LABEL_29;
  }
  v4 = -536854454;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
  {
    v11 = *(_QWORD *)(v3 + 232);
    v6 = *(_DWORD *)v11;
    v7 = *(_DWORD *)(v11 + 172);
    v8 = 1LL;
    goto LABEL_5;
  }
  return (unsigned int)v4;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 7D250: using guessed type int __fastcall IOMalloc(_QWORD);
// 7E230: using guessed type int __fastcall thread_call_enter1(_QWORD, _QWORD);

//----- (000000000001B814) ----------------------------------------------------
void __fastcall IOUSBDevice::ProcessPortReEnumerate(uintptr_t arg1, unsigned int a2)
{
  uintptr_t v2; // r14@1
  __int64 v3; // rcx@1
  __int64 v4; // rdi@1
  int v5; // eax@2
  uintptr_t v6; // rcx@5
  uintptr_t v7; // rdx@5
  uintptr_t v8; // r8@5

  v2 = arg1;
  v3 = *(_QWORD *)(arg1 + 232);
  v4 = *(_QWORD *)(v3 + 144);
  if ( v4 )
  {
    v5 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD))(*(_QWORD *)v4 + 2176LL))(v4, *(_DWORD *)v3, a2);
    if ( v5 && gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      v6 = v5;
      v7 = *(_DWORD *)(*(_QWORD *)(v2 + 232) + 172LL);
      v8 = 5LL;
LABEL_9:
      kernel_debug(0x52D0834u, v2, v7, v6, v8, 0LL);
      return;
    }
  }
  else if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
  {
    v7 = *(_DWORD *)(v3 + 172);
    v6 = 0LL;
    v8 = 6LL;
    goto LABEL_9;
  }
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (000000000001B8BE) ----------------------------------------------------
int __fastcall IOUSBDevice::DisplayUserNotification(IOUSBDevice *this, unsigned int a2)
{
  return IOUSBDevice::DisplayUserNotificationForDevice(this, a2 >> 24, BYTE3(a2), a2 & 0xFFFFFF);
}

//----- (000000000001B8D6) ----------------------------------------------------
int __usercall IOUSBDevice::SetHubParent@<eax>(IOUSBDevice *this@<rdi>, IOUSBHubPolicyMaker *a2@<rsi>, __int64 a3@<rax>)
{
  __int64 v3; // rax@2
  __int64 v5; // [sp-4h] [bp-10h]@1

  v5 = a3;
  if ( a2 )
  {
    v3 = *((_QWORD *)this + 29);
    *(_QWORD *)(v3 + 144) = a2;
    *(_QWORD *)(v3 + 224) = a2;
    (*(void (__fastcall **)(IOUSBHubPolicyMaker *))(*(_QWORD *)a2 + 32LL))(a2);
    HIDWORD(v5) = 0;
    (*(void (__fastcall **)(IOUSBDevice *, char *))(*(_QWORD *)this + 2488LL))(this, (char *)&v5 + 4);
    LODWORD(a3) = WORD2(v5) & 0x2004;
    if ( (WORD2(v5) & 0x2004) == 4 )
      LODWORD(a3) = (*(int (__fastcall **)(IOUSBDevice *, _QWORD, _QWORD))(*(_QWORD *)this + 616LL))(
                      this,
                      "Built-In",
                      **(_QWORD **)off_3B0F8[0]);
  }
  return a3;
}
// 3B0F8: using guessed type __int64 off_3B0F8[3];

//----- (000000000001B94E) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::GetHubParent(IOUSBDevice *this)
{
  return *(_QWORD *)(*((_QWORD *)this + 29) + 144LL);
}

//----- (000000000001B962) ----------------------------------------------------
__int64 __usercall IOUSBDevice::GetDeviceInformation@<rax>(IOUSBDevice *this@<rdi>, unsigned int *a2@<rsi>, __int64 a3@<rax>)
{
  IOUSBDevice *v3; // rbx@1
  __int64 v4; // rax@1
  __int64 v5; // rdi@1
  int v6; // er15@2
  __int64 v7; // rax@2
  __int64 v8; // rax@4
  __int64 v9; // rdi@5
  __int64 v11; // [sp-4h] [bp-20h]@1

  v11 = a3;
  v3 = this;
  (*(void (__cdecl **)(IOUSBDevice *))(*(_QWORD *)this + 32LL))(this);
  v4 = *((_QWORD *)this + 29);
  v5 = *(_QWORD *)(v4 + 144);
  if ( v5 )
  {
    v6 = (*(int (__fastcall **)(__int64, _QWORD, unsigned int *))(*(_QWORD *)v5 + 2152LL))(v5, *(_DWORD *)v4, a2);
    LODWORD(v7) = (*(int (__fastcall **)(IOUSBDevice *, _QWORD))(*(_QWORD *)v3 + 696LL))(v3, "non-removable");
    if ( v7 )
      *(_BYTE *)a2 |= 1u;
    v8 = *((_QWORD *)v3 + 29);
    if ( !*(_BYTE *)(v8 + 165) )
    {
      *(_BYTE *)(v8 + 165) = 1;
      v9 = *(_QWORD *)(v8 + 16);
      if ( v9 )
      {
        HIDWORD(v11) = 0;
        (*(void (__cdecl **)(__int64))(*(_QWORD *)v9 + 32LL))(v9);
        if ( !(*(int (__fastcall **)(_QWORD, char *))(**(_QWORD **)(*((_QWORD *)v3 + 29) + 16LL) + 2488LL))(
                *(_QWORD *)(*((_QWORD *)v3 + 29) + 16LL),
                (char *)&v11 + 4)
          && *(_BYTE *)a2 & 1
          && BYTE4(v11) & 4 )
          *(_BYTE *)(*((_QWORD *)v3 + 29) + 164LL) = 1;
        (*(void (__cdecl **)(_QWORD))(**(_QWORD **)(*((_QWORD *)v3 + 29) + 16LL) + 40LL))(*(_QWORD *)(*((_QWORD *)v3 + 29) + 16LL));
        v8 = *((_QWORD *)v3 + 29);
      }
    }
    if ( *(_BYTE *)(v8 + 164) )
      *(_BYTE *)a2 |= 4u;
    if ( *(_BYTE *)(v8 + 209) )
      *((_BYTE *)a2 + 1) |= 0x20u;
  }
  else
  {
    *a2 = 0;
    v6 = -536870208;
  }
  (*(void (__fastcall **)(IOUSBDevice *))(*(_QWORD *)v3 + 40LL))(v3);
  return (unsigned int)v6;
}

//----- (000000000001BA78) ----------------------------------------------------
char __fastcall IOUSBDevice::IsDeviceInternal(IOUSBDevice *this)
{
  return *(_BYTE *)(*((_QWORD *)this + 29) + 164LL);
}

//----- (000000000001BA8C) ----------------------------------------------------
__int64 __usercall IOUSBDevice::RequestExtraPower@<rax>(IOUSBDevice *this@<rdi>, __int64 a2@<rax>, unsigned int a3@<edx>, unsigned int a4@<esi>)
{
  unsigned int v4; // er12@1
  IOUSBDevice *v5; // r14@1
  signed int v6; // eax@2
  __int64 v7; // rax@5
  signed __int64 v8; // rdi@9
  __int64 v9; // rax@12
  __int64 v10; // rdi@12
  int v11; // er15@12
  __int64 v12; // rax@16
  signed __int64 v13; // rdi@23
  __int64 v14; // rax@25
  __int64 v15; // rdx@25
  __int64 v16; // rax@30
  __int64 v18; // [sp-4h] [bp-30h]@1

  v18 = a2;
  v4 = a3;
  v5 = this;
  HIDWORD(v18) = 0;
  if ( a4 <= 7 )
  {
    v6 = 194;
    if ( _bittest((const unsigned int *)&v6, a4) )
    {
      (*(void (__fastcall **)(IOUSBDevice *, char *))(*(_QWORD *)this + 2488LL))(this, (char *)&v18 + 4);
      if ( BYTE5(v18) & 0x10 )
      {
        if ( v4 )
        {
          v7 = *((_QWORD *)this + 29);
          if ( !*(_DWORD *)(v7 + 156) && !*(_DWORD *)(v7 + 200) && a4 != 7 )
          {
            *(_BYTE *)(v7 + 208) = 1;
            if ( *(_BYTE *)(v7 + 209) )
              v8 = *(_QWORD *)(*(_QWORD *)(v7 + 216) + 672LL) + 332LL;
            else
              v8 = (signed __int64)&IOUSBController::gExternalNonSSPortsUsingExtraCurrent;
            OSIncrementAtomic(v8);
          }
        }
      }
    }
  }
  v9 = *((_QWORD *)v5 + 29);
  v10 = *(_QWORD *)(v9 + 144);
  v11 = 0;
  if ( v10 )
    v11 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v10 + 2184LL))(v10, *(_DWORD *)v9, a4, v4);
  if ( a4 - 6 >= 2 && a4 != 1 )
  {
    if ( !a4 )
    {
      v14 = *((_QWORD *)v5 + 29);
      v15 = (unsigned int)(v11 + *(_DWORD *)(v14 + 152));
      *(_DWORD *)(v14 + 152) = v15;
      (*(void (__fastcall **)(IOUSBDevice *, _QWORD, __int64, signed __int64))(*(_QWORD *)v5 + 640LL))(
        v5,
        "PortUsingExtraPowerForSleep",
        v15,
        32LL);
    }
  }
  else
  {
    v12 = *((_QWORD *)v5 + 29);
    if ( *(_BYTE *)(v12 + 208)
      && BYTE5(v18) & 0x10
      && !v11
      && !*(_DWORD *)(v12 + 156)
      && !*(_DWORD *)(v12 + 200)
      && a4 != 7 )
    {
      *(_BYTE *)(v12 + 208) = 0;
      if ( *(_BYTE *)(v12 + 209) )
        v13 = *(_QWORD *)(*(_QWORD *)(v12 + 216) + 672LL) + 332LL;
      else
        v13 = (signed __int64)&IOUSBController::gExternalNonSSPortsUsingExtraCurrent;
      OSDecrementAtomic(v13);
    }
    switch ( a4 )
    {
      case 1u:
        v16 = *((_QWORD *)v5 + 29);
        *(_DWORD *)(v16 + 156) += v11;
        break;
      case 6u:
        v16 = *((_QWORD *)v5 + 29);
        *(_DWORD *)(v16 + 200) += v11;
        break;
      case 7u:
        v16 = *((_QWORD *)v5 + 29);
        *(_DWORD *)(v16 + 204) += v11;
        break;
      default:
        v16 = *((_QWORD *)v5 + 29);
        break;
    }
    (*(void (__fastcall **)(IOUSBDevice *, _QWORD, _QWORD, signed __int64))(*(_QWORD *)v5 + 640LL))(
      v5,
      "PortUsingExtraPowerForWake",
      (unsigned int)(*(_DWORD *)(v16 + 204) + *(_DWORD *)(v16 + 156) + *(_DWORD *)(v16 + 200)),
      32LL);
  }
  return (unsigned int)v11;
}
// 49584: using guessed type _QWORD IOUSBController::gExternalNonSSPortsUsingExtraCurrent;
// 7D290: using guessed type int __fastcall OSDecrementAtomic(_QWORD);
// 7D298: using guessed type int __fastcall OSIncrementAtomic(_QWORD);

//----- (000000000001BC92) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::ReturnExtraPower(IOUSBDevice *this, unsigned int a2, unsigned int a3)
{
  unsigned int v3; // er15@1
  IOUSBDevice *v4; // r14@1
  __int64 v5; // rax@4
  int v6; // er12@4
  char v7; // r13@5
  __int64 v8; // rdi@16
  signed int v9; // eax@20
  __int64 v10; // rax@23
  __int64 v11; // rdx@23
  __int64 v12; // rax@30
  signed __int64 v13; // rdi@34
  char v15; // [sp+Ch] [bp-34h]@5
  char v16; // [sp+10h] [bp-30h]@5
  int v17; // [sp+14h] [bp-2Ch]@21

  v3 = a3;
  v4 = this;
  if ( !a2 )
  {
    v6 = -536870206;
    if ( *(_DWORD *)(*((_QWORD *)this + 29) + 152LL) < a3 )
      return (unsigned int)v6;
    goto LABEL_13;
  }
  if ( a2 == 7 )
  {
    v5 = *((_QWORD *)this + 29);
    v6 = -536870206;
    if ( *(_DWORD *)(v5 + 204) < a3 )
      return (unsigned int)v6;
    v15 = 1;
    v16 = 0;
    goto LABEL_15;
  }
  if ( a2 != 6 )
  {
    if ( a2 == 1 )
    {
      v16 = 1;
      v6 = -536870206;
      if ( *(_DWORD *)(*((_QWORD *)this + 29) + 156LL) < a3 )
        return (unsigned int)v6;
      goto LABEL_14;
    }
LABEL_13:
    v16 = 0;
LABEL_14:
    v5 = *((_QWORD *)this + 29);
    v15 = 0;
LABEL_15:
    v7 = 0;
    goto LABEL_16;
  }
  v5 = *((_QWORD *)this + 29);
  v6 = -536870206;
  if ( *(_DWORD *)(v5 + 200) < a3 )
    return (unsigned int)v6;
  v7 = 1;
  v15 = 0;
  v16 = 0;
LABEL_16:
  v8 = *(_QWORD *)(v5 + 144);
  if ( !v8
    || (v6 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v8 + 2192LL))(
               v8,
               *(_DWORD *)v5,
               a2,
               a3)) == 0 )
  {
    if ( a2 )
    {
      v6 = 0;
      if ( a2 <= 7 )
      {
        v9 = 194;
        if ( _bittest((const unsigned int *)&v9, a2) )
        {
          v17 = 0;
          (*(void (__fastcall **)(IOUSBDevice *, int *))(*(_QWORD *)v4 + 2488LL))(v4, &v17);
          if ( v16 )
          {
            *(_DWORD *)(*((_QWORD *)v4 + 29) + 156LL) -= v3;
          }
          else if ( v7 )
          {
            *(_DWORD *)(*((_QWORD *)v4 + 29) + 200LL) -= v3;
          }
          else if ( v15 )
          {
            *(_DWORD *)(*((_QWORD *)v4 + 29) + 204LL) -= v3;
          }
          if ( BYTE1(v17) & 0x10 )
          {
            if ( v3 )
            {
              v12 = *((_QWORD *)v4 + 29);
              if ( !*(_DWORD *)(v12 + 156) && !*(_DWORD *)(v12 + 200) && a2 != 7 )
              {
                *(_BYTE *)(v12 + 208) = 0;
                if ( *(_BYTE *)(v12 + 209) )
                  v13 = *(_QWORD *)(*(_QWORD *)(v12 + 216) + 672LL) + 332LL;
                else
                  v13 = (signed __int64)&IOUSBController::gExternalNonSSPortsUsingExtraCurrent;
                OSDecrementAtomic(v13);
              }
            }
          }
          (*(void (__fastcall **)(IOUSBDevice *, _QWORD, _QWORD, signed __int64))(*(_QWORD *)v4 + 640LL))(
            v4,
            "PortUsingExtraPowerForWake",
            (unsigned int)(*(_DWORD *)(*((_QWORD *)v4 + 29) + 204LL)
                         + *(_DWORD *)(*((_QWORD *)v4 + 29) + 156LL)
                         + *(_DWORD *)(*((_QWORD *)v4 + 29) + 200LL)),
            32LL);
        }
      }
    }
    else
    {
      v10 = *((_QWORD *)v4 + 29);
      v11 = *(_DWORD *)(v10 + 152) - v3;
      *(_DWORD *)(v10 + 152) = v11;
      (*(void (__fastcall **)(IOUSBDevice *, _QWORD, __int64, signed __int64))(*(_QWORD *)v4 + 640LL))(
        v4,
        "PortUsingExtraPowerForSleep",
        v11,
        32LL);
      v6 = 0;
    }
  }
  return (unsigned int)v6;
}
// 49584: using guessed type _QWORD IOUSBController::gExternalNonSSPortsUsingExtraCurrent;
// 7D290: using guessed type int __fastcall OSDecrementAtomic(_QWORD);

//----- (000000000001BEE0) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::GetExtraPowerAllocated(IOUSBDevice *this, int a2)
{
  __int64 result; // rax@1

  result = 0LL;
  switch ( a2 )
  {
    case 0:
      result = *(_DWORD *)(*((_QWORD *)this + 29) + 152LL);
      break;
    case 1:
      result = *(_DWORD *)(*((_QWORD *)this + 29) + 156LL);
      break;
    case 6:
      result = *(_DWORD *)(*((_QWORD *)this + 29) + 200LL);
      break;
    case 7:
      result = *(_DWORD *)(*((_QWORD *)this + 29) + 204LL);
      break;
    default:
      return result;
  }
  return result;
}

//----- (000000000001BF5C) ----------------------------------------------------
char __fastcall IOUSBDevice::DoLocationOverrideAndModelMatch(IOUSBDevice *this)
{
  OSMetaClassBase *v1; // rax@1
  const OSMetaClass *v2; // rdx@1
  __int64 v3; // r13@1
  unsigned int v4; // ebx@2
  char v5; // r15@2
  char v6; // r12@2
  const OSMetaClassBase *v7; // r14@3
  OSMetaClassBase *v8; // rax@4
  const OSMetaClass *v9; // rdx@4
  __int64 v10; // rax@4
  __int64 v11; // rax@13
  OSMetaClassBase *v12; // rax@13
  OSMetaClassBase *v13; // rbx@13
  const OSMetaClass *v14; // rdx@13
  __int64 v15; // r12@13
  const OSMetaClassBase *v16; // r14@15
  unsigned int v17; // ebx@15
  char v18; // r13@15
  OSMetaClassBase *v19; // rax@16
  char *v20; // rsi@16
  const OSMetaClass *v21; // rdx@16
  __int64 v22; // rax@16
  __int64 v23; // rax@25
  const OSMetaClassBase *v25; // [sp+8h] [bp-58h]@1
  IOService *v26; // [sp+10h] [bp-50h]@1
  OSMetaClassBase *v27; // [sp+18h] [bp-48h]@14
  char v28; // [sp+22h] [bp-3Eh]@13
  __int64 v29; // [sp+30h] [bp-30h]@1

  v29 = *(_QWORD *)off_3B0E0[0];
  LODWORD(v1) = (*(int (__fastcall **)(IOUSBDevice *, _QWORD))(*(_QWORD *)this + 744LL))(this, "OverrideIfAtLocationID");
  v26 = v1;
  v25 = *(const OSMetaClassBase **)off_3B070[0];
  v3 = OSMetaClassBase::safeMetaCast(v1, *(const OSMetaClassBase **)off_3B070[0], v2);
  if ( v3 )
  {
    v4 = 0;
    v5 = 0;
    v6 = 0;
    if ( (*(int (__fastcall **)(__int64))(*(_QWORD *)v3 + 304LL))(v3) )
    {
      v7 = *(const OSMetaClassBase **)off_3B078[0];
      v5 = 0;
      v6 = 0;
      while ( 1 )
      {
        LODWORD(v8) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v3 + 488LL))(v3, v4);
        v10 = OSMetaClassBase::safeMetaCast(v8, v7, v9);
        if ( v10 )
        {
          if ( (*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v10 + 328LL))(v10, v7) == *(_DWORD *)(*((_QWORD *)this + 29) + 172LL) )
            break;
        }
        ++v4;
        if ( v4 >= (*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v3 + 304LL))(v3, v7) )
          goto LABEL_10;
      }
      v6 = 1;
      v5 = 0;
    }
  }
  else
  {
    v5 = 1;
    v6 = 0;
  }
LABEL_10:
  if ( v26 )
    (*(void (**)(void))(*(_QWORD *)v26 + 40LL))();
  if ( !v6 )
  {
    v18 = v5;
    goto LABEL_25;
  }
  v11 = IOService::getPlatform(v26);
  (*(void (__fastcall **)(__int64, char *, signed __int64))(*(_QWORD *)v11 + 2232LL))(v11, &v28, 14LL);
  LODWORD(v12) = (*(int (__fastcall **)(IOUSBDevice *, _QWORD))(*(_QWORD *)this + 744LL))(this, "MacModel");
  v13 = v12;
  v15 = OSMetaClassBase::safeMetaCast(v12, v25, v14);
  if ( v15 )
  {
    v27 = v13;
    if ( (*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v15 + 304LL))(v15, v25) )
    {
      v16 = *(const OSMetaClassBase **)off_3B088[0];
      v17 = 0;
      v18 = 1;
      do
      {
        LODWORD(v19) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v15 + 488LL))(v15, v17);
        v20 = (char *)v16;
        v22 = OSMetaClassBase::safeMetaCast(v19, v16, v21);
        if ( v22 )
        {
          v20 = &v28;
          if ( (unsigned __int8)(*(int (__fastcall **)(__int64, char *))(*(_QWORD *)v22 + 344LL))(v22, &v28) )
            goto LABEL_23;
        }
        ++v17;
      }
      while ( v17 < (*(int (__fastcall **)(__int64, char *))(*(_QWORD *)v15 + 304LL))(v15, v20) );
    }
  }
  else
  {
    v27 = v13;
  }
  v18 = v5;
LABEL_23:
  if ( v27 )
    (*(void (**)(void))(*(_QWORD *)v27 + 40LL))();
LABEL_25:
  v23 = *(_QWORD *)off_3B0E0[0];
  if ( *(_QWORD *)off_3B0E0[0] == v29 )
    LOBYTE(v23) = v18;
  return v23;
}
// 3B070: using guessed type _QWORD off_3B070[20];
// 3B078: using guessed type _QWORD off_3B078[19];
// 3B088: using guessed type _QWORD off_3B088[17];
// 3B0E0: using guessed type __int64 off_3B0E0[6];
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000001C154) ----------------------------------------------------
int __fastcall IOUSBDevice::DoMessageClients(IOUSBDevice *this, void *a2)
{
  unsigned int v2; // er8@1
  int v4; // [sp+Ch] [bp-4h]@1

  v2 = *(_DWORD *)a2;
  v4 = *((_DWORD *)a2 + 1);
  return (*(int (__fastcall **)(IOUSBDevice *, _QWORD, int *, signed __int64))(*(_QWORD *)this + 1856LL))(
           this,
           v2,
           &v4,
           4LL);
}

//----- (000000000001C180) ----------------------------------------------------
void __fastcall IOUSBDevice::SetPort(IOUSBDevice *this, void *a2)
{
  *((_QWORD *)this + 25) = a2;
}

//----- (000000000001C18E) ----------------------------------------------------
int __fastcall IOUSBDevice::SetAddress(IOUSBDevice *this, unsigned int a2)
{
  *((_WORD *)this + 68) = a2;
  return (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 640LL))(
           this,
           "USB Address",
           a2,
           16LL);
}

//----- (000000000001C1B8) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::GetAddress(IOUSBDevice *this)
{
  return *((_WORD *)this + 68);
}

//----- (000000000001C1C6) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::GetSpeed(IOUSBDevice *this)
{
  return *((_BYTE *)this + 184);
}

//----- (000000000001C1D4) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::GetBus(IOUSBDevice *this)
{
  return *((_QWORD *)this + 18);
}

//----- (000000000001C1E2) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::GetBusPowerAvailable(IOUSBDevice *this)
{
  return *((_DWORD *)this + 45);
}

//----- (000000000001C1EE) ----------------------------------------------------
int __fastcall IOUSBDevice::SetBusPowerAvailable(IOUSBDevice *this, unsigned int a2)
{
  *((_DWORD *)this + 45) = a2;
  return (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 640LL))(
           this,
           "Bus Power Available",
           a2,
           32LL);
}

//----- (000000000001C214) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::GetDevicePowerParent(IOUSBDevice *this)
{
  __int64 v1; // rcx@1
  __int64 result; // rax@1

  v1 = *((_QWORD *)this + 29);
  result = 0LL;
  if ( v1 )
    result = *(_QWORD *)(v1 + 144);
  return result;
}

//----- (000000000001C230) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::GetMaxPacketSize(IOUSBDevice *this)
{
  return *((_BYTE *)this + 167);
}

//----- (000000000001C23E) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::GetVendorID(IOUSBDevice *this)
{
  return *((_WORD *)this + 84);
}

//----- (000000000001C24C) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::GetProductID(IOUSBDevice *this)
{
  return *((_WORD *)this + 85);
}

//----- (000000000001C25A) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::GetDeviceRelease(IOUSBDevice *this)
{
  return *((_WORD *)this + 86);
}

//----- (000000000001C268) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::GetbcdUSB(IOUSBDevice *this)
{
  return *((_WORD *)this + 81);
}

//----- (000000000001C276) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::GetNumConfigurations(IOUSBDevice *this)
{
  return *((_BYTE *)this + 177);
}

//----- (000000000001C284) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::GetDeviceClass(IOUSBDevice *this)
{
  return *((_BYTE *)this + 164);
}

//----- (000000000001C292) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::GetDeviceSubClass(IOUSBDevice *this)
{
  return *((_BYTE *)this + 165);
}

//----- (000000000001C2A0) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::GetProtocol(IOUSBDevice *this)
{
  return *((_BYTE *)this + 166);
}

//----- (000000000001C2AE) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::GetManufacturerStringIndex(IOUSBDevice *this)
{
  return *((_BYTE *)this + 174);
}

//----- (000000000001C2BC) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::GetProductStringIndex(IOUSBDevice *this)
{
  return *((_BYTE *)this + 175);
}

//----- (000000000001C2CA) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::GetSerialNumberStringIndex(IOUSBDevice *this)
{
  return *((_BYTE *)this + 176);
}

//----- (000000000001C2D8) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::GetLocationID(IOUSBDevice *this)
{
  __int64 v1; // rcx@1
  __int64 result; // rax@1

  v1 = *((_QWORD *)this + 29);
  result = 0LL;
  if ( v1 )
    result = *(_DWORD *)(v1 + 172);
  return result;
}

//----- (000000000001C2F2) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::GetPipeZero(IOUSBDevice *this)
{
  return *((_QWORD *)this + 19);
}

//----- (000000000001C300) ----------------------------------------------------
__int64 IOUSBDevice::MakePipe()
{
  return 0LL;
}

//----- (000000000001C308) ----------------------------------------------------
int __fastcall IOUSBDevice::MakePipe(__int64 a1, __int64 a2, __int64 a3)
{
  return (*(int (__fastcall **)(__int64, __int64, _QWORD, __int64))(*(_QWORD *)a1 + 2544LL))(a1, a2, 0LL, a3);
}

//----- (000000000001C322) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::MakePipe(__int64 a1, __int64 a2, unsigned __int64 a3, __int64 a4)
{
  return IOUSBPipeV2::ToEndpoint(a2, a3, a1, *(_QWORD *)(a1 + 144), a4);
}

//----- (000000000001C342) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::GetIsochDelay(IOUSBDevice *this)
{
  __int64 result; // rax@1

  result = *((_QWORD *)this + 29);
  if ( result )
    LOWORD(result) = *(_WORD *)(result + 210);
  else
    LOWORD(result) = 0;
  return (unsigned __int16)result;
}

//----- (000000000001C362) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::_RESERVEDIOUSBDevice18(IOUSBDevice *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBDevice::gMetaClass, 18);
}
// 49760: using guessed type _QWORD IOUSBDevice::gMetaClass;

//----- (000000000001C378) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::_RESERVEDIOUSBDevice19(IOUSBDevice *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBDevice::gMetaClass, 19);
}
// 49760: using guessed type _QWORD IOUSBDevice::gMetaClass;

//----- (000000000001C38E) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceIterator::MetaClass::~MetaClass(IOUSBInterfaceIterator::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000001C398) ----------------------------------------------------
__int64 __fastcall IOUSBDevice::MetaClass::~MetaClass(IOUSBDevice::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000001C3B0) ----------------------------------------------------
__int64 `global constructor keyed to'_a_6()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(&IOUSBInterfaceIterator::gMetaClass, "IOUSBInterfaceIterator", off_3B018[0], 40LL);
  IOUSBInterfaceIterator::gMetaClass = off_3F3C0;
  OSMetaClass::OSMetaClass(&IOUSBDevice::gMetaClass, "IOUSBDevice", &IOUSBNub::gMetaClass, 240LL);
  result = (__int64)off_3FEF0;
  IOUSBDevice::gMetaClass = off_3FEF0;
  return result;
}
// 3B018: using guessed type _QWORD *off_3B018[8];
// 3F3C0: using guessed type __int64 (__fastcall *off_3F3C0[2])(IOUSBInterfaceIterator::MetaClass *__hidden this);
// 3FEF0: using guessed type __int64 (__fastcall *off_3FEF0[2])(IOUSBDevice::MetaClass *__hidden this);
// 49638: using guessed type _QWORD IOUSBNub::gMetaClass;
// 49738: using guessed type _QWORD IOUSBInterfaceIterator::gMetaClass;
// 49760: using guessed type _QWORD IOUSBDevice::gMetaClass;
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001C410) ----------------------------------------------------
__int64 `global destructor keyed to'_a_6()
{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOUSBDevice::gMetaClass);
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&IOUSBInterfaceIterator::gMetaClass);
}
// 49738: using guessed type _QWORD IOUSBInterfaceIterator::gMetaClass;
// 49760: using guessed type _QWORD IOUSBDevice::gMetaClass;

//----- (000000000001C430) ----------------------------------------------------
__int64 __fastcall IOUSBWorkLoop::MetaClass::MetaClass(IOUSBWorkLoop::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBWorkLoop", off_3B010[0], 88LL);
  result = (__int64)off_40210;
  *(_QWORD *)this = off_40210;
  return result;
}
// 3B010: using guessed type _QWORD *off_3B010[9];
// 40210: using guessed type __int64 (__fastcall *off_40210[2])(IOUSBWorkLoop::MetaClass *__hidden this);
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001C462) ----------------------------------------------------
__int64 __fastcall IOUSBWorkLoop::MetaClass::~MetaClass(IOUSBWorkLoop::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000001C46C) ----------------------------------------------------
__int64 __fastcall IOUSBWorkLoop::IOUSBWorkLoop(__int64 a1)
{
  __int64 result; // rax@1

  IOWorkLoop::IOWorkLoop(a1);
  result = (__int64)off_3FFF0;
  *(_QWORD *)a1 = off_3FFF0;
  return result;
}
// 3FFF0: using guessed type __int64 (__fastcall *off_3FFF0[2])(IOUSBWorkLoop *__hidden this);
// 7D358: using guessed type int __cdecl IOWorkLoop::IOWorkLoop(_QWORD);

//----- (000000000001C48C) ----------------------------------------------------
__int64 __fastcall IOUSBWorkLoop::IOUSBWorkLoop(__int64 a1)
{
  __int64 result; // rax@1

  IOWorkLoop::IOWorkLoop(a1);
  result = (__int64)off_3FFF0;
  *(_QWORD *)a1 = off_3FFF0;
  return result;
}
// 3FFF0: using guessed type __int64 (__fastcall *off_3FFF0[2])(IOUSBWorkLoop *__hidden this);
// 7D358: using guessed type int __cdecl IOWorkLoop::IOWorkLoop(_QWORD);

//----- (000000000001C4AC) ----------------------------------------------------
__int64 __fastcall IOUSBWorkLoop::~IOUSBWorkLoop(IOUSBWorkLoop *this)
{
  return IOWorkLoop::~IOWorkLoop(this);
}

//----- (000000000001C4B6) ----------------------------------------------------
__int64 __fastcall IOUSBWorkLoop::~IOUSBWorkLoop(IOUSBWorkLoop *this)
{
  return IOWorkLoop::~IOWorkLoop(this);
}

//----- (000000000001C4C0) ----------------------------------------------------
void __fastcall IOUSBWorkLoop::~IOUSBWorkLoop(IOUSBWorkLoop *this)
{
  IOWorkLoop::~IOWorkLoop(this);
  OSObject::operator delete((void *)this);
}

//----- (000000000001C4E2) ----------------------------------------------------
__int64 __fastcall IOUSBWorkLoop::getMetaClass(IOUSBWorkLoop *this)
{
  return (__int64)&IOUSBWorkLoop::gMetaClass;
}
// 49788: using guessed type _QWORD IOUSBWorkLoop::gMetaClass;

//----- (000000000001C4F0) ----------------------------------------------------
__int64 __fastcall IOUSBWorkLoop::MetaClass::MetaClass(IOUSBWorkLoop::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBWorkLoop", off_3B010[0], 88LL);
  result = (__int64)off_40210;
  *(_QWORD *)this = off_40210;
  return result;
}
// 3B010: using guessed type _QWORD *off_3B010[9];
// 40210: using guessed type __int64 (__fastcall *off_40210[2])(IOUSBWorkLoop::MetaClass *__hidden this);
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001C522) ----------------------------------------------------
__int64 __fastcall IOUSBWorkLoop::MetaClass::alloc(IOUSBWorkLoop::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&stru_20.maxprot, a2);
  IOWorkLoop::IOWorkLoop(v2);
  *(_QWORD *)v2 = off_3FFF0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBWorkLoop::gMetaClass);
  return v2;
}
// 20: using guessed type segment_command_64 stru_20;
// 3FFF0: using guessed type __int64 (__fastcall *off_3FFF0[2])(IOUSBWorkLoop *__hidden this);
// 49788: using guessed type _QWORD IOUSBWorkLoop::gMetaClass;
// 7D358: using guessed type int __cdecl IOWorkLoop::IOWorkLoop(_QWORD);

//----- (000000000001C562) ----------------------------------------------------
__int64 __fastcall IOUSBWorkLoop::IOUSBWorkLoop(__int64 a1)
{
  IOWorkLoop::IOWorkLoop(a1);
  *(_QWORD *)a1 = off_3FFF0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBWorkLoop::gMetaClass);
}
// 3FFF0: using guessed type __int64 (__fastcall *off_3FFF0[2])(IOUSBWorkLoop *__hidden this);
// 49788: using guessed type _QWORD IOUSBWorkLoop::gMetaClass;
// 7D358: using guessed type int __cdecl IOWorkLoop::IOWorkLoop(_QWORD);

//----- (000000000001C592) ----------------------------------------------------
__int64 __fastcall IOUSBWorkLoop::IOUSBWorkLoop(__int64 a1)
{
  IOWorkLoop::IOWorkLoop(a1);
  *(_QWORD *)a1 = off_3FFF0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBWorkLoop::gMetaClass);
}
// 3FFF0: using guessed type __int64 (__fastcall *off_3FFF0[2])(IOUSBWorkLoop *__hidden this);
// 49788: using guessed type _QWORD IOUSBWorkLoop::gMetaClass;
// 7D358: using guessed type int __cdecl IOWorkLoop::IOWorkLoop(_QWORD);

//----- (000000000001C5C2) ----------------------------------------------------
IOUSBWorkLoop *__fastcall IOUSBWorkLoop::workLoop(IOUSBWorkLoop *this, const char *a2)
{
  IOUSBWorkLoop *v2; // rbx@1

  v2 = (IOUSBWorkLoop *)OSObject::operator new((OSObject *)&stru_20.maxprot, (unsigned __int64)a2);
  IOWorkLoop::IOWorkLoop(v2);
  *(_QWORD *)v2 = off_3FFF0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBWorkLoop::gMetaClass);
  if ( v2 && !(unsigned __int8)IOUSBWorkLoop::init(v2, (const char *)this) )
  {
    (*(void (__fastcall **)(IOUSBWorkLoop *, IOUSBWorkLoop *))(*(_QWORD *)v2 + 40LL))(v2, this);
    v2 = 0LL;
  }
  return v2;
}
// 20: using guessed type segment_command_64 stru_20;
// 3FFF0: using guessed type __int64 (__fastcall *off_3FFF0[2])(IOUSBWorkLoop *__hidden this);
// 49788: using guessed type _QWORD IOUSBWorkLoop::gMetaClass;
// 7D358: using guessed type int __cdecl IOWorkLoop::IOWorkLoop(_QWORD);

//----- (000000000001C62E) ----------------------------------------------------
int __fastcall IOUSBWorkLoop::init(IOUSBWorkLoop *this, const char *a2)
{
  __int64 v2; // r15@1
  __int64 v3; // rax@1
  __int64 v4; // rax@2
  int result; // eax@3
  __int64 v6; // rcx@3
  char v7; // [sp+0h] [bp-60h]@1
  __int64 v8; // [sp+40h] [bp-20h]@1

  v2 = off_3B0E0[0];
  v8 = *(_QWORD *)off_3B0E0[0];
  snprintf(&v7, 0x40uLL, "USB-%s", a2);
  LODWORD(v3) = lck_grp_alloc_init(&v7, 0LL);
  *((_QWORD *)this + 10) = v3;
  if ( v3 )
  {
    LODWORD(v4) = IORecursiveLockAllocWithLockGroup(v3);
    *((_QWORD *)this + 2) = v4;
  }
  result = (*(int (__fastcall **)(IOUSBWorkLoop *))(off_3B0A8[0] + 152))(this);
  v6 = *(_QWORD *)v2;
  return result;
}
// 3B0A8: using guessed type __int64 off_3B0A8[13];
// 3B0E0: using guessed type __int64 off_3B0E0[6];
// 7D258: using guessed type int __fastcall IORecursiveLockAllocWithLockGroup(_QWORD);
// 7E1B0: using guessed type int __fastcall lck_grp_alloc_init(_QWORD, _QWORD);

//----- (000000000001C6B2) ----------------------------------------------------
int __fastcall IOUSBWorkLoop::free(IOUSBWorkLoop *this)
{
  IOUSBWorkLoop *v1; // rbx@1
  __int64 v2; // rdi@1

  v1 = this;
  v2 = *((_QWORD *)this + 10);
  if ( v2 )
  {
    lck_grp_free(v2);
    *((_QWORD *)v1 + 10) = 0LL;
  }
  return (*(int (__fastcall **)(IOUSBWorkLoop *))(off_3B0A8[0] + 160))(v1);
}
// 3B0A8: using guessed type __int64 off_3B0A8[13];
// 7E1B8: using guessed type int __cdecl lck_grp_free(_QWORD);

//----- (000000000001C6E8) ----------------------------------------------------
int __fastcall IOUSBWorkLoop::closeGate(IOUSBWorkLoop *this, __int64 a2)
{
  int result; // eax@1
  __int64 v3; // rdx@2
  __int64 v4; // rcx@2
  __int64 v5; // rdx@4
  __int64 i; // rcx@4

  result = (*(int (**)(void))(off_3B0A8[0] + 400))();
  if ( *((_QWORD *)this + 9) )
  {
    if ( (unsigned __int8)(*(int (**)(void))(*(_QWORD *)this + 304LL))() )
      IOLog("IOUSBWorkLoop::closeGate - interrupt Thread being held off", a2, v3, v4);
    result = (*(int (__fastcall **)(IOUSBWorkLoop *, _QWORD, signed __int64))(*(_QWORD *)this + 400LL))(
               this,
               *((_QWORD *)this + 9),
               2LL);
    for ( i = (unsigned int)result; result; i = (unsigned int)result )
    {
      IOLog("sleepGate returned 0x%x\n", (unsigned int)i, v5, i);
      result = (*(int (__fastcall **)(IOUSBWorkLoop *, _QWORD, signed __int64))(*(_QWORD *)this + 400LL))(
                 this,
                 *((_QWORD *)this + 9),
                 2LL);
    }
  }
  return result;
}
// 3B0A8: using guessed type __int64 off_3B0A8[13];
// 7D240: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001C772) ----------------------------------------------------
int __fastcall IOUSBWorkLoop::tryCloseGate(IOUSBWorkLoop *this)
{
  int result; // eax@1

  result = (*(int (__cdecl **)(IOUSBWorkLoop *))(off_3B0A8[0] + 408))(this);
  if ( (_BYTE)result )
  {
    if ( *((_QWORD *)this + 9) )
    {
      (*(void (__cdecl **)(IOUSBWorkLoop *))(*(_QWORD *)this + 376LL))(this);
      result = 0;
    }
  }
  return result;
}
// 3B0A8: using guessed type __int64 off_3B0A8[13];

//----- (000000000001C7A8) ----------------------------------------------------
__int64 __fastcall IOUSBWorkLoop::sleep(IOUSBWorkLoop *this, void *a2, __int64 a3, __int64 a4)
{
  __int64 result; // rax@2

  if ( *((_QWORD *)this + 9) )
  {
    IOLog("IOUSBWorkLoop::sleep: Already asleep: %p\n", a2, a3, a4);
    result = 3758097084LL;
  }
  else
  {
    *((_QWORD *)this + 9) = a2;
    (*(void (**)(void))(*(_QWORD *)this + 376LL))();
    result = 0LL;
  }
  return result;
}
// 7D240: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001C7DA) ----------------------------------------------------
__int64 __fastcall IOUSBWorkLoop::wake(IOUSBWorkLoop *this, void *a2, __int64 a3, __int64 a4)
{
  void *v4; // rdx@1
  signed int v5; // er15@2

  v4 = (void *)*((_QWORD *)this + 9);
  if ( v4 == a2 )
  {
    IORecursiveLockLock(*((_QWORD *)this + 2));
    *((_QWORD *)this + 9) = 0LL;
    v5 = 0;
    (*(void (__fastcall **)(IOUSBWorkLoop *, void *, _QWORD))(*(_QWORD *)this + 408LL))(this, a2, 0LL);
  }
  else
  {
    IOLog("IOUSBWorkLoop::wake: wrong token: %p<->%p\n", a2, v4, a4);
    v5 = -536870212;
  }
  return (unsigned int)v5;
}
// 7D240: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD);
// 7D260: using guessed type int __fastcall IORecursiveLockLock(_QWORD);

//----- (000000000001C840) ----------------------------------------------------
int __fastcall IOUSBWorkLoop::SleepWithTimeout(IOUSBWorkLoop *this, void *a2, unsigned int a3, __int64 a4, __int64 a5, __int64 a6)
{
  __int64 v7; // [sp+8h] [bp-18h]@1

  clock_interval_to_deadline(a3, 1LL, &v7, a4, a5, a6);
  return IORecursiveLockSleepDeadline(*((_QWORD *)this + 2), a2, v7, 2LL);
}
// 7D268: using guessed type int __fastcall IORecursiveLockSleepDeadline(_QWORD, _QWORD, _QWORD, _QWORD);
// 7E178: using guessed type int __fastcall clock_interval_to_deadline(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001C882) ----------------------------------------------------
int __fastcall IOUSBWorkLoop::Wakeup(IOUSBWorkLoop *this, void *a2, unsigned __int8 a3)
{
  return IORecursiveLockWakeup(*((_QWORD *)this + 2), a2, a3);
}
// 7D270: using guessed type int __fastcall IORecursiveLockWakeup(_QWORD, _QWORD, _QWORD);

//----- (000000000001C894) ----------------------------------------------------
int __fastcall IOUSBWorkLoop::CloseGate(IOUSBWorkLoop *this)
{
  return (*(int (**)(void))(*(_QWORD *)this + 384LL))();
}

//----- (000000000001C8A2) ----------------------------------------------------
int __fastcall IOUSBWorkLoop::OpenGate(IOUSBWorkLoop *this)
{
  return (*(int (**)(void))(*(_QWORD *)this + 376LL))();
}

//----- (000000000001C8B0) ----------------------------------------------------
__int64 __fastcall IOUSBWorkLoop::MetaClass::~MetaClass(IOUSBWorkLoop::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000001C8C0) ----------------------------------------------------
__int64 `global constructor keyed to'_a_7()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(&IOUSBWorkLoop::gMetaClass, "IOUSBWorkLoop", off_3B010[0], 88LL);
  result = (__int64)off_40210;
  IOUSBWorkLoop::gMetaClass = off_40210;
  return result;
}
// 3B010: using guessed type _QWORD *off_3B010[9];
// 40210: using guessed type __int64 (__fastcall *off_40210[2])(IOUSBWorkLoop::MetaClass *__hidden this);
// 49788: using guessed type _QWORD IOUSBWorkLoop::gMetaClass;
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001C900) ----------------------------------------------------
__int64 `global destructor keyed to'_a_7()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&IOUSBWorkLoop::gMetaClass);
}
// 49788: using guessed type _QWORD IOUSBWorkLoop::gMetaClass;

//----- (000000000001C920) ----------------------------------------------------
__int64 __fastcall IOUSBControllerUserClient::MetaClass::MetaClass(IOUSBControllerUserClient::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBControllerUserClient", off_3B030[0], 296LL);
  result = (__int64)off_40CF0;
  *(_QWORD *)this = off_40CF0;
  return result;
}
// 3B030: using guessed type _QWORD *off_3B030[5];
// 40CF0: using guessed type __int64 (__fastcall *off_40CF0[2])(IOUSBControllerUserClient::MetaClass *__hidden this);
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001C952) ----------------------------------------------------
__int64 __fastcall IOUSBControllerUserClient::MetaClass::~MetaClass(IOUSBControllerUserClient::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000001C95C) ----------------------------------------------------
__int64 __fastcall IOUSBControllerUserClient::IOUSBControllerUserClient(__int64 a1)
{
  __int64 result; // rax@1

  IOUserClient::IOUserClient(a1);
  result = (__int64)off_40310;
  *(_QWORD *)a1 = off_40310;
  return result;
}
// 40310: using guessed type __int64 (__fastcall *off_40310[2])(IOUSBControllerUserClient *__hidden this);
// 7D578: using guessed type int __cdecl IOUserClient::IOUserClient(_QWORD);

//----- (000000000001C97C) ----------------------------------------------------
__int64 __fastcall IOUSBControllerUserClient::IOUSBControllerUserClient(__int64 a1)
{
  __int64 result; // rax@1

  IOUserClient::IOUserClient(a1);
  result = (__int64)off_40310;
  *(_QWORD *)a1 = off_40310;
  return result;
}
// 40310: using guessed type __int64 (__fastcall *off_40310[2])(IOUSBControllerUserClient *__hidden this);
// 7D578: using guessed type int __cdecl IOUserClient::IOUserClient(_QWORD);

//----- (000000000001C99C) ----------------------------------------------------
__int64 __fastcall IOUSBControllerUserClient::~IOUSBControllerUserClient(IOUSBControllerUserClient *this)
{
  return IOUserClient::~IOUserClient(this);
}

//----- (000000000001C9A6) ----------------------------------------------------
__int64 __fastcall IOUSBControllerUserClient::~IOUSBControllerUserClient(IOUSBControllerUserClient *this)
{
  return IOUserClient::~IOUserClient(this);
}

//----- (000000000001C9B0) ----------------------------------------------------
void __fastcall IOUSBControllerUserClient::~IOUSBControllerUserClient(IOUSBControllerUserClient *this)
{
  IOUserClient::~IOUserClient(this);
  OSObject::operator delete((void *)this);
}

//----- (000000000001C9D2) ----------------------------------------------------
__int64 __fastcall IOUSBControllerUserClient::getMetaClass(IOUSBControllerUserClient *this)
{
  return (__int64)&IOUSBControllerUserClient::gMetaClass;
}
// 497B0: using guessed type _QWORD IOUSBControllerUserClient::gMetaClass;

//----- (000000000001C9E0) ----------------------------------------------------
__int64 __fastcall IOUSBControllerUserClient::MetaClass::MetaClass(IOUSBControllerUserClient::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBControllerUserClient", off_3B030[0], 296LL);
  result = (__int64)off_40CF0;
  *(_QWORD *)this = off_40CF0;
  return result;
}
// 3B030: using guessed type _QWORD *off_3B030[5];
// 40CF0: using guessed type __int64 (__fastcall *off_40CF0[2])(IOUSBControllerUserClient::MetaClass *__hidden this);
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001CA12) ----------------------------------------------------
__int64 __fastcall IOUSBControllerUserClient::MetaClass::alloc(IOUSBControllerUserClient::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&stru_108.addr, a2);
  IOUserClient::IOUserClient(v2);
  *(_QWORD *)v2 = off_40310;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBControllerUserClient::gMetaClass);
  return v2;
}
// 108: using guessed type section_64 stru_108;
// 40310: using guessed type __int64 (__fastcall *off_40310[2])(IOUSBControllerUserClient *__hidden this);
// 497B0: using guessed type _QWORD IOUSBControllerUserClient::gMetaClass;
// 7D578: using guessed type int __cdecl IOUserClient::IOUserClient(_QWORD);

//----- (000000000001CA52) ----------------------------------------------------
__int64 __fastcall IOUSBControllerUserClient::IOUSBControllerUserClient(__int64 a1)
{
  IOUserClient::IOUserClient(a1);
  *(_QWORD *)a1 = off_40310;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBControllerUserClient::gMetaClass);
}
// 40310: using guessed type __int64 (__fastcall *off_40310[2])(IOUSBControllerUserClient *__hidden this);
// 497B0: using guessed type _QWORD IOUSBControllerUserClient::gMetaClass;
// 7D578: using guessed type int __cdecl IOUserClient::IOUserClient(_QWORD);

//----- (000000000001CA82) ----------------------------------------------------
__int64 __fastcall IOUSBControllerUserClient::IOUSBControllerUserClient(__int64 a1)
{
  IOUserClient::IOUserClient(a1);
  *(_QWORD *)a1 = off_40310;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBControllerUserClient::gMetaClass);
}
// 40310: using guessed type __int64 (__fastcall *off_40310[2])(IOUSBControllerUserClient *__hidden this);
// 497B0: using guessed type _QWORD IOUSBControllerUserClient::gMetaClass;
// 7D578: using guessed type int __cdecl IOUserClient::IOUserClient(_QWORD);

//----- (000000000001CAB2) ----------------------------------------------------
__int64 __fastcall IOUSBControllerUserClient::SetExternalMethodVectors(IOUSBControllerUserClient *this)
{
  __int64 result; // rax@1

  result = (__int64)&IOUSBControllerUserClient::sMethods;
  *((_QWORD *)this + 29) = &IOUSBControllerUserClient::sMethods;
  *((_DWORD *)this + 64) = 11;
  return result;
}
// 3ADE0: using guessed type _QWORD IOUSBControllerUserClient::sMethods;

//----- (000000000001CAD0) ----------------------------------------------------
signed __int64 __fastcall IOUSBControllerUserClient::getTargetAndMethodForIndex(IOUSBControllerUserClient *this, IOService **a2, unsigned int a3)
{
  signed __int64 result; // rax@1
  signed __int64 v4; // rcx@2
  __int64 v5; // rdx@2
  IOService *v6; // rax@3

  result = 0LL;
  if ( *((_DWORD *)this + 64) > a3 )
  {
    v4 = 48LL * a3;
    v5 = *(_QWORD *)(*((_QWORD *)this + 29) + 48LL * a3);
    result = 0LL;
    if ( v5 == 1 )
    {
      v6 = (IOService *)*((_QWORD *)this + 27);
    }
    else
    {
      if ( v5 )
        return result;
      v6 = this;
    }
    *a2 = v6;
    result = *((_QWORD *)this + 29) + v4;
  }
  return result;
}

//----- (000000000001CB1C) ----------------------------------------------------
int __fastcall IOUSBControllerUserClient::initWithTask(IOUSBControllerUserClient *this, task *a2, void *a3, unsigned int a4, OSDictionary *a5)
{
  OSDictionary *v5; // r13@1
  unsigned int v6; // er14@1
  IOUserClient *v7; // r15@1
  int result; // eax@4

  v5 = a5;
  v6 = a4;
  v7 = (IOUserClient *)a3;
  if ( a5 )
    (*(void (__fastcall **)(OSDictionary *, _QWORD, _QWORD))(*(_QWORD *)a5 + 464LL))(
      a5,
      "IOUserClientCrossEndianCompatible",
      **(_QWORD **)off_3B0F8[0]);
  if ( a2 )
  {
    *((_BYTE *)this + 273) = (unsigned int)IOUserClient::clientHasPrivilege(v7, "root", (const char *)a3) == 0;
    *((_QWORD *)this + 28) = a2;
    *((_QWORD *)this + 27) = 0LL;
    *((_QWORD *)this + 30) = 0LL;
    *((_BYTE *)this + 272) = 0;
    (*(void (__fastcall **)(IOUSBControllerUserClient *, _QWORD))(*(_QWORD *)this + 2400LL))(this, "root");
    result = (*(int (__fastcall **)(IOUSBControllerUserClient *, task *, IOUserClient *, _QWORD, OSDictionary *))(off_3B0B8[0] + 2288))(
               this,
               a2,
               v7,
               v6,
               v5);
  }
  else
  {
    result = 0;
  }
  return result;
}
// 3B0B8: using guessed type __int64 off_3B0B8[11];
// 3B0F8: using guessed type __int64 off_3B0F8[3];

//----- (000000000001CBDC) ----------------------------------------------------
char __fastcall IOUSBControllerUserClient::start(IOUSBControllerUserClient *this, IOService *a2, const OSMetaClass *a3)
{
  __int64 v3; // rax@1
  __int64 v4; // rax@3
  __int64 v5; // rax@3
  int (__cdecl *v6)(OSObject *, void *, void *, void *, void *); // rdx@3
  __int64 v7; // rcx@4
  __int64 v8; // r8@4
  __int64 v9; // r9@4
  __int64 v10; // r14@4
  __int64 v11; // rax@5
  __int64 v12; // rcx@5
  __int64 v13; // r8@5
  __int64 v14; // r9@5
  __int64 v15; // r15@5
  __int64 v16; // rdx@7
  char v17; // r14@8
  char v19; // [sp+0h] [bp-20h]@0

  v3 = OSMetaClassBase::safeMetaCast(a2, (const OSMetaClassBase *)IOUSBController::metaClass, a3);
  *((_QWORD *)this + 27) = v3;
  if ( !v3
    || !(unsigned __int8)(*(int (__fastcall **)(IOUSBControllerUserClient *, IOService *))(off_3B0B8[0] + 1488))(
                           this,
                           a2) )
    return 0;
  LODWORD(v4) = (*(int (**)(void))(**((_QWORD **)this + 27) + 1664LL))();
  LODWORD(v5) = (*(int (__fastcall **)(__int64, _QWORD, _QWORD))(*(_QWORD *)v4 + 1760LL))(v4, 0LL, 0LL);
  *((_QWORD *)this + 31) = v5;
  if ( v5 )
  {
    v10 = IOCommandGate::commandGate(this, 0LL, v6);
    if ( v10 )
    {
      LODWORD(v11) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 27) + 1672LL))(
                       *((_QWORD *)this + 27),
                       0LL);
      v15 = v11;
      if ( v11 )
      {
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v11 + 32LL))(v11);
        if ( !(*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v15 + 320LL))(v15, v10) )
        {
          *((_QWORD *)this + 30) = v10;
          *((_QWORD *)this + 35) = v15;
          *((_QWORD *)this + 33) = 0LL;
          *((_QWORD *)this + 36) = 0LL;
          return 1;
        }
        v16 = (__int64)"IOUSBControllerUserClient::start - unable to add gate to work loop";
      }
      else
      {
        v16 = (__int64)"IOUSBControllerUserClient::start - unable to find my workloop";
      }
      KernelDebugLogInternal(1u, 0x55534246u, v16, v12, v13, v14, v19);
      (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v10 + 40LL))(v10, 1431519814LL);
      if ( v15 )
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v15 + 40LL))(v15);
      return 0;
    }
    v17 = 0;
    KernelDebugLogInternal(
      1u,
      0x55534246u,
      (__int64)"IOUSBControllerUserClient::start - unable to create command gate",
      v7,
      v8,
      v9,
      v19);
  }
  else
  {
    v17 = 1;
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D0404u, (uintptr_t)this, *((_QWORD *)this + 27), 0xFFFFFFFFE00002BELL, 0LL, 0LL);
  }
  return v17;
}
// 3B0B8: using guessed type __int64 off_3B0B8[11];
// 3B100: using guessed type __int64 off_3B100[2];
// 3BBF8: using guessed type _QWORD IOUSBController::metaClass;
// 49460: using guessed type int gUSBStackDebugFlags;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000001CD84) ----------------------------------------------------
__int64 __fastcall IOUSBControllerUserClient::open(uintptr_t arg1, unsigned __int8 a2)
{
  uintptr_t v2; // rbx@1
  __int64 v3; // rdi@4
  __int64 result; // rax@4
  bool v5; // zf@5

  v2 = arg1;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D0408u, arg1, *(_QWORD *)(arg1 + 216), a2, a2, 0LL);
  v3 = *(_QWORD *)(arg1 + 216);
  result = 3758097113LL;
  if ( v3 )
  {
    v5 = (unsigned __int8)(*(int (__fastcall **)(__int64, uintptr_t, _QWORD, _QWORD))(*(_QWORD *)v3 + 1488LL))(
                            v3,
                            v2,
                            a2,
                            0LL) == 0;
    result = 3758097093LL;
    if ( !v5 )
      result = 0LL;
  }
  return result;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (000000000001CE08) ----------------------------------------------------
__int64 __fastcall IOUSBControllerUserClient::close(IOUSBControllerUserClient *this)
{
  IOUSBControllerUserClient *v1; // r14@1
  __int64 v2; // rdi@1
  signed int v3; // ebx@1

  v1 = this;
  v2 = *((_QWORD *)this + 27);
  v3 = -536870183;
  if ( v2 )
  {
    v3 = 0;
    if ( (unsigned __int8)(*(int (__fastcall **)(__int64, IOUSBControllerUserClient *))(*(_QWORD *)v2 + 1504LL))(v2, v1) )
    {
      v3 = 0;
      (*(void (__fastcall **)(_QWORD, IOUSBControllerUserClient *, _QWORD))(**((_QWORD **)v1 + 27) + 1496LL))(
        *((_QWORD *)v1 + 27),
        v1,
        0LL);
    }
  }
  return (unsigned int)v3;
}

//----- (000000000001CE54) ----------------------------------------------------
__int64 __fastcall IOUSBControllerUserClient::EnableKernelLogger(IOUSBControllerUserClient *this, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 result; // rax@1

  result = 3758097113LL;
  if ( *((_QWORD *)this + 27) )
  {
    KernelDebugEnable(a2, a2, a3, a4);
    result = 0LL;
  }
  return result;
}

//----- (000000000001CE74) ----------------------------------------------------
__int64 __fastcall IOUSBControllerUserClient::SetDebuggingLevel(IOUSBControllerUserClient *this, __int64 a2, __int64 a3)
{
  __int64 result; // rax@1

  result = 3758097113LL;
  if ( *((_QWORD *)this + 27) )
  {
    KernelDebugSetLevel(a2, a2, a3);
    result = 0LL;
  }
  return result;
}

//----- (000000000001CE92) ----------------------------------------------------
__int64 __fastcall IOUSBControllerUserClient::SetDebuggingType(IOUSBControllerUserClient *this, __int64 a2, __int64 a3)
{
  __int64 result; // rax@1

  result = 3758097113LL;
  if ( *((_QWORD *)this + 27) )
  {
    KernelDebugSetOutputType(a2, a2, a3);
    result = 0LL;
  }
  return result;
}

//----- (000000000001CEB0) ----------------------------------------------------
__int64 __fastcall IOUSBControllerUserClient::GetDebuggingLevel(IOUSBControllerUserClient *this, unsigned int *a2, __int64 a3, __int64 a4)
{
  __int64 result; // rax@1

  result = 3758097113LL;
  if ( *((_QWORD *)this + 27) )
  {
    *a2 = KernelDebugGetLevel((__int64)this, (__int64)a2, a3, a4);
    result = 0LL;
  }
  return result;
}

//----- (000000000001CED8) ----------------------------------------------------
__int64 __fastcall IOUSBControllerUserClient::GetDebuggingType(IOUSBControllerUserClient *this, unsigned int *a2, __int64 a3, __int64 a4)
{
  __int64 result; // rax@1

  result = 3758097113LL;
  if ( *((_QWORD *)this + 27) )
  {
    *a2 = KernelDebugGetOutputType((__int64)this, (__int64)a2, a3, a4);
    result = 0LL;
  }
  return result;
}

//----- (000000000001CF00) ----------------------------------------------------
int __fastcall IOUSBControllerUserClient::SetTestMode(IOUSBControllerUserClient *this, unsigned int a2, const OSMetaClass *a3)
{
  int v3; // er14@1
  __int64 v4; // rax@1
  int result; // eax@2

  v3 = (signed int)a3;
  v4 = OSMetaClassBase::safeMetaCast(
         *((OSMetaClassBase **)this + 27),
         (const OSMetaClassBase *)IOUSBControllerV2::metaClass,
         a3);
  if ( v4 )
    result = (*(int (__fastcall **)(__int64, _QWORD, _QWORD))(*(_QWORD *)v4 + 2712LL))(v4, a2, (unsigned int)v3);
  else
    result = -536870183;
  return result;
}
// 419C0: using guessed type _QWORD IOUSBControllerV2::metaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000001CF4A) ----------------------------------------------------
__int64 __fastcall IOUSBControllerUserClient::ReadRegister(uintptr_t arg1, uintptr_t a2, int a3, void *a4)
{
  int v4; // er15@1
  __int64 v5; // r13@1
  uintptr_t v6; // r12@1
  uintptr_t v7; // rcx@3
  signed int v8; // ebx@4
  __int64 v9; // rdi@6
  unsigned __int64 v10; // rax@7
  __int64 v11; // rax@10
  __int64 v12; // rax@11
  __int64 v13; // rax@13
  void *v15; // [sp+0h] [bp-30h]@1

  v15 = a4;
  v4 = a3;
  LODWORD(v5) = a2;
  v6 = arg1;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
  {
    v7 = (signed int)a2;
    a2 = arg1;
    kernel_debug(0x52D040Cu, arg1, *(_QWORD *)(arg1 + 216), v7, a3, 0LL);
  }
  v8 = -536870207;
  if ( *(_BYTE *)(arg1 + 273) )
  {
    v8 = -536870183;
    if ( *(_QWORD *)(arg1 + 216) )
    {
      v9 = *(_QWORD *)(arg1 + 248);
      v8 = -536870210;
      if ( v9 )
      {
        v5 = (unsigned int)v5;
        LODWORD(v10) = (*(int (__fastcall **)(__int64, uintptr_t))(*(_QWORD *)v9 + 296LL))(v9, a2);
        v8 = -536870211;
        if ( (unsigned int)v5 < v10 )
        {
          switch ( v4 )
          {
            case 32:
              LODWORD(v12) = (*(int (**)(void))(**(_QWORD **)(v6 + 248) + 280LL))();
              *(_DWORD *)v15 = *(_DWORD *)(v12 + v5);
              v8 = 0;
              break;
            case 16:
              LODWORD(v11) = (*(int (**)(void))(**(_QWORD **)(v6 + 248) + 280LL))();
              *(_WORD *)v15 = *(_WORD *)(v11 + v5);
              v8 = 0;
              break;
            case 8:
              LODWORD(v13) = (*(int (**)(void))(**(_QWORD **)(v6 + 248) + 280LL))();
              *(_BYTE *)v15 = *(_BYTE *)(v13 + v5);
              v8 = 0;
              break;
            default:
              v8 = -536870206;
              if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
                kernel_debug(0x52D040Cu, v6, *(_QWORD *)(v6 + 216), 0xFFFFFFFFE00002C2LL, 0LL, 0LL);
              break;
          }
        }
      }
    }
  }
  return (unsigned int)v8;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (000000000001D0B8) ----------------------------------------------------
__int64 __fastcall IOUSBControllerUserClient::WriteRegister(uintptr_t arg1, int a2, int a3, int a4)
{
  int v4; // er14@1
  char v5; // al@1
  __int64 result; // rax@7

  v4 = a4;
  v5 = gUSBStackDebugFlags;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
  {
    kernel_debug(0x52D0410u, arg1, *(_QWORD *)(arg1 + 216), a2, a3, 0LL);
    v5 = gUSBStackDebugFlags;
  }
  if ( v5 & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D0410u, 1uLL, v4, 0LL, 0LL, 0LL);
  result = 3758097089LL;
  if ( *(_BYTE *)(arg1 + 273) )
  {
    result = 3758097113LL;
    if ( *(_QWORD *)(arg1 + 216) )
      result = 0LL;
  }
  return result;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (000000000001D160) ----------------------------------------------------
int __fastcall IOUSBControllerUserClient::MessageController(IOUSBControllerUserClient *this, unsigned int a2, const OSMetaClass *a3)
{
  __int64 v3; // rcx@1
  int result; // eax@1

  v3 = OSMetaClassBase::safeMetaCast(
         *((OSMetaClassBase **)this + 27),
         (const OSMetaClassBase *)IOUSBControllerV3::metaClass,
         a3);
  result = -536870183;
  if ( v3 )
  {
    result = -536870207;
    if ( *((_BYTE *)this + 273) )
    {
      if ( (unsigned __int16)a2 == 3 )
        result = (*(int (__fastcall **)(_QWORD, int (__fastcall *)(IOUSBControllerUserClient *, OSObject *, void *, void *, void *, void *), _QWORD, _QWORD, _QWORD, _QWORD))(**((_QWORD **)this + 30) + 456LL))(
                   *((_QWORD *)this + 30),
                   IOUSBControllerUserClient::GatedMessage,
                   a2,
                   0LL,
                   0LL,
                   0LL);
      else
        result = (*(int (__fastcall **)(_QWORD, signed __int64, IOUSBControllerUserClient *, _QWORD))(**((_QWORD **)this + 27) + 1840LL))(
                   *((_QWORD *)this + 27),
                   3758112789LL,
                   this,
                   a2);
    }
  }
  return result;
}
// 44350: using guessed type _QWORD IOUSBControllerV3::metaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000001D1F8) ----------------------------------------------------
int __fastcall IOUSBControllerUserClient::GatedMessage(IOUSBControllerUserClient *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  return (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(**((_QWORD **)this + 27) + 1840LL))(
           *((_QWORD *)this + 27),
           3758112789LL,
           this,
           a2,
           a2,
           a6);
}

//----- (000000000001D222) ----------------------------------------------------
int __fastcall IOUSBControllerUserClient::stop(IOUSBControllerUserClient *this, IOService *a2)
{
  IOUSBControllerUserClient *v2; // r15@1
  __int64 v3; // rdi@1
  __int64 v4; // rdi@3
  __int64 v5; // rdi@5
  __int64 v6; // rdi@7
  int (__fastcall *v7)(IOUSBControllerUserClient *, IOService *); // rbx@9

  v2 = this;
  v3 = *((_QWORD *)this + 31);
  if ( v3 )
  {
    (*(void (__cdecl **)(__int64))(*(_QWORD *)v3 + 40LL))(v3);
    *((_QWORD *)v2 + 31) = 0LL;
  }
  v4 = *((_QWORD *)v2 + 35);
  if ( v4 && *((_QWORD *)v2 + 30) )
  {
    (*(void (__cdecl **)(__int64))(*(_QWORD *)v4 + 328LL))(v4);
    v5 = *((_QWORD *)v2 + 30);
    if ( v5 )
    {
      (*(void (__cdecl **)(__int64))(*(_QWORD *)v5 + 40LL))(v5);
      *((_QWORD *)v2 + 30) = 0LL;
    }
    v6 = *((_QWORD *)v2 + 35);
    if ( v6 )
    {
      (*(void (__cdecl **)(__int64))(*(_QWORD *)v6 + 40LL))(v6);
      *((_QWORD *)v2 + 35) = 0LL;
    }
  }
  v7 = *(int (__fastcall **)(IOUSBControllerUserClient *, IOService *))(off_3B0B8[0] + 1496);
  v7(v2, a2);
  return v7(v2, a2);
}
// 3B0B8: using guessed type __int64 off_3B0B8[11];

//----- (000000000001D2D6) ----------------------------------------------------
__int64 __fastcall IOUSBControllerUserClient::clientClose(IOUSBControllerUserClient *this)
{
  if ( !(unsigned __int8)IOService::isInactive(this) )
    (*(void (__fastcall **)(IOUSBControllerUserClient *, _QWORD))(*(_QWORD *)this + 1536LL))(this, 0LL);
  return 0LL;
}

//----- (000000000001D300) ----------------------------------------------------
__int64 __fastcall IOUSBControllerUserClient::MetaClass::~MetaClass(IOUSBControllerUserClient::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000001D310) ----------------------------------------------------
__int64 `global constructor keyed to'_a_8()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(&IOUSBControllerUserClient::gMetaClass, "IOUSBControllerUserClient", off_3B030[0], 296LL);
  result = (__int64)off_40CF0;
  IOUSBControllerUserClient::gMetaClass = off_40CF0;
  return result;
}
// 3B030: using guessed type _QWORD *off_3B030[5];
// 40CF0: using guessed type __int64 (__fastcall *off_40CF0[2])(IOUSBControllerUserClient::MetaClass *__hidden this);
// 497B0: using guessed type _QWORD IOUSBControllerUserClient::gMetaClass;
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001D350) ----------------------------------------------------
__int64 `global destructor keyed to'_a_8()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&IOUSBControllerUserClient::gMetaClass);
}
// 497B0: using guessed type _QWORD IOUSBControllerUserClient::gMetaClass;

//----- (000000000001D370) ----------------------------------------------------
int __fastcall KernelDebugEnable(unsigned __int8 a1, __int64 a2, __int64 a3, __int64 a4)
{
  int result; // eax@1
  OSDictionary *v5; // rdx@1

  result = IOLog("[KernelDebugging] KernelDebugEnable (%d)\n", a1, a3, a4);
  if ( a1 )
    result = KernelDebugFindKernelLogger((__int64)"[KernelDebugging] KernelDebugEnable (%d)\n", a1, v5);
  return result;
}
// 7D240: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001D39C) ----------------------------------------------------
__int64 __fastcall KernelDebugFindKernelLogger(__int64 a1, __int64 a2, OSDictionary *a3)
{
  signed __int64 v3; // rsi@1
  IOService *v4; // rax@1
  unsigned __int64 v5; // rdx@1
  __int64 v6; // rcx@1
  IOService *v7; // r15@1
  __int64 v8; // r14@2
  __int64 v9; // rdx@3
  __int64 v10; // rcx@3
  __int64 v11; // rbx@3
  __int64 v12; // rax@4
  __int64 v13; // rdx@4
  __int64 v14; // rcx@4
  signed int v15; // er12@6
  __int64 v16; // rdi@7
  __int64 v17; // rdx@9
  __int64 v18; // rcx@9

  v3 = 0LL;
  v4 = (IOService *)IOService::serviceMatching("com_apple_iokit_KLog", 0LL, a3);
  v7 = v4;
  if ( !v4 )
  {
    v16 = (__int64)"[KernelDebugging] [FindKernelLogger] Couldn't create a matching dictionary.\n";
LABEL_9:
    v8 = 0LL;
    IOLog(v16, v3, v5, v6);
LABEL_11:
    gKernelLogger = 0LL;
    v11 = 0LL;
    v15 = -536870212;
    v3 = 3758097084LL;
    IOLog(
      "[KernelDebugging] [FindKernelLogger] Could not find a logger instance. Error = %X.\n",
      3758097084LL,
      v17,
      v18);
    goto LABEL_12;
  }
  v3 = 30000000000LL;
  v8 = IOService::waitForMatchingService(v4, (OSDictionary *)0xFC23AC00, v5);
  if ( !v8 )
  {
    v16 = (__int64)"[KernelDebugging] [FindKernelLogger] Couldn't find the matchingService.\n";
    goto LABEL_9;
  }
  v11 = IOService::getMatchingServices(v7, (OSDictionary *)0xFC23AC00);
  if ( !v11 )
  {
    IOLog("[KernelDebugging] [FindKernelLogger] No %s found.\n", "com_apple_iokit_KLog", v9, v10);
    goto LABEL_11;
  }
  LODWORD(v12) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v11 + 296LL))(v11);
  v14 = v12;
  gKernelLogger = v12;
  if ( v12 )
  {
    v3 = v12;
    IOLog("[KernelDebugging] [FindKernelLogger] Found a logger at %p.\n", v12, v13, v12);
  }
  v15 = 0;
  IOLog("[KernelDebugging] [FindKernelLogger] Found a logger instance.\n", v3, v13, v14);
LABEL_12:
  if ( v8 )
    (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v8 + 40LL))(v8, v3);
  if ( v7 )
    (*(void (__fastcall **)(IOService *, signed __int64))(*(_QWORD *)v7 + 40LL))(v7, v3);
  if ( v11 )
    (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v11 + 40LL))(v11, v3);
  return (unsigned int)v15;
}
// 497D8: using guessed type __int64 gKernelLogger;
// 7D240: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001D4B3) ----------------------------------------------------
int __fastcall KernelDebugSetLevel(int a1, __int64 a2, __int64 a3)
{
  gKernelDebugLevel = a1;
  return IOLog("[KernelDebugging] Debugging level changed to: %d\n", (unsigned int)a1, a3, (unsigned int)a1);
}
// 49170: using guessed type int gKernelDebugLevel;
// 7D240: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001D4D0) ----------------------------------------------------
__int64 __fastcall KernelDebugGetLevel(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  IOLog("[KernelDebugging] KernelDebugGetLevel called (%d)\n", (unsigned int)gKernelDebugLevel, a3, a4);
  return (unsigned int)gKernelDebugLevel;
}
// 49170: using guessed type int gKernelDebugLevel;
// 7D240: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001D4F0) ----------------------------------------------------
__int64 __fastcall KernelDebugGetOutputType(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  IOLog("[KernelDebugging] KernelDebugGetOutputType called (%d)\n", (unsigned int)gKernelDebugOutputType, a3, a4);
  return (unsigned int)gKernelDebugOutputType;
}
// 49174: using guessed type int gKernelDebugOutputType;
// 7D240: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001D510) ----------------------------------------------------
int __fastcall KernelDebugSetOutputType(int a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rcx@1

  v3 = (unsigned int)a1;
  gKernelDebugOutputType = a1;
  if ( a1 & 2 && !gKernelLogger )
  {
    IOLog(
      "[KernelDebugging] SetOutputType failed: could not find kernel logger. It probably needs to be loaded?\n",
      a2,
      a3,
      (unsigned int)a1);
    v3 = (unsigned int)gKernelDebugOutputType;
  }
  return IOLog("[KernelDebugging] Debugging type changed to: %d\n", (unsigned int)v3, a3, v3);
}
// 49174: using guessed type int gKernelDebugOutputType;
// 497D8: using guessed type __int64 gKernelLogger;
// 7D240: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001D552) ----------------------------------------------------
__int64 __fastcall KernelDebugLogInternal(unsigned int a1, unsigned int a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6, char a7)
{
  __int64 v7; // r14@1
  __int64 v8; // r13@1
  uint64_t v9; // rax@3
  __int64 v10; // rdx@3
  __int64 v11; // rcx@3
  char v13; // [sp+10h] [bp-B0h]@3
  __int64 v14; // [sp+28h] [bp-98h]@1
  __int64 v15; // [sp+30h] [bp-90h]@1
  __int64 v16; // [sp+38h] [bp-88h]@1
  unsigned __int64 v17; // [sp+48h] [bp-78h]@3
  int v18; // [sp+50h] [bp-70h]@7
  int v19; // [sp+54h] [bp-6Ch]@7
  char *v20; // [sp+58h] [bp-68h]@7
  char *v21; // [sp+60h] [bp-60h]@7
  int v22; // [sp+70h] [bp-50h]@3
  int v23; // [sp+74h] [bp-4Ch]@3
  char *v24; // [sp+78h] [bp-48h]@3
  char *v25; // [sp+80h] [bp-40h]@3
  __int64 v26; // [sp+90h] [bp-30h]@1

  v7 = a3;
  v16 = a6;
  v15 = a5;
  v14 = a4;
  v8 = off_3B0E0[0];
  v26 = *(_QWORD *)off_3B0E0[0];
  if ( gKernelDebugLevel >= a1 )
  {
    if ( gKernelDebugOutputType & 1 )
    {
      v9 = mach_absolute_time();
      absolutetime_to_nanoseconds(v9, &v17);
      v17 = 4835703278458516699LL * v17 >> 64 >> 18;
      IOLog(
        "%c%c%c%c:    %d.%3.3d    ",
        (unsigned int)((signed int)a2 >> 24),
        (char)(a2 >> 16),
        (unsigned int)SBYTE1(a2));
      v25 = &v13;
      v24 = &a7;
      v23 = 48;
      v22 = 24;
      IOLogv(v7, &v22);
      if ( a2 == 1431519814 )
        IOLog("\n", &v22, v10, v11);
    }
    if ( gKernelDebugOutputType & 2 && gKernelLogger )
    {
      v21 = &v13;
      v20 = &a7;
      v19 = 48;
      v18 = 24;
      (*(void (__fastcall **)(__int64, _QWORD, _QWORD, __int64, int *))(*(_QWORD *)gKernelLogger + 2136LL))(
        gKernelLogger,
        a1,
        a2,
        v7,
        &v18);
    }
  }
  return *(_QWORD *)v8;
}
// 3B0E0: using guessed type __int64 off_3B0E0[6];
// 49170: using guessed type int gKernelDebugLevel;
// 49174: using guessed type int gKernelDebugOutputType;
// 497D8: using guessed type __int64 gKernelLogger;
// 7D240: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD);
// 7D248: using guessed type int __fastcall IOLogv(_QWORD, _QWORD);
// 7E158: using guessed type int __fastcall absolutetime_to_nanoseconds(_QWORD, _QWORD);

//----- (000000000001D703) ----------------------------------------------------
__int64 __usercall KernelDebugLogDataInternal@<rax>(signed __int64 a1@<rdx>, int a2@<ecx>, unsigned int a3@<edi>, unsigned int a4@<esi>, char a5@<r8b>, char a6)
{
  char v6; // bl@1
  __int64 v7; // rax@1
  __int64 v8; // r8@1
  __int64 v9; // r9@1
  __int64 v10; // rdx@2

  v6 = a5;
  LODWORD(v7) = armor(a1, a2);
  if ( v6 )
    v10 = (__int64)"%s";
  else
    v10 = (__int64)"%s\n";
  return KernelDebugLogInternal(a3, a4, v10, v7, v8, v9, a6);
}

//----- (000000000001D74E) ----------------------------------------------------
int __fastcall armor(signed __int64 a1, int a2)
{
  signed __int64 v2; // r15@1
  __int64 v3; // rax@1
  __int64 v4; // rdx@2
  char v5; // bl@3
  char v6; // bl@4

  v2 = a1;
  LODWORD(v3) = IOMalloc((unsigned __int16)(((unsigned __int64)(5726623064LL * a2) >> 32)
                                          + ((unsigned __int64)(5726623064LL * a2) >> 63)
                                          + 1));
  LODWORD(a1) = 0;
  if ( a2 > 0 )
  {
    v4 = 0LL;
    a1 = 2LL;
    while ( 1 )
    {
      *(_BYTE *)(v3 + a1 - 2) = (*(_BYTE *)(v2 + v4) >> 2) + 32;
      v5 = 16 * *(_BYTE *)(v2 + v4) & 0x30;
      *(_BYTE *)(v3 + a1 - 1) = v5;
      if ( (signed int)v4 + 1 >= a2 )
      {
        *(_BYTE *)(v3 + a1 - 1) = v5 + 32;
        goto LABEL_9;
      }
      *(_BYTE *)(v3 + a1 - 1) = (v5 | (*(_BYTE *)(v2 + v4 + 1) >> 4)) + 32;
      v6 = 4 * *(_BYTE *)(v2 + v4 + 1) & 0x3C;
      *(_BYTE *)(v3 + a1) = v6;
      if ( (signed int)v4 + 2 >= a2 )
        break;
      *(_BYTE *)(v3 + a1) = (v6 | (*(_BYTE *)(v2 + v4 + 2) >> 6)) + 32;
      *(_BYTE *)(v3 + a1 + 1) = (*(_BYTE *)(v2 + v4 + 2) & 0x3F) + 32;
      v4 += 3LL;
      a1 += 4LL;
      if ( (signed int)v4 >= a2 )
      {
        LODWORD(a1) = a1 - 2;
        goto LABEL_9;
      }
    }
    *(_BYTE *)(v3 + a1) = v6 + 32;
    LODWORD(a1) = a1 + 1;
  }
LABEL_9:
  *(_BYTE *)(v3 + (signed int)a1) = 0;
  return v3;
}
// 7D250: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (000000000001D83A) ----------------------------------------------------
__int64 __fastcall IOUSBLog::MetaClass::MetaClass(IOUSBLog::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBLog", off_3B098[0], 136LL);
  result = (__int64)off_41680;
  *(_QWORD *)this = off_41680;
  return result;
}
// 3B098: using guessed type _QWORD off_3B098[15];
// 41680: using guessed type __int64 (__fastcall *off_41680[2])(IOUSBLog::MetaClass *__hidden this);
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001D86C) ----------------------------------------------------
__int64 __fastcall IOUSBLog::MetaClass::~MetaClass(IOUSBLog::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000001D876) ----------------------------------------------------
__int64 __fastcall IOUSBLog::IOUSBLog(__int64 a1)
{
  __int64 result; // rax@1

  IOService::IOService(a1);
  result = (__int64)off_40DF0;
  *(_QWORD *)a1 = off_40DF0;
  return result;
}
// 40DF0: using guessed type __int64 (__fastcall *off_40DF0[2])(IOUSBLog *__hidden this);
// 7DEA0: using guessed type int __cdecl IOService::IOService(_QWORD);

//----- (000000000001D896) ----------------------------------------------------
__int64 __fastcall IOUSBLog::IOUSBLog(__int64 a1)
{
  __int64 result; // rax@1

  IOService::IOService(a1);
  result = (__int64)off_40DF0;
  *(_QWORD *)a1 = off_40DF0;
  return result;
}
// 40DF0: using guessed type __int64 (__fastcall *off_40DF0[2])(IOUSBLog *__hidden this);
// 7DEA0: using guessed type int __cdecl IOService::IOService(_QWORD);

//----- (000000000001D8B6) ----------------------------------------------------
__int64 __fastcall IOUSBLog::~IOUSBLog(IOUSBLog *this)
{
  return IOService::~IOService(this);
}

//----- (000000000001D8C0) ----------------------------------------------------
__int64 __fastcall IOUSBLog::~IOUSBLog(IOUSBLog *this)
{
  return IOService::~IOService(this);
}

//----- (000000000001D8CA) ----------------------------------------------------
void __fastcall IOUSBLog::~IOUSBLog(IOUSBLog *this)
{
  IOService::~IOService(this);
  OSObject::operator delete((void *)this);
}

//----- (000000000001D8EC) ----------------------------------------------------
__int64 __fastcall IOUSBLog::getMetaClass(IOUSBLog *this)
{
  return (__int64)&IOUSBLog::gMetaClass;
}
// 497E0: using guessed type _QWORD IOUSBLog::gMetaClass;

//----- (000000000001D8FA) ----------------------------------------------------
__int64 __fastcall IOUSBLog::MetaClass::MetaClass(IOUSBLog::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBLog", off_3B098[0], 136LL);
  result = (__int64)off_41680;
  *(_QWORD *)this = off_41680;
  return result;
}
// 3B098: using guessed type _QWORD off_3B098[15];
// 41680: using guessed type __int64 (__fastcall *off_41680[2])(IOUSBLog::MetaClass *__hidden this);
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001D92C) ----------------------------------------------------
__int64 __fastcall IOUSBLog::MetaClass::alloc(IOUSBLog::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&stru_68.addr, a2);
  IOService::IOService(v2);
  *(_QWORD *)v2 = off_40DF0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBLog::gMetaClass);
  return v2;
}
// 68: using guessed type section_64 stru_68;
// 40DF0: using guessed type __int64 (__fastcall *off_40DF0[2])(IOUSBLog *__hidden this);
// 497E0: using guessed type _QWORD IOUSBLog::gMetaClass;
// 7DEA0: using guessed type int __cdecl IOService::IOService(_QWORD);

//----- (000000000001D96C) ----------------------------------------------------
__int64 __fastcall IOUSBLog::IOUSBLog(__int64 a1)
{
  IOService::IOService(a1);
  *(_QWORD *)a1 = off_40DF0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBLog::gMetaClass);
}
// 40DF0: using guessed type __int64 (__fastcall *off_40DF0[2])(IOUSBLog *__hidden this);
// 497E0: using guessed type _QWORD IOUSBLog::gMetaClass;
// 7DEA0: using guessed type int __cdecl IOService::IOService(_QWORD);

//----- (000000000001D99C) ----------------------------------------------------
__int64 __fastcall IOUSBLog::IOUSBLog(__int64 a1)
{
  IOService::IOService(a1);
  *(_QWORD *)a1 = off_40DF0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBLog::gMetaClass);
}
// 40DF0: using guessed type __int64 (__fastcall *off_40DF0[2])(IOUSBLog *__hidden this);
// 497E0: using guessed type _QWORD IOUSBLog::gMetaClass;
// 7DEA0: using guessed type int __cdecl IOService::IOService(_QWORD);

//----- (000000000001D9CC) ----------------------------------------------------
int __fastcall IOUSBLog::init(IOUSBLog *this, OSDictionary *a2)
{
  return (*(int (__fastcall **)(IOUSBLog *, OSDictionary *))(off_3B0D8[0] + 600))(this, a2);
}
// 3B0D8: using guessed type __int64 off_3B0D8[7];

//----- (000000000001D9DE) ----------------------------------------------------
__int64 __fastcall IOUSBLog::usblog(IOUSBLog *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&stru_68.addr, a2);
  IOService::IOService(v2);
  *(_QWORD *)v2 = off_40DF0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBLog::gMetaClass);
  if ( v2 && !(unsigned __int8)(*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v2 + 584LL))(v2, 0LL) )
  {
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 40LL))(v2);
    v2 = 0LL;
  }
  return v2;
}
// 68: using guessed type section_64 stru_68;
// 40DF0: using guessed type __int64 (__fastcall *off_40DF0[2])(IOUSBLog *__hidden this);
// 497E0: using guessed type _QWORD IOUSBLog::gMetaClass;
// 7DEA0: using guessed type int __cdecl IOService::IOService(_QWORD);

//----- (000000000001DA40) ----------------------------------------------------
__int64 __fastcall IOUSBLog::USBLogPrintf(IOUSBLog *this, __int64 a2, char *a3, __int64 a4, __int64 a5, __int64 a6)
{
  __int64 v6; // rbx@1
  char v8; // [sp+0h] [bp-160h]@1
  __int64 v9; // [sp+18h] [bp-148h]@1
  __int64 v10; // [sp+20h] [bp-140h]@1
  __int64 v11; // [sp+28h] [bp-138h]@1
  char v12; // [sp+30h] [bp-130h]@1
  void *v13; // [sp+130h] [bp-30h]@1
  char *v14; // [sp+138h] [bp-28h]@1
  char *v15; // [sp+140h] [bp-20h]@1
  __int64 v16; // [sp+150h] [bp-10h]@1
  char v17; // [sp+170h] [bp+10h]@0

  v11 = a6;
  v10 = a5;
  v9 = a4;
  v6 = off_3B0E0[0];
  v16 = *(_QWORD *)off_3B0E0[0];
  v15 = &v8;
  v14 = &v17;
  v13 = (void *)24;
  vsnprintf(&v12, 0xFFuLL, a3, (struct __va_list_tag *__attribute__((__org_typedef(va_list))) )&v13);
  return *(_QWORD *)v6;
}
// 3B0E0: using guessed type __int64 off_3B0E0[6];

//----- (000000000001DABE) ----------------------------------------------------
void __fastcall IOUSBLog::AddStatusLevel(IOUSBLog *this, __int64 a2, __int64 a3, char *a4)
{
  ;
}

//----- (000000000001DAC4) ----------------------------------------------------
void __fastcall IOUSBLog::AddStatus(IOUSBLog *this, char *a2)
{
  ;
}

//----- (000000000001DACA) ----------------------------------------------------
void __fastcall IOUSBLog::AddStatus(IOUSBLog *this, __int64 a2, char *a3)
{
  ;
}

//----- (000000000001DAD0) ----------------------------------------------------
const char *__fastcall IOUSBLog::strstr(IOUSBLog *this, const char *a2, const char *a3)
{
  const char *v3; // rbx@1
  int v4; // er13@1
  const char *v5; // r14@2
  size_t v6; // r15@2
  const char v7; // al@2
  __int64 v8; // r12@2
  const char *v9; // rbx@3

  v3 = a2;
  LOBYTE(v4) = *a3;
  if ( !*a3 )
    return v3;
  v5 = a3 + 1;
  v6 = strlen(a3 + 1);
  v7 = *a2;
  v8 = 0LL;
  if ( *a2 )
  {
    v9 = a2 + 1;
    v4 = (unsigned __int8)v4;
    v8 = 0LL;
    while ( (unsigned __int8)v7 != v4 || strncmp(v9, v5, v6) )
    {
      v7 = *v9++;
      if ( !v7 )
        return (const char *)v8;
    }
    return v9 - 1;
  }
  return (const char *)v8;
}

//----- (000000000001DB4A) ----------------------------------------------------
int __fastcall IOUSBLog::stringFromReturn(IOUSBLog *this, unsigned int a2)
{
  __int64 v2; // rax@1
  int v3; // er15@1
  __int64 v4; // rax@1
  int result; // eax@2

  LODWORD(v2) = IOFindNameForValue(a2, &IOUSBLog::stringFromReturn(int)::USBReturn_values);
  v3 = v2;
  LODWORD(v4) = (*(int (__fastcall **)(IOUSBLog *, __int64, _QWORD))(*(_QWORD *)this + 2160LL))(this, v2, "UNDEFINED");
  if ( v4 )
    result = (*(int (__fastcall **)(IOUSBLog *, _QWORD))(off_3B0D8[0] + 1936))(this, a2);
  else
    result = v3;
  return result;
}
// 3B0D8: using guessed type __int64 off_3B0D8[7];
// 41760: using guessed type __int64 IOUSBLog::stringFromReturn(int)::USBReturn_values;
// 7D210: using guessed type int __fastcall IOFindNameForValue(_QWORD, _QWORD);

//----- (000000000001DBB2) ----------------------------------------------------
__int64 __fastcall IOUSBLog::MetaClass::~MetaClass(IOUSBLog::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000001DBC0) ----------------------------------------------------
__int64 `global constructor keyed to'_a_9()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(&IOUSBLog::gMetaClass, "IOUSBLog", off_3B098[0], 136LL);
  result = (__int64)off_41680;
  IOUSBLog::gMetaClass = off_41680;
  return result;
}
// 3B098: using guessed type _QWORD off_3B098[15];
// 41680: using guessed type __int64 (__fastcall *off_41680[2])(IOUSBLog::MetaClass *__hidden this);
// 497E0: using guessed type _QWORD IOUSBLog::gMetaClass;
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001DC00) ----------------------------------------------------
__int64 `global destructor keyed to'_a_9()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&IOUSBLog::gMetaClass);
}
// 497E0: using guessed type _QWORD IOUSBLog::gMetaClass;

//----- (000000000001DC20) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV2::MetaClass::MetaClass(IOUSBControllerV2::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBControllerV2", &IOUSBController::gMetaClass, 440LL);
  result = (__int64)off_42570;
  *(_QWORD *)this = off_42570;
  return result;
}
// 42570: using guessed type __int64 (__fastcall *off_42570[2])(IOUSBControllerV2::MetaClass *__hidden this);
// 49588: using guessed type _QWORD IOUSBController::gMetaClass;
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001DC52) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV2::MetaClass::~MetaClass(IOUSBControllerV2::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000001DC5C) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV2::IOUSBControllerV2(__int64 a1)
{
  __int64 result; // rax@1

  IOUSBController::IOUSBController(a1);
  result = (__int64)off_419E0;
  *(_QWORD *)a1 = off_419E0;
  return result;
}
// 419E0: using guessed type __int64 (__fastcall *off_419E0[2])(IOUSBControllerV2 *__hidden this);

//----- (000000000001DC7C) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV2::~IOUSBControllerV2(IOUSBControllerV2 *this)
{
  return IOUSBController::~IOUSBController(this);
}

//----- (000000000001DC86) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV2::~IOUSBControllerV2(IOUSBControllerV2 *this)
{
  return IOUSBController::~IOUSBController(this);
}

//----- (000000000001DC90) ----------------------------------------------------
void __fastcall IOUSBControllerV2::~IOUSBControllerV2(IOUSBControllerV2 *this)
{
  IOUSBController::~IOUSBController(this);
  OSObject::operator delete((void *)this);
}

//----- (000000000001DCB2) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV2::getMetaClass(IOUSBControllerV2 *this)
{
  return (__int64)&IOUSBControllerV2::gMetaClass;
}
// 49808: using guessed type _QWORD IOUSBControllerV2::gMetaClass;

//----- (000000000001DCC0) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV2::MetaClass::MetaClass(IOUSBControllerV2::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBControllerV2", &IOUSBController::gMetaClass, 440LL);
  result = (__int64)off_42570;
  *(_QWORD *)this = off_42570;
  return result;
}
// 42570: using guessed type __int64 (__fastcall *off_42570[2])(IOUSBControllerV2::MetaClass *__hidden this);
// 49588: using guessed type _QWORD IOUSBController::gMetaClass;
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001DCF2) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV2::MetaClass::alloc(IOUSBControllerV2::MetaClass *this)
{
  return 0LL;
}

//----- (000000000001DCFA) ----------------------------------------------------
char __fastcall IOUSBControllerV2::init(IOUSBControllerV2 *this, OSDictionary *a2)
{
  char v2; // r14@2
  void *v3; // rax@3

  if ( !(unsigned __int8)((int (__fastcall *)(_QWORD, _QWORD))`vtable for'IOUSBController[75])(this, a2) )
    goto LABEL_5;
  v2 = 1;
  if ( !*((_QWORD *)this + 54) )
  {
    LODWORD(v3) = IOMalloc(160LL);
    *((_QWORD *)this + 54) = v3;
    if ( v3 )
    {
      bzero(v3, 0xA0uLL);
      return v2;
    }
LABEL_5:
    v2 = 0;
  }
  return v2;
}
// 3BC10: using guessed type __int64 `vtable for'IOUSBController[2];
// 7D250: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (000000000001DD52) ----------------------------------------------------
char __usercall IOUSBControllerV2::start@<al>(IOUSBControllerV2 *this@<rdi>, IOService *a2@<rsi>, char a3@<al>)
{
  __int64 v3; // rax@2
  __int64 v4; // r8@2
  __int64 v5; // r9@2
  __int64 v6; // rcx@2
  char v7; // bl@2
  char v9; // [sp-8h] [bp-10h]@1

  v9 = a3;
  if ( (unsigned __int8)((int (__fastcall *)(IOUSBControllerV2 *, IOService *))`vtable for'IOUSBController[186])(
                          this,
                          a2) )
  {
    LODWORD(v3) = thread_call_allocate(IOUSBControllerV2::ReturnIsochDoneQueueEntry, this);
    v6 = *((_QWORD *)this + 54);
    *(_QWORD *)(v6 + 152) = v3;
    v7 = 1;
    if ( !v3 )
    {
      v7 = 0;
      KernelDebugLogInternal(
        1u,
        0x55534246u,
        (__int64)"IOUSBControllerV2::start - could not allocate thread callout function.",
        v6,
        v4,
        v5,
        v9);
    }
  }
  else
  {
    v7 = 0;
  }
  return v7;
}
// 3BC10: using guessed type __int64 `vtable for'IOUSBController[2];
// 7E220: using guessed type int __fastcall thread_call_allocate(_QWORD, _QWORD);

//----- (000000000001DDB8) ----------------------------------------------------
int __fastcall IOUSBControllerV2::ReturnIsochDoneQueueEntry(IOUSBControllerV2 *this, OSObject *a2, void *a3)
{
  __int64 v3; // rax@1
  __int64 v4; // rbx@1

  v3 = OSMetaClassBase::safeMetaCast(
         this,
         (const OSMetaClassBase *)&IOUSBControllerV2::gMetaClass,
         (const OSMetaClass *)a3);
  v4 = v3;
  if ( v3 && a2 )
  {
    (*(void (__fastcall **)(__int64, OSObject *))(*(_QWORD *)v3 + 2840LL))(v3, a2);
    LODWORD(v3) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v4 + 40LL))(v4);
  }
  return v3;
}
// 49808: using guessed type _QWORD IOUSBControllerV2::gMetaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000001DDFC) ----------------------------------------------------
void __fastcall IOUSBControllerV2::free(IOUSBControllerV2 *this)
{
  uintptr_t v1; // rax@4
  uintptr_t v2; // rdx@5
  uintptr_t v3; // rbx@12
  __int64 v4; // r12@13

  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D00BCu, *(_DWORD *)(*((_QWORD *)this + 21) + 224LL), 0LL, 0LL, 3uLL, 0LL);
  v1 = *((_QWORD *)this + 54);
  if ( v1 )
  {
    v2 = *(_QWORD *)(v1 + 152);
    if ( v2 )
    {
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        kernel_debug(0x52D00BCu, *(_DWORD *)(*((_QWORD *)this + 21) + 224LL), v2, 0LL, 4uLL, 0LL);
        v2 = *(_QWORD *)(*((_QWORD *)this + 54) + 152LL);
      }
      if ( thread_call_cancel(v2) == 1 )
        (*(void (__fastcall **)(IOUSBControllerV2 *))(*(_QWORD *)this + 40LL))(this);
      thread_call_free(*(_QWORD *)(*((_QWORD *)this + 54) + 152LL));
      v1 = *((_QWORD *)this + 54);
    }
    v3 = *(_QWORD *)(v1 + 144);
    if ( v3 )
    {
      v4 = off_3B100[0];
      do
      {
        if ( gUSBStackDebugFlags & 2 && *(_DWORD *)v4 & 0xFFFFFFF7 )
        {
          kernel_debug(0x52D00BCu, *(_DWORD *)(*((_QWORD *)this + 21) + 224LL), v3, 0LL, 5uLL, 0LL);
          v1 = *((_QWORD *)this + 54);
        }
        *(_QWORD *)(v1 + 144) = *(_QWORD *)(v3 + 16);
        (*(void (__fastcall **)(uintptr_t))(*(_QWORD *)v3 + 40LL))(v3);
        v1 = *((_QWORD *)this + 54);
        v3 = *(_QWORD *)(v1 + 144);
      }
      while ( v3 );
    }
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      kernel_debug(0x52D00BCu, *(_DWORD *)(*((_QWORD *)this + 21) + 224LL), v1, 0LL, 6uLL, 0LL);
      v1 = *((_QWORD *)this + 54);
    }
    IOFree(v1, 160LL);
    *((_QWORD *)this + 54) = 0LL;
  }
  if ( gUSBStackDebugFlags & 2 )
  {
    if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D00BCu, *(_DWORD *)(*((_QWORD *)this + 21) + 224LL), 0LL, 0LL, 7uLL, 0LL);
  }
  JUMPOUT(__CS__, `vtable for'IOUSBController[20]);
}
// 3B100: using guessed type __int64 off_3B100[2];
// 3BC10: using guessed type __int64 `vtable for'IOUSBController[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 7D218: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// 7E228: using guessed type int __fastcall thread_call_cancel(_QWORD);
// 7E238: using guessed type int __fastcall thread_call_free(_QWORD);

//----- (000000000001DFFC) ----------------------------------------------------
void __usercall IOUSBControllerV2::clearTTHandler(uintptr_t arg1@<rdi>, OSObject *this@<rsi>, void *a3@<rdx>, char a4@<al>, unsigned int a5@<ecx>)
{
  unsigned int v5; // ebx@1
  __int16 v6; // r13@1
  int *v7; // r14@1
  __int64 v8; // rax@6
  __int64 v9; // r8@6
  __int64 v10; // r9@6
  unsigned __int8 v11; // bl@7
  char v12; // al@8
  uintptr_t v13; // r14@9
  uintptr_t v14; // r13@9
  __int64 v15; // rax@10
  __int64 v16; // rax@11
  uintptr_t v17; // rax@13
  int v18; // eax@19
  __int64 v19; // rax@28
  char v20; // [sp+0h] [bp-30h]@1
  char v21; // [sp+0h] [bp-30h]@9
  int v22; // [sp+4h] [bp-2Ch]@1

  v20 = a4;
  v5 = a5;
  v22 = (signed int)a3;
  v6 = IOUSBCommand::GetAddress(this);
  v7 = &gUSBStackDebugFlags;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D0019u, arg1, (uintptr_t)this, v22, v5, 0LL);
  if ( !arg1 || !this )
  {
    LODWORD(v8) = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)arg1 + 904LL))(arg1, 0LL);
    KernelDebugLogInternal(
      1u,
      0x55534246u,
      (__int64)"%s::clearTTHandler: missing controller or command",
      v8,
      v9,
      v10,
      v20);
  }
  v11 = 16 * (unsigned __int64)IOUSBCommand::GetStage(this);
  if ( (v11 ^ (unsigned __int8)IOUSBCommand::GetStage(this)) & 0x10 )
  {
    v12 = IOUSBCommand::GetStage(this);
    IOUSBCommand::SetStage(this, v12 | 0x10);
  }
  else
  {
    v21 = v6;
    v13 = *(_QWORD *)(*((_QWORD *)this + 27) + 48LL);
    v14 = IOUSBCommand::GetRequestMemoryDescriptor(this);
    IOUSBCommand::SetStage(this, 0);
    if ( v13 )
    {
      LODWORD(v15) = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)v13 + 312LL))(v13, 0LL);
      if ( v15 )
      {
        LODWORD(v16) = (*(int (__fastcall **)(uintptr_t))(*(_QWORD *)v13 + 312LL))(v13);
        if ( v16 != v14 )
        {
          if ( gUSBStackDebugFlags & 2 )
          {
            LODWORD(v17) = (*(int (__fastcall **)(uintptr_t))(*(_QWORD *)v13 + 312LL))(v13);
            if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
              kernel_debug(0x52D0018u, arg1, v17, v14, 1uLL, 0LL);
          }
        }
        (*(void (__fastcall **)(uintptr_t, signed __int64))(*(_QWORD *)v13 + 304LL))(v13, 1LL);
      }
      else if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        kernel_debug(0x52D0018u, arg1, v13, 0LL, 2uLL, 0LL);
      }
    }
    v7 = &gUSBStackDebugFlags;
    v18 = gUSBStackDebugFlags & 2;
    if ( v14 )
    {
      if ( v18 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D0018u, arg1, v14, 0LL, 3uLL, 0LL);
      IOUSBCommand::SetRequestMemoryDescriptor(this, 0LL);
      (*(void (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)v14 + 504LL))(v14, 0LL);
      (*(void (__fastcall **)(uintptr_t))(*(_QWORD *)v14 + 40LL))(v14);
    }
    else if ( v18 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      kernel_debug(0x52D0018u, arg1, 0LL, 0LL, 4uLL, 0LL);
    }
    LOBYTE(v6) = v21;
    if ( arg1 )
    {
      v19 = *(_QWORD *)(arg1 + 168);
      if ( v19 )
        (*(void (__fastcall **)(_QWORD, OSObject *))(**(_QWORD **)v19 + 304LL))(*(_QWORD *)v19, this);
    }
  }
  if ( v22 != -536854448 && v22 )
  {
    if ( *(_BYTE *)v7 & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D0018u, arg1, v22, 0LL, 5uLL, 0LL);
    (*(void (__fastcall **)(uintptr_t, _QWORD, _QWORD, signed __int64))(*(_QWORD *)arg1 + 2240LL))(
      arg1,
      (unsigned __int8)v6,
      0LL,
      3LL);
  }
  if ( *(_BYTE *)v7 & 2 )
  {
    if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D001Au, arg1, 0LL, 0LL, 0LL, 0LL);
  }
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (000000000001E2E4) ----------------------------------------------------
void __fastcall IOUSBControllerV2::ClearTT(uintptr_t arg1, unsigned __int16 a2, unsigned __int8 a3, unsigned __int64 a4)
{
  char v4; // r12@1
  unsigned __int8 v5; // r15@1
  char v6; // r14@1
  __int16 v7; // r13@4
  __int64 v8; // r15@5
  uintptr_t v9; // rsi@6
  int v10; // ebx@6
  __int64 v11; // r13@7
  __int64 v12; // rax@7
  __int64 v13; // r9@7
  __int64 v14; // r12@7
  int *v15; // r14@7
  uintptr_t v16; // rsi@8
  uint32_t v17; // edi@10
  uintptr_t v18; // r8@10
  __int64 v19; // rax@14
  __int64 v20; // rax@15
  const OSMetaClass *v21; // rdx@15
  __int64 v22; // rax@16
  __int64 v23; // rax@21
  __int64 v24; // rdi@22
  __int64 v25; // rbx@22
  __int64 v26; // rax@22
  __int64 v27; // rax@23
  __int64 v28; // ST18_8@23
  __int64 v29; // rax@23
  int v30; // eax@24
  int v31; // er14@25
  __int64 v32; // rax@25
  char v33; // ST00_1@25
  __int64 v34; // rax@30
  __int64 v35; // r8@30
  __int64 v36; // r9@30
  int v37; // er14@36
  __int16 v38; // ax@36
  __int16 v39; // r14@38
  int v40; // er13@44
  int v41; // ebx@44
  __int64 v42; // rbx@54
  __int64 v43; // rax@59
  char v44; // [sp+0h] [bp-A0h]@0
  __int64 v45; // [sp+18h] [bp-88h]@36
  char v46; // [sp+24h] [bp-7Ch]@15
  __int64 v47; // [sp+28h] [bp-78h]@14
  __int64 v48; // [sp+30h] [bp-70h]@5
  unsigned __int8 v49; // [sp+3Ch] [bp-64h]@5
  uintptr_t arg1a; // [sp+40h] [bp-60h]@4

  v4 = a4;
  v5 = a3;
  v6 = a2;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D001Du, arg1, a2, a3, (unsigned __int8)a4, 0LL);
  arg1a = arg1;
  v7 = *(_BYTE *)(arg1 + a2 + 176);
  if ( *(_BYTE *)(arg1 + a2 + 176) )
  {
    v48 = a2;
    v49 = v5;
    v8 = IOBufferMemoryDescriptor::withOptions((IOBufferMemoryDescriptor *)((char *)&dword_0 + 3), 0x18u, 1uLL, a4);
    if ( !v8 )
    {
      v10 = -536870211;
      v14 = 0LL;
      v15 = &gUSBStackDebugFlags;
      v9 = arg1;
      if ( gUSBStackDebugFlags & 2 && (v14 = 0LL, *(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
      {
        v11 = 0LL;
        kernel_debug(0x52D001Cu, arg1, 0LL, 0LL, 2uLL, 0LL);
        v8 = 0LL;
        v14 = 0LL;
      }
      else
      {
        v11 = 0LL;
        v8 = 0LL;
      }
      goto LABEL_49;
    }
    v9 = 0LL;
    v10 = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v8 + 496LL))(v8, 0LL);
    if ( v10 )
    {
      v11 = 0LL;
      LODWORD(v12) = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)arg1 + 904LL))(arg1, 0LL);
      v9 = 1431519814LL;
      KernelDebugLogInternal(
        1u,
        0x55534246u,
        (__int64)"%s::ClearTT - err (0x%x) trying to prepare memory descriptor",
        v12,
        (unsigned int)v10,
        v13,
        v44);
      (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v8 + 40LL))(v8, 1431519814LL);
      v8 = 0LL;
      v14 = 0LL;
      v15 = &gUSBStackDebugFlags;
      goto LABEL_49;
    }
    LODWORD(v19) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v8 + 736LL))(v8);
    v47 = v19;
    if ( v19 )
    {
      v46 = v4;
      LODWORD(v20) = (*(int (__fastcall **)(_QWORD, _QWORD))(***(_QWORD ***)(arg1 + 168) + 296LL))(
                       **(_QWORD **)(arg1 + 168),
                       0LL);
      v14 = v20;
      if ( v20
        || (IOUSBController::IncreaseCommandPool((IOUSBController *)arg1, 0LL, v21),
            v9 = 0LL,
            LODWORD(v22) = (*(int (__fastcall **)(_QWORD, _QWORD))(***(_QWORD ***)(arg1 + 168) + 296LL))(
                             **(_QWORD **)(arg1 + 168),
                             0LL),
            (v14 = v22) != 0) )
      {
        if ( *(_QWORD *)(*(_QWORD *)(v14 + 216) + 56LL) )
          IOUSBCommand::SetBufferUSBCommand((IOUSBCommand *)v14, 0LL);
        if ( IOUSBCommand::GetRequestMemoryDescriptor((IOUSBCommand *)v14) )
          IOUSBCommand::SetRequestMemoryDescriptor((IOUSBCommand *)v14, 0LL);
        v23 = *(_QWORD *)(*(_QWORD *)(v14 + 216) + 48LL);
        if ( v23 )
        {
          v24 = *(_QWORD *)(*(_QWORD *)(v14 + 216) + 48LL);
          v25 = *(_QWORD *)(*(_QWORD *)(v14 + 216) + 48LL);
          LODWORD(v26) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v23 + 312LL))(v24, 0LL);
          if ( v26 )
          {
            LODWORD(v27) = (*(int (**)(void))(*(_QWORD *)v24 + 312LL))();
            v28 = v27;
            LODWORD(v29) = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)arg1a + 904LL))(arg1a, 0LL);
            KernelDebugLogInternal(
              1u,
              0x55534246u,
              (__int64)"%s::ClearTT - dmaCommand (%p) already had memory descriptor (%p) - clearing",
              v29,
              v25,
              v28,
              v44);
            (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v25 + 304LL))(v25, 1LL);
          }
          v30 = (*(int (__fastcall **)(__int64, __int64, signed __int64))(*(_QWORD *)v25 + 296LL))(v25, v8, 1LL);
          if ( v30 )
          {
            v31 = v30;
            LODWORD(v32) = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)arg1a + 904LL))(arg1a, 0LL);
            v11 = v25;
            v33 = v25;
            v9 = 1431519814LL;
            v10 = v31;
            KernelDebugLogInternal(
              1u,
              0x55534246u,
              (__int64)"%s::ClearTT - err (0x%x) setting memory descriptor (%p) into dmaCommand (%p)",
              v32,
              (unsigned int)v31,
              v8,
              v33);
            v15 = &gUSBStackDebugFlags;
          }
          else
          {
            v45 = v25;
            IOUSBCommand::SetRequestMemoryDescriptor((IOUSBCommand *)v14, (IOMemoryDescriptor *)v8);
            IOUSBCommand::SetReqCount((IOUSBCommand *)v14, 8LL);
            v37 = v49 & 0xF | 16 * (v6 & 0x7F);
            v38 = v37 | 0x8000;
            if ( !v46 )
              v38 = v37;
            *(_BYTE *)v47 = 35;
            *(_BYTE *)(v47 + 1) = 8;
            *(_WORD *)(v47 + 2) = v38;
            v39 = v7;
            if ( *(_BYTE *)(*(_QWORD *)(arg1a + 432) + (unsigned __int16)v7) )
              *(_WORD *)(v47 + 4) = *(_BYTE *)(arg1a + v48 + 304);
            else
              *(_WORD *)(v47 + 4) = 1;
            *(_WORD *)(v47 + 6) = 0;
            *(_QWORD *)(v47 + 8) = 0LL;
            *(_DWORD *)(v47 + 16) = 0;
            IOUSBCommand::SetUSLCompletion(v14, arg1a, (__int64)IOUSBControllerV2::clearTTHandler, v14);
            v40 = 0;
            IOUSBCommand::SetUseTimeStamp((IOUSBCommand *)v14, 0);
            IOUSBCommand::SetSelector(v14, 0);
            IOUSBCommand::SetRequest(v14, v47);
            IOUSBCommand::SetAddress((IOUSBCommand *)v14, v39);
            IOUSBCommand::SetEndpoint((IOUSBCommand *)v14, 0);
            IOUSBCommand::SetType((IOUSBCommand *)v14, 0);
            IOUSBCommand::SetBuffer((IOUSBCommand *)v14, 0LL);
            IOUSBCommand::SetClientCompletion(v14, arg1a, (__int64)IOUSBControllerV2::clearTTHandler, v14);
            IOUSBCommand::SetNoDataTimeout((IOUSBCommand *)v14, 5000);
            IOUSBCommand::SetCompletionTimeout((IOUSBCommand *)v14, 0);
            IOUSBCommand::SetStage((IOUSBCommand *)v14, 0);
            IOUSBCommand::SetBufferUSBCommand((IOUSBCommand *)v14, 0LL);
            IOUSBCommand::SetMultiTransferTransaction((IOUSBCommand *)v14, 0);
            IOUSBCommand::SetFinalTransferInTransaction((IOUSBCommand *)v14, 0);
            v41 = 0;
            do
              IOUSBCommand::SetUIMScratch((IOUSBCommand *)v14, v41++, 0);
            while ( v41 != 10 );
            v15 = &gUSBStackDebugFlags;
            do
              IOUSBCommand::SetUIMScratch64((IOUSBCommand *)v14, v40++, 0LL);
            while ( v40 != 5 );
            v9 = v14;
            v8 = 0LL;
            v10 = IOUSBController::ControlTransaction(arg1a, (IOUSBCommand *)v14);
            v11 = v45;
            if ( !v10 )
            {
LABEL_65:
              if ( *(_BYTE *)v15 & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
              {
                v17 = 86835230;
                v18 = 0LL;
                v16 = arg1a;
                goto LABEL_68;
              }
              return;
            }
          }
        }
        else
        {
          v11 = 0LL;
          LODWORD(v34) = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)arg1 + 904LL))(arg1, 0LL);
          v9 = 1431519814LL;
          KernelDebugLogInternal(
            1u,
            0x55534246u,
            (__int64)"%s::ClearTT - No dmaCommand in the usb command",
            v34,
            v35,
            v36,
            v44);
          v10 = -536870210;
          v15 = &gUSBStackDebugFlags;
          if ( gUSBStackDebugFlags & 2 )
          {
            v11 = 0LL;
            if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
            {
              v11 = 0LL;
              v9 = arg1;
              kernel_debug(0x52D001Cu, arg1, 0LL, 0LL, 4uLL, 0LL);
            }
          }
        }
LABEL_49:
        if ( *(_BYTE *)v15 & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        {
          v9 = arg1a;
          kernel_debug(0x52D001Cu, arg1a, v10, 0LL, 6uLL, 0LL);
        }
        if ( v8 )
        {
          v9 = 0LL;
          (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v8 + 504LL))(v8, 0LL);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v8 + 40LL))(v8);
        }
        v42 = 0LL;
        if ( v14 )
        {
          v42 = IOUSBCommand::GetRequestMemoryDescriptor((IOUSBCommand *)v14);
          if ( v42 )
          {
            v9 = 0LL;
            IOUSBCommand::SetRequestMemoryDescriptor((IOUSBCommand *)v14, 0LL);
          }
          v11 = *(_QWORD *)(*(_QWORD *)(v14 + 216) + 48LL);
        }
        if ( v11 )
        {
          LODWORD(v43) = (*(int (__fastcall **)(__int64, uintptr_t))(*(_QWORD *)v11 + 312LL))(v11, v9);
          if ( v43 )
            (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v11 + 304LL))(v11, 1LL);
        }
        if ( v42 )
        {
          (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v42 + 504LL))(v42, 0LL);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v42 + 40LL))(v42);
        }
        if ( v14 )
          (*(void (__fastcall **)(_QWORD, __int64))(***(_QWORD ***)(arg1a + 168) + 304LL))(
            **(_QWORD **)(arg1a + 168),
            v14);
        goto LABEL_65;
      }
      v10 = -536870210;
      v15 = &gUSBStackDebugFlags;
      if ( gUSBStackDebugFlags & 2 )
      {
        v9 = arg1;
        if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        {
          v11 = 0LL;
          kernel_debug(0x52D001Cu, arg1, 0LL, 0LL, 3uLL, 0LL);
          goto LABEL_49;
        }
      }
    }
    else
    {
      v15 = &gUSBStackDebugFlags;
      if ( gUSBStackDebugFlags & 2 )
      {
        v10 = -536870211;
        v9 = arg1;
        if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        {
          v11 = 0LL;
          kernel_debug(0x52D001Cu, arg1, 0LL, 0LL, 5uLL, 0LL);
          v14 = 0LL;
          goto LABEL_49;
        }
      }
      else
      {
        v10 = -536870211;
      }
      v14 = 0LL;
    }
    v11 = 0LL;
    goto LABEL_49;
  }
  v16 = arg1;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
  {
    v17 = 86835228;
    v18 = 1LL;
LABEL_68:
    kernel_debug(v17, v16, 0LL, 0LL, v18, 0LL);
  }
}
// 0: using guessed type int dword_0;
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (000000000001EA22) ----------------------------------------------------
int __fastcall IOUSBControllerV2::OpenPipe(__int64 a1, unsigned int a2, unsigned int a3, __int64 a4)
{
  return (*(int (__fastcall **)(_QWORD, __int64 (__fastcall *)(uintptr_t, OSObject *, void *, void *, void *, void *), _QWORD, _QWORD, __int64, _QWORD))(**(_QWORD **)(a1 + 144) + 456LL))(
           *(_QWORD *)(a1 + 144),
           IOUSBControllerV2::DoCreateEP,
           a2,
           a3,
           a4,
           0LL);
}

//----- (000000000001EA4C) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV2::DoCreateEP(uintptr_t arg1, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  unsigned int v6; // er14@1
  void *v7; // r13@1
  unsigned int v8; // er12@4
  __int64 v9; // rax@4
  signed int v10; // ebx@5
  uintptr_t v11; // rcx@7
  __int64 v12; // rdx@7
  int v13; // ST00_4@8
  int v14; // eax@8
  char v15; // si@10
  int *v16; // r14@11
  int v17; // ST00_4@17
  int v18; // ST08_4@21
  int v19; // ST00_4@21
  __int64 v20; // rbx@22
  int v21; // ST10_4@22
  int v22; // ST08_4@22
  int v23; // ST00_4@23
  unsigned __int8 v25; // [sp+18h] [bp-38h]@1
  unsigned __int8 v26; // [sp+20h] [bp-30h]@4

  v6 = (unsigned int)a5;
  v7 = a4;
  v25 = (unsigned __int8)a3;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(
      0x52D0021u,
      arg1,
      *(_BYTE *)(arg1 + (unsigned __int8)a2 + 176),
      *(_BYTE *)(arg1 + (unsigned __int8)a2 + 304),
      *((_BYTE *)a4 + 10),
      0LL);
  v26 = (unsigned __int8)a2;
  v8 = v6 >> 16;
  v9 = OSMetaClassBase::safeMetaCast(
         (OSMetaClassBase *)arg1,
         (const OSMetaClassBase *)IOUSBControllerV3::metaClass,
         (const OSMetaClass *)a3);
  if ( v9 || (v10 = -536870201, !(_BYTE)v8) && !(_WORD)v6 )
  {
    v11 = *((_BYTE *)v7 + 10);
    v10 = -536870206;
    v12 = (__int64)off_1EDF4;
    switch ( v11 )
    {
      case 0uLL:
        v13 = *(_BYTE *)(arg1 + (unsigned __int8)a2 + 304);
        v14 = (*(int (__fastcall **)(uintptr_t, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)arg1 + 2656LL))(
                arg1,
                (unsigned __int8)a2,
                *((_BYTE *)v7 + 8),
                *((_WORD *)v7 + 6),
                v25,
                *(_BYTE *)(arg1 + (unsigned __int8)a2 + 176));
        goto LABEL_24;
      case 1uLL:
        if ( (unsigned __int8)(v25 & 0xFE) == 2LL )
        {
          v15 = *((_BYTE *)v7 + 14);
          v11 = *((_BYTE *)v7 + 14);
          v12 = (unsigned __int8)(*((_BYTE *)v7 + 14) - 1);
          if ( (unsigned int)v12 >= 0x10 )
          {
            v16 = &gUSBStackDebugFlags;
            if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
              kernel_debug(0x52D0020u, arg1, 0xFFFFFFFFE00002C2LL, v11, 0LL, 0LL);
            goto LABEL_26;
          }
        }
        else
        {
          *((_BYTE *)v7 + 14) = 1;
          v15 = 1;
        }
        if ( (unsigned __int8)v8 )
        {
          v14 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v9 + 3288LL))(
                  v9,
                  v26,
                  *((_BYTE *)v7 + 8),
                  *((_WORD *)v7 + 6),
                  *((_BYTE *)v7 + 9),
                  (unsigned __int8)v15);
        }
        else
        {
          v23 = *(_BYTE *)(arg1 + v26 + 304);
          v14 = (*(int (__fastcall **)(uintptr_t, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)arg1 + 2752LL))(
                  arg1,
                  v26,
                  *((_BYTE *)v7 + 8),
                  *((_WORD *)v7 + 6),
                  *((_BYTE *)v7 + 9),
                  *(_BYTE *)(arg1 + v26 + 176));
        }
LABEL_24:
        v10 = v14;
LABEL_25:
        v16 = &gUSBStackDebugFlags;
LABEL_26:
        if ( *(_BYTE *)v16 & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          kernel_debug(0x52D0022u, arg1, v10, 0LL, 0LL, 0LL);
        if ( v10 == -536854458 )
        {
          IOLog(
            "The USB device at USB Address %d might not work correctly because the controller driver has reached a hardware limit on the number of endpoints\n",
            v26,
            v12,
            v11);
          v10 = -536854458;
        }
        break;
      case 2uLL:
        if ( (unsigned __int16)v6 | (unsigned __int8)v8 )
        {
          v14 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v9 + 3272LL))(
                  v9,
                  (unsigned __int8)a2,
                  *((_BYTE *)v7 + 8),
                  *((_BYTE *)v7 + 9),
                  v25,
                  *((_WORD *)v7 + 6));
        }
        else
        {
          v18 = *(_BYTE *)(arg1 + (unsigned __int8)a2 + 304);
          v19 = *(_BYTE *)(arg1 + (unsigned __int8)a2 + 176);
          v14 = (*(int (__fastcall **)(uintptr_t, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)arg1 + 2664LL))(
                  arg1,
                  (unsigned __int8)a2,
                  *((_BYTE *)v7 + 8),
                  *((_BYTE *)v7 + 9),
                  v25,
                  *((_WORD *)v7 + 6));
        }
        goto LABEL_24;
      case 3uLL:
        if ( (unsigned __int8)v8 )
        {
          v17 = *((_BYTE *)v7 + 14);
          v14 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v9 + 3280LL))(
                  v9,
                  (unsigned __int8)a2,
                  *((_BYTE *)v7 + 8),
                  *((_BYTE *)v7 + 9),
                  v25,
                  *((_WORD *)v7 + 6));
        }
        else
        {
          v20 = *((_BYTE *)v7 + 14);
          v21 = *(_BYTE *)(arg1 + (unsigned __int8)a2 + 304);
          v22 = *(_BYTE *)(arg1 + (unsigned __int8)a2 + 176);
          v14 = (*(int (__fastcall **)(uintptr_t, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)arg1 + 2672LL))(
                  arg1,
                  (unsigned __int8)a2,
                  *((_BYTE *)v7 + 8),
                  *((_BYTE *)v7 + 9),
                  v25,
                  *((_WORD *)v7 + 6));
        }
        goto LABEL_24;
      default:
        goto LABEL_25;
    }
  }
  return (unsigned int)v10;
}
// 1EDF4: using guessed type void *__ptr32 off_1EDF4[4];
// 3B100: using guessed type __int64 off_3B100[2];
// 44350: using guessed type _QWORD IOUSBControllerV3::metaClass;
// 49460: using guessed type int gUSBStackDebugFlags;
// 7D240: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD);
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000001EE04) ----------------------------------------------------
int __fastcall IOUSBControllerV2::OpenSSPipe(__int64 a1, unsigned int a2, unsigned int a3, __int64 a4, int a5, int a6)
{
  return (*(int (__fastcall **)(_QWORD, __int64 (__fastcall *)(uintptr_t, OSObject *, void *, void *, void *, void *), _QWORD, _QWORD, __int64, _QWORD))(**(_QWORD **)(a1 + 144) + 456LL))(
           *(_QWORD *)(a1 + 144),
           IOUSBControllerV2::DoCreateEP,
           a2,
           a3,
           a4,
           (unsigned int)(a5 + (a6 << 16)));
}

//----- (000000000001EE34) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV2::CreateDevice(IOUSBControllerV2 *this, IOUSBDevice *a2, unsigned int a3, unsigned __int8 a4, unsigned __int8 a5, unsigned int a6, unsigned __int16 a7, int a8)
{
  unsigned __int8 v8; // r15@1
  __int64 result; // rax@2
  unsigned int v10; // er13@3
  unsigned int v11; // er14@3
  unsigned int v12; // ST04_4@3

  v8 = a4;
  if ( a3 <= 0x80 )
  {
    v10 = (unsigned __int16)a3;
    v11 = a5;
    v12 = a6;
    IOUSBControllerV2::UpdateTopology(this, a3, a5, a7, a8);
    result = IOUSBController::CreateDevice(this, a2, v10, v8, v11, v12);
  }
  else
  {
    result = 3758096385LL;
  }
  return result;
}

//----- (000000000001EEB6) ----------------------------------------------------
char __fastcall IOUSBControllerV2::UpdateTopology(IOUSBControllerV2 *this, unsigned __int16 a2, unsigned int a3, unsigned __int16 a4, char a5)
{
  __int64 v5; // rax@3
  char v6; // dl@3
  __int64 v7; // rcx@4

  if ( a3 > 1 )
  {
    LOBYTE(v5) = a3;
    if ( (unsigned __int8)a3 == 2 )
    {
      v5 = a2;
      *((_BYTE *)this + v5 + 176) = 0;
      *((_BYTE *)this + v5 + 304) = 0;
    }
  }
  else if ( (unsigned __int16)(a4 & 0xFFFE) != 128 && (v5 = a4, (v6 = *((_BYTE *)this + a4 + 176)) != 0) )
  {
    v7 = a2;
    *((_BYTE *)this + v7 + 176) = v6;
    LOBYTE(v5) = *((_BYTE *)this + v5 + 304);
    *((_BYTE *)this + v7 + 304) = v5;
  }
  else
  {
    v5 = a2;
    *((_BYTE *)this + v5 + 176) = a4;
    *((_BYTE *)this + v5 + 304) = a5;
  }
  return v5;
}

//----- (000000000001EF26) ----------------------------------------------------
int __fastcall IOUSBControllerV2::ConfigureDeviceZero(IOUSBControllerV2 *this, unsigned __int8 a2, unsigned __int8 a3, unsigned int a4, char a5)
{
  int result; // eax@2
  unsigned int v6; // er15@3

  if ( a4 <= 0x81 )
  {
    v6 = a3;
    IOUSBControllerV2::UpdateTopology(this, 0, a3, a4, a5);
    result = IOUSBController::ConfigureDeviceZero(this, a2, v6);
  }
  else
  {
    result = -536870911;
  }
  return result;
}

//----- (000000000001EF7C) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV2::UpdateDeviceAddress(IOUSBControllerV2 *this, unsigned __int16 a2, unsigned __int16 a3, unsigned __int8 a4, unsigned int a5, char a6)
{
  __int64 result; // rax@1
  __int64 v7; // rax@2

  result = 3758096385LL;
  if ( a5 <= 0x81 )
  {
    IOUSBControllerV2::UpdateTopology(this, a3, a4, a5, a6);
    v7 = a2;
    *((_BYTE *)this + v7 + 176) = 0;
    *((_BYTE *)this + v7 + 304) = 0;
    result = 0LL;
  }
  return result;
}

//----- (000000000001EFC8) ----------------------------------------------------
int __fastcall IOUSBControllerV2::DOHSHubMaintenance(IOUSBControllerV2 *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  *(_BYTE *)(*((_QWORD *)this + 54) + (unsigned __int16)a2) = (unsigned __int8)a4 & 1;
  return (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 2696LL))(
           this,
           (unsigned __int16)a2,
           0LL,
           (unsigned int)a3,
           (unsigned int)a4);
}

//----- (000000000001EFFE) ----------------------------------------------------
int __fastcall IOUSBControllerV2::DOSetTestMode(IOUSBControllerV2 *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  return (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 2720LL))(
           this,
           a2,
           a3,
           a4,
           a5,
           a6);
}

//----- (000000000001F010) ----------------------------------------------------
int __fastcall IOUSBControllerV2::AddHSHub(IOUSBControllerV2 *this, unsigned int a2, unsigned int a3)
{
  return (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(**((_QWORD **)this + 18) + 456LL))(
           *((_QWORD *)this + 18),
           IOUSBControllerV2::DOHSHubMaintenance,
           a2,
           1LL,
           a3,
           0LL);
}

//----- (000000000001F040) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV2::UIMHubMaintenance(IOUSBControllerV2 *this)
{
  return 3758097095LL;
}

//----- (000000000001F04C) ----------------------------------------------------
int __fastcall IOUSBControllerV2::RemoveHSHub(IOUSBControllerV2 *this, unsigned int a2)
{
  return (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(**((_QWORD **)this + 18) + 456LL))(
           *((_QWORD *)this + 18),
           IOUSBControllerV2::DOHSHubMaintenance,
           a2,
           2LL,
           0LL,
           0LL);
}

//----- (000000000001F078) ----------------------------------------------------
int __fastcall IOUSBControllerV2::SetTestMode(IOUSBControllerV2 *this, unsigned int a2, unsigned int a3)
{
  return (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(**((_QWORD **)this + 18) + 456LL))(
           *((_QWORD *)this + 18),
           IOUSBControllerV2::DOSetTestMode,
           a2,
           a3,
           0LL,
           0LL);
}

//----- (000000000001F0A6) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV2::UIMSetTestMode(IOUSBControllerV2 *this)
{
  return 3758097095LL;
}

//----- (000000000001F0B2) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV2::GetMicroFrameNumber(IOUSBControllerV2 *this)
{
  return 0LL;
}

//----- (000000000001F0BA) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV2::ReadV2(IOUSBController *this, IOMemoryDescriptor *a2, __int16 a3, __int64 a4, __int64 a5, int a6, int a7, __int64 a8)
{
  int v8; // er12@1
  __int64 v9; // r14@3
  int v10; // er15@3
  unsigned __int64 v11; // rax@3
  __int64 v12; // rdx@4
  int v13; // ecx@4
  __int64 v14; // r15@4
  int v15; // er12@8
  __int64 v16; // rax@11
  __int64 v17; // r8@11
  __int64 v18; // r9@11
  __int64 v19; // rax@12
  const OSMetaClass *v20; // rdx@12
  int v21; // ecx@12
  __int64 v22; // rax@13
  __int64 v23; // rbx@15
  __int64 v24; // rax@16
  __int64 v25; // rax@17
  __int64 v26; // r12@17
  __int64 v27; // rax@17
  __int64 v28; // rax@19
  __int64 v29; // r9@19
  __int64 v30; // rdi@19
  __int64 v31; // rax@19
  __int64 v32; // rsi@19
  __int64 v33; // ST20_8@20
  __int64 v34; // r12@20
  __int64 v35; // ST18_8@20
  int v36; // er15@20
  int v37; // ebx@20
  __int64 v38; // rbx@24
  __int64 v39; // rax@25
  __int64 v40; // rax@29
  __int64 v41; // r8@29
  __int64 v42; // r9@29
  int v43; // er14@30
  __int64 v44; // rbx@31
  __int64 v45; // r15@31
  __int64 v46; // rax@32
  char v48; // [sp+0h] [bp-C0h]@0
  int v49; // [sp+28h] [bp-98h]@14
  char v50; // [sp+2Ch] [bp-94h]@9
  __int64 v51; // [sp+38h] [bp-88h]@12
  __int16 v52; // [sp+44h] [bp-7Ch]@3
  __int64 v53; // [sp+48h] [bp-78h]@3
  char v54; // [sp+50h] [bp-70h]@33
  __int64 v55; // [sp+58h] [bp-68h]@33
  __int64 v56; // [sp+68h] [bp-58h]@23
  __int64 v57; // [sp+70h] [bp-50h]@23
  __int64 v58; // [sp+78h] [bp-48h]@23
  __int64 v59; // [sp+80h] [bp-40h]@20
  __int64 v60; // [sp+88h] [bp-38h]@20
  __int64 v61; // [sp+90h] [bp-30h]@20

  v8 = -536870206;
  if ( *(_BYTE *)(a4 + 9) == 1 )
  {
    if ( a2 )
    {
      v53 = a4;
      v9 = a5;
      v52 = a3;
      v10 = a6;
      LODWORD(v11) = (*(int (__fastcall **)(IOMemoryDescriptor *))(*(_QWORD *)a2 + 456LL))(a2);
      if ( v11 >= a8 )
      {
        v12 = (unsigned int)a7;
        v13 = v10;
        v14 = v9;
        if ( *(_BYTE *)(v53 + 10) == 2 || !(v13 | a7) )
        {
          v8 = -536870166;
          if ( v9 )
          {
            v8 = -536870199;
            if ( *((_QWORD *)this + 18) )
            {
              v15 = v13;
              if ( *(_QWORD (__cdecl **)(void *, void *, int, unsigned int))(v9 + 8) == off_3B000 )
              {
                v50 = 1;
                if ( (unsigned __int8)(*(int (__fastcall **)(_QWORD, IOMemoryDescriptor *, _QWORD))(**((_QWORD **)this + 17)
                                                                                                  + 304LL))(
                                        *((_QWORD *)this + 17),
                                        a2,
                                        (unsigned int)a7) )
                {
                  LODWORD(v16) = (*(int (__fastcall **)(IOUSBController *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
                  KernelDebugLogInternal(
                    1u,
                    0x55534246u,
                    (__int64)"IOUSBControllerV2(%s)::DoIOTransfer sync request on workloop thread.  Use async!",
                    v16,
                    v17,
                    v18,
                    v48);
                  v8 = -536854454;
                  return (unsigned int)v8;
                }
              }
              else
              {
                v50 = 0;
              }
              LODWORD(v19) = (*(int (__fastcall **)(_QWORD, _QWORD, __int64))(***((_QWORD ***)this + 21) + 296LL))(
                               **((_QWORD **)this + 21),
                               0LL,
                               v12);
              v51 = v19;
              v21 = v15;
              if ( v19
                || (IOUSBController::IncreaseCommandPool(this, 0LL, v20),
                    LODWORD(v22) = (*(int (__fastcall **)(_QWORD, _QWORD))(***((_QWORD ***)this + 21) + 296LL))(
                                     **((_QWORD **)this + 21),
                                     0LL),
                    v21 = v15,
                    v14 = v9,
                    v51 = v22,
                    v8 = -536870210,
                    v22) )
              {
                v49 = v21;
                if ( a8 )
                {
                  v23 = *(_QWORD *)(*(_QWORD *)(v51 + 216) + 48LL);
                  if ( !v23 )
                  {
                    LODWORD(v40) = (*(int (__fastcall **)(IOUSBController *, _QWORD))(*(_QWORD *)this + 904LL))(
                                     this,
                                     0LL);
                    KernelDebugLogInternal(1u, 0x55534246u, (__int64)"%s::ReadV2 - no DMA COMMAND", v40, v41, v42, v48);
                    v8 = -536870210;
                    return (unsigned int)v8;
                  }
                  LODWORD(v24) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v23 + 312LL))(v23);
                  if ( v24 )
                  {
                    LODWORD(v25) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v23 + 312LL))(v23);
                    v26 = v25;
                    LODWORD(v27) = (*(int (__fastcall **)(IOUSBController *, _QWORD))(*(_QWORD *)this + 904LL))(
                                     this,
                                     0LL);
                    KernelDebugLogInternal(
                      1u,
                      0x55534246u,
                      (__int64)"%s::ReadV2 - dma command (%p) already contains memory descriptor (%p) - clearing",
                      v27,
                      v23,
                      v26,
                      v48);
                    (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v23 + 304LL))(v23, 1LL);
                  }
                  v8 = (*(int (__fastcall **)(__int64, IOMemoryDescriptor *, signed __int64))(*(_QWORD *)v23 + 296LL))(
                         v23,
                         a2,
                         1LL);
                  if ( v8 )
                  {
                    LODWORD(v28) = (*(int (__fastcall **)(IOUSBController *, _QWORD))(*(_QWORD *)this + 904LL))(
                                     this,
                                     0LL);
                    KernelDebugLogInternal(
                      1u,
                      0x55534246u,
                      (__int64)"%s::ReadV2 - err(0x%x) attempting to set the memory descriptor to the dmaCommand",
                      v28,
                      (unsigned int)v8,
                      v29,
                      v48);
                    v30 = **((_QWORD **)this + 21);
                    v31 = *(_QWORD *)v30;
                    v32 = v51;
LABEL_28:
                    (*(void (__fastcall **)(__int64, __int64))(v31 + 304))(v30, v32);
                    return (unsigned int)v8;
                  }
                }
                v33 = *(_QWORD *)v14;
                v34 = *(_QWORD *)(v14 + 8);
                v35 = *(_QWORD *)(v14 + 16);
                IOUSBCommand::SetIsSyncTransfer((IOUSBCommand *)v51, v50);
                IOUSBCommand::SetUseTimeStamp((IOUSBCommand *)v51, 1);
                IOUSBCommand::SetSelector(v51, 1);
                v36 = 0;
                IOUSBCommand::SetRequest(v51, 0LL);
                IOUSBCommand::SetAddress((IOUSBCommand *)v51, v52);
                IOUSBCommand::SetEndpoint((IOUSBCommand *)v51, *(_BYTE *)(v53 + 8));
                *(_DWORD *)(*(_QWORD *)(v51 + 216) + 72LL) = 0;
                IOUSBCommand::SetDirection((IOUSBCommand *)v51, 1);
                IOUSBCommand::SetType((IOUSBCommand *)v51, *(_BYTE *)(v53 + 10));
                IOUSBCommand::SetBuffer((IOUSBCommand *)v51, a2);
                IOUSBCommand::SetReqCount((IOUSBCommand *)v51, a8);
                v60 = v34;
                v59 = v33;
                v61 = v35;
                IOUSBCommand::SetClientCompletion(v51, v33, v34, v35);
                IOUSBCommand::SetNoDataTimeout((IOUSBCommand *)v51, v49);
                IOUSBCommand::SetCompletionTimeout((IOUSBCommand *)v51, a7);
                IOUSBCommand::SetMultiTransferTransaction((IOUSBCommand *)v51, 0);
                IOUSBCommand::SetFinalTransferInTransaction((IOUSBCommand *)v51, 0);
                v37 = 0;
                do
                  IOUSBCommand::SetUIMScratch((IOUSBCommand *)v51, v37++, 0);
                while ( v37 != 10 );
                do
                  IOUSBCommand::SetUIMScratch64((IOUSBCommand *)v51, v36++, 0LL);
                while ( v36 != 5 );
                v56 = 0LL;
                v57 = 0LL;
                v58 = 0LL;
                IOUSBCommand::SetDisjointCompletion(v51, 0LL, 0LL, 0LL);
                v8 = (*(int (__fastcall **)(IOUSBController *, __int64, _QWORD))(*(_QWORD *)this + 2616LL))(
                       this,
                       v51,
                       *(_WORD *)(v53 + 12));
                if ( v8 )
                {
                  v38 = *(_QWORD *)(*(_QWORD *)(v51 + 216) + 48LL);
                  if ( v38 )
                  {
                    LODWORD(v39) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v38 + 312LL))(v38);
                    if ( v39 )
                      (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v38 + 304LL))(v38, 1LL);
                  }
                  v30 = **((_QWORD **)this + 21);
                  v31 = *(_QWORD *)v30;
                  v32 = v51;
                  goto LABEL_28;
                }
                v8 = 0;
                v43 = (*(int (__fastcall **)(_QWORD, __int64 (__fastcall *)(uintptr_t, OSObject *, void *, void *, void *, void *), __int64, _QWORD, _QWORD, _QWORD))(**((_QWORD **)this + 18) + 456LL))(
                        *((_QWORD *)this + 18),
                        IOUSBController::DoIOTransfer,
                        v51,
                        0LL,
                        0LL,
                        0LL);
                if ( (v43 != 0) | (unsigned __int8)v50 )
                {
                  v44 = *(_QWORD *)(*(_QWORD *)(v51 + 216) + 48LL);
                  v45 = 0LL;
                  if ( v44 )
                  {
                    LODWORD(v46) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v44 + 312LL))(v44);
                    v45 = v46;
                  }
                  IOUSBCommand::GetDisjointCompletion((IOUSBCommand *)&v54, v51);
                  if ( v55 && gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
                    kernel_debug(0x52D0024u, (uintptr_t)this, v43, 0LL, 1uLL, 0LL);
                  if ( v45 )
                    (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v44 + 304LL))(v44, 1LL);
                  (*(void (__fastcall **)(_QWORD, __int64))(***((_QWORD ***)this + 21) + 304LL))(
                    **((_QWORD **)this + 21),
                    v51);
                  v8 = v43;
                }
              }
            }
          }
        }
      }
    }
  }
  return (unsigned int)v8;
}
// 3B000: using guessed type _QWORD (__cdecl *off_3B000)(void *, void *, int, unsigned int);
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (000000000001F64A) ----------------------------------------------------
int __usercall IOUSBControllerV2::UIMCreateIsochEndpoint@<eax>(IOUSBControllerV2 *this@<rdi>, int a2, unsigned __int8 a3)
{
  return (*(int (**)(void))(*(_QWORD *)this + 2680LL))();
}

//----- (000000000001F65C) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV2::AllocateIsochEP(IOUSBControllerV2 *this, __int64 a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  char savedregs; // [sp+0h] [bp+0h]@0

  KernelDebugLogInternal(
    1u,
    0x55534246u,
    (__int64)"IOUSBControllerV2::AllocateIsochEP - should be overriden in a subclass",
    a4,
    a5,
    a6,
    savedregs);
  return 0LL;
}

//----- (000000000001F67C) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV2::DeallocateIsochEP(IOUSBControllerV2 *this, IOUSBControllerIsochEndpoint *a2)
{
  __int64 v2; // rax@1

  v2 = *((_QWORD *)this + 54);
  *((_QWORD *)a2 + 2) = *(_QWORD *)(v2 + 144);
  *(_QWORD *)(v2 + 144) = a2;
  return 0LL;
}

//----- (000000000001F69E) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV2::FindIsochronousEndpoint(IOUSBControllerV2 *this, int a2, unsigned __int16 a3, __int16 a4, IOUSBControllerIsochEndpoint **a5)
{
  __int64 v5; // rdi@1
  __int64 result; // rax@1
  int v7; // er9@2
  int v8; // er10@2
  IOUSBControllerIsochEndpoint *v9; // rdx@2
  IOUSBControllerIsochEndpoint *v10; // rcx@3

  v5 = *(_QWORD *)(*((_QWORD *)this + 54) + 136LL);
  result = 0LL;
  if ( v5 )
  {
    v7 = a4;
    result = 0LL;
    a2 = (unsigned __int16)a2;
    v8 = a3;
    v9 = 0LL;
    while ( 1 )
    {
      v10 = v9;
      v9 = (IOUSBControllerIsochEndpoint *)v5;
      if ( *(_WORD *)(v5 + 114) == a2 && *(_WORD *)(v5 + 116) == v8 && *(_BYTE *)(v5 + 128) == v7 )
        break;
      v5 = *(_QWORD *)(v5 + 16);
      if ( !v5 )
        return result;
    }
    if ( a5 )
      *a5 = v10;
    result = v5;
  }
  return result;
}

//----- (000000000001F702) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV2::CreateIsochronousEndpoint(IOUSBControllerV2 *this, __int16 a2, __int16 a3, char a4)
{
  char v4; // r14@1
  __int16 v5; // r15@1
  __int64 v6; // rcx@1
  __int64 v7; // rbx@1
  __int64 v8; // rax@2
  __int64 v9; // rax@4

  v4 = a4;
  v5 = a3;
  v6 = *((_QWORD *)this + 54);
  v7 = *(_QWORD *)(v6 + 144);
  if ( v7 )
    goto LABEL_4;
  LODWORD(v8) = (*(int (__cdecl **)(IOUSBControllerV2 *))(*(_QWORD *)this + 2760LL))(this);
  v7 = 0LL;
  if ( v8 )
  {
    v6 = *((_QWORD *)this + 54);
    v7 = v8;
LABEL_4:
    *(_QWORD *)(v6 + 144) = *(_QWORD *)(v7 + 16);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v7 + 136LL))(v7);
    v9 = *((_QWORD *)this + 54);
    *(_QWORD *)(v7 + 16) = *(_QWORD *)(v9 + 136);
    *(_QWORD *)(v9 + 136) = v7;
    *(_WORD *)(v7 + 114) = a2;
    *(_WORD *)(v7 + 116) = v5;
    *(_BYTE *)(v7 + 128) = v4;
  }
  return v7;
}

//----- (000000000001F7A0) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV2::PutTDonToDoList(IOUSBControllerV2 *this, IOUSBControllerIsochEndpoint *a2, IOUSBControllerIsochListElement *a3)
{
  __int64 result; // rax@2

  if ( *((_QWORD *)a2 + 3) )
  {
    result = *((_QWORD *)a2 + 4);
    *(_QWORD *)(result + 32) = a3;
  }
  else
  {
    *((_QWORD *)a2 + 3) = a3;
  }
  *((_QWORD *)a2 + 4) = a3;
  ++*((_DWORD *)a2 + 22);
  ++*((_DWORD *)a2 + 21);
  return result;
}

//----- (000000000001F7C6) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV2::GetTDfromToDoList(IOUSBControllerV2 *this, IOUSBControllerIsochEndpoint *a2, const OSMetaClass *a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rax@3

  v3 = *((_QWORD *)a2 + 3);
  if ( v3 )
  {
    if ( v3 == *((_QWORD *)a2 + 4) )
    {
      *((_QWORD *)a2 + 4) = 0LL;
      v4 = 0LL;
    }
    else
    {
      v4 = OSMetaClassBase::safeMetaCast(
             *(OSMetaClassBase **)(v3 + 32),
             (const OSMetaClassBase *)IOUSBControllerIsochListElement::metaClass,
             a3);
    }
    *((_QWORD *)a2 + 3) = v4;
    --*((_DWORD *)a2 + 22);
  }
  return v3;
}
// 42898: using guessed type _QWORD IOUSBControllerIsochListElement::metaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000001F80E) ----------------------------------------------------
void __fastcall IOUSBControllerV2::PutTDonDoneQueue(uintptr_t arg1, uintptr_t arg2, uintptr_t arg3, unsigned __int8 a4)
{
  unsigned __int8 v4; // bl@1
  uintptr_t v5; // r12@1
  unsigned __int8 v6; // al@2
  __int64 v7; // rax@4
  __int64 v8; // rdx@6
  __int64 i; // rcx@6
  __int64 v10; // rax@12
  uintptr_t v11; // rax@14
  uintptr_t v12; // rbx@14
  __int64 v13; // rax@26
  unsigned __int8 v14; // [sp+0h] [bp-2Ch]@10

  v4 = a4;
  v5 = arg3;
  if ( gUSBStackDebugFlags & 2 )
  {
    v6 = (*(int (__cdecl **)(_QWORD))(**(_QWORD **)(arg1 + 136) + 312LL))(*(_QWORD *)(arg1 + 136));
    if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D00A5u, arg1, arg2, v5, v4 | ((unsigned __int64)v6 << 8), 0LL);
  }
  v7 = *(_QWORD *)(arg2 + 40);
  if ( v7 && !*(_QWORD *)(arg2 + 48) )
  {
    v8 = *(_QWORD *)(v7 + 32);
    for ( i = *(_QWORD *)(arg2 + 40); v8; v8 = *(_QWORD *)(v8 + 32) )
      i = v8;
    *(_QWORD *)(arg2 + 48) = i;
  }
  if ( v4 )
  {
    v14 = v4;
    while ( 1 )
    {
      v10 = *(_QWORD *)(arg2 + 56);
      if ( !v10 || *(_QWORD *)(v10 + 88) >= *(_QWORD *)(v5 + 88) )
        break;
      LODWORD(v11) = (*(int (__fastcall **)(uintptr_t, uintptr_t))(*(_QWORD *)arg1 + 2816LL))(arg1, arg2);
      v12 = v11;
      if ( gUSBStackDebugFlags & 2 )
      {
        if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          kernel_debug(0x52D00A4u, arg1, v11, 0LL, 0LL, 0LL);
      }
      (*(void (__fastcall **)(uintptr_t, uintptr_t, uintptr_t, _QWORD))(*(_QWORD *)arg1 + 2824LL))(arg1, arg2, v12, 0LL);
    }
    v7 = *(_QWORD *)(arg2 + 40);
    v4 = v14;
  }
  if ( v7 )
    *(_QWORD *)(*(_QWORD *)(arg2 + 48) + 32LL) = v5;
  else
    *(_QWORD *)(arg2 + 40) = v5;
  *(_QWORD *)(arg2 + 48) = v5;
  ++*(_DWORD *)(arg2 + 92);
  if ( v4 && !*(_DWORD *)(arg2 + 96) && !*(_QWORD *)(arg2 + 24) )
  {
    while ( 1 )
    {
      LODWORD(v13) = (*(int (__fastcall **)(uintptr_t, uintptr_t))(*(_QWORD *)arg1 + 2816LL))(arg1, arg2);
      if ( !v13 )
        break;
      (*(void (__fastcall **)(uintptr_t, uintptr_t, __int64, _QWORD))(*(_QWORD *)arg1 + 2824LL))(arg1, arg2, v13, 0LL);
    }
  }
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D00A6u, arg1, 0LL, 0LL, 0LL, 0LL);
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (000000000001F9C0) ----------------------------------------------------
int __fastcall IOUSBControllerV2::GetTDfromDoneQueue(IOUSBControllerV2 *this, IOUSBControllerIsochEndpoint *a2, const OSMetaClass *a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rax@3
  int result; // eax@4

  v3 = *((_QWORD *)a2 + 5);
  if ( v3 )
  {
    if ( v3 == *((_QWORD *)a2 + 6) )
    {
      *((_QWORD *)a2 + 6) = 0LL;
      v4 = 0LL;
    }
    else
    {
      v4 = OSMetaClassBase::safeMetaCast(
             *(OSMetaClassBase **)(v3 + 32),
             (const OSMetaClassBase *)IOUSBControllerIsochListElement::metaClass,
             a3);
    }
    *((_QWORD *)a2 + 5) = v4;
    --*((_DWORD *)a2 + 23);
    --*((_DWORD *)a2 + 21);
    result = v3;
  }
  else
  {
    result = (*(int (**)(void))(*(_QWORD *)this + 2816LL))();
  }
  return result;
}
// 42898: using guessed type _QWORD IOUSBControllerIsochListElement::metaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000001FA1E) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV2::GatedGetTDfromDoneQueue(IOUSBControllerV2 *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  void *v6; // rbx@1
  __int64 result; // rax@1
  __int64 v8; // rax@3

  v6 = a3;
  result = 3758097097LL;
  if ( this )
  {
    if ( a2 )
    {
      LODWORD(v8) = (*(int (__fastcall **)(IOUSBControllerV2 *, OSObject *, void *, void *, void *, void *))(*(_QWORD *)this + 2832LL))(
                      this,
                      a2,
                      a3,
                      a4,
                      a5,
                      a6);
      *(_QWORD *)v6 = v8;
      result = 0LL;
    }
  }
  return result;
}

//----- (000000000001FA4C) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV2::PutTDonDeferredQueue(IOUSBControllerV2 *this, IOUSBControllerIsochEndpoint *a2, IOUSBControllerIsochListElement *a3)
{
  __int64 result; // rax@2

  if ( *((_QWORD *)a2 + 7) )
  {
    result = *((_QWORD *)a2 + 8);
    *(_QWORD *)(result + 32) = a3;
  }
  else
  {
    *((_QWORD *)a2 + 7) = a3;
  }
  *((_QWORD *)a2 + 8) = a3;
  ++*((_DWORD *)a2 + 25);
  return result;
}

//----- (000000000001FA6E) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV2::GetTDfromDeferredQueue(IOUSBControllerV2 *this, IOUSBControllerIsochEndpoint *a2, const OSMetaClass *a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rax@3

  v3 = *((_QWORD *)a2 + 7);
  if ( v3 )
  {
    if ( v3 == *((_QWORD *)a2 + 8) )
    {
      *((_QWORD *)a2 + 8) = 0LL;
      v4 = 0LL;
    }
    else
    {
      v4 = OSMetaClassBase::safeMetaCast(
             *(OSMetaClassBase **)(v3 + 32),
             (const OSMetaClassBase *)IOUSBControllerIsochListElement::metaClass,
             a3);
    }
    *((_QWORD *)a2 + 7) = v4;
    --*((_DWORD *)a2 + 25);
  }
  return v3;
}
// 42898: using guessed type _QWORD IOUSBControllerIsochListElement::metaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000001FAB6) ----------------------------------------------------
void __fastcall IOUSBControllerV2::ReturnIsochDoneQueue(IOUSBControllerV2 *this, uintptr_t arg2)
{
  uintptr_t v2; // rbx@1
  uintptr_t v3; // r14@1
  uintptr_t v4; // rax@4
  uintptr_t v5; // rdi@6
  uintptr_t v6; // r12@9
  uintptr_t v7; // rsi@10
  int v8; // eax@10
  int v9; // ecx@10
  int v10; // er15@10
  int v11; // edx@10
  __int64 v12; // rax@26
  int v13; // edx@26
  __int64 v14; // [sp+8h] [bp-38h]@4
  uintptr_t arg3; // [sp+10h] [bp-30h]@1

  v2 = arg2;
  v3 = (uintptr_t)this;
  arg3 = 0LL;
  (*(void (__fastcall **)(_QWORD, __int64 (__fastcall *)(IOUSBControllerV2 *__hidden, OSObject *, void *, void *, void *, void *), uintptr_t, uintptr_t *, _QWORD, _QWORD))(**((_QWORD **)this + 18) + 456LL))(
    *((_QWORD *)this + 18),
    IOUSBControllerV2::GatedGetTDfromDoneQueue,
    arg2,
    &arg3,
    0LL,
    0LL);
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D0029u, (uintptr_t)this, arg2, arg3, *(_DWORD *)(arg2 + 120), 0LL);
  v4 = 0LL;
  v14 = 0LL;
  if ( arg3 )
  {
    v14 = *(_QWORD *)(arg3 + 48);
    v4 = arg3;
  }
LABEL_6:
  v5 = v4;
  while ( v5 )
  {
    v6 = *(_QWORD *)(v5 + 64);
    if ( v6 )
    {
      v7 = *(_DWORD *)(*(_QWORD *)(v3 + 168) + 28LL);
      v8 = *(_WORD *)(v2 + 114);
      v9 = *(_WORD *)(v2 + 116);
      v10 = v9 | (*(_DWORD *)(*(_QWORD *)(v3 + 168) + 28LL) << 16) | (v8 << 8);
      *(_QWORD *)(v5 + 64) = 0LL;
      v11 = *(_DWORD *)(v2 + 120);
      if ( v11 == -536854515 )
      {
        if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
          goto LABEL_23;
        kernel_debug(0x52D0028u, v7, v8, v9, 1uLL, 0LL);
        v11 = *(_DWORD *)(v2 + 120);
      }
      if ( v11 != -536854516 )
        goto LABEL_18;
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        kernel_debug(
          0x52D0028u,
          *(_DWORD *)(*(_QWORD *)(v3 + 168) + 28LL),
          *(_WORD *)(v2 + 114),
          *(_WORD *)(v2 + 116),
          2uLL,
          0LL);
        v11 = *(_DWORD *)(v2 + 120);
LABEL_18:
        if ( v11 == -536870168
          && *(_BYTE *)(v2 + 128) == 1
          && gUSBStackDebugFlags & 2
          && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          kernel_debug(
            0x52D0028u,
            *(_DWORD *)(*(_QWORD *)(v3 + 168) + 28LL),
            *(_WORD *)(v2 + 114),
            *(_WORD *)(v2 + 116),
            3uLL,
            0LL);
      }
LABEL_23:
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D0028u, (unsigned int)v10, v6, *(_DWORD *)(v2 + 120), 5uLL, 0LL);
      ((void (__fastcall *)(_QWORD, _QWORD, _QWORD, __int64))v6)(
        *(_QWORD *)(arg3 + 56),
        *(_QWORD *)(arg3 + 72),
        *(_DWORD *)(v2 + 120),
        v14);
      v12 = *(_QWORD *)(v3 + 168);
      v13 = *(_DWORD *)(v12 + 188);
      *(_DWORD *)(v12 + 188) = v13 - 1;
      if ( v13 <= 0 )
      {
        if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          kernel_debug(0x52D0028u, *(_DWORD *)(v12 + 28), *(_WORD *)(v2 + 114), *(_WORD *)(v2 + 116), 4uLL, 0LL);
      }
      else if ( v13 == 1 )
      {
        if ( *(_DWORD *)(v12 + 204) )
        {
          IOService::requireMaxBusStall((IOService *)v3, 0);
          if ( OSMetaClassBase::metaCast((OSMetaClassBase *)v3, "AppleUSBUHCI") )
            IOService::requireMaxInterruptDelay((IOService *)v3, 0);
        }
      }
      if ( *(_DWORD *)(v2 + 120) != -536870165 )
        *(_DWORD *)(v2 + 120) = 0;
      (*(void (__fastcall **)(uintptr_t, uintptr_t))(*(_QWORD *)arg3 + 320LL))(arg3, v3);
      arg3 = 0LL;
      (*(void (__fastcall **)(_QWORD, __int64 (__fastcall *)(IOUSBControllerV2 *__hidden, OSObject *, void *, void *, void *, void *), uintptr_t, uintptr_t *, _QWORD, _QWORD))(**(_QWORD **)(v3 + 144) + 456LL))(
        *(_QWORD *)(v3 + 144),
        IOUSBControllerV2::GatedGetTDfromDoneQueue,
        v2,
        &arg3,
        0LL,
        0LL);
      v4 = arg3;
      v5 = 0LL;
      if ( arg3 )
      {
        v14 = *(_QWORD *)(arg3 + 48);
        goto LABEL_6;
      }
    }
    else
    {
      (*(void (__fastcall **)(uintptr_t, uintptr_t))(*(_QWORD *)v5 + 320LL))(v5, v3);
      arg3 = 0LL;
      (*(void (__fastcall **)(_QWORD, __int64 (__fastcall *)(IOUSBControllerV2 *__hidden, OSObject *, void *, void *, void *, void *), uintptr_t, uintptr_t *, _QWORD, _QWORD))(**(_QWORD **)(v3 + 144) + 456LL))(
        *(_QWORD *)(v3 + 144),
        IOUSBControllerV2::GatedGetTDfromDoneQueue,
        v2,
        &arg3,
        0LL,
        0LL);
      v5 = arg3;
    }
  }
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D002Au, v3, 0LL, 0LL, 0LL, 0LL);
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (000000000001FE2A) ----------------------------------------------------
int __fastcall IOUSBControllerV2::GetNewDMACommand(IOUSBControllerV2 *this)
{
  return IODMACommand::withSpecification(off_3B028[0], 32LL, 0LL, 0LL, 0LL, 1LL);
}
// 3B028: using guessed type __int64 *off_3B028[6];
// 7D420: using guessed type int __fastcall IODMACommand::withSpecification(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000001FE68) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV2::GetLowLatencyOptionsAndPhysicalMask(IOUSBControllerV2 *this, unsigned int *a2, unsigned __int64 *a3)
{
  *a2 = 0;
  *a3 = 4294963200LL;
  return 0LL;
}

//----- (000000000001FE7E) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV2::GetFrameNumberWithTime(IOUSBControllerV2 *this, unsigned __int64 *a2, unsigned __int64 *a3)
{
  return 3758097095LL;
}

//----- (000000000001FE8A) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV2::ReadStream(IOUSBController *this, __int64 a2, IOMemoryDescriptor *a3, __int16 a4, __int64 a5, __int64 a6, int a7, int a8, __int64 a9)
{
  __int64 v9; // r12@1
  __int64 v10; // r13@1
  IOMemoryDescriptor *v11; // r14@1
  signed int v12; // ebx@1
  unsigned __int64 v13; // rax@3
  __int64 v14; // rdx@3
  __int64 v15; // rcx@4
  char v16; // al@13
  __int64 v17; // rax@14
  __int64 v18; // r8@14
  __int64 v19; // r9@14
  __int64 v20; // rax@15
  const OSMetaClass *v21; // rdx@15
  __int64 v22; // rax@16
  int v23; // er15@17
  uintptr_t v24; // rbx@17
  uintptr_t v25; // rax@19
  int v26; // ecx@24
  IOUSBController *v27; // r14@26
  int v28; // er15@26
  __int64 v29; // rax@28
  int v30; // ebx@29
  __int64 v31; // rbx@35
  __int64 v32; // rax@39
  char v34; // [sp+0h] [bp-B0h]@0
  uintptr_t v35; // [sp+18h] [bp-98h]@25
  char v36; // [sp+2Ch] [bp-84h]@9
  __int64 v37; // [sp+30h] [bp-80h]@15
  __int16 v38; // [sp+38h] [bp-78h]@3
  char v39; // [sp+40h] [bp-70h]@43
  __int64 v40; // [sp+58h] [bp-58h]@31
  __int64 v41; // [sp+60h] [bp-50h]@31
  __int64 v42; // [sp+68h] [bp-48h]@31
  __int64 v43; // [sp+70h] [bp-40h]@28
  __int64 v44; // [sp+78h] [bp-38h]@28
  __int64 v45; // [sp+80h] [bp-30h]@28

  v9 = a6;
  v10 = a5;
  v11 = a3;
  v12 = -536870206;
  if ( *(_BYTE *)(a5 + 9) == 1 )
  {
    if ( a3 )
    {
      v38 = a4;
      LODWORD(v13) = (*(int (__fastcall **)(IOMemoryDescriptor *))(*(_QWORD *)a3 + 456LL))(a3);
      if ( v13 >= a9 )
      {
        v15 = (unsigned int)a8;
        if ( *(_BYTE *)(v10 + 10) == 2 || !(a7 | a8) )
        {
          v12 = -536870166;
          if ( v9 )
          {
            if ( *((_QWORD *)this + 18) )
            {
              if ( *(_QWORD (__cdecl **)(void *, void *, int, unsigned int))(v9 + 8) == off_3B000 )
              {
                v16 = (*(int (__fastcall **)(_QWORD, __int64, __int64, _QWORD))(**((_QWORD **)this + 17) + 304LL))(
                        *((_QWORD *)this + 17),
                        a2,
                        v14,
                        (unsigned int)a8);
                LOBYTE(v15) = 1;
                v36 = 1;
                if ( v16 )
                {
                  LODWORD(v17) = (*(int (__fastcall **)(IOUSBController *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
                  KernelDebugLogInternal(
                    1u,
                    0x55534246u,
                    (__int64)"IOUSBController(%s)::Read sync request on workloop thread.  Use async!",
                    v17,
                    v18,
                    v19,
                    v34);
                  v12 = -536854454;
                  return (unsigned int)v12;
                }
              }
              else
              {
                v36 = 0;
              }
              LODWORD(v20) = (*(int (__fastcall **)(_QWORD, _QWORD, __int64, __int64))(***((_QWORD ***)this + 21) + 296LL))(
                               **((_QWORD **)this + 21),
                               0LL,
                               v14,
                               v15);
              v37 = v20;
              if ( v20
                || (IOUSBController::IncreaseCommandPool(this, 0LL, v21),
                    LODWORD(v22) = (*(int (__fastcall **)(_QWORD, _QWORD))(***((_QWORD ***)this + 21) + 296LL))(
                                     **((_QWORD **)this + 21),
                                     0LL),
                    v37 = v22,
                    v12 = -536870210,
                    v22) )
              {
                v23 = 0;
                v24 = 0LL;
                if ( a9 )
                {
                  v24 = *(_QWORD *)(*(_QWORD *)(v37 + 216) + 48LL);
                  if ( !v24 )
                  {
                    v28 = -536870210;
                    if ( gUSBStackDebugFlags & 2 )
                    {
                      v27 = this;
                      v31 = v37;
                      if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
                        kernel_debug(0x52D004Cu, (uintptr_t)this, 0xFFFFFFFFE00002BELL, 0LL, 2uLL, 0LL);
                      goto LABEL_43;
                    }
                    v27 = this;
                    goto LABEL_42;
                  }
                  LODWORD(v25) = (*(int (__fastcall **)(uintptr_t))(*(_QWORD *)v24 + 312LL))(v24);
                  if ( v25 )
                  {
                    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
                      kernel_debug(0x52D004Cu, (uintptr_t)this, v24, v25, 3uLL, 0LL);
                    (*(void (__fastcall **)(uintptr_t, signed __int64))(*(_QWORD *)v24 + 304LL))(v24, 1LL);
                  }
                  v26 = (*(int (__fastcall **)(uintptr_t, IOMemoryDescriptor *, signed __int64))(*(_QWORD *)v24 + 296LL))(
                          v24,
                          v11,
                          1LL);
                  if ( v26 )
                  {
                    v35 = v24;
                    if ( gUSBStackDebugFlags & 2 )
                    {
                      v27 = this;
                      v28 = v26;
                      if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
                        kernel_debug(0x52D004Cu, (uintptr_t)this, v26, 0LL, 5uLL, 0LL);
                    }
                    else
                    {
                      v27 = this;
                      v28 = v26;
                    }
LABEL_38:
                    if ( v35 )
                    {
                      LODWORD(v32) = (*(int (__fastcall **)(uintptr_t))(*(_QWORD *)v35 + 312LL))(v35);
                      v31 = v37;
                      if ( v32 )
                        (*(void (__fastcall **)(uintptr_t, signed __int64))(*(_QWORD *)v35 + 304LL))(v35, 1LL);
                      goto LABEL_43;
                    }
LABEL_42:
                    v31 = v37;
LABEL_43:
                    IOUSBCommand::GetDisjointCompletion((IOUSBCommand *)&v39, v31);
                    (*(void (__fastcall **)(_QWORD, __int64))(***((_QWORD ***)v27 + 21) + 304LL))(
                      **((_QWORD **)v27 + 21),
                      v31);
                    v12 = v28;
                    return (unsigned int)v12;
                  }
                }
                v35 = v24;
                IOUSBCommand::SetIsSyncTransfer((IOUSBCommand *)v37, v36);
                IOUSBCommand::SetUseTimeStamp((IOUSBCommand *)v37, 0);
                IOUSBCommand::SetSelector(v37, 1);
                IOUSBCommand::SetRequest(v37, 0LL);
                IOUSBCommand::SetAddress((IOUSBCommand *)v37, v38);
                IOUSBCommand::SetEndpoint((IOUSBCommand *)v37, *(_BYTE *)(v10 + 8));
                IOUSBCommand::SetDirection((IOUSBCommand *)v37, 1);
                IOUSBCommand::SetType((IOUSBCommand *)v37, *(_BYTE *)(v10 + 10));
                IOUSBCommand::SetBuffer((IOUSBCommand *)v37, v11);
                IOUSBCommand::SetReqCount((IOUSBCommand *)v37, a9);
                v45 = *(_QWORD *)(v9 + 16);
                v29 = *(_QWORD *)v9;
                v44 = *(_QWORD *)(v9 + 8);
                v43 = v29;
                IOUSBCommand::SetClientCompletion(v37, v29, v44, v45);
                IOUSBCommand::SetNoDataTimeout((IOUSBCommand *)v37, a7);
                IOUSBCommand::SetCompletionTimeout((IOUSBCommand *)v37, a8);
                IOUSBCommand::SetMultiTransferTransaction((IOUSBCommand *)v37, 0);
                IOUSBCommand::SetFinalTransferInTransaction((IOUSBCommand *)v37, 0);
                *(_DWORD *)(*(_QWORD *)(v37 + 216) + 72LL) = a2;
                do
                {
                  v30 = 0;
                  IOUSBCommand::SetUIMScratch((IOUSBCommand *)v37, v23++, 0);
                }
                while ( v23 != 10 );
                do
                  IOUSBCommand::SetUIMScratch64((IOUSBCommand *)v37, v30++, 0LL);
                while ( v30 != 5 );
                v40 = 0LL;
                v41 = 0LL;
                v42 = 0LL;
                IOUSBCommand::SetDisjointCompletion(v37, 0LL, 0LL, 0LL);
                v27 = this;
                v28 = (*(int (__fastcall **)(IOUSBController *, __int64, _QWORD))(*(_QWORD *)this + 2616LL))(
                        this,
                        v37,
                        *(_WORD *)(v10 + 12));
                if ( v28 )
                  goto LABEL_38;
                v12 = 0;
                v28 = (*(int (__fastcall **)(_QWORD, __int64 (__fastcall *)(uintptr_t, OSObject *, void *, void *, void *, void *), __int64, _QWORD, _QWORD, _QWORD))(**((_QWORD **)this + 18) + 456LL))(
                        *((_QWORD *)this + 18),
                        IOUSBController::DoIOTransfer,
                        v37,
                        0LL,
                        0LL,
                        0LL);
                if ( (v28 != 0) | (unsigned __int8)v36 )
                  goto LABEL_38;
              }
            }
            else
            {
              v12 = -536870199;
              if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
                kernel_debug(0x52D004Cu, (uintptr_t)this, 0xFFFFFFFFE00002C9LL, 0LL, 1uLL, 0LL);
            }
          }
        }
      }
    }
  }
  return (unsigned int)v12;
}
// 3B000: using guessed type _QWORD (__cdecl *off_3B000)(void *, void *, int, unsigned int);
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (00000000000203AC) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV2::WriteStream(IOUSBController *this, __int64 a2, IOMemoryDescriptor *a3, __int16 a4, __int64 a5, __int64 a6, int a7, int a8, __int64 a9)
{
  IOMemoryDescriptor *v9; // r14@1
  signed int v10; // er15@1
  __int64 v11; // r13@3
  unsigned __int64 v12; // rax@3
  __int64 v13; // rdx@3
  __int64 v14; // rcx@4
  char v15; // al@9
  __int64 v16; // rax@10
  __int64 v17; // r8@10
  __int64 v18; // r9@10
  __int64 v19; // rax@11
  const OSMetaClass *v20; // rdx@11
  int v21; // er12@13
  uintptr_t v22; // rbx@13
  __int64 v23; // r15@13
  uintptr_t v24; // rax@15
  int v25; // er13@20
  __int64 v26; // r12@22
  IOUSBController *v27; // r14@22
  __int64 v28; // rax@24
  int v29; // ebx@25
  __int64 v30; // rdx@27
  __int64 v31; // rax@36
  char v33; // [sp+0h] [bp-C0h]@0
  uintptr_t v34; // [sp+20h] [bp-A0h]@21
  __int64 v35; // [sp+28h] [bp-98h]@8
  char v36; // [sp+3Ch] [bp-84h]@8
  __int16 v37; // [sp+44h] [bp-7Ch]@3
  __int64 v38; // [sp+48h] [bp-78h]@3
  char v39; // [sp+50h] [bp-70h]@40
  __int64 v40; // [sp+68h] [bp-58h]@27
  __int64 v41; // [sp+70h] [bp-50h]@27
  __int64 v42; // [sp+78h] [bp-48h]@27
  __int64 v43; // [sp+80h] [bp-40h]@24
  __int64 v44; // [sp+88h] [bp-38h]@24
  __int64 v45; // [sp+90h] [bp-30h]@24

  v9 = a3;
  v10 = -536870206;
  if ( !*(_BYTE *)(a5 + 9) )
  {
    if ( a3 )
    {
      v37 = a4;
      v38 = a5;
      v11 = a6;
      LODWORD(v12) = (*(int (__fastcall **)(IOMemoryDescriptor *))(*(_QWORD *)a3 + 456LL))(a3);
      if ( v12 >= a9 )
      {
        v14 = (unsigned int)a8;
        if ( *(_BYTE *)(v38 + 10) == 2 || !(a7 | a8) )
        {
          v10 = -536870199;
          if ( *((_QWORD *)this + 18) )
          {
            if ( *(_QWORD (__cdecl **)(void *, void *, int, unsigned int))(v11 + 8) == off_3B000 )
            {
              v35 = v11;
              v15 = (*(int (__fastcall **)(_QWORD, __int64, __int64, _QWORD))(**((_QWORD **)this + 17) + 304LL))(
                      *((_QWORD *)this + 17),
                      a2,
                      v13,
                      (unsigned int)a8);
              LOBYTE(v14) = 1;
              v36 = 1;
              if ( v15 )
              {
                LODWORD(v16) = (*(int (__fastcall **)(IOUSBController *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
                KernelDebugLogInternal(
                  1u,
                  0x55534246u,
                  (__int64)"IOUSBController(%s)::Write sync request on workloop thread.  Use async!",
                  v16,
                  v17,
                  v18,
                  v33);
                v10 = -536854454;
                return (unsigned int)v10;
              }
            }
            else
            {
              v35 = v11;
              v36 = 0;
            }
            LODWORD(v19) = (*(int (__fastcall **)(_QWORD, _QWORD, __int64, __int64))(***((_QWORD ***)this + 21) + 296LL))(
                             **((_QWORD **)this + 21),
                             0LL,
                             v13,
                             v14);
            if ( v19
              || (IOUSBController::IncreaseCommandPool(this, 0LL, v20),
                  LODWORD(v19) = (*(int (__fastcall **)(_QWORD, _QWORD))(***((_QWORD ***)this + 21) + 296LL))(
                                   **((_QWORD **)this + 21),
                                   0LL),
                  v10 = -536870210,
                  v19) )
            {
              v21 = 0;
              v22 = 0LL;
              v23 = v19;
              if ( a9 )
              {
                v22 = *(_QWORD *)(*(_QWORD *)(v19 + 216) + 48LL);
                if ( !v22 )
                {
                  v25 = -536870210;
                  if ( gUSBStackDebugFlags & 2 )
                  {
                    v27 = this;
                    if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
                      kernel_debug(0x52D0064u, (uintptr_t)this, 0xFFFFFFFFE00002BELL, 0LL, 1uLL, 0LL);
                  }
                  else
                  {
                    v27 = this;
                  }
                  goto LABEL_40;
                }
                LODWORD(v24) = (*(int (__fastcall **)(uintptr_t))(*(_QWORD *)v22 + 312LL))(v22);
                if ( v24 )
                {
                  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
                    kernel_debug(0x52D0064u, (uintptr_t)this, v22, v24, 2uLL, 0LL);
                  (*(void (__fastcall **)(uintptr_t, signed __int64))(*(_QWORD *)v22 + 304LL))(v22, 1LL);
                }
                v25 = (*(int (__fastcall **)(uintptr_t, IOMemoryDescriptor *, signed __int64))(*(_QWORD *)v22 + 296LL))(
                        v22,
                        v9,
                        1LL);
                if ( v25 )
                {
                  v34 = v22;
                  if ( gUSBStackDebugFlags & 2 )
                  {
                    v26 = v23;
                    v27 = this;
                    if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
                      kernel_debug(0x52D0064u, (uintptr_t)this, v25, 0LL, 4uLL, 0LL);
                  }
                  else
                  {
                    v26 = v23;
                    v27 = this;
                  }
                  goto LABEL_35;
                }
              }
              v34 = v22;
              IOUSBCommand::SetIsSyncTransfer((IOUSBCommand *)v23, v36);
              IOUSBCommand::SetUseTimeStamp((IOUSBCommand *)v23, 0);
              IOUSBCommand::SetSelector(v23, 2);
              IOUSBCommand::SetRequest(v23, 0LL);
              IOUSBCommand::SetAddress((IOUSBCommand *)v23, v37);
              IOUSBCommand::SetEndpoint((IOUSBCommand *)v23, *(_BYTE *)(v38 + 8));
              IOUSBCommand::SetDirection((IOUSBCommand *)v23, 0);
              IOUSBCommand::SetType((IOUSBCommand *)v23, *(_BYTE *)(v38 + 10));
              IOUSBCommand::SetBuffer((IOUSBCommand *)v23, v9);
              IOUSBCommand::SetReqCount((IOUSBCommand *)v23, a9);
              v45 = *(_QWORD *)(v35 + 16);
              v28 = *(_QWORD *)v35;
              v44 = *(_QWORD *)(v35 + 8);
              v43 = v28;
              IOUSBCommand::SetClientCompletion(v23, v28, v44, v45);
              IOUSBCommand::SetNoDataTimeout((IOUSBCommand *)v23, a7);
              IOUSBCommand::SetCompletionTimeout((IOUSBCommand *)v23, a8);
              IOUSBCommand::SetMultiTransferTransaction((IOUSBCommand *)v23, 0);
              IOUSBCommand::SetFinalTransferInTransaction((IOUSBCommand *)v23, 0);
              *(_DWORD *)(*(_QWORD *)(v23 + 216) + 72LL) = a2;
              do
              {
                v29 = 0;
                IOUSBCommand::SetUIMScratch((IOUSBCommand *)v23, v21++, 0);
              }
              while ( v21 != 10 );
              do
                IOUSBCommand::SetUIMScratch64((IOUSBCommand *)v23, v29++, 0LL);
              while ( v29 != 5 );
              v40 = 0LL;
              v41 = 0LL;
              v42 = 0LL;
              IOUSBCommand::SetDisjointCompletion(v23, 0LL, 0LL, 0LL);
              v27 = this;
              v25 = (*(int (__fastcall **)(IOUSBController *, __int64, _QWORD))(*(_QWORD *)this + 2616LL))(
                      this,
                      v23,
                      *(_WORD *)(v38 + 12));
              v30 = v23;
              if ( v25 )
              {
                v26 = v23;
                goto LABEL_35;
              }
              v10 = 0;
              v26 = v30;
              v25 = (*(int (__fastcall **)(_QWORD, __int64 (__fastcall *)(uintptr_t, OSObject *, void *, void *, void *, void *), __int64, _QWORD, _QWORD, _QWORD))(**((_QWORD **)this + 18) + 456LL))(
                      *((_QWORD *)this + 18),
                      IOUSBController::DoIOTransfer,
                      v30,
                      0LL,
                      0LL,
                      0LL);
              if ( (v25 != 0) | (unsigned __int8)v36 )
              {
LABEL_35:
                if ( v34 )
                {
                  LODWORD(v31) = (*(int (__fastcall **)(uintptr_t))(*(_QWORD *)v34 + 312LL))(v34);
                  v23 = v26;
                  if ( v31 )
                    (*(void (__fastcall **)(uintptr_t, signed __int64))(*(_QWORD *)v34 + 304LL))(v34, 1LL);
                }
                else
                {
                  v23 = v26;
                }
LABEL_40:
                IOUSBCommand::GetDisjointCompletion((IOUSBCommand *)&v39, v23);
                (*(void (__fastcall **)(_QWORD, __int64))(***((_QWORD ***)v27 + 21) + 304LL))(
                  **((_QWORD **)v27 + 21),
                  v23);
                v10 = v25;
                return (unsigned int)v10;
              }
            }
          }
        }
      }
    }
  }
  return (unsigned int)v10;
}
// 3B000: using guessed type _QWORD (__cdecl *off_3B000)(void *, void *, int, unsigned int);
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (0000000000020896) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV2::_RESERVEDIOUSBControllerV227(IOUSBControllerV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBControllerV2::gMetaClass, 27);
}
// 49808: using guessed type _QWORD IOUSBControllerV2::gMetaClass;

//----- (00000000000208AC) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV2::_RESERVEDIOUSBControllerV228(IOUSBControllerV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBControllerV2::gMetaClass, 28);
}
// 49808: using guessed type _QWORD IOUSBControllerV2::gMetaClass;

//----- (00000000000208C2) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV2::_RESERVEDIOUSBControllerV229(IOUSBControllerV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBControllerV2::gMetaClass, 29);
}
// 49808: using guessed type _QWORD IOUSBControllerV2::gMetaClass;

//----- (00000000000208D8) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV2::MetaClass::~MetaClass(IOUSBControllerV2::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (00000000000208F0) ----------------------------------------------------
__int64 `global constructor keyed to'_a_10()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(&IOUSBControllerV2::gMetaClass, "IOUSBControllerV2", &IOUSBController::gMetaClass, 440LL);
  result = (__int64)off_42570;
  IOUSBControllerV2::gMetaClass = off_42570;
  return result;
}
// 42570: using guessed type __int64 (__fastcall *off_42570[2])(IOUSBControllerV2::MetaClass *__hidden this);
// 49588: using guessed type _QWORD IOUSBController::gMetaClass;
// 49808: using guessed type _QWORD IOUSBControllerV2::gMetaClass;
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000020930) ----------------------------------------------------
__int64 `global destructor keyed to'_a_10()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&IOUSBControllerV2::gMetaClass);
}
// 49808: using guessed type _QWORD IOUSBControllerV2::gMetaClass;

//----- (0000000000020950) ----------------------------------------------------
__int64 __fastcall IOUSBControllerListElement::MetaClass::MetaClass(IOUSBControllerListElement::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBControllerListElement", off_3B080[0], 40LL);
  result = (__int64)off_427C0;
  *(_QWORD *)this = off_427C0;
  return result;
}
// 3B080: using guessed type _QWORD off_3B080[18];
// 427C0: using guessed type __int64 (__fastcall *off_427C0[2])(IOUSBControllerListElement::MetaClass *__hidden this);
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000020982) ----------------------------------------------------
__int64 __fastcall IOUSBControllerListElement::MetaClass::~MetaClass(IOUSBControllerListElement::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000002098C) ----------------------------------------------------
__int64 __fastcall IOUSBControllerListElement::IOUSBControllerListElement(__int64 a1)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1);
  result = (__int64)off_42670;
  *(_QWORD *)a1 = off_42670;
  return result;
}
// 42670: using guessed type __int64 (__fastcall *off_42670[2])(IOUSBControllerListElement *__hidden this);
// 7D998: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (00000000000209AC) ----------------------------------------------------
__int64 __fastcall IOUSBControllerListElement::~IOUSBControllerListElement(IOUSBControllerListElement *this)
{
  return OSObject::~OSObject(this);
}

//----- (00000000000209B6) ----------------------------------------------------
__int64 __fastcall IOUSBControllerListElement::~IOUSBControllerListElement(IOUSBControllerListElement *this)
{
  return OSObject::~OSObject(this);
}

//----- (00000000000209C0) ----------------------------------------------------
void __fastcall IOUSBControllerListElement::~IOUSBControllerListElement(IOUSBControllerListElement *this)
{
  OSObject::~OSObject(this);
  OSObject::operator delete((void *)this);
}

//----- (00000000000209E2) ----------------------------------------------------
__int64 __fastcall IOUSBControllerListElement::getMetaClass(IOUSBControllerListElement *this)
{
  return (__int64)&IOUSBControllerListElement::gMetaClass;
}
// 49830: using guessed type _QWORD IOUSBControllerListElement::gMetaClass;

//----- (00000000000209F0) ----------------------------------------------------
__int64 __fastcall IOUSBControllerListElement::MetaClass::MetaClass(IOUSBControllerListElement::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBControllerListElement", off_3B080[0], 40LL);
  result = (__int64)off_427C0;
  *(_QWORD *)this = off_427C0;
  return result;
}
// 3B080: using guessed type _QWORD off_3B080[18];
// 427C0: using guessed type __int64 (__fastcall *off_427C0[2])(IOUSBControllerListElement::MetaClass *__hidden this);
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000020A22) ----------------------------------------------------
__int64 __fastcall IOUSBControllerListElement::MetaClass::alloc(IOUSBControllerListElement::MetaClass *this)
{
  return 0LL;
}

//----- (0000000000020A2A) ----------------------------------------------------
void __fastcall IOUSBControllerListElement::print(IOUSBControllerListElement *this)
{
  ;
}

//----- (0000000000020A30) ----------------------------------------------------
__int64 __fastcall IOUSBControllerIsochListElement::MetaClass::MetaClass(IOUSBControllerIsochListElement::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBControllerIsochListElement", &IOUSBControllerListElement::gMetaClass, 112LL);
  result = (__int64)off_42A20;
  *(_QWORD *)this = off_42A20;
  return result;
}
// 42A20: using guessed type __int64 (__fastcall *off_42A20[2])(IOUSBControllerIsochListElement::MetaClass *__hidden this);
// 49830: using guessed type _QWORD IOUSBControllerListElement::gMetaClass;
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000020A62) ----------------------------------------------------
__int64 __fastcall IOUSBControllerIsochListElement::MetaClass::~MetaClass(IOUSBControllerIsochListElement::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000020A6C) ----------------------------------------------------
__int64 __fastcall IOUSBControllerIsochListElement::IOUSBControllerIsochListElement(__int64 a1)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1);
  result = (__int64)off_428C0;
  *(_QWORD *)a1 = off_428C0;
  return result;
}
// 428C0: using guessed type __int64 (__fastcall *off_428C0[2])(IOUSBControllerIsochListElement *__hidden this);
// 7D998: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000020A8C) ----------------------------------------------------
__int64 __fastcall IOUSBControllerIsochListElement::~IOUSBControllerIsochListElement(IOUSBControllerIsochListElement *this)
{
  return OSObject::~OSObject(this);
}

//----- (0000000000020A96) ----------------------------------------------------
__int64 __fastcall IOUSBControllerIsochListElement::~IOUSBControllerIsochListElement(IOUSBControllerIsochListElement *this)
{
  return OSObject::~OSObject(this);
}

//----- (0000000000020AA0) ----------------------------------------------------
void __fastcall IOUSBControllerIsochListElement::~IOUSBControllerIsochListElement(IOUSBControllerIsochListElement *this)
{
  OSObject::~OSObject(this);
  OSObject::operator delete((void *)this);
}

//----- (0000000000020AC2) ----------------------------------------------------
__int64 __fastcall IOUSBControllerIsochListElement::getMetaClass(IOUSBControllerIsochListElement *this)
{
  return (__int64)&IOUSBControllerIsochListElement::gMetaClass;
}
// 49858: using guessed type _QWORD IOUSBControllerIsochListElement::gMetaClass;

//----- (0000000000020AD0) ----------------------------------------------------
__int64 __fastcall IOUSBControllerIsochListElement::MetaClass::MetaClass(IOUSBControllerIsochListElement::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBControllerIsochListElement", &IOUSBControllerListElement::gMetaClass, 112LL);
  result = (__int64)off_42A20;
  *(_QWORD *)this = off_42A20;
  return result;
}
// 42A20: using guessed type __int64 (__fastcall *off_42A20[2])(IOUSBControllerIsochListElement::MetaClass *__hidden this);
// 49830: using guessed type _QWORD IOUSBControllerListElement::gMetaClass;
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000020B02) ----------------------------------------------------
__int64 __fastcall IOUSBControllerIsochListElement::MetaClass::alloc(IOUSBControllerIsochListElement::MetaClass *this)
{
  return 0LL;
}

//----- (0000000000020B0A) ----------------------------------------------------
void __fastcall IOUSBControllerIsochListElement::print(IOUSBControllerIsochListElement *this)
{
  ;
}

//----- (0000000000020B10) ----------------------------------------------------
__int64 __fastcall IOUSBControllerIsochEndpoint::MetaClass::MetaClass(IOUSBControllerIsochEndpoint::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBControllerIsochEndpoint", off_3B080[0], 136LL);
  result = (__int64)off_42C50;
  *(_QWORD *)this = off_42C50;
  return result;
}
// 3B080: using guessed type _QWORD off_3B080[18];
// 42C50: using guessed type __int64 (__fastcall *off_42C50[2])(IOUSBControllerIsochEndpoint::MetaClass *__hidden this);
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000020B42) ----------------------------------------------------
__int64 __fastcall IOUSBControllerIsochEndpoint::MetaClass::~MetaClass(IOUSBControllerIsochEndpoint::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000020B4C) ----------------------------------------------------
__int64 __fastcall IOUSBControllerIsochEndpoint::IOUSBControllerIsochEndpoint(__int64 a1)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1);
  result = (__int64)off_42B20;
  *(_QWORD *)a1 = off_42B20;
  return result;
}
// 42B20: using guessed type __int64 (__fastcall *off_42B20[2])(IOUSBControllerIsochEndpoint *__hidden this);
// 7D998: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000020B6C) ----------------------------------------------------
__int64 __fastcall IOUSBControllerIsochEndpoint::IOUSBControllerIsochEndpoint(__int64 a1)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1);
  result = (__int64)off_42B20;
  *(_QWORD *)a1 = off_42B20;
  return result;
}
// 42B20: using guessed type __int64 (__fastcall *off_42B20[2])(IOUSBControllerIsochEndpoint *__hidden this);
// 7D998: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000020B8C) ----------------------------------------------------
__int64 __fastcall IOUSBControllerIsochEndpoint::~IOUSBControllerIsochEndpoint(IOUSBControllerIsochEndpoint *this)
{
  return OSObject::~OSObject(this);
}

//----- (0000000000020B96) ----------------------------------------------------
__int64 __fastcall IOUSBControllerIsochEndpoint::~IOUSBControllerIsochEndpoint(IOUSBControllerIsochEndpoint *this)
{
  return OSObject::~OSObject(this);
}

//----- (0000000000020BA0) ----------------------------------------------------
void __fastcall IOUSBControllerIsochEndpoint::~IOUSBControllerIsochEndpoint(IOUSBControllerIsochEndpoint *this)
{
  OSObject::~OSObject(this);
  OSObject::operator delete((void *)this);
}

//----- (0000000000020BC2) ----------------------------------------------------
__int64 __fastcall IOUSBControllerIsochEndpoint::getMetaClass(IOUSBControllerIsochEndpoint *this)
{
  return (__int64)&IOUSBControllerIsochEndpoint::gMetaClass;
}
// 49880: using guessed type _QWORD IOUSBControllerIsochEndpoint::gMetaClass;

//----- (0000000000020BD0) ----------------------------------------------------
__int64 __fastcall IOUSBControllerIsochEndpoint::MetaClass::MetaClass(IOUSBControllerIsochEndpoint::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBControllerIsochEndpoint", off_3B080[0], 136LL);
  result = (__int64)off_42C50;
  *(_QWORD *)this = off_42C50;
  return result;
}
// 3B080: using guessed type _QWORD off_3B080[18];
// 42C50: using guessed type __int64 (__fastcall *off_42C50[2])(IOUSBControllerIsochEndpoint::MetaClass *__hidden this);
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000020C02) ----------------------------------------------------
__int64 __fastcall IOUSBControllerIsochEndpoint::MetaClass::alloc(IOUSBControllerIsochEndpoint::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&stru_68.addr, a2);
  OSObject::OSObject(v2);
  *(_QWORD *)v2 = off_42B20;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBControllerIsochEndpoint::gMetaClass);
  return v2;
}
// 68: using guessed type section_64 stru_68;
// 42B20: using guessed type __int64 (__fastcall *off_42B20[2])(IOUSBControllerIsochEndpoint *__hidden this);
// 49880: using guessed type _QWORD IOUSBControllerIsochEndpoint::gMetaClass;
// 7D998: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000020C42) ----------------------------------------------------
__int64 __fastcall IOUSBControllerIsochEndpoint::IOUSBControllerIsochEndpoint(__int64 a1)
{
  OSObject::OSObject(a1);
  *(_QWORD *)a1 = off_42B20;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBControllerIsochEndpoint::gMetaClass);
}
// 42B20: using guessed type __int64 (__fastcall *off_42B20[2])(IOUSBControllerIsochEndpoint *__hidden this);
// 49880: using guessed type _QWORD IOUSBControllerIsochEndpoint::gMetaClass;
// 7D998: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000020C72) ----------------------------------------------------
__int64 __fastcall IOUSBControllerIsochEndpoint::IOUSBControllerIsochEndpoint(__int64 a1)
{
  OSObject::OSObject(a1);
  *(_QWORD *)a1 = off_42B20;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBControllerIsochEndpoint::gMetaClass);
}
// 42B20: using guessed type __int64 (__fastcall *off_42B20[2])(IOUSBControllerIsochEndpoint *__hidden this);
// 49880: using guessed type _QWORD IOUSBControllerIsochEndpoint::gMetaClass;
// 7D998: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000020CA2) ----------------------------------------------------
char __fastcall IOUSBControllerIsochEndpoint::init(IOUSBControllerIsochEndpoint *this)
{
  *((_QWORD *)this + 4) = 0LL;
  *((_QWORD *)this + 3) = 0LL;
  *((_QWORD *)this + 6) = 0LL;
  *((_QWORD *)this + 5) = 0LL;
  *((_QWORD *)this + 8) = 0LL;
  *((_QWORD *)this + 7) = 0LL;
  *((_QWORD *)this + 9) = 0LL;
  *((_DWORD *)this + 20) = 0;
  *((_WORD *)this + 56) = 0;
  *((_DWORD *)this + 21) = 0;
  *((_DWORD *)this + 22) = 0;
  *((_DWORD *)this + 23) = 0;
  *((_DWORD *)this + 24) = 0;
  *((_DWORD *)this + 25) = 0;
  *((_DWORD *)this + 26) = 0;
  *((_DWORD *)this + 27) = 0;
  *((_WORD *)this + 56) = 0;
  *((_WORD *)this + 57) = 0;
  *((_WORD *)this + 58) = 0;
  *((_DWORD *)this + 30) = 0;
  *((_DWORD *)this + 31) = 0;
  *((_WORD *)this + 64) = 0;
  return 1;
}

//----- (0000000000020D4A) ----------------------------------------------------
__int64 __fastcall IOUSBControllerListElement::MetaClass::~MetaClass(IOUSBControllerListElement::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000020D54) ----------------------------------------------------
__int64 __fastcall IOUSBControllerIsochListElement::MetaClass::~MetaClass(IOUSBControllerIsochListElement::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000020D5E) ----------------------------------------------------
__int64 __fastcall IOUSBControllerIsochEndpoint::MetaClass::~MetaClass(IOUSBControllerIsochEndpoint::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000020D70) ----------------------------------------------------
__int64 `global constructor keyed to'_a_11()
{
  __int64 v0; // r14@1
  __int64 result; // rax@1

  v0 = off_3B080[0];
  OSMetaClass::OSMetaClass(&IOUSBControllerListElement::gMetaClass, "IOUSBControllerListElement", off_3B080[0], 40LL);
  IOUSBControllerListElement::gMetaClass = off_427C0;
  OSMetaClass::OSMetaClass(
    &IOUSBControllerIsochListElement::gMetaClass,
    "IOUSBControllerIsochListElement",
    &IOUSBControllerListElement::gMetaClass,
    112LL);
  IOUSBControllerIsochListElement::gMetaClass = off_42A20;
  OSMetaClass::OSMetaClass(&IOUSBControllerIsochEndpoint::gMetaClass, "IOUSBControllerIsochEndpoint", v0, 136LL);
  result = (__int64)off_42C50;
  IOUSBControllerIsochEndpoint::gMetaClass = off_42C50;
  return result;
}
// 3B080: using guessed type _QWORD off_3B080[18];
// 427C0: using guessed type __int64 (__fastcall *off_427C0[2])(IOUSBControllerListElement::MetaClass *__hidden this);
// 42A20: using guessed type __int64 (__fastcall *off_42A20[2])(IOUSBControllerIsochListElement::MetaClass *__hidden this);
// 42C50: using guessed type __int64 (__fastcall *off_42C50[2])(IOUSBControllerIsochEndpoint::MetaClass *__hidden this);
// 49830: using guessed type _QWORD IOUSBControllerListElement::gMetaClass;
// 49858: using guessed type _QWORD IOUSBControllerIsochListElement::gMetaClass;
// 49880: using guessed type _QWORD IOUSBControllerIsochEndpoint::gMetaClass;
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000020E10) ----------------------------------------------------
__int64 `global destructor keyed to'_a_11()
{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOUSBControllerIsochEndpoint::gMetaClass);
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOUSBControllerIsochListElement::gMetaClass);
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&IOUSBControllerListElement::gMetaClass);
}
// 49830: using guessed type _QWORD IOUSBControllerListElement::gMetaClass;
// 49858: using guessed type _QWORD IOUSBControllerIsochListElement::gMetaClass;
// 49880: using guessed type _QWORD IOUSBControllerIsochEndpoint::gMetaClass;

//----- (0000000000020E40) ----------------------------------------------------
__int64 __fastcall IOUSBHubDevice::MetaClass::MetaClass(IOUSBHubDevice::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBHubDevice", &IOUSBDevice::gMetaClass, 264LL);
  result = (__int64)off_43850;
  *(_QWORD *)this = off_43850;
  return result;
}
// 43850: using guessed type __int64 (__fastcall *off_43850[2])(IOUSBHubDevice::MetaClass *__hidden this);
// 49760: using guessed type _QWORD IOUSBDevice::gMetaClass;
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000020E72) ----------------------------------------------------
__int64 __fastcall IOUSBHubDevice::MetaClass::~MetaClass(IOUSBHubDevice::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000020E7C) ----------------------------------------------------
__int64 __fastcall IOUSBHubDevice::IOUSBHubDevice(__int64 a1)
{
  __int64 result; // rax@1

  IOUSBDevice::IOUSBDevice(a1);
  result = (__int64)off_42D50;
  *(_QWORD *)a1 = off_42D50;
  return result;
}
// 42D50: using guessed type __int64 (__fastcall *off_42D50[2])(IOUSBHubDevice *__hidden this);

//----- (0000000000020E9C) ----------------------------------------------------
__int64 __fastcall IOUSBHubDevice::IOUSBHubDevice(__int64 a1)
{
  __int64 result; // rax@1

  IOUSBDevice::IOUSBDevice(a1);
  result = (__int64)off_42D50;
  *(_QWORD *)a1 = off_42D50;
  return result;
}
// 42D50: using guessed type __int64 (__fastcall *off_42D50[2])(IOUSBHubDevice *__hidden this);

//----- (0000000000020EBC) ----------------------------------------------------
__int64 __fastcall IOUSBHubDevice::~IOUSBHubDevice(IOUSBHubDevice *this)
{
  return IOUSBDevice::~IOUSBDevice(this);
}

//----- (0000000000020EC6) ----------------------------------------------------
__int64 __fastcall IOUSBHubDevice::~IOUSBHubDevice(IOUSBHubDevice *this)
{
  return IOUSBDevice::~IOUSBDevice(this);
}

//----- (0000000000020ED0) ----------------------------------------------------
void __fastcall IOUSBHubDevice::~IOUSBHubDevice(IOUSBHubDevice *this)
{
  IOUSBDevice::~IOUSBDevice(this);
  OSObject::operator delete((void *)this);
}

//----- (0000000000020EF2) ----------------------------------------------------
__int64 __fastcall IOUSBHubDevice::getMetaClass(IOUSBHubDevice *this)
{
  return (__int64)&IOUSBHubDevice::gMetaClass;
}
// 498A8: using guessed type _QWORD IOUSBHubDevice::gMetaClass;

//----- (0000000000020F00) ----------------------------------------------------
__int64 __fastcall IOUSBHubDevice::MetaClass::MetaClass(IOUSBHubDevice::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBHubDevice", &IOUSBDevice::gMetaClass, 264LL);
  result = (__int64)off_43850;
  *(_QWORD *)this = off_43850;
  return result;
}
// 43850: using guessed type __int64 (__fastcall *off_43850[2])(IOUSBHubDevice::MetaClass *__hidden this);
// 49760: using guessed type _QWORD IOUSBDevice::gMetaClass;
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000020F32) ----------------------------------------------------
__int64 __fastcall IOUSBHubDevice::MetaClass::alloc(IOUSBHubDevice::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&stru_108, a2);
  IOUSBDevice::IOUSBDevice(v2);
  *(_QWORD *)v2 = off_42D50;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBHubDevice::gMetaClass);
  return v2;
}
// 108: using guessed type section_64 stru_108;
// 42D50: using guessed type __int64 (__fastcall *off_42D50[2])(IOUSBHubDevice *__hidden this);
// 498A8: using guessed type _QWORD IOUSBHubDevice::gMetaClass;

//----- (0000000000020F72) ----------------------------------------------------
__int64 __fastcall IOUSBHubDevice::IOUSBHubDevice(__int64 a1)
{
  IOUSBDevice::IOUSBDevice(a1);
  *(_QWORD *)a1 = off_42D50;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBHubDevice::gMetaClass);
}
// 42D50: using guessed type __int64 (__fastcall *off_42D50[2])(IOUSBHubDevice *__hidden this);
// 498A8: using guessed type _QWORD IOUSBHubDevice::gMetaClass;

//----- (0000000000020FA2) ----------------------------------------------------
__int64 __fastcall IOUSBHubDevice::IOUSBHubDevice(__int64 a1)
{
  IOUSBDevice::IOUSBDevice(a1);
  *(_QWORD *)a1 = off_42D50;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBHubDevice::gMetaClass);
}
// 42D50: using guessed type __int64 (__fastcall *off_42D50[2])(IOUSBHubDevice *__hidden this);
// 498A8: using guessed type _QWORD IOUSBHubDevice::gMetaClass;

//----- (0000000000020FD2) ----------------------------------------------------
__int64 __fastcall IOUSBHubDevice::NewHubDevice(IOUSBHubDevice *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 result; // rax@1
  bool v4; // zf@2

  v2 = OSObject::operator new((OSObject *)&stru_108, a2);
  IOUSBDevice::IOUSBDevice(v2);
  *(_QWORD *)v2 = off_42D50;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBHubDevice::gMetaClass);
  result = 0LL;
  if ( v2 )
  {
    v4 = (unsigned __int8)(*(int (__fastcall **)(__int64, _QWORD *))(*(_QWORD *)v2 + 136LL))(
                            v2,
                            &IOUSBHubDevice::gMetaClass) == 0;
    result = v2;
    if ( v4 )
    {
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 40LL))(v2);
      result = 0LL;
    }
  }
  return result;
}
// 108: using guessed type section_64 stru_108;
// 42D50: using guessed type __int64 (__fastcall *off_42D50[2])(IOUSBHubDevice *__hidden this);
// 498A8: using guessed type _QWORD IOUSBHubDevice::gMetaClass;

//----- (0000000000021034) ----------------------------------------------------
char __fastcall IOUSBHubDevice::init(IOUSBHubDevice *this)
{
  char v1; // r14@2
  void *v2; // rax@3

  if ( !(unsigned __int8)((int (*)(void))`vtable for'IOUSBDevice[19])() )
    goto LABEL_5;
  v1 = 1;
  if ( !*((_QWORD *)this + 32) )
  {
    LODWORD(v2) = IOMalloc(56LL);
    *((_QWORD *)this + 32) = v2;
    if ( v2 )
    {
      bzero(v2, 0x38uLL);
      return v1;
    }
LABEL_5:
    v1 = 0;
  }
  return v1;
}
// 3F4B0: using guessed type __int64 `vtable for'IOUSBDevice[2];
// 7D250: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (000000000002108C) ----------------------------------------------------
int __fastcall IOUSBHubDevice::start(IOUSBHubDevice *this, IOService *a2)
{
  int result; // eax@2

  if ( (unsigned __int8)((int (__fastcall *)(IOUSBHubDevice *, IOService *))`vtable for'IOUSBDevice[186])(this, a2) )
    result = (*(int (__cdecl **)(IOUSBHubDevice *))(*(_QWORD *)this + 2600LL))(this);
  else
    result = 0;
  return result;
}
// 3F4B0: using guessed type __int64 `vtable for'IOUSBDevice[2];

//----- (00000000000210BE) ----------------------------------------------------
char __fastcall IOUSBHubDevice::InitializeCharacteristics(IOUSBHubDevice *this)
{
  (*(void (__fastcall **)(IOUSBHubDevice *, _QWORD))(*(_QWORD *)this + 2592LL))(this, 0LL);
  return 1;
}

//----- (00000000000210D2) ----------------------------------------------------
void __fastcall IOUSBHubDevice::stop(IOUSBHubDevice *this, IOService *a2)
{
  JUMPOUT(__CS__, `vtable for'IOUSBDevice[187]);
}
// 3F4B0: using guessed type __int64 `vtable for'IOUSBDevice[2];

//----- (00000000000210E4) ----------------------------------------------------
void __fastcall IOUSBHubDevice::free(IOUSBHubDevice *this)
{
  IOUSBHubDevice *v1; // rbx@1
  __int64 v2; // rdi@1

  v1 = this;
  v2 = *((_QWORD *)this + 32);
  if ( v2 )
  {
    IOFree(v2, 56LL);
    *((_QWORD *)v1 + 32) = 0LL;
  }
  JUMPOUT(__CS__, `vtable for'IOUSBDevice[20]);
}
// 3F4B0: using guessed type __int64 `vtable for'IOUSBDevice[2];
// 7D218: using guessed type int __fastcall IOFree(_QWORD, _QWORD);

//----- (0000000000021124) ----------------------------------------------------
void __fastcall IOUSBHubDevice::SetHubCharacteristics(IOUSBHubDevice *this, int a2)
{
  *((_DWORD *)this + 60) = a2;
}

//----- (0000000000021130) ----------------------------------------------------
__int64 __fastcall IOUSBHubDevice::GetHubCharacteristics(IOUSBHubDevice *this)
{
  return *((_DWORD *)this + 60);
}

//----- (000000000002113C) ----------------------------------------------------
__int64 __fastcall IOUSBHubDevice::GetMaxProvidedPower(IOUSBHubDevice *this)
{
  return **((_DWORD **)this + 32);
}

//----- (000000000002114C) ----------------------------------------------------
__int64 __fastcall IOUSBHubDevice::RequestProvidedPower(IOUSBHubDevice *this, unsigned int a2)
{
  __int64 result; // rax@1

  result = 500LL;
  if ( a2 <= 0x1F4 )
    result = a2;
  return result;
}

//----- (0000000000021160) ----------------------------------------------------
void __fastcall IOUSBHubDevice::SetPolicyMaker(IOUSBHubDevice *this, IOUSBHubPolicyMaker *a2)
{
  *((_QWORD *)this + 31) = a2;
}

//----- (000000000002116E) ----------------------------------------------------
__int64 __fastcall IOUSBHubDevice::GetPolicyMaker(IOUSBHubDevice *this)
{
  return *((_QWORD *)this + 31);
}

//----- (000000000002117C) ----------------------------------------------------
__int64 __usercall IOUSBHubDevice::RequestExtraPower@<rax>(IOUSBHubDevice *this@<rdi>, __int64 a2@<rax>, unsigned int a3@<edx>, unsigned int a4@<esi>)
{
  unsigned int v4; // er14@1
  unsigned int v5; // er12@3
  __int64 v6; // rax@5
  __int64 v7; // r13@6
  __int64 v8; // r12@8
  __int64 v10; // [sp+0h] [bp-30h]@1

  v10 = a2;
  v4 = a3;
  if ( a4 - 6 < 2 )
    goto LABEL_14;
  if ( !a4 )
    return (*(int (__fastcall **)(IOUSBHubDevice *, _QWORD))(*(_QWORD *)this + 2664LL))(this, a3);
  if ( a4 != 1 )
  {
    v5 = 0;
    if ( (a4 & 0xFFFFFFFE) == 4 )
      (*(void (__fastcall **)(IOUSBHubDevice *, _QWORD, _QWORD))(*(_QWORD *)this + 2704LL))(this, a4, a3);
  }
  else
  {
LABEL_14:
    v10 = 0LL;
    v6 = *((_QWORD *)this + 29);
    v5 = 0;
    if ( v6 )
    {
      v7 = *(_QWORD *)(v6 + 104);
      if ( v7 )
      {
        if ( *(_QWORD *)(v6 + 80) )
        {
          v8 = *(_QWORD *)(v6 + 80);
          (*(void (**)(void))(*(_QWORD *)this + 32LL))();
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v8 + 32LL))(v8);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v7 + 32LL))(v7);
          (*(void (__fastcall **)(__int64, __int64 (__fastcall *)(IOUSBHubDevice *, __int64, unsigned __int64, unsigned __int64 *), _QWORD, _QWORD, __int64 *, _QWORD))(*(_QWORD *)v7 + 456LL))(
            v7,
            IOUSBHubDevice::RequestExtraWakePowerGated,
            a4,
            v4,
            &v10,
            0LL);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v7 + 40LL))(v7);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v8 + 40LL))(v8);
          (*(void (__fastcall **)(IOUSBHubDevice *))(*(_QWORD *)this + 40LL))(this);
          v5 = v10;
        }
      }
    }
  }
  return v5;
}

//----- (0000000000021286) ----------------------------------------------------
__int64 __fastcall IOUSBHubDevice::RequestExtraWakePowerGated(IOUSBHubDevice *this, __int64 a2, unsigned __int64 a3, unsigned __int64 *a4)
{
  unsigned __int64 *v4; // r14@1
  unsigned __int64 v5; // r13@1
  unsigned __int64 v6; // rbx@1
  __int64 v7; // rax@2
  __int64 v8; // rcx@2
  unsigned __int64 v9; // rdx@2
  __int64 v10; // rcx@4
  unsigned __int64 v11; // r12@4
  __int64 v12; // rax@9
  unsigned int v13; // ecx@9
  int v14; // eax@15
  __int64 v15; // rcx@15

  v4 = a4;
  v5 = a3;
  v6 = 0LL;
  if ( !a3 )
    goto LABEL_19;
  v7 = *((_QWORD *)this + 32);
  v8 = *(_DWORD *)(*((_QWORD *)this + 29) + 192LL);
  v9 = *(_DWORD *)v7;
  if ( v8 + v5 > v9 )
    v5 = (unsigned int)(v9 - v8);
  v10 = *(_DWORD *)(v7 + 4);
  v11 = 0LL;
  if ( v10 >= v5 )
  {
    *(_DWORD *)(v7 + 4) = v10 - v5;
    v11 = v5;
  }
  if ( *v4 )
  {
LABEL_18:
    v6 = v11;
    goto LABEL_19;
  }
  if ( !*(_BYTE *)(v7 + 24) )
  {
    if ( *(_DWORD *)(v7 + 12) && *(_DWORD *)(v7 + 20) <= 1u )
    {
      v6 = 0LL;
      if ( v5 > *(_DWORD *)(v7 + 16) )
        goto LABEL_19;
      v14 = ((int (__fastcall *)(IOUSBHubDevice *))`vtable for'IOUSBDevice[314])(this);
      v15 = *((_QWORD *)this + 32);
      if ( v14 == *(_DWORD *)(v15 + 12) )
      {
        v6 = *(_DWORD *)(v15 + 16);
        ++*(_DWORD *)(v15 + 20);
        (*(void (__fastcall **)(IOUSBHubDevice *, _QWORD, unsigned __int64, signed __int64))(*(_QWORD *)this + 640LL))(
          this,
          "PortActualRequestExtraPower",
          v6,
          32LL);
        (*(void (__fastcall **)(IOUSBHubDevice *, _QWORD, _QWORD, signed __int64))(*(_QWORD *)this + 640LL))(
          this,
          "ExtraWakePowerAllocated",
          *(_DWORD *)(*((_QWORD *)this + 32) + 20LL),
          32LL);
        goto LABEL_19;
      }
      ((void (__fastcall *)(IOUSBHubDevice *, _QWORD, _QWORD))`vtable for'IOUSBDevice[315])(
        this,
        (unsigned int)a2,
        (unsigned int)v14);
    }
    goto LABEL_18;
  }
  v6 = v11;
  if ( ((int (__fastcall *)(IOUSBHubDevice *, __int64, _QWORD))`vtable for'IOUSBDevice[314])(this, a2, (unsigned int)v5) == v5 )
  {
    LODWORD(v12) = (*(int (__fastcall **)(IOUSBHubDevice *, _QWORD))(*(_QWORD *)this + 696LL))(
                     this,
                     "PortActualRequestExtraPower");
    v13 = v5;
    if ( v12 )
      v13 = v5 + (*(int (__fastcall **)(__int64))(*(_QWORD *)v12 + 328LL))(v12);
    (*(void (__fastcall **)(IOUSBHubDevice *, _QWORD, _QWORD, signed __int64))(*(_QWORD *)this + 640LL))(
      this,
      "PortActualRequestExtraPower",
      v13,
      32LL);
    v6 = v5;
  }
LABEL_19:
  *v4 = v6;
  return 0LL;
}
// 3F4B0: using guessed type __int64 `vtable for'IOUSBDevice[2];

//----- (0000000000021404) ----------------------------------------------------
__int64 __fastcall IOUSBHubDevice::ReturnExtraPower(IOUSBHubDevice *this, unsigned int a2, unsigned int a3)
{
  unsigned int v3; // er14@1
  __int64 v4; // rax@5
  signed int v5; // er12@5
  __int64 v6; // r13@6
  __int64 v7; // r12@8
  __int64 v8; // ST00_8@8

  v3 = a3;
  if ( a2 - 6 < 2 )
    goto LABEL_15;
  if ( !a2 )
  {
    (*(void (__fastcall **)(IOUSBHubDevice *, _QWORD))(*(_QWORD *)this + 2672LL))(this, a3);
LABEL_11:
    v5 = 0;
    return (unsigned int)v5;
  }
  if ( a2 != 1 )
  {
    v5 = -536870206;
    if ( (a2 & 0xFFFFFFFE) == 2 )
    {
      (*(void (__fastcall **)(IOUSBHubDevice *, _QWORD, _QWORD))(*(_QWORD *)this + 2704LL))(this, a2, a3);
      goto LABEL_11;
    }
  }
  else
  {
LABEL_15:
    v4 = *((_QWORD *)this + 29);
    v5 = 0;
    if ( v4 )
    {
      v6 = *(_QWORD *)(v4 + 104);
      if ( v6 )
      {
        if ( *(_QWORD *)(v4 + 80) )
        {
          v7 = *(_QWORD *)(v4 + 80);
          v8 = *(_QWORD *)(v4 + 80);
          (*(void (__cdecl **)(IOUSBHubDevice *))(*(_QWORD *)this + 32LL))(this);
          (*(void (**)(void))(*(_QWORD *)v7 + 32LL))();
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v6 + 32LL))(v6);
          v5 = 0;
          (*(void (__fastcall **)(__int64, __int64 (__fastcall *)(IOUSBHubDevice *, __int64, __int64), _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v6 + 456LL))(
            v6,
            IOUSBHubDevice::ReturnExtraWakePowerGated,
            a2,
            v3,
            0LL,
            0LL);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v6 + 40LL))(v6);
          (*(void (**)(void))(*(_QWORD *)v8 + 40LL))();
          (*(void (__fastcall **)(IOUSBHubDevice *))(*(_QWORD *)this + 40LL))(this);
        }
      }
    }
  }
  return (unsigned int)v5;
}

//----- (000000000002150A) ----------------------------------------------------
__int64 __fastcall IOUSBHubDevice::ReturnExtraWakePowerGated(IOUSBHubDevice *this, __int64 a2, __int64 a3)
{
  __int64 v3; // rax@2
  __int64 v4; // rax@3
  __int64 v5; // rdx@3

  if ( a3 )
  {
    v3 = *((_QWORD *)this + 32);
    if ( *(_DWORD *)(v3 + 20) )
    {
      ((void (__fastcall *)(IOUSBHubDevice *, __int64, _QWORD))`vtable for'IOUSBDevice[315])(
        this,
        a2,
        *(_DWORD *)(v3 + 12));
      v4 = *((_QWORD *)this + 32);
      v5 = (unsigned int)(*(_DWORD *)(v4 + 20) - 1);
      *(_DWORD *)(v4 + 20) = v5;
      (*(void (__fastcall **)(IOUSBHubDevice *, _QWORD, __int64, signed __int64))(*(_QWORD *)this + 640LL))(
        this,
        "ExtraWakePowerAllocated",
        v5,
        32LL);
    }
    else if ( *(_BYTE *)(v3 + 24) )
    {
      ((void (__cdecl *)(IOUSBHubDevice *))`vtable for'IOUSBDevice[315])(this);
    }
    else
    {
      *(_DWORD *)(v3 + 4) += a3;
    }
  }
  return 0LL;
}
// 3F4B0: using guessed type __int64 `vtable for'IOUSBDevice[2];

//----- (0000000000021586) ----------------------------------------------------
__int64 __fastcall IOUSBHubDevice::RequestSleepPower(IOUSBHubDevice *this, unsigned int a2)
{
  __int64 v2; // rcx@1
  __int64 result; // rax@1
  __int64 v4; // rbx@2
  __int64 v5; // r14@3
  __int64 v6; // [sp+8h] [bp-28h]@1

  v6 = 0LL;
  v2 = *((_QWORD *)this + 29);
  result = 0LL;
  if ( v2 )
  {
    v4 = *(_QWORD *)(v2 + 104);
    if ( v4 )
    {
      v5 = *(_QWORD *)(v2 + 80);
      if ( v5 )
      {
        (*(void (**)(void))(*(_QWORD *)this + 32LL))();
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v5 + 32LL))(v5);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v4 + 32LL))(v4);
        (*(void (__fastcall **)(__int64, __int64 (__fastcall *)(IOUSBHubDevice *__hidden, unsigned __int64, unsigned __int64 *), _QWORD, __int64 *, _QWORD, _QWORD))(*(_QWORD *)v4 + 456LL))(
          v4,
          IOUSBHubDevice::RequestSleepPowerGated,
          a2,
          &v6,
          0LL,
          0LL);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v4 + 40LL))(v4);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v5 + 40LL))(v5);
        (*(void (__fastcall **)(IOUSBHubDevice *))(*(_QWORD *)this + 40LL))(this);
        result = (unsigned int)v6;
      }
    }
  }
  return result;
}

//----- (000000000002162A) ----------------------------------------------------
__int64 __fastcall IOUSBHubDevice::RequestSleepPowerGated(IOUSBHubDevice *this, unsigned __int64 a2, unsigned __int64 *a3)
{
  unsigned __int64 *v3; // r14@1
  unsigned __int64 v4; // rbx@1
  __int64 v5; // rax@2
  unsigned __int64 v6; // rcx@2
  int v7; // eax@5
  int v8; // er12@5
  __int64 v9; // rcx@5
  int v10; // eax@5
  unsigned __int64 v11; // rbx@6
  unsigned __int64 v12; // rdx@9
  int v13; // er12@11

  v3 = a3;
  v4 = a2;
  if ( a2 && (v5 = *((_QWORD *)this + 32), (v6 = *(_DWORD *)(v5 + 40)) != 0) )
  {
    if ( v6 < a2 )
    {
      if ( *(_BYTE *)(v5 + 24) )
      {
        v7 = ((int (__fastcall *)(IOUSBHubDevice *, _QWORD, _QWORD))`vtable for'IOUSBDevice[314])(
               this,
               0LL,
               (unsigned int)a2);
        v8 = v7;
        v9 = (unsigned int)v7;
        v10 = *(_DWORD *)(*((_QWORD *)this + 32) + 40LL);
        if ( v9 != a2 )
        {
          v13 = v8 - v10;
          (*(void (__fastcall **)(IOUSBHubDevice *, _QWORD, _QWORD, signed __int64))(*(_QWORD *)this + 640LL))(
            this,
            "PortActualRequestExtraSleepPower",
            (unsigned int)v13,
            32LL);
          goto LABEL_15;
        }
        LODWORD(v11) = a2 - v10;
        (*(void (__fastcall **)(IOUSBHubDevice *, _QWORD, _QWORD, signed __int64))(*(_QWORD *)this + 640LL))(
          this,
          "PortActualRequestExtraSleepPower",
          (unsigned int)(a2 - v10),
          32LL);
      }
      else
      {
        v12 = *(_DWORD *)(v5 + 8);
        if ( *(_DWORD *)(v5 + 28) < a2 )
          v4 = *(_DWORD *)(v5 + 28);
        v11 = v4 - v6;
        v13 = 0;
        if ( v11 > v12 )
          goto LABEL_15;
        *(_DWORD *)(v5 + 8) = v12 - v11;
      }
      v13 = v11;
LABEL_15:
      *v3 = (unsigned int)(*(_DWORD *)(*((_QWORD *)this + 32) + 40LL) + v13);
      return 0LL;
    }
    *a3 = a2;
  }
  else
  {
    *a3 = 0LL;
  }
  return 0LL;
}
// 3F4B0: using guessed type __int64 `vtable for'IOUSBDevice[2];

//----- (000000000002170C) ----------------------------------------------------
int __fastcall IOUSBHubDevice::ReturnSleepPower(IOUSBHubDevice *this, unsigned int a2)
{
  __int64 v2; // rax@1
  __int64 v3; // rbx@2
  __int64 v4; // r15@3

  v2 = *((_QWORD *)this + 29);
  if ( v2 )
  {
    v3 = *(_QWORD *)(v2 + 104);
    if ( v3 )
    {
      v4 = *(_QWORD *)(v2 + 80);
      if ( v4 )
      {
        (*(void (**)(void))(*(_QWORD *)this + 32LL))();
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v4 + 32LL))(v4);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 32LL))(v3);
        (*(void (__fastcall **)(__int64, __int64 (__fastcall *)(IOUSBHubDevice *__hidden, unsigned __int64), _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v3 + 456LL))(
          v3,
          IOUSBHubDevice::ReturnSleepPowerGated,
          a2,
          0LL,
          0LL,
          0LL);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 40LL))(v3);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v4 + 40LL))(v4);
        LODWORD(v2) = (*(int (__fastcall **)(IOUSBHubDevice *))(*(_QWORD *)this + 40LL))(this);
      }
    }
  }
  return v2;
}

//----- (00000000000217A0) ----------------------------------------------------
__int64 __fastcall IOUSBHubDevice::ReturnSleepPowerGated(IOUSBHubDevice *this, unsigned __int64 a2)
{
  __int64 v2; // rcx@1
  unsigned __int64 v3; // rdx@1

  v2 = *((_QWORD *)this + 32);
  v3 = *(_DWORD *)(v2 + 40);
  if ( v3 < a2 )
  {
    if ( *(_BYTE *)(v2 + 24) )
    {
      ((void (__fastcall *)(IOUSBHubDevice *, _QWORD, _QWORD))`vtable for'IOUSBDevice[315])(this, 0LL, (unsigned int)a2);
    }
    else if ( a2 )
    {
      *(_DWORD *)(v2 + 8) += a2 - v3;
    }
  }
  return 0LL;
}
// 3F4B0: using guessed type __int64 `vtable for'IOUSBDevice[2];

//----- (00000000000217DE) ----------------------------------------------------
int __usercall IOUSBHubDevice::InitializeExtraPower@<eax>(IOUSBHubDevice *this@<rdi>, __int64 a2@<rax>, int a3@<edx>, int a4@<ecx>, int a5@<esi>, int a6@<r8d>)
{
  int v6; // er14@1
  int v7; // er12@1
  int v8; // er13@1
  IOUSBHubDevice *v9; // r15@1
  __int64 v10; // rax@1
  __int64 v11; // rdi@1
  __int64 v12; // rax@2
  __int64 v13; // rbx@2
  __int64 v14; // rdi@4
  __int64 v15; // rax@7
  char v16; // al@9
  __int64 v17; // rcx@9
  __int64 v18; // rax@10
  int v19; // eax@12
  OSMetaClassBase *v20; // rax@13
  __int64 v21; // rsi@13
  const OSMetaClass *v22; // rdx@13
  __int64 v23; // rax@13
  OSMetaClassBase *v24; // rax@16
  OSMetaClassBase *v25; // rbx@16
  const OSMetaClassBase *v26; // r14@16
  __int64 v27; // rsi@16
  const OSMetaClass *v28; // rdx@16
  __int64 v29; // rax@16
  OSMetaClassBase *v30; // rax@20
  OSMetaClassBase *v31; // rbx@20
  const OSMetaClass *v32; // rdx@20
  __int64 v33; // rax@20
  __int64 v34; // rax@24
  IOUSBControllerV3 *v35; // rdi@24
  __int64 v37; // [sp-4h] [bp-30h]@1

  v37 = a2;
  v6 = a6;
  v7 = a4;
  v8 = a3;
  v9 = this;
  HIDWORD(v37) = 0;
  (*(void (__fastcall **)(IOUSBHubDevice *, char *))(*(_QWORD *)this + 2488LL))(this, (char *)&v37 + 4);
  v10 = *((_QWORD *)this + 32);
  *(_DWORD *)v10 = a5;
  *(_DWORD *)(v10 + 4) = v8;
  *(_DWORD *)(v10 + 28) = v7;
  *(_DWORD *)(v10 + 8) = v6;
  v11 = *((_QWORD *)this + 18);
  if ( v11 )
  {
    LODWORD(v12) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v11 + 696LL))(
                     v11,
                     "UpdatedSleepPropertiesExists");
    v13 = *(_QWORD *)off_3B0F8[0];
    if ( v12 == **(_QWORD **)off_3B0F8[0] && (WORD2(v37) & 0x2007) == 7 )
    {
      *(_BYTE *)(*((_QWORD *)v9 + 32) + 24LL) = 1;
      v14 = *(_QWORD *)(*((_QWORD *)v9 + 29) + 16LL);
      if ( !v14 )
        goto LABEL_16;
      goto LABEL_13;
    }
  }
  else
  {
    v13 = *(_QWORD *)off_3B0F8[0];
  }
  LODWORD(v15) = (*(int (__fastcall **)(IOUSBHubDevice *, _QWORD))(*(_QWORD *)v9 + 696LL))(
                   v9,
                   "RequestExtraCurrentFromParent");
  if ( v15 != *(_QWORD *)v13 )
  {
    *(_BYTE *)(*((_QWORD *)v9 + 32) + 24LL) = 0;
    goto LABEL_16;
  }
  v16 = (*(int (__fastcall **)(IOUSBHubDevice *))(*(_QWORD *)v9 + 2520LL))(v9);
  v17 = *((_QWORD *)v9 + 32);
  *(_BYTE *)(v17 + 24) = v16;
  if ( v16 )
  {
    v18 = *((_QWORD *)v9 + 29);
    v14 = *(_QWORD *)(v18 + 16);
    if ( v14 )
    {
      if ( *(_BYTE *)(v18 + 209) )
      {
        v19 = *(_DWORD *)(*(_QWORD *)(*(_QWORD *)(v18 + 216) + 672LL) + 312LL);
LABEL_15:
        *(_DWORD *)v17 = v19;
        goto LABEL_16;
      }
LABEL_13:
      LODWORD(v20) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v14 + 696LL))(v14, "AAPL,current-available");
      v21 = *(_QWORD *)off_3B078[0];
      v23 = OSMetaClassBase::safeMetaCast(v20, *(const OSMetaClassBase **)off_3B078[0], v22);
      if ( !v23 )
        goto LABEL_16;
      v19 = (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v23 + 328LL))(v23, v21);
      v17 = *((_QWORD *)v9 + 32);
      goto LABEL_15;
    }
  }
LABEL_16:
  LODWORD(v24) = (*(int (__fastcall **)(IOUSBHubDevice *, _QWORD))(*(_QWORD *)v9 + 744LL))(v9, "ExtraPowerRequest");
  v25 = v24;
  v26 = *(const OSMetaClassBase **)off_3B078[0];
  v27 = *(_QWORD *)off_3B078[0];
  v29 = OSMetaClassBase::safeMetaCast(v24, *(const OSMetaClassBase **)off_3B078[0], v28);
  if ( v29 )
    *(_DWORD *)(*((_QWORD *)v9 + 32) + 12LL) = (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v29 + 328LL))(
                                                 v29,
                                                 v27);
  if ( v25 )
    (*(void (__fastcall **)(OSMetaClassBase *, __int64))(*(_QWORD *)v25 + 40LL))(v25, v27);
  LODWORD(v30) = (*(int (__fastcall **)(IOUSBHubDevice *, _QWORD))(*(_QWORD *)v9 + 744LL))(v9, "ExtraPowerForPorts");
  v31 = v30;
  v33 = OSMetaClassBase::safeMetaCast(v30, v26, v32);
  if ( v33 )
    *(_DWORD *)(*((_QWORD *)v9 + 32) + 16LL) = (*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v33 + 328LL))(
                                                 v33,
                                                 v26);
  if ( v31 )
    (*(void (__fastcall **)(OSMetaClassBase *, const OSMetaClassBase *))(*(_QWORD *)v31 + 40LL))(v31, v26);
  v34 = *((_QWORD *)v9 + 29);
  v35 = *(IOUSBControllerV3 **)(v34 + 216);
  if ( v35 )
    LODWORD(v34) = IOUSBControllerV3::UpdateThunderboltExtraCurrentiVars(v35);
  return v34;
}
// 3B078: using guessed type _QWORD off_3B078[19];
// 3B0F8: using guessed type __int64 off_3B0F8[3];
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (00000000000219FC) ----------------------------------------------------
int __usercall IOUSBHubDevice::SendExtraPowerMessage@<eax>(IOUSBHubDevice *this@<rdi>, __int64 a2@<rax>, int a3@<edx>, const char *a4@<rsi>)
{
  int v4; // er15@1
  __int64 v5; // rax@1
  __int64 v6; // rax@4
  int (__fastcall *v7)(_QWORD, _QWORD); // r14@9
  __int64 v8; // rax@9
  __int64 v9; // r14@9
  OSMetaClassBase *v10; // rax@10
  const OSMetaClass *v11; // rdx@10
  signed __int64 v12; // rsi@11
  __int64 v13; // rax@11
  __int64 v15; // [sp-4h] [bp-30h]@1

  v15 = a2;
  v4 = (signed int)a4;
  HIDWORD(v15) = a3;
  v5 = *((_QWORD *)this + 32);
  if ( *(_DWORD *)(v5 + 16) || *(_BYTE *)(v5 + 24) )
  {
    if ( (_DWORD)a4 == 2 )
      LODWORD(v6) = ((int (__fastcall *)(IOUSBHubDevice *, signed __int64))`vtable for'IOUSBDevice[315])(this, 2LL);
    else
      LODWORD(v6) = ((int (__fastcall *)(IOUSBHubDevice *, _QWORD))`vtable for'IOUSBDevice[314])(this, (unsigned int)a4);
  }
  else if ( (_DWORD)a4 == 4 )
  {
    LODWORD(v6) = (*(int (__fastcall **)(IOUSBHubDevice *, signed __int64, _QWORD, _QWORD))(*(_QWORD *)this + 1856LL))(
                    this,
                    3758112792LL,
                    0LL,
                    0LL);
  }
  else
  {
    v7 = *(int (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)this + 800LL);
    v8 = IORegistryEntry::getPlane("IOUSB", a4);
    LODWORD(v6) = v7(this, v8);
    v9 = v6;
    if ( v6 )
    {
      for ( LODWORD(v10) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v6 + 296LL))(v6);
            v10;
            LODWORD(v10) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v9 + 296LL))(v9, v12) )
      {
        v12 = IOUSBDevice::metaClass;
        v13 = OSMetaClassBase::safeMetaCast(v10, (const OSMetaClassBase *)IOUSBDevice::metaClass, v11);
        if ( v13 && v4 == 2 )
        {
          v12 = 3758112791LL;
          (*(void (__fastcall **)(__int64, signed __int64, char *, signed __int64))(*(_QWORD *)v13 + 1856LL))(
            v13,
            3758112791LL,
            (char *)&v15 + 4,
            4LL);
        }
      }
      LODWORD(v6) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v9 + 40LL))(v9);
    }
  }
  return v6;
}
// 3F498: using guessed type _QWORD IOUSBDevice::metaClass;
// 3F4B0: using guessed type __int64 `vtable for'IOUSBDevice[2];
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000021B10) ----------------------------------------------------
__int64 __fastcall IOUSBHubDevice::UpdateUnconnectedExternalPorts(IOUSBHubDevice *this, int a2)
{
  __int64 v2; // rcx@1
  __int64 result; // rax@1
  __int64 v4; // rbx@2
  __int64 v5; // r14@3
  unsigned int v6; // [sp+Ch] [bp-24h]@1

  v6 = 0;
  v2 = *((_QWORD *)this + 29);
  result = 0LL;
  if ( v2 )
  {
    v4 = *(_QWORD *)(v2 + 104);
    if ( v4 )
    {
      v5 = *(_QWORD *)(v2 + 80);
      if ( v5 )
      {
        (*(void (**)(void))(*(_QWORD *)this + 32LL))();
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v5 + 32LL))(v5);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v4 + 32LL))(v4);
        (*(void (__fastcall **)(__int64, __int64 (__fastcall *)(IOUSBHubDevice *, signed int, int *), _QWORD, int *, _QWORD, _QWORD))(*(_QWORD *)v4 + 456LL))(
          v4,
          IOUSBHubDevice::UpdateUnconnectedExternalPortsGated,
          a2,
          &v6,
          0LL,
          0LL);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v4 + 40LL))(v4);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v5 + 40LL))(v5);
        (*(void (__fastcall **)(IOUSBHubDevice *))(*(_QWORD *)this + 40LL))(this);
        result = v6;
      }
    }
  }
  return result;
}

//----- (0000000000021BB2) ----------------------------------------------------
__int64 __fastcall IOUSBHubDevice::UpdateUnconnectedExternalPortsGated(IOUSBHubDevice *this, signed int a2, int *a3)
{
  int *v3; // r13@1
  signed int v4; // ebx@1
  __int64 v5; // r15@1
  int v6; // er14@2
  int v7; // er14@5
  char *v8; // rcx@5
  __int64 v9; // rax@5
  int v10; // er13@6
  signed int v11; // ebx@7
  char *v12; // rcx@8
  __int64 v13; // rax@8
  int v14; // ebx@9
  OSMetaClassBase *v15; // rax@10
  __int64 v16; // rsi@10
  const OSMetaClass *v17; // rdx@10
  __int64 v18; // rax@10
  int v19; // er13@16
  __int64 v20; // rax@20
  OSMetaClassBase *v21; // rax@21
  OSMetaClassBase *v22; // r13@21
  __int64 v23; // rsi@21
  const OSMetaClass *v24; // rdx@21
  __int64 v25; // rax@21
  int v26; // ebx@26
  __int64 v27; // rax@26
  char *v28; // r14@30
  IOUSBControllerV3 *v29; // rdi@33
  OSMetaClassBase *v31; // [sp+0h] [bp-40h]@10
  int *v32; // [sp+8h] [bp-38h]@5
  int *v33; // [sp+8h] [bp-38h]@21
  char *v34; // [sp+10h] [bp-30h]@26

  v3 = a3;
  v4 = a2;
  v5 = IOService::getResourceService(this);
  if ( v5 )
  {
    v6 = a2 - 1000;
    if ( a2 <= 1999 )
      v6 = a2;
    if ( v6 < 1000 )
    {
      v12 = (char *)this + 232;
      v13 = *((_QWORD *)this + 29);
      if ( *(_BYTE *)(v13 + 209) )
      {
        v14 = *(_DWORD *)(*(_QWORD *)(*(_QWORD *)(v13 + 216) + 672LL) + 324LL);
      }
      else
      {
        v33 = v3;
        LODWORD(v21) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v5 + 744LL))(v5, "AAPL,UnconnectedSSPorts");
        v22 = v21;
        v23 = *(_QWORD *)off_3B078[0];
        v25 = OSMetaClassBase::safeMetaCast(v21, *(const OSMetaClassBase **)off_3B078[0], v24);
        v14 = 0;
        if ( v25 )
          v14 = (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v25 + 328LL))(v25, v23);
        if ( v22 )
          (*(void (__fastcall **)(OSMetaClassBase *, __int64))(*(_QWORD *)v22 + 40LL))(v22, v23);
        v3 = v33;
        v12 = (char *)this + 232;
      }
      v34 = v12;
      v26 = v6 + v14;
      *(_DWORD *)(*((_QWORD *)this + 32) + 44LL) = v26;
      v27 = *((_QWORD *)this + 29);
      if ( *(_BYTE *)(v27 + 209) )
        *(_DWORD *)(*(_QWORD *)(*(_QWORD *)(v27 + 216) + 672LL) + 324LL) = v26;
      else
        (*(void (__fastcall **)(__int64, _QWORD, _QWORD, signed __int64))(*(_QWORD *)v5 + 640LL))(
          v5,
          "AAPL,UnconnectedSSPorts",
          (unsigned int)v26,
          32LL);
      v8 = v34;
      *v3 = v26;
    }
    else
    {
      v32 = v3;
      v7 = v6 - 1000;
      v8 = (char *)this + 232;
      v9 = *((_QWORD *)this + 29);
      if ( *(_BYTE *)(v9 + 209) )
      {
        v10 = *(_DWORD *)(*(_QWORD *)(*(_QWORD *)(v9 + 216) + 672LL) + 320LL);
      }
      else
      {
        LODWORD(v15) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v5 + 744LL))(v5, "AAPL,ExternalSSPorts");
        v31 = v15;
        v16 = *(_QWORD *)off_3B078[0];
        v18 = OSMetaClassBase::safeMetaCast(v15, *(const OSMetaClassBase **)off_3B078[0], v17);
        v10 = 0;
        if ( v18 )
          v10 = (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v18 + 328LL))(v18, v16);
        if ( v31 )
          (*(void (__fastcall **)(OSMetaClassBase *, __int64))(*(_QWORD *)v31 + 40LL))(v31, v16);
        v8 = (char *)this + 232;
      }
      if ( v4 <= 1999 )
      {
        v19 = v7 + v10;
        *(_DWORD *)(*((_QWORD *)this + 32) + 48LL) += v19;
      }
      else
      {
        v19 = v10 - v7;
        *(_DWORD *)(*((_QWORD *)this + 32) + 48LL) -= v19;
      }
      if ( v7 > 0 )
      {
        if ( *(_BYTE *)(*(_QWORD *)v8 + 209LL) )
        {
          v20 = *(_QWORD *)(*(_QWORD *)(*(_QWORD *)v8 + 216LL) + 672LL);
          *(_DWORD *)(v20 + 320) = v19;
          *(_DWORD *)(v20 + 324) = v19;
        }
        else
        {
          v28 = v8;
          (*(void (__fastcall **)(__int64, _QWORD, _QWORD, signed __int64))(*(_QWORD *)v5 + 640LL))(
            v5,
            "AAPL,ExternalSSPorts",
            (unsigned int)v19,
            32LL);
          (*(void (__fastcall **)(_QWORD, _QWORD, _QWORD, signed __int64))(*(_QWORD *)v5 + 640LL))(
            v5,
            "AAPL,UnconnectedSSPorts",
            (unsigned int)v19,
            32LL);
          v8 = v28;
        }
      }
      *v32 = v19;
    }
    v11 = 0;
  }
  else
  {
    v11 = -536870211;
    v8 = (char *)this + 232;
  }
  v29 = *(IOUSBControllerV3 **)(*(_QWORD *)v8 + 216LL);
  if ( v29 )
    IOUSBControllerV3::UpdateThunderboltExtraCurrentiVars(v29);
  return (unsigned int)v11;
}
// 3B078: using guessed type _QWORD off_3B078[19];
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000021E5A) ----------------------------------------------------
int __fastcall IOUSBHubDevice::SetTotalSleepCurrent(IOUSBHubDevice *this)
{
  return (*(int (**)(void))(*(_QWORD *)this + 2680LL))();
}

//----- (0000000000021E6C) ----------------------------------------------------
int __fastcall IOUSBHubDevice::GetTotalSleepCurrent(IOUSBHubDevice *this)
{
  return (*(int (**)(void))(*(_QWORD *)this + 2688LL))();
}

//----- (0000000000021E7A) ----------------------------------------------------
__int64 __fastcall IOUSBHubDevice::SetSleepCurrent(IOUSBHubDevice *this, int a2)
{
  __int64 result; // rax@1

  result = *((_QWORD *)this + 32);
  *(_DWORD *)(result + 40) = a2;
  return result;
}

//----- (0000000000021E8A) ----------------------------------------------------
__int64 __fastcall IOUSBHubDevice::GetSleepCurrent(IOUSBHubDevice *this)
{
  return *(_DWORD *)(*((_QWORD *)this + 32) + 40LL);
}

//----- (0000000000021E9A) ----------------------------------------------------
void __fastcall IOUSBHubDevice::InitializeExtraPower(IOUSBHubDevice *this)
{
  ;
}

//----- (0000000000021EA0) ----------------------------------------------------
__int64 __fastcall IOUSBHubDevice::RequestExtraPower(IOUSBHubDevice *this)
{
  return 0LL;
}

//----- (0000000000021EA8) ----------------------------------------------------
void __fastcall IOUSBHubDevice::ReturnExtraPower(IOUSBHubDevice *this)
{
  ;
}

//----- (0000000000021EAE) ----------------------------------------------------
__int64 __fastcall IOUSBHubDevice::_RESERVEDIOUSBHubDevice7(IOUSBHubDevice *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBHubDevice::gMetaClass, 7);
}
// 498A8: using guessed type _QWORD IOUSBHubDevice::gMetaClass;

//----- (0000000000021EC4) ----------------------------------------------------
__int64 __fastcall IOUSBHubDevice::_RESERVEDIOUSBHubDevice8(IOUSBHubDevice *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBHubDevice::gMetaClass, 8);
}
// 498A8: using guessed type _QWORD IOUSBHubDevice::gMetaClass;

//----- (0000000000021EDA) ----------------------------------------------------
__int64 __fastcall IOUSBHubDevice::_RESERVEDIOUSBHubDevice9(IOUSBHubDevice *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBHubDevice::gMetaClass, 9);
}
// 498A8: using guessed type _QWORD IOUSBHubDevice::gMetaClass;

//----- (0000000000021EF0) ----------------------------------------------------
__int64 __fastcall IOUSBHubDevice::_RESERVEDIOUSBHubDevice10(IOUSBHubDevice *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBHubDevice::gMetaClass, 10);
}
// 498A8: using guessed type _QWORD IOUSBHubDevice::gMetaClass;

//----- (0000000000021F06) ----------------------------------------------------
__int64 __fastcall IOUSBHubDevice::_RESERVEDIOUSBHubDevice11(IOUSBHubDevice *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBHubDevice::gMetaClass, 11);
}
// 498A8: using guessed type _QWORD IOUSBHubDevice::gMetaClass;

//----- (0000000000021F1C) ----------------------------------------------------
__int64 __fastcall IOUSBHubDevice::_RESERVEDIOUSBHubDevice12(IOUSBHubDevice *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBHubDevice::gMetaClass, 12);
}
// 498A8: using guessed type _QWORD IOUSBHubDevice::gMetaClass;

//----- (0000000000021F32) ----------------------------------------------------
__int64 __fastcall IOUSBHubDevice::_RESERVEDIOUSBHubDevice13(IOUSBHubDevice *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBHubDevice::gMetaClass, 13);
}
// 498A8: using guessed type _QWORD IOUSBHubDevice::gMetaClass;

//----- (0000000000021F48) ----------------------------------------------------
__int64 __fastcall IOUSBHubDevice::_RESERVEDIOUSBHubDevice14(IOUSBHubDevice *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBHubDevice::gMetaClass, 14);
}
// 498A8: using guessed type _QWORD IOUSBHubDevice::gMetaClass;

//----- (0000000000021F5E) ----------------------------------------------------
__int64 __fastcall IOUSBHubDevice::_RESERVEDIOUSBHubDevice15(IOUSBHubDevice *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBHubDevice::gMetaClass, 15);
}
// 498A8: using guessed type _QWORD IOUSBHubDevice::gMetaClass;

//----- (0000000000021F74) ----------------------------------------------------
__int64 __fastcall IOUSBHubDevice::MetaClass::~MetaClass(IOUSBHubDevice::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000021F80) ----------------------------------------------------
__int64 `global constructor keyed to'_a_12()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(&IOUSBHubDevice::gMetaClass, "IOUSBHubDevice", &IOUSBDevice::gMetaClass, 264LL);
  result = (__int64)off_43850;
  IOUSBHubDevice::gMetaClass = off_43850;
  return result;
}
// 43850: using guessed type __int64 (__fastcall *off_43850[2])(IOUSBHubDevice::MetaClass *__hidden this);
// 49760: using guessed type _QWORD IOUSBDevice::gMetaClass;
// 498A8: using guessed type _QWORD IOUSBHubDevice::gMetaClass;
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000021FC0) ----------------------------------------------------
__int64 `global destructor keyed to'_a_12()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&IOUSBHubDevice::gMetaClass);
}
// 498A8: using guessed type _QWORD IOUSBHubDevice::gMetaClass;

//----- (0000000000021FE0) ----------------------------------------------------
__int64 __fastcall IOUSBHubPolicyMaker::MetaClass::MetaClass(IOUSBHubPolicyMaker::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBHubPolicyMaker", off_3B098[0], 200LL);
  result = (__int64)off_44270;
  *(_QWORD *)this = off_44270;
  return result;
}
// 3B098: using guessed type _QWORD off_3B098[15];
// 44270: using guessed type __int64 (__fastcall *off_44270[2])(IOUSBHubPolicyMaker::MetaClass *__hidden this);
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000022012) ----------------------------------------------------
__int64 __fastcall IOUSBHubPolicyMaker::MetaClass::~MetaClass(IOUSBHubPolicyMaker::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000002201C) ----------------------------------------------------
__int64 __fastcall IOUSBHubPolicyMaker::IOUSBHubPolicyMaker(__int64 a1)
{
  __int64 result; // rax@1

  IOService::IOService(a1);
  result = (__int64)off_43950;
  *(_QWORD *)a1 = off_43950;
  return result;
}
// 43950: using guessed type __int64 (__fastcall *off_43950[2])(IOUSBHubPolicyMaker *__hidden this);
// 7DEA0: using guessed type int __cdecl IOService::IOService(_QWORD);

//----- (000000000002203C) ----------------------------------------------------
__int64 __fastcall IOUSBHubPolicyMaker::~IOUSBHubPolicyMaker(IOUSBHubPolicyMaker *this)
{
  return IOService::~IOService(this);
}

//----- (0000000000022046) ----------------------------------------------------
__int64 __fastcall IOUSBHubPolicyMaker::~IOUSBHubPolicyMaker(IOUSBHubPolicyMaker *this)
{
  return IOService::~IOService(this);
}

//----- (0000000000022050) ----------------------------------------------------
void __fastcall IOUSBHubPolicyMaker::~IOUSBHubPolicyMaker(IOUSBHubPolicyMaker *this)
{
  IOService::~IOService(this);
  OSObject::operator delete((void *)this);
}

//----- (0000000000022072) ----------------------------------------------------
__int64 __fastcall IOUSBHubPolicyMaker::getMetaClass(IOUSBHubPolicyMaker *this)
{
  return (__int64)&IOUSBHubPolicyMaker::gMetaClass;
}
// 498D0: using guessed type _QWORD IOUSBHubPolicyMaker::gMetaClass;

//----- (0000000000022080) ----------------------------------------------------
__int64 __fastcall IOUSBHubPolicyMaker::MetaClass::MetaClass(IOUSBHubPolicyMaker::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBHubPolicyMaker", off_3B098[0], 200LL);
  result = (__int64)off_44270;
  *(_QWORD *)this = off_44270;
  return result;
}
// 3B098: using guessed type _QWORD off_3B098[15];
// 44270: using guessed type __int64 (__fastcall *off_44270[2])(IOUSBHubPolicyMaker::MetaClass *__hidden this);
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000220B2) ----------------------------------------------------
__int64 __fastcall IOUSBHubPolicyMaker::MetaClass::alloc(IOUSBHubPolicyMaker::MetaClass *this)
{
  return 0LL;
}

//----- (00000000000220BA) ----------------------------------------------------
int __fastcall IOUSBHubPolicyMaker::stop(IOUSBHubPolicyMaker *this, IOService *a2)
{
  IOService *v2; // rax@1

  v2 = (IOService *)IOService::getPMRootDomain(this);
  IOService::deRegisterInterestedDriver(v2, this);
  return (*(int (__fastcall **)(IOUSBHubPolicyMaker *, IOUSBHubPolicyMaker *))(*(_QWORD *)this + 1944LL))(this, this);
}

//----- (00000000000220E6) ----------------------------------------------------
char __usercall IOUSBHubPolicyMaker::start@<al>(IOUSBHubPolicyMaker *this@<rdi>, IOService *a2@<rsi>, char a3@<al>, const OSMetaClass *a4@<rdx>)
{
  __int64 v4; // rax@1
  OSMetaClassBase *v5; // rax@3
  const OSMetaClass *v6; // rdx@3
  OSMetaClassBase *v7; // rax@3
  const OSMetaClass *v8; // rdx@3
  __int64 v9; // rax@6
  __int64 v10; // rbx@6
  __int64 v11; // rax@8
  OSMetaClassBase *v12; // rax@8
  OSMetaClassBase *v13; // rbx@8
  const OSMetaClassBase *v14; // r14@8
  const char *v15; // rsi@8
  const OSMetaClass *v16; // rdx@8
  __int64 v17; // rax@8
  int v18; // eax@9
  signed int v19; // ecx@9
  __int64 v20; // rax@15
  __int64 v21; // rbx@15
  int v22; // er12@16
  OSMetaClassBase *v23; // rax@18
  const OSMetaClass *v24; // rdx@18
  __int64 v25; // r15@18
  char v26; // al@19
  int v27; // ecx@20
  int v28; // eax@22
  OSMetaClassBase *v29; // rax@29
  const OSMetaClass *v30; // rdx@29
  __int64 v31; // rax@29
  int v32; // eax@30
  int v33; // eax@31
  __int64 v34; // r8@31
  __int64 v35; // r9@31
  char v36; // bl@32
  IOService *v38; // rax@36
  char v39; // [sp-8h] [bp-30h]@1

  v39 = a3;
  v4 = OSMetaClassBase::safeMetaCast(a2, (const OSMetaClassBase *)IOUSBHubDevice::metaClass, a4);
  *((_QWORD *)this + 18) = v4;
  if ( !v4 )
    return 0;
  if ( !(unsigned __int8)(*(int (__fastcall **)(IOUSBHubPolicyMaker *, IOService *))(off_3B0D8[0] + 1488))(this, a2) )
    return 0;
  LODWORD(v5) = (*(int (**)(void))(**((_QWORD **)this + 18) + 2264LL))();
  v7 = (OSMetaClassBase *)OSMetaClassBase::safeMetaCast(v5, (const OSMetaClassBase *)IOUSBControllerV2::metaClass, v6);
  *((_QWORD *)this + 17) = v7;
  if ( !v7 )
    return 0;
  if ( !OSMetaClassBase::safeMetaCast(v7, (const OSMetaClassBase *)IOUSBControllerV3::metaClass, v8)
    || gUSBStackDebugFlags & 0x20
    || (LODWORD(v9) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 18) + 696LL))(
                        *((_QWORD *)this + 18),
                        "kUSBHubDontAllowLowPower"),
        v10 = *(_QWORD *)off_3B0F8[0],
        v9 == **(_QWORD **)off_3B0F8[0]) )
  {
    *((_BYTE *)this + 162) = 1;
    v10 = *(_QWORD *)off_3B0F8[0];
  }
  LODWORD(v11) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 18) + 696LL))(
                   *((_QWORD *)this + 18),
                   "kUSBNoExtraSleepCurrent");
  *((_BYTE *)this + 163) = v11 == *(_QWORD *)v10;
  LODWORD(v12) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 18) + 744LL))(
                   *((_QWORD *)this + 18),
                   "kUSBDeviceResumeRecoveryTime");
  v13 = v12;
  v14 = *(const OSMetaClassBase **)off_3B078[0];
  v15 = *(const char **)off_3B078[0];
  v17 = OSMetaClassBase::safeMetaCast(v12, *(const OSMetaClassBase **)off_3B078[0], v16);
  if ( v17 )
  {
    v18 = (*(int (__fastcall **)(__int64, const char *))(*(_QWORD *)v17 + 328LL))(v17, v15);
    v19 = 10;
    if ( (unsigned int)v18 >= 0xA )
      v19 = v18;
    *((_DWORD *)this + 46) = v19;
  }
  else
  {
    *((_DWORD *)this + 46) = 10;
  }
  if ( v13 )
    (*(void (__fastcall **)(OSMetaClassBase *))(*(_QWORD *)v13 + 40LL))(v13);
  *((_DWORD *)this + 41) = -1;
  (*(void (__fastcall **)(IOUSBHubPolicyMaker *))(*(_QWORD *)this + 1936LL))(this);
  IOService::makeUsable(this);
  v20 = IORegistryEntry::getPlane("IOUSB", v15);
  v21 = v20;
  if ( v20 )
  {
    v22 = (*(int (__cdecl **)(_QWORD))(**((_QWORD **)this + 18) + 2616LL))(*((_QWORD *)this + 18));
    if ( v22 & 1 )
    {
      *((_BYTE *)this + 160) = 1;
      LODWORD(v20) = (*(int (__fastcall **)(_QWORD, IOUSBHubPolicyMaker *))(**((_QWORD **)this + 17) + 1952LL))(
                       *((_QWORD *)this + 17),
                       this);
    }
    else
    {
      LODWORD(v23) = (*(int (__fastcall **)(_QWORD, __int64))(**((_QWORD **)this + 18) + 792LL))(
                       *((_QWORD *)this + 18),
                       v21);
      v20 = OSMetaClassBase::safeMetaCast(v23, (const OSMetaClassBase *)IOUSBHubDevice::metaClass, v24);
      v25 = v20;
      if ( v20 )
      {
        *((_QWORD *)this + 19) = v20;
        v26 = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v20 + 2616LL))(v20, IOUSBHubDevice::metaClass);
        if ( v26 & 2 )
          v27 = v22 | 2;
        else
          v27 = v22 | v26 & 8;
        v28 = v27 | v26 & 4;
        if ( v28 != v22 )
          (*(void (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 18) + 2592LL))(
            *((_QWORD *)this + 18),
            (unsigned int)v28);
        LODWORD(v20) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v25 + 2608LL))(v25);
        if ( v20 )
          LODWORD(v20) = (*(int (__fastcall **)(__int64, IOUSBHubPolicyMaker *))(*(_QWORD *)v20 + 1952LL))(v20, this);
      }
    }
  }
  if ( !*((_BYTE *)this + 160) )
    IOUSBHubPolicyMaker::AllocateExtraPower(this, v20);
  if ( !(unsigned __int8)(*(int (__fastcall **)(IOUSBHubPolicyMaker *))(*(_QWORD *)this + 2136LL))(this) )
  {
    (*(void (__fastcall **)(IOUSBHubPolicyMaker *))(*(_QWORD *)this + 1944LL))(this);
    return 0;
  }
  LODWORD(v29) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 18) + 696LL))(
                   *((_QWORD *)this + 18),
                   "AAPL,standard-port-current-in-sleep");
  v31 = OSMetaClassBase::safeMetaCast(v29, v14, v30);
  if ( v31 )
  {
    v32 = (*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v31 + 328LL))(v31, v14);
    (*(void (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 18) + 2680LL))(
      *((_QWORD *)this + 18),
      (unsigned int)v32);
  }
  v33 = (*(int (__fastcall **)(IOUSBHubPolicyMaker *, IOUSBHubPolicyMaker *, _QWORD *, signed __int64))(*(_QWORD *)this + 1960LL))(
          this,
          this,
          &ourPowerStates,
          5LL);
  if ( v33 )
  {
    v36 = 0;
    KernelDebugLogInternal(
      1u,
      0x55534246u,
      (__int64)"IOUSBHubPolicyMaker::start - err [0x%x] from registerPowerDriver",
      (unsigned int)v33,
      v34,
      v35,
      v39);
    (*(void (__fastcall **)(IOUSBHubPolicyMaker *, signed __int64))(*(_QWORD *)this + 1944LL))(this, 1431519814LL);
  }
  else
  {
    v38 = (IOService *)IOService::getPMRootDomain(this);
    IOService::registerInterestedDriver(v38, this);
    (*(void (__fastcall **)(_QWORD, IOUSBHubPolicyMaker *))(**((_QWORD **)this + 18) + 2584LL))(
      *((_QWORD *)this + 18),
      this);
    v36 = 1;
  }
  return v36;
}
// 3B078: using guessed type _QWORD off_3B078[19];
// 3B0D8: using guessed type __int64 off_3B0D8[7];
// 3B0F8: using guessed type __int64 off_3B0F8[3];
// 419C0: using guessed type _QWORD IOUSBControllerV2::metaClass;
// 42D30: using guessed type _QWORD IOUSBHubDevice::metaClass;
// 44350: using guessed type _QWORD IOUSBControllerV3::metaClass;
// 49180: using guessed type _QWORD ourPowerStates;
// 49460: using guessed type int gUSBStackDebugFlags;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000002244E) ----------------------------------------------------
int __usercall IOUSBHubPolicyMaker::AllocateExtraPower@<eax>(IOUSBHubPolicyMaker *this@<rdi>, int result@<eax>)
{
  IOUSBHubPolicyMaker *v2; // rbx@1
  __int64 v3; // rdi@1
  int v4; // er14@2
  OSMetaClassBase *v5; // rax@4
  const OSMetaClassBase *v6; // r15@4
  __int64 v7; // rsi@4
  const OSMetaClass *v8; // rdx@4
  __int64 v9; // rax@4
  OSMetaClassBase *v10; // rax@6
  const OSMetaClass *v11; // rdx@6
  __int64 v12; // rax@6
  int v13; // er12@6
  int v14; // er13@6
  OSMetaClassBase *v15; // rax@8
  const OSMetaClass *v16; // rdx@8
  __int64 v17; // rax@8
  OSMetaClassBase *v18; // rax@10
  const OSMetaClass *v19; // rdx@10
  __int64 v20; // rax@10
  __int64 v21; // rdx@10
  __int64 v22; // r8@10

  v2 = this;
  v3 = *((_QWORD *)this + 18);
  if ( v3 )
  {
    v4 = 500;
    if ( (unsigned __int8)(*(int (__cdecl **)(__int64))(*(_QWORD *)v3 + 2256LL))(v3) == 3 )
      v4 = 900;
    LODWORD(v5) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)v2 + 18) + 696LL))(
                    *((_QWORD *)v2 + 18),
                    "AAPL,current-available");
    v6 = *(const OSMetaClassBase **)off_3B078[0];
    v7 = *(_QWORD *)off_3B078[0];
    v9 = OSMetaClassBase::safeMetaCast(v5, *(const OSMetaClassBase **)off_3B078[0], v8);
    if ( v9 )
      v4 = (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v9 + 328LL))(v9, v7);
    LODWORD(v10) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)v2 + 18) + 696LL))(
                     *((_QWORD *)v2 + 18),
                     "AAPL,current-extra");
    v12 = OSMetaClassBase::safeMetaCast(v10, v6, v11);
    v13 = 0;
    v14 = 0;
    if ( v12 )
      v14 = (*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v12 + 328LL))(v12, v6);
    LODWORD(v15) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)v2 + 18) + 696LL))(
                     *((_QWORD *)v2 + 18),
                     "AAPL,max-port-current-in-sleep");
    v17 = OSMetaClassBase::safeMetaCast(v15, v6, v16);
    if ( v17 )
      v13 = (*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v17 + 328LL))(v17, v6);
    LODWORD(v18) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)v2 + 18) + 696LL))(
                     *((_QWORD *)v2 + 18),
                     "AAPL,current-extra-in-sleep");
    v20 = OSMetaClassBase::safeMetaCast(v18, v6, v19);
    v22 = 0LL;
    if ( v20 )
      v22 = (unsigned int)(*(int (__fastcall **)(__int64, const OSMetaClassBase *, __int64, _QWORD, _QWORD))(*(_QWORD *)v20 + 328LL))(
                            v20,
                            v6,
                            v21,
                            *(_QWORD *)v20,
                            0LL);
    result = (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, __int64))(**((_QWORD **)v2 + 18) + 2696LL))(
               *((_QWORD *)v2 + 18),
               (unsigned int)v4,
               (unsigned int)v14,
               (unsigned int)v13,
               v22);
  }
  return result;
}
// 3B078: using guessed type _QWORD off_3B078[19];
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (00000000000225B4) ----------------------------------------------------
int __fastcall IOUSBHubPolicyMaker::powerStateForDomainState(IOUSBHubPolicyMaker *this)
{
  return (*(int (__fastcall **)(IOUSBHubPolicyMaker *))(off_3B0D8[0] + 2064))(this);
}
// 3B0D8: using guessed type __int64 off_3B0D8[7];

//----- (00000000000225C6) ----------------------------------------------------
int __fastcall IOUSBHubPolicyMaker::maxCapabilityForDomainState(IOUSBHubPolicyMaker *this)
{
  return (*(int (__fastcall **)(IOUSBHubPolicyMaker *))(off_3B0D8[0] + 2048))(this);
}
// 3B0D8: using guessed type __int64 off_3B0D8[7];

//----- (00000000000225D8) ----------------------------------------------------
int __fastcall IOUSBHubPolicyMaker::powerStateWillChangeTo(IOUSBHubPolicyMaker *this, __int64 a2, __int64 a3, IOService *a4)
{
  IOService *v4; // r12@1
  __int64 v5; // r14@1

  v4 = a4;
  v5 = a3;
  if ( this == a4 )
    *((_DWORD *)this + 41) = a3;
  else
    IOService::getPMRootDomain(this);
  return (*(int (__fastcall **)(IOUSBHubPolicyMaker *, __int64, __int64, IOService *))(off_3B0D8[0] + 2072))(
           this,
           a2,
           v5,
           v4);
}
// 3B0D8: using guessed type __int64 off_3B0D8[7];

//----- (0000000000022624) ----------------------------------------------------
int __fastcall IOUSBHubPolicyMaker::setPowerState(uintptr_t arg1, unsigned __int64 a2, IOService *a3)
{
  signed int v3; // er14@2

  if ( (IOService *)arg1 != a3 )
  {
    v3 = 0;
    if ( gUSBStackDebugFlags & 2 )
    {
      if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        v3 = 0;
        kernel_debug(0x52D8C04u, arg1, (signed int)a2, (uintptr_t)a3, *(_DWORD *)(arg1 + 168), 0LL);
      }
    }
    return v3;
  }
  v3 = 0;
  if ( (unsigned __int8)IOService::isInactive(a3) )
    return v3;
  if ( a2 >= 5 )
  {
    v3 = 5;
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D8C04u, arg1, (signed int)a2, *(_DWORD *)(arg1 + 168), 5uLL, 0LL);
    return v3;
  }
  if ( *(_QWORD *)(arg1 + 168) == a2 )
    return v3;
  return (*(int (__fastcall **)(_QWORD))(*(_QWORD *)arg1 + 2144LL))(arg1);
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (0000000000022710) ----------------------------------------------------
int __fastcall IOUSBHubPolicyMaker::powerStateDidChangeTo(IOUSBHubPolicyMaker *this, __int64 a2, __int64 a3, IOService *a4)
{
  IOService *v4; // r12@1
  __int64 v5; // r14@1

  v4 = a4;
  v5 = a3;
  if ( this == a4 )
    *((_QWORD *)this + 21) = a3;
  else
    IOService::getPMRootDomain(this);
  return (*(int (__fastcall **)(IOUSBHubPolicyMaker *, __int64, __int64, IOService *))(off_3B0D8[0] + 2080))(
           this,
           a2,
           v5,
           v4);
}
// 3B0D8: using guessed type __int64 off_3B0D8[7];

//----- (000000000002275C) ----------------------------------------------------
int __fastcall IOUSBHubPolicyMaker::powerChangeDone(IOUSBHubPolicyMaker *this, __int64 a2)
{
  __int64 v2; // rax@2

  if ( (unsigned __int8)IOService::isInactive(this) )
  {
    v2 = (unsigned int)IOService::getPowerState(this);
    if ( *((_QWORD *)this + 21) != (unsigned int)v2 )
      *((_QWORD *)this + 21) = v2;
  }
  *((_DWORD *)this + 41) = -1;
  if ( *((_BYTE *)this + 160) && *((_QWORD *)this + 21) <= 1uLL )
    IOService::changePowerStateTo(this, 4uLL);
  return (*(int (__fastcall **)(IOUSBHubPolicyMaker *, __int64))(off_3B0D8[0] + 2136))(this, a2);
}
// 3B0D8: using guessed type __int64 off_3B0D8[7];

//----- (00000000000227CE) ----------------------------------------------------
__int64 __fastcall IOUSBHubPolicyMaker::EnsureUsability(IOUSBHubPolicyMaker *this)
{
  if ( *((_QWORD *)this + 21) != 4LL || *((_BYTE *)this + 161) )
  {
    *((_BYTE *)this + 161) = 0;
    IOService::changePowerStateToPriv(this, 4uLL);
  }
  return 0LL;
}

//----- (00000000000227FA) ----------------------------------------------------
int __fastcall IOUSBHubPolicyMaker::RequestExtraPower(IOUSBHubPolicyMaker *this, __int64 a2, unsigned int a3, unsigned int a4)
{
  __int64 v4; // rdi@1
  int result; // eax@2

  v4 = *((_QWORD *)this + 18);
  if ( v4 )
    result = (*(int (__fastcall **)(__int64, _QWORD, _QWORD))(*(_QWORD *)v4 + 2496LL))(v4, a3, a4);
  else
    result = 0;
  return result;
}

//----- (0000000000022820) ----------------------------------------------------
int __fastcall IOUSBHubPolicyMaker::ReturnExtraPower(IOUSBHubPolicyMaker *this, __int64 a2, unsigned int a3, unsigned int a4)
{
  __int64 v4; // rdi@1
  int result; // eax@2

  v4 = *((_QWORD *)this + 18);
  if ( v4 )
    result = (*(int (__fastcall **)(__int64, _QWORD, _QWORD))(*(_QWORD *)v4 + 2504LL))(v4, a3, a4);
  else
    result = 0;
  return result;
}

//----- (0000000000022846) ----------------------------------------------------
__int64 __fastcall IOUSBHubPolicyMaker::GetExtraPortPower(IOUSBHubPolicyMaker *this, __int64 a2, unsigned int *a3)
{
  return 3758097095LL;
}

//----- (0000000000022852) ----------------------------------------------------
__int64 __fastcall IOUSBHubPolicyMaker::ReturnExtraPortPower(IOUSBHubPolicyMaker *this)
{
  return 3758097095LL;
}

//----- (000000000002285E) ----------------------------------------------------
__int64 __fastcall IOUSBHubPolicyMaker::GetPortInformation(IOUSBHubPolicyMaker *this, __int64 a2, unsigned int *a3)
{
  return 3758097095LL;
}

//----- (000000000002286A) ----------------------------------------------------
__int64 __fastcall IOUSBHubPolicyMaker::ResetPort(IOUSBHubPolicyMaker *this)
{
  return 3758097095LL;
}

//----- (0000000000022876) ----------------------------------------------------
__int64 __fastcall IOUSBHubPolicyMaker::SuspendPort(IOUSBHubPolicyMaker *this)
{
  return 3758097095LL;
}

//----- (0000000000022882) ----------------------------------------------------
__int64 __fastcall IOUSBHubPolicyMaker::ReEnumeratePort(IOUSBHubPolicyMaker *this)
{
  return 3758097095LL;
}

//----- (000000000002288E) ----------------------------------------------------
signed __int64 __fastcall IOUSBHubPolicyMaker::ProcessUSBNotification(IOUSBHubPolicyMaker *this, __int64 a2, IOUSBNotification *a3)
{
  return 3758097095LL;
}

//----- (000000000002289A) ----------------------------------------------------
int __fastcall IOUSBHubPolicyMaker::GetMinimumIdlePowerState(IOUSBHubPolicyMaker *this, __int64 a2, const OSMetaClass *a3)
{
  __int64 v3; // rax@2
  int result; // eax@3

  if ( *((_QWORD *)this + 18)
    && (v3 = OSMetaClassBase::safeMetaCast(
               *((OSMetaClassBase **)this + 17),
               (const OSMetaClassBase *)IOUSBControllerV3::metaClass,
               a3)) != 0 )
    result = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v3 + 3336LL))(v3, IOUSBControllerV3::metaClass);
  else
    result = 3;
  return result;
}
// 44350: using guessed type _QWORD IOUSBControllerV3::metaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (00000000000228D8) ----------------------------------------------------
__int64 __fastcall IOUSBHubPolicyMaker::GetPowerExitLatencies(uintptr_t arg1, uintptr_t arg3, const OSMetaClass *a3)
{
  uintptr_t v3; // r14@1
  uintptr_t v4; // r12@1
  uintptr_t v5; // rsi@1
  uintptr_t v6; // r15@1
  int v7; // ebx@5
  int v8; // eax@6
  __int64 v9; // rdi@7
  __int64 v10; // rax@8

  v3 = arg3;
  v4 = arg1;
  v5 = IOUSBControllerV3::metaClass;
  v6 = OSMetaClassBase::safeMetaCast(
         *(OSMetaClassBase **)(arg1 + 136),
         (const OSMetaClassBase *)IOUSBControllerV3::metaClass,
         a3);
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
  {
    v5 = arg1;
    kernel_debug(0x52D8C09u, arg1, v6, v3, *(_BYTE *)(arg1 + 160), 0LL);
  }
  if ( *(_BYTE *)(arg1 + 160) )
  {
    v7 = 0;
    if ( v6 )
    {
      v8 = (*(int (__fastcall **)(uintptr_t, uintptr_t))(*(_QWORD *)v6 + 3368LL))(v6, v3);
LABEL_10:
      v7 = v8;
      goto LABEL_11;
    }
  }
  else
  {
    v9 = *(_QWORD *)(arg1 + 144);
    v7 = 0;
    if ( v9 )
    {
      LODWORD(v10) = (*(int (__fastcall **)(__int64, uintptr_t))(*(_QWORD *)v9 + 2480LL))(v9, v5);
      if ( v10 )
      {
        v8 = (*(int (__fastcall **)(__int64, uintptr_t))(*(_QWORD *)v10 + 2216LL))(v10, v3);
        goto LABEL_10;
      }
    }
  }
LABEL_11:
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D8C0Au, v4, v6, v3, v7, 0LL);
  return (unsigned int)v7;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 44350: using guessed type _QWORD IOUSBControllerV3::metaClass;
// 49460: using guessed type int gUSBStackDebugFlags;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (00000000000229D4) ----------------------------------------------------
__int64 __fastcall IOUSBHubPolicyMaker::_RESERVEDIOUSBHubPolicyMaker9(IOUSBHubPolicyMaker *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBHubPolicyMaker::gMetaClass, 9);
}
// 498D0: using guessed type _QWORD IOUSBHubPolicyMaker::gMetaClass;

//----- (00000000000229EA) ----------------------------------------------------
__int64 __fastcall IOUSBHubPolicyMaker::_RESERVEDIOUSBHubPolicyMaker10(IOUSBHubPolicyMaker *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBHubPolicyMaker::gMetaClass, 10);
}
// 498D0: using guessed type _QWORD IOUSBHubPolicyMaker::gMetaClass;

//----- (0000000000022A00) ----------------------------------------------------
__int64 __fastcall IOUSBHubPolicyMaker::_RESERVEDIOUSBHubPolicyMaker11(IOUSBHubPolicyMaker *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBHubPolicyMaker::gMetaClass, 11);
}
// 498D0: using guessed type _QWORD IOUSBHubPolicyMaker::gMetaClass;

//----- (0000000000022A16) ----------------------------------------------------
__int64 __fastcall IOUSBHubPolicyMaker::_RESERVEDIOUSBHubPolicyMaker12(IOUSBHubPolicyMaker *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBHubPolicyMaker::gMetaClass, 12);
}
// 498D0: using guessed type _QWORD IOUSBHubPolicyMaker::gMetaClass;

//----- (0000000000022A2C) ----------------------------------------------------
__int64 __fastcall IOUSBHubPolicyMaker::_RESERVEDIOUSBHubPolicyMaker13(IOUSBHubPolicyMaker *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBHubPolicyMaker::gMetaClass, 13);
}
// 498D0: using guessed type _QWORD IOUSBHubPolicyMaker::gMetaClass;

//----- (0000000000022A42) ----------------------------------------------------
__int64 __fastcall IOUSBHubPolicyMaker::_RESERVEDIOUSBHubPolicyMaker14(IOUSBHubPolicyMaker *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBHubPolicyMaker::gMetaClass, 14);
}
// 498D0: using guessed type _QWORD IOUSBHubPolicyMaker::gMetaClass;

//----- (0000000000022A58) ----------------------------------------------------
__int64 __fastcall IOUSBHubPolicyMaker::_RESERVEDIOUSBHubPolicyMaker15(IOUSBHubPolicyMaker *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBHubPolicyMaker::gMetaClass, 15);
}
// 498D0: using guessed type _QWORD IOUSBHubPolicyMaker::gMetaClass;

//----- (0000000000022A6E) ----------------------------------------------------
__int64 __fastcall IOUSBHubPolicyMaker::_RESERVEDIOUSBHubPolicyMaker16(IOUSBHubPolicyMaker *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBHubPolicyMaker::gMetaClass, 16);
}
// 498D0: using guessed type _QWORD IOUSBHubPolicyMaker::gMetaClass;

//----- (0000000000022A84) ----------------------------------------------------
__int64 __fastcall IOUSBHubPolicyMaker::_RESERVEDIOUSBHubPolicyMaker17(IOUSBHubPolicyMaker *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBHubPolicyMaker::gMetaClass, 17);
}
// 498D0: using guessed type _QWORD IOUSBHubPolicyMaker::gMetaClass;

//----- (0000000000022A9A) ----------------------------------------------------
__int64 __fastcall IOUSBHubPolicyMaker::_RESERVEDIOUSBHubPolicyMaker18(IOUSBHubPolicyMaker *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBHubPolicyMaker::gMetaClass, 18);
}
// 498D0: using guessed type _QWORD IOUSBHubPolicyMaker::gMetaClass;

//----- (0000000000022AB0) ----------------------------------------------------
__int64 __fastcall IOUSBHubPolicyMaker::_RESERVEDIOUSBHubPolicyMaker19(IOUSBHubPolicyMaker *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBHubPolicyMaker::gMetaClass, 19);
}
// 498D0: using guessed type _QWORD IOUSBHubPolicyMaker::gMetaClass;

//----- (0000000000022AC6) ----------------------------------------------------
__int64 __fastcall IOUSBHubPolicyMaker::MetaClass::~MetaClass(IOUSBHubPolicyMaker::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000022AD0) ----------------------------------------------------
__int64 `global constructor keyed to'_a_13()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(&IOUSBHubPolicyMaker::gMetaClass, "IOUSBHubPolicyMaker", off_3B098[0], 200LL);
  result = (__int64)off_44270;
  IOUSBHubPolicyMaker::gMetaClass = off_44270;
  return result;
}
// 3B098: using guessed type _QWORD off_3B098[15];
// 44270: using guessed type __int64 (__fastcall *off_44270[2])(IOUSBHubPolicyMaker::MetaClass *__hidden this);
// 498D0: using guessed type _QWORD IOUSBHubPolicyMaker::gMetaClass;
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000022B10) ----------------------------------------------------
__int64 `global destructor keyed to'_a_13()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&IOUSBHubPolicyMaker::gMetaClass);
}
// 498D0: using guessed type _QWORD IOUSBHubPolicyMaker::gMetaClass;

//----- (0000000000022B30) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::MetaClass::MetaClass(IOUSBControllerV3::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBControllerV3", &IOUSBControllerV2::gMetaClass, 680LL);
  result = (__int64)off_450E0;
  *(_QWORD *)this = off_450E0;
  return result;
}
// 450E0: using guessed type __int64 (__fastcall *off_450E0[2])(IOUSBControllerV3::MetaClass *__hidden this);
// 49808: using guessed type _QWORD IOUSBControllerV2::gMetaClass;
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000022B62) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::MetaClass::~MetaClass(IOUSBControllerV3::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000022B6C) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::IOUSBControllerV3(__int64 a1)
{
  __int64 result; // rax@1

  IOUSBControllerV2::IOUSBControllerV2(a1);
  result = (__int64)off_44370;
  *(_QWORD *)a1 = off_44370;
  return result;
}
// 44370: using guessed type __int64 (__fastcall *off_44370[2])(IOUSBControllerV3 *__hidden this);

//----- (0000000000022B8C) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::~IOUSBControllerV3(IOUSBControllerV3 *this)
{
  return IOUSBControllerV2::~IOUSBControllerV2(this);
}

//----- (0000000000022B96) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::~IOUSBControllerV3(IOUSBControllerV3 *this)
{
  return IOUSBControllerV2::~IOUSBControllerV2(this);
}

//----- (0000000000022BA0) ----------------------------------------------------
void __fastcall IOUSBControllerV3::~IOUSBControllerV3(IOUSBControllerV3 *this)
{
  IOUSBControllerV2::~IOUSBControllerV2(this);
  OSObject::operator delete((void *)this);
}

//----- (0000000000022BC2) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::getMetaClass(IOUSBControllerV3 *this)
{
  return (__int64)&IOUSBControllerV3::gMetaClass;
}
// 49900: using guessed type _QWORD IOUSBControllerV3::gMetaClass;

//----- (0000000000022BD0) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::MetaClass::MetaClass(IOUSBControllerV3::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBControllerV3", &IOUSBControllerV2::gMetaClass, 680LL);
  result = (__int64)off_450E0;
  *(_QWORD *)this = off_450E0;
  return result;
}
// 450E0: using guessed type __int64 (__fastcall *off_450E0[2])(IOUSBControllerV3::MetaClass *__hidden this);
// 49808: using guessed type _QWORD IOUSBControllerV2::gMetaClass;
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000022C02) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::MetaClass::alloc(IOUSBControllerV3::MetaClass *this)
{
  return 0LL;
}

//----- (0000000000022C0A) ----------------------------------------------------
char __fastcall IOUSBControllerV3::init(IOUSBControllerV3 *this, OSDictionary *a2)
{
  IOUSBControllerV3 *v2; // rbx@1
  IOUSBControllerV3 *v3; // rax@3
  char v4; // bl@5
  __int64 v5; // rax@6
  OSMetaClassBase *v6; // rax@6
  __int64 v7; // rsi@6
  const OSMetaClass *v8; // rdx@6
  __int64 v9; // rax@6
  __int64 v10; // rax@7

  v2 = this;
  if ( !(unsigned __int8)((int (__fastcall *)(IOUSBControllerV3 *, OSDictionary *))`vtable for'IOUSBControllerV2[75])(
                           this,
                           a2) )
    return 0;
  if ( !*((_QWORD *)this + 84) )
  {
    LODWORD(v3) = IOMalloc(392LL);
    *((_QWORD *)this + 84) = v3;
    if ( v3 )
    {
      this = v3;
      bzero((void *)v3, 0x188uLL);
      goto LABEL_5;
    }
    return 0;
  }
LABEL_5:
  *((_DWORD *)v2 + 112) = -1;
  v4 = 1;
  if ( !IOUSBControllerV3::_gHibernateState )
  {
    v5 = IOService::getPMRootDomain(this);
    LODWORD(v6) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v5 + 696LL))(v5, "IOHibernateState");
    v7 = *(_QWORD *)off_3B068[0];
    v9 = OSMetaClassBase::safeMetaCast(v6, *(const OSMetaClassBase **)off_3B068[0], v8);
    if ( v9 )
    {
      LODWORD(v10) = (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v9 + 376LL))(v9, v7);
      IOUSBControllerV3::_gHibernateState = v10;
    }
  }
  return v4;
}
// 3B068: using guessed type _QWORD off_3B068[21];
// 419D0: using guessed type __int64 `vtable for'IOUSBControllerV2[2];
// 498F8: using guessed type _QWORD IOUSBControllerV3::_gHibernateState;
// 7D250: using guessed type int __fastcall IOMalloc(_QWORD);
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000022CBA) ----------------------------------------------------
char __fastcall IOUSBControllerV3::start(IOUSBControllerV3 *this, IOService *a2, const OSMetaClass *a3)
{
  IOService *v3; // r14@1
  uintptr_t v4; // rbx@1
  int (__fastcall *v5)(OSMetaClassBase *, __int64, const OSMetaClass *); // rsi@1
  __int64 v6; // rax@1
  int v7; // eax@3
  uintptr_t v8; // rdx@6
  uintptr_t v9; // r8@6
  char *v10; // r12@9
  __int64 v11; // rax@12
  __int64 v12; // rdi@13
  int (__fastcall *v13)(OSMetaClassBase *, __int64, const OSMetaClass *); // rax@16
  __int64 v14; // rax@26
  __int64 v15; // r15@26
  __int64 v16; // rax@28
  __int64 v17; // r15@28
  __int64 v18; // rax@30
  __int64 v19; // r15@30
  __int64 v20; // rax@32
  __int64 v21; // r15@32
  __int64 v22; // rax@34
  __int64 v23; // r15@34
  __int64 v24; // rax@36
  __int64 v25; // r14@36
  __int64 v26; // rdi@37
  int v27; // eax@40
  __int64 v28; // rdi@45
  __int64 v29; // rdi@47
  __int64 v30; // rdi@48
  unsigned __int8 v32; // [sp+Fh] [bp-21h]@1

  v3 = a2;
  v4 = (uintptr_t)this;
  v32 = 0;
  v5 = (int (__fastcall *)(OSMetaClassBase *, __int64, const OSMetaClass *))*off_3B020[0];
  v6 = OSMetaClassBase::safeMetaCast(v3, (const OSMetaClassBase *)*off_3B020[0], a3);
  *((_QWORD *)this + 61) = v6;
  if ( !v6 )
    goto LABEL_45;
  if ( *(_BYTE *)(*((_QWORD *)this + 21) + 40LL) == 1 )
  {
    v5 = (int (__fastcall *)(OSMetaClassBase *, __int64, const OSMetaClass *))v3;
    v7 = (*(int (__fastcall **)(IOUSBControllerV3 *, IOService *))(*(_QWORD *)this + 2928LL))(this, v3);
    if ( v7 )
    {
      if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
        goto LABEL_45;
      v8 = v7;
      v9 = 1LL;
      goto LABEL_44;
    }
    v6 = *((_QWORD *)this + 61);
  }
  (*(void (__fastcall **)(__int64, signed __int64, char *))(*(_QWORD *)v6 + 2272LL))(v6, 1LL, &v32);
  if ( v32 <= 0x3Fu )
  {
    v10 = (char *)this + 672;
  }
  else
  {
    v10 = (char *)this + 672;
    *(_WORD *)(*((_QWORD *)this + 84) + 264LL) = v32 + 4;
  }
  *(_QWORD *)(*((_QWORD *)this + 84) + 272LL) = IOUSBController::CopyACPIDevice(this, *((IORegistryEntry **)this + 61));
  v5 = (int (__fastcall *)(OSMetaClassBase *, __int64, const OSMetaClass *))v3;
  if ( !(unsigned __int8)((int (__fastcall *)(IOUSBControllerV3 *, IOService *))`vtable for'IOUSBControllerV2[186])(
                           this,
                           v3) )
    goto LABEL_45;
  v11 = *((_QWORD *)this + 21);
  if ( v11 )
  {
    v12 = *(_QWORD *)(v11 + 16);
    if ( v12 )
    {
      if ( *(_BYTE *)(v11 + 25) )
      {
        *(_BYTE *)(v11 + 25) = 0;
        (*(void (**)(void))(*(_QWORD *)v12 + 536LL))();
      }
    }
  }
  v5 = IOUSBControllerV3::RootHubTimerFired;
  LODWORD(v13) = IOTimerEventSource::timerEventSource(v4, IOUSBControllerV3::RootHubTimerFired);
  *(_QWORD *)(v4 + 496) = v13;
  if ( !v13 )
  {
    if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
      goto LABEL_45;
    v8 = -536870211LL;
    v9 = 2LL;
    goto LABEL_44;
  }
  v5 = v13;
  if ( (*(int (__fastcall **)(_QWORD, int (__fastcall *)(OSMetaClassBase *, __int64, const OSMetaClass *)))(**(_QWORD **)(v4 + 136) + 320LL))(
         *(_QWORD *)(v4 + 136),
         v13) )
  {
    if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
      goto LABEL_45;
    v8 = -536870212LL;
    v9 = 3LL;
    goto LABEL_44;
  }
  if ( *(_BYTE *)(*(_QWORD *)(v4 + 168) + 244LL) && *(_QWORD *)v10 )
  {
    LODWORD(v14) = (*(int (__fastcall **)(IOService *, _QWORD))(*(_QWORD *)v3 + 744LL))(v3, "AAPL,current-extra");
    v15 = v14;
    if ( v14 )
    {
      *(_DWORD *)(*(_QWORD *)v10 + 304LL) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v14 + 328LL))(v14);
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v15 + 40LL))(v15);
    }
    LODWORD(v16) = (*(int (__fastcall **)(IOService *, _QWORD))(*(_QWORD *)v3 + 744LL))(
                     v3,
                     "AAPL,current-extra-in-sleep");
    v17 = v16;
    if ( v16 )
    {
      *(_DWORD *)(*(_QWORD *)v10 + 308LL) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v16 + 328LL))(v16);
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v17 + 40LL))(v17);
    }
    LODWORD(v18) = (*(int (__fastcall **)(IOService *, _QWORD))(*(_QWORD *)v3 + 744LL))(v3, "AAPL,current-available");
    v19 = v18;
    if ( v18 )
    {
      *(_DWORD *)(*(_QWORD *)v10 + 312LL) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v18 + 328LL))(v18);
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v19 + 40LL))(v19);
    }
    LODWORD(v20) = (*(int (__fastcall **)(IOService *, _QWORD))(*(_QWORD *)v3 + 744LL))(
                     v3,
                     "AAPL,max-port-current-in-sleep");
    v21 = v20;
    if ( v20 )
    {
      *(_DWORD *)(*(_QWORD *)v10 + 316LL) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v20 + 328LL))(v20);
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v21 + 40LL))(v21);
    }
    LODWORD(v22) = (*(int (__fastcall **)(IOService *, _QWORD))(*(_QWORD *)v3 + 744LL))(v3, "AAPL,device-internal");
    v23 = v22;
    if ( v22 )
    {
      *(_DWORD *)(*(_QWORD *)v10 + 336LL) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v22 + 328LL))(v22);
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v23 + 40LL))(v23);
    }
    v5 = (int (__fastcall *)(OSMetaClassBase *, __int64, const OSMetaClass *))"AAPL,ExternalConnectorBitmap";
    LODWORD(v24) = (*(int (__fastcall **)(IOService *, _QWORD))(*(_QWORD *)v3 + 744LL))(
                     v3,
                     "AAPL,ExternalConnectorBitmap");
    v25 = v24;
    if ( v24 )
    {
      *(_DWORD *)(*(_QWORD *)(v4 + 672) + 340LL) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v24 + 328LL))(v24);
      v26 = *(_QWORD *)(*(_QWORD *)(v4 + 168) + 216LL);
      if ( v26 )
      {
        v5 = (int (__fastcall *)(OSMetaClassBase *, __int64, const OSMetaClass *))"AAPL,device-internal";
        (*(void (__fastcall **)(__int64, _QWORD, __int64))(*(_QWORD *)v26 + 616LL))(v26, "AAPL,device-internal", v25);
      }
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v25 + 40LL))(v25);
      *(_BYTE *)(*(_QWORD *)v10 + 344LL) = 1;
    }
  }
  v27 = (*(int (__fastcall **)(uintptr_t))(*(_QWORD *)v4 + 2944LL))(v4);
  if ( !v27 )
  {
    IOUSBControllerV3::UpdateThunderboltExtraCurrentiVars((IOUSBControllerV3 *)v4);
    return 1;
  }
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
  {
    v8 = v27;
    v9 = 4LL;
LABEL_44:
    v5 = (int (__fastcall *)(OSMetaClassBase *, __int64, const OSMetaClass *))v4;
    kernel_debug(0x52D0050u, v4, v8, 0LL, v9, 0LL);
  }
LABEL_45:
  v28 = *(_QWORD *)(v4 + 464);
  if ( v28 )
  {
    (*(void (__fastcall **)(__int64, int (__fastcall *)(OSMetaClassBase *, __int64, const OSMetaClass *)))(*(_QWORD *)v28 + 40LL))(
      v28,
      v5);
    *(_QWORD *)(v4 + 464) = 0LL;
  }
  v29 = *(_QWORD *)(v4 + 496);
  if ( v29 )
  {
    (*(void (__fastcall **)(__int64, int (__fastcall *)(OSMetaClassBase *, __int64, const OSMetaClass *)))(*(_QWORD *)v29 + 536LL))(
      v29,
      v5);
    v30 = *(_QWORD *)(v4 + 136);
    if ( v30 )
      (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v30 + 328LL))(v30, *(_QWORD *)(v4 + 496));
    (*(void (**)(void))(**(_QWORD **)(v4 + 496) + 40LL))();
    *(_QWORD *)(v4 + 496) = 0LL;
  }
  return 0;
}
// 3B020: using guessed type _QWORD *off_3B020[7];
// 3B100: using guessed type __int64 off_3B100[2];
// 419D0: using guessed type __int64 `vtable for'IOUSBControllerV2[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);
// 7D878: using guessed type int __fastcall IOTimerEventSource::timerEventSource(_QWORD, _QWORD);

//----- (0000000000023120) ----------------------------------------------------
int __fastcall IOUSBControllerV3::RootHubTimerFired(OSMetaClassBase *a1, __int64 a2, const OSMetaClass *a3)
{
  uintptr_t v3; // rsi@1
  IOService *v4; // rax@1
  uintptr_t v5; // rbx@1
  __int64 v6; // rdi@4
  __int64 v7; // rax@5
  IOService *v8; // rax@7
  __int64 v9; // rdi@8
  __int64 v10; // rax@9
  IOService *v11; // rax@11
  uintptr_t v12; // rax@13
  uintptr_t v13; // r14@13
  IOService *v14; // rax@13
  unsigned int v15; // eax@13

  v3 = (uintptr_t)&IOUSBControllerV3::gMetaClass;
  v4 = (IOService *)OSMetaClassBase::safeMetaCast(a1, (const OSMetaClassBase *)&IOUSBControllerV3::gMetaClass, a3);
  v5 = (uintptr_t)v4;
  if ( v4 )
  {
    LODWORD(v4) = IOService::isInactive(v4);
    if ( !(_BYTE)v4 )
    {
      if ( *(_BYTE *)(v5 + 444) )
      {
        v6 = *(_QWORD *)(v5 + 152);
        if ( !v6
          || (LODWORD(v7) = (*(int (__fastcall **)(__int64, _QWORD *))(*(_QWORD *)v6 + 2608LL))(
                              v6,
                              &IOUSBControllerV3::gMetaClass),
              !v7)
          || *(_DWORD *)(v5 + 448) != 2
          || (LODWORD(v8) = (*(int (**)(void))(**(_QWORD **)(v5 + 152) + 2608LL))(),
              LODWORD(v4) = IOService::getPowerState(v8),
              (_DWORD)v4 != 2) )
        {
          v9 = *(_QWORD *)(*(_QWORD *)(v5 + 168) + 216LL);
          if ( !v9
            || (LODWORD(v10) = (*(int (__fastcall **)(__int64, _QWORD *))(*(_QWORD *)v9 + 2608LL))(
                                 v9,
                                 &IOUSBControllerV3::gMetaClass),
                !v10)
            || *(_DWORD *)(v5 + 448) != 2
            || (LODWORD(v11) = (*(int (**)(void))(**(_QWORD **)(*(_QWORD *)(v5 + 168) + 216LL) + 2608LL))(),
                LODWORD(v4) = IOService::getPowerState(v11),
                (_DWORD)v4 != 2) )
          {
            if ( gUSBStackDebugFlags & 2 )
            {
              LODWORD(v12) = (*(int (__fastcall **)(_QWORD, _QWORD *))(**(_QWORD **)(v5 + 152) + 2608LL))(
                               *(_QWORD *)(v5 + 152),
                               &IOUSBControllerV3::gMetaClass);
              v13 = v12;
              LODWORD(v14) = (*(int (**)(void))(**(_QWORD **)(v5 + 152) + 2608LL))();
              v15 = IOService::getPowerState(v14);
              if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
              {
                v3 = v5;
                kernel_debug(0x52D0040u, v5, v13, v15, 4uLL, 0LL);
              }
            }
            (*(void (__fastcall **)(uintptr_t, uintptr_t))(*(_QWORD *)v5 + 2984LL))(v5, v3);
            v4 = *(IOService **)(v5 + 672);
            if ( *(_DWORD *)v4 )
            {
              LODWORD(v4) = IOService::isInactive((IOService *)v5);
              if ( !(_BYTE)v4 )
              {
                if ( *(_BYTE *)(v5 + 444) )
                {
                  LODWORD(v4) = *(_BYTE *)(*(_QWORD *)(v5 + 168) + 40LL);
                  if ( (_DWORD)v4 != 3 )
                    LODWORD(v4) = (*(int (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(v5 + 496) + 464LL))(
                                    *(_QWORD *)(v5 + 496),
                                    **(_DWORD **)(v5 + 672));
                }
              }
            }
          }
        }
      }
    }
  }
  return (signed int)v4;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 49900: using guessed type _QWORD IOUSBControllerV3::gMetaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (00000000000232B6) ----------------------------------------------------
int __fastcall IOUSBControllerV3::UpdateThunderboltExtraCurrentiVars(IOUSBControllerV3 *this)
{
  __int64 v1; // rax@1

  v1 = *((_QWORD *)this + 21);
  if ( *(_BYTE *)(v1 + 244) )
  {
    (*(void (__fastcall **)(IOUSBControllerV3 *, _QWORD, _QWORD, signed __int64))(*(_QWORD *)this + 640LL))(
      this,
      "_tbCurrentExtra",
      *(_DWORD *)(*((_QWORD *)this + 84) + 304LL),
      64LL);
    (*(void (__fastcall **)(IOUSBControllerV3 *, _QWORD, _QWORD, signed __int64))(*(_QWORD *)this + 640LL))(
      this,
      "_tbCurrentExtraInSleep",
      *(_DWORD *)(*((_QWORD *)this + 84) + 308LL),
      64LL);
    (*(void (__fastcall **)(IOUSBControllerV3 *, _QWORD, _QWORD, signed __int64))(*(_QWORD *)this + 640LL))(
      this,
      "_tbMaxCurrentPerPort",
      *(_DWORD *)(*((_QWORD *)this + 84) + 312LL),
      64LL);
    (*(void (__fastcall **)(IOUSBControllerV3 *, _QWORD, _QWORD, signed __int64))(*(_QWORD *)this + 640LL))(
      this,
      "_tbMaxCurrentPerPortInSleep",
      *(_DWORD *)(*((_QWORD *)this + 84) + 316LL),
      64LL);
    (*(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 640LL))(
      this,
      "_tbExternalSSPorts",
      *(_DWORD *)(*((_QWORD *)this + 84) + 320LL),
      64LL);
    (*(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 640LL))(
      this,
      "_tbUnconnectedExternalSSPorts",
      *(_DWORD *)(*((_QWORD *)this + 84) + 324LL),
      64LL);
    (*(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 640LL))(
      this,
      "_tbRevocableExtraCurrent",
      *(_DWORD *)(*((_QWORD *)this + 84) + 328LL),
      64LL);
    (*(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 640LL))(
      this,
      "_tbExternalNonSSPortsUsingExtraCurrent",
      *(_DWORD *)(*((_QWORD *)this + 84) + 332LL),
      64LL);
    (*(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 640LL))(
      this,
      "_tbCaptiveBitmap",
      *(_DWORD *)(*((_QWORD *)this + 84) + 336LL),
      64LL);
    LODWORD(v1) = (*(int (__fastcall **)(IOUSBControllerV3 *, _QWORD, _QWORD, signed __int64))(*(_QWORD *)this + 640LL))(
                    this,
                    "_tbExternalConnectorBitmap",
                    *(_DWORD *)(*((_QWORD *)this + 84) + 340LL),
                    64LL);
  }
  return v1;
}

//----- (000000000002345E) ----------------------------------------------------
void __fastcall IOUSBControllerV3::stop(IOUSBControllerV3 *this, IOService *a2)
{
  IOUSBControllerV3 *v2; // r12@1
  IOPMrootDomain *v3; // rbx@1
  __int64 v4; // rcx@1
  __int64 v5; // r13@2
  int v6; // er15@2
  __int64 v7; // rbx@4
  __int64 v8; // rdi@8
  __int64 v9; // rdi@10
  __int64 v10; // rdi@12
  __int64 v11; // rdi@13
  __int64 v12; // rax@16
  __int64 v13; // rdi@17
  unsigned __int64 v14; // rsi@21
  IOService *v15; // rax@23
  IOPMrootDomain *v16; // [sp+8h] [bp-38h]@4

  v2 = this;
  v3 = (IOPMrootDomain *)IOService::getPMRootDomain(this);
  v4 = *((_QWORD *)this + 84);
  if ( *(_BYTE *)(v4 + 346) )
  {
    v5 = IOUSBController::GetCommandGate(this);
    v4 = *((_QWORD *)this + 84);
    v6 = *(_DWORD *)(v4 + 348);
    if ( v5 )
    {
      if ( v6 > 0 )
      {
        v16 = v3;
        v7 = 0LL;
        do
          (*(void (__fastcall **)(__int64, __int64 (__fastcall *)(uintptr_t, uintptr_t), __int64, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v5 + 456LL))(
            v5,
            IOUSBControllerV3::WakeUpCheckPowerModeThreadsGated,
            v7++,
            0LL,
            0LL,
            0LL);
        while ( v6 != (_DWORD)v7 );
        v4 = *((_QWORD *)this + 84);
        v3 = v16;
      }
      *(_BYTE *)(v4 + 346) = 0;
    }
  }
  v8 = *((_QWORD *)this + 58);
  if ( v8 )
  {
    (*(void (**)(void))(*(_QWORD *)v8 + 40LL))();
    *((_QWORD *)v2 + 58) = 0LL;
    v4 = *((_QWORD *)v2 + 84);
  }
  v9 = *(_QWORD *)(v4 + 272);
  if ( v9 )
  {
    (*(void (**)(void))(*(_QWORD *)v9 + 40LL))();
    v4 = *((_QWORD *)v2 + 84);
    *(_QWORD *)(v4 + 272) = 0LL;
  }
  v10 = *((_QWORD *)v2 + 62);
  if ( v10 )
  {
    (*(void (**)(void))(*(_QWORD *)v10 + 536LL))();
    v11 = *((_QWORD *)v2 + 17);
    if ( v11 )
      (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v11 + 328LL))(v11, *((_QWORD *)v2 + 62));
    (*(void (**)(void))(**((_QWORD **)v2 + 62) + 40LL))();
    *((_QWORD *)v2 + 62) = 0LL;
    v4 = *((_QWORD *)v2 + 84);
  }
  v12 = *(_QWORD *)(v4 + 288);
  if ( v12 )
  {
    v13 = *((_QWORD *)v2 + 17);
    if ( v13 )
    {
      (*(void (__fastcall **)(__int64, __int64))(*(_QWORD *)v13 + 328LL))(v13, v12);
      v12 = *(_QWORD *)(*((_QWORD *)v2 + 84) + 288LL);
    }
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v12 + 40LL))(v12);
    v4 = *((_QWORD *)v2 + 84);
    *(_QWORD *)(v4 + 288) = 0LL;
  }
  if ( v3 )
  {
    v14 = *(_QWORD *)(v4 + 8);
    if ( v14 )
      IOPMrootDomain::releasePMAssertion(v3, v14);
  }
  (*(void (__fastcall **)(IOUSBControllerV3 *))(*(_QWORD *)v2 + 1944LL))(v2);
  v15 = (IOService *)IOService::getPMRootDomain(v2);
  IOService::deRegisterInterestedDriver(v15, v2);
  IOService::deRegisterInterestedDriver(*((IOService **)v2 + 61), v2);
  JUMPOUT(__CS__, `vtable for'IOUSBControllerV2[187]);
}
// 419D0: using guessed type __int64 `vtable for'IOUSBControllerV2[2];

//----- (0000000000023654) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::WakeUpCheckPowerModeThreadsGated(uintptr_t arg1, uintptr_t arg2)
{
  uintptr_t v2; // r14@1
  __int64 v3; // rbx@1
  int v4; // eax@2
  signed int v5; // ebx@6
  uintptr_t v6; // rdx@9
  uintptr_t v7; // r8@9
  uintptr_t v8; // rsi@9

  v2 = arg2;
  v3 = IOUSBController::GetCommandGate((IOUSBController *)arg1);
  if ( !v3 )
  {
    v5 = 0;
    if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
      return (unsigned int)v5;
    v5 = 0;
    v6 = 0LL;
    v7 = 11LL;
    v8 = arg1;
LABEL_13:
    kernel_debug(0x52D00ACu, v8, v6, 0LL, v7, 0LL);
    return (unsigned int)v5;
  }
  v4 = gUSBStackDebugFlags & 2;
  if ( arg2 > 0x1F )
  {
    v5 = -536870206;
    if ( !v4 || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
      return (unsigned int)v5;
    v7 = 14LL;
    v8 = arg1;
    v6 = v2;
    goto LABEL_13;
  }
  if ( v4 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D00ACu, arg1, arg2, 0LL, 0xDuLL, 0LL);
  (*(void (__fastcall **)(__int64, uintptr_t, signed __int64))(*(_QWORD *)v3 + 488LL))(
    v3,
    *(_QWORD *)(arg1 + 672) + arg2 + 352,
    1LL);
  v5 = 0;
  return (unsigned int)v5;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (0000000000023748) ----------------------------------------------------
void __fastcall IOUSBControllerV3::willTerminate(IOUSBControllerV3 *this, IOService *a2)
{
  JUMPOUT(__CS__, `vtable for'IOUSBControllerV2[130]);
}
// 419D0: using guessed type __int64 `vtable for'IOUSBControllerV2[2];

//----- (000000000002375A) ----------------------------------------------------
void __fastcall IOUSBControllerV3::didTerminate(IOUSBControllerV3 *this, IOService *a2, __int64 a3, bool *a4)
{
  if ( *((_QWORD *)this + 84) )
  {
    if ( *(_BYTE *)(*((_QWORD *)this + 21) + 244LL) )
      IOService::requireMaxBusStall(this, 0);
  }
  JUMPOUT(__CS__, `vtable for'IOUSBControllerV2[131]);
}
// 419D0: using guessed type __int64 `vtable for'IOUSBControllerV2[2];

//----- (00000000000237B6) ----------------------------------------------------
char __fastcall IOUSBControllerV3::GetPMCSR(uintptr_t arg1, unsigned __int16 *a2)
{
  uintptr_t *v2; // r15@1
  uintptr_t v3; // r14@1
  IOPCIDevice *v4; // rdi@2
  unsigned __int16 v5; // ax@3
  unsigned __int16 v6; // ax@6
  OSMetaClassBase *v7; // rax@8
  const OSMetaClass *v8; // rdx@8
  OSMetaClassBase *v9; // rbx@8
  uintptr_t v10; // rsi@9
  __int64 v11; // rax@9
  unsigned __int16 v12; // ax@10
  __int64 v13; // rax@15
  unsigned __int16 v14; // ax@16
  uintptr_t v15; // rdx@18
  char v16; // bl@18
  uintptr_t v17; // r8@18

  v2 = (uintptr_t *)a2;
  v3 = arg1;
  if ( !a2 )
  {
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      v16 = 0;
      v15 = 0LL;
      v17 = 41LL;
      goto LABEL_29;
    }
    goto LABEL_25;
  }
  *a2 = -1;
  v4 = *(IOPCIDevice **)(arg1 + 488);
  if ( !v4 )
  {
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      v16 = 0;
      v15 = 0LL;
      v17 = 42LL;
      goto LABEL_29;
    }
LABEL_25:
    v16 = 0;
    goto LABEL_30;
  }
  v5 = IOPCIDevice::extendedConfigRead16(v4, 4uLL);
  if ( v5 != 0xFFFF )
  {
    if ( !(v5 & 2) )
    {
      IOPCIDevice::extendedConfigWrite16(*(IOPCIDevice **)(v3 + 488), 4uLL, v5 | 2);
      if ( gUSBStackDebugFlags & 2 )
      {
        v6 = IOPCIDevice::extendedConfigRead16(*(IOPCIDevice **)(v3 + 488), 4uLL);
        if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          kernel_debug(0x52D002Cu, v3, v6, 0LL, 0x2CuLL, 0LL);
      }
    }
    LODWORD(v7) = (*(int (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(v3 + 488) + 744LL))(
                    *(_QWORD *)(v3 + 488),
                    "IOPCIPMCSState");
    v9 = v7;
    if ( v7 )
    {
      v10 = *(_QWORD *)off_3B078[0];
      v11 = OSMetaClassBase::safeMetaCast(v7, *(const OSMetaClassBase **)off_3B078[0], v8);
      if ( v11 )
      {
        v12 = (*(int (__fastcall **)(__int64, uintptr_t))(*(_QWORD *)v11 + 320LL))(v11, v10);
        *(_WORD *)v2 = v12;
        if ( gUSBStackDebugFlags & 2 )
        {
          if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          {
            v10 = v3;
            kernel_debug(0x52D002Cu, v3, v12, 0LL, 0x2DuLL, 0LL);
          }
        }
      }
      (*(void (__fastcall **)(OSMetaClassBase *, uintptr_t))(*(_QWORD *)v9 + 40LL))(v9, v10);
      (*(void (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(v3 + 488) + 672LL))(
        *(_QWORD *)(v3 + 488),
        "IOPCIPMCSState");
    }
    if ( *(_WORD *)v2 == 0xFFFF )
    {
      v13 = *(_QWORD *)(v3 + 672);
      if ( *(_WORD *)(v13 + 264) )
      {
        v14 = IOPCIDevice::extendedConfigRead16(*(IOPCIDevice **)(v3 + 488), *(_WORD *)(v13 + 264));
        *(_WORD *)v2 = v14;
        if ( gUSBStackDebugFlags & 2 )
        {
          if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          {
            v15 = v14;
            v16 = 0;
            v17 = 46LL;
LABEL_29:
            kernel_debug(0x52D002Cu, v3, v15, 0LL, v17, 0LL);
            goto LABEL_30;
          }
        }
      }
    }
    goto LABEL_25;
  }
  v16 = 1;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
  {
    v15 = 0LL;
    v17 = 43LL;
    goto LABEL_29;
  }
LABEL_30:
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D002Cu, v3, *(_WORD *)v2, 0LL, 0x2FuLL, 0LL);
  return v16;
}
// 3B078: using guessed type _QWORD off_3B078[19];
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000023A44) ----------------------------------------------------
uintptr_t __fastcall IOUSBControllerV3::maxCapabilityForDomainState(uintptr_t arg1, uintptr_t arg2)
{
  uintptr_t v2; // r14@1
  uintptr_t v3; // rbx@1
  uintptr_t v4; // rax@3
  uintptr_t v5; // r12@3
  __int64 v6; // rax@3
  __int64 v7; // rdx@4
  uintptr_t v8; // rsi@7
  char v9; // bl@7
  __int64 v10; // rax@7
  __int64 v11; // rdx@7
  __int64 v12; // rcx@13
  bool v13; // zf@14
  uintptr_t v14; // r12@16
  uintptr_t v15; // rax@16
  char v16; // al@28
  __int64 v17; // rcx@28
  unsigned __int16 v19; // [sp+Ch] [bp-24h]@28
  unsigned __int16 v20; // [sp+Eh] [bp-22h]@7

  v2 = arg2;
  v3 = 4LL;
  if ( !(unsigned __int8)IOService::isInactive((IOService *)arg1) )
  {
    v3 = 4LL;
    if ( *(_QWORD *)(arg1 + 672) )
    {
      LODWORD(v4) = ((int (*)(void))`vtable for'IOUSBControllerV2[256])();
      v5 = v4;
      v6 = *(_QWORD *)(arg1 + 456);
      if ( v6 == 2 && (v7 = *(_QWORD *)(arg1 + 672)) != 0 && *(_BYTE *)(v7 + 201) )
      {
        if ( *(_BYTE *)(v7 + 298) )
        {
          v20 = -1;
          v8 = (uintptr_t)&v20;
          v9 = IOUSBControllerV3::GetPMCSR(arg1, &v20);
          v10 = *(_QWORD *)(arg1 + 672);
          *(_BYTE *)(v10 + 201) = 0;
          v11 = v20;
          if ( v20 != 0xFFFFLL )
          {
            if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
            {
              v8 = arg1;
              kernel_debug(0x52D002Cu, arg1, v20, 0LL, 4uLL, 0LL);
              v11 = v20;
            }
            v10 = *(_QWORD *)(arg1 + 672);
            if ( BYTE1(v11) & 1 )
              *(_BYTE *)(v10 + 200) = 1;
          }
          v12 = (unsigned __int8)(v9 | (*(_BYTE *)(v10 + 200) != 0));
          if ( (_DWORD)v12 != 1
            || (LOBYTE(v12) = v9 | (*(_BYTE *)(v10 + 384) == 0),
                v13 = ((unsigned __int8)v9 | (*(_BYTE *)(v10 + 384) == 0)) == 0,
                v3 = v5,
                v13) )
          {
            *(_BYTE *)(v10 + 384) = 0;
            (*(void (__fastcall **)(uintptr_t, uintptr_t, __int64, __int64))(*(_QWORD *)arg1 + 3064LL))(
              arg1,
              v8,
              v11,
              v12);
            (*(void (__fastcall **)(uintptr_t, signed __int64))(*(_QWORD *)arg1 + 2960LL))(arg1, 1LL);
            *(_BYTE *)(arg1 + 441) = 1;
            IOService::changePowerStateToPriv((IOService *)arg1, 0LL);
            IOService::powerOverrideOnPriv((IOService *)arg1);
            clock_get_uptime(*(_QWORD *)(arg1 + 672) + 256LL);
            v3 = 2LL;
            if ( gUSBStackDebugFlags & 2 )
            {
              v14 = *(_DWORD *)(*(_QWORD *)(arg1 + 168) + 224LL);
              v15 = IORegistryEntry::getRegistryEntryID((IORegistryEntry *)arg1);
              v3 = 2LL;
              if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
              {
                v3 = 2LL;
                kernel_debug(0x52D00A9u, v14, v2, 2uLL, v15, 0LL);
              }
            }
          }
        }
        else
        {
          if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          {
            kernel_debug(0x52D002Cu, arg1, arg2, 0LL, 0x20uLL, 0LL);
            v7 = *(_QWORD *)(arg1 + 672);
          }
          v3 = 2LL;
          if ( *(_QWORD *)(v7 + 288) )
          {
            v19 = -1;
            v16 = IOUSBControllerV3::GetPMCSR(arg1, &v19);
            v17 = *(_QWORD *)(arg1 + 672);
            *(_BYTE *)(v17 + 201) = 0;
            v3 = 2LL;
            if ( !v16 )
            {
              v3 = 2LL;
              if ( !(HIBYTE(v19) & 1) )
              {
                *(_BYTE *)(v17 + 200) = 0;
                (*(void (__fastcall **)(uintptr_t, unsigned __int16 *))(*(_QWORD *)arg1 + 3064LL))(arg1, &v19);
                (*(void (__fastcall **)(uintptr_t, signed __int64))(*(_QWORD *)arg1 + 2960LL))(arg1, 1LL);
                *(_BYTE *)(arg1 + 441) = 1;
                v3 = 0LL;
                IOService::changePowerStateToPriv((IOService *)arg1, 0LL);
                IOService::powerOverrideOnPriv((IOService *)arg1);
                clock_get_uptime(*(_QWORD *)(arg1 + 672) + 256LL);
              }
            }
          }
        }
      }
      else
      {
        v3 = 1LL;
        if ( !*(_BYTE *)(arg1 + 453) )
        {
          v3 = 0LL;
          if ( !*(_BYTE *)(arg1 + 452) )
          {
            v3 = 4LL;
            if ( (*(_QWORD *)(*(_QWORD *)(arg1 + 480) + 408LL) & 4LL | 0x400) != arg2 )
            {
              v3 = 0LL;
              if ( v6 != 0 || v5 != 2 )
                v3 = v5;
            }
          }
        }
      }
    }
  }
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(
      0x52D002Cu,
      arg1,
      v2 | ((unsigned __int64)*(_BYTE *)(*(_QWORD *)(arg1 + 672) + 201LL) << 32),
      v3,
      5uLL,
      0LL);
  return v3;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 419D0: using guessed type __int64 `vtable for'IOUSBControllerV2[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 7E170: using guessed type int __fastcall clock_get_uptime(_QWORD);

//----- (0000000000023DBE) ----------------------------------------------------
void __fastcall IOUSBControllerV3::initialPowerStateForDomainState(IOUSBControllerV3 *this)
{
  JUMPOUT(__CS__, `vtable for'IOUSBControllerV2[257]);
}
// 419D0: using guessed type __int64 `vtable for'IOUSBControllerV2[2];

//----- (0000000000023DD0) ----------------------------------------------------
void __fastcall IOUSBControllerV3::powerStateWillChangeTo(uintptr_t arg1, uintptr_t arg2, __int64 a3, IOService *a4)
{
  uintptr_t v4; // r15@1
  __int64 v5; // r14@1
  uintptr_t v6; // rbx@1
  uintptr_t v7; // r13@1
  __int64 v8; // rax@19
  __int64 v9; // rax@28
  __int64 v10; // rdi@29

  v4 = (uintptr_t)a4;
  v5 = a3;
  v6 = arg2;
  v7 = arg1;
  if ( (IOService *)IOService::getPMRootDomain((IOService *)arg1) == a4 )
  {
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      arg2 = arg1;
      kernel_debug(0x52D002Cu, arg1, v6, *(_BYTE *)(arg1 + 456) | (unsigned __int64)(v5 << 16), 9uLL, 0LL);
    }
    if ( v6 & 2 )
    {
      if ( *(_QWORD *)(arg1 + 456) == 2LL )
      {
        if ( IOUSBControllerV3::_gHibernateState
          && *(_DWORD *)IOUSBControllerV3::_gHibernateState == 2
          && (v8 = *(_QWORD *)(arg1 + 672)) != 0 )
        {
          *(_BYTE *)(v8 + 201) = 1;
          if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
            kernel_debug(0x52D002Cu, arg1, 0LL, 0LL, 0xAuLL, 0LL);
        }
        else
        {
          if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          {
            arg2 = arg1;
            kernel_debug(0x52D002Cu, arg1, 0LL, 0LL, 0xBuLL, 0LL);
          }
          (*(void (__fastcall **)(uintptr_t, uintptr_t))(*(_QWORD *)arg1 + 2976LL))(arg1, arg2);
        }
      }
    }
    else if ( v6 & 4 )
    {
      v9 = *(_QWORD *)(arg1 + 672);
      if ( v9 )
      {
        v10 = *(_QWORD *)(v9 + 288);
        if ( v10 )
        {
          if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          {
            arg2 = v7;
            kernel_debug(0x52D002Cu, v7, 0LL, 0LL, 0x13uLL, 0LL);
            v10 = *(_QWORD *)(*(_QWORD *)(v7 + 672) + 288LL);
          }
          (*(void (__fastcall **)(__int64, uintptr_t))(*(_QWORD *)v10 + 344LL))(v10, arg2);
          *(_BYTE *)(*(_QWORD *)(v7 + 672) + 296LL) = 1;
        }
      }
    }
  }
  else if ( arg1 == v4 )
  {
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D002Cu, arg1, v4, *(_BYTE *)(arg1 + 456) | (unsigned __int64)(v5 << 16), 6uLL, 0LL);
    *(_DWORD *)(arg1 + 448) = v5;
  }
  else if ( *(_QWORD *)(arg1 + 488) == v4 )
  {
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D002Cu, arg1, arg2, *(_BYTE *)(arg1 + 456) | (unsigned __int64)(v5 << 16), 0x17uLL, 0LL);
    if ( BYTE1(v6) & 0x10 )
    {
      if ( gUSBStackDebugFlags & 2 )
      {
        if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          kernel_debug(0x52D002Cu, arg1, 0LL, 0LL, 0x26uLL, 0LL);
      }
      *(_BYTE *)(*(_QWORD *)(arg1 + 672) + 345LL) = 1;
    }
    else
    {
      *(_BYTE *)(*(_QWORD *)(arg1 + 672) + 345LL) = 0;
    }
  }
  JUMPOUT(__CS__, `vtable for'IOUSBControllerV2[259]);
}
// 3B100: using guessed type __int64 off_3B100[2];
// 419D0: using guessed type __int64 `vtable for'IOUSBControllerV2[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 498F8: using guessed type _QWORD IOUSBControllerV3::_gHibernateState;

//----- (00000000000240B4) ----------------------------------------------------
__int64 __usercall IOUSBControllerV3::setPowerState@<rax>(uintptr_t arg1@<rdi>, uintptr_t arg3@<rsi>, IOService *this@<rdx>, char a4@<al>)
{
  IOService *v4; // rbx@1
  unsigned __int64 v5; // r15@1
  uintptr_t v6; // r12@1
  uintptr_t v7; // rdx@3
  signed int v8; // er14@5
  uint32_t v9; // edi@7
  uintptr_t v10; // rdx@7
  uintptr_t v11; // r8@7
  unsigned __int64 v12; // rax@18
  __int64 v13; // rax@21
  OSMetaClassBase *v14; // rax@26
  const OSMetaClass *v15; // rdx@26
  OSMetaClassBase *v16; // rbx@26
  uintptr_t v17; // rsi@27
  __int64 v18; // rax@27
  unsigned __int16 v19; // ax@28
  uintptr_t v20; // rbx@32
  __int64 v21; // rax@36
  __int64 v22; // r9@36
  __int64 v23; // rax@39
  __int64 v24; // r9@39
  __int64 v25; // rax@45
  __int64 v26; // rdi@46
  __int64 v27; // rax@52
  unsigned __int64 v28; // rcx@57
  char v30; // [sp-6h] [bp-30h]@1
  unsigned __int16 v31; // [sp+0h] [bp-2Ah]@26

  v30 = a4;
  v4 = this;
  v5 = arg3;
  v6 = arg1;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
  {
    v7 = (signed int)arg3;
    arg3 = arg1;
    kernel_debug(0x52D002Du, arg1, v7, (uintptr_t)v4, *(_DWORD *)(arg1 + 456), 0LL);
  }
  if ( (IOService *)arg1 == v4 )
  {
    if ( (unsigned __int8)IOService::isInactive(v4) )
    {
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D002Cu, arg1, 0LL, 0LL, 0x3EuLL, 0LL);
      *(_QWORD *)(arg1 + 456) = v5;
      v8 = 0;
    }
    else if ( v5 < 5 )
    {
      v12 = *(_QWORD *)(arg1 + 456);
      v8 = 0;
      if ( v12 != v5 )
      {
        if ( v12 > 2 || v5 < 3 )
        {
          if ( v12 >= 4 && v5 <= 3 )
          {
            v25 = *(_QWORD *)(arg1 + 168);
            if ( v25 )
            {
              v26 = *(_QWORD *)(v25 + 16);
              if ( v26 )
              {
                if ( *(_BYTE *)(v25 + 25) )
                {
                  *(_BYTE *)(v25 + 25) = 0;
                  (*(void (__fastcall **)(__int64, uintptr_t))(*(_QWORD *)v26 + 536LL))(v26, arg3);
                }
              }
            }
          }
        }
        else
        {
          (*(void (__fastcall **)(uintptr_t, signed __int64))(*(_QWORD *)arg1 + 2968LL))(arg1, 1LL);
          v13 = *(_QWORD *)(arg1 + 672);
          *(_BYTE *)(v13 + 384) = 0;
          if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          {
            kernel_debug(0x52D002Cu, arg1, *(_QWORD *)(arg1 + 456), v5, 0x43uLL, 0LL);
            v13 = *(_QWORD *)(arg1 + 672);
          }
          if ( v13 && *(_WORD *)(v13 + 264) )
          {
            v31 = IOPCIDevice::extendedConfigRead16(*(IOPCIDevice **)(arg1 + 488), *(_WORD *)(v13 + 264));
            LODWORD(v14) = (*(int (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(arg1 + 488) + 744LL))(
                             *(_QWORD *)(arg1 + 488),
                             "IOPCIPMCSState");
            v16 = v14;
            if ( v14 )
            {
              v17 = *(_QWORD *)off_3B078[0];
              v18 = OSMetaClassBase::safeMetaCast(v14, *(const OSMetaClassBase **)off_3B078[0], v15);
              if ( v18 )
              {
                v19 = (*(int (__fastcall **)(__int64, uintptr_t))(*(_QWORD *)v18 + 320LL))(v18, v17);
                if ( gUSBStackDebugFlags & 2 )
                {
                  if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
                  {
                    v17 = arg1;
                    kernel_debug(0x52D002Cu, arg1, v19, v31, 0x42uLL, 0LL);
                  }
                }
              }
              (*(void (__fastcall **)(OSMetaClassBase *, uintptr_t))(*(_QWORD *)v16 + 40LL))(v16, v17);
              (*(void (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(arg1 + 488) + 672LL))(
                *(_QWORD *)(arg1 + 488),
                "IOPCIPMCSState");
            }
            v20 = v31;
            if ( v31 == 0xFFFF )
            {
              if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
                kernel_debug(0x52D002Cu, arg1, 0xFFFFuLL, 0LL, 0x40uLL, 0LL);
            }
            else if ( v31 & 0x8003 )
            {
              if ( BYTE1(v20) & 0x80 )
              {
                if ( *(_QWORD *)(arg1 + 456) == 2LL )
                {
                  LODWORD(v21) = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)arg1 + 904LL))(arg1, 0LL);
                  KernelDebugLogInternal(
                    1u,
                    0x55534246u,
                    (__int64)"%s: setPowerState - PCI device still has PME status bit set. PMCSR is 0x%04x",
                    v21,
                    v31,
                    v22,
                    v30);
                }
                IOPCIDevice::extendedConfigWrite16(
                  *(IOPCIDevice **)(arg1 + 488),
                  *(_WORD *)(*(_QWORD *)(arg1 + 672) + 264LL),
                  v20);
                IOPCIDevice::extendedConfigRead16(
                  *(IOPCIDevice **)(arg1 + 488),
                  *(_WORD *)(*(_QWORD *)(arg1 + 672) + 264LL));
              }
              if ( v20 & 3 )
              {
                LODWORD(v23) = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)arg1 + 904LL))(arg1, 0LL);
                KernelDebugLogInternal(
                  1u,
                  0x55534246u,
                  (__int64)"%s: setPowerState - PCI device is in the wrong Power State. PMCSR is 0x%04x",
                  v23,
                  (unsigned int)v20,
                  v24,
                  v30);
              }
              if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
                kernel_debug(0x52D002Cu, arg1, v20, 0LL, 0x41uLL, 0LL);
            }
          }
        }
        v27 = *(_QWORD *)(v6 + 464);
        if ( v27 )
        {
          if ( *(_BYTE *)(v6 + 441) )
          {
            if ( *(_QWORD *)(v27 + 456) <= 2uLL )
            {
              do
                IOSleep(10LL);
              while ( *(_QWORD *)(*(_QWORD *)(v6 + 464) + 456LL) < 3uLL );
            }
          }
          else
          {
            v28 = *(_QWORD *)(v6 + 456);
            if ( v28 <= 2 && v5 >= 3 && *(_QWORD *)(v27 + 456) <= 2uLL )
            {
              do
              {
                IOSleep(10LL);
                v27 = *(_QWORD *)(v6 + 464);
              }
              while ( *(_QWORD *)(v27 + 456) < 3uLL );
              v28 = *(_QWORD *)(v6 + 456);
            }
            if ( v28 >= 2 && v5 <= 1 && *(_QWORD *)(v27 + 456) >= 2uLL )
            {
              do
                IOSleep(10LL);
              while ( *(_QWORD *)(*(_QWORD *)(v6 + 464) + 456LL) > 1uLL );
            }
          }
        }
        (*(void (__fastcall **)(uintptr_t, unsigned __int64))(*(_QWORD *)v6 + 3152LL))(v6, v5);
        if ( gUSBStackDebugFlags & 2 )
        {
          if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          {
            v10 = *(_QWORD *)(v6 + 456);
            v8 = 0;
            v9 = 86835246;
            v11 = 0LL;
            goto LABEL_8;
          }
        }
      }
    }
    else
    {
      v8 = 5;
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        v9 = 86835244;
        v10 = 0LL;
        v11 = 63LL;
        goto LABEL_8;
      }
    }
  }
  else
  {
    v8 = 0;
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      v8 = 0;
      v9 = 86835244;
      v10 = 0LL;
      v11 = 61LL;
LABEL_8:
      kernel_debug(v9, v6, v10, 0LL, v11, 0LL);
      return (unsigned int)v8;
    }
  }
  return (unsigned int)v8;
}
// 3B078: using guessed type _QWORD off_3B078[19];
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 7D278: using guessed type int __fastcall IOSleep(_QWORD);
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000002459A) ----------------------------------------------------
void __fastcall IOUSBControllerV3::powerStateDidChangeTo(uintptr_t arg1, uintptr_t arg2, uintptr_t arg3, uintptr_t a4)
{
  uintptr_t v4; // rbx@1
  uintptr_t v5; // r14@1
  __int64 v6; // rax@7

  v4 = a4;
  v5 = arg3;
  if ( IOService::getPMRootDomain((IOService *)arg1) != a4 )
  {
    if ( arg1 == v4 )
    {
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D002Cu, arg1, v4, *(_QWORD *)(arg1 + 456), 7uLL, 0LL);
    }
    else if ( *(_QWORD *)(arg1 + 488) == v4 )
    {
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D002Cu, arg1, arg2, v5, 0x18uLL, 0LL);
      v6 = *(_QWORD *)(arg1 + 672);
      if ( arg2 & 2 )
        *(_BYTE *)(v6 + 298) = 1;
      else
        *(_BYTE *)(v6 + 298) = 0;
    }
  }
  JUMPOUT(__CS__, `vtable for'IOUSBControllerV2[260]);
}
// 3B100: using guessed type __int64 off_3B100[2];
// 419D0: using guessed type __int64 `vtable for'IOUSBControllerV2[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (0000000000024696) ----------------------------------------------------
void __fastcall IOUSBControllerV3::powerChangeDone(IOUSBControllerV3 *this, uintptr_t arg2)
{
  uintptr_t v2; // r14@1
  uintptr_t v3; // r13@1
  __int64 v4; // rdi@4
  unsigned __int64 v5; // rbx@8
  uintptr_t v6; // r15@11
  uintptr_t v7; // rax@11
  __int64 v8; // rax@15
  __int64 v9; // rax@16
  signed __int64 v10; // rsi@16
  unsigned __int64 v11; // rbx@19
  uintptr_t v12; // r15@20
  uintptr_t v13; // rax@20
  __int64 v14; // rax@25
  __int64 v15; // rdi@27
  __int64 v16; // r12@37
  char v17; // al@38
  int v18; // er14@39
  uintptr_t v19; // rbx@39
  int v20; // eax@43
  uintptr_t arg3; // [sp+10h] [bp-30h]@39

  v2 = arg2;
  v3 = (uintptr_t)this;
  *((_DWORD *)this + 112) = -1;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D002Cu, (uintptr_t)this, arg2, *((_QWORD *)this + 57), 8uLL, 0LL);
  v4 = *((_QWORD *)this + 84);
  if ( v4 && *(_BYTE *)(v4 + 200) )
    *(_BYTE *)(v4 + 200) = 0;
  if ( *(_BYTE *)(v3 + 441) )
  {
    v5 = 0LL;
    *(_BYTE *)(v3 + 441) = 0;
    if ( v4 )
    {
      *(_BYTE *)(v4 + 250) = 1;
      v5 = computeDeltaTimeMS((const unsigned __int64 *)(v4 + 256));
    }
    *(_WORD *)(v3 + 452) = 0;
    if ( gUSBStackDebugFlags & 2 )
    {
      v6 = *(_DWORD *)(*(_QWORD *)(v3 + 168) + 224LL);
      v7 = IORegistryEntry::getRegistryEntryID((IORegistryEntry *)v3);
      if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D00A8u, v6, arg2, v5, v7, 0LL);
    }
    IOService::changePowerStateToPriv((IOService *)v3, 4uLL);
    (*(void (__fastcall **)(uintptr_t, signed __int64))(*(_QWORD *)v3 + 2976LL))(v3, 4LL);
    IOService::powerOverrideOffPriv((IOService *)v3);
    IOService::changePowerStateToPriv((IOService *)v3, *(_DWORD *)(*(_QWORD *)(v3 + 672) + 280LL));
    goto LABEL_25;
  }
  if ( *(_BYTE *)(v3 + 442) )
  {
    v8 = *(_QWORD *)(v3 + 456);
    if ( !v8 )
    {
      *(_BYTE *)(v3 + 442) = 0;
      v9 = off_3B0D8[0];
      v10 = 3758096976LL;
LABEL_24:
      (*(void (__fastcall **)(uintptr_t, signed __int64))(v9 + 1064))(v3, v10);
      goto LABEL_25;
    }
    if ( v8 == 1 )
    {
      *(_BYTE *)(v3 + 442) = 0;
      v9 = off_3B0D8[0];
      v10 = 3758097168LL;
      goto LABEL_24;
    }
  }
  else
  {
    if ( !v4 )
      goto LABEL_34;
    if ( *(_BYTE *)(v4 + 250) )
    {
      *(_BYTE *)(v4 + 250) = 0;
      v11 = computeDeltaTimeMS((const unsigned __int64 *)(v4 + 256));
      if ( gUSBStackDebugFlags & 2 )
      {
        v12 = *(_DWORD *)(*(_QWORD *)(v3 + 168) + 224LL);
        v13 = IORegistryEntry::getRegistryEntryID((IORegistryEntry *)v3);
        if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          kernel_debug(0x52D00AAu, v12, arg2, v11, v13, 0LL);
      }
    }
  }
LABEL_25:
  v14 = *(_QWORD *)(v3 + 672);
  if ( v14 )
  {
    if ( *(_BYTE *)(v14 + 296) )
    {
      v15 = *(_QWORD *)(v14 + 288);
      if ( v15 )
      {
        if ( v2 >= 3 && *(_QWORD *)(v3 + 456) == 2LL )
        {
          if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          {
            kernel_debug(0x52D002Cu, v3, 0LL, 0LL, 0x14uLL, 0LL);
            v14 = *(_QWORD *)(v3 + 672);
            v15 = *(_QWORD *)(v14 + 288);
          }
          *(_BYTE *)(v14 + 296) = 0;
          (*(void (**)(void))(*(_QWORD *)v15 + 336LL))();
        }
      }
    }
  }
LABEL_34:
  if ( v2 == 2 && *(_QWORD *)(v3 + 456) == 4LL )
  {
    if ( *(_BYTE *)(*(_QWORD *)(v3 + 672) + 346LL) )
    {
      v16 = IOUSBController::GetCommandGate((IOUSBController *)v3);
      if ( v16 )
      {
        v17 = (unsigned __int8)(gUSBStackDebugFlags & 2) >> 1;
        if ( *(_DWORD *)(*(_QWORD *)(v3 + 672) + 348LL) <= 0 )
        {
          arg3 = *(_DWORD *)(*(_QWORD *)(v3 + 672) + 348LL);
        }
        else
        {
          v18 = *(_DWORD *)(*(_QWORD *)(v3 + 672) + 348LL);
          arg3 = *(_DWORD *)(*(_QWORD *)(v3 + 672) + 348LL);
          v19 = 0LL;
          do
          {
            if ( v17 & 1 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
              kernel_debug(0x52D002Cu, v3, v19, arg3, 0x23uLL, 0LL);
            v20 = (*(int (__fastcall **)(__int64, __int64 (__fastcall *)(uintptr_t, uintptr_t), uintptr_t, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v16 + 456LL))(
                    v16,
                    IOUSBControllerV3::WakeUpCheckPowerModeThreadsGated,
                    v19,
                    0LL,
                    0LL,
                    0LL);
            if ( v20 && gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
              kernel_debug(0x52D002Cu, v3, v20, 0LL, 0x24uLL, 0LL);
            IOSleep(10LL);
            ++v19;
            v17 = (unsigned __int8)(gUSBStackDebugFlags & 2) >> 1;
          }
          while ( v18 != (_DWORD)v19 );
        }
        if ( v17 )
        {
          if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
            kernel_debug(0x52D002Cu, v3, arg3, *(_DWORD *)(*(_QWORD *)(v3 + 672) + 348LL), 0x25uLL, 0LL);
        }
        *(_BYTE *)(*(_QWORD *)(v3 + 672) + 346LL) = 0;
      }
    }
  }
  JUMPOUT(__CS__, `vtable for'IOUSBControllerV2[267]);
}
// 3B0D8: using guessed type __int64 off_3B0D8[7];
// 3B100: using guessed type __int64 off_3B100[2];
// 419D0: using guessed type __int64 `vtable for'IOUSBControllerV2[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 7D278: using guessed type int __fastcall IOSleep(_QWORD);

//----- (0000000000024AB7) ----------------------------------------------------
unsigned __int64 __fastcall computeDeltaTimeMS(const unsigned __int64 *a1)
{
  const unsigned __int64 *v1; // rbx@1
  unsigned __int64 result; // rax@1
  const unsigned __int64 v3; // rdi@1
  __int64 v4; // [sp+8h] [bp-18h]@1
  unsigned __int64 v5; // [sp+10h] [bp-10h]@1

  v1 = a1;
  v4 = 0LL;
  clock_get_uptime(&v5);
  result = 0LL;
  v3 = v5 - *a1;
  if ( v5 > *v1 )
  {
    v5 -= *v1;
    absolutetime_to_nanoseconds(v3, &v4);
    result = (unsigned __int64)((unsigned __int128)(4835703278458516699LL * v4) >> 64) >> 18;
  }
  return result;
}
// 7E158: using guessed type int __fastcall absolutetime_to_nanoseconds(_QWORD, _QWORD);
// 7E170: using guessed type int __fastcall clock_get_uptime(_QWORD);

//----- (0000000000024B08) ----------------------------------------------------
int __fastcall IOUSBControllerV3::systemWillShutdown(IOUSBControllerV3 *this, int a2)
{
  IOUSBControllerV3 *v2; // rbx@1
  unsigned __int64 v3; // rsi@2
  __int64 v4; // rax@5
  __int64 v5; // rdi@6
  __int64 v6; // rax@8

  v2 = this;
  if ( a2 == -536870320 )
  {
    *((_BYTE *)this + 442) = 1;
    *((_BYTE *)this + 452) = 1;
    v3 = 0LL;
  }
  else
  {
    if ( a2 != -536870128 )
    {
      LODWORD(v4) = (*(int (**)(void))(off_3B0D8[0] + 1064))();
      return v4;
    }
    *((_BYTE *)this + 442) = 1;
    *((_BYTE *)this + 453) = 1;
    v3 = 1LL;
  }
  IOService::changePowerStateToPriv(this, v3);
  IOService::powerOverrideOnPriv(this);
  v4 = *((_QWORD *)this + 21);
  if ( v4 )
  {
    v5 = *(_QWORD *)(v4 + 16);
    if ( v5 )
    {
      if ( *(_BYTE *)(v4 + 25) )
      {
        (*(void (__cdecl **)(__int64))(*(_QWORD *)v5 + 536LL))(v5);
        v6 = *((_QWORD *)v2 + 21);
        *(_DWORD *)(v6 + 232) = 100;
        LODWORD(v4) = (*(int (__fastcall **)(_QWORD, signed __int64, signed __int64))(**(_QWORD **)(v6 + 16) + 480LL))(
                        *(_QWORD *)(v6 + 16),
                        100LL,
                        1LL);
      }
    }
  }
  return v4;
}
// 3B0D8: using guessed type __int64 off_3B0D8[7];

//----- (0000000000024BC8) ----------------------------------------------------
void __fastcall IOUSBControllerV3::free(IOUSBControllerV3 *this)
{
  __int64 v1; // rax@4

  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D00BCu, *(_DWORD *)(*((_QWORD *)this + 21) + 224LL), 0LL, 0LL, 0LL, 0LL);
  v1 = *((_QWORD *)this + 84);
  if ( v1 )
  {
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      kernel_debug(0x52D00BCu, *(_DWORD *)(*((_QWORD *)this + 21) + 224LL), *((_QWORD *)this + 84), 0LL, 1uLL, 0LL);
      v1 = *((_QWORD *)this + 84);
    }
    IOFree(v1, 392LL);
    *((_QWORD *)this + 84) = 0LL;
  }
  if ( gUSBStackDebugFlags & 2 )
  {
    if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D00BCu, *(_DWORD *)(*((_QWORD *)this + 21) + 224LL), 0LL, 0LL, 2uLL, 0LL);
  }
  JUMPOUT(__CS__, `vtable for'IOUSBControllerV2[20]);
}
// 3B100: using guessed type __int64 off_3B100[2];
// 419D0: using guessed type __int64 `vtable for'IOUSBControllerV2[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 7D218: using guessed type int __fastcall IOFree(_QWORD, _QWORD);

//----- (0000000000024CC2) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::CheckForEHCIController(IOUSBControllerV3 *this, IOService *a2, __int64 a3, __int64 a4, __int64 a5, __int64 a6)
{
  IOUSBControllerV3 *v6; // r14@1
  __int64 v7; // rdi@1
  __int64 v8; // r15@1
  __int64 v9; // r13@3
  __int64 v10; // r12@4
  __int64 v11; // rax@4
  __int64 v12; // rax@4
  __int64 v13; // rbx@4
  OSMetaClassBase *v14; // rax@5
  const OSMetaClassBase *v15; // r12@5
  const OSMetaClassBase *v16; // rsi@5
  const OSMetaClass *v17; // rdx@5
  __int64 v18; // rax@5
  const OSMetaClassBase *v19; // r13@6
  OSMetaClassBase *v20; // rax@7
  const OSMetaClass *v21; // rdx@7
  __int64 v22; // rax@7
  __int64 v23; // rax@8
  OSMetaClassBase *v24; // rax@9
  const OSMetaClass *v25; // rdx@9
  signed __int64 v26; // rsi@11
  __int64 v28; // rbx@15
  OSDictionary *v29; // rdx@15
  IOService *v30; // rax@15
  unsigned __int64 v31; // rdx@15
  int v32; // er12@15
  int v33; // er14@17
  __int64 v34; // r12@18
  __int64 v35; // rax@21
  __int64 v36; // rax@23
  bool v37; // zf@24
  bool v38; // sf@24
  unsigned __int8 v39; // of@24
  __int64 v40; // r14@27
  __int64 v41; // rax@28
  char v42; // [sp+0h] [bp-40h]@0
  IOService *v43; // [sp+8h] [bp-38h]@15
  IOUSBControllerV3 *v44; // [sp+10h] [bp-30h]@6

  v6 = this;
  v7 = *((_QWORD *)this + 61);
  LODWORD(v8) = 0;
  if ( v7 )
    v8 = (unsigned __int8)(*(int (**)(void))(*(_QWORD *)v7 + 2288LL))();
  v9 = 0LL;
  if ( !a2 )
    goto LABEL_11;
  v10 = off_3B0E8[0];
  LODWORD(v11) = (*(int (__fastcall **)(IOService *, _QWORD))(*(_QWORD *)a2 + 792LL))(a2, *(_QWORD *)off_3B0E8[0]);
  LODWORD(v12) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v11 + 800LL))(v11, *(_QWORD *)v10);
  v13 = v12;
  v9 = 0LL;
  if ( !v12 )
    goto LABEL_11;
  LODWORD(v14) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v12 + 296LL))(v12);
  v15 = (const OSMetaClassBase *)*off_3B048[0];
  v16 = (const OSMetaClassBase *)*off_3B048[0];
  v18 = OSMetaClassBase::safeMetaCast(v14, (const OSMetaClassBase *)*off_3B048[0], v17);
  if ( !v18 )
  {
LABEL_10:
    (*(void (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v13 + 40LL))(v13, v16);
    v9 = 0LL;
LABEL_11:
    v26 = 1431519814LL;
    KernelDebugLogInternal(
      1u,
      0x55534246u,
      (__int64)"We could not find a corresponding USB EHCI controller for our OHCI controller at PCI device number%d",
      (unsigned int)v8,
      a5,
      a6,
      v42);
    goto LABEL_12;
  }
  v44 = v6;
  v19 = *(const OSMetaClassBase **)off_3B068[0];
  while ( 1 )
  {
    LODWORD(v20) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v18 + 696LL))(v18, "class-code");
    v22 = OSMetaClassBase::safeMetaCast(v20, v19, v21);
    if ( v22 )
    {
      LODWORD(v23) = (*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v22 + 376LL))(v22, v19);
      if ( *(_DWORD *)v23 == 787232 )
        break;
    }
    LODWORD(v24) = (*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v13 + 296LL))(v13, v19);
    v16 = v15;
    v18 = OSMetaClassBase::safeMetaCast(v24, v15, v25);
    if ( !v18 )
      goto LABEL_10;
  }
  (*(void (__fastcall **)(__int64))(*(_QWORD *)v13 + 40LL))(v13);
  v28 = 0LL;
  v26 = 0LL;
  v30 = (IOService *)IOService::serviceMatching("AppleUSBEHCI", 0LL, v29);
  v43 = v30;
  v32 = 0;
  v9 = 0LL;
  if ( v30 )
  {
    v26 = 5000000000LL;
    v28 = IOService::waitForMatchingService(v30, (OSDictionary *)0x2A05F200, v31);
    v32 = 0;
    v9 = 0LL;
  }
  while ( 1 )
  {
    v33 = v32;
LABEL_18:
    v34 = off_3B0E8[0];
    if ( !v28 )
      break;
    while ( 1 )
    {
      v26 = *(_QWORD *)v34;
      LODWORD(v35) = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v28 + 792LL))(v28, *(_QWORD *)v34);
      if ( (_DWORD)v8 == (unsigned __int8)(*(int (__fastcall **)(__int64))(*(_QWORD *)v35 + 2288LL))(v35) )
      {
        *((_QWORD *)v44 + 58) = v28;
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v28 + 32LL))(v28);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v28 + 40LL))(v28);
        v26 = (signed __int64)"Companion";
        (*(void (__fastcall **)(IOUSBControllerV3 *, _QWORD, _QWORD))(*(_QWORD *)v44 + 624LL))(v44, "Companion", "yes");
        goto LABEL_31;
      }
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v28 + 40LL))(v28);
      if ( !v9 )
        break;
      LODWORD(v36) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v9 + 296LL))(v9);
      v28 = v36;
      if ( !v36 )
        break;
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v36 + 32LL))(v36);
    }
    v32 = v33 + 1;
    v39 = __OFSUB__(v33, 499);
    v37 = v33 == 499;
    v38 = v33 - 499 < 0;
    v28 = 0LL;
    ++v33;
    if ( !((unsigned __int8)(v38 ^ v39) | v37) )
      goto LABEL_18;
    if ( v9 )
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v9 + 40LL))(v9);
    IOSleep(10LL);
    v40 = IOService::getMatchingServices(v43, (OSDictionary *)v26);
    v28 = 0LL;
    v9 = 0LL;
    if ( v40 )
    {
      LODWORD(v41) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v40 + 296LL))(v40);
      v28 = v41;
      v9 = v40;
      if ( v41 )
      {
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v41 + 32LL))(v41);
        v9 = v40;
      }
    }
  }
LABEL_31:
  if ( v33 == 500 )
    goto LABEL_11;
LABEL_12:
  if ( v9 )
    (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v9 + 40LL))(v9, v26);
  return 0LL;
}
// 3B048: using guessed type _QWORD *off_3B048[2];
// 3B068: using guessed type _QWORD off_3B068[21];
// 3B0E8: using guessed type __int64 off_3B0E8[5];
// 7D278: using guessed type int __fastcall IOSleep(_QWORD);
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000024F7E) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::AllocatePowerStateArray(uintptr_t arg1)
{
  void *v1; // rax@1
  unsigned __int64 v2; // rcx@2
  __int64 v3; // rax@2
  signed int v4; // er14@2
  __int64 v5; // rdx@3
  unsigned __int64 v6; // rsi@3

  *(_QWORD *)(arg1 + 472) = 5LL;
  LODWORD(v1) = IOMalloc(480LL);
  *(_QWORD *)(arg1 + 480) = v1;
  if ( v1 )
  {
    bzero(v1, 0x1E0uLL);
    v2 = *(_QWORD *)(arg1 + 472);
    v3 = *(_QWORD *)(arg1 + 480);
    v4 = 0;
    if ( v2 )
    {
      v5 = *(_QWORD *)(arg1 + 480);
      v6 = 0LL;
      do
      {
        *(_QWORD *)v5 = 1LL;
        ++v6;
        v5 += 96LL;
      }
      while ( v6 < v2 );
    }
    *(_QWORD *)(v3 + 104) = 128LL;
    *(_QWORD *)(v3 + 112) = 128LL;
    *(_QWORD *)(v3 + 200) = 4LL;
    *(_QWORD *)(v3 + 208) = 1LL;
    *(_QWORD *)(v3 + 216) = *(_BYTE *)(*(_QWORD *)(arg1 + 168) + 200LL) ^ 1LL;
    *(_QWORD *)(v3 + 296) = 0x10000LL;
    *(_QWORD *)(v3 + 304) = 0x10000LL;
    *(_QWORD *)(v3 + 312) = 2LL;
    *(_QWORD *)(v3 + 392) = 0x8000LL;
    *(_QWORD *)(v3 + 400) = 2LL;
    *(_QWORD *)(v3 + 408) = 2LL;
  }
  else
  {
    v4 = -536870211;
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D0054u, arg1, 0xFFFFFFFFE00002BDLL, 0LL, 0LL, 0LL);
  }
  return (unsigned int)v4;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 7D250: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (00000000000250B0) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::InitForPM(IOUSBControllerV3 *this)
{
  IOPMrootDomain *v1; // r14@1
  int v2; // eax@1
  signed int v3; // er14@2
  const char *v4; // rax@6

  v1 = (IOPMrootDomain *)IOService::getPMRootDomain(this);
  v2 = (*(int (**)(void))(*(_QWORD *)this + 2936LL))();
  if ( v2 )
  {
    v3 = -536870211;
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D0058u, (uintptr_t)this, v2, 0LL, 0LL, 0LL);
  }
  else
  {
    if ( v1 )
    {
      LODWORD(v4) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 61) + 904LL))(
                      *((_QWORD *)this + 61),
                      0LL);
      *(_QWORD *)(*((_QWORD *)this + 84) + 8LL) = IOPMrootDomain::createPMAssertion(v1, 4uLL, 0, this, v4);
      IOService::registerInterestedDriver(v1, this);
    }
    (*(void (__fastcall **)(IOUSBControllerV3 *))(*(_QWORD *)this + 3336LL))(this);
    IOService::makeUsable(this);
    (*(void (__fastcall **)(IOUSBControllerV3 *, IOUSBControllerV3 *, _QWORD, _QWORD))(*(_QWORD *)this + 1960LL))(
      this,
      this,
      *((_QWORD *)this + 60),
      *((_QWORD *)this + 59));
    IOService::registerInterestedDriver(*((IOService **)this + 61), this);
    IOService::changePowerStateTo(this, *(_DWORD *)(*((_QWORD *)this + 84) + 280LL));
    IOService::changePowerStateToPriv(this, *(_DWORD *)(*((_QWORD *)this + 84) + 280LL));
    v3 = 0;
  }
  return (unsigned int)v3;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 7D618: using guessed type _QWORD __cdecl IOPMrootDomain::createPMAssertion(IOPMrootDomain *__hidden this, unsigned __int64, unsigned int, IOService *, const char *);

//----- (00000000000251D0) ----------------------------------------------------
int __fastcall IOUSBControllerV3::CheckPowerModeBeforeGatedCall(IOUSBControllerV3 *this, char *a2)
{
  return (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 3360LL))(this, a2, 0LL, 0LL);
}

//----- (00000000000251E6) ----------------------------------------------------
__int64 __usercall IOUSBControllerV3::CheckPowerModeBeforeGatedCall@<rax>(IOUSBControllerV3 *this@<rdi>, char *a2@<rsi>, OSObject *a3@<rdx>, __int64 a4@<rax>, unsigned int a5@<ecx>)
{
  unsigned int v5; // ebx@1
  signed int v6; // er15@4
  __int64 v7; // rax@7
  uintptr_t v8; // rdx@12
  int v9; // eax@16
  uintptr_t v10; // rdx@22
  uintptr_t v11; // rcx@22
  uintptr_t v12; // r8@22
  __int64 v13; // rcx@24
  __int64 v14; // rbx@24
  __int64 v15; // r8@24
  __int64 v16; // r9@24
  __int64 v17; // rax@28
  uintptr_t v18; // rdx@32
  uintptr_t v19; // rcx@32
  uintptr_t v20; // r8@32
  __int64 v21; // rax@33
  signed int v22; // er15@34
  signed int v23; // ebx@35
  signed int v24; // ecx@35
  __int64 v25; // r12@42
  int v26; // eax@45
  int v27; // ecx@50
  __int64 v29; // [sp+0h] [bp-30h]@1

  v29 = a4;
  v5 = a5;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
  {
    a2 = (char *)this;
    kernel_debug(
      0x52D0031u,
      (uintptr_t)this,
      *((_QWORD *)this + 57),
      *((_DWORD *)this + 112),
      *(_BYTE *)(*((_QWORD *)this + 84) + 345LL) | ((unsigned __int64)a5 << 16),
      0LL);
  }
  v6 = -536870174;
  if ( *((_QWORD *)this + 17) )
  {
    if ( (v5 & 0x80000000) != 0 && *(_BYTE *)(*((_QWORD *)this + 84) + 345LL) )
    {
      v7 = *((_QWORD *)this + 57);
      if ( v7 == 4 )
      {
        if ( *((_DWORD *)this + 112) == 2 )
        {
LABEL_42:
          v25 = IOUSBController::GetCommandGate(this);
          if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
            kernel_debug(0x52D0030u, (uintptr_t)this, v5, 0LL, 0xCuLL, 0LL);
          v6 = 0;
          v26 = (*(int (__fastcall **)(__int64, __int64 (__fastcall *)(uintptr_t), _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v25 + 456LL))(
                  v25,
                  IOUSBControllerV3::WaitForPCIPauseToFinish,
                  0LL,
                  0LL,
                  0LL,
                  0LL);
          if ( !v26 || !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
            goto LABEL_61;
          v10 = v26;
          v6 = 0;
          v11 = 0LL;
          v12 = 13LL;
          goto LABEL_49;
        }
      }
      else if ( v7 == 2 && *((_DWORD *)this + 112) == -1 )
      {
        goto LABEL_42;
      }
    }
    v8 = *((_QWORD *)this + 57);
    if ( v8 != 4 )
    {
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        a2 = (char *)this;
        kernel_debug(0x52D0030u, (uintptr_t)this, v8, v5, 0xBuLL, 0LL);
      }
      v9 = *((_DWORD *)this + 112);
      if ( v9 != -1 && v9 != 4 )
      {
LABEL_41:
        v6 = -536870163;
        goto LABEL_61;
      }
      if ( (unsigned __int8)(*(int (__fastcall **)(_QWORD, char *))(**((_QWORD **)this + 17) + 304LL))(
                              *((_QWORD *)this + 17),
                              a2) )
      {
        v6 = 0;
        if ( !*((_BYTE *)this + 444) )
        {
          v6 = -536870911;
          if ( gUSBStackDebugFlags & 2 )
          {
            if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
            {
              v10 = *((_DWORD *)this + 114);
              v11 = -536870911LL;
              v12 = 1LL;
LABEL_49:
              kernel_debug(0x52D0030u, (uintptr_t)this, v10, v11, v12, 0LL);
              goto LABEL_61;
            }
          }
        }
LABEL_61:
        if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          kernel_debug(0x52D0032u, (uintptr_t)this, v6, 0LL, 0LL, 0LL);
        return (unsigned int)v6;
      }
      if ( (unsigned __int8)(*(int (**)(void))(**((_QWORD **)this + 17) + 312LL))() )
      {
        v14 = IOUSBController::GetCommandGate(this);
        v6 = -536870211;
        if ( !v14 )
          goto LABEL_61;
        *(_DWORD *)(*((_QWORD *)this + 84) + 20LL) = 1;
        if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          kernel_debug(0x52D0030u, (uintptr_t)this, *((_QWORD *)this + 57), 1uLL, 0xAuLL, 0LL);
        clock_interval_to_deadline(5LL, 1000000000LL, &v29, v13, v15, v16);
        LODWORD(v17) = (*(int (__fastcall **)(__int64, signed __int64, __int64, signed __int64))(*(_QWORD *)v14 + 496LL))(
                         v14,
                         *((_QWORD *)this + 84) + 20LL,
                         v29,
                         2LL);
        if ( (signed int)v17 >= 0 )
        {
          v27 = v17;
          if ( (unsigned int)v17 <= 3 )
          {
            v17 = (__int64)off_25764;
            switch ( v27 )
            {
              case 0:
                if ( !(gUSBStackDebugFlags & 2) )
                  goto LABEL_60;
                v6 = 0;
                if ( !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
                  goto LABEL_61;
                v10 = *((_QWORD *)this + 57);
                v6 = 0;
                v11 = 0LL;
                v12 = 4LL;
                goto LABEL_49;
              case 1:
                if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
                  kernel_debug(0x52D0030u, (uintptr_t)this, *((_QWORD *)this + 57), 1uLL, 5uLL, 0LL);
                *(_DWORD *)(*((_QWORD *)this + 84) + 20LL) = 0;
                v6 = -536870186;
                break;
              case 2:
                if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
                  kernel_debug(0x52D0030u, (uintptr_t)this, *((_QWORD *)this + 57), 2uLL, 6uLL, 0LL);
                *(_DWORD *)(*((_QWORD *)this + 84) + 20LL) = 0;
                v6 = -536870165;
                break;
              case 3:
                if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
                  kernel_debug(0x52D0030u, (uintptr_t)this, *((_QWORD *)this + 57), 3uLL, 7uLL, 0LL);
                *(_DWORD *)(*((_QWORD *)this + 84) + 20LL) = 0;
                v6 = -536870199;
                break;
              default:
                goto LABEL_51;
            }
            goto LABEL_61;
          }
        }
        else if ( (_DWORD)v17 == -536870174 )
        {
          if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
            goto LABEL_55;
          v18 = *((_QWORD *)this + 57);
          v19 = -536870174LL;
          v20 = 8LL;
LABEL_54:
          kernel_debug(0x52D0030u, (uintptr_t)this, v18, v19, v20, 0LL);
LABEL_55:
          *(_DWORD *)(*((_QWORD *)this + 84) + 20LL) = 0;
          v6 = -536870174;
          goto LABEL_61;
        }
LABEL_51:
        if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
          goto LABEL_55;
        v19 = (signed int)v17;
        v18 = *((_QWORD *)this + 57);
        v20 = 9LL;
        goto LABEL_54;
      }
      v21 = *((_QWORD *)this + 57);
      if ( v21 != 4 )
      {
        v22 = 100;
        do
        {
          v23 = v22;
          v24 = v21;
          if ( v22 <= 0 )
            break;
          --v22;
          IOSleep(10LL);
          v21 = *((_QWORD *)this + 57);
          v24 = 4;
        }
        while ( v21 != 4 );
        v6 = 0;
        if ( v23 > 1 )
          goto LABEL_61;
        if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          kernel_debug(0x52D0030u, (uintptr_t)this, v24, 0xFFFFFFFFE00002EDLL, 2uLL, 0LL);
        goto LABEL_41;
      }
    }
LABEL_60:
    v6 = 0;
    goto LABEL_61;
  }
  return (unsigned int)v6;
}
// 25764: using guessed type void *__ptr32 off_25764[4];
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 7D278: using guessed type int __fastcall IOSleep(_QWORD);
// 7E178: using guessed type int __fastcall clock_interval_to_deadline(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000025774) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::WaitForPCIPauseToFinish(uintptr_t arg1)
{
  __int64 v1; // rcx@1
  __int64 v2; // rbx@1
  __int64 v3; // r8@1
  __int64 v4; // r9@1
  __int64 v5; // rax@2
  uintptr_t v6; // rdx@2
  signed int v7; // er14@3
  uintptr_t v8; // rcx@5
  uintptr_t v9; // r8@5
  int v10; // edx@9
  __int64 v11; // rax@12
  __int64 v12; // rcx@12
  int v13; // ecx@17
  __int64 v15; // [sp+8h] [bp-28h]@12

  v2 = IOUSBController::GetCommandGate((IOUSBController *)arg1);
  if ( v2 )
  {
    v5 = *(_QWORD *)(arg1 + 672);
    v6 = *(_DWORD *)(v5 + 348);
    if ( v6 < 0x20 )
    {
      *(_BYTE *)(v5 + 346) = 1;
      v10 = v6 + 1;
      *(_DWORD *)(v5 + 348) = v10;
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D00ACu, arg1, *(_QWORD *)(arg1 + 456), v10, 0xAuLL, 0LL);
      clock_interval_to_deadline(30LL, 1000000000LL, &v15, v1, v3, v4);
      LODWORD(v11) = (*(int (__fastcall **)(__int64, signed __int64, __int64, signed __int64))(*(_QWORD *)v2 + 496LL))(
                       v2,
                       *(_QWORD *)(arg1 + 672) + *(_DWORD *)(*(_QWORD *)(arg1 + 672) + 348LL) - 1 + 352LL,
                       v15,
                       2LL);
      v12 = *(_QWORD *)(arg1 + 672);
      --*(_DWORD *)(v12 + 348);
      *(_BYTE *)(v12 + 346) = 0;
      if ( (signed int)v11 >= 0 )
      {
        v13 = v11;
        if ( (unsigned int)v11 <= 3 )
        {
          v11 = (__int64)off_25A9C;
          switch ( v13 )
          {
            case 0:
              v7 = 0;
              if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
                goto LABEL_22;
              v6 = *(_QWORD *)(arg1 + 456);
              v7 = 0;
              v8 = 0LL;
              v9 = 4LL;
              goto LABEL_21;
            case 1:
              v7 = -536870186;
              if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
                goto LABEL_22;
              v6 = *(_QWORD *)(arg1 + 456);
              v8 = 1LL;
              v9 = 5LL;
              goto LABEL_21;
            case 2:
              v7 = -536870165;
              if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
                goto LABEL_22;
              v6 = *(_QWORD *)(arg1 + 456);
              v8 = 2LL;
              v9 = 6LL;
              goto LABEL_21;
            case 3:
              v7 = -536870199;
              if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
                goto LABEL_22;
              v6 = *(_QWORD *)(arg1 + 456);
              v8 = 3LL;
              v9 = 7LL;
              break;
            default:
              goto LABEL_18;
          }
          goto LABEL_21;
        }
      }
      else if ( (_DWORD)v11 == -536870174 )
      {
        v7 = -536870174;
        if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        {
          v6 = *(_QWORD *)(arg1 + 456);
          v8 = -536870174LL;
          v9 = 8LL;
          goto LABEL_21;
        }
        goto LABEL_22;
      }
LABEL_18:
      v7 = -536870174;
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        v8 = (signed int)v11;
        v6 = *(_QWORD *)(arg1 + 456);
        v9 = 9LL;
        goto LABEL_21;
      }
      goto LABEL_22;
    }
    v7 = -536870211;
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      v8 = 0LL;
      v9 = 15LL;
LABEL_21:
      kernel_debug(0x52D00ACu, arg1, v6, v8, v9, 0LL);
      goto LABEL_22;
    }
  }
  else
  {
    v7 = -536870211;
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      v6 = *(_QWORD *)(arg1 + 456);
      v8 = 0LL;
      v9 = 1LL;
      goto LABEL_21;
    }
  }
LABEL_22:
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D00ACu, arg1, v7, 0LL, 2uLL, 0LL);
  return (unsigned int)v7;
}
// 25A9C: using guessed type void *__ptr32 off_25A9C[4];
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 7E178: using guessed type int __fastcall clock_interval_to_deadline(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000025AAC) ----------------------------------------------------
int __fastcall IOUSBControllerV3::DoEnableAddressEndpoints(IOUSBControllerV3 *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  LOBYTE(a4) = a3 != 0LL;
  return (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 3112LL))(
           this,
           (unsigned __int16)a2,
           a3 != 0LL,
           a4,
           a5,
           a6);
}

//----- (0000000000025ACA) ----------------------------------------------------
int __fastcall IOUSBControllerV3::EnableAddressEndpoints(IOUSBControllerV3 *this, unsigned int a2, unsigned __int8 a3)
{
  unsigned __int8 v3; // bl@1
  __int64 v4; // rax@1

  v3 = a3;
  v4 = IOUSBController::GetCommandGate(this);
  return (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v4 + 456LL))(
           v4,
           IOUSBControllerV3::DoEnableAddressEndpoints,
           a2,
           v3,
           0LL,
           0LL);
}

//----- (0000000000025B02) ----------------------------------------------------
int __fastcall IOUSBControllerV3::DoEnableAllEndpoints(IOUSBControllerV3 *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  LOBYTE(a4) = a2 != 0LL;
  return (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 3120LL))(
           this,
           a2 != 0LL,
           a3,
           a4,
           a5,
           a6);
}

//----- (0000000000025B1C) ----------------------------------------------------
int __fastcall IOUSBControllerV3::EnableAllEndpoints(IOUSBControllerV3 *this, unsigned __int8 a2)
{
  __int64 v2; // rax@1

  v2 = IOUSBController::GetCommandGate(this);
  return (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v2 + 456LL))(
           v2,
           IOUSBControllerV3::DoEnableAllEndpoints,
           a2,
           0LL,
           0LL,
           0LL);
}

//----- (0000000000025B52) ----------------------------------------------------
int __fastcall IOUSBControllerV3::ControllerOff(IOUSBControllerV3 *this)
{
  __int64 v1; // rax@1
  __int64 v2; // rax@4
  __int64 v3; // rdi@5

  v1 = *((_QWORD *)this + 84);
  if ( v1 && *(_BYTE *)(v1 + 249) )
    (*(void (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 61) + 2384LL))(*((_QWORD *)this + 61), 0LL);
  (*(void (__fastcall **)(IOUSBControllerV3 *))(*(_QWORD *)this + 3064LL))(this);
  v2 = *((_QWORD *)this + 21);
  if ( v2 )
  {
    v3 = *(_QWORD *)(v2 + 16);
    if ( v3 )
    {
      if ( *(_BYTE *)(v2 + 25) )
      {
        *(_BYTE *)(v2 + 25) = 0;
        LODWORD(v2) = (*(int (**)(void))(*(_QWORD *)v3 + 536LL))();
      }
    }
  }
  return v2;
}

//----- (0000000000025BC4) ----------------------------------------------------
int __fastcall IOUSBControllerV3::ControllerRestart(IOUSBControllerV3 *this)
{
  return (*(int (**)(void))(*(_QWORD *)this + 3024LL))();
}

//----- (0000000000025BD2) ----------------------------------------------------
int __fastcall IOUSBControllerV3::ControllerSleep(IOUSBControllerV3 *this)
{
  __int64 v1; // rax@3

  if ( *((_QWORD *)this + 57) == 3LL )
    (*(void (__cdecl **)(IOUSBControllerV3 *))(*(_QWORD *)this + 3104LL))(this);
  (*(void (__fastcall **)(IOUSBControllerV3 *, _QWORD))(*(_QWORD *)this + 3128LL))(this, 0LL);
  LODWORD(v1) = (*(int (__fastcall **)(IOUSBControllerV3 *))(*(_QWORD *)this + 3080LL))(this);
  if ( *((_QWORD *)this + 84) )
  {
    v1 = *((_QWORD *)this + 21);
    if ( *(_BYTE *)(v1 + 244) )
      LODWORD(v1) = IOService::requireMaxBusStall(this, 0);
  }
  return v1;
}

//----- (0000000000025C3C) ----------------------------------------------------
int __fastcall IOUSBControllerV3::ControllerDoze(IOUSBControllerV3 *this)
{
  __int64 v1; // rax@5

  if ( *((_QWORD *)this + 57) >= 2uLL )
  {
    if ( *((_QWORD *)this + 57) == 2LL )
      (*(void (__cdecl **)(IOUSBControllerV3 *))(*(_QWORD *)this + 3088LL))(this);
  }
  else
  {
    *(_DWORD *)(*((_QWORD *)this + 21) + 232LL) = 1000;
    (*(void (__cdecl **)(IOUSBControllerV3 *))(*(_QWORD *)this + 3072LL))(this);
  }
  LODWORD(v1) = (*(int (__fastcall **)(IOUSBControllerV3 *))(*(_QWORD *)this + 3096LL))(this);
  if ( *((_QWORD *)this + 84) )
  {
    v1 = *((_QWORD *)this + 21);
    if ( *(_BYTE *)(v1 + 244) )
      LODWORD(v1) = IOService::requireMaxBusStall(this, 0);
  }
  return v1;
}

//----- (0000000000025CBA) ----------------------------------------------------
void __usercall IOUSBControllerV3::ControllerOn(IOUSBControllerV3 *this@<rdi>, __int64 a2@<rax>)
{
  signed __int64 v2; // rsi@1
  unsigned __int16 v3; // ax@1
  signed __int64 v4; // rax@4
  signed __int64 v5; // rax@9
  __int64 v6; // rax@10
  unsigned __int64 v7; // rax@13
  __int64 v8; // [sp-8h] [bp-10h]@1

  v8 = a2;
  v2 = 6LL;
  v3 = IOPCIDevice::extendedConfigRead16(*((IOPCIDevice **)this + 61), 6uLL);
  if ( v3 == 0xFFFF )
  {
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D002Cu, (uintptr_t)this, 0xFFFFuLL, 0LL, 0x1BuLL, 0LL);
  }
  else
  {
    if ( HIBYTE(v3) & 0x20 )
    {
      if ( BYTE1(gUSBStackDebugFlags) & 0x80 )
      {
        LODWORD(v4) = (*(int (__fastcall **)(IOUSBControllerV3 *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
        v2 = v4;
        panic(
          "\"IOUSBControllerV3(%s)[%p] PCI Master Abort status is active\\n\"@/SourceCache/IOUSBFamily_kexts/IOUSBFamily-710.4.14/IOUSBFamily/Classes/IOUSBControllerV3.cpp:1868",
          v4,
          this,
          v8);
      }
      else if ( BYTE1(gUSBStackDebugFlags) & 0x40 )
      {
        LODWORD(v5) = (*(int (__fastcall **)(IOUSBControllerV3 *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
        v2 = v5;
        IOLog("IOUSBControllerV3(%s)[%p] PCI Master Abort status is active\n", v2, this, v2);
      }
    }
    v6 = *((_QWORD *)this + 84);
    if ( v6 && *(_BYTE *)(*((_QWORD *)this + 21) + 244LL) )
    {
      v2 = *(_DWORD *)(v6 + 300);
      IOService::requireMaxBusStall(this, v2);
    }
    v7 = *((_QWORD *)this + 57);
    if ( v7 == 3 )
    {
      (*(void (__fastcall **)(IOUSBControllerV3 *, signed __int64))(*(_QWORD *)this + 3104LL))(this, v2);
    }
    else if ( v7 == 2 )
    {
      (*(void (__fastcall **)(IOUSBControllerV3 *, signed __int64))(*(_QWORD *)this + 3088LL))(this, v2);
    }
    else if ( v7 <= 1 )
    {
      *(_DWORD *)(*((_QWORD *)this + 21) + 232LL) = 1000;
      (*(void (__fastcall **)(IOUSBControllerV3 *, signed __int64))(*(_QWORD *)this + 3072LL))(this, v2);
    }
  }
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 7D240: using guessed type int __fastcall IOLog(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000025E1E) ----------------------------------------------------
char __fastcall IOUSBControllerV3::IsControllerAvailable(IOUSBControllerV3 *this)
{
  return *((_BYTE *)this + 444);
}

//----- (0000000000025E2A) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::GatedPowerChange(IOUSBControllerV3 *this, uintptr_t arg2, void *a3, void *a4, void *a5, void *a6)
{
  unsigned __int64 v6; // r14@1
  uintptr_t v7; // rbx@1
  uintptr_t v8; // r15@1
  __int64 v9; // rdx@16
  int v10; // eax@18
  int v11; // eax@23
  __int64 v12; // rax@29
  __int64 v13; // rdi@30
  __int64 v14; // rax@34

  v6 = arg2;
  v7 = (uintptr_t)this;
  v8 = *((_QWORD *)this + 57);
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
  {
    arg2 = (uintptr_t)this;
    kernel_debug(0x52D0035u, (uintptr_t)this, v6, v8, 0LL, 0LL);
  }
  switch ( v6 )
  {
    case 0uLL:
      (*(void (__fastcall **)(IOUSBControllerV3 *, uintptr_t, void *, void *, void *, void *))(*(_QWORD *)this + 3024LL))(
        this,
        arg2,
        a3,
        a4,
        a5,
        a6);
      break;
    case 1uLL:
      (*(void (__fastcall **)(IOUSBControllerV3 *, uintptr_t, void *, void *, void *, void *))(*(_QWORD *)this + 3032LL))(
        this,
        arg2,
        a3,
        a4,
        a5,
        a6);
      break;
    case 2uLL:
      (*(void (__fastcall **)(IOUSBControllerV3 *, uintptr_t, void *, void *, void *, void *))(*(_QWORD *)this + 3040LL))(
        this,
        arg2,
        a3,
        a4,
        a5,
        a6);
      break;
    case 3uLL:
      (*(void (__fastcall **)(IOUSBControllerV3 *, uintptr_t, void *, void *, void *, void *))(*(_QWORD *)this + 3048LL))(
        this,
        arg2,
        a3,
        a4,
        a5,
        a6);
      break;
    case 4uLL:
      (*(void (__fastcall **)(IOUSBControllerV3 *, uintptr_t, void *, void *, void *, void *))(*(_QWORD *)this + 3056LL))(
        this,
        arg2,
        a3,
        a4,
        a5,
        a6);
      break;
    default:
      break;
  }
  *((_QWORD *)this + 57) = v6;
  if ( v6 > 2 )
  {
    *((_BYTE *)this + 444) = 1;
    if ( v8 <= 2 )
    {
      (*(void (__fastcall **)(IOUSBControllerV3 *, signed __int64, void *, void *, void *, void *))(*(_QWORD *)this
                                                                                                  + 3128LL))(
        this,
        1LL,
        a3,
        a4,
        a5,
        a6);
      if ( **((_DWORD **)this + 84) )
        (*(void (__fastcall **)(IOUSBControllerV3 *))(*(_QWORD *)this + 3176LL))(this);
    }
    if ( !*((_QWORD *)this + 19) )
    {
      v9 = *((_QWORD *)this + 21);
      if ( v9 && *(_BYTE *)(v9 + 40) == 3 )
      {
        v10 = (*(int (__fastcall **)(IOUSBControllerV3 *, _QWORD, signed __int64, void *, void *, void *))(*(_QWORD *)this + 2568LL))(
                this,
                *((_QWORD *)this + 61),
                v9 + 216,
                a4,
                a5,
                a6);
        if ( v10 )
        {
          if ( gUSBStackDebugFlags & 2 )
          {
            a4 = (void *)off_3B100[0];
            if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
              kernel_debug(0x52D0034u, (uintptr_t)this, v10, 0LL, 0LL, 0LL);
          }
        }
        else
        {
          (*(void (__fastcall **)(_QWORD, signed __int64))(**(_QWORD **)(*((_QWORD *)this + 21) + 216LL) + 1456LL))(
            *(_QWORD *)(*((_QWORD *)this + 21) + 216LL),
            3LL);
        }
      }
      v11 = (*(int (__fastcall **)(IOUSBControllerV3 *, _QWORD, char *, void *, void *, void *))(*(_QWORD *)this + 2568LL))(
              this,
              *((_QWORD *)this + 61),
              (char *)this + 152,
              a4,
              a5,
              a6);
      if ( v11 )
      {
        if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          kernel_debug(0x52D0034u, (uintptr_t)this, v11, 0LL, 0LL, 0LL);
      }
      else
      {
        (*(void (__fastcall **)(_QWORD, signed __int64))(**((_QWORD **)this + 19) + 1456LL))(
          *((_QWORD *)this + 19),
          3LL);
      }
    }
  }
  else
  {
    *((_BYTE *)this + 444) = 0;
    (*(void (__fastcall **)(IOUSBControllerV3 *, uintptr_t, void *, void *, void *, void *))(*(_QWORD *)this + 3016LL))(
      this,
      arg2,
      a3,
      a4,
      a5,
      a6);
    (*(void (__fastcall **)(IOUSBControllerV3 *, _QWORD))(*(_QWORD *)this + 2968LL))(this, 0LL);
  }
  if ( v6 == 4 )
  {
    v12 = *((_QWORD *)this + 21);
    if ( v12 )
    {
      v13 = *(_QWORD *)(v12 + 16);
      if ( v13 )
      {
        if ( !*(_BYTE *)(v12 + 25) )
        {
          *(_BYTE *)(v12 + 25) = 1;
          (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v13 + 464LL))(v13, *(_DWORD *)(v12 + 232));
        }
      }
    }
    if ( *(_DWORD *)(*(_QWORD *)(v7 + 672) + 20LL) )
    {
      v14 = IOUSBController::GetCommandGate((IOUSBController *)v7);
      if ( v14 )
      {
        (*(void (__fastcall **)(__int64, signed __int64, _QWORD))(*(_QWORD *)v14 + 488LL))(
          v14,
          *(_QWORD *)(v7 + 672) + 20LL,
          0LL);
        if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          kernel_debug(0x52D0034u, v7, 0LL, 0LL, 2uLL, 0LL);
        *(_DWORD *)(*(_QWORD *)(v7 + 672) + 20LL) = 0;
      }
      else if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        kernel_debug(0x52D0034u, v7, 0LL, 0LL, 1uLL, 0LL);
      }
    }
  }
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D0036u, v7, *(_QWORD *)(v7 + 456), 0LL, 0LL, 0LL);
  return 0LL;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (000000000002615C) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::ChangeExternalDeviceCount(IOUSBControllerV3 *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  OSObject *v6; // r14@1
  IOPMrootDomain *v7; // rax@1
  __int64 v8; // rcx@2
  unsigned __int64 v9; // rsi@2
  int v10; // edx@3
  unsigned int v11; // edx@5
  int v12; // edx@6

  v6 = a2;
  v7 = (IOPMrootDomain *)IOService::getPMRootDomain(this);
  if ( v7 )
  {
    v8 = *((_QWORD *)this + 84);
    v9 = *(_QWORD *)(v8 + 8);
    if ( v9 )
    {
      v10 = *(_DWORD *)(v8 + 16);
      if ( v6 )
      {
        *(_DWORD *)(v8 + 16) = v10 + 1;
        if ( !v10 )
        {
          v11 = 255;
LABEL_8:
          IOPMrootDomain::setPMAssertionLevel(v7, v9, v11);
          return 0LL;
        }
      }
      else
      {
        v12 = v10 - 1;
        *(_DWORD *)(v8 + 16) = v12;
        if ( !v12 )
        {
          v11 = 0;
          goto LABEL_8;
        }
      }
    }
  }
  return 0LL;
}

//----- (00000000000261B4) ----------------------------------------------------
int __fastcall IOUSBControllerV3::HandlePowerChange(IOUSBControllerV3 *this, __int64 a2)
{
  __int64 v2; // rax@1

  v2 = IOUSBController::GetCommandGate(this);
  return (*(int (__fastcall **)(__int64, __int64 (__fastcall *)(IOUSBControllerV3 *, uintptr_t, void *, void *, void *, void *), __int64, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v2 + 456LL))(
           v2,
           IOUSBControllerV3::GatedPowerChange,
           a2,
           0LL,
           0LL,
           0LL);
}

//----- (00000000000261EA) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::EnableBusMastering(uintptr_t arg1, char a2)
{
  int v2; // eax@1
  unsigned __int16 v3; // cx@2
  unsigned __int16 v4; // ax@2

  v2 = IOPCIDevice::extendedConfigRead16(*(IOPCIDevice **)(arg1 + 488), 4uLL);
  if ( (unsigned __int16)v2 == 0xFFFF )
  {
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D002Cu, arg1, 0xFFFFuLL, 0LL, 0x1CuLL, 0LL);
  }
  else
  {
    v3 = v2 | 4;
    v4 = v2 & 0xFFFB;
    if ( a2 )
      v4 = v3;
    IOPCIDevice::extendedConfigWrite16(*(IOPCIDevice **)(arg1 + 488), 4uLL, v4);
  }
  return 0LL;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (000000000002627A) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::EnsureUsability(IOUSBControllerV3 *this)
{
  IOUSBControllerV3 *v1; // rbx@1
  __int64 v2; // rdi@1
  __int64 v3; // rax@2
  __int64 v4; // rax@3
  __int64 v5; // rdi@4
  __int64 v6; // rax@5
  __int64 v7; // rax@6

  v1 = this;
  v2 = *((_QWORD *)this + 19);
  if ( v2 )
  {
    LODWORD(v3) = (*(int (__cdecl **)(__int64))(*(_QWORD *)v2 + 2608LL))(v2);
    if ( v3 )
    {
      LODWORD(v4) = (*(int (__cdecl **)(_QWORD))(**((_QWORD **)v1 + 19) + 2608LL))(*((_QWORD *)v1 + 19));
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v4 + 2128LL))(v4);
    }
  }
  v5 = *(_QWORD *)(*((_QWORD *)v1 + 21) + 216LL);
  if ( v5 )
  {
    LODWORD(v6) = (*(int (__cdecl **)(__int64))(*(_QWORD *)v5 + 2608LL))(v5);
    if ( v6 )
    {
      LODWORD(v7) = (*(int (__cdecl **)(_QWORD))(**(_QWORD **)(*((_QWORD *)v1 + 21) + 216LL) + 2608LL))(*(_QWORD *)(*((_QWORD *)v1 + 21) + 216LL));
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v7 + 2128LL))(v7);
    }
  }
  return 0LL;
}

//----- (0000000000026306) ----------------------------------------------------
void __fastcall IOUSBControllerV3::RHCompleteTransaction(uintptr_t arg1, __int64 a2, __int16 a3, __int64 a4, unsigned __int8 a5)
{
  unsigned __int8 v5; // r13@1
  uintptr_t v6; // r12@1
  __int64 v7; // r15@2
  __int64 v8; // r8@2
  __int64 v9; // r9@2
  __int64 v10; // rbx@2
  __int64 v11; // rax@2
  __int16 *v12; // rdx@3
  __int16 *v13; // ST18_8@8
  char v14; // bl@8
  __int16 *v15; // r13@10
  char v16; // bl@10
  int v17; // ebx@11
  __int64 v18; // rax@12
  char v19; // [sp+0h] [bp-80h]@0
  __int64 v20; // [sp+20h] [bp-60h]@6
  __int64 v21; // [sp+28h] [bp-58h]@6
  int v22; // [sp+34h] [bp-4Ch]@6
  __int16 v23; // [sp+54h] [bp-2Ch]@4
  char v24; // [sp+57h] [bp-29h]@3

  v5 = a5;
  v6 = *(_QWORD *)(a2 + 24);
  if ( v6 )
  {
    v7 = *(_QWORD *)a2;
    v8 = *(_DWORD *)(a2 + 8);
    v9 = *(_QWORD *)(a2 + 16);
    v10 = *(_QWORD *)(a2 + 32);
    *(_QWORD *)(a2 + 32) = *(_QWORD *)(a2 + 72);
    *(_QWORD *)(a2 + 24) = *(_QWORD *)(a2 + 64);
    *(_QWORD *)(a2 + 16) = *(_QWORD *)(a2 + 56);
    v11 = *(_QWORD *)(a2 + 40);
    *(_QWORD *)(a2 + 8) = *(_QWORD *)(a2 + 48);
    *(_QWORD *)a2 = v11;
    *(_QWORD *)(a2 + 64) = 0LL;
    if ( (unsigned __int16)a4 > 7u )
    {
      v23 = a3;
      v12 = &v23;
      LOBYTE(a4) = 2;
    }
    else
    {
      v24 = a3;
      v12 = (__int16 *)&v24;
      LOBYTE(a4) = 1;
    }
    if ( v7 )
    {
      v20 = v9;
      v21 = v10;
      v22 = v8;
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        v13 = v12;
        v14 = a4;
        kernel_debug(0x52D0040u, arg1, v5, 0LL, 5uLL, 0LL);
        LOBYTE(a4) = v14;
        v12 = v13;
      }
      if ( v5 )
      {
        v15 = v12;
        v16 = a4;
        (*(void (__fastcall **)(uintptr_t))(*(_QWORD *)arg1 + 3016LL))(arg1);
        LOBYTE(a4) = v16;
        v12 = v15;
        *(_BYTE *)(*(_QWORD *)(arg1 + 672) + 4LL) = 0;
      }
      v17 = (unsigned __int8)a4;
      (*(void (__fastcall **)(__int64, _QWORD, __int16 *, _QWORD))(*(_QWORD *)v7 + 488LL))(
        v7,
        0LL,
        v12,
        (unsigned __int8)a4);
      IOUSBController::Complete(arg1, v6, v22 - v17, 0, v20, v6, v21);
    }
    else
    {
      LODWORD(v18) = (*(int (__fastcall **)(uintptr_t, _QWORD, __int16 *, __int64, __int64, __int64))(*(_QWORD *)arg1 + 904LL))(
                       arg1,
                       0LL,
                       v12,
                       a4,
                       v8,
                       v9);
      KernelDebugLogInternal(
        1u,
        0x55534246u,
        (__int64)"IOUSBControllerV3(%s)::RHCompleteTransaction - NULL action(%p) or buf(%p)",
        v18,
        v6,
        0LL,
        v19);
    }
  }
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (0000000000026494) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::CheckForRootHubChanges(uintptr_t arg1)
{
  uintptr_t v1; // r14@1
  __int64 v2; // rdi@3
  __int64 v3; // rax@4
  __int64 v4; // rax@5
  __int64 v5; // rdi@9
  __int64 v6; // rax@10
  __int64 v7; // rax@11
  __int64 v8; // rsi@16
  char v9; // r8@16
  int v10; // edi@16
  int v11; // ebx@16
  unsigned int v12; // er13@16
  __int16 v13; // r9@16
  char v14; // dl@16
  char v15; // al@16
  unsigned int v16; // er15@16
  __int16 v17; // r12@16
  __int64 v18; // rax@16
  signed __int64 v19; // rcx@16
  char v20; // bl@17
  __int64 v21; // rax@19
  signed __int64 v22; // rcx@19
  int v23; // er13@23
  int v24; // er15@25

  v1 = arg1;
  (*(void (__cdecl **)(uintptr_t))(*(_QWORD *)arg1 + 2248LL))(arg1);
  if ( *(_WORD *)(arg1 + 506) || *(_DWORD *)(*(_QWORD *)(arg1 + 672) + 204LL) )
  {
    v2 = *(_QWORD *)(arg1 + 152);
    if ( v2 )
    {
      LODWORD(v3) = (*(int (__cdecl **)(__int64))(*(_QWORD *)v2 + 2608LL))(v2);
      if ( v3 )
      {
        LODWORD(v4) = (*(int (__cdecl **)(_QWORD))(**(_QWORD **)(v1 + 152) + 2608LL))(*(_QWORD *)(v1 + 152));
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v4 + 2128LL))(v4);
      }
      else if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        kernel_debug(0x52D0038u, v1, *(_WORD *)(v1 + 506), 0LL, 0LL, 0LL);
      }
    }
    v5 = *(_QWORD *)(*(_QWORD *)(v1 + 168) + 216LL);
    if ( v5 )
    {
      LODWORD(v6) = (*(int (__cdecl **)(__int64))(*(_QWORD *)v5 + 2608LL))(v5);
      if ( v6 )
      {
        LODWORD(v7) = (*(int (__cdecl **)(_QWORD))(**(_QWORD **)(*(_QWORD *)(v1 + 168) + 216LL) + 2608LL))(*(_QWORD *)(*(_QWORD *)(v1 + 168) + 216LL));
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v7 + 2128LL))(v7);
      }
      else if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        kernel_debug(0x52D0038u, v1, *(_WORD *)(v1 + 506), 0LL, 1uLL, 0LL);
      }
    }
    if ( *(_BYTE *)(*(_QWORD *)(v1 + 168) + 40LL) == 3 )
    {
      v8 = *(_QWORD *)(v1 + 672);
      v9 = *(_BYTE *)(v8 + 33);
      v10 = *(_DWORD *)(v8 + 204);
      v11 = *(_DWORD *)(v8 + 204) & 1;
      v12 = v11 | 2
                * ((v10 & ((unsigned int)(-1 << (31 - (*(_BYTE *)(v8 + 34) + v9 - 1))) >> (*(_BYTE *)(v8 + 34)
                                                                                         + 31
                                                                                         - (*(_BYTE *)(v8 + 34)
                                                                                          + v9
                                                                                          - 1)) << *(_BYTE *)(v8 + 34))) >> *(_BYTE *)(v8 + 34));
      v13 = *(_WORD *)(v8 + 204) & 1 | 2
                                     * ((v10 & ((unsigned int)(-1 << (31 - (*(_BYTE *)(v8 + 34) + v9 - 1))) >> (*(_BYTE *)(v8 + 34) + 31 - (*(_BYTE *)(v8 + 34) + v9 - 1)) << *(_BYTE *)(v8 + 34))) >> *(_BYTE *)(v8 + 34));
      v14 = *(_BYTE *)(v8 + 35);
      v15 = 31 - (v14 + *(_BYTE *)(v8 + 32) - 1);
      v16 = v11 | 2 * ((v10 & ((unsigned int)(-1 << v15) >> (v14 + v15) << *(_BYTE *)(v8 + 35))) >> *(_BYTE *)(v8 + 35));
      v17 = *(_WORD *)(v8 + 204) & 1 | 2
                                     * ((v10 & ((unsigned int)(-1 << v15) >> (v14 + v15) << *(_BYTE *)(v8 + 35))) >> *(_BYTE *)(v8 + 35));
      v18 = v17 != 0;
      v19 = v8 + 40 * v18 + 64;
      while ( 1 )
      {
        v20 = 1;
        if ( *(_QWORD *)v19 )
          break;
        LODWORD(v18) = v18 + 1;
        v19 += 40LL;
        if ( (signed int)v18 > 1 )
        {
          v21 = v13 != 0;
          v22 = v1 + 40 * v21 + 536;
          while ( !*(_QWORD *)v22 )
          {
            LODWORD(v21) = v21 + 1;
            v22 += 40LL;
            if ( (signed int)v21 > 1 )
            {
              v20 = 0;
              goto LABEL_23;
            }
          }
          break;
        }
      }
LABEL_23:
      v23 = (unsigned __int16)v12;
      if ( v23 )
      {
        IOUSBControllerV3::RHCompleteTransaction(v1, v1 + 512, v13, *(_BYTE *)(v8 + 33), v20 == 0);
        v8 = *(_QWORD *)(v1 + 672);
        *(_DWORD *)(v8 + 204) = v23;
      }
      v24 = (unsigned __int16)v16;
      if ( v24 )
      {
        IOUSBControllerV3::RHCompleteTransaction(v1, v8 + 40, v17, *(_BYTE *)(v8 + 32), v20 == 0);
        *(_DWORD *)(*(_QWORD *)(v1 + 672) + 204LL) |= v24;
      }
    }
    else
    {
      IOUSBControllerV3::RHCompleteTransaction(
        v1,
        v1 + 512,
        *(_WORD *)(v1 + 506),
        *(_BYTE *)(v1 + 505),
        *(_QWORD *)(v1 + 576) == 0LL);
    }
  }
  return 0LL;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (0000000000026762) ----------------------------------------------------
__int64 __usercall IOUSBControllerV3::RHQueueTransaction@<rax>(int a1@<edx>, __int64 a2@<rcx>, __int64 a3@<rdi>, __int64 a4@<rsi>, __int64 a5, __int64 a6, __int64 a7)
{
  signed int v7; // ebx@1

  v7 = -536870174;
  if ( !*(_QWORD *)(a2 + 24) )
  {
    *(_QWORD *)a2 = a4;
    *(_DWORD *)(a2 + 8) = a1;
    *(_QWORD *)(a2 + 32) = a7;
    *(_QWORD *)(a2 + 24) = a6;
    *(_QWORD *)(a2 + 16) = a5;
    v7 = 0;
    if ( *(_BYTE *)(*(_QWORD *)(a3 + 672) + 4LL) )
      (*(void (__cdecl **)(__int64))(*(_QWORD *)a3 + 2984LL))(a3);
  }
  return (unsigned int)v7;
}

//----- (00000000000267B6) ----------------------------------------------------
__int64 __usercall IOUSBControllerV3::RootHubQueueInterruptRead@<rax>(uintptr_t arg1@<rdi>, uintptr_t arg2@<rsi>, uintptr_t arg3@<rdx>, __int64 a4, __int64 a5, __int64 a6)
{
  unsigned int v6; // er12@1
  signed __int64 v7; // r13@4
  unsigned int v8; // er14@4
  signed int v9; // er12@7

  v6 = arg3;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D003Du, arg1, arg2, (unsigned int)arg3, 0LL, 0LL);
  (*(void (__fastcall **)(uintptr_t, signed __int64))(*(_QWORD *)arg1 + 3176LL))(arg1, 32LL);
  v7 = arg1 + 512;
  v8 = v6;
  if ( *(_BYTE *)(*(_QWORD *)(arg1 + 168) + 40LL) == 3
    && ((*(int (__fastcall **)(uintptr_t))(*(_QWORD *)arg2 + 472LL))(arg2) & 3) == 3 )
    v7 = *(_QWORD *)(arg1 + 672) + 40LL;
  v9 = -536870174;
  if ( !*(_QWORD *)(v7 + 24) )
  {
    *(_QWORD *)v7 = arg2;
    *(_DWORD *)(v7 + 8) = v8;
    *(_QWORD *)(v7 + 32) = a6;
    *(_QWORD *)(v7 + 24) = a5;
    *(_QWORD *)(v7 + 16) = a4;
    v9 = 0;
    if ( *(_BYTE *)(*(_QWORD *)(arg1 + 672) + 4LL) )
      (*(void (__fastcall **)(uintptr_t))(*(_QWORD *)arg1 + 2984LL))(arg1);
  }
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D003Eu, arg1, v9, v8, 0LL, 0LL);
  return (unsigned int)v9;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (0000000000026910) ----------------------------------------------------
uintptr_t __fastcall IOUSBControllerV3::RHAbortTransaction(uintptr_t arg1, __int64 a2)
{
  uintptr_t result; // rax@1
  __int64 v3; // r8@2
  __int64 v4; // r9@2
  unsigned int v5; // edx@2
  __int64 v6; // rcx@2

  result = *(_QWORD *)(a2 + 24);
  if ( result )
  {
    v3 = *(_QWORD *)(a2 + 32);
    v4 = *(_QWORD *)(a2 + 16);
    v5 = *(_DWORD *)(a2 + 8);
    *(_QWORD *)(a2 + 32) = *(_QWORD *)(a2 + 72);
    *(_QWORD *)(a2 + 24) = *(_QWORD *)(a2 + 64);
    *(_QWORD *)(a2 + 16) = *(_QWORD *)(a2 + 56);
    v6 = *(_QWORD *)(a2 + 40);
    *(_QWORD *)(a2 + 8) = *(_QWORD *)(a2 + 48);
    *(_QWORD *)a2 = v6;
    *(_QWORD *)(a2 + 64) = 0LL;
    IOUSBController::Complete(arg1, result, v5, 0xE00002EB, v4, result, v3);
    result = *(_QWORD *)(arg1 + 672);
    *(_BYTE *)(result + 4) = 1;
  }
  return result;
}

//----- (00000000000269A4) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::RootHubAbortInterruptRead(uintptr_t arg1)
{
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D0040u, arg1, 0LL, 0LL, 3uLL, 0LL);
  (*(void (__fastcall **)(uintptr_t))(*(_QWORD *)arg1 + 3016LL))(arg1);
  if ( *(_BYTE *)(*(_QWORD *)(arg1 + 168) + 40LL) == 3 )
    IOUSBControllerV3::RHAbortTransaction(arg1, *(_QWORD *)(arg1 + 672) + 40LL);
  IOUSBControllerV3::RHAbortTransaction(arg1, arg1 + 512);
  return 0LL;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (0000000000026A2A) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::RootHubStartTimer(IOUSBControllerV3 *this)
{
  return 3758097095LL;
}

//----- (0000000000026A36) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::RootHubStartTimer32(uintptr_t arg1, uintptr_t arg2)
{
  uintptr_t v2; // r15@1
  __int64 v3; // rdi@5
  signed int v4; // er14@6
  uintptr_t v5; // rcx@9
  uintptr_t v6; // r8@9

  v2 = arg1;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D0040u, arg1, (unsigned int)arg2, 0LL, 1uLL, 0LL);
  if ( (_DWORD)arg2 )
  {
    **(_DWORD **)(arg1 + 672) = arg2;
    v3 = *(_QWORD *)(arg1 + 496);
    if ( v3 )
    {
      (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v3 + 464LL))(v3, (unsigned int)arg2);
      v4 = 0;
      return (unsigned int)v4;
    }
    v4 = 0;
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      v4 = 0;
      v5 = 0LL;
      v6 = 7LL;
      goto LABEL_13;
    }
  }
  else
  {
    v4 = -536870206;
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      v5 = -536870206LL;
      v6 = 6LL;
LABEL_13:
      kernel_debug(0x52D0040u, v2, 0LL, v5, v6, 0LL);
      return (unsigned int)v4;
    }
  }
  return (unsigned int)v4;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (0000000000026B1A) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::RootHubStopTimer(uintptr_t arg1)
{
  __int64 v1; // rdi@4

  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D0040u, arg1, 0LL, 0LL, 2uLL, 0LL);
  v1 = *(_QWORD *)(arg1 + 496);
  if ( v1 )
    (*(void (__cdecl **)(__int64))(*(_QWORD *)v1 + 536LL))(v1);
  return 0LL;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (0000000000026B76) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::AllocateExtraRootHubPortPower(IOUSBControllerV3 *this)
{
  return 0LL;
}

//----- (0000000000026B7E) ----------------------------------------------------
void __fastcall IOUSBControllerV3::ReturnExtraRootHubPortPower(IOUSBControllerV3 *this)
{
  ;
}

//----- (0000000000026B84) ----------------------------------------------------
int __fastcall IOUSBControllerV3::CheckPMAssertions(IOUSBControllerV3 *this, IOUSBDevice *a2, unsigned __int8 a3)
{
  unsigned __int8 v3; // r14@1
  __int64 v4; // r15@1
  int result; // eax@3

  v3 = a3;
  v4 = IOUSBController::GetCommandGate(this);
  if ( a2 && !IOUSBDevice::IsDeviceInternal(a2) )
    result = (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v4 + 456LL))(
               v4,
               IOUSBControllerV3::ChangeExternalDeviceCount,
               v3,
               0LL,
               0LL,
               0LL);
  else
    result = -536870199;
  return result;
}

//----- (0000000000026BEA) ----------------------------------------------------
signed __int64 __fastcall IOUSBControllerV3::GetRootHubBOSDescriptor(IOUSBControllerV3 *this, OSData *a2)
{
  return 3758097095LL;
}

//----- (0000000000026BF6) ----------------------------------------------------
signed __int64 IOUSBControllerV3::GetRootHub3Descriptor()
{
  return 3758097095LL;
}

//----- (0000000000026C02) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::GetRootHubPortErrorCount(IOUSBControllerV3 *this, __int64 a2, unsigned __int16 *a3)
{
  return 3758097095LL;
}

//----- (0000000000026C0E) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::UIMDeviceToBeReset(IOUSBControllerV3 *this)
{
  return 3758097095LL;
}

//----- (0000000000026C1A) ----------------------------------------------------
int __usercall IOUSBControllerV3::UIMAbortStream@<eax>(IOUSBControllerV3 *this@<rdi>, char a2@<al>, __int16 a3@<dx>, __int16 a4@<cx>, unsigned int a5@<esi>, __int16 a6@<r8w>)
{
  __int64 v6; // rax@2
  __int64 v7; // r9@2
  int result; // eax@2
  char v9; // [sp-8h] [bp-10h]@1

  v9 = a2;
  if ( (a5 & 0x80000000) != 0 )
  {
    result = (*(int (__fastcall **)(IOUSBControllerV3 *, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 2224LL))(
               this,
               (unsigned int)a3,
               (unsigned int)a4,
               (unsigned int)a6);
  }
  else
  {
    LODWORD(v6) = (*(int (__fastcall **)(IOUSBControllerV3 *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
    KernelDebugLogInternal(
      1u,
      0x55534246u,
      (__int64)"IOUSBControllerV3(%s)::UIMAbortEndpoint - Stream version called for UIM which doesn't support it (0x%x)",
      v6,
      a5,
      v7,
      v9);
    result = -536870201;
  }
  return result;
}

//----- (0000000000026C78) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::UIMMaxSupportedStream(IOUSBControllerV3 *this)
{
  return 0LL;
}

//----- (0000000000026C80) ----------------------------------------------------
int __fastcall IOUSBControllerV3::GetActualDeviceAddress(IOUSBControllerV3 *this, unsigned int a2, unsigned __int16 *a3)
{
  unsigned __int16 *v3; // r14@1
  __int64 v4; // rax@1

  v3 = a3;
  v4 = IOUSBController::GetCommandGate(this);
  return (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v4 + 456LL))(
           v4,
           IOUSBControllerV3::DoGetActualDeviceAddress,
           a2,
           v3,
           0LL,
           0LL);
}

//----- (0000000000026CB8) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::DoGetActualDeviceAddress(IOUSBControllerV3 *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  void *v6; // rbx@1
  __int16 v7; // ax@1
  bool v8; // zf@1
  __int64 result; // rax@1

  v6 = a3;
  v7 = (*(int (__fastcall **)(IOUSBControllerV3 *, _QWORD, void *, void *, void *, void *))(*(_QWORD *)this + 3264LL))(
         this,
         (unsigned __int16)a2,
         a3,
         a4,
         a5,
         a6);
  *(_WORD *)v6 = v7;
  v8 = v7 == 0;
  result = 3758097136LL;
  if ( !v8 )
    result = 0LL;
  return result;
}

//----- (0000000000026CE4) ----------------------------------------------------
int __fastcall IOUSBControllerV3::CreateStreams(IOUSBControllerV3 *this, unsigned int a2, unsigned int a3, unsigned int a4, unsigned int a5)
{
  unsigned int v5; // ebx@1
  __int64 v6; // r14@1
  __int64 v7; // r15@1
  __int64 v8; // rax@1

  v5 = a5;
  v6 = a4;
  v7 = a3;
  v8 = IOUSBController::GetCommandGate(this);
  return (*(int (__fastcall **)(__int64, int (__fastcall *)(IOUSBControllerV3 *, OSObject *, void *, void *, void *, void *), _QWORD, __int64, __int64, _QWORD))(*(_QWORD *)v8 + 456LL))(
           v8,
           IOUSBControllerV3::DoCreateStreams,
           a2,
           v7,
           v6,
           v5);
}

//----- (0000000000026D2C) ----------------------------------------------------
int __fastcall IOUSBControllerV3::DoCreateStreams(IOUSBControllerV3 *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  return (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 3296LL))(
           this,
           (unsigned __int8)a2,
           (unsigned __int8)a3,
           (unsigned __int8)a4,
           a5,
           a6);
}

//----- (0000000000026D48) ----------------------------------------------------
signed __int64 IOUSBControllerV3::GetRootHubPowerExitLatencies()
{
  return 3758097095LL;
}

//----- (0000000000026D54) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::AcquireDeviceZero(IOUSBControllerV3 *this)
{
  int v1; // er14@1
  __int64 v2; // rax@2
  __int64 v3; // r9@2
  char v5; // [sp+0h] [bp-10h]@0

  v1 = (*(int (__fastcall **)(IOUSBControllerV3 *, _QWORD))(*(_QWORD *)this + 2952LL))(this, "AcquireDeviceZero");
  if ( !v1 )
    JUMPOUT(__CS__, `vtable for'IOUSBController[306]);
  LODWORD(v2) = (*(int (__fastcall **)(IOUSBControllerV3 *, _QWORD))(*(_QWORD *)this + 904LL))(this, 0LL);
  KernelDebugLogInternal(
    1u,
    0x55534246u,
    (__int64)"IOUSBControllerV3(%s)::AcquireDeviceZero - CheckPowerModeBeforeGatedCall returned 0x%x",
    v2,
    (unsigned int)v1,
    v3,
    v5);
  return (unsigned int)v1;
}
// 3BC10: using guessed type __int64 `vtable for'IOUSBController[2];

//----- (0000000000026DBE) ----------------------------------------------------
int __fastcall IOUSBControllerV3::ReleaseDeviceZero(IOUSBControllerV3 *this)
{
  int result; // eax@1

  result = (*(int (__fastcall **)(IOUSBControllerV3 *, _QWORD))(*(_QWORD *)this + 2952LL))(this, "ReleaseDeviceZero");
  if ( !result )
    JUMPOUT(__CS__, `vtable for'IOUSBController[307]);
  return result;
}
// 3BC10: using guessed type __int64 `vtable for'IOUSBController[2];

//----- (0000000000026DF8) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::DeviceRequest(IOService *this, __int64 a2, __int64 a3, unsigned __int16 a4, unsigned __int8 a5, unsigned int a6)
{
  unsigned __int16 v6; // r14@1
  int v7; // eax@1
  unsigned int v8; // er15@1
  signed int v9; // eax@3
  int v10; // ebx@6
  signed int v11; // eax@7
  unsigned __int8 v13; // [sp+14h] [bp-3Ch]@1
  __int64 v14; // [sp+18h] [bp-38h]@1
  unsigned int v15; // [sp+24h] [bp-2Ch]@1

  v15 = a6;
  v13 = a5;
  v6 = a4;
  v14 = a3;
  v7 = *(_DWORD *)(a2 + 16);
  v8 = 0;
  if ( v7 & 0x40000000 )
  {
    *(_DWORD *)(a2 + 16) = v7 & 0xBFFFFFFF;
    v8 = 2147483648;
  }
  v9 = *((_DWORD *)this + 112);
  if ( v9 == -1 || v9 >= 3 )
    IOService::changePowerStateTo(this, 4uLL);
  v10 = (*(int (__fastcall **)(IOService *, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 3360LL))(
          this,
          "DeviceRequest",
          0LL,
          v8);
  if ( !v10 )
  {
    v10 = ((int (__fastcall *)(IOService *, __int64, __int64, _QWORD, _QWORD, _QWORD))`vtable for'IOUSBController[318])(
            this,
            a2,
            v14,
            v6,
            v13,
            v15);
    v11 = *((_DWORD *)this + 112);
    if ( v11 == -1 || v11 >= 3 )
      IOService::changePowerStateTo(this, *(_DWORD *)(*((_QWORD *)this + 84) + 280LL));
  }
  return (unsigned int)v10;
}
// 3BC10: using guessed type __int64 `vtable for'IOUSBController[2];

//----- (0000000000026EE0) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::DeviceRequest(IOService *this, __int64 a2, __int64 a3, unsigned __int16 a4, unsigned __int8 a5, unsigned int a6)
{
  unsigned __int16 v6; // r14@1
  int v7; // eax@1
  unsigned int v8; // er15@1
  signed int v9; // eax@3
  int v10; // ebx@6
  signed int v11; // eax@7
  unsigned __int8 v13; // [sp+14h] [bp-3Ch]@1
  __int64 v14; // [sp+18h] [bp-38h]@1
  unsigned int v15; // [sp+24h] [bp-2Ch]@1

  v15 = a6;
  v13 = a5;
  v6 = a4;
  v14 = a3;
  v7 = *(_DWORD *)(a2 + 16);
  v8 = 0;
  if ( v7 & 0x40000000 )
  {
    *(_DWORD *)(a2 + 16) = v7 & 0xBFFFFFFF;
    v8 = 2147483648;
  }
  v9 = *((_DWORD *)this + 112);
  if ( v9 == -1 || v9 >= 3 )
    IOService::changePowerStateTo(this, 4uLL);
  v10 = (*(int (__fastcall **)(IOService *, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 3360LL))(
          this,
          "DeviceRequest",
          *(_QWORD *)(a2 + 8),
          v8);
  if ( !v10 )
  {
    v10 = ((int (__fastcall *)(IOService *, __int64, __int64, _QWORD, _QWORD, _QWORD))`vtable for'IOUSBController[319])(
            this,
            a2,
            v14,
            v6,
            v13,
            v15);
    v11 = *((_DWORD *)this + 112);
    if ( v11 == -1 || v11 >= 3 )
      IOService::changePowerStateTo(this, *(_DWORD *)(*((_QWORD *)this + 84) + 280LL));
  }
  return (unsigned int)v10;
}
// 3BC10: using guessed type __int64 `vtable for'IOUSBController[2];

//----- (0000000000026FCA) ----------------------------------------------------
int __fastcall IOUSBControllerV3::ClosePipe(__int64 a1)
{
  int result; // eax@6

  if ( (unsigned __int8)IOService::isInactive((IOService *)a1)
    || *(_BYTE *)(a1 + 444)
    || *(_BYTE *)(a1 + 441)
    || *(_BYTE *)(a1 + 453)
    || *(_BYTE *)(a1 + 452)
    || (result = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)a1 + 2952LL))(a1, "ClosePipe")) == 0 )
    JUMPOUT(__CS__, `vtable for'IOUSBController[297]);
  return result;
}
// 3BC10: using guessed type __int64 `vtable for'IOUSBController[2];

//----- (000000000002704E) ----------------------------------------------------
int __fastcall IOUSBControllerV3::AbortPipe(__int64 a1, unsigned int a2, __int64 a3)
{
  return (*(int (__fastcall **)(__int64, signed __int64, _QWORD, __int64))(*(_QWORD *)a1 + 3232LL))(
           a1,
           0x80000000LL,
           a2,
           a3);
}

//----- (000000000002706E) ----------------------------------------------------
int __fastcall IOUSBControllerV3::AbortPipe(__int64 a1, unsigned int a2, unsigned __int16 a3, __int64 a4)
{
  __int64 v4; // r12@1
  unsigned __int16 v5; // r14@1
  int result; // eax@6

  v4 = a4;
  v5 = a3;
  if ( (unsigned __int8)IOService::isInactive((IOService *)a1)
    || *(_BYTE *)(a1 + 444)
    || *(_BYTE *)(a1 + 441)
    || *(_BYTE *)(a1 + 453)
    || *(_BYTE *)(a1 + 452)
    || (result = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)a1 + 2952LL))(a1, "AbortPipe")) == 0 )
    result = (*(int (__fastcall **)(_QWORD, int (__fastcall *)(IOUSBControllerV3 *, OSObject *, void *, void *, void *, void *), _QWORD, _QWORD, _QWORD, _QWORD))(**(_QWORD **)(a1 + 144) + 456LL))(
               *(_QWORD *)(a1 + 144),
               IOUSBControllerV3::DoAbortStream,
               a2,
               v5,
               *(_BYTE *)(v4 + 8),
               *(_BYTE *)(v4 + 9));
  return result;
}

//----- (0000000000027108) ----------------------------------------------------
int __fastcall IOUSBControllerV3::DoAbortStream(IOUSBControllerV3 *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  return (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 3240LL))(
           this,
           a2,
           (unsigned int)(signed __int16)a3,
           (unsigned int)(signed __int16)a4,
           (unsigned int)(signed __int16)a5,
           a6);
}

//----- (0000000000027124) ----------------------------------------------------
int __fastcall IOUSBControllerV3::ResetPipe(__int64 a1)
{
  int result; // eax@6

  if ( (unsigned __int8)IOService::isInactive((IOService *)a1)
    || *(_BYTE *)(a1 + 444)
    || *(_BYTE *)(a1 + 441)
    || *(_BYTE *)(a1 + 453)
    || *(_BYTE *)(a1 + 452)
    || (result = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)a1 + 2952LL))(a1, "ResetPipe")) == 0 )
    JUMPOUT(__CS__, `vtable for'IOUSBController[299]);
  return result;
}
// 3BC10: using guessed type __int64 `vtable for'IOUSBController[2];

//----- (00000000000271A8) ----------------------------------------------------
int __fastcall IOUSBControllerV3::ClearPipeStall(__int64 a1)
{
  int result; // eax@1

  result = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)a1 + 2952LL))(a1, "ClearPipeStall");
  if ( !result )
    JUMPOUT(__CS__, `vtable for'IOUSBController[300]);
  return result;
}
// 3BC10: using guessed type __int64 `vtable for'IOUSBController[2];

//----- (00000000000271FC) ----------------------------------------------------
int __fastcall IOUSBControllerV3::Read(__int64 a1, __int64 a2, unsigned int a3, __int64 a4, __int64 a5)
{
  return (*(int (__fastcall **)(__int64, _QWORD, __int64, _QWORD, __int64, __int64))(*(_QWORD *)a1 + 3216LL))(
           a1,
           0LL,
           a2,
           a3,
           a4,
           a5);
}

//----- (000000000002723C) ----------------------------------------------------
int __fastcall IOUSBControllerV3::Read(__int64 a1, int a2, __int64 a3)
{
  int result; // eax@1

  result = (*(int (__fastcall **)(__int64, _QWORD, __int64, _QWORD))(*(_QWORD *)a1 + 3360LL))(
             a1,
             "Read",
             a3,
             2 * (a2 & 0x40000000u));
  if ( !result )
    JUMPOUT(__CS__, `vtable for'IOUSBControllerV2[361]);
  return result;
}
// 419D0: using guessed type __int64 `vtable for'IOUSBControllerV2[2];

//----- (00000000000272D0) ----------------------------------------------------
int __fastcall IOUSBControllerV3::Write(__int64 a1, __int64 a2, unsigned int a3, __int64 a4, __int64 a5)
{
  return (*(int (__fastcall **)(__int64, _QWORD, __int64, _QWORD, __int64, __int64))(*(_QWORD *)a1 + 3224LL))(
           a1,
           0LL,
           a2,
           a3,
           a4,
           a5);
}

//----- (0000000000027310) ----------------------------------------------------
int __fastcall IOUSBControllerV3::Write(__int64 a1, int a2, __int64 a3)
{
  int result; // eax@1

  result = (*(int (__fastcall **)(__int64, _QWORD, __int64, _QWORD))(*(_QWORD *)a1 + 3360LL))(
             a1,
             "Write",
             a3,
             2 * (a2 & 0x40000000u));
  if ( !result )
    JUMPOUT(__CS__, `vtable for'IOUSBControllerV2[362]);
  return result;
}
// 419D0: using guessed type __int64 `vtable for'IOUSBControllerV2[2];

//----- (00000000000273A4) ----------------------------------------------------
int __usercall IOUSBControllerV3::IsocIO@<eax>(__int64 a1@<rdi>, __int64 a2@<rsi>, __int64 a3)
{
  char v3; // dl@1
  signed __int64 v4; // rcx@1
  int result; // eax@3

  v3 = *(_BYTE *)(a3 + 10);
  v4 = 0LL;
  if ( v3 < 0 )
  {
    *(_BYTE *)(a3 + 10) = v3 & 0x7F;
    v4 = 0x80000000LL;
  }
  result = (*(int (__fastcall **)(__int64, _QWORD, __int64, signed __int64))(*(_QWORD *)a1 + 3360LL))(
             a1,
             "IsocIO",
             a2,
             v4);
  if ( !result )
    JUMPOUT(__CS__, `vtable for'IOUSBController[303]);
  return result;
}
// 3BC10: using guessed type __int64 `vtable for'IOUSBController[2];

//----- (0000000000027436) ----------------------------------------------------
int __usercall IOUSBControllerV3::IsocIO@<eax>(__int64 a1@<rdi>, __int64 a2@<rsi>, __int64 a3)
{
  char v3; // dl@1
  signed __int64 v4; // rcx@1
  int result; // eax@3

  v3 = *(_BYTE *)(a3 + 10);
  v4 = 0LL;
  if ( v3 < 0 )
  {
    *(_BYTE *)(a3 + 10) = v3 & 0x7F;
    v4 = 0x80000000LL;
  }
  result = (*(int (__fastcall **)(__int64, _QWORD, __int64, signed __int64))(*(_QWORD *)a1 + 3360LL))(
             a1,
             "IsocIO (LL)",
             a2,
             v4);
  if ( !result )
    JUMPOUT(__CS__, `vtable for'IOUSBController[327]);
  return result;
}
// 3BC10: using guessed type __int64 `vtable for'IOUSBController[2];

//----- (00000000000274C8) ----------------------------------------------------
int __fastcall IOUSBControllerV3::OpenPipe(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  return (*(int (__fastcall **)(__int64, __int64, __int64, __int64, _QWORD, _QWORD))(*(_QWORD *)a1 + 3248LL))(
           a1,
           a2,
           a3,
           a4,
           0LL,
           0LL);
}

//----- (00000000000274E0) ----------------------------------------------------
int __fastcall IOUSBControllerV3::OpenPipe(__int64 a1, __int64 a2, __int64 a3, __int64 a4, int a5, int a6)
{
  int v6; // er14@1
  int result; // eax@1
  int v8; // [sp+0h] [bp-2Ch]@1

  v6 = a6;
  v8 = a5;
  result = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)a1 + 2952LL))(a1, "OpenPipe");
  if ( !result )
  {
    if ( v8 | v6 )
      JUMPOUT(__CS__, `vtable for'IOUSBControllerV2[363]);
    JUMPOUT(__CS__, `vtable for'IOUSBControllerV2[296]);
  }
  return result;
}
// 419D0: using guessed type __int64 `vtable for'IOUSBControllerV2[2];

//----- (0000000000027582) ----------------------------------------------------
int __fastcall IOUSBControllerV3::AddHSHub(IOUSBControllerV3 *this)
{
  int result; // eax@1

  result = (*(int (__fastcall **)(IOUSBControllerV3 *, _QWORD))(*(_QWORD *)this + 2952LL))(this, "AddHSHub");
  if ( !result )
    JUMPOUT(__CS__, `vtable for'IOUSBControllerV2[338]);
  return result;
}
// 419D0: using guessed type __int64 `vtable for'IOUSBControllerV2[2];

//----- (00000000000275D6) ----------------------------------------------------
int __fastcall IOUSBControllerV3::RemoveHSHub(IOUSBControllerV3 *this)
{
  int result; // eax@5

  if ( (unsigned __int8)IOService::isInactive(this)
    || *((_BYTE *)this + 444)
    || *((_BYTE *)this + 441)
    || __PAIR__(*((_BYTE *)this + 453), *((_BYTE *)this + 452))
    || (result = (*(int (__fastcall **)(IOUSBControllerV3 *, _QWORD))(*(_QWORD *)this + 2952LL))(this, "RemoveHSHub")) == 0 )
    JUMPOUT(__CS__, `vtable for'IOUSBControllerV2[340]);
  return result;
}
// 419D0: using guessed type __int64 `vtable for'IOUSBControllerV2[2];

//----- (0000000000027644) ----------------------------------------------------
int __fastcall IOUSBControllerV3::SetTestMode(IOUSBControllerV3 *this)
{
  int result; // eax@1

  IOService::changePowerStateTo(this, 4uLL);
  result = (*(int (__fastcall **)(IOUSBControllerV3 *, _QWORD))(*(_QWORD *)this + 2952LL))(this, "SetTestMode");
  if ( !result )
    JUMPOUT(__CS__, `vtable for'IOUSBControllerV2[341]);
  return result;
}
// 419D0: using guessed type __int64 `vtable for'IOUSBControllerV2[2];

//----- (00000000000276A4) ----------------------------------------------------
int __fastcall IOUSBControllerV3::ReadV2(__int64 a1)
{
  int result; // eax@1

  result = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)a1 + 2952LL))(a1, "ReadV2");
  if ( !result )
    JUMPOUT(__CS__, `vtable for'IOUSBControllerV2[345]);
  return result;
}
// 419D0: using guessed type __int64 `vtable for'IOUSBControllerV2[2];

//----- (0000000000027716) ----------------------------------------------------
char __fastcall IOUSBControllerV3::GetInternalHubErrataBits(IOUSBControllerV3 *this, IORegistryEntry *a2, int a3, unsigned int a4, unsigned int *a5)
{
  unsigned int v5; // er12@1
  int v6; // er15@1
  __int64 v7; // rax@4
  int v8; // eax@5
  IORegistryEntry *v9; // rax@8
  IORegistryEntry *v10; // rbx@8
  IORegistryEntry *v11; // rsi@9
  char v12; // r14@9
  unsigned int *v14; // [sp+0h] [bp-30h]@1

  v14 = a5;
  v5 = a4;
  v6 = a3;
  if ( !(*(_BYTE *)(*((_QWORD *)this + 84) + 212LL) & 1)
    && !(unsigned int)IOUSBController::calculateUSBDepth(this, a4)
    && *(_BYTE *)(*((_QWORD *)this + 21) + 40LL) == 3 )
  {
    v7 = *((_QWORD *)this + 84);
    if ( v5 & 0x1000000 )
      v8 = *(_BYTE *)(v7 + 35);
    else
      v8 = *(_BYTE *)(v7 + 34);
    v6 = v6 + v8 - 1;
  }
  v9 = IOUSBController::CopyACPIDevice(this, a2);
  v10 = v9;
  if ( v9 )
  {
    v11 = v9;
    v12 = IOUSBController::CheckACPIUPCTableForInternalHubErrataBits(this, v9, v6, v5, v14);
    (*(void (__fastcall **)(IORegistryEntry *, IORegistryEntry *))(*(_QWORD *)v10 + 40LL))(v10, v11);
  }
  else
  {
    v12 = 0;
  }
  return v12;
}

//----- (00000000000277CE) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::GetConnectorType(IOUSBControllerV3 *this, IORegistryEntry *a2, unsigned int a3, unsigned int a4, unsigned __int8 *a5)
{
  unsigned __int8 *v5; // r14@1
  unsigned int v6; // ebx@1
  int v7; // er12@1
  __int64 v8; // rax@1
  int v9; // esi@2
  __int64 v10; // rax@7
  int v11; // eax@8
  IORegistryEntry *v12; // rax@10
  IORegistryEntry *v13; // rbx@10
  IORegistryEntry *v14; // rsi@11
  unsigned int v15; // er14@11
  unsigned int v17; // [sp+0h] [bp-2Ch]@8

  v5 = a5;
  v6 = a4;
  v7 = a3;
  v8 = *((_QWORD *)this + 84);
  if ( *(_BYTE *)(v8 + 344) )
  {
    v9 = *(_DWORD *)(v8 + 336);
    if ( _bittest((const unsigned int *)&v9, a3) )
    {
      *a5 = -1;
    }
    else if ( (1 << a3) & *(_DWORD *)(v8 + 340) )
    {
      *a5 = 3;
    }
    else
    {
      *a5 = -2;
    }
  }
  else
  {
    if ( *(_BYTE *)(v8 + 212) & 1
      || (unsigned int)IOUSBController::calculateUSBDepth(this, a4)
      || *(_BYTE *)(*((_QWORD *)this + 21) + 40LL) != 3 )
    {
      v17 = v6;
    }
    else
    {
      v10 = *((_QWORD *)this + 84);
      if ( v6 & 0x1000000 )
      {
        v17 = v6;
        v11 = *(_BYTE *)(v10 + 35);
      }
      else
      {
        v17 = v6;
        v11 = *(_BYTE *)(v10 + 34);
      }
      v7 = v7 + v11 - 1;
    }
    v12 = IOUSBController::CopyACPIDevice(this, a2);
    v13 = v12;
    if ( v12 )
    {
      v14 = v12;
      v15 = IOUSBController::CheckACPIUPCTable(this, v12, v7, v17, v5);
      (*(void (__fastcall **)(IORegistryEntry *, IORegistryEntry *))(*(_QWORD *)v13 + 40LL))(v13, v14);
      return v15;
    }
  }
  return 0LL;
}

//----- (00000000000278C8) ----------------------------------------------------
void __fastcall IOUSBControllerV3::FixupNECControllerConfigRegisters(uintptr_t arg1)
{
  unsigned __int16 v1; // bx@1
  unsigned int v2; // er15@3

  v1 = IOPCIDevice::extendedConfigRead16(*(IOPCIDevice **)(arg1 + 488), 0x42uLL);
  if ( v1 == 0xFFFF )
  {
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D002Cu, arg1, 0xFFFFuLL, 0LL, 0x1DuLL, 0LL);
  }
  else if ( (v1 & 0x8000u) == 0 )
  {
    v2 = IOPCIDevice::extendedConfigRead32(*(IOPCIDevice **)(arg1 + 488), 0xE0uLL);
    IOPCIDevice::extendedConfigWrite32(*(IOPCIDevice **)(arg1 + 488), 0xE0uLL, v2 | 0x80);
    IOPCIDevice::extendedConfigWrite16(*(IOPCIDevice **)(arg1 + 488), 0x42uLL, v1 | 0x8000);
    IOPCIDevice::extendedConfigWrite32(*(IOPCIDevice **)(arg1 + 488), 0xE0uLL, v2);
  }
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (00000000000279B0) ----------------------------------------------------
char __fastcall IOUSBControllerV3::CanControllerMuxOverToEHCI(IOUSBControllerV3 *this, IORegistryEntry *a2)
{
  return (unsigned __int8)(*(_BYTE *)(*((_QWORD *)this + 84) + 212LL) & 8) >> 3;
}

//----- (00000000000279C8) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::UIMGetActualDeviceAddress(IOUSBControllerV3 *this)
{
  return 0LL;
}

//----- (00000000000279D0) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::UIMCreateSSBulkEndpoint(IOUSBControllerV3 *this)
{
  return 3758097095LL;
}

//----- (00000000000279DC) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::UIMCreateSSInterruptEndpoint(IOUSBControllerV3 *this)
{
  return 3758097095LL;
}

//----- (00000000000279E8) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::UIMCreateSSIsochEndpoint(IOUSBControllerV3 *this)
{
  return 3758097095LL;
}

//----- (00000000000279F4) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::UIMCreateStreams(IOUSBControllerV3 *this)
{
  return 3758097095LL;
}

//----- (0000000000027A00) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::GetBandwidthAvailableForDevice(IOUSBControllerV3 *this, IOUSBDevice *a2, unsigned int *a3)
{
  *a3 = (*(int (__fastcall **)(IOUSBControllerV3 *, IOUSBDevice *))(*(_QWORD *)this + 2448LL))(this, a2);
  return 0LL;
}

//----- (0000000000027A1E) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::GetMinimumIdlePowerState(uintptr_t arg1)
{
  uintptr_t v1; // rbx@1
  uintptr_t v2; // rdx@2
  uintptr_t v3; // rcx@2
  uintptr_t v4; // r15@4
  __int64 v5; // rax@7
  signed int v6; // er14@7
  __int64 v7; // rdi@11
  int v8; // eax@12
  uintptr_t v9; // rdx@15
  uintptr_t v10; // r8@15
  int v11; // eax@19
  __int64 v12; // rax@19
  unsigned int v14; // [sp+Ch] [bp-24h]@12

  v1 = arg1;
  if ( gUSBStackDebugFlags & 2 )
  {
    v2 = *(_QWORD *)(arg1 + 672);
    v3 = 3LL;
    if ( v2 )
      v3 = *(_DWORD *)(v2 + 280) | ((unsigned int)*(_BYTE *)(v2 + 297) << 8);
    v4 = arg1 + 672;
    if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D002Cu, arg1, v2, v3, 0xEuLL, 0LL);
  }
  else
  {
    v4 = arg1 + 672;
  }
  v5 = *(_QWORD *)v4;
  v6 = 3;
  if ( !*(_QWORD *)v4 )
    return (unsigned int)v6;
  if ( *(_BYTE *)(v5 + 297) )
  {
LABEL_29:
    v6 = *(_DWORD *)(v5 + 280);
    return (unsigned int)v6;
  }
  *(_DWORD *)(v5 + 280) = 3;
  if ( !(gUSBStackDebugFlags & 0x40) && *(_WORD *)(v5 + 264) )
  {
    v7 = *(_QWORD *)(v5 + 272);
    if ( v7 )
    {
      v14 = 0;
      v8 = (*(int (__fastcall **)(__int64, _QWORD, int *, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v7 + 2256LL))(
             v7,
             "_GPE",
             &v14,
             0LL,
             0LL,
             0LL);
      if ( v8 )
      {
        if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        {
          v9 = v8;
          v10 = 16LL;
LABEL_24:
          kernel_debug(0x52D002Cu, v1, v9, 0LL, v10, 0LL);
          goto LABEL_25;
        }
      }
      else
      {
        v11 = (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD, signed __int64))(**(_QWORD **)(*(_QWORD *)v4 + 272LL)
                                                                            + 2296LL))(
                *(_QWORD *)(*(_QWORD *)v4 + 272LL),
                v14,
                0LL,
                3LL);
        LODWORD(v12) = IOInterruptEventSource::interruptEventSource(
                         v1,
                         IOUSBControllerV3::PMEHandler,
                         *(_QWORD *)(*(_QWORD *)v4 + 272LL),
                         (unsigned int)v11);
        *(_QWORD *)(*(_QWORD *)v4 + 288LL) = v12;
        if ( v12 )
        {
          (*(void (__fastcall **)(_QWORD, __int64))(**(_QWORD **)(v1 + 136) + 320LL))(*(_QWORD *)(v1 + 136), v12);
          (*(void (**)(void))(**(_QWORD **)(*(_QWORD *)v4 + 288LL) + 336LL))();
          *(_DWORD *)(*(_QWORD *)v4 + 280LL) = 2;
        }
        else if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        {
          v9 = 0LL;
          v10 = 17LL;
          goto LABEL_24;
        }
      }
    }
    else if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      v9 = 0LL;
      v10 = 15LL;
      goto LABEL_24;
    }
  }
LABEL_25:
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D002Cu, v1, *(_BYTE *)(*(_QWORD *)v4 + 297LL), 0LL, 0x12uLL, 0LL);
  v5 = *(_QWORD *)v4;
  *(_BYTE *)(v5 + 297) = 1;
  if ( v5 )
    goto LABEL_29;
  return (unsigned int)v6;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 7D890: using guessed type int __fastcall IOInterruptEventSource::interruptEventSource(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000027C78) ----------------------------------------------------
void __usercall IOUSBControllerV3::PMEHandler(uintptr_t arg1@<rdi>, char a2@<al>, __int64 a3@<rsi>)
{
  __int64 v3; // r14@1
  __int64 v4; // rax@2
  unsigned __int64 v5; // rsi@3
  unsigned __int16 v6; // ax@4
  uintptr_t v7; // rdx@17
  uintptr_t v8; // r8@17
  __int64 v9; // rax@19
  __int64 v10; // r8@19
  __int64 v11; // r9@19
  char v12; // [sp-8h] [bp-20h]@1

  v12 = a2;
  v3 = a3;
  if ( (unsigned __int8)IOService::isInactive((IOService *)arg1) )
    return;
  v4 = *(_QWORD *)(arg1 + 672);
  if ( !v4 )
    return;
  v5 = *(_WORD *)(v4 + 264);
  if ( !*(_WORD *)(v4 + 264) )
    return;
  v6 = IOPCIDevice::extendedConfigRead16(*(IOPCIDevice **)(arg1 + 488), v5);
  if ( v6 == 0xFFFF )
  {
    if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
      return;
    v7 = 0xFFFFLL;
    v8 = 30LL;
    goto LABEL_18;
  }
  if ( (unsigned __int16)(v6 & 0x8100) == 33024 )
  {
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      v5 = arg1;
      kernel_debug(0x52D002Cu, arg1, *(_QWORD *)(arg1 + 456), v6, 0xCuLL, 0LL);
    }
    if ( *(_QWORD *)(*(_QWORD *)(arg1 + 672) + 288LL) == v3 )
    {
      if ( *(_QWORD *)(arg1 + 456) <= 2uLL )
      {
        (*(void (__fastcall **)(__int64, unsigned __int64))(*(_QWORD *)v3 + 344LL))(v3, v5);
        *(_BYTE *)(*(_QWORD *)(arg1 + 672) + 296LL) = 1;
        if ( gUSBStackDebugFlags & 2 )
        {
          if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          {
            v5 = arg1;
            kernel_debug(0x52D002Cu, arg1, 0LL, 0LL, 0xDuLL, 0LL);
          }
        }
        (*(void (__fastcall **)(uintptr_t, unsigned __int64))(*(_QWORD *)arg1 + 2976LL))(arg1, v5);
        return;
      }
      LODWORD(v9) = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)arg1 + 904LL))(arg1, 0LL);
      KernelDebugLogInternal(
        1u,
        0x55534246u,
        (__int64)"%s::PMEHandler - unexpected PME while not in power state Sleep (interrupt storm?)",
        v9,
        v10,
        v11,
        v12);
      if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
        return;
      v7 = *(_QWORD *)(arg1 + 456);
      v8 = 22LL;
LABEL_18:
      kernel_debug(0x52D002Cu, arg1, v7, 0LL, v8, 0LL);
      return;
    }
  }
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (0000000000027E46) ----------------------------------------------------
char __fastcall IOUSBControllerV3::DoNotPowerOffPortsOnStop(IOUSBControllerV3 *this)
{
  return (unsigned __int8)(*(_BYTE *)(*((_QWORD *)this + 84) + 213LL) & 4) >> 2;
}

//----- (0000000000027E5E) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::_RESERVEDIOUSBControllerV325(IOUSBControllerV3 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBControllerV3::gMetaClass, 25);
}
// 49900: using guessed type _QWORD IOUSBControllerV3::gMetaClass;

//----- (0000000000027E74) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::_RESERVEDIOUSBControllerV326(IOUSBControllerV3 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBControllerV3::gMetaClass, 26);
}
// 49900: using guessed type _QWORD IOUSBControllerV3::gMetaClass;

//----- (0000000000027E8A) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::_RESERVEDIOUSBControllerV327(IOUSBControllerV3 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBControllerV3::gMetaClass, 27);
}
// 49900: using guessed type _QWORD IOUSBControllerV3::gMetaClass;

//----- (0000000000027EA0) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::_RESERVEDIOUSBControllerV328(IOUSBControllerV3 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBControllerV3::gMetaClass, 28);
}
// 49900: using guessed type _QWORD IOUSBControllerV3::gMetaClass;

//----- (0000000000027EB6) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::_RESERVEDIOUSBControllerV329(IOUSBControllerV3 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBControllerV3::gMetaClass, 29);
}
// 49900: using guessed type _QWORD IOUSBControllerV3::gMetaClass;

//----- (0000000000027ECC) ----------------------------------------------------
__int64 __fastcall IOUSBControllerV3::MetaClass::~MetaClass(IOUSBControllerV3::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000027EE0) ----------------------------------------------------
__int64 `global constructor keyed to'_a_14()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(&IOUSBControllerV3::gMetaClass, "IOUSBControllerV3", &IOUSBControllerV2::gMetaClass, 680LL);
  result = (__int64)off_450E0;
  IOUSBControllerV3::gMetaClass = off_450E0;
  return result;
}
// 450E0: using guessed type __int64 (__fastcall *off_450E0[2])(IOUSBControllerV3::MetaClass *__hidden this);
// 49808: using guessed type _QWORD IOUSBControllerV2::gMetaClass;
// 49900: using guessed type _QWORD IOUSBControllerV3::gMetaClass;
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000027F20) ----------------------------------------------------
__int64 `global destructor keyed to'_a_14()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&IOUSBControllerV3::gMetaClass);
}
// 49900: using guessed type _QWORD IOUSBControllerV3::gMetaClass;

//----- (0000000000027F40) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::MetaClass::MetaClass(IOUSBInterfaceUserClientV2::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBInterfaceUserClientV2", off_3B030[0], 296LL);
  result = (__int64)off_45D60;
  *(_QWORD *)this = off_45D60;
  return result;
}
// 3B030: using guessed type _QWORD *off_3B030[5];
// 45D60: using guessed type __int64 (__fastcall *off_45D60[2])(IOUSBInterfaceUserClientV2::MetaClass *__hidden this);
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000027F72) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::MetaClass::~MetaClass(IOUSBInterfaceUserClientV2::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000027F7C) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::IOUSBInterfaceUserClientV2(__int64 a1)
{
  __int64 result; // rax@1

  IOUserClient::IOUserClient(a1);
  result = (__int64)off_451E0;
  *(_QWORD *)a1 = off_451E0;
  return result;
}
// 451E0: using guessed type __int64 (__fastcall *off_451E0[2])(IOUSBInterfaceUserClientV2 *__hidden this);
// 7D578: using guessed type int __cdecl IOUserClient::IOUserClient(_QWORD);

//----- (0000000000027F9C) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::IOUSBInterfaceUserClientV2(__int64 a1)
{
  __int64 result; // rax@1

  IOUserClient::IOUserClient(a1);
  result = (__int64)off_451E0;
  *(_QWORD *)a1 = off_451E0;
  return result;
}
// 451E0: using guessed type __int64 (__fastcall *off_451E0[2])(IOUSBInterfaceUserClientV2 *__hidden this);
// 7D578: using guessed type int __cdecl IOUserClient::IOUserClient(_QWORD);

//----- (0000000000027FBC) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::~IOUSBInterfaceUserClientV2(IOUSBInterfaceUserClientV2 *this)
{
  return IOUserClient::~IOUserClient(this);
}

//----- (0000000000027FC6) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::~IOUSBInterfaceUserClientV2(IOUSBInterfaceUserClientV2 *this)
{
  return IOUserClient::~IOUserClient(this);
}

//----- (0000000000027FD0) ----------------------------------------------------
void __fastcall IOUSBInterfaceUserClientV2::~IOUSBInterfaceUserClientV2(IOUSBInterfaceUserClientV2 *this)
{
  IOUserClient::~IOUserClient(this);
  OSObject::operator delete((void *)this);
}

//----- (0000000000027FF2) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::getMetaClass(IOUSBInterfaceUserClientV2 *this)
{
  return (__int64)&IOUSBInterfaceUserClientV2::gMetaClass;
}
// 49928: using guessed type _QWORD IOUSBInterfaceUserClientV2::gMetaClass;

//----- (0000000000028000) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::MetaClass::MetaClass(IOUSBInterfaceUserClientV2::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBInterfaceUserClientV2", off_3B030[0], 296LL);
  result = (__int64)off_45D60;
  *(_QWORD *)this = off_45D60;
  return result;
}
// 3B030: using guessed type _QWORD *off_3B030[5];
// 45D60: using guessed type __int64 (__fastcall *off_45D60[2])(IOUSBInterfaceUserClientV2::MetaClass *__hidden this);
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000028032) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::MetaClass::alloc(IOUSBInterfaceUserClientV2::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&stru_108.addr, a2);
  IOUserClient::IOUserClient(v2);
  *(_QWORD *)v2 = off_451E0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBInterfaceUserClientV2::gMetaClass);
  return v2;
}
// 108: using guessed type section_64 stru_108;
// 451E0: using guessed type __int64 (__fastcall *off_451E0[2])(IOUSBInterfaceUserClientV2 *__hidden this);
// 49928: using guessed type _QWORD IOUSBInterfaceUserClientV2::gMetaClass;
// 7D578: using guessed type int __cdecl IOUserClient::IOUserClient(_QWORD);

//----- (0000000000028072) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::IOUSBInterfaceUserClientV2(__int64 a1)
{
  IOUserClient::IOUserClient(a1);
  *(_QWORD *)a1 = off_451E0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBInterfaceUserClientV2::gMetaClass);
}
// 451E0: using guessed type __int64 (__fastcall *off_451E0[2])(IOUSBInterfaceUserClientV2 *__hidden this);
// 49928: using guessed type _QWORD IOUSBInterfaceUserClientV2::gMetaClass;
// 7D578: using guessed type int __cdecl IOUserClient::IOUserClient(_QWORD);

//----- (00000000000280A2) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::IOUSBInterfaceUserClientV2(__int64 a1)
{
  IOUserClient::IOUserClient(a1);
  *(_QWORD *)a1 = off_451E0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBInterfaceUserClientV2::gMetaClass);
}
// 451E0: using guessed type __int64 (__fastcall *off_451E0[2])(IOUSBInterfaceUserClientV2 *__hidden this);
// 49928: using guessed type _QWORD IOUSBInterfaceUserClientV2::gMetaClass;
// 7D578: using guessed type int __cdecl IOUserClient::IOUserClient(_QWORD);

//----- (00000000000280D2) ----------------------------------------------------
__int64 __fastcall IOUSBLowLatencyCommand::MetaClass::MetaClass(IOUSBLowLatencyCommand::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBLowLatencyCommand", off_3B090[0], 136LL);
  result = (__int64)off_46040;
  *(_QWORD *)this = off_46040;
  return result;
}
// 3B090: using guessed type _QWORD off_3B090[16];
// 46040: using guessed type __int64 (__fastcall *off_46040[2])(IOUSBLowLatencyCommand::MetaClass *__hidden this);
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000028104) ----------------------------------------------------
__int64 __fastcall IOUSBLowLatencyCommand::MetaClass::~MetaClass(IOUSBLowLatencyCommand::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000002810E) ----------------------------------------------------
__int64 __fastcall IOUSBLowLatencyCommand::IOUSBLowLatencyCommand(IOCommand *a1, const OSMetaClass *a2)
{
  __int64 result; // rax@1

  IOCommand::IOCommand(a1, a2);
  result = (__int64)off_45E60;
  *(_QWORD *)a1 = off_45E60;
  return result;
}
// 45E60: using guessed type __int64 (__fastcall *off_45E60[2])(IOUSBLowLatencyCommand *__hidden this);

//----- (000000000002812E) ----------------------------------------------------
__int64 __fastcall IOUSBLowLatencyCommand::IOUSBLowLatencyCommand(IOCommand *a1, const OSMetaClass *a2)
{
  __int64 result; // rax@1

  IOCommand::IOCommand(a1, a2);
  result = (__int64)off_45E60;
  *(_QWORD *)a1 = off_45E60;
  return result;
}
// 45E60: using guessed type __int64 (__fastcall *off_45E60[2])(IOUSBLowLatencyCommand *__hidden this);

//----- (000000000002814E) ----------------------------------------------------
__int64 __fastcall IOUSBLowLatencyCommand::~IOUSBLowLatencyCommand(IOUSBLowLatencyCommand *this)
{
  return IOCommand::~IOCommand(this);
}

//----- (0000000000028158) ----------------------------------------------------
__int64 __fastcall IOUSBLowLatencyCommand::~IOUSBLowLatencyCommand(IOUSBLowLatencyCommand *this)
{
  return IOCommand::~IOCommand(this);
}

//----- (0000000000028162) ----------------------------------------------------
void __fastcall IOUSBLowLatencyCommand::~IOUSBLowLatencyCommand(IOUSBLowLatencyCommand *this)
{
  IOCommand::~IOCommand(this);
  OSObject::operator delete((void *)this);
}

//----- (0000000000028184) ----------------------------------------------------
__int64 __fastcall IOUSBLowLatencyCommand::getMetaClass(IOUSBLowLatencyCommand *this)
{
  return (__int64)&IOUSBLowLatencyCommand::gMetaClass;
}
// 49950: using guessed type _QWORD IOUSBLowLatencyCommand::gMetaClass;

//----- (0000000000028192) ----------------------------------------------------
__int64 __fastcall IOUSBLowLatencyCommand::MetaClass::MetaClass(IOUSBLowLatencyCommand::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBLowLatencyCommand", off_3B090[0], 136LL);
  result = (__int64)off_46040;
  *(_QWORD *)this = off_46040;
  return result;
}
// 3B090: using guessed type _QWORD off_3B090[16];
// 46040: using guessed type __int64 (__fastcall *off_46040[2])(IOUSBLowLatencyCommand::MetaClass *__hidden this);
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000281C4) ----------------------------------------------------
IOCommand *__fastcall IOUSBLowLatencyCommand::MetaClass::alloc(IOUSBLowLatencyCommand::MetaClass *this, unsigned __int64 a2)
{
  IOCommand *v2; // rbx@1

  v2 = (IOCommand *)OSObject::operator new((OSObject *)&stru_68.addr, a2);
  IOCommand::IOCommand(v2, (const OSMetaClass *)&IOUSBLowLatencyCommand::gMetaClass);
  *(_QWORD *)v2 = off_45E60;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBLowLatencyCommand::gMetaClass);
  return v2;
}
// 68: using guessed type section_64 stru_68;
// 45E60: using guessed type __int64 (__fastcall *off_45E60[2])(IOUSBLowLatencyCommand *__hidden this);
// 49950: using guessed type _QWORD IOUSBLowLatencyCommand::gMetaClass;

//----- (0000000000028204) ----------------------------------------------------
__int64 __fastcall IOUSBLowLatencyCommand::IOUSBLowLatencyCommand(IOCommand *a1)
{
  IOCommand::IOCommand(a1, (const OSMetaClass *)&IOUSBLowLatencyCommand::gMetaClass);
  *(_QWORD *)a1 = off_45E60;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBLowLatencyCommand::gMetaClass);
}
// 45E60: using guessed type __int64 (__fastcall *off_45E60[2])(IOUSBLowLatencyCommand *__hidden this);
// 49950: using guessed type _QWORD IOUSBLowLatencyCommand::gMetaClass;

//----- (0000000000028234) ----------------------------------------------------
__int64 __fastcall IOUSBLowLatencyCommand::IOUSBLowLatencyCommand(IOCommand *a1)
{
  IOCommand::IOCommand(a1, (const OSMetaClass *)&IOUSBLowLatencyCommand::gMetaClass);
  *(_QWORD *)a1 = off_45E60;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBLowLatencyCommand::gMetaClass);
}
// 45E60: using guessed type __int64 (__fastcall *off_45E60[2])(IOUSBLowLatencyCommand *__hidden this);
// 49950: using guessed type _QWORD IOUSBLowLatencyCommand::gMetaClass;

//----- (0000000000028264) ----------------------------------------------------
signed __int64 __fastcall IOUSBInterfaceUserClientV2::_open(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rax@1
  int v5; // er14@4
  signed __int64 result; // rax@4

  v3 = a3;
  v4 = *(_QWORD *)(a1 + 288);
  if ( v4 && *(_BYTE *)(v4 + 183) && !*(_BYTE *)(v4 + 182) )
  {
    result = 3758097122LL;
  }
  else
  {
    (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
    v5 = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)a1 + 2400LL))(a1, **(_QWORD **)(v3 + 32) != 0LL);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
    result = (unsigned int)v5;
  }
  return result;
}

//----- (00000000000282CE) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::_close(IOService *this)
{
  __int64 v1; // rax@1
  int v2; // er12@3
  __int64 v3; // r14@4
  __int64 v4; // r15@4
  __int64 v5; // r12@5
  __int64 v6; // r13@6

  v1 = *((_QWORD *)this + 36);
  if ( !v1 || !*(_BYTE *)(v1 + 183) || (v2 = -536870174, *(_BYTE *)(v1 + 182)) )
  {
    (*(void (__cdecl **)(IOService *))(*(_QWORD *)this + 32LL))(this);
    v3 = 0LL;
    v4 = 0LL;
    if ( !(unsigned __int8)IOService::isInactive(this) )
    {
      v5 = *((_QWORD *)this + 30);
      v3 = 0LL;
      v4 = 0LL;
      if ( v5 )
      {
        v6 = *((_QWORD *)this + 31);
        v3 = 0LL;
        v4 = 0LL;
        if ( v6 )
        {
          (*(void (__fastcall **)(_QWORD))(*(_QWORD *)v6 + 32LL))(*((_QWORD *)this + 31));
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v5 + 32LL))(v5);
          v3 = v5;
          v4 = v6;
        }
      }
    }
    if ( !(unsigned __int8)IOService::isInactive(this) && *((_QWORD *)this + 30) && *((_QWORD *)this + 31) )
    {
      v2 = (*(int (__fastcall **)(__int64, int (__fastcall *)(IOUSBInterfaceUserClientV2 *, OSObject *, void *, void *, void *, void *), _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v3 + 456LL))(
             v3,
             IOUSBInterfaceUserClientV2::closeGated,
             0LL,
             0LL,
             0LL,
             0LL);
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 40LL))(v3);
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v4 + 40LL))(v4);
    }
    else
    {
      v2 = (*(int (__fastcall **)(IOService *))(*(_QWORD *)this + 2408LL))(this);
    }
    (*(void (__fastcall **)(IOService *))(*(_QWORD *)this + 40LL))(this);
  }
  return (unsigned int)v2;
}

//----- (00000000000283E8) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::_GetDevice(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1

  v3 = a3;
  (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
  LODWORD(v3) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)a1 + 2416LL))(a1, *(_QWORD *)(v3 + 72));
  (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
  return (unsigned int)v3;
}

//----- (0000000000028420) ----------------------------------------------------
signed __int64 __fastcall IOUSBInterfaceUserClientV2::_SetAlternateInterface(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rax@1
  int v5; // er14@4
  signed __int64 result; // rax@4

  v3 = a3;
  v4 = *(_QWORD *)(a1 + 288);
  if ( v4 && *(_BYTE *)(v4 + 183) && !*(_BYTE *)(v4 + 182) )
  {
    result = 3758097122LL;
  }
  else
  {
    (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
    v5 = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)a1 + 2424LL))(a1, **(_BYTE **)(v3 + 32));
    (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
    result = (unsigned int)v5;
  }
  return result;
}

//----- (0000000000028482) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::_GetFrameNumber(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1

  v3 = a3;
  (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
  LODWORD(v3) = (*(int (__fastcall **)(__int64, _QWORD, signed __int64))(*(_QWORD *)a1 + 2432LL))(
                  a1,
                  *(_QWORD *)(v3 + 88),
                  v3 + 96);
  (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
  return (unsigned int)v3;
}

//----- (00000000000284C0) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::_GetPipeProperties(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1

  v3 = a3;
  (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
  LODWORD(v3) = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, signed __int64, signed __int64, signed __int64))(*(_QWORD *)a1 + 2496LL))(
                  a1,
                  **(_BYTE **)(v3 + 32),
                  *(_QWORD *)(v3 + 72),
                  *(_QWORD *)(v3 + 72) + 8LL,
                  *(_QWORD *)(v3 + 72) + 16LL,
                  *(_QWORD *)(v3 + 72) + 24LL);
  (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
  return (unsigned int)v3;
}

//----- (000000000002851A) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::_ReadPipe(uintptr_t arg1, __int64 a2, __int64 a3)
{
  __int64 v3; // rbx@1
  __int64 v4; // r14@1
  __int64 v5; // rdi@1
  int v6; // er15@3
  uintptr_t v7; // rcx@6
  int v8; // eax@13
  uintptr_t v9; // rdx@15
  uintptr_t v10; // rcx@15
  uintptr_t v11; // r8@15
  uintptr_t v12; // rsi@15
  __int64 v13; // rax@17
  __int64 v14; // r12@17
  __int64 v15; // rsi@18
  int v16; // eax@18
  int v17; // eax@19
  __int64 v18; // r8@23
  uintptr_t v19; // r12@24
  int v20; // eax@26
  __int64 v22; // [sp+10h] [bp-40h]@18
  __int64 (__fastcall *v23)(IOUSBInterfaceUserClientV2 *, void *, void *, unsigned int); // [sp+18h] [bp-38h]@18
  __int64 v24; // [sp+20h] [bp-30h]@18

  v3 = a3;
  v4 = arg1;
  v5 = *(_QWORD *)(arg1 + 288);
  if ( !v5 || !*(_BYTE *)(v5 + 183) || (v6 = -536870174, *(_BYTE *)(v5 + 182)) )
  {
    if ( gUSBStackDebugFlags & 2 )
    {
      if ( *(_QWORD *)(a3 + 8) )
        v7 = *(_QWORD *)(*(_QWORD *)(a3 + 32) + 32LL);
      else
        v7 = *(_QWORD *)(a3 + 104) ? *(_QWORD *)(a3 + 112) : (unsigned __int64)*(_DWORD *)(a3 + 96);
      if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        kernel_debug(0x52D242Cu, v4, *(_DWORD *)(v5 + 176), v7, 1uLL, 0LL);
        v5 = *(_QWORD *)(v4 + 288);
      }
    }
    if ( OSIncrementAtomic(v5 + 176) < 2048 )
    {
      if ( *(_QWORD *)(v3 + 8) )
      {
        LODWORD(v13) = IOMalloc(104LL);
        v14 = v13;
        v6 = -536870211;
        if ( v13 )
        {
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v4 + 32LL))(v4);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v4 + 2728LL))(v4);
          bcopy(*(const void **)(v3 + 16), (void *)v14, 0x40uLL);
          *(_DWORD *)(v14 + 64) = *(_DWORD *)(v3 + 24);
          *(_BYTE *)(v14 + 80) = 30;
          v22 = v4;
          v23 = IOUSBInterfaceUserClientV2::ReqComplete;
          v24 = v14;
          v15 = *(_QWORD *)(v3 + 32);
          v16 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v4 + 2504LL))(
                  v4,
                  *(_BYTE *)v15,
                  *(_DWORD *)(v15 + 8),
                  *(_DWORD *)(v15 + 16),
                  *(_QWORD *)(v15 + 24),
                  *(_QWORD *)(v15 + 32));
          v6 = 0;
          if ( v16 )
          {
            v6 = v16;
            v17 = OSDecrementAtomic(*(_QWORD *)(v4 + 288) + 176LL);
            if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
              kernel_debug(0x52D242Cu, v4, v17 - 1, v6, 5uLL, 0LL);
            IOFree(v14, 104LL);
            (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v4 + 2720LL))(v4, 104LL);
            (*(void (__fastcall **)(__int64))(*(_QWORD *)v4 + 40LL))(v4);
          }
        }
      }
      else
      {
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v4 + 32LL))(v4);
        v18 = *(_QWORD *)(v3 + 104);
        if ( v18 )
        {
          v19 = *(_QWORD *)(v3 + 112);
          v6 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, __int64, signed __int64))(*(_QWORD *)v4 + 2520LL))(
                 v4,
                 **(_BYTE **)(v3 + 32),
                 *(_DWORD *)(*(_QWORD *)(v3 + 32) + 8LL),
                 *(_DWORD *)(*(_QWORD *)(v3 + 32) + 16LL),
                 v18,
                 v3 + 112);
        }
        else
        {
          v6 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, _QWORD, signed __int64))(*(_QWORD *)v4 + 2512LL))(
                 v4,
                 **(_BYTE **)(v3 + 32),
                 *(_DWORD *)(*(_QWORD *)(v3 + 32) + 8LL),
                 *(_DWORD *)(*(_QWORD *)(v3 + 32) + 16LL),
                 *(_QWORD *)(v3 + 88),
                 v3 + 96);
          v19 = 0LL;
        }
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v4 + 40LL))(v4);
        v20 = OSDecrementAtomic(*(_QWORD *)(v4 + 288) + 176LL);
        if ( gUSBStackDebugFlags & 2 )
        {
          if ( !*(_QWORD *)(v3 + 104) )
            v19 = *(_DWORD *)(v3 + 96);
          if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          {
            v9 = v20 - 1;
            v11 = 6LL;
            v12 = v4;
            v10 = v19;
            goto LABEL_31;
          }
        }
      }
    }
    else
    {
      v8 = OSDecrementAtomic(*(_QWORD *)(v4 + 288) + 176LL);
      v6 = -536854462;
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        v9 = v8;
        v10 = 2048LL;
        v11 = 2LL;
        v12 = v4;
LABEL_31:
        kernel_debug(0x52D242Cu, v12, v9, v10, v11, 0LL);
        return (unsigned int)v6;
      }
    }
  }
  return (unsigned int)v6;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 7D218: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// 7D250: using guessed type int __fastcall IOMalloc(_QWORD);
// 7D290: using guessed type int __fastcall OSDecrementAtomic(_QWORD);
// 7D298: using guessed type int __fastcall OSIncrementAtomic(_QWORD);

//----- (0000000000028804) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::_WritePipe(uintptr_t arg1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rbx@1
  __int64 v5; // rax@1
  signed int v6; // er15@3
  uintptr_t v7; // r15@5
  uintptr_t v8; // rcx@6
  __int64 v9; // rdi@7
  uintptr_t v10; // rax@8
  int v11; // eax@13
  uintptr_t v12; // rdx@15
  uintptr_t v13; // rcx@15
  uintptr_t v14; // r8@15
  uintptr_t v15; // rsi@15
  __int64 v16; // rax@17
  __int64 v17; // r12@17
  __int64 v18; // rsi@18
  int v19; // eax@18
  int v20; // eax@19
  int v21; // eax@24
  int v22; // eax@26
  uintptr_t v23; // r12@27
  __int64 v24; // rdi@27
  uintptr_t v25; // rax@28
  __int64 v27; // [sp+10h] [bp-40h]@18
  __int64 (__fastcall *v28)(IOUSBInterfaceUserClientV2 *, void *, void *, unsigned int); // [sp+18h] [bp-38h]@18
  __int64 v29; // [sp+20h] [bp-30h]@18

  v3 = a3;
  v4 = arg1;
  v5 = *(_QWORD *)(arg1 + 288);
  if ( !v5 || !*(_BYTE *)(v5 + 183) || (v6 = -536870174, *(_BYTE *)(v5 + 182)) )
  {
    if ( gUSBStackDebugFlags & 2 )
    {
      v7 = *(_DWORD *)(v5 + 176);
      if ( *(_QWORD *)(a3 + 8) )
      {
        v8 = *(_QWORD *)(*(_QWORD *)(a3 + 32) + 32LL);
      }
      else
      {
        v9 = *(_QWORD *)(a3 + 64);
        if ( v9 )
        {
          LODWORD(v10) = (*(int (**)(void))(*(_QWORD *)v9 + 456LL))();
          v8 = v10;
        }
        else
        {
          v8 = *(_DWORD *)(a3 + 56);
        }
      }
      if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D242Cu, v4, v7, v8, 3uLL, 0LL);
    }
    if ( OSIncrementAtomic(*(_QWORD *)(v4 + 288) + 176LL) < 2048 )
    {
      if ( *(_QWORD *)(v3 + 8) )
      {
        LODWORD(v16) = IOMalloc(104LL);
        v17 = v16;
        v6 = -536870211;
        if ( v16 )
        {
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v4 + 32LL))(v4);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v4 + 2728LL))(v4);
          bcopy(*(const void **)(v3 + 16), (void *)v17, 0x40uLL);
          *(_DWORD *)(v17 + 64) = *(_DWORD *)(v3 + 24);
          *(_BYTE *)(v17 + 80) = 30;
          v27 = v4;
          v28 = IOUSBInterfaceUserClientV2::ReqComplete;
          v29 = v17;
          v18 = *(_QWORD *)(v3 + 32);
          v19 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v4 + 2528LL))(
                  v4,
                  *(_BYTE *)v18,
                  *(_DWORD *)(v18 + 8),
                  *(_DWORD *)(v18 + 16),
                  *(_QWORD *)(v18 + 24),
                  *(_QWORD *)(v18 + 32));
          v6 = 0;
          if ( v19 )
          {
            v6 = v19;
            v20 = OSDecrementAtomic(*(_QWORD *)(v4 + 288) + 176LL);
            if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
              kernel_debug(0x52D242Cu, v4, v20 - 1, v6, 7uLL, 0LL);
            IOFree(v17, 104LL);
            (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v4 + 2720LL))(v4, 104LL);
            (*(void (__fastcall **)(__int64))(*(_QWORD *)v4 + 40LL))(v4);
          }
        }
      }
      else
      {
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v4 + 32LL))(v4);
        if ( *(_QWORD *)(v3 + 64) )
          v21 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v4 + 2544LL))(
                  v4,
                  **(_BYTE **)(v3 + 32),
                  *(_DWORD *)(*(_QWORD *)(v3 + 32) + 8LL),
                  *(_DWORD *)(*(_QWORD *)(v3 + 32) + 16LL));
        else
          v21 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v4 + 2536LL))(
                  v4,
                  **(_BYTE **)(v3 + 32),
                  *(_DWORD *)(*(_QWORD *)(v3 + 32) + 8LL),
                  *(_DWORD *)(*(_QWORD *)(v3 + 32) + 16LL),
                  *(_QWORD *)(v3 + 48),
                  *(_DWORD *)(v3 + 56));
        v6 = v21;
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v4 + 40LL))(v4);
        v22 = OSDecrementAtomic(*(_QWORD *)(v4 + 288) + 176LL);
        if ( gUSBStackDebugFlags & 2 )
        {
          v23 = v22 - 1;
          v24 = *(_QWORD *)(v3 + 64);
          if ( v24 )
            LODWORD(v25) = (*(int (**)(void))(*(_QWORD *)v24 + 456LL))();
          else
            v25 = *(_DWORD *)(v3 + 56);
          if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          {
            v14 = 8LL;
            v15 = v4;
            v12 = v23;
            v13 = v25;
            goto LABEL_32;
          }
        }
      }
    }
    else
    {
      v11 = OSDecrementAtomic(*(_QWORD *)(v4 + 288) + 176LL);
      v6 = -536854462;
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        v12 = v11;
        v13 = 2048LL;
        v14 = 4LL;
        v15 = v4;
LABEL_32:
        kernel_debug(0x52D242Cu, v15, v12, v13, v14, 0LL);
        return (unsigned int)v6;
      }
    }
  }
  return (unsigned int)v6;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 7D218: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// 7D250: using guessed type int __fastcall IOMalloc(_QWORD);
// 7D290: using guessed type int __fastcall OSDecrementAtomic(_QWORD);
// 7D298: using guessed type int __fastcall OSIncrementAtomic(_QWORD);

//----- (0000000000028AFE) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::_GetPipeStatus(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1

  v3 = a3;
  (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
  LODWORD(v3) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)a1 + 2552LL))(a1, **(_BYTE **)(v3 + 32));
  (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
  return (unsigned int)v3;
}

//----- (0000000000028B38) ----------------------------------------------------
signed __int64 __fastcall IOUSBInterfaceUserClientV2::_AbortPipe(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rax@1
  int v5; // er14@4
  signed __int64 result; // rax@4

  v3 = a3;
  v4 = *(_QWORD *)(a1 + 288);
  if ( v4 && *(_BYTE *)(v4 + 183) && !*(_BYTE *)(v4 + 182) )
  {
    result = 3758097122LL;
  }
  else
  {
    (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
    v5 = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)a1 + 2560LL))(a1, **(_BYTE **)(v3 + 32));
    (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
    result = (unsigned int)v5;
  }
  return result;
}

//----- (0000000000028B9A) ----------------------------------------------------
signed __int64 __fastcall IOUSBInterfaceUserClientV2::_ResetPipe(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rax@1
  int v5; // er14@4
  signed __int64 result; // rax@4

  v3 = a3;
  v4 = *(_QWORD *)(a1 + 288);
  if ( v4 && *(_BYTE *)(v4 + 183) && !*(_BYTE *)(v4 + 182) )
  {
    result = 3758097122LL;
  }
  else
  {
    (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
    v5 = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)a1 + 2568LL))(a1, **(_BYTE **)(v3 + 32));
    (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
    result = (unsigned int)v5;
  }
  return result;
}

//----- (0000000000028BFC) ----------------------------------------------------
signed __int64 __fastcall IOUSBInterfaceUserClientV2::_ClearPipeStall(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rax@1
  int v5; // er14@4
  signed __int64 result; // rax@4

  v3 = a3;
  v4 = *(_QWORD *)(a1 + 288);
  if ( v4 && *(_BYTE *)(v4 + 183) && !*(_BYTE *)(v4 + 182) )
  {
    result = 3758097122LL;
  }
  else
  {
    (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
    v5 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD))(*(_QWORD *)a1 + 2576LL))(
           a1,
           **(_BYTE **)(v3 + 32),
           *(_QWORD *)(*(_QWORD *)(v3 + 32) + 8LL) != 0LL);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
    result = (unsigned int)v5;
  }
  return result;
}

//----- (0000000000028C6A) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::_ControlRequestOut(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r12@1
  __int64 v4; // rax@1
  signed int v5; // ebx@3
  unsigned int v6; // ecx@4
  __int64 v7; // rdx@5
  __int64 v8; // rsi@5
  __int64 v9; // rax@10
  __int64 v10; // r15@10
  __int64 v11; // rsi@11
  int v12; // ST18_4@11
  int v13; // ST10_4@11
  __int64 v14; // ST08_8@11
  __int64 v15; // ST00_8@11
  int v16; // er12@11
  __int64 v17; // rsi@14
  int v18; // ST08_4@14
  int v19; // ST00_4@14
  int v20; // eax@14
  __int64 v21; // rsi@15
  __int64 v22; // rbx@15
  __int64 v23; // ST10_8@15
  int v24; // ST08_4@15
  int v25; // ST00_4@15
  __int64 v27; // [sp+28h] [bp-38h]@11
  __int64 (__fastcall *v28)(IOUSBInterfaceUserClientV2 *, void *, void *, unsigned int); // [sp+30h] [bp-30h]@11
  __int64 v29; // [sp+38h] [bp-28h]@11

  v3 = a3;
  v4 = *(_QWORD *)(a1 + 288);
  if ( !v4 || !*(_BYTE *)(v4 + 183) || (v5 = -536870174, *(_BYTE *)(v4 + 182)) )
  {
    v6 = *(_DWORD *)(v4 + 168);
    if ( v6 )
    {
      v7 = *(_QWORD *)(*(_QWORD *)(a3 + 32) + 8LL) | (*(_QWORD *)(*(_QWORD *)(a3 + 32) + 32LL) << 32) | (*(_QWORD *)(*(_QWORD *)(a3 + 32) + 24LL) << 16) | (*(_QWORD *)(*(_QWORD *)(a3 + 32) + 16LL) << 8);
      v8 = 0LL;
      while ( 1 )
      {
        if ( *(_QWORD *)(v4 + 8 * v8 + 8) == v7 )
        {
          v5 = -536870174;
          if ( !*(_BYTE *)v4 )
            break;
        }
        ++v8;
        if ( (unsigned int)v8 >= v6 )
          goto LABEL_9;
      }
    }
    else
    {
LABEL_9:
      if ( *(_QWORD *)(v3 + 8) )
      {
        LODWORD(v9) = IOMalloc(104LL);
        v10 = v9;
        v5 = -536870211;
        if ( v9 )
        {
          (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 32LL))(a1);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 2728LL))(a1);
          bcopy(*(const void **)(v3 + 16), (void *)v10, 0x40uLL);
          *(_DWORD *)(v10 + 64) = *(_DWORD *)(v3 + 24);
          v27 = a1;
          v28 = IOUSBInterfaceUserClientV2::ReqComplete;
          v29 = v10;
          v11 = *(_QWORD *)(v3 + 32);
          v12 = *(_DWORD *)(v11 + 64);
          v13 = *(_DWORD *)(v11 + 56);
          v14 = *(_QWORD *)(v11 + 48);
          v15 = *(_QWORD *)(v11 + 40);
          v16 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 2616LL))(
                  a1,
                  *(_BYTE *)v11,
                  *(_BYTE *)(v11 + 8),
                  *(_BYTE *)(v11 + 16),
                  *(_WORD *)(v11 + 24),
                  *(_WORD *)(v11 + 32));
          v5 = 0;
          if ( v16 )
          {
            IOFree(v10, 104LL);
            (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)a1 + 2720LL))(a1, 104LL);
            (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
            v5 = v16;
          }
        }
      }
      else
      {
        (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 32LL))(a1);
        if ( *(_QWORD *)(v3 + 64) )
        {
          v17 = *(_QWORD *)(v3 + 32);
          v18 = *(_DWORD *)(v17 + 64);
          v19 = *(_DWORD *)(v17 + 56);
          v20 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 2632LL))(
                  a1,
                  *(_BYTE *)v17,
                  *(_BYTE *)(v17 + 8),
                  *(_BYTE *)(v17 + 16),
                  *(_WORD *)(v17 + 24),
                  *(_WORD *)(v17 + 32));
        }
        else
        {
          v21 = *(_QWORD *)(v3 + 32);
          v22 = *(_DWORD *)(v3 + 56);
          v23 = *(_QWORD *)(v3 + 48);
          v24 = *(_DWORD *)(v21 + 64);
          v25 = *(_DWORD *)(v21 + 56);
          v20 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 2624LL))(
                  a1,
                  *(_BYTE *)v21,
                  *(_BYTE *)(v21 + 8),
                  *(_BYTE *)(v21 + 16),
                  *(_WORD *)(v21 + 24),
                  *(_WORD *)(v21 + 32));
        }
        v5 = v20;
        (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
      }
    }
  }
  return (unsigned int)v5;
}
// 7D218: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// 7D250: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (0000000000028E98) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::_ControlRequestIn(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rax@1
  signed int v5; // ebx@3
  __int64 v6; // rax@5
  __int64 v7; // r15@5
  __int64 v8; // rsi@6
  int v9; // ST18_4@6
  int v10; // ST10_4@6
  __int64 v11; // ST08_8@6
  __int64 v12; // ST00_8@6
  int v13; // er14@6
  __int64 v14; // rsi@9
  int v15; // ST08_4@9
  int v16; // ST00_4@9
  int v17; // eax@9
  __int64 v18; // rsi@10
  __int64 v19; // ST10_8@10
  int v20; // ST08_4@10
  int v21; // ST00_4@10
  __int64 v22; // rax@12
  __int64 v24; // [sp+28h] [bp-38h]@6
  __int64 (__fastcall *v25)(IOUSBInterfaceUserClientV2 *, void *, void *, unsigned int); // [sp+30h] [bp-30h]@6
  __int64 v26; // [sp+38h] [bp-28h]@6

  v3 = a3;
  v4 = *(_QWORD *)(a1 + 288);
  if ( !v4 || !*(_BYTE *)(v4 + 183) || (v5 = -536870174, *(_BYTE *)(v4 + 182)) )
  {
    if ( *(_QWORD *)(a3 + 8) )
    {
      LODWORD(v6) = IOMalloc(104LL);
      v7 = v6;
      v5 = -536870211;
      if ( v6 )
      {
        (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 32LL))(a1);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 2728LL))(a1);
        bcopy(*(const void **)(v3 + 16), (void *)v7, 0x40uLL);
        *(_DWORD *)(v7 + 64) = *(_DWORD *)(v3 + 24);
        v24 = a1;
        v25 = IOUSBInterfaceUserClientV2::ReqComplete;
        v26 = v7;
        v8 = *(_QWORD *)(v3 + 32);
        v9 = *(_DWORD *)(v8 + 64);
        v10 = *(_DWORD *)(v8 + 56);
        v11 = *(_QWORD *)(v8 + 48);
        v12 = *(_QWORD *)(v8 + 40);
        v13 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 2592LL))(
                a1,
                *(_BYTE *)v8,
                *(_BYTE *)(v8 + 8),
                *(_BYTE *)(v8 + 16),
                *(_WORD *)(v8 + 24),
                *(_WORD *)(v8 + 32));
        v5 = 0;
        if ( v13 )
        {
          IOFree(v7, 104LL);
          (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)a1 + 2720LL))(a1, 104LL);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
          v5 = v13;
        }
      }
    }
    else
    {
      (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
      if ( *(_QWORD *)(v3 + 104) )
      {
        v14 = *(_QWORD *)(v3 + 32);
        v15 = *(_DWORD *)(v14 + 64);
        v16 = *(_DWORD *)(v14 + 56);
        v17 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 2608LL))(
                a1,
                *(_BYTE *)v14,
                *(_BYTE *)(v14 + 8),
                *(_BYTE *)(v14 + 16),
                *(_WORD *)(v14 + 24),
                *(_WORD *)(v14 + 32));
      }
      else
      {
        v18 = *(_QWORD *)(v3 + 32);
        v19 = *(_QWORD *)(v3 + 88);
        v20 = *(_DWORD *)(v18 + 64);
        v21 = *(_DWORD *)(v18 + 56);
        v17 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 2600LL))(
                a1,
                *(_BYTE *)v18,
                *(_BYTE *)(v18 + 8),
                *(_BYTE *)(v18 + 16),
                *(_WORD *)(v18 + 24),
                *(_WORD *)(v18 + 32));
      }
      v5 = v17;
      if ( *(_DWORD *)(v3 + 80) )
      {
        v22 = *(_QWORD *)(v3 + 72);
        if ( v5 == -536870168 )
        {
          *(_QWORD *)v22 = 1LL;
          v5 = 0;
        }
        else
        {
          *(_QWORD *)v22 = 0LL;
        }
      }
      (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
    }
  }
  return (unsigned int)v5;
}
// 7D218: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// 7D250: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (00000000000290A8) ----------------------------------------------------
signed __int64 __fastcall IOUSBInterfaceUserClientV2::_SetPipePolicy(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rax@1
  int v5; // er14@4
  signed __int64 result; // rax@4

  v3 = a3;
  v4 = *(_QWORD *)(a1 + 288);
  if ( v4 && *(_BYTE *)(v4 + 183) && !*(_BYTE *)(v4 + 182) )
  {
    result = 3758097122LL;
  }
  else
  {
    (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
    v5 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 2584LL))(
           a1,
           **(_BYTE **)(v3 + 32),
           *(_WORD *)(*(_QWORD *)(v3 + 32) + 8LL),
           *(_BYTE *)(*(_QWORD *)(v3 + 32) + 16LL));
    (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
    result = (unsigned int)v5;
  }
  return result;
}

//----- (0000000000029112) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::_GetBandwidthAvailable(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1

  v3 = a3;
  (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
  LODWORD(v3) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)a1 + 2456LL))(a1, *(_QWORD *)(v3 + 72));
  (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
  return (unsigned int)v3;
}

//----- (000000000002914A) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::_GetEndpointProperties(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1

  v3 = a3;
  (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
  LODWORD(v3) = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, _QWORD, signed __int64))(*(_QWORD *)a1 + 2472LL))(
                  a1,
                  **(_BYTE **)(v3 + 32),
                  *(_BYTE *)(*(_QWORD *)(v3 + 32) + 8LL),
                  *(_BYTE *)(*(_QWORD *)(v3 + 32) + 16LL),
                  *(_QWORD *)(v3 + 72),
                  *(_QWORD *)(v3 + 72) + 8LL);
  (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
  return (unsigned int)v3;
}

//----- (00000000000291A4) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::_LowLatencyPrepareBuffer(IOService *this, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rax@1
  int v5; // er12@3
  __int64 v6; // rax@4
  __int64 v7; // r15@5
  __int64 v8; // rbx@6
  __int64 v10; // [sp+8h] [bp-58h]@4
  __int64 v11; // [sp+10h] [bp-50h]@4
  __int64 v12; // [sp+18h] [bp-48h]@4
  __int64 v13; // [sp+20h] [bp-40h]@4
  __int64 v14; // [sp+28h] [bp-38h]@4
  __int64 v15; // [sp+38h] [bp-28h]@4

  v3 = a3;
  v4 = *((_QWORD *)this + 36);
  if ( !v4 || !*(_BYTE *)(v4 + 183) || (v5 = -536870174, *(_BYTE *)(v4 + 182)) )
  {
    v6 = *(_QWORD *)(a3 + 32);
    v10 = *(_QWORD *)v6;
    v11 = *(_QWORD *)(v6 + 8);
    v12 = *(_QWORD *)(v6 + 16);
    v13 = *(_QWORD *)(v6 + 24);
    v14 = *(_QWORD *)(v6 + 32);
    v15 = *(_QWORD *)(v6 + 48);
    v5 = -536870210;
    if ( !(unsigned __int8)IOService::isInactive(this) )
    {
      v7 = *((_QWORD *)this + 30);
      if ( v7 )
      {
        v8 = *((_QWORD *)this + 31);
        if ( v8 )
        {
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v8 + 32LL))(v8);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v7 + 32LL))(v7);
          v5 = (*(int (__fastcall **)(__int64, int (__fastcall *)(IOUSBInterfaceUserClientV2 *, OSObject *, void *, void *, void *, void *), __int64 *, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v7 + 456LL))(
                 v7,
                 IOUSBInterfaceUserClientV2::LowLatencyPrepareBufferGated,
                 &v10,
                 *(_QWORD *)(v3 + 72),
                 0LL,
                 0LL);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v7 + 40LL))(v7);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v8 + 40LL))(v8);
        }
      }
    }
  }
  return (unsigned int)v5;
}

//----- (0000000000029296) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::_LowLatencyReleaseBuffer(IOService *this, __int64 a2, __int64 a3)
{
  __int64 v3; // rax@1
  int v4; // er14@3
  __int64 v5; // rax@4
  __int64 v6; // r15@5
  __int64 v7; // rbx@6
  __int64 v9; // [sp+0h] [bp-50h]@4
  __int64 v10; // [sp+8h] [bp-48h]@4
  __int64 v11; // [sp+10h] [bp-40h]@4
  __int64 v12; // [sp+18h] [bp-38h]@4
  __int64 v13; // [sp+30h] [bp-20h]@4

  v3 = *((_QWORD *)this + 36);
  if ( !v3 || !*(_BYTE *)(v3 + 183) || (v4 = -536870174, *(_BYTE *)(v3 + 182)) )
  {
    v5 = *(_QWORD *)(a3 + 32);
    v9 = *(_QWORD *)v5;
    v10 = *(_QWORD *)(v5 + 8);
    v11 = *(_QWORD *)(v5 + 16);
    v12 = *(_QWORD *)(v5 + 24);
    v13 = *(_QWORD *)(v5 + 48);
    v4 = -536870210;
    if ( !(unsigned __int8)IOService::isInactive(this) )
    {
      v6 = *((_QWORD *)this + 30);
      if ( v6 )
      {
        v7 = *((_QWORD *)this + 31);
        if ( v7 )
        {
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v7 + 32LL))(v7);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v6 + 32LL))(v6);
          v4 = (*(int (__fastcall **)(__int64, int (__fastcall *)(IOUSBInterfaceUserClientV2 *, OSObject *, void *, void *, void *, void *), __int64 *, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v6 + 456LL))(
                 v6,
                 IOUSBInterfaceUserClientV2::LowLatencyReleaseBufferGated,
                 &v9,
                 0LL,
                 0LL,
                 0LL);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v6 + 40LL))(v6);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v7 + 40LL))(v7);
        }
      }
    }
  }
  return (unsigned int)v4;
}

//----- (0000000000029378) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::_GetMicroFrameNumber(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1

  v3 = a3;
  (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
  LODWORD(v3) = (*(int (__fastcall **)(__int64, _QWORD, signed __int64))(*(_QWORD *)a1 + 2440LL))(
                  a1,
                  *(_QWORD *)(v3 + 88),
                  v3 + 96);
  (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
  return (unsigned int)v3;
}

//----- (00000000000293B6) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::_GetFrameListTime(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1

  v3 = a3;
  (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
  LODWORD(v3) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)a1 + 2464LL))(a1, *(_QWORD *)(v3 + 72));
  (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
  return (unsigned int)v3;
}

//----- (00000000000293EE) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::_GetFrameNumberWithTime(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1

  v3 = a3;
  (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
  LODWORD(v3) = (*(int (__fastcall **)(__int64, _QWORD, signed __int64))(*(_QWORD *)a1 + 2448LL))(
                  a1,
                  *(_QWORD *)(v3 + 88),
                  v3 + 96);
  (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
  return (unsigned int)v3;
}

//----- (000000000002942C) ----------------------------------------------------
int __fastcall IOUSBInterfaceUserClientV2::_SetAsyncPort(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rax@1
  int result; // eax@4

  v3 = *(_QWORD *)(a1 + 288);
  if ( v3 && *(_BYTE *)(v3 + 183) && !*(_BYTE *)(v3 + 182) )
    result = -536870174;
  else
    result = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)a1 + 2640LL))(a1, *(_QWORD *)(a3 + 8));
  return result;
}

//----- (0000000000029466) ----------------------------------------------------
signed __int64 __fastcall IOUSBInterfaceUserClientV2::_ReadIsochPipe(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rcx@1
  signed __int64 result; // rax@3
  int v6; // er15@5
  __int64 v7; // rax@6
  __int64 v8; // [sp+8h] [bp-48h]@6
  __int64 v9; // [sp+10h] [bp-40h]@6
  __int64 v10; // [sp+18h] [bp-38h]@6
  __int64 v11; // [sp+20h] [bp-30h]@6
  __int64 v12; // [sp+28h] [bp-28h]@6
  __int64 v13; // [sp+30h] [bp-20h]@6

  v3 = a3;
  v4 = *(_QWORD *)(a1 + 288);
  if ( !v4 || !*(_BYTE *)(v4 + 183) || (result = 3758097122LL, *(_BYTE *)(v4 + 182)) )
  {
    result = 3758097095LL;
    if ( *(_QWORD *)(a3 + 8) )
    {
      (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
      (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 2728LL))(a1);
      v6 = -536870206;
      if ( *(_QWORD *)(v3 + 64)
        || (v7 = *(_QWORD *)(v3 + 32),
            v8 = *(_QWORD *)v7,
            v9 = *(_QWORD *)(v7 + 8),
            v10 = *(_QWORD *)(v7 + 16),
            v11 = *(_QWORD *)(v7 + 24),
            v12 = *(_QWORD *)(v7 + 32),
            v13 = *(_QWORD *)(v7 + 40),
            v6 = (*(int (__fastcall **)(__int64, __int64 *, _QWORD, _QWORD, signed __int64))(*(_QWORD *)a1 + 2800LL))(
                   a1,
                   &v8,
                   *(_QWORD *)(v3 + 16),
                   *(_DWORD *)(v3 + 24),
                   1LL),
            result = 0LL,
            v6) )
      {
        (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 2720LL))(a1);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
        result = (unsigned int)v6;
      }
    }
  }
  return result;
}

//----- (0000000000029550) ----------------------------------------------------
signed __int64 __fastcall IOUSBInterfaceUserClientV2::_WriteIsochPipe(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rcx@1
  signed __int64 result; // rax@3
  int v6; // er15@5
  __int64 v7; // rax@6
  __int64 v8; // [sp+8h] [bp-48h]@6
  __int64 v9; // [sp+10h] [bp-40h]@6
  __int64 v10; // [sp+18h] [bp-38h]@6
  __int64 v11; // [sp+20h] [bp-30h]@6
  __int64 v12; // [sp+28h] [bp-28h]@6
  __int64 v13; // [sp+30h] [bp-20h]@6

  v3 = a3;
  v4 = *(_QWORD *)(a1 + 288);
  if ( !v4 || !*(_BYTE *)(v4 + 183) || (result = 3758097122LL, *(_BYTE *)(v4 + 182)) )
  {
    result = 3758097095LL;
    if ( *(_QWORD *)(a3 + 8) )
    {
      (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
      (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 2728LL))(a1);
      v6 = -536870201;
      if ( *(_QWORD *)(v3 + 64)
        || (v7 = *(_QWORD *)(v3 + 32),
            v8 = *(_QWORD *)v7,
            v9 = *(_QWORD *)(v7 + 8),
            v10 = *(_QWORD *)(v7 + 16),
            v11 = *(_QWORD *)(v7 + 24),
            v12 = *(_QWORD *)(v7 + 32),
            v13 = *(_QWORD *)(v7 + 40),
            v6 = (*(int (__fastcall **)(__int64, __int64 *, _QWORD, _QWORD, signed __int64))(*(_QWORD *)a1 + 2800LL))(
                   a1,
                   &v8,
                   *(_QWORD *)(v3 + 16),
                   *(_DWORD *)(v3 + 24),
                   2LL),
            result = 0LL,
            v6) )
      {
        (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 2720LL))(a1);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
        result = (unsigned int)v6;
      }
    }
  }
  return result;
}

//----- (000000000002963A) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::_LowLatencyReadIsochPipe(IOService *this, __int64 a2, __int64 a3)
{
  __int64 v3; // r15@1
  __int64 v4; // rax@1
  signed int v5; // ebx@3
  __int64 v6; // rax@5
  __int64 v7; // r14@5
  __int64 v8; // rax@6
  __int64 v9; // rsi@7
  int v10; // er12@7
  __int64 v11; // rax@8
  __int64 v12; // rdx@8
  __int64 v13; // r8@8
  __int64 v14; // r9@8
  __int64 v15; // r15@9
  __int64 v16; // rcx@10
  __int64 v17; // ST00_8@11
  __int64 v19; // [sp+8h] [bp-88h]@8
  __int64 v20; // [sp+10h] [bp-80h]@8
  __int64 v21; // [sp+18h] [bp-78h]@8
  __int64 v22; // [sp+20h] [bp-70h]@8
  __int64 v23; // [sp+28h] [bp-68h]@8
  __int64 v24; // [sp+30h] [bp-60h]@8
  __int64 v25; // [sp+38h] [bp-58h]@8
  __int64 v26; // [sp+40h] [bp-50h]@8
  __int64 v27; // [sp+48h] [bp-48h]@8
  IOService *v28; // [sp+50h] [bp-40h]@7
  __int64 (__fastcall *v29)(OSMetaClassBase *, __int64, const OSMetaClass *); // [sp+58h] [bp-38h]@7
  __int64 v30; // [sp+60h] [bp-30h]@7

  v3 = a3;
  v4 = *((_QWORD *)this + 36);
  if ( !v4 || !*(_BYTE *)(v4 + 183) || (v5 = -536870174, *(_BYTE *)(v4 + 182)) )
  {
    v5 = -536870201;
    if ( *(_QWORD *)(a3 + 8) )
    {
      LODWORD(v6) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 33) + 296LL))(
                      *((_QWORD *)this + 33),
                      0LL);
      v7 = v6;
      if ( v6
        || ((*(void (__fastcall **)(IOService *))(*(_QWORD *)this + 2744LL))(this),
            LODWORD(v8) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 33) + 296LL))(
                            *((_QWORD *)this + 33),
                            0LL),
            v7 = v8,
            v5 = -536870210,
            v8) )
      {
        (*(void (__fastcall **)(IOService *))(*(_QWORD *)this + 32LL))(this);
        (*(void (__fastcall **)(IOService *))(*(_QWORD *)this + 2728LL))(this);
        (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v7 + 280LL))(v7, *(_QWORD *)(v3 + 16));
        v9 = *(_DWORD *)(v3 + 24);
        (*(void (__fastcall **)(__int64, __int64))(*(_QWORD *)v7 + 288LL))(v7, v9);
        v28 = this;
        v29 = IOUSBInterfaceUserClientV2::LowLatencyIsoReqComplete;
        v30 = v7;
        v10 = -536870201;
        if ( *(_QWORD *)(v3 + 64) )
          goto LABEL_13;
        v11 = *(_QWORD *)(v3 + 32);
        v19 = *(_QWORD *)v11;
        v20 = *(_QWORD *)(v11 + 8);
        v21 = *(_QWORD *)(v11 + 16);
        v22 = *(_QWORD *)(v11 + 24);
        v23 = *(_QWORD *)(v11 + 32);
        v24 = *(_QWORD *)(v11 + 40);
        v25 = *(_QWORD *)(v11 + 48);
        v26 = *(_QWORD *)(v11 + 56);
        v27 = *(_QWORD *)(v11 + 64);
        v10 = -536870210;
        if ( (unsigned __int8)IOService::isInactive(this) )
          goto LABEL_13;
        v15 = *((_QWORD *)this + 30);
        v10 = -536870210;
        if ( !v15
          || (v16 = *((_QWORD *)this + 31)) == 0
          || ((*(void (__cdecl **)(_QWORD, __int64, __int64, __int64, __int64, __int64, _QWORD, __int64, __int64, __int64, __int64, __int64, __int64))(*(_QWORD *)v16 + 32LL))(
                *((_QWORD *)this + 31),
                v9,
                v12,
                v16,
                v13,
                v14,
                *((_QWORD *)this + 31),
                v19,
                v20,
                v21,
                v22,
                v23,
                v24),
              (*(void (__fastcall **)(__int64))(*(_QWORD *)v15 + 32LL))(v15),
              v5 = 0,
              v10 = (*(int (__fastcall **)(__int64, int (__fastcall *)(IOUSBInterfaceUserClientV2 *, OSObject *, void *, void *, void *, void *), __int64 *, __int64 *, signed __int64, _QWORD))(*(_QWORD *)v15 + 456LL))(
                      v15,
                      IOUSBInterfaceUserClientV2::DoLowLatencyIsochPipeAsyncGated,
                      &v19,
                      &v28,
                      1LL,
                      0LL),
              (*(void (__fastcall **)(__int64))(*(_QWORD *)v15 + 40LL))(v15),
              (*(void (**)(void))(*(_QWORD *)v17 + 40LL))(),
              v10) )
        {
          if ( !v7 )
          {
LABEL_14:
            (*(void (__fastcall **)(IOService *))(*(_QWORD *)this + 2720LL))(this);
            (*(void (__fastcall **)(IOService *))(*(_QWORD *)this + 40LL))(this);
            v5 = v10;
            return (unsigned int)v5;
          }
LABEL_13:
          (*(void (__fastcall **)(_QWORD, __int64))(**((_QWORD **)this + 33) + 304LL))(*((_QWORD *)this + 33), v7);
          goto LABEL_14;
        }
      }
    }
  }
  return (unsigned int)v5;
}

//----- (0000000000029852) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::_LowLatencyWriteIsochPipe(IOService *this, __int64 a2, __int64 a3)
{
  __int64 v3; // r15@1
  __int64 v4; // rax@1
  signed int v5; // ebx@3
  __int64 v6; // rax@5
  __int64 v7; // r14@5
  __int64 v8; // rax@6
  __int64 v9; // rsi@7
  int v10; // er12@7
  __int64 v11; // rax@8
  __int64 v12; // rdx@8
  __int64 v13; // r8@8
  __int64 v14; // r9@8
  __int64 v15; // r15@9
  __int64 v16; // rcx@10
  __int64 v17; // ST00_8@11
  __int64 v19; // [sp+8h] [bp-88h]@8
  __int64 v20; // [sp+10h] [bp-80h]@8
  __int64 v21; // [sp+18h] [bp-78h]@8
  __int64 v22; // [sp+20h] [bp-70h]@8
  __int64 v23; // [sp+28h] [bp-68h]@8
  __int64 v24; // [sp+30h] [bp-60h]@8
  __int64 v25; // [sp+38h] [bp-58h]@8
  __int64 v26; // [sp+40h] [bp-50h]@8
  __int64 v27; // [sp+48h] [bp-48h]@8
  IOService *v28; // [sp+50h] [bp-40h]@7
  __int64 (__fastcall *v29)(OSMetaClassBase *, __int64, const OSMetaClass *); // [sp+58h] [bp-38h]@7
  __int64 v30; // [sp+60h] [bp-30h]@7

  v3 = a3;
  v4 = *((_QWORD *)this + 36);
  if ( !v4 || !*(_BYTE *)(v4 + 183) || (v5 = -536870174, *(_BYTE *)(v4 + 182)) )
  {
    v5 = -536870201;
    if ( *(_QWORD *)(a3 + 8) )
    {
      LODWORD(v6) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 33) + 296LL))(
                      *((_QWORD *)this + 33),
                      0LL);
      v7 = v6;
      if ( v6
        || ((*(void (__fastcall **)(IOService *))(*(_QWORD *)this + 2744LL))(this),
            LODWORD(v8) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 33) + 296LL))(
                            *((_QWORD *)this + 33),
                            0LL),
            v7 = v8,
            v5 = -536870210,
            v8) )
      {
        (*(void (__fastcall **)(IOService *))(*(_QWORD *)this + 32LL))(this);
        (*(void (__fastcall **)(IOService *))(*(_QWORD *)this + 2728LL))(this);
        (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v7 + 280LL))(v7, *(_QWORD *)(v3 + 16));
        v9 = *(_DWORD *)(v3 + 24);
        (*(void (__fastcall **)(__int64, __int64))(*(_QWORD *)v7 + 288LL))(v7, v9);
        v28 = this;
        v29 = IOUSBInterfaceUserClientV2::LowLatencyIsoReqComplete;
        v30 = v7;
        v10 = -536870201;
        if ( *(_QWORD *)(v3 + 64) )
          goto LABEL_13;
        v11 = *(_QWORD *)(v3 + 32);
        v19 = *(_QWORD *)v11;
        v20 = *(_QWORD *)(v11 + 8);
        v21 = *(_QWORD *)(v11 + 16);
        v22 = *(_QWORD *)(v11 + 24);
        v23 = *(_QWORD *)(v11 + 32);
        v24 = *(_QWORD *)(v11 + 40);
        v25 = *(_QWORD *)(v11 + 48);
        v26 = *(_QWORD *)(v11 + 56);
        v27 = *(_QWORD *)(v11 + 64);
        v10 = -536870210;
        if ( (unsigned __int8)IOService::isInactive(this) )
          goto LABEL_13;
        v15 = *((_QWORD *)this + 30);
        v10 = -536870210;
        if ( !v15
          || (v16 = *((_QWORD *)this + 31)) == 0
          || ((*(void (__cdecl **)(_QWORD, __int64, __int64, __int64, __int64, __int64, _QWORD, __int64, __int64, __int64, __int64, __int64, __int64))(*(_QWORD *)v16 + 32LL))(
                *((_QWORD *)this + 31),
                v9,
                v12,
                v16,
                v13,
                v14,
                *((_QWORD *)this + 31),
                v19,
                v20,
                v21,
                v22,
                v23,
                v24),
              (*(void (__fastcall **)(__int64))(*(_QWORD *)v15 + 32LL))(v15),
              v5 = 0,
              v10 = (*(int (__fastcall **)(__int64, int (__fastcall *)(IOUSBInterfaceUserClientV2 *, OSObject *, void *, void *, void *, void *), __int64 *, __int64 *, signed __int64, _QWORD))(*(_QWORD *)v15 + 456LL))(
                      v15,
                      IOUSBInterfaceUserClientV2::DoLowLatencyIsochPipeAsyncGated,
                      &v19,
                      &v28,
                      2LL,
                      0LL),
              (*(void (__fastcall **)(__int64))(*(_QWORD *)v15 + 40LL))(v15),
              (*(void (**)(void))(*(_QWORD *)v17 + 40LL))(),
              v10) )
        {
          if ( !v7 )
          {
LABEL_14:
            (*(void (__fastcall **)(IOService *))(*(_QWORD *)this + 2720LL))(this);
            (*(void (__fastcall **)(IOService *))(*(_QWORD *)this + 40LL))(this);
            v5 = v10;
            return (unsigned int)v5;
          }
LABEL_13:
          (*(void (__fastcall **)(_QWORD, __int64))(**((_QWORD **)this + 33) + 304LL))(*((_QWORD *)this + 33), v7);
          goto LABEL_14;
        }
      }
    }
  }
  return (unsigned int)v5;
}

//----- (0000000000029A6A) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::_GetConfigDescriptor(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rbx@1
  __int64 v4; // rdx@1
  int v5; // eax@2
  int v6; // ebx@4

  v3 = a3;
  (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
  v4 = *(_QWORD *)(v3 + 104);
  if ( v4 )
    v5 = (*(int (__fastcall **)(__int64, _QWORD, __int64, signed __int64))(*(_QWORD *)a1 + 2488LL))(
           a1,
           **(_BYTE **)(v3 + 32),
           v4,
           v3 + 112);
  else
    v5 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, signed __int64))(*(_QWORD *)a1 + 2480LL))(
           a1,
           **(_BYTE **)(v3 + 32),
           *(_QWORD *)(v3 + 88),
           v3 + 96);
  v6 = v5;
  (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
  return (unsigned int)v6;
}

//----- (0000000000029AD2) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::_GetPipePropertiesV2(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1

  v3 = a3;
  (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
  LODWORD(v3) = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, signed __int64, signed __int64, signed __int64))(*(_QWORD *)a1 + 2856LL))(
                  a1,
                  **(_BYTE **)(v3 + 32),
                  *(_QWORD *)(v3 + 72),
                  *(_QWORD *)(v3 + 72) + 8LL,
                  *(_QWORD *)(v3 + 72) + 16LL,
                  *(_QWORD *)(v3 + 72) + 24LL);
  (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
  return (unsigned int)v3;
}

//----- (0000000000029B48) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::_GetPipePropertiesV3(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1

  v3 = a3;
  (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
  LODWORD(v3) = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, signed __int64))(*(_QWORD *)a1 + 2864LL))(
                  a1,
                  **(_BYTE **)(v3 + 32),
                  *(_BYTE *)(*(_QWORD *)(v3 + 32) + 8LL),
                  *(_QWORD *)(v3 + 88),
                  v3 + 96);
  (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
  return (unsigned int)v3;
}

//----- (0000000000029B8E) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::_GetEndpointPropertiesV3(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rbx@1

  v3 = a3;
  (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
  LODWORD(v3) = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 2872LL))(
                  a1,
                  **(_BYTE **)(v3 + 32),
                  *(_BYTE *)(*(_QWORD *)(v3 + 32) + 8LL),
                  *(_BYTE *)(*(_QWORD *)(v3 + 32) + 16LL),
                  *(_BYTE *)(*(_QWORD *)(v3 + 32) + 24LL),
                  *(_QWORD *)(v3 + 88));
  (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
  return (unsigned int)v3;
}

//----- (0000000000029BE8) ----------------------------------------------------
int IOUSBInterfaceUserClientV2::externalMethod()
{
  return (*(int (**)(void))(off_3B0B8[0] + 2144))();
}
// 3B0B8: using guessed type __int64 off_3B0B8[11];

//----- (0000000000029C18) ----------------------------------------------------
signed __int64 __fastcall IOUSBInterfaceUserClientV2::SetAsyncPort(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 v3; // rdi@1
  signed __int64 result; // rax@3

  v2 = a1;
  v3 = *(_QWORD *)(a1 + 232);
  if ( v3 )
  {
    IOUserClient::releaseNotificationPort(v3);
    *(_QWORD *)(v2 + 232) = 0LL;
  }
  result = 3758097113LL;
  if ( *(_QWORD *)(v2 + 216) )
  {
    *(_QWORD *)(v2 + 232) = a2;
    result = 0LL;
  }
  return result;
}
// 7D518: using guessed type int __cdecl IOUserClient::releaseNotificationPort(_QWORD);

//----- (0000000000029C5E) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::ReqComplete(IOUSBInterfaceUserClientV2 *this, void *a2, void *a3, unsigned int a4)
{
  unsigned int v4; // er13@1
  int v5; // er12@1
  void *v6; // r14@1
  __int64 v7; // rbx@1
  unsigned __int64 *v8; // rsi@1
  unsigned int v9; // er8@1
  uintptr_t v10; // r15@1
  __int64 v11; // rdi@9
  int v12; // eax@12
  int v14[2]; // [sp+8h] [bp-38h]@7
  __int64 v15; // [sp+10h] [bp-30h]@1

  v4 = a4;
  v5 = (signed int)a3;
  v6 = a2;
  v7 = off_3B0E0[0];
  v15 = *(_QWORD *)off_3B0E0[0];
  v8 = &IOUSBInterfaceUserClientV2::gMetaClass;
  v10 = OSMetaClassBase::safeMetaCast(
          this,
          (const OSMetaClassBase *)&IOUSBInterfaceUserClientV2::gMetaClass,
          (const OSMetaClass *)a3);
  if ( v10 )
  {
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      v8 = (unsigned __int64 *)v10;
      kernel_debug(0x52D2420u, v10, v5, v4, *((_DWORD *)v6 + 17), 0LL);
    }
    if ( v5 != -536870168 && v5 )
      *(_QWORD *)v14 = 0LL;
    else
      *(_QWORD *)v14 = *((_DWORD *)v6 + 17) - v4;
    v11 = *((_QWORD *)v6 + 9);
    if ( v11 )
    {
      v8 = 0LL;
      (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v11 + 504LL))(v11, 0LL);
      (*(void (**)(void))(**((_QWORD **)v6 + 9) + 40LL))();
    }
    if ( *((_BYTE *)v6 + 80) == 30 )
    {
      v12 = OSDecrementAtomic(*(_QWORD *)(v10 + 288) + 176LL);
      if ( gUSBStackDebugFlags & 2 )
      {
        if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        {
          v8 = (unsigned __int64 *)v10;
          kernel_debug(0x52D242Cu, v10, v12 - 1, *((_DWORD *)v6 + 17), 0LL, 0LL);
        }
      }
    }
    if ( !*(_BYTE *)(v10 + 276) )
    {
      v8 = (unsigned __int64 *)(unsigned int)v5;
      IOUserClient::sendAsyncResult64(
        (IOUserClient *)v6,
        (unsigned __int64 *)(unsigned int)v5,
        (unsigned __int64)v14,
        (unsigned __int64 *)((char *)&dword_0 + 1),
        v9);
    }
    IOUserClient::releaseAsyncReference64((IOUserClient *)v6, v8);
    IOFree(v6, 104LL);
    (*(void (__fastcall **)(uintptr_t, signed __int64))(*(_QWORD *)v10 + 2720LL))(v10, 104LL);
    (*(void (__fastcall **)(uintptr_t))(*(_QWORD *)v10 + 40LL))(v10);
    v7 = off_3B0E0[0];
  }
  return *(_QWORD *)v7;
}
// 0: using guessed type int dword_0;
// 3B0E0: using guessed type __int64 off_3B0E0[6];
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 49928: using guessed type _QWORD IOUSBInterfaceUserClientV2::gMetaClass;
// 7D218: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// 7D290: using guessed type int __fastcall OSDecrementAtomic(_QWORD);
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000029DD2) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::IsoReqComplete(OSMetaClassBase *a1, __int64 a2, const OSMetaClass *a3)
{
  int v3; // er15@1
  __int64 v4; // rbx@1
  __int64 v5; // r12@1
  unsigned __int64 *v6; // rsi@1
  unsigned int v7; // er8@1
  uintptr_t v8; // r14@1
  __int64 v9; // rdi@5
  __int64 v10; // rdi@7
  __int64 v11; // rdi@9
  int v13[2]; // [sp+0h] [bp-30h]@5
  __int64 v14; // [sp+8h] [bp-28h]@1

  v3 = (signed int)a3;
  v4 = a2;
  v5 = off_3B0E0[0];
  v14 = *(_QWORD *)off_3B0E0[0];
  v6 = &IOUSBInterfaceUserClientV2::gMetaClass;
  v8 = OSMetaClassBase::safeMetaCast(a1, (const OSMetaClassBase *)&IOUSBInterfaceUserClientV2::gMetaClass, a3);
  if ( v8 )
  {
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      v6 = (unsigned __int64 *)v8;
      kernel_debug(0x52D2424u, v8, v3, *(_QWORD *)(v4 + 112), 0LL, 0LL);
    }
    *(_QWORD *)v13 = *(_QWORD *)(v4 + 80);
    v9 = *(_QWORD *)(v4 + 96);
    if ( v9 )
    {
      v6 = 0LL;
      (*(void (__fastcall **)(__int64, _QWORD, signed __int64, _QWORD))(*(_QWORD *)v9 + 488LL))(
        v9,
        0LL,
        v4 + 128,
        *(_QWORD *)(v4 + 72));
    }
    v10 = *(_QWORD *)(v4 + 88);
    if ( v10 )
    {
      v6 = 0LL;
      (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v10 + 504LL))(v10, 0LL);
      (*(void (__cdecl **)(_QWORD, _QWORD))(**(_QWORD **)(v4 + 88) + 40LL))(*(_QWORD *)(v4 + 88), 0LL);
      *(_QWORD *)(v4 + 88) = 0LL;
    }
    v11 = *(_QWORD *)(v4 + 96);
    if ( v11 )
    {
      v6 = 0LL;
      (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v11 + 504LL))(v11, 0LL);
      (*(void (__cdecl **)(_QWORD, _QWORD))(**(_QWORD **)(v4 + 96) + 40LL))(*(_QWORD *)(v4 + 96), 0LL);
      *(_QWORD *)(v4 + 96) = 0LL;
    }
    if ( !*(_BYTE *)(v8 + 276) )
    {
      v6 = (unsigned __int64 *)(unsigned int)v3;
      IOUserClient::sendAsyncResult64(
        (IOUserClient *)v4,
        (unsigned __int64 *)(unsigned int)v3,
        (unsigned __int64)v13,
        (unsigned __int64 *)((char *)&dword_0 + 1),
        v7);
    }
    IOUserClient::releaseAsyncReference64((IOUserClient *)v4, v6);
    IOFree(v4, *(_QWORD *)(v4 + 72) + 128LL);
    (*(void (__fastcall **)(uintptr_t))(*(_QWORD *)v8 + 2720LL))(v8);
    (*(void (__fastcall **)(uintptr_t))(*(_QWORD *)v8 + 40LL))(v8);
  }
  return *(_QWORD *)v5;
}
// 0: using guessed type int dword_0;
// 3B0E0: using guessed type __int64 off_3B0E0[6];
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 49928: using guessed type _QWORD IOUSBInterfaceUserClientV2::gMetaClass;
// 7D218: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000029F1E) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::LowLatencyIsoReqComplete(OSMetaClassBase *a1, __int64 a2, const OSMetaClass *a3)
{
  int v3; // er15@1
  __int64 v4; // r14@1
  __int64 v5; // r13@1
  uintptr_t v6; // r12@1
  unsigned int v7; // er8@5
  __int64 v8; // rbx@7
  __int64 v9; // rsi@7
  __int64 v10; // rax@7
  __int64 v11; // rax@11
  __int64 v12; // rax@12
  char v14; // [sp+0h] [bp-80h]@5
  int v15[2]; // [sp+48h] [bp-38h]@5
  __int64 v16; // [sp+50h] [bp-30h]@1

  v3 = (signed int)a3;
  v4 = a2;
  v5 = off_3B0E0[0];
  v16 = *(_QWORD *)off_3B0E0[0];
  v6 = OSMetaClassBase::safeMetaCast(a1, (const OSMetaClassBase *)&IOUSBInterfaceUserClientV2::gMetaClass, a3);
  if ( v6 )
  {
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D2428u, v6, v3, *(_QWORD *)(*(_QWORD *)(a2 + 128) + 24LL), 0LL, 0LL);
    *(_QWORD *)v15 = *(_QWORD *)(a2 + 104);
    bcopy((const void *)(a2 + 32), &v14, 0x40uLL);
    if ( !*(_BYTE *)(v6 + 276) )
      IOUserClient::sendAsyncResult64(
        (IOUserClient *)&v14,
        (unsigned __int64 *)(unsigned int)v3,
        (unsigned __int64)v15,
        (unsigned __int64 *)((char *)&dword_0 + 1),
        v7);
    v8 = *(_QWORD *)(a2 + 112);
    v9 = 0LL;
    (*(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v8 + 504LL))(*(_QWORD *)(v4 + 112), 0LL);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v8 + 40LL))(v8);
    v10 = *(_QWORD *)(*(_QWORD *)(v4 + 128) + 8LL);
    if ( v10 )
    {
      --*(_DWORD *)(v10 + 84);
      v9 = *(_QWORD *)(*(_QWORD *)(v4 + 128) + 8LL);
      if ( *(_BYTE *)(v9 + 80) )
      {
        if ( !*(_DWORD *)(v9 + 84) )
          (*(void (__fastcall **)(uintptr_t))(*(_QWORD *)v6 + 2816LL))(v6);
      }
    }
    v11 = **(_QWORD **)(v4 + 128);
    if ( v11 )
    {
      --*(_DWORD *)(v11 + 84);
      v12 = *(_QWORD *)(v4 + 128);
      v9 = *(_QWORD *)v12;
      if ( *(_BYTE *)(*(_QWORD *)v12 + 80LL) )
      {
        if ( !*(_DWORD *)(v9 + 84) )
          (*(void (__fastcall **)(uintptr_t))(*(_QWORD *)v6 + 2816LL))(v6);
      }
    }
    IOUserClient::releaseAsyncReference64((IOUserClient *)&v14, (unsigned __int64 *)v9);
    (*(void (__fastcall **)(_QWORD, __int64))(**(_QWORD **)(v6 + 264) + 304LL))(*(_QWORD *)(v6 + 264), v4);
    (*(void (__fastcall **)(uintptr_t))(*(_QWORD *)v6 + 2720LL))(v6);
    (*(void (__fastcall **)(uintptr_t))(*(_QWORD *)v6 + 40LL))(v6);
  }
  return *(_QWORD *)v5;
}
// 0: using guessed type int dword_0;
// 3B0E0: using guessed type __int64 off_3B0E0[6];
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 49928: using guessed type _QWORD IOUSBInterfaceUserClientV2::gMetaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000002A0AC) ----------------------------------------------------
char __fastcall IOUSBInterfaceUserClientV2::initWithTask(IOUSBInterfaceUserClientV2 *this, task *a2, void *a3, unsigned int a4, OSDictionary *a5)
{
  OSDictionary *v5; // rbx@1
  unsigned int v6; // er14@1
  IOUserClient *v7; // r12@1
  const char *v8; // rdx@3
  unsigned __int8 v9; // cl@3
  char result; // al@3
  void *v11; // rax@6

  v5 = a5;
  v6 = a4;
  v7 = (IOUserClient *)a3;
  if ( a5 )
    (*(void (__fastcall **)(OSDictionary *, _QWORD, _QWORD))(*(_QWORD *)a5 + 464LL))(
      a5,
      "IOUserClientCrossEndianCompatible",
      **(_QWORD **)off_3B0F8[0]);
  v9 = (*(int (__fastcall **)(IOUSBInterfaceUserClientV2 *, task *, IOUserClient *, _QWORD, OSDictionary *))(off_3B0B8[0] + 2288))(
         this,
         a2,
         v7,
         v6,
         v5);
  result = 0;
  if ( a2 && !(v9 ^ 1) )
  {
    if ( *((_QWORD *)this + 36) )
    {
LABEL_8:
      **((_BYTE **)this + 36) = (unsigned int)IOUserClient::clientHasPrivilege(v7, "root", v8) == 0;
      *((_QWORD *)this + 28) = a2;
      *((_BYTE *)this + 276) = 0;
      *((_QWORD *)this + 29) = 0LL;
      *((_BYTE *)this + 278) = v6 >> 31;
      return 1;
    }
    LODWORD(v11) = IOMalloc(184LL);
    *((_QWORD *)this + 36) = v11;
    if ( v11 )
    {
      bzero(v11, 0xB8uLL);
      goto LABEL_8;
    }
    result = 0;
  }
  return result;
}
// 3B0B8: using guessed type __int64 off_3B0B8[11];
// 3B0F8: using guessed type __int64 off_3B0F8[3];
// 7D250: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (000000000002A19A) ----------------------------------------------------
char __usercall IOUSBInterfaceUserClientV2::start@<al>(IOUSBInterfaceUserClientV2 *this@<rdi>, IOService *a2@<rsi>, char a3@<al>)
{
  IOUSBInterfaceUserClientV2 *v3; // r12@1
  const OSMetaClass *v4; // rdx@1
  __int64 v5; // rcx@1
  __int64 v6; // r8@1
  __int64 v7; // r9@1
  __int64 v8; // rax@2
  char v9; // al@3
  __int64 v10; // r8@3
  __int64 v11; // r9@3
  __int64 v12; // rcx@3
  IOUserClient *v13; // rbx@6
  task *v14; // rax@6
  IOService *v15; // rdx@6
  const char *v16; // rdx@6
  __int64 v17; // rax@6
  __int64 v18; // rax@7
  __int64 v19; // rdx@8
  char v20; // bl@10
  signed __int64 v21; // rsi@11
  __int64 v22; // rax@11
  __int64 v23; // rbx@16
  __int64 v24; // rax@17
  __int64 v25; // rax@19
  __int64 v26; // rax@19
  __int64 v27; // rax@20
  OSMetaClassBase *v28; // rax@23
  OSMetaClassBase *v29; // r14@23
  const OSMetaClassBase *v30; // rsi@23
  const OSMetaClass *v31; // rdx@23
  int (__cdecl *v32)(OSObject *, void *, void *, void *, void *); // rdx@23
  __int64 v33; // r13@23
  int v34; // eax@26
  const OSMetaClassBase *v35; // r15@27
  unsigned int v36; // ebx@27
  OSMetaClassBase *v37; // rax@28
  const OSMetaClass *v38; // rdx@28
  __int64 v39; // rax@28
  __int64 v40; // rax@29
  __int64 v41; // rcx@29
  __int64 v42; // rcx@34
  __int64 v43; // r8@34
  __int64 v44; // r9@34
  IOWorkLoop *v45; // r14@34
  IOUSBCommandPool *v46; // rax@35
  __int64 v47; // rcx@35
  __int64 v48; // r8@35
  __int64 v49; // r9@35
  IOUSBCommandPool *v50; // r15@35
  signed __int64 v51; // rsi@36
  __int64 v52; // rdx@37
  __int64 v53; // rax@43
  __int64 v54; // rdi@44
  IOCommandPool *v56; // rax@50
  __int64 v57; // rcx@50
  __int64 v58; // r8@50
  __int64 v59; // r9@50
  char v60; // [sp-8h] [bp-30h]@1

  v60 = a3;
  v3 = this;
  (*(void (**)(void))(*(_QWORD *)this + 32LL))();
  if ( !(unsigned __int8)(*(int (**)(void))(off_3B0B8[0] + 1488))() )
  {
    v19 = (__int64)"IOUSBInterfaceUserClientV2::start - super::start returned false!";
LABEL_10:
    v20 = 0;
    KernelDebugLogInternal(1u, 0x55534246u, v19, v5, v6, v7, v60);
    (*(void (__fastcall **)(IOUSBInterfaceUserClientV2 *, signed __int64))(*(_QWORD *)this + 40LL))(this, 1431519814LL);
    return v20;
  }
  v8 = OSMetaClassBase::safeMetaCast(a2, (const OSMetaClassBase *)IOUSBInterface::metaClass, v4);
  *((_QWORD *)this + 27) = v8;
  if ( !v8 )
  {
    v19 = (__int64)"IOUSBInterfaceUserClientV2::start - provider is NULL!";
    goto LABEL_10;
  }
  (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v8 + 32LL))(v8, IOUSBInterface::metaClass);
  *(_BYTE *)(*((_QWORD *)this + 36) + 174LL) = 0;
  v9 = (*(int (__fastcall **)(_QWORD, IOUSBInterfaceUserClientV2 *, _QWORD, _QWORD))(**((_QWORD **)this + 27) + 1488LL))(
         *((_QWORD *)this + 27),
         this,
         0LL,
         0LL);
  v12 = *((_QWORD *)this + 27);
  if ( v9 )
  {
    if ( (unsigned __int8)(*(int (__fastcall **)(_QWORD))(*(_QWORD *)v12 + 2248LL))(*((_QWORD *)this + 27)) == 8 )
      *(_BYTE *)(*((_QWORD *)this + 36) + 181LL) = 1;
    v13 = (IOUserClient *)*((_QWORD *)this + 28);
    LODWORD(v14) = (*(int (**)(void))(**((_QWORD **)this + 27) + 2216LL))();
    *(_BYTE *)(*((_QWORD *)this + 36) + 182LL) = (unsigned int)IOUserClient::clientHasAuthorization(v13, v14, v15) == 0;
    v17 = IOUserClient::copyClientEntitlement(*((IOUserClient **)this + 28), "com.apple.vm.device-access", v16);
    if ( v17 )
    {
      *(_BYTE *)(*((_QWORD *)this + 36) + 183LL) = v17 == **(_QWORD **)off_3B0F8[0];
      (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v17 + 40LL))(v17, "com.apple.vm.device-access");
      v18 = *((_QWORD *)this + 36);
    }
    else
    {
      v18 = *((_QWORD *)this + 36);
      *(_BYTE *)(v18 + 183) = 0;
    }
    if ( *(_BYTE *)(v18 + 182) && *(_BYTE *)(v18 + 183) )
    {
      v23 = *(_QWORD *)off_3B0F8[0];
    }
    else
    {
      LODWORD(v24) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 27) + 696LL))(
                       *((_QWORD *)this + 27),
                       "NeedsAdministratorPrivilege");
      v23 = *(_QWORD *)off_3B0F8[0];
      if ( v24 == **(_QWORD **)off_3B0F8[0] && !**((_BYTE **)this + 36) )
        goto LABEL_43;
    }
    LODWORD(v25) = (*(int (**)(void))(**((_QWORD **)this + 27) + 2216LL))();
    LODWORD(v26) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v25 + 696LL))(
                     v25,
                     "NeedsDeviceAccessEntitlement");
    if ( v26 == *(_QWORD *)v23 )
    {
      v27 = *((_QWORD *)this + 36);
      if ( !*(_BYTE *)v27 && (!*(_BYTE *)(v27 + 182) || !*(_BYTE *)(v27 + 183)) )
      {
LABEL_43:
        v53 = *((_QWORD *)this + 36);
        if ( *(_BYTE *)(v53 + 174) )
          return 0;
        *(_BYTE *)(v53 + 174) = 1;
        v54 = *((_QWORD *)this + 27);
        if ( !v54 )
        {
LABEL_47:
          (*(void (__fastcall **)(IOUSBInterfaceUserClientV2 *))(*(_QWORD *)v3 + 40LL))(v3);
          return 0;
        }
        v21 = (signed __int64)v3;
        (*(void (__fastcall **)(__int64, IOUSBInterfaceUserClientV2 *, _QWORD))(*(_QWORD *)v54 + 1496LL))(v54, v3, 0LL);
LABEL_46:
        (*(void (__fastcall **)(_QWORD, signed __int64))(**((_QWORD **)v3 + 27) + 40LL))(*((_QWORD *)v3 + 27), v21);
        goto LABEL_47;
      }
    }
    LODWORD(v28) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 27) + 744LL))(
                     *((_QWORD *)this + 27),
                     "ExtendedData");
    v29 = v28;
    v30 = *(const OSMetaClassBase **)off_3B070[0];
    v33 = OSMetaClassBase::safeMetaCast(v28, *(const OSMetaClassBase **)off_3B070[0], v31);
    if ( v33 )
    {
      if ( (unsigned int)(*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v33 + 304LL))(v33, v30) < 0x15 )
      {
        v34 = (*(int (__fastcall **)(__int64))(*(_QWORD *)v33 + 304LL))(v33);
        *(_DWORD *)(*((_QWORD *)this + 36) + 168LL) = v34;
        if ( !v34 )
          goto LABEL_32;
      }
      else
      {
        *(_DWORD *)(*((_QWORD *)this + 36) + 168LL) = 20;
      }
      v35 = *(const OSMetaClassBase **)off_3B078[0];
      v36 = 0;
      do
      {
        LODWORD(v37) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v33 + 488LL))(v33, v36);
        v30 = v35;
        v39 = OSMetaClassBase::safeMetaCast(v37, v35, v38);
        if ( v39 )
        {
          LODWORD(v40) = (*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v39 + 336LL))(v39, v35);
          v32 = (int (__cdecl *)(OSObject *, void *, void *, void *, void *))v36;
          v41 = *((_QWORD *)this + 36);
          *(_QWORD *)(v41 + 8LL * v36 + 8) = v40;
        }
        else
        {
          v41 = *((_QWORD *)this + 36);
        }
        ++v36;
      }
      while ( v36 < *(_DWORD *)(v41 + 168) );
    }
LABEL_32:
    if ( v29 )
      (*(void (__fastcall **)(OSMetaClassBase *, const OSMetaClassBase *))(*(_QWORD *)v29 + 40LL))(v29, v30);
    v45 = (IOWorkLoop *)IOCommandGate::commandGate(this, 0LL, v32);
    if ( v45 )
    {
      LODWORD(v46) = (*(int (__fastcall **)(IOUSBInterfaceUserClientV2 *, _QWORD))(*(_QWORD *)this + 1672LL))(this, 0LL);
      v50 = v46;
      if ( v46 )
      {
        (*(void (__fastcall **)(IOUSBCommandPool *))(*(_QWORD *)v46 + 32LL))(v46);
        v51 = (signed __int64)v45;
        if ( !(*(int (__fastcall **)(IOUSBCommandPool *, IOWorkLoop *))(*(_QWORD *)v50 + 320LL))(v50, v45) )
        {
          v56 = IOUSBCommandPool::withWorkLoop(v50, v45);
          *((_QWORD *)this + 33) = v56;
          if ( v56 )
          {
            if ( !(unsigned __int8)IOService::isInactive(this) )
            {
              *((_QWORD *)this + 30) = v45;
              *((_QWORD *)this + 31) = v50;
              return 1;
            }
          }
          else
          {
            KernelDebugLogInternal(
              1u,
              0x55534246u,
              (__int64)"IOUSBInterfaceUserClientV2::start - unable to create free command pool",
              v57,
              v58,
              v59,
              v60);
            v51 = (signed __int64)v45;
            (*(void (__fastcall **)(IOUSBCommandPool *, IOWorkLoop *))(*(_QWORD *)v50 + 328LL))(v50, v45);
          }
          goto LABEL_41;
        }
        v52 = (__int64)"IOUSBInterfaceUserClientV2::start - unable to add gate to work loop";
      }
      else
      {
        v52 = (__int64)"IOUSBInterfaceUserClientV2::start - unable to find my workloop";
      }
      v51 = 1431519814LL;
      KernelDebugLogInternal(1u, 0x55534246u, v52, v47, v48, v49, v60);
LABEL_41:
      (*(void (__fastcall **)(IOWorkLoop *, signed __int64))(*(_QWORD *)v45 + 40LL))(v45, v51);
      if ( v50 )
        (*(void (__fastcall **)(IOUSBCommandPool *))(*(_QWORD *)v50 + 40LL))(v50);
      goto LABEL_43;
    }
    KernelDebugLogInternal(
      1u,
      0x55534246u,
      (__int64)"IOUSBInterfaceUserClientV2::start - unable to create command gate",
      v42,
      v43,
      v44,
      v60);
    goto LABEL_43;
  }
  v20 = 0;
  v21 = 1431519814LL;
  KernelDebugLogInternal(
    1u,
    0x55534246u,
    (__int64)"IOUSBInterfaceUserClientV2::start -  could not open() our provider(%p)!",
    v12,
    v10,
    v11,
    v60);
  v22 = *((_QWORD *)this + 36);
  if ( !*(_BYTE *)(v22 + 174) )
  {
    *(_BYTE *)(v22 + 174) = 1;
    goto LABEL_46;
  }
  return v20;
}
// 3B070: using guessed type _QWORD off_3B070[20];
// 3B078: using guessed type _QWORD off_3B078[19];
// 3B0B8: using guessed type __int64 off_3B0B8[11];
// 3B0F8: using guessed type __int64 off_3B0F8[3];
// 3C7A0: using guessed type _QWORD IOUSBInterface::metaClass;
// 7D4D0: using guessed type _QWORD __cdecl IOUserClient::clientHasAuthorization(IOUserClient *__hidden this, task *, IOService *);
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000002A63C) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::open(IOUSBInterfaceUserClientV2 *this, unsigned __int8 a2)
{
  IOUSBInterfaceUserClientV2 *v2; // rbx@1
  __int64 v3; // rax@1
  signed int v4; // er15@2
  __int64 v5; // rdi@3
  __int64 v6; // rcx@6

  v2 = this;
  (*(void (__cdecl **)(IOUSBInterfaceUserClientV2 *))(*(_QWORD *)this + 2728LL))(this);
  v3 = *((_QWORD *)this + 36);
  if ( !*(_BYTE *)(v3 + 181) || (v4 = -536870174, !*(_BYTE *)(v3 + 183)) )
  {
    v5 = *((_QWORD *)this + 27);
    v4 = -536870183;
    if ( v5 )
    {
      v4 = -536870203;
      if ( (unsigned __int8)(*(int (__fastcall **)(__int64, IOUSBInterfaceUserClientV2 *, _QWORD, _QWORD))(*(_QWORD *)v5 + 1488LL))(
                              v5,
                              v2,
                              a2 | 0x20000u,
                              0LL) )
      {
        *(_BYTE *)(*((_QWORD *)v2 + 36) + 172LL) = 1;
        *(_BYTE *)(*((_QWORD *)v2 + 36) + 175LL) = (*(int (__cdecl **)(_QWORD))(**((_QWORD **)v2 + 27) + 2232LL))(*((_QWORD *)v2 + 27));
        if ( *((_BYTE *)v2 + 278) )
          v6 = off_3B0F8[0];
        else
          v6 = off_3B0F0[0];
        (*(void (__fastcall **)(_QWORD, _QWORD, _QWORD))(**((_QWORD **)v2 + 27) + 616LL))(
          *((_QWORD *)v2 + 27),
          "IOUserClientCrossEndianCompatible",
          **(_QWORD **)v6);
        *((_BYTE *)v2 + 277) = 0;
        v4 = 0;
      }
    }
  }
  (*(void (__fastcall **)(IOUSBInterfaceUserClientV2 *))(*(_QWORD *)v2 + 2720LL))(v2);
  return (unsigned int)v4;
}
// 3B0F0: using guessed type __int64 off_3B0F0[4];
// 3B0F8: using guessed type __int64 off_3B0F8[3];

//----- (000000000002A738) ----------------------------------------------------
int __fastcall IOUSBInterfaceUserClientV2::closeGated(IOUSBInterfaceUserClientV2 *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  __int64 v6; // rax@1
  int result; // eax@2

  v6 = OSMetaClassBase::safeMetaCast(
         this,
         (const OSMetaClassBase *)&IOUSBInterfaceUserClientV2::gMetaClass,
         (const OSMetaClass *)a3);
  if ( v6 )
    result = (*(int (__fastcall **)(__int64, _QWORD *))(*(_QWORD *)v6 + 2408LL))(
               v6,
               &IOUSBInterfaceUserClientV2::gMetaClass);
  else
    result = -536870206;
  return result;
}
// 49928: using guessed type _QWORD IOUSBInterfaceUserClientV2::gMetaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000002A762) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::close(IOUSBInterfaceUserClientV2 *this)
{
  __int64 result; // rax@1
  signed int v2; // ebx@3
  __int64 v3; // rcx@5

  result = 3758097113LL;
  if ( *((_QWORD *)this + 27) )
  {
    if ( *((_DWORD *)this + 68) )
    {
      v2 = -32;
      do
        (*(void (__fastcall **)(IOUSBInterfaceUserClientV2 *, _QWORD))(*(_QWORD *)this + 2560LL))(
          this,
          (unsigned __int8)(v2++ + 33));
      while ( v2 );
    }
    v3 = *((_QWORD *)this + 36);
    result = 3758097101LL;
    if ( *(_BYTE *)(v3 + 172) )
    {
      *(_BYTE *)(v3 + 172) = 0;
      (*(void (__fastcall **)(_QWORD, IOUSBInterfaceUserClientV2 *, signed __int64))(**((_QWORD **)this + 27) + 1496LL))(
        *((_QWORD *)this + 27),
        this,
        0x20000LL);
      result = 0LL;
    }
  }
  return result;
}

//----- (000000000002A7DC) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::SetAlternateInterface(IOUSBInterfaceUserClientV2 *this, unsigned __int8 a2)
{
  int v2; // er14@1

  (*(void (__cdecl **)(IOUSBInterfaceUserClientV2 *))(*(_QWORD *)this + 2728LL))(this);
  v2 = -536870183;
  if ( *((_QWORD *)this + 27) && !(unsigned __int8)IOService::isInactive(this) )
    v2 = (*(int (__fastcall **)(_QWORD, IOUSBInterfaceUserClientV2 *, _QWORD))(**((_QWORD **)this + 27) + 2192LL))(
           *((_QWORD *)this + 27),
           this,
           a2);
  (*(void (__fastcall **)(IOUSBInterfaceUserClientV2 *))(*(_QWORD *)this + 2720LL))(this);
  return (unsigned int)v2;
}

//----- (000000000002A846) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::GetDevice(IOUSBInterfaceUserClientV2 *this, unsigned __int64 *a2)
{
  int v2; // er15@1
  __int64 v3; // rax@3
  int (__fastcall *v4)(_QWORD, _QWORD, _QWORD, _QWORD); // r12@3
  __int64 v5; // r15@3
  __int64 v6; // rax@3
  unsigned __int64 v8; // [sp+8h] [bp-28h]@3

  (*(void (**)(void))(*(_QWORD *)this + 2728LL))();
  *a2 = 0LL;
  v2 = -536870183;
  if ( *((_QWORD *)this + 27) && !(unsigned __int8)IOService::isInactive(this) )
  {
    LODWORD(v3) = (*(int (**)(void))(**((_QWORD **)this + 27) + 2216LL))();
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 32LL))(v3);
    v4 = *(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 2344LL);
    v5 = *((_QWORD *)this + 28);
    LODWORD(v6) = (*(int (**)(void))(**((_QWORD **)this + 27) + 2216LL))();
    v2 = v4(this, v5, v6, &v8);
    *a2 = v8;
  }
  (*(void (__fastcall **)(IOUSBInterfaceUserClientV2 *))(*(_QWORD *)this + 2720LL))(this);
  return (unsigned int)v2;
}

//----- (000000000002A8F8) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::GetFrameNumber(IOService *this, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  signed int v4; // er12@1
  __int64 v5; // rax@3
  __int64 v6; // rax@3
  __int64 v7; // rax@3

  v3 = a3;
  (*(void (**)(void))(*(_QWORD *)this + 2728LL))();
  v4 = -536870183;
  if ( *((_QWORD *)this + 27) && !(unsigned __int8)IOService::isInactive(this) )
  {
    *(_QWORD *)(a2 + 8) = mach_absolute_time();
    LODWORD(v5) = (*(int (**)(void))(**((_QWORD **)this + 27) + 2216LL))();
    LODWORD(v6) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v5 + 2264LL))(v5);
    LODWORD(v7) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v6 + 2456LL))(v6);
    *(_QWORD *)a2 = v7;
    *(_DWORD *)v3 = 16;
    v4 = 0;
  }
  (*(void (__fastcall **)(IOService *))(*(_QWORD *)this + 2720LL))(this);
  return (unsigned int)v4;
}

//----- (000000000002A988) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::GetMicroFrameNumber(IOService *this, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  IOService *v4; // rbx@1
  __int64 v5; // rdi@1
  signed int v6; // er12@1
  __int64 v7; // rax@2
  OSMetaClassBase *v8; // rax@2
  const OSMetaClass *v9; // rdx@2
  __int64 v10; // r13@2
  __int64 v11; // rax@5

  v3 = a3;
  v4 = this;
  v5 = *((_QWORD *)this + 27);
  v6 = -536870183;
  if ( v5 )
  {
    LODWORD(v7) = (*(int (__cdecl **)(__int64))(*(_QWORD *)v5 + 2216LL))(v5);
    LODWORD(v8) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v7 + 2264LL))(v7);
    v10 = OSMetaClassBase::safeMetaCast(v8, (const OSMetaClassBase *)IOUSBControllerV2::metaClass, v9);
    if ( v10 )
    {
      (*(void (__fastcall **)(IOService *, _QWORD))(*(_QWORD *)v4 + 2728LL))(v4, IOUSBControllerV2::metaClass);
      v6 = -536870183;
      if ( *((_QWORD *)v4 + 27) && !(unsigned __int8)IOService::isInactive(v4) )
      {
        *(_QWORD *)(a2 + 8) = mach_absolute_time();
        LODWORD(v11) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v10 + 2728LL))(v10);
        if ( v11 )
        {
          *(_QWORD *)a2 = v11;
          *(_DWORD *)v3 = 16;
          v6 = 0;
        }
        else
        {
          *(_DWORD *)v3 = 0;
          v6 = -536870201;
        }
      }
      (*(void (__fastcall **)(IOService *))(*(_QWORD *)v4 + 2720LL))(v4);
    }
  }
  return (unsigned int)v6;
}
// 419C0: using guessed type _QWORD IOUSBControllerV2::metaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000002AA62) ----------------------------------------------------
int __fastcall IOUSBInterfaceUserClientV2::GetFrameNumberWithTime(IOService *this, __int64 a2, __int64 a3)
{
  __int64 v3; // r15@1
  signed int v4; // ebx@1
  __int64 v5; // rax@4
  OSMetaClassBase *v6; // rax@4
  const OSMetaClass *v7; // rdx@4
  __int64 v8; // rax@4
  int result; // eax@5

  v3 = a3;
  v4 = -536870206;
  if ( *(_DWORD *)a3 == 16
    && (v4 = -536870183, *((_QWORD *)this + 27))
    && !(unsigned __int8)IOService::isInactive(this)
    && (LODWORD(v5) = (*(int (**)(void))(**((_QWORD **)this + 27) + 2216LL))(),
        LODWORD(v6) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v5 + 2264LL))(v5),
        v8 = OSMetaClassBase::safeMetaCast(v6, (const OSMetaClassBase *)IOUSBControllerV2::metaClass, v7),
        v4 = -536870201,
        v8) )
  {
    result = (*(int (__fastcall **)(__int64, __int64, signed __int64))(*(_QWORD *)v8 + 2864LL))(v8, a2, a2 + 8);
    *(_DWORD *)v3 = 16;
  }
  else
  {
    result = v4;
  }
  return result;
}
// 419C0: using guessed type _QWORD IOUSBControllerV2::metaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000002AAFE) ----------------------------------------------------
__int64 __usercall IOUSBInterfaceUserClientV2::GetBandwidthAvailable@<rax>(IOUSBInterfaceUserClientV2 *this@<rdi>, unsigned __int64 *a2@<rsi>, __int64 a3@<rax>)
{
  signed int v3; // ebx@1
  __int64 v4; // rax@3
  __int64 v5; // r15@3
  OSMetaClassBase *v6; // rax@5
  const OSMetaClass *v7; // rdx@5
  __int64 v8; // r12@5
  const OSMetaClass *v9; // rdx@5
  __int64 v10; // rax@5
  __int64 v11; // rax@8
  __int64 v12; // rax@8
  int v13; // eax@8
  __int64 v15; // [sp-4h] [bp-30h]@1

  v15 = a3;
  v3 = -536870183;
  if ( *((_QWORD *)this + 27) && !(unsigned __int8)IOService::isInactive(this) )
  {
    LODWORD(v4) = (*(int (__cdecl **)(_QWORD))(**((_QWORD **)this + 27) + 2216LL))(*((_QWORD *)this + 27));
    v5 = v4;
    if ( v4
      && *(_QWORD *)(v4 + 232)
      && (LODWORD(v6) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v4 + 2264LL))(v4),
          v8 = OSMetaClassBase::safeMetaCast(v6, (const OSMetaClassBase *)IOUSBControllerV3::metaClass, v7),
          v10 = OSMetaClassBase::safeMetaCast(
                  *(OSMetaClassBase **)(*(_QWORD *)(v5 + 232) + 16LL),
                  (const OSMetaClassBase *)IOUSBHubDevice::metaClass,
                  v9),
          v8)
      && v10
      && !(*(int (__fastcall **)(__int64, __int64, char *))(*(_QWORD *)v8 + 3328LL))(v8, v5, (char *)&v15 + 4) )
    {
      v13 = HIDWORD(v15);
    }
    else
    {
      LODWORD(v11) = (*(int (__cdecl **)(_QWORD))(**((_QWORD **)this + 27) + 2216LL))(*((_QWORD *)this + 27));
      LODWORD(v12) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v11 + 2264LL))(v11);
      v13 = (*(int (__fastcall **)(__int64))(*(_QWORD *)v12 + 2448LL))(v12);
      HIDWORD(v15) = v13;
    }
    *a2 = (unsigned int)v13;
    v3 = 0;
  }
  return (unsigned int)v3;
}
// 42D30: using guessed type _QWORD IOUSBHubDevice::metaClass;
// 44350: using guessed type _QWORD IOUSBControllerV3::metaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000002ABFC) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::GetFrameListTime(IOUSBInterfaceUserClientV2 *this, unsigned __int64 *a2)
{
  signed int v2; // er15@1
  __int64 v3; // rax@3

  v2 = -536870183;
  if ( *((_QWORD *)this + 27) && !(unsigned __int8)IOService::isInactive(this) )
  {
    LODWORD(v3) = (*(int (__cdecl **)(_QWORD))(**((_QWORD **)this + 27) + 2216LL))(*((_QWORD *)this + 27));
    if ( ((*(int (__fastcall **)(__int64))(*(_QWORD *)v3 + 2256LL))(v3) & 0xFE) == 2 )
      *a2 = 125LL;
    else
      *a2 = 1000LL;
    v2 = 0;
  }
  return (unsigned int)v2;
}

//----- (000000000002AC70) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::GetEndpointProperties(IOUSBInterfaceUserClientV2 *this, unsigned __int8 a2, unsigned __int8 a3, unsigned __int8 a4, unsigned __int64 *a5, unsigned __int64 *a6, unsigned __int64 *a7)
{
  unsigned __int8 v7; // r12@1
  unsigned __int8 v8; // r13@1
  int v9; // ebx@1
  unsigned __int64 *v11; // [sp+10h] [bp-40h]@2
  unsigned __int64 *v12; // [sp+18h] [bp-38h]@2
  unsigned __int8 v13; // [sp+23h] [bp-2Dh]@4
  unsigned __int16 v14; // [sp+24h] [bp-2Ch]@3
  unsigned __int8 v15; // [sp+27h] [bp-29h]@3

  v7 = a4;
  v8 = a3;
  v9 = -536870183;
  if ( *((_QWORD *)this + 27) )
  {
    v11 = a5;
    v12 = a6;
    if ( !(unsigned __int8)IOService::isInactive(this) )
    {
      v9 = (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, char *, __int16 *))(**((_QWORD **)this + 27) + 2296LL))(
             *((_QWORD *)this + 27),
             a2,
             v8,
             v7,
             &v15,
             &v14);
      if ( !v9 )
      {
        *v11 = v15;
        *v12 = v14;
        *a7 = v13;
        v9 = 0;
      }
    }
  }
  return (unsigned int)v9;
}

//----- (000000000002AD16) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::GetEndpointPropertiesV3(IOService *this, char a2, char a3, char a4, char a5, __int64 a6, __int64 a7)
{
  __int64 v7; // r14@1
  char v8; // r13@1
  int v9; // er12@1
  char v11; // [sp+0h] [bp-30h]@2
  char v12; // [sp+4h] [bp-2Ch]@2

  v7 = a6;
  v8 = a3;
  v9 = -536870183;
  if ( *((_QWORD *)this + 27) )
  {
    v11 = a5;
    v12 = a4;
    if ( !(unsigned __int8)IOService::isInactive(this) )
    {
      *(_BYTE *)v7 = v11;
      *(_BYTE *)(v7 + 1) = a2;
      *(_BYTE *)(v7 + 3) = v8;
      *(_BYTE *)(v7 + 2) = v12;
      v9 = (*(int (__fastcall **)(_QWORD, __int64))(**((_QWORD **)this + 27) + 2344LL))(*((_QWORD *)this + 27), v7);
      if ( !v9 )
      {
        *(_DWORD *)a7 = 15;
        v9 = 0;
      }
    }
  }
  return (unsigned int)v9;
}

//----- (000000000002ADA2) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::GetConfigDescriptor(IOService *this, unsigned __int8 a2, void *a3, unsigned int *a4)
{
  unsigned int *v4; // r15@1
  void *v5; // r14@1
  signed int v6; // er13@1
  __int64 v7; // rax@3
  __int64 v8; // rax@3
  unsigned int v9; // ecx@4
  unsigned int v10; // edx@4

  v4 = a4;
  v5 = a3;
  (*(void (__cdecl **)(IOService *))(*(_QWORD *)this + 2728LL))(this);
  v6 = -536870183;
  if ( *((_QWORD *)this + 27) )
  {
    if ( !(unsigned __int8)IOService::isInactive(this) )
    {
      LODWORD(v7) = (*(int (__cdecl **)(_QWORD))(**((_QWORD **)this + 27) + 2216LL))(*((_QWORD *)this + 27));
      LODWORD(v8) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v7 + 2216LL))(v7, a2);
      v6 = -536870160;
      if ( v8 )
      {
        v9 = *(_WORD *)(v8 + 2);
        v10 = *v4;
        if ( v9 < *v4 )
        {
          *v4 = v9;
          v10 = v9;
        }
        bcopy((const void *)v8, v5, v10);
        v6 = 0;
      }
    }
  }
  (*(void (__fastcall **)(IOService *))(*(_QWORD *)this + 2720LL))(this);
  return (unsigned int)v6;
}

//----- (000000000002AE4A) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::GetConfigDescriptor(IOUSBInterfaceUserClientV2 *this, unsigned __int8 a2, IOMemoryDescriptor *a3, unsigned int *a4)
{
  unsigned int *v4; // r15@1
  IOMemoryDescriptor *v5; // r14@1
  signed int v6; // er12@1
  __int64 v7; // rax@4
  __int64 v8; // rax@4
  __int64 v9; // r13@4
  unsigned int v10; // eax@5

  v4 = a4;
  v5 = a3;
  v6 = -536870206;
  if ( a3 )
  {
    (*(void (__cdecl **)(IOUSBInterfaceUserClientV2 *))(*(_QWORD *)this + 2728LL))(this);
    v6 = -536870183;
    if ( *((_QWORD *)this + 27) )
    {
      if ( !(unsigned __int8)IOService::isInactive(this) )
      {
        LODWORD(v7) = (*(int (__cdecl **)(_QWORD))(**((_QWORD **)this + 27) + 2216LL))(*((_QWORD *)this + 27));
        LODWORD(v8) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v7 + 2216LL))(v7, a2);
        v9 = v8;
        v6 = -536870160;
        if ( v8 )
        {
          v10 = *(_WORD *)(v8 + 2);
          if ( v10 < *v4 )
            *v4 = v10;
          v6 = 0;
          (*(void (__fastcall **)(IOMemoryDescriptor *, _QWORD))(*(_QWORD *)v5 + 496LL))(v5, 0LL);
          (*(void (__fastcall **)(IOMemoryDescriptor *, _QWORD, __int64, _QWORD))(*(_QWORD *)v5 + 488LL))(
            v5,
            0LL,
            v9,
            *v4);
          (*(void (__fastcall **)(IOMemoryDescriptor *, _QWORD))(*(_QWORD *)v5 + 504LL))(v5, 0LL);
        }
      }
    }
    (*(void (__fastcall **)(IOUSBInterfaceUserClientV2 *))(*(_QWORD *)this + 2720LL))(this);
  }
  return (unsigned int)v6;
}

//----- (000000000002AF28) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::ReadPipe(IOService *this, unsigned __int8 a2, unsigned int a3, unsigned int a4, uintptr_t a5, unsigned __int64 a6, __int64 a7)
{
  uintptr_t v7; // r15@1
  unsigned int v8; // er13@1
  signed int v9; // ebx@1
  __int64 v10; // rax@4
  task *v11; // r8@4
  __int64 v12; // r12@5
  __int64 v13; // rbx@5
  IOService *v14; // rsi@5
  IOService *v15; // r15@5
  int v16; // er14@6
  __int64 v18; // [sp+0h] [bp-40h]@6
  unsigned int v19; // [sp+Ch] [bp-34h]@2
  unsigned __int64 arg1; // [sp+10h] [bp-30h]@2

  v7 = a5;
  v8 = a3;
  v9 = -536870183;
  if ( *((_QWORD *)this + 27) )
  {
    v19 = a4;
    arg1 = a6;
    if ( !(unsigned __int8)IOService::isInactive(this) )
    {
      if ( a7 )
      {
        LODWORD(v10) = (*(int (__fastcall **)(IOService *, _QWORD))(*(_QWORD *)this + 2680LL))(this, a2);
        v9 = -536854431;
        if ( v10 )
        {
          v12 = v10;
          v13 = *(_QWORD *)(a7 + 16);
          v14 = (IOService *)arg1;
          v15 = (IOService *)IOMemoryDescriptor::withAddressRange(
                               (IOMemoryDescriptor *)v7,
                               arg1,
                               1uLL,
                               *((_QWORD *)this + 28),
                               v11);
          if ( !v15 )
          {
            v9 = -536870211;
            if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
            {
              v14 = this;
              kernel_debug(0x52D2404u, (uintptr_t)this, arg1, 0LL, 0xFFFFFFFFE00002BDLL, 0LL);
            }
            goto LABEL_16;
          }
          v18 = v13;
          v9 = 0;
          v14 = 0LL;
          v16 = (*(int (__fastcall **)(IOService *, _QWORD))(*(_QWORD *)v15 + 496LL))(v15, 0LL);
          if ( !v16 )
          {
            *(_DWORD *)(v18 + 68) = arg1;
            *(_QWORD *)(v18 + 72) = v15;
            v14 = v15;
            v16 = (*(int (__fastcall **)(__int64, IOService *, _QWORD, _QWORD, __int64, _QWORD))(*(_QWORD *)v12 + 432LL))(
                    v12,
                    v15,
                    v8,
                    v19,
                    a7,
                    0LL);
            if ( !v16 )
            {
LABEL_16:
              (*(void (__fastcall **)(__int64, IOService *))(*(_QWORD *)v12 + 40LL))(v12, v14);
              return (unsigned int)v9;
            }
            v14 = 0LL;
            (*(void (__fastcall **)(IOService *, _QWORD))(*(_QWORD *)v15 + 504LL))(v15, 0LL);
          }
          (*(void (__fastcall **)(IOService *))(*(_QWORD *)v15 + 40LL))(v15);
          v9 = v16;
          goto LABEL_16;
        }
      }
      else
      {
        v9 = -536870206;
        if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          kernel_debug(0x52D2404u, arg1, v7, 0LL, 0xFFFFFFFFE00002C2LL, 0LL);
      }
    }
  }
  return (unsigned int)v9;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (000000000002B0CE) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::ReadPipe(IOUSBInterfaceUserClientV2 *this, unsigned __int8 a2, unsigned int a3, unsigned int a4, void *a5, unsigned int *a6)
{
  unsigned int *v6; // r14@1
  IOMemoryDescriptor *v7; // r12@1
  int v8; // er15@1
  __int64 v9; // rax@3
  unsigned int v10; // ecx@3
  __int64 v11; // r13@3
  __int64 v12; // rsi@4
  __int64 v13; // r12@4
  unsigned int v15; // [sp+8h] [bp-38h]@1
  unsigned int v16; // [sp+Ch] [bp-34h]@1
  __int64 v17; // [sp+10h] [bp-30h]@4

  v6 = a6;
  v7 = (IOMemoryDescriptor *)a5;
  v16 = a4;
  v15 = a3;
  (*(void (**)(void))(*(_QWORD *)this + 2728LL))();
  v8 = -536870183;
  if ( *((_QWORD *)this + 27) )
  {
    if ( !(unsigned __int8)IOService::isInactive(this) )
    {
      LODWORD(v9) = (*(int (__fastcall **)(IOUSBInterfaceUserClientV2 *, _QWORD))(*(_QWORD *)this + 2680LL))(this, a2);
      v11 = v9;
      v8 = -536854431;
      if ( v9 )
      {
        v12 = *v6;
        v17 = *v6;
        v13 = IOMemoryDescriptor::withAddress(v7, (void *)v12, 1uLL, v10);
        v8 = -536870211;
        if ( v13 )
        {
          *v6 = 0;
          v8 = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v13 + 496LL))(v13, 0LL);
          if ( !v8 )
          {
            v8 = (*(int (__fastcall **)(__int64, __int64, _QWORD, _QWORD, _QWORD, __int64 *))(*(_QWORD *)v11 + 432LL))(
                   v11,
                   v13,
                   v15,
                   v16,
                   0LL,
                   &v17);
            *v6 = v17;
            (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v13 + 504LL))(v13, 0LL);
          }
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v13 + 40LL))(v13);
        }
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v11 + 40LL))(v11);
      }
    }
  }
  (*(void (__fastcall **)(IOUSBInterfaceUserClientV2 *))(*(_QWORD *)this + 2720LL))(this);
  return (unsigned int)v8;
}

//----- (000000000002B1E8) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::ReadPipe(IOUSBInterfaceUserClientV2 *this, unsigned __int8 a2, unsigned int a3, unsigned int a4, IOMemoryDescriptor *a5, unsigned __int64 *a6)
{
  IOMemoryDescriptor *v6; // r14@1
  unsigned int v7; // er13@1
  int v8; // er15@1
  __int64 v9; // rax@3
  __int64 v10; // r12@3
  unsigned int v12; // [sp+Ch] [bp-34h]@1
  unsigned __int64 *v13; // [sp+10h] [bp-30h]@1

  v13 = a6;
  v6 = a5;
  v12 = a4;
  v7 = a3;
  (*(void (**)(void))(*(_QWORD *)this + 2728LL))();
  v8 = -536870183;
  if ( *((_QWORD *)this + 27) )
  {
    if ( !(unsigned __int8)IOService::isInactive(this) )
    {
      LODWORD(v9) = (*(int (__fastcall **)(IOUSBInterfaceUserClientV2 *, _QWORD))(*(_QWORD *)this + 2680LL))(this, a2);
      v10 = v9;
      v8 = -536854431;
      if ( v9 )
      {
        v8 = -536870211;
        if ( v6 )
        {
          v8 = (*(int (__fastcall **)(IOMemoryDescriptor *, _QWORD))(*(_QWORD *)v6 + 496LL))(v6, 0LL);
          if ( !v8 )
          {
            v8 = (*(int (__fastcall **)(__int64, IOMemoryDescriptor *, _QWORD, _QWORD, _QWORD, unsigned __int64 *))(*(_QWORD *)v10 + 432LL))(
                   v10,
                   v6,
                   v7,
                   v12,
                   0LL,
                   v13);
            (*(void (__fastcall **)(IOMemoryDescriptor *, _QWORD))(*(_QWORD *)v6 + 504LL))(v6, 0LL);
          }
        }
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v10 + 40LL))(v10);
      }
    }
  }
  (*(void (__fastcall **)(IOUSBInterfaceUserClientV2 *))(*(_QWORD *)this + 2720LL))(this);
  return (unsigned int)v8;
}

//----- (000000000002B2CA) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::WritePipe(IOService *this, unsigned __int8 a2, unsigned int a3, unsigned int a4, uintptr_t a5, unsigned __int64 a6, __int64 a7)
{
  uintptr_t v7; // r15@1
  unsigned int v8; // er13@1
  signed int v9; // ebx@1
  __int64 v10; // rax@4
  task *v11; // r8@4
  __int64 v12; // r12@5
  __int64 v13; // rbx@5
  IOService *v14; // rsi@5
  IOService *v15; // r15@5
  int v16; // er14@6
  __int64 v18; // [sp+0h] [bp-40h]@6
  unsigned int v19; // [sp+Ch] [bp-34h]@2
  unsigned __int64 arg1; // [sp+10h] [bp-30h]@2

  v7 = a5;
  v8 = a3;
  v9 = -536870183;
  if ( *((_QWORD *)this + 27) )
  {
    v19 = a4;
    arg1 = a6;
    if ( !(unsigned __int8)IOService::isInactive(this) )
    {
      if ( a7 )
      {
        LODWORD(v10) = (*(int (__fastcall **)(IOService *, _QWORD))(*(_QWORD *)this + 2680LL))(this, a2);
        v9 = -536854431;
        if ( v10 )
        {
          v12 = v10;
          v13 = *(_QWORD *)(a7 + 16);
          v14 = (IOService *)arg1;
          v15 = (IOService *)IOMemoryDescriptor::withAddressRange(
                               (IOMemoryDescriptor *)v7,
                               arg1,
                               2uLL,
                               *((_QWORD *)this + 28),
                               v11);
          if ( !v15 )
          {
            v9 = -536870211;
            if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
            {
              v14 = this;
              kernel_debug(0x52D2408u, (uintptr_t)this, arg1, 0LL, 0xFFFFFFFFE00002BDLL, 0LL);
            }
            goto LABEL_16;
          }
          v18 = v13;
          v9 = 0;
          v14 = 0LL;
          v16 = (*(int (__fastcall **)(IOService *, _QWORD))(*(_QWORD *)v15 + 496LL))(v15, 0LL);
          if ( !v16 )
          {
            *(_DWORD *)(v18 + 68) = arg1;
            *(_QWORD *)(v18 + 72) = v15;
            v14 = v15;
            v16 = (*(int (__fastcall **)(__int64, IOService *, _QWORD, _QWORD, __int64))(*(_QWORD *)v12 + 440LL))(
                    v12,
                    v15,
                    v8,
                    v19,
                    a7);
            if ( !v16 )
            {
LABEL_16:
              (*(void (__fastcall **)(__int64, IOService *))(*(_QWORD *)v12 + 40LL))(v12, v14);
              return (unsigned int)v9;
            }
            v14 = 0LL;
            (*(void (__fastcall **)(IOService *, _QWORD))(*(_QWORD *)v15 + 504LL))(v15, 0LL);
          }
          (*(void (__fastcall **)(IOService *))(*(_QWORD *)v15 + 40LL))(v15);
          v9 = v16;
          goto LABEL_16;
        }
      }
      else
      {
        v9 = -536870206;
        if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          kernel_debug(0x52D2408u, arg1, v7, 0LL, 0xFFFFFFFFE00002C2LL, 0LL);
      }
    }
  }
  return (unsigned int)v9;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (000000000002B46E) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::WritePipe(IOUSBInterfaceUserClientV2 *this, unsigned __int8 a2, unsigned int a3, unsigned int a4, const void *a5, unsigned int a6)
{
  unsigned int v6; // er15@1
  IOMemoryDescriptor *v7; // r14@1
  int v8; // er13@1
  __int64 v9; // rax@3
  unsigned int v10; // ecx@3
  __int64 v11; // r12@3
  __int64 v12; // rsi@4
  __int64 v13; // r14@4
  unsigned int v15; // [sp+0h] [bp-30h]@1
  unsigned int v16; // [sp+4h] [bp-2Ch]@1

  v6 = a6;
  v7 = (IOMemoryDescriptor *)a5;
  v16 = a4;
  v15 = a3;
  (*(void (**)(void))(*(_QWORD *)this + 2728LL))();
  v8 = -536870183;
  if ( *((_QWORD *)this + 27) )
  {
    if ( !(unsigned __int8)IOService::isInactive(this) )
    {
      LODWORD(v9) = (*(int (__fastcall **)(IOUSBInterfaceUserClientV2 *, _QWORD))(*(_QWORD *)this + 2680LL))(this, a2);
      v11 = v9;
      v8 = -536854431;
      if ( v9 )
      {
        v12 = v6;
        v13 = IOMemoryDescriptor::withAddress(v7, (void *)v6, 2uLL, v10);
        v8 = -536870211;
        if ( v13 )
        {
          v12 = 0LL;
          v8 = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v13 + 496LL))(v13, 0LL);
          if ( !v8 )
          {
            v8 = (*(int (__fastcall **)(__int64, __int64, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v11 + 440LL))(
                   v11,
                   v13,
                   v15,
                   v16,
                   0LL);
            v12 = 0LL;
            (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v13 + 504LL))(v13, 0LL);
          }
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v13 + 40LL))(v13);
        }
        (*(void (__fastcall **)(__int64, __int64))(*(_QWORD *)v11 + 40LL))(v11, v12);
      }
    }
  }
  (*(void (__fastcall **)(IOUSBInterfaceUserClientV2 *))(*(_QWORD *)this + 2720LL))(this);
  return (unsigned int)v8;
}

//----- (000000000002B568) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::WritePipe(IOUSBInterfaceUserClientV2 *this, unsigned __int8 a2, unsigned int a3, unsigned int a4, IOMemoryDescriptor *a5)
{
  IOMemoryDescriptor *v5; // r12@1
  unsigned int v6; // er15@1
  int v7; // er14@1
  __int64 v8; // rax@4
  __int64 v9; // r13@4
  unsigned int v11; // [sp+0h] [bp-2Ch]@2

  v5 = a5;
  v6 = a3;
  v7 = -536870206;
  if ( a5 )
  {
    v11 = a4;
    (*(void (__cdecl **)(IOUSBInterfaceUserClientV2 *))(*(_QWORD *)this + 2728LL))(this);
    v7 = -536870183;
    if ( *((_QWORD *)this + 27) )
    {
      if ( !(unsigned __int8)IOService::isInactive(this) )
      {
        LODWORD(v8) = (*(int (__fastcall **)(IOUSBInterfaceUserClientV2 *, _QWORD))(*(_QWORD *)this + 2680LL))(this, a2);
        v9 = v8;
        v7 = -536854431;
        if ( v8 )
        {
          v7 = (*(int (__fastcall **)(IOMemoryDescriptor *, _QWORD))(*(_QWORD *)v5 + 496LL))(v5, 0LL);
          if ( v7 )
          {
            if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
              kernel_debug(0x52D2408u, (uintptr_t)this, v7, 0LL, 0LL, 0LL);
          }
          else
          {
            v7 = (*(int (__fastcall **)(__int64, IOMemoryDescriptor *, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v9 + 440LL))(
                   v9,
                   v5,
                   v6,
                   v11,
                   0LL);
            (*(void (__fastcall **)(IOMemoryDescriptor *, _QWORD))(*(_QWORD *)v5 + 504LL))(v5, 0LL);
          }
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v9 + 40LL))(v9);
        }
      }
    }
    (*(void (__fastcall **)(IOUSBInterfaceUserClientV2 *))(*(_QWORD *)this + 2720LL))(this);
  }
  return (unsigned int)v7;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (000000000002B686) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::GetPipeProperties(IOUSBInterfaceUserClientV2 *this, unsigned __int8 a2, unsigned __int64 *a3, unsigned __int64 *a4, unsigned __int64 *a5, unsigned __int64 *a6, unsigned __int64 *a7)
{
  unsigned __int64 *v7; // r13@1
  unsigned __int64 *v8; // r14@1
  signed int v9; // er12@1
  __int64 v10; // rax@3
  __int64 v11; // r15@3
  unsigned __int64 *v13; // [sp+8h] [bp-38h]@1
  unsigned __int64 *v14; // [sp+10h] [bp-30h]@1

  v13 = a6;
  v14 = a5;
  v7 = a4;
  v8 = a3;
  (*(void (**)(void))(*(_QWORD *)this + 2728LL))();
  v9 = -536870183;
  if ( *((_QWORD *)this + 27) )
  {
    if ( !(unsigned __int8)IOService::isInactive(this) )
    {
      LODWORD(v10) = (*(int (__fastcall **)(IOUSBInterfaceUserClientV2 *, _QWORD))(*(_QWORD *)this + 2680LL))(this, a2);
      v11 = v10;
      v9 = -536854431;
      if ( v10 )
      {
        if ( v8 )
          *v8 = (unsigned __int8)(*(int (__fastcall **)(__int64))(*(_QWORD *)v10 + 384LL))(v10);
        if ( v7 )
          *v7 = (unsigned __int8)(*(int (__fastcall **)(__int64))(*(_QWORD *)v11 + 400LL))(v11);
        if ( v14 )
          *v14 = (unsigned __int8)(*(int (__fastcall **)(__int64))(*(_QWORD *)v11 + 392LL))(v11);
        if ( v13 )
          *v13 = (unsigned __int16)(*(int (__fastcall **)(__int64))(*(_QWORD *)v11 + 416LL))(v11);
        if ( a7 )
          *a7 = (unsigned __int8)(*(int (__fastcall **)(__int64))(*(_QWORD *)v11 + 424LL))(v11);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v11 + 40LL))(v11);
        v9 = 0;
      }
    }
  }
  (*(void (__fastcall **)(IOUSBInterfaceUserClientV2 *))(*(_QWORD *)this + 2720LL))(this);
  return (unsigned int)v9;
}

//----- (000000000002B7A8) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::GetPipePropertiesV2(IOUSBInterfaceUserClientV2 *this, unsigned __int8 a2, unsigned __int64 *a3, unsigned __int64 *a4, unsigned __int64 *a5, unsigned __int64 *a6, unsigned __int64 *a7, unsigned __int64 *a8, unsigned __int64 *a9, unsigned __int64 *a10)
{
  unsigned __int64 *v10; // r13@1
  unsigned __int64 *v11; // r15@1
  signed int v12; // er12@1
  OSMetaClassBase *v13; // rax@3
  const OSMetaClass *v14; // rdx@3
  OSMetaClassBase *v15; // r14@3
  __int64 v16; // r15@14
  unsigned __int64 *v18; // [sp+8h] [bp-38h]@1
  unsigned __int64 *v19; // [sp+10h] [bp-30h]@1

  v18 = a6;
  v19 = a5;
  v10 = a4;
  v11 = a3;
  (*(void (**)(void))(*(_QWORD *)this + 2728LL))();
  v12 = -536870183;
  if ( *((_QWORD *)this + 27) )
  {
    if ( !(unsigned __int8)IOService::isInactive(this) )
    {
      LODWORD(v13) = (*(int (__fastcall **)(IOUSBInterfaceUserClientV2 *, _QWORD))(*(_QWORD *)this + 2680LL))(this, a2);
      v15 = v13;
      v12 = -536854431;
      if ( v13 )
      {
        if ( v11 )
          *v11 = (unsigned __int8)(*(int (__fastcall **)(OSMetaClassBase *))(*(_QWORD *)v13 + 384LL))(v13);
        if ( v10 )
          *v10 = (unsigned __int8)(*(int (__fastcall **)(OSMetaClassBase *))(*(_QWORD *)v15 + 400LL))(v15);
        if ( v19 )
          *v19 = (unsigned __int8)(*(int (__fastcall **)(OSMetaClassBase *))(*(_QWORD *)v15 + 392LL))(v15);
        if ( v18 )
          *v18 = (unsigned __int16)(*(int (__fastcall **)(OSMetaClassBase *))(*(_QWORD *)v15 + 416LL))(v15);
        if ( a7 )
          *a7 = (unsigned __int8)(*(int (__fastcall **)(OSMetaClassBase *))(*(_QWORD *)v15 + 424LL))(v15);
        v16 = OSMetaClassBase::safeMetaCast(v15, (const OSMetaClassBase *)IOUSBPipeV2::metaClass, v14);
        if ( v16 )
        {
          if ( a8 )
            *a8 = (unsigned __int8)(*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v16 + 656LL))(
                                     v16,
                                     IOUSBPipeV2::metaClass);
          if ( a9 )
            *a9 = (unsigned __int8)(*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v16 + 664LL))(
                                     v16,
                                     IOUSBPipeV2::metaClass);
          if ( a10 )
            *a10 = (unsigned __int16)(*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v16 + 672LL))(
                                       v16,
                                       IOUSBPipeV2::metaClass);
        }
        (*(void (__fastcall **)(OSMetaClassBase *, _QWORD))(*(_QWORD *)v15 + 40LL))(v15, IOUSBPipeV2::metaClass);
        v12 = 0;
      }
    }
  }
  (*(void (__fastcall **)(IOUSBInterfaceUserClientV2 *))(*(_QWORD *)this + 2720LL))(this);
  return (unsigned int)v12;
}
// 474A0: using guessed type _QWORD IOUSBPipeV2::metaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000002B938) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::GetPipePropertiesV3(IOService *this, unsigned __int8 a2, char a3, __int64 a4, __int64 a5)
{
  __int64 v5; // r14@1
  __int64 v6; // r15@1
  signed int v7; // ebx@1
  OSMetaClassBase *v8; // rax@5
  OSMetaClassBase *v9; // r12@5
  const OSMetaClass *v10; // rdx@6
  __int64 v11; // rbx@6

  v5 = a5;
  v6 = a4;
  v7 = -536870206;
  if ( a4 && a3 == 3 )
  {
    (*(void (__cdecl **)(IOService *))(*(_QWORD *)this + 2728LL))(this);
    v7 = -536870183;
    if ( *((_QWORD *)this + 27) )
    {
      if ( !(unsigned __int8)IOService::isInactive(this) )
      {
        LODWORD(v8) = (*(int (__fastcall **)(IOService *, _QWORD))(*(_QWORD *)this + 2680LL))(this, a2);
        v9 = v8;
        v7 = -536854431;
        if ( v8 )
        {
          *(_BYTE *)v6 = 3;
          *(_BYTE *)(v6 + 1) = (*(int (__cdecl **)(_QWORD))(**((_QWORD **)this + 27) + 2232LL))(*((_QWORD *)this + 27));
          *(_BYTE *)(v6 + 2) = (*(int (__fastcall **)(OSMetaClassBase *))(*(_QWORD *)v9 + 384LL))(v9);
          *(_BYTE *)(v6 + 3) = (*(int (__fastcall **)(OSMetaClassBase *))(*(_QWORD *)v9 + 400LL))(v9);
          *(_BYTE *)(v6 + 5) = (*(int (__fastcall **)(OSMetaClassBase *))(*(_QWORD *)v9 + 536LL))(v9);
          *(_BYTE *)(v6 + 6) = (*(int (__fastcall **)(OSMetaClassBase *))(*(_QWORD *)v9 + 544LL))(v9);
          *(_BYTE *)(v6 + 4) = (*(int (__fastcall **)(OSMetaClassBase *))(*(_QWORD *)v9 + 392LL))(v9);
          *(_WORD *)(v6 + 8) = (*(int (__fastcall **)(OSMetaClassBase *))(*(_QWORD *)v9 + 416LL))(v9);
          *(_BYTE *)(v6 + 7) = (*(int (__fastcall **)(OSMetaClassBase *))(*(_QWORD *)v9 + 424LL))(v9);
          *(_BYTE *)(v6 + 12) = 0;
          *(_BYTE *)(v6 + 10) = 0;
          *(_WORD *)(v6 + 13) = 0;
          v11 = OSMetaClassBase::safeMetaCast(v9, (const OSMetaClassBase *)IOUSBPipeV2::metaClass, v10);
          if ( v11 )
          {
            *(_BYTE *)(v6 + 10) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v11 + 656LL))(
                                    v11,
                                    IOUSBPipeV2::metaClass);
            *(_BYTE *)(v6 + 12) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v11 + 664LL))(v11);
            *(_BYTE *)(v6 + 11) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v11 + 616LL))(v11);
            *(_WORD *)(v6 + 13) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v11 + 672LL))(v11);
          }
          (*(void (__fastcall **)(OSMetaClassBase *, _QWORD))(*(_QWORD *)v9 + 40LL))(v9, IOUSBPipeV2::metaClass);
          *(_DWORD *)v5 = 15;
          v7 = 0;
        }
      }
    }
    (*(void (__fastcall **)(IOService *))(*(_QWORD *)this + 2720LL))(this);
  }
  return (unsigned int)v7;
}
// 474A0: using guessed type _QWORD IOUSBPipeV2::metaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000002BAEC) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::GetPipeStatus(IOUSBInterfaceUserClientV2 *this, unsigned __int8 a2)
{
  int v2; // er14@1
  __int64 v3; // rax@3
  __int64 v4; // r15@3

  (*(void (__cdecl **)(IOUSBInterfaceUserClientV2 *))(*(_QWORD *)this + 2728LL))(this);
  v2 = -536870183;
  if ( *((_QWORD *)this + 27) )
  {
    if ( !(unsigned __int8)IOService::isInactive(this) )
    {
      LODWORD(v3) = (*(int (__fastcall **)(IOUSBInterfaceUserClientV2 *, _QWORD))(*(_QWORD *)this + 2680LL))(this, a2);
      v4 = v3;
      v2 = -536854431;
      if ( v3 )
      {
        v2 = (*(int (__fastcall **)(__int64))(*(_QWORD *)v3 + 480LL))(v3);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v4 + 40LL))(v4);
      }
    }
  }
  (*(void (__fastcall **)(IOUSBInterfaceUserClientV2 *))(*(_QWORD *)this + 2720LL))(this);
  return (unsigned int)v2;
}

//----- (000000000002BB72) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::AbortPipe(IOUSBInterfaceUserClientV2 *this, unsigned __int8 a2)
{
  int v2; // er14@1
  __int64 v3; // rax@3
  __int64 v4; // r15@3

  (*(void (__cdecl **)(IOUSBInterfaceUserClientV2 *))(*(_QWORD *)this + 2728LL))(this);
  v2 = -536870183;
  if ( *((_QWORD *)this + 27) )
  {
    if ( !(unsigned __int8)IOService::isInactive(this) )
    {
      LODWORD(v3) = (*(int (__fastcall **)(IOUSBInterfaceUserClientV2 *, _QWORD))(*(_QWORD *)this + 2680LL))(this, a2);
      v4 = v3;
      v2 = -536854431;
      if ( v3 )
      {
        v2 = (*(int (__fastcall **)(__int64))(*(_QWORD *)v3 + 296LL))(v3);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v4 + 40LL))(v4);
      }
    }
  }
  (*(void (__fastcall **)(IOUSBInterfaceUserClientV2 *))(*(_QWORD *)this + 2720LL))(this);
  return (unsigned int)v2;
}

//----- (000000000002BBF8) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::ResetPipe(IOUSBInterfaceUserClientV2 *this, unsigned __int8 a2)
{
  int v2; // er14@1
  __int64 v3; // rax@3
  __int64 v4; // r15@3

  (*(void (__cdecl **)(IOUSBInterfaceUserClientV2 *))(*(_QWORD *)this + 2728LL))(this);
  v2 = -536870183;
  if ( *((_QWORD *)this + 27) )
  {
    if ( !(unsigned __int8)IOService::isInactive(this) )
    {
      LODWORD(v3) = (*(int (__fastcall **)(IOUSBInterfaceUserClientV2 *, _QWORD))(*(_QWORD *)this + 2680LL))(this, a2);
      v4 = v3;
      v2 = -536854431;
      if ( v3 )
      {
        v2 = (*(int (__fastcall **)(__int64))(*(_QWORD *)v3 + 304LL))(v3);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v4 + 40LL))(v4);
      }
    }
  }
  (*(void (__fastcall **)(IOUSBInterfaceUserClientV2 *))(*(_QWORD *)this + 2720LL))(this);
  return (unsigned int)v2;
}

//----- (000000000002BC7E) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::ClearPipeStall(IOUSBInterfaceUserClientV2 *this, unsigned __int8 a2, unsigned __int8 a3)
{
  unsigned __int8 v3; // r14@1
  int v4; // er15@1
  __int64 v5; // rax@3
  __int64 v6; // r12@3

  v3 = a3;
  (*(void (**)(void))(*(_QWORD *)this + 2728LL))();
  v4 = -536870183;
  if ( *((_QWORD *)this + 27) )
  {
    if ( !(unsigned __int8)IOService::isInactive(this) )
    {
      LODWORD(v5) = (*(int (__fastcall **)(IOUSBInterfaceUserClientV2 *, _QWORD))(*(_QWORD *)this + 2680LL))(this, a2);
      v6 = v5;
      v4 = -536854431;
      if ( v5 )
      {
        v4 = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v5 + 488LL))(v5, v3);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v6 + 40LL))(v6);
      }
    }
  }
  (*(void (__fastcall **)(IOUSBInterfaceUserClientV2 *))(*(_QWORD *)this + 2720LL))(this);
  return (unsigned int)v4;
}

//----- (000000000002BD0C) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::SetPipePolicy(IOUSBInterfaceUserClientV2 *this, unsigned __int8 a2, unsigned __int16 a3, unsigned __int8 a4)
{
  unsigned __int8 v4; // r14@1
  unsigned __int16 v5; // r15@1
  int v6; // er12@1
  __int64 v7; // rax@3
  __int64 v8; // r13@3

  v4 = a4;
  v5 = a3;
  (*(void (__cdecl **)(IOUSBInterfaceUserClientV2 *))(*(_QWORD *)this + 2728LL))(this);
  v6 = -536870183;
  if ( *((_QWORD *)this + 27) )
  {
    if ( !(unsigned __int8)IOService::isInactive(this) )
    {
      LODWORD(v7) = (*(int (__fastcall **)(IOUSBInterfaceUserClientV2 *, _QWORD))(*(_QWORD *)this + 2680LL))(this, a2);
      v8 = v7;
      v6 = -536854431;
      if ( v7 )
      {
        v6 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD))(*(_QWORD *)v7 + 496LL))(v7, v5, v4);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v8 + 40LL))(v8);
      }
    }
  }
  (*(void (__fastcall **)(IOUSBInterfaceUserClientV2 *))(*(_QWORD *)this + 2720LL))(this);
  return (unsigned int)v6;
}

//----- (000000000002BDAA) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::ControlRequestOut(IOService *this, uintptr_t arg3, IOMemoryDescriptor *a3, unsigned __int8 a4, unsigned __int16 a5, int a6, __int64 arg3a, task *a8, unsigned int a9, unsigned int a10, task *a11)
{
  __int16 v11; // r14@1
  unsigned __int8 v12; // r13@1
  signed int v13; // er15@6
  uintptr_t v14; // r14@7
  unsigned __int8 v15; // al@7
  uintptr_t v16; // rcx@8
  uintptr_t v17; // r8@8
  uintptr_t v18; // rsi@8
  uintptr_t v19; // rdx@8
  __int64 v20; // rax@11
  __int64 v21; // r15@12
  int v22; // esi@12
  __int64 v23; // r9@12
  __int64 v24; // rax@13
  IOService *v25; // rsi@14
  int v26; // eax@14
  __int64 v27; // r13@29
  int v28; // er14@29
  __int64 v30; // [sp+0h] [bp-40h]@14
  __int64 v31; // [sp+8h] [bp-38h]@13
  unsigned __int16 v32; // [sp+10h] [bp-30h]@1
  unsigned __int8 v33; // [sp+14h] [bp-2Ch]@1

  v11 = a6;
  v32 = a5;
  v33 = a4;
  v12 = (unsigned __int8)a3;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(
      0x52D240Cu,
      (uintptr_t)this,
      a5 | (a4 << 16) | ((unsigned __int8)a3 << 24),
      arg3a | (a6 << 16),
      0LL,
      0LL);
  if ( !*((_QWORD *)this + 27) || (unsigned __int8)IOService::isInactive(this) )
  {
    v13 = -536870183;
    if ( gUSBStackDebugFlags & 2 )
    {
      v14 = *((_QWORD *)this + 27);
      v15 = IOService::isInactive(this);
      if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        v16 = v15;
        v17 = 6LL;
        v18 = (uintptr_t)this;
        v19 = v14;
LABEL_9:
        kernel_debug(0x52D240Cu, v18, v19, v16, v17, 0LL);
        return (unsigned int)v13;
      }
    }
    return (unsigned int)v13;
  }
  if ( a11 )
  {
    LODWORD(v20) = (*(int (__fastcall **)(IOService *, _QWORD))(*(_QWORD *)this + 2680LL))(this, (unsigned __int8)arg3);
    if ( !v20 )
    {
      v13 = -536854431;
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        v19 = 0LL;
        v16 = 0LL;
        v17 = 5LL;
        v18 = (uintptr_t)this;
        goto LABEL_9;
      }
      return (unsigned int)v13;
    }
    v21 = *((_QWORD *)a11 + 2);
    v22 = arg3a;
    v23 = 0LL;
    if ( arg3a )
    {
      v31 = v20;
      v24 = IOMemoryDescriptor::withAddressRange(a8, arg3a, 2uLL, *((_QWORD *)this + 28), a11);
      if ( !v24 )
      {
        v13 = -536870211;
        if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          kernel_debug(0x52D240Cu, (uintptr_t)this, 0LL, arg3a, 2uLL, 0LL);
        goto LABEL_36;
      }
      v25 = 0LL;
      v30 = v24;
      v26 = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v24 + 496LL))(v24, 0LL);
      if ( v26 )
      {
        v13 = v26;
        if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        {
          v25 = this;
          kernel_debug(0x52D240Cu, (uintptr_t)this, v26, 0LL, 3uLL, 0LL);
        }
        (*(void (__fastcall **)(__int64, IOService *))(*(_QWORD *)v30 + 40LL))(v30, v25);
LABEL_36:
        (*(void (**)(void))(*(_QWORD *)v31 + 40LL))();
        return (unsigned int)v13;
      }
      v20 = v31;
      v22 = arg3a;
      v23 = v30;
    }
    v31 = v20;
    *(_BYTE *)(v21 + 80) = v12;
    *(_BYTE *)(v21 + 81) = v33;
    *(_WORD *)(v21 + 82) = v32;
    *(_WORD *)(v21 + 84) = v11;
    *(_WORD *)(v21 + 86) = v22;
    *(_QWORD *)(v21 + 88) = v23;
    *(_DWORD *)(v21 + 68) = v22;
    *(_QWORD *)(v21 + 72) = v23;
    v27 = v23;
    v28 = (*(int (__fastcall **)(__int64, signed __int64, _QWORD, _QWORD))(*(_QWORD *)v20 + 448LL))(
            v20,
            v21 + 80,
            a9,
            a10);
    v13 = 0;
    if ( v28 )
    {
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D240Cu, (uintptr_t)this, v28, 0LL, 4uLL, 0LL);
      if ( v27 )
      {
        (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v27 + 504LL))(v27, 0LL);
        (*(void (**)(void))(*(_QWORD *)v27 + 40LL))();
      }
      v13 = v28;
    }
    goto LABEL_36;
  }
  v13 = -536870206;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
  {
    v16 = v32;
    v19 = v33;
    v18 = v12;
    v17 = 1LL;
    goto LABEL_9;
  }
  return (unsigned int)v13;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (000000000002C0EE) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::ControlRequestOut(IOUSBInterfaceUserClientV2 *this, IOUSBInterfaceUserClientV2 *a2, char a3, char a4, __int16 a5, int a6, unsigned int a7, unsigned int a8, const void *a9, unsigned int a10)
{
  __int16 v10; // r14@1
  char v11; // r12@1
  char v12; // r13@1
  unsigned __int8 v13; // r15@1
  int v14; // er14@6
  uintptr_t v15; // r15@7
  unsigned __int8 v16; // al@7
  uintptr_t v17; // rcx@8
  uintptr_t v18; // r8@8
  uintptr_t v19; // rsi@8
  uintptr_t v20; // rdx@8
  __int64 v21; // rax@10
  __int64 v22; // r15@10
  IOUSBInterfaceUserClientV2 *v23; // rsi@11
  __int16 v25; // [sp+Ch] [bp-44h]@1
  char v26; // [sp+10h] [bp-40h]@11
  char v27; // [sp+11h] [bp-3Fh]@11
  __int16 v28; // [sp+12h] [bp-3Eh]@11
  __int16 v29; // [sp+14h] [bp-3Ch]@11
  __int16 v30; // [sp+16h] [bp-3Ah]@11
  const void *v31; // [sp+18h] [bp-38h]@11
  int v32; // [sp+20h] [bp-30h]@11

  v25 = a6;
  v10 = a5;
  v11 = a4;
  v12 = a3;
  v13 = (unsigned __int8)a2;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
  {
    a2 = this;
    kernel_debug(
      0x52D240Cu,
      (uintptr_t)this,
      (unsigned __int16)a5 | ((unsigned __int8)a4 << 16) | ((unsigned __int8)a3 << 24),
      a10 | (a6 << 16),
      7uLL,
      0LL);
  }
  (*(void (__fastcall **)(IOUSBInterfaceUserClientV2 *, IOUSBInterfaceUserClientV2 *))(*(_QWORD *)this + 2728LL))(
    this,
    a2);
  if ( *((_QWORD *)this + 27) && !(unsigned __int8)IOService::isInactive(this) )
  {
    LODWORD(v21) = (*(int (__fastcall **)(IOUSBInterfaceUserClientV2 *, _QWORD))(*(_QWORD *)this + 2680LL))(this, v13);
    v22 = v21;
    if ( v21 )
    {
      v26 = v12;
      v27 = v11;
      v28 = v10;
      v29 = v25;
      v30 = a10;
      v31 = a9;
      v32 = (*(_BYTE *)(*((_QWORD *)this + 36) + 180LL) == 0) << 30;
      v23 = (IOUSBInterfaceUserClientV2 *)&v26;
      v14 = (*(int (__fastcall **)(__int64, char *, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v21 + 456LL))(
              v21,
              &v26,
              a7,
              a8,
              0LL);
      BYTE3(v32) &= 0xBFu;
      if ( v14 && gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        v23 = this;
        kernel_debug(0x52D240Cu, (uintptr_t)this, v14, 0LL, 8uLL, 0LL);
      }
      (*(void (__fastcall **)(__int64, IOUSBInterfaceUserClientV2 *))(*(_QWORD *)v22 + 40LL))(v22, v23);
    }
    else
    {
      v14 = -536854431;
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        v20 = 0LL;
        v17 = 0LL;
        v18 = 9LL;
        v19 = (uintptr_t)this;
        goto LABEL_9;
      }
    }
  }
  else
  {
    v14 = -536870183;
    if ( gUSBStackDebugFlags & 2 )
    {
      v15 = *((_QWORD *)this + 27);
      v16 = IOService::isInactive(this);
      if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        v17 = v16;
        v18 = 10LL;
        v19 = (uintptr_t)this;
        v20 = v15;
LABEL_9:
        kernel_debug(0x52D240Cu, v19, v20, v17, v18, 0LL);
        goto LABEL_19;
      }
    }
  }
LABEL_19:
  (*(void (__fastcall **)(IOUSBInterfaceUserClientV2 *))(*(_QWORD *)this + 2720LL))(this);
  return (unsigned int)v14;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (000000000002C2F8) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::ControlRequestOut(IOUSBInterfaceUserClientV2 *this, IOUSBInterfaceUserClientV2 *a2, char a3, char a4, __int16 a5, int a6, unsigned int a7, unsigned int a8, IOMemoryDescriptor *a9)
{
  char v9; // r15@1
  char v10; // r13@1
  unsigned __int8 v11; // r14@1
  int v12; // eax@1
  unsigned __int64 v13; // rax@3
  int v14; // er14@7
  uintptr_t v15; // r15@8
  unsigned __int8 v16; // al@8
  uintptr_t v17; // rcx@9
  uintptr_t v18; // r8@9
  uintptr_t v19; // rsi@9
  uintptr_t v20; // rdx@9
  __int64 v21; // rax@14
  __int64 v22; // r15@17
  __int64 v24; // [sp+0h] [bp-50h]@14
  __int16 v25; // [sp+8h] [bp-48h]@2
  int v26; // [sp+Ch] [bp-44h]@2
  char v27; // [sp+10h] [bp-40h]@22
  char v28; // [sp+11h] [bp-3Fh]@22
  __int16 v29; // [sp+12h] [bp-3Eh]@22
  __int16 v30; // [sp+14h] [bp-3Ch]@22
  __int16 v31; // [sp+16h] [bp-3Ah]@22
  IOMemoryDescriptor *v32; // [sp+18h] [bp-38h]@22
  int v33; // [sp+20h] [bp-30h]@22

  v9 = a4;
  v10 = a3;
  v11 = (unsigned __int8)a2;
  v12 = gUSBStackDebugFlags & 2;
  if ( a9 )
  {
    v25 = a5;
    v26 = a6;
    if ( v12 )
    {
      LODWORD(v13) = (*(int (**)(void))(*(_QWORD *)a9 + 456LL))();
      if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        a2 = this;
        kernel_debug(
          0x52D240Cu,
          (uintptr_t)this,
          (unsigned __int16)v25 | ((unsigned __int8)v9 << 16) | ((unsigned __int8)v10 << 24),
          (v26 << 16) | v13,
          0xCuLL,
          0LL);
      }
    }
    (*(void (__fastcall **)(IOUSBInterfaceUserClientV2 *, IOUSBInterfaceUserClientV2 *))(*(_QWORD *)this + 2728LL))(
      this,
      a2);
    if ( *((_QWORD *)this + 27) && !(unsigned __int8)IOService::isInactive(this) )
    {
      LODWORD(v21) = (*(int (__fastcall **)(IOUSBInterfaceUserClientV2 *, _QWORD))(*(_QWORD *)this + 2680LL))(this, v11);
      v24 = v21;
      if ( v21 )
      {
        v14 = (*(int (__fastcall **)(IOMemoryDescriptor *, _QWORD))(*(_QWORD *)a9 + 496LL))(a9, 0LL);
        if ( v14 )
        {
          if ( gUSBStackDebugFlags & 2 )
          {
            v22 = v24;
            if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
              kernel_debug(0x52D240Cu, (uintptr_t)this, v14, 0LL, 0xEuLL, 0LL);
          }
          else
          {
            v22 = v24;
          }
        }
        else
        {
          v27 = v10;
          v28 = v9;
          v29 = v25;
          v30 = v26;
          v31 = (*(int (__fastcall **)(IOMemoryDescriptor *))(*(_QWORD *)a9 + 456LL))(a9);
          v32 = a9;
          v33 = (*(_BYTE *)(*((_QWORD *)this + 36) + 180LL) == 0) << 30;
          v22 = v24;
          v14 = (*(int (__fastcall **)(__int64, char *, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v24 + 448LL))(
                  v24,
                  &v27,
                  a7,
                  a8,
                  0LL);
          BYTE3(v33) &= 0xBFu;
          if ( v14 && gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
            kernel_debug(0x52D240Cu, (uintptr_t)this, v14, 0LL, 0xDuLL, 0LL);
          (*(void (__fastcall **)(IOMemoryDescriptor *, _QWORD))(*(_QWORD *)a9 + 504LL))(a9, 0LL);
        }
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v22 + 40LL))(v22);
        goto LABEL_29;
      }
      v14 = -536854431;
      if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
      {
LABEL_29:
        (*(void (__fastcall **)(IOUSBInterfaceUserClientV2 *))(*(_QWORD *)this + 2720LL))(this);
        return (unsigned int)v14;
      }
      v20 = 0LL;
      v17 = 0LL;
      v18 = 15LL;
      v19 = (uintptr_t)this;
    }
    else
    {
      v14 = -536870183;
      if ( !(gUSBStackDebugFlags & 2) )
        goto LABEL_29;
      v15 = *((_QWORD *)this + 27);
      v16 = IOService::isInactive(this);
      if ( !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
        goto LABEL_29;
      v17 = v16;
      v18 = 16LL;
      v19 = (uintptr_t)this;
      v20 = v15;
    }
    kernel_debug(0x52D240Cu, v19, v20, v17, v18, 0LL);
    goto LABEL_29;
  }
  v14 = -536870206;
  if ( v12 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D240Cu, (uintptr_t)this, 0LL, 0LL, 0xBuLL, 0LL);
  return (unsigned int)v14;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (000000000002C5F6) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::ControlRequestIn(IOService *this, uintptr_t arg3, IOMemoryDescriptor *a3, unsigned __int8 a4, unsigned __int16 a5, int a6, __int64 arg3a, task *a8, unsigned int a9, unsigned int a10, task *a11)
{
  __int16 v11; // r14@1
  unsigned __int8 v12; // r13@1
  signed int v13; // er15@6
  uintptr_t v14; // r14@7
  unsigned __int8 v15; // al@7
  uintptr_t v16; // rcx@8
  uintptr_t v17; // r8@8
  uintptr_t v18; // rsi@8
  uintptr_t v19; // rdx@8
  __int64 v20; // rax@11
  __int64 v21; // r15@12
  int v22; // esi@12
  __int64 v23; // r9@12
  __int64 v24; // rax@13
  IOService *v25; // rsi@14
  int v26; // eax@14
  __int64 v27; // r13@29
  int v28; // er14@29
  __int64 v30; // [sp+0h] [bp-40h]@14
  __int64 v31; // [sp+8h] [bp-38h]@13
  unsigned __int16 v32; // [sp+10h] [bp-30h]@1
  unsigned __int8 v33; // [sp+14h] [bp-2Ch]@1

  v11 = a6;
  v32 = a5;
  v33 = a4;
  v12 = (unsigned __int8)a3;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(
      0x52D2410u,
      (uintptr_t)this,
      a5 | (a4 << 16) | ((unsigned __int8)a3 << 24),
      arg3a | (a6 << 16),
      0LL,
      0LL);
  if ( !*((_QWORD *)this + 27) || (unsigned __int8)IOService::isInactive(this) )
  {
    v13 = -536870183;
    if ( gUSBStackDebugFlags & 2 )
    {
      v14 = *((_QWORD *)this + 27);
      v15 = IOService::isInactive(this);
      if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        v16 = v15;
        v17 = 6LL;
        v18 = (uintptr_t)this;
        v19 = v14;
LABEL_9:
        kernel_debug(0x52D2410u, v18, v19, v16, v17, 0LL);
        return (unsigned int)v13;
      }
    }
    return (unsigned int)v13;
  }
  if ( a11 )
  {
    LODWORD(v20) = (*(int (__fastcall **)(IOService *, _QWORD))(*(_QWORD *)this + 2680LL))(this, (unsigned __int8)arg3);
    if ( !v20 )
    {
      v13 = -536854431;
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        v19 = 0LL;
        v16 = 0LL;
        v17 = 5LL;
        v18 = (uintptr_t)this;
        goto LABEL_9;
      }
      return (unsigned int)v13;
    }
    v21 = *((_QWORD *)a11 + 2);
    v22 = arg3a;
    v23 = 0LL;
    if ( arg3a )
    {
      v31 = v20;
      v24 = IOMemoryDescriptor::withAddressRange(a8, arg3a, 1uLL, *((_QWORD *)this + 28), a11);
      if ( !v24 )
      {
        v13 = -536870211;
        if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          kernel_debug(0x52D2410u, (uintptr_t)this, 0LL, arg3a, 2uLL, 0LL);
        goto LABEL_36;
      }
      v25 = 0LL;
      v30 = v24;
      v26 = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v24 + 496LL))(v24, 0LL);
      if ( v26 )
      {
        v13 = v26;
        if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        {
          v25 = this;
          kernel_debug(0x52D2410u, (uintptr_t)this, v26, 0LL, 3uLL, 0LL);
        }
        (*(void (__fastcall **)(__int64, IOService *))(*(_QWORD *)v30 + 40LL))(v30, v25);
LABEL_36:
        (*(void (**)(void))(*(_QWORD *)v31 + 40LL))();
        return (unsigned int)v13;
      }
      v20 = v31;
      v22 = arg3a;
      v23 = v30;
    }
    v31 = v20;
    *(_BYTE *)(v21 + 80) = v12;
    *(_BYTE *)(v21 + 81) = v33;
    *(_WORD *)(v21 + 82) = v32;
    *(_WORD *)(v21 + 84) = v11;
    *(_WORD *)(v21 + 86) = v22;
    *(_QWORD *)(v21 + 88) = v23;
    *(_DWORD *)(v21 + 68) = v22;
    *(_QWORD *)(v21 + 72) = v23;
    v27 = v23;
    v28 = (*(int (__fastcall **)(__int64, signed __int64, _QWORD, _QWORD))(*(_QWORD *)v20 + 448LL))(
            v20,
            v21 + 80,
            a9,
            a10);
    v13 = 0;
    if ( v28 )
    {
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D2410u, (uintptr_t)this, v28, 0LL, 4uLL, 0LL);
      if ( v27 )
      {
        (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v27 + 504LL))(v27, 0LL);
        (*(void (**)(void))(*(_QWORD *)v27 + 40LL))();
      }
      v13 = v28;
    }
    goto LABEL_36;
  }
  v13 = -536870206;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
  {
    v16 = v32;
    v19 = v33;
    v18 = v12;
    v17 = 1LL;
    goto LABEL_9;
  }
  return (unsigned int)v13;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (000000000002C93A) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::ControlRequestIn(IOUSBInterfaceUserClientV2 *this, IOUSBInterfaceUserClientV2 *a2, char a3, char a4, __int16 a5, int a6, unsigned int a7, unsigned int a8, void *a9, unsigned int *a10)
{
  __int16 v10; // bx@1
  char v11; // r13@1
  char v12; // r15@1
  int v13; // ebx@6
  uintptr_t v14; // r15@7
  unsigned __int8 v15; // al@7
  uintptr_t v16; // rcx@8
  uintptr_t v17; // r8@8
  uintptr_t v18; // rsi@8
  uintptr_t v19; // rdx@8
  __int64 v20; // rax@10
  IOUSBInterfaceUserClientV2 *v21; // rsi@11
  __int64 v22; // r13@11
  unsigned int v23; // er15@11
  int v24; // eax@11
  unsigned __int8 v26; // [sp+8h] [bp-48h]@1
  __int16 v27; // [sp+Ch] [bp-44h]@1
  char v28; // [sp+10h] [bp-40h]@11
  char v29; // [sp+11h] [bp-3Fh]@11
  __int16 v30; // [sp+12h] [bp-3Eh]@11
  __int16 v31; // [sp+14h] [bp-3Ch]@11
  __int16 v32; // [sp+16h] [bp-3Ah]@11
  void *v33; // [sp+18h] [bp-38h]@11
  unsigned int v34; // [sp+20h] [bp-30h]@11

  v27 = a6;
  v10 = a5;
  v11 = a4;
  v12 = a3;
  v26 = (unsigned __int8)a2;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
  {
    a2 = this;
    kernel_debug(
      0x52D2410u,
      (uintptr_t)this,
      (unsigned __int16)a5 | ((unsigned __int8)a4 << 16) | ((unsigned __int8)a3 << 24),
      *a10 | (a6 << 16),
      7uLL,
      0LL);
  }
  (*(void (__fastcall **)(IOUSBInterfaceUserClientV2 *, IOUSBInterfaceUserClientV2 *))(*(_QWORD *)this + 2728LL))(
    this,
    a2);
  if ( *((_QWORD *)this + 27) && !(unsigned __int8)IOService::isInactive(this) )
  {
    LODWORD(v20) = (*(int (__fastcall **)(IOUSBInterfaceUserClientV2 *, _QWORD))(*(_QWORD *)this + 2680LL))(this, v26);
    if ( v20 )
    {
      v28 = v12;
      v29 = v11;
      v30 = v10;
      v31 = v27;
      v32 = *(_WORD *)a10;
      v33 = a9;
      v34 = (*(_BYTE *)(*((_QWORD *)this + 36) + 180LL) == 0) << 30;
      v21 = (IOUSBInterfaceUserClientV2 *)&v28;
      v22 = v20;
      v13 = (*(int (__fastcall **)(__int64, char *, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v20 + 456LL))(
              v20,
              &v28,
              a7,
              a8,
              0LL);
      v23 = v34 & 0xBFFFFFFF;
      v34 &= 0xBFFFFFFF;
      v24 = gUSBStackDebugFlags & 2;
      if ( v13 != -536870168 && v13 )
      {
        v23 = 0;
        if ( v24 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        {
          v23 = 0;
          v21 = this;
          kernel_debug(0x52D2410u, (uintptr_t)this, v13, 0LL, 8uLL, 0LL);
        }
      }
      else if ( v24 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        v21 = this;
        kernel_debug(0x52D2410u, (uintptr_t)this, v23, v13, 0x11uLL, 0LL);
        v23 = v34;
      }
      *a10 = v23;
      (*(void (__fastcall **)(__int64, IOUSBInterfaceUserClientV2 *))(*(_QWORD *)v22 + 40LL))(v22, v21);
    }
    else
    {
      v13 = -536854431;
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        v19 = 0LL;
        v16 = 0LL;
        v17 = 9LL;
        v18 = (uintptr_t)this;
        goto LABEL_9;
      }
    }
  }
  else
  {
    v13 = -536870183;
    if ( gUSBStackDebugFlags & 2 )
    {
      v14 = *((_QWORD *)this + 27);
      v15 = IOService::isInactive(this);
      if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        v16 = v15;
        v17 = 10LL;
        v18 = (uintptr_t)this;
        v19 = v14;
LABEL_9:
        kernel_debug(0x52D2410u, v18, v19, v16, v17, 0LL);
        goto LABEL_23;
      }
    }
  }
LABEL_23:
  (*(void (__fastcall **)(IOUSBInterfaceUserClientV2 *))(*(_QWORD *)this + 2720LL))(this);
  return (unsigned int)v13;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (000000000002CB98) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::ControlRequestIn(IOUSBInterfaceUserClientV2 *this, IOUSBInterfaceUserClientV2 *a2, char a3, char a4, __int16 a5, int a6, unsigned int a7, unsigned int a8, IOMemoryDescriptor *a9, unsigned int *a10)
{
  char v10; // r15@1
  char v11; // r14@1
  unsigned __int8 v12; // r13@1
  int v13; // eax@1
  unsigned __int64 v14; // rax@3
  int v15; // er12@7
  uintptr_t v16; // r14@8
  unsigned __int8 v17; // al@8
  uintptr_t v18; // rcx@9
  uintptr_t v19; // r8@9
  uintptr_t v20; // rsi@9
  uintptr_t v21; // rdx@9
  __int64 v22; // rax@14
  __int64 v23; // r15@17
  int *v24; // rcx@22
  unsigned int v25; // eax@27
  __int64 v27; // [sp+8h] [bp-58h]@14
  __int16 v28; // [sp+14h] [bp-4Ch]@2
  __int16 v29; // [sp+18h] [bp-48h]@2
  int v30; // [sp+1Ch] [bp-44h]@2
  char v31; // [sp+20h] [bp-40h]@22
  char v32; // [sp+21h] [bp-3Fh]@22
  __int16 v33; // [sp+22h] [bp-3Eh]@22
  __int16 v34; // [sp+24h] [bp-3Ch]@22
  __int16 v35; // [sp+26h] [bp-3Ah]@22
  IOMemoryDescriptor *v36; // [sp+28h] [bp-38h]@22
  uintptr_t arg2; // [sp+30h] [bp-30h]@22

  v10 = a4;
  v11 = a3;
  v12 = (unsigned __int8)a2;
  v13 = gUSBStackDebugFlags & 2;
  if ( a9 )
  {
    v29 = a5;
    v30 = a6;
    v28 = *(_WORD *)a10;
    if ( v13 )
    {
      LODWORD(v14) = (*(int (**)(void))(*(_QWORD *)a9 + 456LL))();
      if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        a2 = this;
        kernel_debug(
          0x52D2410u,
          (uintptr_t)this,
          (unsigned __int16)v29 | ((unsigned __int8)v10 << 16) | ((unsigned __int8)v11 << 24),
          (v30 << 16) | v14,
          0xCuLL,
          0LL);
      }
    }
    (*(void (__fastcall **)(IOUSBInterfaceUserClientV2 *, IOUSBInterfaceUserClientV2 *))(*(_QWORD *)this + 2728LL))(
      this,
      a2);
    if ( *((_QWORD *)this + 27) && !(unsigned __int8)IOService::isInactive(this) )
    {
      LODWORD(v22) = (*(int (__fastcall **)(IOUSBInterfaceUserClientV2 *, _QWORD))(*(_QWORD *)this + 2680LL))(this, v12);
      v27 = v22;
      if ( v22 )
      {
        v15 = (*(int (__fastcall **)(IOMemoryDescriptor *, _QWORD))(*(_QWORD *)a9 + 496LL))(a9, 0LL);
        if ( v15 )
        {
          if ( gUSBStackDebugFlags & 2 )
          {
            v23 = v27;
            if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
              kernel_debug(0x52D2410u, (uintptr_t)this, v15, 0LL, 0xEuLL, 0LL);
          }
          else
          {
            v23 = v27;
          }
        }
        else
        {
          v31 = v11;
          v32 = v10;
          v33 = v29;
          v34 = v30;
          v35 = v28;
          v36 = a9;
          LODWORD(arg2) = (*(_BYTE *)(*((_QWORD *)this + 36) + 180LL) == 0) << 30;
          v23 = v27;
          v15 = (*(int (__fastcall **)(__int64, char *, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v27 + 448LL))(
                  v27,
                  &v31,
                  a7,
                  a8,
                  0LL);
          BYTE3(arg2) &= 0xBFu;
          v24 = &gUSBStackDebugFlags;
          if ( !v15 )
            goto LABEL_39;
          if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          {
            kernel_debug(0x52D2410u, (uintptr_t)this, v15, 0LL, 0xDuLL, 0LL);
            v24 = &gUSBStackDebugFlags;
          }
          if ( v15 == -536870168 || (v25 = 0, !v15) )
          {
LABEL_39:
            if ( *(_BYTE *)v24 & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
              kernel_debug(0x52D2410u, (uintptr_t)this, (unsigned int)arg2, v15, 0x12uLL, 0LL);
            v25 = arg2;
          }
          *a10 = v25;
          (*(void (__fastcall **)(IOMemoryDescriptor *, _QWORD))(*(_QWORD *)a9 + 504LL))(a9, 0LL);
        }
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v23 + 40LL))(v23);
        goto LABEL_35;
      }
      v15 = -536854431;
      if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
      {
LABEL_35:
        (*(void (__fastcall **)(IOUSBInterfaceUserClientV2 *))(*(_QWORD *)this + 2720LL))(this);
        return (unsigned int)v15;
      }
      v21 = 0LL;
      v18 = 0LL;
      v19 = 15LL;
      v20 = (uintptr_t)this;
    }
    else
    {
      v15 = -536870183;
      if ( !(gUSBStackDebugFlags & 2) )
        goto LABEL_35;
      v16 = *((_QWORD *)this + 27);
      v17 = IOService::isInactive(this);
      if ( !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
        goto LABEL_35;
      v18 = v17;
      v19 = 16LL;
      v20 = (uintptr_t)this;
      v21 = v16;
    }
    kernel_debug(0x52D2410u, v20, v21, v18, v19, 0LL);
    goto LABEL_35;
  }
  v15 = -536870206;
  if ( v13 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D2410u, (uintptr_t)this, 0LL, 0LL, 0xBuLL, 0LL);
  return (unsigned int)v15;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (000000000002CEE4) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::DoIsochPipeAsync(IOService *this, __int64 a2, const void *a3, int a4, unsigned int a5)
{
  unsigned int v5; // er13@1
  const void *v6; // rbx@1
  __int64 v7; // r12@1
  uintptr_t v8; // r14@1
  signed int v9; // ebx@6
  int *v10; // r13@6
  uintptr_t v11; // r15@7
  unsigned __int8 v12; // al@7
  __int64 v13; // rax@9
  task *v14; // r8@9
  IOService *v15; // rsi@10
  uintptr_t v16; // rax@10
  int v17; // eax@11
  task *v18; // r8@11
  uintptr_t v19; // r15@13
  uintptr_t v20; // rcx@14
  uintptr_t v21; // r8@14
  uintptr_t v22; // rdx@14
  uintptr_t v23; // rax@23
  int v24; // eax@24
  void *v25; // rax@35
  const void *v26; // rdi@36
  __int64 v27; // rbx@36
  __int64 v28; // rax@36
  int v29; // eax@37
  __int64 v30; // rdx@46
  __int64 v31; // rcx@47
  uintptr_t arg2; // [sp+8h] [bp-78h]@24
  char v34; // [sp+10h] [bp-70h]@22
  uintptr_t v35; // [sp+18h] [bp-68h]@10
  uintptr_t v36; // [sp+18h] [bp-68h]@23
  uintptr_t v37; // [sp+20h] [bp-60h]@11
  signed int v38; // [sp+2Ch] [bp-54h]@14
  __int64 v39; // [sp+30h] [bp-50h]@10
  int v40; // [sp+38h] [bp-48h]@1
  signed __int64 v41; // [sp+38h] [bp-48h]@36
  uintptr_t v42; // [sp+40h] [bp-40h]@36
  __int64 (__fastcall *v43)(OSMetaClassBase *, __int64, const OSMetaClass *); // [sp+48h] [bp-38h]@36
  __int64 v44; // [sp+50h] [bp-30h]@36

  v5 = a5;
  v40 = a4;
  v6 = a3;
  v7 = a2;
  v8 = (uintptr_t)this;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D2415u, (uintptr_t)this, *(_QWORD *)(a2 + 16), *(_QWORD *)(a2 + 24), a5, 0LL);
  if ( !*((_QWORD *)this + 27) || (unsigned __int8)IOService::isInactive(this) )
  {
    v9 = -536870183;
    v10 = &gUSBStackDebugFlags;
    if ( gUSBStackDebugFlags & 2 )
    {
      v11 = *((_QWORD *)this + 27);
      v12 = IOService::isInactive(this);
      if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D2414u, (uintptr_t)this, v11, v12, 6uLL, 0LL);
    }
    goto LABEL_56;
  }
  LODWORD(v13) = (*(int (__fastcall **)(IOService *, _QWORD))(*(_QWORD *)this + 2680LL))(this, *(_BYTE *)a2);
  if ( v13 )
  {
    v39 = v13;
    v35 = *(_QWORD *)(a2 + 32);
    v15 = *(IOService **)(a2 + 16);
    v16 = IOMemoryDescriptor::withAddressRange(
            *(IOMemoryDescriptor **)(v7 + 8),
            (unsigned __int64)v15,
            v5,
            *((_QWORD *)this + 28),
            v14);
    if ( v16 )
    {
      v15 = 0LL;
      v37 = v16;
      v17 = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)v16 + 496LL))(v16, 0LL);
      if ( !v17 )
      {
        v15 = (IOService *)(8 * (_DWORD)v35 & 0xFFFFFFF8);
        v36 = 8 * (_DWORD)v35 & 0xFFFFFFF8;
        v23 = IOMemoryDescriptor::withAddressRange(
                *(IOMemoryDescriptor **)(v7 + 40),
                (unsigned __int64)v15,
                3uLL,
                *((_QWORD *)this + 28),
                v18);
        if ( v23 )
        {
          v15 = 0LL;
          arg2 = v23;
          v24 = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)v23 + 496LL))(v23, 0LL);
          if ( !v24 )
          {
            LODWORD(v25) = IOMalloc(v36 + 128);
            v34 = 1;
            if ( v25 )
            {
              v26 = v6;
              v27 = (__int64)v25;
              bcopy(v26, v25, 0x40uLL);
              *(_DWORD *)(v27 + 64) = v40;
              *(_QWORD *)(v27 + 72) = v36;
              *(_QWORD *)(v27 + 80) = *(_QWORD *)(v7 + 40);
              *(_QWORD *)(v27 + 104) = *(_QWORD *)(v7 + 32);
              *(_QWORD *)(v27 + 88) = v37;
              *(_QWORD *)(v27 + 96) = arg2;
              *(_QWORD *)(v27 + 112) = *(_QWORD *)(v7 + 24);
              *(_QWORD *)(v27 + 120) = (unsigned __int64)(*(_BYTE *)(*(_QWORD *)(v8 + 288) + 180LL) == 0) << 30;
              v41 = v27 + 128;
              (*(void (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)arg2 + 480LL))(arg2, 0LL);
              v42 = v8;
              v43 = IOUSBInterfaceUserClientV2::IsoReqComplete;
              v44 = v27;
              v28 = *(_QWORD *)v39;
              if ( v5 == 2 )
              {
                v15 = (IOService *)v37;
                v29 = (*(int (__fastcall **)(__int64, uintptr_t, _QWORD, _QWORD, signed __int64, __int64 *))(v28 + 344))(
                        v39,
                        v37,
                        *(_QWORD *)(v7 + 24),
                        *(_DWORD *)(v7 + 32),
                        v41,
                        &v42);
              }
              else
              {
                v15 = (IOService *)v37;
                v29 = (*(int (__fastcall **)(__int64, uintptr_t, _QWORD, _QWORD, signed __int64, __int64 *))(v28 + 336))(
                        v39,
                        v37,
                        *(_QWORD *)(v7 + 24),
                        *(_DWORD *)(v7 + 32),
                        v41,
                        &v42);
              }
              v38 = v29;
            }
            else
            {
              v38 = -536870211;
            }
            LOBYTE(v7) = 1;
            v10 = &gUSBStackDebugFlags;
            v19 = arg2;
            goto LABEL_46;
          }
          LOBYTE(v7) = 1;
          v10 = &gUSBStackDebugFlags;
          if ( !(gUSBStackDebugFlags & 2) )
          {
            v38 = v24;
            v34 = 0;
            v19 = arg2;
            goto LABEL_46;
          }
          v19 = arg2;
          if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          {
            v38 = v24;
            v34 = 0;
            v15 = this;
            kernel_debug(0x52D2414u, (uintptr_t)this, arg2, v24, 4uLL, 0LL);
            goto LABEL_46;
          }
          v38 = v24;
        }
        else
        {
          LOBYTE(v7) = 1;
          v10 = &gUSBStackDebugFlags;
          if ( !(gUSBStackDebugFlags & 2) )
          {
            v34 = 0;
            v38 = -536870211;
            v19 = 0LL;
            goto LABEL_46;
          }
          v38 = -536870211;
          v19 = 0LL;
          if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          {
            v19 = 0LL;
            v15 = this;
            kernel_debug(0x52D2414u, (uintptr_t)this, v36, 0xFFFFFFFFE00002BDLL, 3uLL, 0LL);
          }
        }
        v34 = 0;
        goto LABEL_46;
      }
      v10 = &gUSBStackDebugFlags;
      if ( gUSBStackDebugFlags & 2 )
      {
        v19 = 0LL;
        if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        {
          v38 = v17;
          v20 = v17;
          v19 = 0LL;
          v21 = 2LL;
          v15 = this;
          v22 = v37;
          goto LABEL_21;
        }
        v34 = 0;
        v38 = v17;
        v7 = 0LL;
LABEL_46:
        (*(void (**)(void))(*(_QWORD *)v39 + 40LL))();
        v9 = 0;
        if ( v38 )
        {
          v31 = v7;
          if ( v37 )
          {
            if ( (_BYTE)v7 )
            {
              v15 = 0LL;
              (*(void (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)v37 + 504LL))(v37, 0LL);
            }
            (*(void (**)(void))(*(_QWORD *)v37 + 40LL))();
          }
          if ( v19 )
          {
            if ( v34 )
            {
              v15 = 0LL;
              (*(void (__fastcall **)(uintptr_t, _QWORD, __int64, __int64))(*(_QWORD *)v19 + 504LL))(v19, 0LL, v30, v31);
            }
            (*(void (__fastcall **)(uintptr_t, IOService *, __int64, __int64))(*(_QWORD *)v19 + 40LL))(
              v19,
              v15,
              v30,
              v31);
          }
          v9 = v38;
        }
        goto LABEL_56;
      }
      v34 = 0;
      v38 = v17;
    }
    else
    {
      v10 = &gUSBStackDebugFlags;
      if ( gUSBStackDebugFlags & 2 )
      {
        v38 = -536870211;
        v37 = 0LL;
        v19 = 0LL;
        if ( !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
        {
LABEL_22:
          v34 = 0;
          v7 = 0LL;
          goto LABEL_46;
        }
        v22 = *(_QWORD *)(v7 + 16);
        v19 = 0LL;
        v20 = -536870211LL;
        v21 = 1LL;
        v15 = this;
LABEL_21:
        kernel_debug(0x52D2414u, (uintptr_t)v15, v22, v20, v21, 0LL);
        goto LABEL_22;
      }
      v34 = 0;
      v38 = -536870211;
      v37 = 0LL;
    }
    v7 = 0LL;
    v19 = 0LL;
    goto LABEL_46;
  }
  v9 = -536854431;
  v10 = &gUSBStackDebugFlags;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D2414u, (uintptr_t)this, 0xFFFFFFFFE0004061LL, 0LL, 5uLL, 0LL);
LABEL_56:
  if ( *(_BYTE *)v10 & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D2416u, v8, v9, 0LL, 0LL, 0LL);
  return (unsigned int)v9;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 7D250: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (000000000002D400) ----------------------------------------------------
int __fastcall IOUSBInterfaceUserClientV2::DoLowLatencyIsochPipeAsyncGated(IOUSBInterfaceUserClientV2 *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  void *v6; // r14@1
  void *v7; // r15@1
  __int64 v8; // rax@1
  int result; // eax@2

  v6 = a4;
  v7 = a3;
  v8 = OSMetaClassBase::safeMetaCast(
         this,
         (const OSMetaClassBase *)&IOUSBInterfaceUserClientV2::gMetaClass,
         (const OSMetaClass *)a3);
  if ( v8 )
    result = (*(int (__fastcall **)(__int64, OSObject *, void *, void *))(*(_QWORD *)v8 + 2808LL))(v8, a2, v7, v6);
  else
    result = -536870206;
  return result;
}
// 49928: using guessed type _QWORD IOUSBInterfaceUserClientV2::gMetaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000002D458) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::DoLowLatencyIsochPipeAsync(IOService *this, __int64 a2, __int64 a3, uintptr_t a4)
{
  uintptr_t v4; // r12@1
  __int64 v5; // r15@1
  uintptr_t v6; // r13@1
  int *v7; // r14@1
  int v8; // er15@6
  uintptr_t v9; // rbx@7
  unsigned __int8 v10; // al@7
  uintptr_t v11; // rcx@8
  uintptr_t v12; // r8@8
  uintptr_t v13; // rsi@8
  uintptr_t v14; // rdx@8
  __int64 v15; // rax@10
  __int64 v16; // rax@11
  unsigned int v17; // er8@11
  __int64 v18; // r14@11
  IOSubMemoryDescriptor *v19; // rdi@12
  uintptr_t v20; // rax@14
  uintptr_t v21; // rcx@18
  uintptr_t v22; // r8@18
  uintptr_t v23; // rsi@18
  uintptr_t v24; // rdx@18
  __int64 v25; // rax@30
  __int64 v26; // r8@31
  __int64 v27; // rcx@31
  __int64 v28; // rdx@31
  __int64 v29; // rax@31
  int v30; // ST00_4@32
  int v31; // eax@32
  int v32; // ST00_4@38
  __int64 v34; // [sp+8h] [bp-48h]@15
  __int64 v35; // [sp+10h] [bp-40h]@11
  uintptr_t v36; // [sp+18h] [bp-38h]@15
  __int64 v37; // [sp+20h] [bp-30h]@11

  v4 = a4;
  v5 = a3;
  v6 = (uintptr_t)this;
  v7 = &gUSBStackDebugFlags;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D2449u, (uintptr_t)this, *(_QWORD *)(a2 + 8), *(_QWORD *)(a2 + 16), a4, 0LL);
  if ( !*((_QWORD *)this + 27) || (unsigned __int8)IOService::isInactive(this) )
  {
    v8 = -536870183;
    if ( gUSBStackDebugFlags & 2 )
    {
      v9 = *((_QWORD *)this + 27);
      v10 = IOService::isInactive(this);
      if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        v11 = v10;
        v12 = 6LL;
        v13 = (uintptr_t)this;
        v14 = v9;
LABEL_9:
        kernel_debug(0x52D2448u, v13, v14, v11, v12, 0LL);
        goto LABEL_43;
      }
    }
    goto LABEL_43;
  }
  LODWORD(v15) = (*(int (__fastcall **)(IOService *, _QWORD))(*(_QWORD *)this + 2680LL))(this, *(_BYTE *)a2);
  if ( v15 )
  {
    v37 = v15;
    v35 = *(_QWORD *)(v5 + 16);
    LODWORD(v16) = (*(int (__fastcall **)(IOService *, _QWORD))(*(_QWORD *)this + 2832LL))(this, *(_QWORD *)(a2 + 40));
    v18 = v16;
    if ( v16 )
    {
      v19 = *(IOSubMemoryDescriptor **)(v16 + 32);
      if ( !v19 )
        v19 = *(IOSubMemoryDescriptor **)(v16 + 64);
      v20 = IOSubMemoryDescriptor::withSubRange(
              v19,
              *(IOMemoryDescriptor **)(a2 + 48),
              *(_QWORD *)(a2 + 8),
              (unsigned int)v4,
              v17);
      if ( v20 )
      {
        v34 = v5;
        v36 = v20;
        v8 = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)v20 + 496LL))(v20, 0LL);
        if ( v8 )
        {
          v7 = &gUSBStackDebugFlags;
          if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          {
            v21 = v8;
            v22 = 3LL;
            v23 = v6;
            v24 = v36;
LABEL_37:
            kernel_debug(0x52D2448u, v23, v24, v21, v22, 0LL);
          }
LABEL_40:
          (*(void (__cdecl **)(__int64))(*(_QWORD *)v37 + 40LL))(v37);
          if ( v8 && v36 )
            (*(void (__cdecl **)(uintptr_t))(*(_QWORD *)v36 + 40LL))(v36);
          goto LABEL_43;
        }
        LODWORD(v25) = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)v6 + 2832LL))(v6, *(_QWORD *)(a2 + 56));
        if ( v25 )
        {
          v26 = *(_QWORD *)(v25 + 56) + *(_QWORD *)(a2 + 64);
          ++*(_DWORD *)(v18 + 84);
          ++*(_DWORD *)(v25 + 84);
          *(_QWORD *)(v35 + 104) = *(_QWORD *)(v25 + 16) + *(_QWORD *)(a2 + 64);
          *(_QWORD *)(v35 + 112) = v36;
          v27 = *(_QWORD *)(v35 + 128);
          *(_QWORD *)(v27 + 8) = v18;
          *(_QWORD *)v27 = v25;
          v28 = *(_QWORD *)(a2 + 16);
          *(_QWORD *)(v27 + 24) = v28;
          *(_QWORD *)(v27 + 16) = (unsigned __int64)(*(_BYTE *)(*(_QWORD *)(v6 + 288) + 180LL) == 0) << 30;
          v29 = *(_QWORD *)v37;
          if ( v4 == 2 )
          {
            v30 = *(_DWORD *)(a2 + 32);
            v31 = (*(int (__fastcall **)(__int64, uintptr_t, __int64, _QWORD, __int64, __int64))(v29 + 512))(
                    v37,
                    v36,
                    v28,
                    *(_DWORD *)(a2 + 24),
                    v26,
                    v34);
          }
          else
          {
            v32 = *(_DWORD *)(a2 + 32);
            v31 = (*(int (__fastcall **)(__int64, uintptr_t, __int64, _QWORD, __int64, __int64))(v29 + 504))(
                    v37,
                    v36,
                    v28,
                    *(_DWORD *)(a2 + 24),
                    v26,
                    v34);
          }
          v8 = v31;
          v7 = &gUSBStackDebugFlags;
          goto LABEL_40;
        }
        v8 = -536870211;
        v7 = &gUSBStackDebugFlags;
        if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
          goto LABEL_40;
        v24 = *(_QWORD *)(a2 + 56);
        v21 = -536870211LL;
        v22 = 4LL;
LABEL_36:
        v23 = v6;
        goto LABEL_37;
      }
      v8 = -536870211;
      v7 = &gUSBStackDebugFlags;
      if ( gUSBStackDebugFlags & 2 )
      {
        v36 = 0LL;
        if ( !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
          goto LABEL_40;
        v24 = *(_QWORD *)(a2 + 8);
        v21 = -536870211LL;
        v22 = 2LL;
        goto LABEL_36;
      }
    }
    else
    {
      v8 = -536870211;
      v7 = &gUSBStackDebugFlags;
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        v24 = *(_QWORD *)(a2 + 40);
        v36 = 0LL;
        v21 = -536870211LL;
        v22 = 1LL;
        goto LABEL_36;
      }
      v20 = 0LL;
    }
    v36 = v20;
    goto LABEL_40;
  }
  v8 = -536854431;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
  {
    v14 = -536854431LL;
    v11 = 0LL;
    v12 = 5LL;
    v13 = (uintptr_t)this;
    goto LABEL_9;
  }
LABEL_43:
  if ( *(_BYTE *)v7 & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D244Au, v6, v8, 0LL, 0LL, 0LL);
  return (unsigned int)v8;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (000000000002D806) ----------------------------------------------------
int __fastcall IOUSBInterfaceUserClientV2::LowLatencyPrepareBufferGated(IOUSBInterfaceUserClientV2 *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  void *v6; // r14@1
  __int64 v7; // rax@1
  int result; // eax@2

  v6 = a3;
  v7 = OSMetaClassBase::safeMetaCast(
         this,
         (const OSMetaClassBase *)&IOUSBInterfaceUserClientV2::gMetaClass,
         (const OSMetaClass *)a3);
  if ( v7 )
    result = (*(int (__fastcall **)(__int64, OSObject *, void *))(*(_QWORD *)v7 + 2752LL))(v7, a2, v6);
  else
    result = -536870206;
  return result;
}
// 49928: using guessed type _QWORD IOUSBInterfaceUserClientV2::gMetaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000002D848) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::LowLatencyPrepareBuffer(IOService *this, __int64 a2, __int64 a3)
{
  __int64 v3; // r13@1
  __int64 v4; // r15@1
  int v5; // er14@1
  void *v6; // rax@4
  void *v7; // r12@4
  __int64 v8; // rax@5
  OSMetaClassBase *v9; // rax@6
  const OSMetaClass *v10; // rdx@6
  __int64 v11; // rax@6
  task *v12; // r8@6
  unsigned __int64 v13; // rcx@7
  unsigned __int64 v14; // r8@9
  uintptr_t v15; // rax@10
  IOService *v16; // rsi@11
  __int64 v17; // r13@20
  uintptr_t v18; // rdx@24
  uintptr_t v19; // rsi@24
  uintptr_t v20; // rcx@24
  uintptr_t v21; // r8@24
  __int64 v22; // rax@29
  __int64 v23; // r14@29
  __int64 v24; // rax@30
  uintptr_t v25; // rdx@33
  uintptr_t v26; // rcx@33
  uintptr_t v27; // r8@33
  __int64 v28; // rax@34
  __int64 v29; // r14@35
  __int64 v30; // rax@35
  uintptr_t arg2; // [sp+0h] [bp-40h]@11
  unsigned __int64 v33; // [sp+8h] [bp-38h]@9
  int v34; // [sp+14h] [bp-2Ch]@9

  v3 = a3;
  v4 = a2;
  (*(void (**)(void))(*(_QWORD *)this + 2728LL))();
  v5 = -536870183;
  if ( !*((_QWORD *)this + 27) || (unsigned __int8)IOService::isInactive(this) )
    goto LABEL_38;
  *(_QWORD *)v3 = 0LL;
  v5 = -536870206;
  if ( *(_QWORD *)(a2 + 16) )
  {
    LODWORD(v6) = IOMalloc(96LL);
    v7 = v6;
    if ( v6 )
    {
      bzero(v6, 0x60uLL);
      *(_QWORD *)v7 = *(_QWORD *)a2;
      *((_QWORD *)v7 + 1) = *(_QWORD *)(a2 + 24);
      LODWORD(v8) = (*(int (__fastcall **)(_QWORD, signed __int64))(**((_QWORD **)this + 27) + 2216LL))(
                      *((_QWORD *)this + 27),
                      96LL);
      v5 = -536870208;
      if ( !v8 )
        goto LABEL_38;
      LODWORD(v9) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v8 + 2264LL))(v8);
      v11 = OSMetaClassBase::safeMetaCast(v9, (const OSMetaClassBase *)IOUSBControllerV2::metaClass, v10);
      v5 = -536870183;
      if ( !v11 )
        goto LABEL_38;
      v13 = *(_QWORD *)(a2 + 24);
      if ( v13 == 2 )
      {
        v17 = IOMemoryDescriptor::withAddressRange(
                *(IOMemoryDescriptor **)(a2 + 8),
                *(_QWORD *)(a2 + 16),
                3uLL,
                *((_QWORD *)this + 28),
                v12);
        if ( v17 )
        {
          v5 = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v17 + 496LL))(v17, 0LL);
          if ( !v5 )
          {
            LODWORD(v22) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v17 + 512LL))(v17, 0LL);
            v23 = v22;
            if ( !v22 )
            {
              if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
                kernel_debug(0x52D2418u, 2uLL, 0xFFFFFFFFE00002BDLL, 0LL, 0xAuLL, 0LL);
              (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v17 + 504LL))(v17, 0LL);
              v5 = -536870211;
              goto LABEL_38;
            }
            LODWORD(v24) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v22 + 280LL))(v22);
            *((_QWORD *)v7 + 7) = v24;
            *((_QWORD *)v7 + 2) = *(_QWORD *)(a2 + 8);
            *((_QWORD *)v7 + 3) = *(_QWORD *)(a2 + 16);
            *((_QWORD *)v7 + 5) = v17;
            *((_QWORD *)v7 + 6) = v23;
            goto LABEL_37;
          }
          if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
            goto LABEL_38;
          v18 = v5;
          v19 = 2LL;
          v20 = 0LL;
          v21 = 9LL;
        }
        else
        {
          v5 = -536870211;
          if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
            goto LABEL_38;
          v18 = *(_DWORD *)(a2 + 16);
          v19 = *(_QWORD *)(a2 + 8);
          v20 = -536870211LL;
          v21 = 8LL;
        }
        kernel_debug(0x52D2418u, v19, v18, v20, v21, 0LL);
      }
      else
      {
        if ( v13 > 1 )
        {
LABEL_37:
          (*(void (__fastcall **)(IOService *, void *))(*(_QWORD *)this + 2824LL))(this, v7);
          v5 = 0;
          goto LABEL_38;
        }
        v5 = -536870206;
        if ( !(*(int (__fastcall **)(__int64, int *, unsigned __int64 *))(*(_QWORD *)v11 + 2856LL))(v11, &v34, &v33) )
        {
          v15 = IOBufferMemoryDescriptor::inTaskWithPhysicalMask(
                  *(IOBufferMemoryDescriptor **)off_3B108,
                  (task *)(v34 | ((unsigned int)(*(_QWORD *)(a2 + 24) < 1uLL) + 65537)),
                  *(_QWORD *)(a2 + 16),
                  v33,
                  v14);
          if ( v15 )
          {
            v16 = 0LL;
            arg2 = v15;
            v5 = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)v15 + 496LL))(v15, 0LL);
            if ( v5 )
            {
              if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
              {
                v16 = this;
                kernel_debug(0x52D2418u, (uintptr_t)this, arg2, v5, 3uLL, 0LL);
              }
              if ( arg2 )
                (*(void (__fastcall **)(uintptr_t, IOService *))(*(_QWORD *)arg2 + 40LL))(arg2, v16);
              goto LABEL_38;
            }
            v5 = 0;
            v28 = IOMemoryDescriptor::createMappingInTask(
                    (IOMemoryDescriptor *)arg2,
                    *((task **)this + 28),
                    0LL,
                    1u,
                    0LL,
                    0LL);
            if ( v28 )
            {
              v29 = v28;
              LODWORD(v30) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v28 + 280LL))(v28);
              if ( v30 )
              {
                *((_QWORD *)v7 + 3) = *(_QWORD *)(v4 + 16);
                *((_QWORD *)v7 + 8) = arg2;
                *((_QWORD *)v7 + 9) = v29;
                *(_QWORD *)v3 = v30;
                goto LABEL_37;
              }
              v5 = 0;
              if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
                goto LABEL_38;
              v5 = 0;
              v25 = 0LL;
              v26 = 0LL;
              v27 = 5LL;
            }
            else
            {
              if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
                goto LABEL_38;
              v5 = 0;
              v25 = 0LL;
              v26 = 0LL;
              v27 = 4LL;
            }
          }
          else
          {
            v5 = -536870211;
            if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
              goto LABEL_38;
            v25 = *(_QWORD *)(a2 + 16);
            v26 = -536870211LL;
            v27 = 2LL;
          }
          kernel_debug(0x52D2418u, (uintptr_t)this, v25, v26, v27, 0LL);
          goto LABEL_38;
        }
      }
LABEL_38:
      (*(void (__fastcall **)(IOService *))(*(_QWORD *)this + 2720LL))(this);
      return (unsigned int)v5;
    }
    v5 = -536870211;
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D2418u, (uintptr_t)this, 0x60uLL, 0xFFFFFFFFE00002BDLL, 1uLL, 0LL);
  }
  return (unsigned int)v5;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 3B108: using guessed type __int64 off_3B108;
// 419C0: using guessed type _QWORD IOUSBControllerV2::metaClass;
// 49460: using guessed type int gUSBStackDebugFlags;
// 7D250: using guessed type int __fastcall IOMalloc(_QWORD);
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000002DD02) ----------------------------------------------------
int __fastcall IOUSBInterfaceUserClientV2::LowLatencyReleaseBufferGated(IOUSBInterfaceUserClientV2 *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  __int64 v6; // rax@1
  int result; // eax@2

  v6 = OSMetaClassBase::safeMetaCast(
         this,
         (const OSMetaClassBase *)&IOUSBInterfaceUserClientV2::gMetaClass,
         (const OSMetaClass *)a3);
  if ( v6 )
    result = (*(int (__fastcall **)(__int64, OSObject *))(*(_QWORD *)v6 + 2760LL))(v6, a2);
  else
    result = -536870206;
  return result;
}
// 49928: using guessed type _QWORD IOUSBInterfaceUserClientV2::gMetaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000002DD40) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::LowLatencyReleaseBuffer(IOService *this, __int64 a2)
{
  signed int v2; // er14@1
  __int64 v3; // rax@3
  __int64 v4; // r15@3

  (*(void (__cdecl **)(IOService *))(*(_QWORD *)this + 2728LL))(this);
  v2 = -536870183;
  if ( *((_QWORD *)this + 27) )
  {
    if ( !(unsigned __int8)IOService::isInactive(this) )
    {
      LODWORD(v3) = (*(int (__fastcall **)(IOService *, _QWORD))(*(_QWORD *)this + 2832LL))(this, *(_QWORD *)a2);
      v4 = v3;
      v2 = -536870206;
      if ( v3 )
      {
        if ( (unsigned __int8)(*(int (__fastcall **)(IOService *, __int64))(*(_QWORD *)this + 2840LL))(this, v3) )
        {
          if ( *(_DWORD *)(v4 + 84) <= 0 )
            (*(void (__fastcall **)(IOService *, __int64))(*(_QWORD *)this + 2816LL))(this, v4);
          else
            *(_BYTE *)(v4 + 80) = 1;
          v2 = 0;
        }
      }
    }
  }
  (*(void (__fastcall **)(IOService *))(*(_QWORD *)this + 2720LL))(this);
  return (unsigned int)v2;
}

//----- (000000000002DDE0) ----------------------------------------------------
int __fastcall IOUSBInterfaceUserClientV2::LowLatencyReleaseKernelBufferInfo(__int64 a1, __int64 a2)
{
  __int64 v2; // rdi@1
  __int64 v3; // rdi@3
  __int64 v4; // rdi@5
  __int64 v5; // rdi@7
  __int64 v6; // rdi@9

  v2 = *(_QWORD *)(a2 + 48);
  if ( v2 )
  {
    (*(void (__cdecl **)(__int64))(*(_QWORD *)v2 + 40LL))(v2);
    *(_QWORD *)(a2 + 48) = 0LL;
    *(_QWORD *)(a2 + 56) = 0LL;
  }
  v3 = *(_QWORD *)(a2 + 40);
  if ( v3 )
  {
    (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v3 + 504LL))(v3, 0LL);
    (*(void (__cdecl **)(_QWORD))(**(_QWORD **)(a2 + 40) + 40LL))(*(_QWORD *)(a2 + 40));
    *(_QWORD *)(a2 + 40) = 0LL;
  }
  v4 = *(_QWORD *)(a2 + 32);
  if ( v4 )
  {
    (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v4 + 504LL))(v4, 0LL);
    (*(void (__cdecl **)(_QWORD))(**(_QWORD **)(a2 + 32) + 40LL))(*(_QWORD *)(a2 + 32));
    *(_QWORD *)(a2 + 32) = 0LL;
  }
  v5 = *(_QWORD *)(a2 + 64);
  if ( v5 )
  {
    (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v5 + 504LL))(v5, 0LL);
    (*(void (__cdecl **)(_QWORD))(**(_QWORD **)(a2 + 64) + 40LL))(*(_QWORD *)(a2 + 64));
    *(_QWORD *)(a2 + 64) = 0LL;
  }
  v6 = *(_QWORD *)(a2 + 72);
  if ( v6 )
  {
    (*(void (__cdecl **)(__int64))(*(_QWORD *)v6 + 40LL))(v6);
    *(_QWORD *)(a2 + 72) = 0LL;
  }
  return IOFree(a2, 96LL);
}
// 7D218: using guessed type int __fastcall IOFree(_QWORD, _QWORD);

//----- (000000000002DEA4) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::AddDataBufferToList(__int64 a1, __int64 a2)
{
  __int64 result; // rax@1
  __int64 v3; // rcx@2

  result = *(_QWORD *)(a1 + 256);
  if ( result )
  {
    do
    {
      v3 = result;
      result = *(_QWORD *)(result + 88);
    }
    while ( result );
    *(_QWORD *)(v3 + 88) = a2;
  }
  else
  {
    *(_QWORD *)(a1 + 256) = a2;
  }
  return result;
}

//----- (000000000002DED0) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::FindBufferCookieInListV2(IOUSBInterfaceUserClientV2 *this, __int64 a2)
{
  __int64 v2; // rcx@1
  __int64 result; // rax@1

  v2 = *((_QWORD *)this + 32);
  result = 0LL;
  if ( v2 )
  {
    result = 0LL;
    while ( *(_QWORD *)v2 != a2 )
    {
      v2 = *(_QWORD *)(v2 + 88);
      if ( !v2 )
        return result;
    }
    result = v2;
  }
  return result;
}

//----- (000000000002DEFA) ----------------------------------------------------
char __fastcall IOUSBInterfaceUserClientV2::RemoveDataBufferFromList(__int64 a1, __int64 a2)
{
  __int64 v2; // rax@1
  __int64 v3; // rcx@3
  char result; // al@5

  v2 = *(_QWORD *)(a1 + 256);
  if ( v2 )
  {
    if ( v2 == a2 )
    {
      *(_QWORD *)(a1 + 256) = *(_QWORD *)(a2 + 88);
    }
    else
    {
      do
      {
        v3 = v2;
        v2 = *(_QWORD *)(v2 + 88);
      }
      while ( v2 != a2 );
      *(_QWORD *)(v3 + 88) = *(_QWORD *)(a2 + 88);
    }
    result = 1;
  }
  else
  {
    result = 0;
  }
  return result;
}

//----- (000000000002DF38) ----------------------------------------------------
int __usercall IOUSBInterfaceUserClientV2::DecrementOutstandingIO@<eax>(IOUSBInterfaceUserClientV2 *this@<rdi>, __int64 a2@<rax>)
{
  IOUSBInterfaceUserClientV2 *v2; // r14@1
  __int64 v3; // rbx@1
  __int64 v4; // r15@2
  char *v5; // rbx@2
  bool v6; // zf@3
  __int64 v7; // rdi@6

  v2 = this;
  v3 = *((_QWORD *)this + 30);
  if ( v3 )
  {
    v4 = *((_QWORD *)this + 31);
    (*(void (__fastcall **)(_QWORD))(*(_QWORD *)v4 + 32LL))(*((_QWORD *)this + 31));
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 32LL))(v3);
    (*(void (__fastcall **)(__int64, __int64 (__fastcall *)(IOUSBInterfaceUserClientV2 *__hidden, OSObject *, void *, void *, void *, void *), signed __int64, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v3 + 456LL))(
      v3,
      IOUSBInterfaceUserClientV2::ChangeOutstandingIO,
      -1LL,
      0LL,
      0LL,
      0LL);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 40LL))(v3);
    LODWORD(a2) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v4 + 40LL))(v4);
    v5 = (char *)this + 272;
  }
  else
  {
    v5 = (char *)this + 272;
    v6 = (*((_DWORD *)this + 68))-- == 1;
    if ( v6 )
    {
      if ( *((_BYTE *)this + 277) )
      {
        a2 = *((_QWORD *)this + 36);
        if ( !*(_BYTE *)(a2 + 174) )
        {
          *(_BYTE *)(a2 + 174) = 1;
          v7 = *((_QWORD *)this + 27);
          if ( v7 )
          {
            (*(void (__fastcall **)(__int64, IOUSBInterfaceUserClientV2 *, _QWORD))(*(_QWORD *)v7 + 1496LL))(
              v7,
              v2,
              0LL);
            (*(void (__cdecl **)(_QWORD))(**((_QWORD **)v2 + 27) + 40LL))(*((_QWORD *)v2 + 27));
            *((_BYTE *)v2 + 277) = 0;
          }
          LODWORD(a2) = (*(int (__fastcall **)(IOUSBInterfaceUserClientV2 *))(*(_QWORD *)v2 + 40LL))(v2);
        }
      }
    }
  }
  if ( !*(_DWORD *)v5 )
  {
    a2 = *((_QWORD *)v2 + 36);
    if ( *(_BYTE *)(a2 + 173) )
    {
      *(_BYTE *)(a2 + 173) = 0;
      LODWORD(a2) = IOUSBInterfaceUserClientV2::ReleaseWorkLoopAndGate(v2);
    }
  }
  return a2;
}

//----- (000000000002E04A) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::ChangeOutstandingIO(IOUSBInterfaceUserClientV2 *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  int v6; // er14@1
  uintptr_t v7; // rsi@1
  uintptr_t v8; // rax@1
  uintptr_t v9; // rbx@1
  bool v10; // zf@3
  __int64 v11; // rax@5
  __int64 v12; // rdi@6
  uintptr_t v13; // r14@11
  uintptr_t v14; // rsi@11
  uintptr_t v15; // r8@11

  v6 = (signed int)a2;
  v7 = (uintptr_t)&IOUSBInterfaceUserClientV2::gMetaClass;
  v8 = OSMetaClassBase::safeMetaCast(
         this,
         (const OSMetaClassBase *)&IOUSBInterfaceUserClientV2::gMetaClass,
         (const OSMetaClass *)a3);
  v9 = v8;
  if ( !v8 )
  {
    if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
      return 0LL;
    v13 = v6 & 0xFFFFFFFF;
    v14 = 0LL;
    v15 = 0LL;
LABEL_17:
    kernel_debug(0x52D241Cu, v14, v13, 0LL, v15, 0LL);
    return 0LL;
  }
  if ( v6 == -1 )
  {
    v10 = (*(_DWORD *)(v8 + 272))-- == 1;
    if ( v10 )
    {
      if ( *(_BYTE *)(v8 + 277) )
      {
        v11 = *(_QWORD *)(v8 + 288);
        if ( !*(_BYTE *)(v11 + 174) )
        {
          *(_BYTE *)(v11 + 174) = 1;
          v12 = *(_QWORD *)(v9 + 216);
          if ( v12 )
          {
            v7 = v9;
            (*(void (__fastcall **)(__int64, uintptr_t, _QWORD))(*(_QWORD *)v12 + 1496LL))(v12, v9, 0LL);
            (*(void (__cdecl **)(_QWORD))(**(_QWORD **)(v9 + 216) + 40LL))(*(_QWORD *)(v9 + 216));
            *(_BYTE *)(v9 + 277) = 0;
          }
          (*(void (__fastcall **)(uintptr_t, uintptr_t))(*(_QWORD *)v9 + 40LL))(v9, v7);
        }
      }
    }
    return 0LL;
  }
  if ( v6 == 1 )
  {
    ++*(_DWORD *)(v8 + 272);
    return 0LL;
  }
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
  {
    v13 = v6 & 0xFFFFFFFF;
    v15 = 1LL;
    v14 = v8;
    goto LABEL_17;
  }
  return 0LL;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 49928: using guessed type _QWORD IOUSBInterfaceUserClientV2::gMetaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000002E16C) ----------------------------------------------------
int __fastcall IOUSBInterfaceUserClientV2::ReleaseWorkLoopAndGate(IOUSBInterfaceUserClientV2 *this)
{
  IOUSBInterfaceUserClientV2 *v1; // rbx@1
  int result; // eax@2
  __int64 v3; // rdi@3
  __int64 v4; // r14@5
  __int64 v5; // r15@6
  __int64 v6; // rdi@8

  v1 = this;
  if ( *((_QWORD *)this + 32) )
    result = (*(int (__cdecl **)(IOUSBInterfaceUserClientV2 *))(*(_QWORD *)this + 2712LL))(this);
  v3 = *((_QWORD *)this + 33);
  if ( v3 )
  {
    result = (*(int (__cdecl **)(__int64))(*(_QWORD *)v3 + 40LL))(v3);
    *((_QWORD *)v1 + 33) = 0LL;
  }
  v4 = *((_QWORD *)v1 + 31);
  if ( v4 )
  {
    v5 = *((_QWORD *)v1 + 30);
    if ( v5 )
    {
      *((_QWORD *)v1 + 30) = 0LL;
      *((_QWORD *)v1 + 31) = 0LL;
      (*(void (__fastcall **)(__int64, __int64))(*(_QWORD *)v4 + 328LL))(v4, v5);
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v5 + 40LL))(v5);
      result = (*(int (__fastcall **)(__int64))(*(_QWORD *)v4 + 40LL))(v4);
    }
  }
  v6 = *((_QWORD *)v1 + 29);
  if ( v6 )
  {
    result = IOUserClient::releaseNotificationPort(v6);
    *((_QWORD *)v1 + 29) = 0LL;
  }
  return result;
}
// 7D518: using guessed type int __cdecl IOUserClient::releaseNotificationPort(_QWORD);

//----- (000000000002E222) ----------------------------------------------------
int __fastcall IOUSBInterfaceUserClientV2::IncrementOutstandingIO(IOUSBInterfaceUserClientV2 *this)
{
  __int64 v1; // r15@1
  __int64 v2; // r14@1
  int result; // eax@1

  v1 = *((_QWORD *)this + 30);
  v2 = *((_QWORD *)this + 31);
  result = IOService::isInactive(this);
  if ( *((_QWORD *)this + 30) )
  {
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 32LL))(v2);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v1 + 32LL))(v1);
    (*(void (__fastcall **)(__int64, __int64 (__fastcall *)(IOUSBInterfaceUserClientV2 *__hidden, OSObject *, void *, void *, void *, void *), signed __int64, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v1 + 456LL))(
      v1,
      IOUSBInterfaceUserClientV2::ChangeOutstandingIO,
      1LL,
      0LL,
      0LL,
      0LL);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v1 + 40LL))(v1);
    result = (*(int (__fastcall **)(__int64))(*(_QWORD *)v2 + 40LL))(v2);
  }
  else
  {
    ++*((_DWORD *)this + 68);
  }
  return result;
}

//----- (000000000002E2AC) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::GetOutstandingIO(IOUSBInterfaceUserClientV2 *this)
{
  __int64 v1; // rbx@1
  __int64 v2; // r14@2
  __int64 result; // rax@2
  unsigned int v4; // [sp+Ch] [bp-14h]@1

  v4 = 0;
  v1 = *((_QWORD *)this + 30);
  if ( v1 )
  {
    v2 = *((_QWORD *)this + 31);
    (*(void (__fastcall **)(_QWORD))(*(_QWORD *)v2 + 32LL))(*((_QWORD *)this + 31));
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v1 + 32LL))(v1);
    (*(void (__fastcall **)(__int64, __int64 (__fastcall *)(IOUSBInterfaceUserClientV2 *__hidden, OSObject *, void *, void *, void *, void *), int *, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v1 + 456LL))(
      v1,
      IOUSBInterfaceUserClientV2::GetGatedOutstandingIO,
      &v4,
      0LL,
      0LL,
      0LL);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v1 + 40LL))(v1);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 40LL))(v2);
    result = v4;
  }
  else
  {
    result = *((_DWORD *)this + 68);
  }
  return result;
}

//----- (000000000002E328) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::GetGatedOutstandingIO(IOUSBInterfaceUserClientV2 *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  __int64 v6; // rax@1

  v6 = OSMetaClassBase::safeMetaCast(
         this,
         (const OSMetaClassBase *)&IOUSBInterfaceUserClientV2::gMetaClass,
         (const OSMetaClass *)a3);
  if ( v6 )
    *(_DWORD *)a2 = *(_DWORD *)(v6 + 272);
  return 0LL;
}
// 49928: using guessed type _QWORD IOUSBInterfaceUserClientV2::gMetaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000002E354) ----------------------------------------------------
int __fastcall IOUSBInterfaceUserClientV2::IncreaseCommandPool(IOUSBInterfaceUserClientV2 *this, unsigned __int64 a2)
{
  IOUSBInterfaceUserClientV2 *v2; // r14@1
  signed int v3; // ebx@1
  IOCommand *v4; // rax@2

  v2 = this;
  v3 = 10;
  do
  {
    v4 = IOUSBLowLatencyCommand::NewCommand(this, a2);
    if ( v4 )
    {
      this = (IOUSBInterfaceUserClientV2 *)*((_QWORD *)v2 + 33);
      a2 = (unsigned __int64)v4;
      LODWORD(v4) = (*(int (__fastcall **)(IOUSBInterfaceUserClientV2 *, IOCommand *))(*(_QWORD *)this + 304LL))(
                      this,
                      v4);
    }
    --v3;
  }
  while ( v3 );
  *((_DWORD *)v2 + 70) += 10;
  return (signed int)v4;
}

//----- (000000000002E392) ----------------------------------------------------
IOCommand *__fastcall IOUSBLowLatencyCommand::NewCommand(IOUSBLowLatencyCommand *this, unsigned __int64 a2)
{
  IOCommand *v2; // rbx@1

  v2 = (IOCommand *)OSObject::operator new((OSObject *)&stru_68.addr, a2);
  IOCommand::IOCommand(v2, (const OSMetaClass *)&IOUSBLowLatencyCommand::gMetaClass);
  *(_QWORD *)v2 = off_45E60;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBLowLatencyCommand::gMetaClass);
  if ( v2
    && !(unsigned __int8)(*(int (__fastcall **)(IOCommand *, _QWORD *))(*(_QWORD *)v2 + 136LL))(
                           v2,
                           &IOUSBLowLatencyCommand::gMetaClass) )
  {
    (*(void (__fastcall **)(IOCommand *))(*(_QWORD *)v2 + 40LL))(v2);
    v2 = 0LL;
  }
  return v2;
}
// 68: using guessed type section_64 stru_68;
// 45E60: using guessed type __int64 (__fastcall *off_45E60[2])(IOUSBLowLatencyCommand *__hidden this);
// 49950: using guessed type _QWORD IOUSBLowLatencyCommand::gMetaClass;

//----- (000000000002E3F2) ----------------------------------------------------
int __fastcall IOUSBInterfaceUserClientV2::ReleasePreparedDescriptors(IOUSBInterfaceUserClientV2 *this)
{
  __int64 v1; // rsi@2
  __int64 v2; // rbx@3
  int result; // eax@3

  if ( !*((_DWORD *)this + 68) )
  {
    v1 = *((_QWORD *)this + 32);
    if ( v1 )
    {
      do
      {
        v2 = *(_QWORD *)(v1 + 88);
        result = (*(int (__fastcall **)(IOUSBInterfaceUserClientV2 *))(*(_QWORD *)this + 2816LL))(this);
        v1 = v2;
      }
      while ( v2 );
      *((_QWORD *)this + 32) = 0LL;
    }
  }
  return result;
}

//----- (000000000002E43A) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::GetPipeObj(IOUSBInterfaceUserClientV2 *this, unsigned __int8 a2)
{
  __int64 result; // rax@1
  char v3; // cl@2
  __int64 v4; // rax@5
  __int64 v5; // rax@6
  __int64 v6; // r14@7
  char v7; // cl@9
  IOService *v8; // rdi@10
  char v9; // cl@11

  result = 0LL;
  if ( *((_QWORD *)this + 27) )
  {
    v3 = IOService::isInactive(this);
    result = 0LL;
    if ( !v3 )
    {
      if ( a2 )
      {
        result = 0LL;
        if ( a2 > 0x20u )
          return result;
        LODWORD(v4) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 27) + 2200LL))(
                        *((_QWORD *)this + 27),
                        (unsigned __int8)(a2 - 1));
      }
      else
      {
        LODWORD(v5) = (*(int (__cdecl **)(_QWORD))(**((_QWORD **)this + 27) + 2216LL))(*((_QWORD *)this + 27));
        LODWORD(v4) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v5 + 2344LL))(v5);
      }
      v6 = v4;
      result = 0LL;
      if ( v6 )
      {
        result = 0LL;
        if ( !*(_BYTE *)(*((_QWORD *)this + 36) + 174LL) )
        {
          v7 = IOService::isInactive(this);
          result = 0LL;
          if ( !v7 )
          {
            v8 = (IOService *)*((_QWORD *)this + 27);
            result = 0LL;
            if ( v8 )
            {
              v9 = IOService::isInactive(v8);
              result = 0LL;
              if ( !v9 )
              {
                (*(void (__fastcall **)(__int64))(*(_QWORD *)v6 + 32LL))(v6);
                result = v6;
              }
            }
          }
        }
      }
    }
  }
  return result;
}

//----- (000000000002E510) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::clientClose(IOUSBInterfaceUserClientV2 *this)
{
  int v1; // er14@1
  __int64 v2; // r12@2
  __int64 v3; // r15@3

  (*(void (**)(void))(*(_QWORD *)this + 32LL))();
  v1 = -536870208;
  if ( !(unsigned __int8)IOService::isInactive(this) )
  {
    v2 = *((_QWORD *)this + 30);
    if ( v2 )
    {
      v3 = *((_QWORD *)this + 31);
      if ( v3 )
      {
        (*(void (__fastcall **)(_QWORD))(*(_QWORD *)v3 + 32LL))(*((_QWORD *)this + 31));
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 32LL))(v2);
        v1 = (*(int (__fastcall **)(__int64, int (__fastcall *)(IOUSBInterfaceUserClientV2 *, OSObject *, void *, void *, void *, void *), _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v2 + 456LL))(
               v2,
               IOUSBInterfaceUserClientV2::ClientCloseEntry,
               0LL,
               0LL,
               0LL,
               0LL);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 40LL))(v2);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 40LL))(v3);
      }
    }
  }
  (*(void (__fastcall **)(IOUSBInterfaceUserClientV2 *))(*(_QWORD *)this + 40LL))(this);
  return (unsigned int)v1;
}

//----- (000000000002E5AA) ----------------------------------------------------
int __fastcall IOUSBInterfaceUserClientV2::ClientCloseEntry(IOUSBInterfaceUserClientV2 *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  __int64 v6; // rax@1
  int result; // eax@2

  v6 = OSMetaClassBase::safeMetaCast(
         this,
         (const OSMetaClassBase *)&IOUSBInterfaceUserClientV2::gMetaClass,
         (const OSMetaClass *)a3);
  if ( v6 )
    result = (*(int (__fastcall **)(__int64, _QWORD *))(*(_QWORD *)v6 + 2848LL))(
               v6,
               &IOUSBInterfaceUserClientV2::gMetaClass);
  else
    result = -536870206;
  return result;
}
// 49928: using guessed type _QWORD IOUSBInterfaceUserClientV2::gMetaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000002E5D4) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::ClientCloseGated(IOUSBInterfaceUserClientV2 *this)
{
  IOUSBInterfaceUserClientV2 *v1; // r15@1
  signed int v2; // ebx@1
  __int64 v3; // rdi@3
  __int64 v4; // rax@6
  __int64 v5; // r14@6
  __int64 v6; // rax@7
  __int64 v7; // rdi@13
  __int64 v8; // rax@14
  __int64 v9; // rax@18

  v1 = this;
  v2 = -536870208;
  if ( !(unsigned __int8)IOService::isInactive(this) )
  {
    (*(void (__cdecl **)(IOUSBInterfaceUserClientV2 *))(*(_QWORD *)this + 32LL))(this);
    if ( *((_BYTE *)this + 276) )
    {
      v3 = *((_QWORD *)this + 27);
      if ( v3 )
      {
        if ( *(_BYTE *)(*((_QWORD *)v1 + 36) + 172LL) )
        {
          if ( (unsigned __int8)(*(int (__cdecl **)(__int64))(*(_QWORD *)v3 + 2232LL))(v3) != *(_BYTE *)(*((_QWORD *)v1 + 36) + 175LL) )
          {
            LODWORD(v4) = (*(int (__cdecl **)(_QWORD))(**((_QWORD **)v1 + 27) + 2216LL))(*((_QWORD *)v1 + 27));
            v5 = v4;
            (*(void (__fastcall **)(_QWORD, IOUSBInterfaceUserClientV2 *, _QWORD))(**((_QWORD **)v1 + 27) + 2192LL))(
              *((_QWORD *)v1 + 27),
              v1,
              *(_BYTE *)(*((_QWORD *)v1 + 36) + 175LL));
            if ( v5 )
            {
              LODWORD(v6) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v5 + 696LL))(v5, "kSuspendPort");
              if ( v6 == **(_QWORD **)off_3B0F8[0] )
              {
                if ( (unsigned __int8)(*(int (__fastcall **)(__int64, IOUSBInterfaceUserClientV2 *, _QWORD, _QWORD))(*(_QWORD *)v5 + 1488LL))(
                                        v5,
                                        v1,
                                        0LL,
                                        0LL) )
                {
                  (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v5 + 2440LL))(v5, 1LL);
                  (*(void (__fastcall **)(__int64, IOUSBInterfaceUserClientV2 *, _QWORD))(*(_QWORD *)v5 + 1496LL))(
                    v5,
                    v1,
                    0LL);
                }
              }
            }
          }
          if ( *((_QWORD *)v1 + 27) && !(unsigned __int8)IOService::isInactive(v1) )
            (*(void (__cdecl **)(_QWORD))(**((_QWORD **)v1 + 27) + 2136LL))(*((_QWORD *)v1 + 27));
        }
      }
    }
    v7 = *((_QWORD *)v1 + 27);
    if ( v7 )
    {
      v8 = *((_QWORD *)v1 + 36);
      if ( *(_BYTE *)(v8 + 172) )
      {
        *(_BYTE *)(v8 + 172) = 0;
        (*(void (__fastcall **)(__int64, IOUSBInterfaceUserClientV2 *, signed __int64))(*(_QWORD *)v7 + 1496LL))(
          v7,
          v1,
          0x20000LL);
      }
    }
    if ( !(unsigned __int8)IOService::isInactive(v1) && !*((_DWORD *)v1 + 68) )
    {
      v9 = *((_QWORD *)v1 + 36);
      if ( !*(_BYTE *)(v9 + 174) )
      {
        *(_BYTE *)(v9 + 174) = 1;
        (*(void (__cdecl **)(_QWORD))(**((_QWORD **)v1 + 27) + 40LL))(*((_QWORD *)v1 + 27));
        (*(void (__fastcall **)(IOUSBInterfaceUserClientV2 *))(*(_QWORD *)v1 + 40LL))(v1);
      }
    }
    *((_QWORD *)v1 + 28) = 0LL;
    v2 = 0;
    (*(void (__fastcall **)(IOUSBInterfaceUserClientV2 *, _QWORD))(*(_QWORD *)v1 + 1536LL))(v1, 0LL);
    (*(void (__fastcall **)(IOUSBInterfaceUserClientV2 *))(*(_QWORD *)v1 + 40LL))(v1);
  }
  return (unsigned int)v2;
}
// 3B0F8: using guessed type __int64 off_3B0F8[3];

//----- (000000000002E7B2) ----------------------------------------------------
int __fastcall IOUSBInterfaceUserClientV2::clientDied(IOUSBInterfaceUserClientV2 *this)
{
  *((_BYTE *)this + 276) = 1;
  return (*(int (**)(void))(off_3B0B8[0] + 2312))();
}
// 3B0B8: using guessed type __int64 off_3B0B8[11];

//----- (000000000002E7CC) ----------------------------------------------------
int __fastcall IOUSBInterfaceUserClientV2::stop(IOUSBInterfaceUserClientV2 *this, IOService *a2)
{
  if ( *((_DWORD *)this + 68) )
    *(_BYTE *)(*((_QWORD *)this + 36) + 173LL) = 1;
  else
    IOUSBInterfaceUserClientV2::ReleaseWorkLoopAndGate(this);
  return (*(int (__fastcall **)(IOUSBInterfaceUserClientV2 *))(off_3B0B8[0] + 1496))(this);
}
// 3B0B8: using guessed type __int64 off_3B0B8[11];

//----- (000000000002E812) ----------------------------------------------------
int __fastcall IOUSBInterfaceUserClientV2::free(IOUSBInterfaceUserClientV2 *this)
{
  IOUSBInterfaceUserClientV2 *v1; // rbx@1
  __int64 v2; // rdi@1

  v1 = this;
  v2 = *((_QWORD *)this + 36);
  if ( v2 )
  {
    IOFree(v2, 184LL);
    *((_QWORD *)v1 + 36) = 0LL;
  }
  return (*(int (__fastcall **)(IOUSBInterfaceUserClientV2 *))(off_3B0B8[0] + 160))(v1);
}
// 3B0B8: using guessed type __int64 off_3B0B8[11];
// 7D218: using guessed type int __fastcall IOFree(_QWORD, _QWORD);

//----- (000000000002E852) ----------------------------------------------------
int __fastcall IOUSBInterfaceUserClientV2::finalize(IOUSBInterfaceUserClientV2 *this)
{
  return (*(int (__fastcall **)(IOUSBInterfaceUserClientV2 *))(off_3B0B8[0] + 1560))(this);
}
// 3B0B8: using guessed type __int64 off_3B0B8[11];

//----- (000000000002E864) ----------------------------------------------------
int __fastcall IOUSBInterfaceUserClientV2::willTerminate(IOUSBInterfaceUserClientV2 *this, IOService *a2, unsigned int a3)
{
  unsigned int v3; // er14@1
  signed int v4; // ebx@4

  v3 = a3;
  if ( *((_QWORD *)this + 31) && *((_QWORD *)this + 27) && *((_DWORD *)this + 68) )
  {
    v4 = -32;
    do
      (*(void (__fastcall **)(IOUSBInterfaceUserClientV2 *, _QWORD))(*(_QWORD *)this + 2560LL))(
        this,
        (unsigned __int8)(v4++ + 33));
    while ( v4 );
  }
  return (*(int (__fastcall **)(IOUSBInterfaceUserClientV2 *, IOService *, _QWORD))(off_3B0B8[0] + 1040))(this, a2, v3);
}
// 3B0B8: using guessed type __int64 off_3B0B8[11];

//----- (000000000002E8D4) ----------------------------------------------------
int __fastcall IOUSBInterfaceUserClientV2::didTerminate(IOUSBInterfaceUserClientV2 *this, IOService *a2, unsigned int a3, bool *a4)
{
  bool *v4; // r14@1
  unsigned int v5; // er15@1
  IOUSBInterfaceUserClientV2 *v6; // rbx@1
  __int64 v7; // rax@2
  __int64 v8; // rdi@3
  __int64 v9; // rax@7
  char v10; // r13@7
  __int64 v11; // rdi@7
  __int64 v12; // rdi@10

  v4 = a4;
  v5 = a3;
  v6 = this;
  if ( *((_QWORD *)this + 31) )
  {
    v7 = *((_QWORD *)this + 36);
    if ( *(_BYTE *)(v7 + 172) )
    {
      v8 = *((_QWORD *)this + 27);
      if ( v8 )
      {
        *(_BYTE *)(v7 + 172) = 0;
        (*(void (__fastcall **)(__int64, IOUSBInterfaceUserClientV2 *, signed __int64))(*(_QWORD *)v8 + 1496LL))(
          v8,
          v6,
          0x20000LL);
      }
    }
    if ( *((_DWORD *)v6 + 68) )
    {
      *((_BYTE *)v6 + 277) = 1;
    }
    else
    {
      v9 = *((_QWORD *)v6 + 36);
      v10 = *(_BYTE *)(v9 + 174);
      *(_BYTE *)(v9 + 174) = 1;
      v11 = *((_QWORD *)v6 + 27);
      if ( v11
        && (unsigned __int8)(*(int (__fastcall **)(__int64, IOUSBInterfaceUserClientV2 *))(*(_QWORD *)v11 + 1504LL))(
                              v11,
                              v6) )
      {
        *((_BYTE *)v6 + 277) = 0;
        (*(void (__fastcall **)(_QWORD, IOUSBInterfaceUserClientV2 *, _QWORD))(**((_QWORD **)v6 + 27) + 1496LL))(
          *((_QWORD *)v6 + 27),
          v6,
          0LL);
      }
      v12 = *((_QWORD *)v6 + 27);
      if ( v12 && !v10 )
      {
        (*(void (__cdecl **)(__int64))(*(_QWORD *)v12 + 40LL))(v12);
        (*(void (__fastcall **)(IOUSBInterfaceUserClientV2 *))(*(_QWORD *)v6 + 40LL))(v6);
      }
    }
  }
  return (*(int (__fastcall **)(IOUSBInterfaceUserClientV2 *, IOService *, _QWORD, bool *))(off_3B0B8[0] + 1048))(
           v6,
           a2,
           v5,
           v4);
}
// 3B0B8: using guessed type __int64 off_3B0B8[11];

//----- (000000000002E9D6) ----------------------------------------------------
int __fastcall IOUSBInterfaceUserClientV2::terminate(IOUSBInterfaceUserClientV2 *this)
{
  return (*(int (__fastcall **)(IOUSBInterfaceUserClientV2 *))(off_3B0B8[0] + 1552))(this);
}
// 3B0B8: using guessed type __int64 off_3B0B8[11];

//----- (000000000002E9E8) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::message(IOUSBInterfaceUserClientV2 *this, __int64 a2, IOService *a3, void *a4)
{
  return 0LL;
}

//----- (000000000002E9F0) ----------------------------------------------------
void IOUSBInterfaceUserClientV2::PrintExternalMethodArgs()
{
  ;
}

//----- (000000000002E9F6) ----------------------------------------------------
signed __int64 IOUSBInterfaceUserClientV2::DoIsochPipeAsync()
{
  return 3758097095LL;
}

//----- (000000000002EA02) ----------------------------------------------------
signed __int64 IOUSBInterfaceUserClientV2::DoLowLatencyIsochPipeAsync()
{
  return 3758097095LL;
}

//----- (000000000002EA0E) ----------------------------------------------------
__int64 IOUSBInterfaceUserClientV2::RemoveDataBufferFromList()
{
  return 0LL;
}

//----- (000000000002EA16) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::FindBufferCookieInList(IOUSBInterfaceUserClientV2 *this)
{
  return 0LL;
}

//----- (000000000002EA1E) ----------------------------------------------------
void IOUSBInterfaceUserClientV2::AddDataBufferToList()
{
  ;
}

//----- (000000000002EA24) ----------------------------------------------------
signed __int64 IOUSBInterfaceUserClientV2::LowLatencyReleaseBuffer()
{
  return 3758097095LL;
}

//----- (000000000002EA30) ----------------------------------------------------
signed __int64 IOUSBInterfaceUserClientV2::LowLatencyPrepareBuffer()
{
  return 3758097095LL;
}

//----- (000000000002EA3C) ----------------------------------------------------
signed __int64 IOUSBInterfaceUserClientV2::DoLowLatencyIsochPipeAsync()
{
  return 3758097095LL;
}

//----- (000000000002EA48) ----------------------------------------------------
void IOUSBInterfaceUserClientV2::AddDataBufferToList()
{
  ;
}

//----- (000000000002EA4E) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::FindBufferCookieInList(IOUSBInterfaceUserClientV2 *this)
{
  return 0LL;
}

//----- (000000000002EA56) ----------------------------------------------------
__int64 IOUSBInterfaceUserClientV2::RemoveDataBufferFromList()
{
  return 0LL;
}

//----- (000000000002EA5E) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::_RESERVEDIOUSBInterfaceUserClientV216(IOUSBInterfaceUserClientV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBInterfaceUserClientV2::gMetaClass, 16);
}
// 49928: using guessed type _QWORD IOUSBInterfaceUserClientV2::gMetaClass;

//----- (000000000002EA74) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::_RESERVEDIOUSBInterfaceUserClientV217(IOUSBInterfaceUserClientV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBInterfaceUserClientV2::gMetaClass, 17);
}
// 49928: using guessed type _QWORD IOUSBInterfaceUserClientV2::gMetaClass;

//----- (000000000002EA8A) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::_RESERVEDIOUSBInterfaceUserClientV218(IOUSBInterfaceUserClientV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBInterfaceUserClientV2::gMetaClass, 18);
}
// 49928: using guessed type _QWORD IOUSBInterfaceUserClientV2::gMetaClass;

//----- (000000000002EAA0) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::_RESERVEDIOUSBInterfaceUserClientV219(IOUSBInterfaceUserClientV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBInterfaceUserClientV2::gMetaClass, 19);
}
// 49928: using guessed type _QWORD IOUSBInterfaceUserClientV2::gMetaClass;

//----- (000000000002EAB6) ----------------------------------------------------
char __fastcall IOUSBLowLatencyCommand::init(IOUSBLowLatencyCommand *this)
{
  void *v1; // rax@3

  if ( (unsigned __int8)(*(int (__cdecl **)(IOUSBLowLatencyCommand *))(off_3B0D0[0] + 152))(this) )
  {
    if ( *((_QWORD *)this + 16) )
    {
LABEL_5:
      *((_QWORD *)this + 12) = 0LL;
      return 1;
    }
    LODWORD(v1) = IOMalloc(32LL);
    *((_QWORD *)this + 16) = v1;
    if ( v1 )
    {
      bzero(v1, 0x20uLL);
      goto LABEL_5;
    }
  }
  return 0;
}
// 3B0D0: using guessed type __int64 off_3B0D0[8];
// 7D250: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (000000000002EB12) ----------------------------------------------------
int __fastcall IOUSBLowLatencyCommand::free(IOUSBLowLatencyCommand *this)
{
  IOUSBLowLatencyCommand *v1; // rbx@1
  __int64 v2; // rdi@1

  v1 = this;
  v2 = *((_QWORD *)this + 16);
  if ( v2 )
  {
    IOFree(v2, 32LL);
    *((_QWORD *)v1 + 16) = 0LL;
  }
  return (*(int (__fastcall **)(IOUSBLowLatencyCommand *))(off_3B0D0[0] + 160))(v1);
}
// 3B0D0: using guessed type __int64 off_3B0D0[8];
// 7D218: using guessed type int __fastcall IOFree(_QWORD, _QWORD);

//----- (000000000002EB52) ----------------------------------------------------
void __fastcall IOUSBLowLatencyCommand::SetAsyncReference(IOUSBLowLatencyCommand *this, unsigned __int64 *a2)
{
  bcopy(a2, (char *)this + 32, 0x40uLL);
}

//----- (000000000002EB6C) ----------------------------------------------------
void __fastcall IOUSBLowLatencyCommand::SetAsyncCount(IOUSBLowLatencyCommand *this, int a2)
{
  *((_DWORD *)this + 30) = a2;
}

//----- (000000000002EB76) ----------------------------------------------------
__int64 __fastcall IOUSBLowLatencyCommand::_RESERVEDIOUSBLowLatencyCommand0(IOUSBLowLatencyCommand *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBLowLatencyCommand::gMetaClass, 0);
}
// 49950: using guessed type _QWORD IOUSBLowLatencyCommand::gMetaClass;

//----- (000000000002EB8A) ----------------------------------------------------
__int64 __fastcall IOUSBLowLatencyCommand::_RESERVEDIOUSBLowLatencyCommand1(IOUSBLowLatencyCommand *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBLowLatencyCommand::gMetaClass, 1);
}
// 49950: using guessed type _QWORD IOUSBLowLatencyCommand::gMetaClass;

//----- (000000000002EBA0) ----------------------------------------------------
__int64 __fastcall IOUSBLowLatencyCommand::_RESERVEDIOUSBLowLatencyCommand2(IOUSBLowLatencyCommand *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBLowLatencyCommand::gMetaClass, 2);
}
// 49950: using guessed type _QWORD IOUSBLowLatencyCommand::gMetaClass;

//----- (000000000002EBB6) ----------------------------------------------------
__int64 __fastcall IOUSBLowLatencyCommand::_RESERVEDIOUSBLowLatencyCommand3(IOUSBLowLatencyCommand *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBLowLatencyCommand::gMetaClass, 3);
}
// 49950: using guessed type _QWORD IOUSBLowLatencyCommand::gMetaClass;

//----- (000000000002EBCC) ----------------------------------------------------
__int64 __fastcall IOUSBLowLatencyCommand::_RESERVEDIOUSBLowLatencyCommand4(IOUSBLowLatencyCommand *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBLowLatencyCommand::gMetaClass, 4);
}
// 49950: using guessed type _QWORD IOUSBLowLatencyCommand::gMetaClass;

//----- (000000000002EBE2) ----------------------------------------------------
__int64 __fastcall IOUSBLowLatencyCommand::_RESERVEDIOUSBLowLatencyCommand5(IOUSBLowLatencyCommand *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBLowLatencyCommand::gMetaClass, 5);
}
// 49950: using guessed type _QWORD IOUSBLowLatencyCommand::gMetaClass;

//----- (000000000002EBF8) ----------------------------------------------------
__int64 __fastcall IOUSBLowLatencyCommand::_RESERVEDIOUSBLowLatencyCommand6(IOUSBLowLatencyCommand *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBLowLatencyCommand::gMetaClass, 6);
}
// 49950: using guessed type _QWORD IOUSBLowLatencyCommand::gMetaClass;

//----- (000000000002EC0E) ----------------------------------------------------
__int64 __fastcall IOUSBLowLatencyCommand::_RESERVEDIOUSBLowLatencyCommand7(IOUSBLowLatencyCommand *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBLowLatencyCommand::gMetaClass, 7);
}
// 49950: using guessed type _QWORD IOUSBLowLatencyCommand::gMetaClass;

//----- (000000000002EC24) ----------------------------------------------------
__int64 __fastcall IOUSBLowLatencyCommand::_RESERVEDIOUSBLowLatencyCommand8(IOUSBLowLatencyCommand *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBLowLatencyCommand::gMetaClass, 8);
}
// 49950: using guessed type _QWORD IOUSBLowLatencyCommand::gMetaClass;

//----- (000000000002EC3A) ----------------------------------------------------
__int64 __fastcall IOUSBLowLatencyCommand::_RESERVEDIOUSBLowLatencyCommand9(IOUSBLowLatencyCommand *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBLowLatencyCommand::gMetaClass, 9);
}
// 49950: using guessed type _QWORD IOUSBLowLatencyCommand::gMetaClass;

//----- (000000000002EC50) ----------------------------------------------------
__int64 __fastcall IOUSBLowLatencyCommand::_RESERVEDIOUSBLowLatencyCommand10(IOUSBLowLatencyCommand *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBLowLatencyCommand::gMetaClass, 10);
}
// 49950: using guessed type _QWORD IOUSBLowLatencyCommand::gMetaClass;

//----- (000000000002EC66) ----------------------------------------------------
__int64 __fastcall IOUSBLowLatencyCommand::_RESERVEDIOUSBLowLatencyCommand11(IOUSBLowLatencyCommand *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBLowLatencyCommand::gMetaClass, 11);
}
// 49950: using guessed type _QWORD IOUSBLowLatencyCommand::gMetaClass;

//----- (000000000002EC7C) ----------------------------------------------------
__int64 __fastcall IOUSBLowLatencyCommand::_RESERVEDIOUSBLowLatencyCommand12(IOUSBLowLatencyCommand *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBLowLatencyCommand::gMetaClass, 12);
}
// 49950: using guessed type _QWORD IOUSBLowLatencyCommand::gMetaClass;

//----- (000000000002EC92) ----------------------------------------------------
__int64 __fastcall IOUSBLowLatencyCommand::_RESERVEDIOUSBLowLatencyCommand13(IOUSBLowLatencyCommand *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBLowLatencyCommand::gMetaClass, 13);
}
// 49950: using guessed type _QWORD IOUSBLowLatencyCommand::gMetaClass;

//----- (000000000002ECA8) ----------------------------------------------------
__int64 __fastcall IOUSBLowLatencyCommand::_RESERVEDIOUSBLowLatencyCommand14(IOUSBLowLatencyCommand *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBLowLatencyCommand::gMetaClass, 14);
}
// 49950: using guessed type _QWORD IOUSBLowLatencyCommand::gMetaClass;

//----- (000000000002ECBE) ----------------------------------------------------
__int64 __fastcall IOUSBLowLatencyCommand::_RESERVEDIOUSBLowLatencyCommand15(IOUSBLowLatencyCommand *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBLowLatencyCommand::gMetaClass, 15);
}
// 49950: using guessed type _QWORD IOUSBLowLatencyCommand::gMetaClass;

//----- (000000000002ECD4) ----------------------------------------------------
__int64 __fastcall IOUSBLowLatencyCommand::_RESERVEDIOUSBLowLatencyCommand16(IOUSBLowLatencyCommand *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBLowLatencyCommand::gMetaClass, 16);
}
// 49950: using guessed type _QWORD IOUSBLowLatencyCommand::gMetaClass;

//----- (000000000002ECEA) ----------------------------------------------------
__int64 __fastcall IOUSBLowLatencyCommand::_RESERVEDIOUSBLowLatencyCommand17(IOUSBLowLatencyCommand *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBLowLatencyCommand::gMetaClass, 17);
}
// 49950: using guessed type _QWORD IOUSBLowLatencyCommand::gMetaClass;

//----- (000000000002ED00) ----------------------------------------------------
__int64 __fastcall IOUSBLowLatencyCommand::_RESERVEDIOUSBLowLatencyCommand18(IOUSBLowLatencyCommand *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBLowLatencyCommand::gMetaClass, 18);
}
// 49950: using guessed type _QWORD IOUSBLowLatencyCommand::gMetaClass;

//----- (000000000002ED16) ----------------------------------------------------
__int64 __fastcall IOUSBLowLatencyCommand::_RESERVEDIOUSBLowLatencyCommand19(IOUSBLowLatencyCommand *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBLowLatencyCommand::gMetaClass, 19);
}
// 49950: using guessed type _QWORD IOUSBLowLatencyCommand::gMetaClass;

//----- (000000000002ED2C) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV2::MetaClass::~MetaClass(IOUSBInterfaceUserClientV2::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000002ED36) ----------------------------------------------------
__int64 __fastcall IOUSBLowLatencyCommand::MetaClass::~MetaClass(IOUSBLowLatencyCommand::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000002ED40) ----------------------------------------------------
__int64 `global constructor keyed to'_a_15()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(&IOUSBInterfaceUserClientV2::gMetaClass, "IOUSBInterfaceUserClientV2", off_3B030[0], 296LL);
  IOUSBInterfaceUserClientV2::gMetaClass = off_45D60;
  OSMetaClass::OSMetaClass(&IOUSBLowLatencyCommand::gMetaClass, "IOUSBLowLatencyCommand", off_3B090[0], 136LL);
  result = (__int64)off_46040;
  IOUSBLowLatencyCommand::gMetaClass = off_46040;
  return result;
}
// 3B030: using guessed type _QWORD *off_3B030[5];
// 3B090: using guessed type _QWORD off_3B090[16];
// 45D60: using guessed type __int64 (__fastcall *off_45D60[2])(IOUSBInterfaceUserClientV2::MetaClass *__hidden this);
// 46040: using guessed type __int64 (__fastcall *off_46040[2])(IOUSBLowLatencyCommand::MetaClass *__hidden this);
// 49928: using guessed type _QWORD IOUSBInterfaceUserClientV2::gMetaClass;
// 49950: using guessed type _QWORD IOUSBLowLatencyCommand::gMetaClass;
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000002EDA0) ----------------------------------------------------
__int64 `global destructor keyed to'_a_15()
{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOUSBLowLatencyCommand::gMetaClass);
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&IOUSBInterfaceUserClientV2::gMetaClass);
}
// 49928: using guessed type _QWORD IOUSBInterfaceUserClientV2::gMetaClass;
// 49950: using guessed type _QWORD IOUSBLowLatencyCommand::gMetaClass;

//----- (000000000002EDC0) ----------------------------------------------------
__int64 __fastcall IOUSBNotification::MetaClass::MetaClass(IOUSBNotification::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBNotification", off_3B080[0], 120LL);
  result = (__int64)off_46560;
  *(_QWORD *)this = off_46560;
  return result;
}
// 3B080: using guessed type _QWORD off_3B080[18];
// 46560: using guessed type __int64 (__fastcall *off_46560[2])(IOUSBNotification::MetaClass *__hidden this);
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000002EDF2) ----------------------------------------------------
__int64 __fastcall IOUSBNotification::MetaClass::~MetaClass(IOUSBNotification::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000002EDFC) ----------------------------------------------------
__int64 __fastcall IOUSBNotification::IOUSBNotification(__int64 a1)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1);
  result = (__int64)off_46430;
  *(_QWORD *)a1 = off_46430;
  return result;
}
// 46430: using guessed type __int64 (__fastcall *off_46430[2])(IOUSBNotification *__hidden this);
// 7D998: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (000000000002EE1C) ----------------------------------------------------
__int64 __fastcall IOUSBNotification::IOUSBNotification(__int64 a1)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1);
  result = (__int64)off_46430;
  *(_QWORD *)a1 = off_46430;
  return result;
}
// 46430: using guessed type __int64 (__fastcall *off_46430[2])(IOUSBNotification *__hidden this);
// 7D998: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (000000000002EE3C) ----------------------------------------------------
__int64 __fastcall IOUSBNotification::~IOUSBNotification(IOUSBNotification *this)
{
  return OSObject::~OSObject(this);
}

//----- (000000000002EE46) ----------------------------------------------------
__int64 __fastcall IOUSBNotification::~IOUSBNotification(IOUSBNotification *this)
{
  return OSObject::~OSObject(this);
}

//----- (000000000002EE50) ----------------------------------------------------
void __fastcall IOUSBNotification::~IOUSBNotification(IOUSBNotification *this)
{
  OSObject::~OSObject(this);
  OSObject::operator delete((void *)this);
}

//----- (000000000002EE72) ----------------------------------------------------
__int64 __fastcall IOUSBNotification::getMetaClass(IOUSBNotification *this)
{
  return (__int64)&IOUSBNotification::gMetaClass;
}
// 49978: using guessed type _QWORD IOUSBNotification::gMetaClass;

//----- (000000000002EE80) ----------------------------------------------------
__int64 __fastcall IOUSBNotification::MetaClass::MetaClass(IOUSBNotification::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBNotification", off_3B080[0], 120LL);
  result = (__int64)off_46560;
  *(_QWORD *)this = off_46560;
  return result;
}
// 3B080: using guessed type _QWORD off_3B080[18];
// 46560: using guessed type __int64 (__fastcall *off_46560[2])(IOUSBNotification::MetaClass *__hidden this);
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000002EEB2) ----------------------------------------------------
__int64 __fastcall IOUSBNotification::MetaClass::alloc(IOUSBNotification::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)stru_68.segname, a2);
  OSObject::OSObject(v2);
  *(_QWORD *)v2 = off_46430;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBNotification::gMetaClass);
  return v2;
}
// 68: using guessed type section_64 stru_68;
// 46430: using guessed type __int64 (__fastcall *off_46430[2])(IOUSBNotification *__hidden this);
// 49978: using guessed type _QWORD IOUSBNotification::gMetaClass;
// 7D998: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (000000000002EEF2) ----------------------------------------------------
__int64 __fastcall IOUSBNotification::IOUSBNotification(__int64 a1)
{
  OSObject::OSObject(a1);
  *(_QWORD *)a1 = off_46430;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBNotification::gMetaClass);
}
// 46430: using guessed type __int64 (__fastcall *off_46430[2])(IOUSBNotification *__hidden this);
// 49978: using guessed type _QWORD IOUSBNotification::gMetaClass;
// 7D998: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (000000000002EF22) ----------------------------------------------------
__int64 __fastcall IOUSBNotification::IOUSBNotification(__int64 a1)
{
  OSObject::OSObject(a1);
  *(_QWORD *)a1 = off_46430;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBNotification::gMetaClass);
}
// 46430: using guessed type __int64 (__fastcall *off_46430[2])(IOUSBNotification *__hidden this);
// 49978: using guessed type _QWORD IOUSBNotification::gMetaClass;
// 7D998: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (000000000002EF52) ----------------------------------------------------
__int64 __fastcall IOUSBNotification::withUserClient(IOUSBNotification *this, IOUserClient *a2)
{
  __int64 v2; // rax@1
  __int64 v3; // rbx@1

  LODWORD(v2) = (*(int (__fastcall **)(_QWORD *, IOUserClient *))(IOUSBNotification::gMetaClass + 136LL))(
                  &IOUSBNotification::gMetaClass,
                  a2);
  v3 = v2;
  if ( v2 && (unsigned __int8)(*(int (__fastcall **)(__int64))(*(_QWORD *)v2 + 136LL))(v2) )
    *(_QWORD *)(v3 + 16) = this;
  return v3;
}
// 49978: using guessed type _QWORD IOUSBNotification::gMetaClass;

//----- (000000000002EF94) ----------------------------------------------------
__int64 __fastcall IOUSBNotification::SendNotification(IOUSBNotification *this, __int64 a2, void *a3, __int64 a4, unsigned int a5)
{
  __int64 v5; // rbx@1
  __int64 result; // rax@1
  __int64 v7; // rcx@1
  int v8[2]; // [sp+0h] [bp-20h]@1
  void *v9; // [sp+8h] [bp-18h]@1
  __int64 v10; // [sp+10h] [bp-10h]@1

  v5 = off_3B0E0[0];
  v10 = *(_QWORD *)off_3B0E0[0];
  *(_QWORD *)v8 = a2;
  v9 = a3;
  result = IOUserClient::sendAsyncResult64(
             (IOUSBNotification *)((char *)this + 48),
             0LL,
             (unsigned __int64)v8,
             (unsigned __int64 *)((char *)&dword_0 + 2),
             a5);
  v7 = *(_QWORD *)v5;
  return result;
}
// 0: using guessed type int dword_0;
// 3B0E0: using guessed type __int64 off_3B0E0[6];

//----- (000000000002EFDC) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::SendNotification(IOUSBDeviceUserClientV2 *this, unsigned __int64 (*a2)[8], unsigned __int64 *a3, __int64 a4, unsigned int a5)
{
  return IOUserClient::sendAsyncResult64(this, 0LL, (int)a2, (unsigned __int64 *)(unsigned int)a3, a5);
}

//----- (000000000002EFF2) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::MetaClass::MetaClass(IOUSBDeviceUserClientV2::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBDeviceUserClientV2", off_3B030[0], 272LL);
  result = (__int64)off_47160;
  *(_QWORD *)this = off_47160;
  return result;
}
// 3B030: using guessed type _QWORD *off_3B030[5];
// 47160: using guessed type __int64 (__fastcall *off_47160[2])(IOUSBDeviceUserClientV2::MetaClass *__hidden this);
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000002F024) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::MetaClass::~MetaClass(IOUSBDeviceUserClientV2::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000002F02E) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::IOUSBDeviceUserClientV2(__int64 a1)
{
  __int64 result; // rax@1

  IOUserClient::IOUserClient(a1);
  result = (__int64)off_46660;
  *(_QWORD *)a1 = off_46660;
  return result;
}
// 46660: using guessed type __int64 (__fastcall *off_46660[2])(IOUSBDeviceUserClientV2 *__hidden this);
// 7D578: using guessed type int __cdecl IOUserClient::IOUserClient(_QWORD);

//----- (000000000002F04E) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::IOUSBDeviceUserClientV2(__int64 a1)
{
  __int64 result; // rax@1

  IOUserClient::IOUserClient(a1);
  result = (__int64)off_46660;
  *(_QWORD *)a1 = off_46660;
  return result;
}
// 46660: using guessed type __int64 (__fastcall *off_46660[2])(IOUSBDeviceUserClientV2 *__hidden this);
// 7D578: using guessed type int __cdecl IOUserClient::IOUserClient(_QWORD);

//----- (000000000002F06E) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::~IOUSBDeviceUserClientV2(IOUSBDeviceUserClientV2 *this)
{
  return IOUserClient::~IOUserClient(this);
}

//----- (000000000002F078) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::~IOUSBDeviceUserClientV2(IOUSBDeviceUserClientV2 *this)
{
  return IOUserClient::~IOUserClient(this);
}

//----- (000000000002F082) ----------------------------------------------------
void __fastcall IOUSBDeviceUserClientV2::~IOUSBDeviceUserClientV2(IOUSBDeviceUserClientV2 *this)
{
  IOUserClient::~IOUserClient(this);
  OSObject::operator delete((void *)this);
}

//----- (000000000002F0A4) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::getMetaClass(IOUSBDeviceUserClientV2 *this)
{
  return (__int64)&IOUSBDeviceUserClientV2::gMetaClass;
}
// 499A0: using guessed type _QWORD IOUSBDeviceUserClientV2::gMetaClass;

//----- (000000000002F0B2) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::MetaClass::MetaClass(IOUSBDeviceUserClientV2::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBDeviceUserClientV2", off_3B030[0], 272LL);
  result = (__int64)off_47160;
  *(_QWORD *)this = off_47160;
  return result;
}
// 3B030: using guessed type _QWORD *off_3B030[5];
// 47160: using guessed type __int64 (__fastcall *off_47160[2])(IOUSBDeviceUserClientV2::MetaClass *__hidden this);
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (000000000002F0E4) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::MetaClass::alloc(IOUSBDeviceUserClientV2::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&stru_108.sectname[8], a2);
  IOUserClient::IOUserClient(v2);
  *(_QWORD *)v2 = off_46660;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBDeviceUserClientV2::gMetaClass);
  return v2;
}
// 108: using guessed type section_64 stru_108;
// 46660: using guessed type __int64 (__fastcall *off_46660[2])(IOUSBDeviceUserClientV2 *__hidden this);
// 499A0: using guessed type _QWORD IOUSBDeviceUserClientV2::gMetaClass;
// 7D578: using guessed type int __cdecl IOUserClient::IOUserClient(_QWORD);

//----- (000000000002F124) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::IOUSBDeviceUserClientV2(__int64 a1)
{
  IOUserClient::IOUserClient(a1);
  *(_QWORD *)a1 = off_46660;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBDeviceUserClientV2::gMetaClass);
}
// 46660: using guessed type __int64 (__fastcall *off_46660[2])(IOUSBDeviceUserClientV2 *__hidden this);
// 499A0: using guessed type _QWORD IOUSBDeviceUserClientV2::gMetaClass;
// 7D578: using guessed type int __cdecl IOUserClient::IOUserClient(_QWORD);

//----- (000000000002F154) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::IOUSBDeviceUserClientV2(__int64 a1)
{
  IOUserClient::IOUserClient(a1);
  *(_QWORD *)a1 = off_46660;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBDeviceUserClientV2::gMetaClass);
}
// 46660: using guessed type __int64 (__fastcall *off_46660[2])(IOUSBDeviceUserClientV2 *__hidden this);
// 499A0: using guessed type _QWORD IOUSBDeviceUserClientV2::gMetaClass;
// 7D578: using guessed type int __cdecl IOUserClient::IOUserClient(_QWORD);

//----- (000000000002F184) ----------------------------------------------------
signed __int64 __fastcall IOUSBDeviceUserClientV2::_open(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rax@1
  int v5; // er14@4
  signed __int64 result; // rax@4

  v3 = a3;
  v4 = *(_QWORD *)(a1 + 264);
  if ( v4 && *(_BYTE *)(v4 + 202) && !*(_BYTE *)(v4 + 201) )
  {
    result = 3758097122LL;
  }
  else
  {
    (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
    v5 = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)a1 + 2400LL))(a1, **(_QWORD **)(v3 + 32) != 0LL);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
    result = (unsigned int)v5;
  }
  return result;
}

//----- (000000000002F1EE) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::_close(IOService *this)
{
  __int64 v1; // rax@1
  int v2; // er12@3
  __int64 v3; // r14@5
  __int64 v4; // r15@6

  v1 = *((_QWORD *)this + 33);
  if ( !v1 || !*(_BYTE *)(v1 + 202) || (v2 = -536870174, *(_BYTE *)(v1 + 201)) )
  {
    (*(void (**)(void))(*(_QWORD *)this + 32LL))();
    if ( !(unsigned __int8)IOService::isInactive(this)
      && (v3 = *((_QWORD *)this + 30)) != 0
      && (v4 = *((_QWORD *)this + 31)) != 0 )
    {
      (*(void (__fastcall **)(_QWORD))(*(_QWORD *)v4 + 32LL))(*((_QWORD *)this + 31));
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 32LL))(v3);
      v2 = (*(int (__fastcall **)(__int64, int (__fastcall *)(IOUSBDeviceUserClientV2 *, OSObject *, void *, void *, void *, void *), _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v3 + 456LL))(
             v3,
             IOUSBDeviceUserClientV2::closeGated,
             0LL,
             0LL,
             0LL,
             0LL);
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 40LL))(v3);
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v4 + 40LL))(v4);
    }
    else
    {
      v2 = (*(int (__fastcall **)(IOService *))(*(_QWORD *)this + 2408LL))(this);
    }
    (*(void (__fastcall **)(IOService *))(*(_QWORD *)this + 40LL))(this);
  }
  return (unsigned int)v2;
}

//----- (000000000002F2BC) ----------------------------------------------------
signed __int64 __fastcall IOUSBDeviceUserClientV2::_SetConfiguration(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rax@1
  int v5; // er14@4
  signed __int64 result; // rax@4

  v3 = a3;
  v4 = *(_QWORD *)(a1 + 264);
  if ( v4 && *(_BYTE *)(v4 + 202) && !*(_BYTE *)(v4 + 201) )
  {
    result = 3758097122LL;
  }
  else
  {
    (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
    v5 = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)a1 + 2424LL))(a1, **(_BYTE **)(v3 + 32));
    (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
    result = (unsigned int)v5;
  }
  return result;
}

//----- (000000000002F31E) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::_GetConfiguration(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1

  v3 = a3;
  (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
  LODWORD(v3) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)a1 + 2432LL))(a1, *(_QWORD *)(v3 + 72));
  (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
  return (unsigned int)v3;
}

//----- (000000000002F356) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::_GetConfigDescriptor(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rbx@1
  __int64 v4; // rdx@1
  int v5; // eax@2
  int v6; // ebx@4

  v3 = a3;
  (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
  v4 = *(_QWORD *)(v3 + 104);
  if ( v4 )
    v5 = (*(int (__fastcall **)(__int64, _QWORD, __int64, signed __int64))(*(_QWORD *)a1 + 2448LL))(
           a1,
           **(_BYTE **)(v3 + 32),
           v4,
           v3 + 112);
  else
    v5 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, signed __int64))(*(_QWORD *)a1 + 2440LL))(
           a1,
           **(_BYTE **)(v3 + 32),
           *(_QWORD *)(v3 + 88),
           v3 + 96);
  v6 = v5;
  (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
  return (unsigned int)v6;
}

//----- (000000000002F3BE) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::_GetFrameNumber(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1

  v3 = a3;
  (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
  LODWORD(v3) = (*(int (__fastcall **)(__int64, _QWORD, signed __int64))(*(_QWORD *)a1 + 2544LL))(
                  a1,
                  *(_QWORD *)(v3 + 88),
                  v3 + 96);
  (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
  return (unsigned int)v3;
}

//----- (000000000002F3FC) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::_DeviceRequestOut(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rax@1
  signed int v5; // ebx@3
  unsigned int v6; // ecx@4
  __int64 v7; // rdx@5
  __int64 v8; // rsi@5
  __int64 v9; // rax@10
  __int64 v10; // r15@10
  __int64 v11; // rsi@11
  int v12; // ST10_4@11
  int v13; // ST08_4@11
  __int64 v14; // ST00_8@11
  int v15; // er14@11
  __int64 v16; // rsi@14
  int v17; // ST00_4@14
  int v18; // eax@14
  __int64 v19; // rsi@15
  int v20; // ST10_4@15
  __int64 v21; // ST08_8@15
  int v22; // ST00_4@15
  __int64 v24; // [sp+28h] [bp-38h]@11
  __int64 (__fastcall *v25)(IOUSBDeviceUserClientV2 *, void *, void *, unsigned int); // [sp+30h] [bp-30h]@11
  __int64 v26; // [sp+38h] [bp-28h]@11

  v3 = a3;
  v4 = *(_QWORD *)(a1 + 264);
  if ( !v4 || !*(_BYTE *)(v4 + 202) || (v5 = -536870174, *(_BYTE *)(v4 + 201)) )
  {
    v6 = *(_DWORD *)(v4 + 176);
    if ( v6 )
    {
      v7 = *(_QWORD *)(*(_QWORD *)(a3 + 32) + 8LL) | (*(_QWORD *)(*(_QWORD *)(a3 + 32) + 32LL) << 32) | (*(_QWORD *)(*(_QWORD *)(a3 + 32) + 24LL) << 16) | (*(_QWORD *)(*(_QWORD *)(a3 + 32) + 16LL) << 8);
      v8 = 0LL;
      while ( 1 )
      {
        if ( *(_QWORD *)(v4 + 8 * v8 + 16) == v7 )
        {
          v5 = -536870174;
          if ( !*(_BYTE *)(v4 + 8) )
            break;
        }
        ++v8;
        if ( (unsigned int)v8 >= v6 )
          goto LABEL_9;
      }
    }
    else
    {
LABEL_9:
      if ( *(_QWORD *)(v3 + 8) )
      {
        LODWORD(v9) = IOMalloc(104LL);
        v10 = v9;
        v5 = -536870211;
        if ( v9 )
        {
          (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 32LL))(a1);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 2608LL))(a1);
          bcopy(*(const void **)(v3 + 16), (void *)v10, 0x40uLL);
          *(_DWORD *)(v10 + 64) = *(_DWORD *)(v3 + 24);
          v24 = a1;
          v25 = IOUSBDeviceUserClientV2::ReqComplete;
          v26 = v10;
          v11 = *(_QWORD *)(v3 + 32);
          v12 = *(_DWORD *)(v11 + 64);
          v13 = *(_DWORD *)(v11 + 56);
          v14 = *(_QWORD *)(v11 + 48);
          v15 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 2488LL))(
                  a1,
                  *(_BYTE *)(v11 + 8),
                  *(_BYTE *)(v11 + 16),
                  *(_WORD *)(v11 + 24),
                  *(_WORD *)(v11 + 32),
                  *(_QWORD *)(v11 + 40));
          v5 = 0;
          if ( v15 )
          {
            IOFree(v10, 104LL);
            (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)a1 + 2600LL))(a1, 104LL);
            (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
            v5 = v15;
          }
        }
      }
      else
      {
        (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 32LL))(a1);
        if ( *(_QWORD *)(v3 + 64) )
        {
          v16 = *(_QWORD *)(v3 + 32);
          v17 = *(_DWORD *)(v16 + 64);
          v18 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 2504LL))(
                  a1,
                  *(_BYTE *)(v16 + 8),
                  *(_BYTE *)(v16 + 16),
                  *(_WORD *)(v16 + 24),
                  *(_WORD *)(v16 + 32),
                  *(_DWORD *)(v16 + 56));
        }
        else
        {
          v19 = *(_QWORD *)(v3 + 32);
          v20 = *(_DWORD *)(v3 + 56);
          v21 = *(_QWORD *)(v3 + 48);
          v22 = *(_DWORD *)(v19 + 64);
          v18 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 2496LL))(
                  a1,
                  *(_BYTE *)(v19 + 8),
                  *(_BYTE *)(v19 + 16),
                  *(_WORD *)(v19 + 24),
                  *(_WORD *)(v19 + 32),
                  *(_DWORD *)(v19 + 56));
        }
        v5 = v18;
        (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
      }
    }
  }
  return (unsigned int)v5;
}
// 7D218: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// 7D250: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (000000000002F610) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::_DeviceRequestIn(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rax@1
  signed int v5; // ebx@3
  __int64 v6; // rax@5
  __int64 v7; // r15@5
  __int64 v8; // rsi@6
  int v9; // ST10_4@6
  int v10; // ST08_4@6
  __int64 v11; // ST00_8@6
  int v12; // er14@6
  __int64 v13; // rsi@9
  int v14; // ST00_4@9
  int v15; // eax@9
  __int64 v16; // rsi@10
  __int64 v17; // ST08_8@10
  int v18; // ST00_4@10
  __int64 v19; // rax@12
  __int64 v21; // [sp+28h] [bp-38h]@6
  __int64 (__fastcall *v22)(IOUSBDeviceUserClientV2 *, void *, void *, unsigned int); // [sp+30h] [bp-30h]@6
  __int64 v23; // [sp+38h] [bp-28h]@6

  v3 = a3;
  v4 = *(_QWORD *)(a1 + 264);
  if ( !v4 || !*(_BYTE *)(v4 + 202) || (v5 = -536870174, *(_BYTE *)(v4 + 201)) )
  {
    if ( *(_QWORD *)(a3 + 8) )
    {
      LODWORD(v6) = IOMalloc(104LL);
      v7 = v6;
      v5 = -536870211;
      if ( v6 )
      {
        (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 32LL))(a1);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 2608LL))(a1);
        bcopy(*(const void **)(v3 + 16), (void *)v7, 0x40uLL);
        *(_DWORD *)(v7 + 64) = *(_DWORD *)(v3 + 24);
        v21 = a1;
        v22 = IOUSBDeviceUserClientV2::ReqComplete;
        v23 = v7;
        v8 = *(_QWORD *)(v3 + 32);
        v9 = *(_DWORD *)(v8 + 64);
        v10 = *(_DWORD *)(v8 + 56);
        v11 = *(_QWORD *)(v8 + 48);
        v12 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 2464LL))(
                a1,
                *(_BYTE *)(v8 + 8),
                *(_BYTE *)(v8 + 16),
                *(_WORD *)(v8 + 24),
                *(_WORD *)(v8 + 32),
                *(_QWORD *)(v8 + 40));
        v5 = 0;
        if ( v12 )
        {
          IOFree(v7, 104LL);
          (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)a1 + 2600LL))(a1, 104LL);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
          v5 = v12;
        }
      }
    }
    else
    {
      (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
      if ( *(_QWORD *)(v3 + 104) )
      {
        v13 = *(_QWORD *)(v3 + 32);
        v14 = *(_DWORD *)(v13 + 64);
        v15 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 2480LL))(
                a1,
                *(_BYTE *)(v13 + 8),
                *(_BYTE *)(v13 + 16),
                *(_WORD *)(v13 + 24),
                *(_WORD *)(v13 + 32),
                *(_DWORD *)(v13 + 56));
      }
      else
      {
        v16 = *(_QWORD *)(v3 + 32);
        v17 = *(_QWORD *)(v3 + 88);
        v18 = *(_DWORD *)(v16 + 64);
        v15 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 2472LL))(
                a1,
                *(_BYTE *)(v16 + 8),
                *(_BYTE *)(v16 + 16),
                *(_WORD *)(v16 + 24),
                *(_WORD *)(v16 + 32),
                *(_DWORD *)(v16 + 56));
      }
      v5 = v15;
      if ( *(_DWORD *)(v3 + 80) )
      {
        v19 = *(_QWORD *)(v3 + 72);
        if ( v5 == -536870168 )
        {
          *(_QWORD *)v19 = 1LL;
          v5 = 0;
        }
        else
        {
          *(_QWORD *)v19 = 0LL;
        }
      }
      (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
    }
  }
  return (unsigned int)v5;
}
// 7D218: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// 7D250: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (000000000002F806) ----------------------------------------------------
__int64 __usercall IOUSBDeviceUserClientV2::_CreateInterfaceIterator@<rax>(__int64 a1@<rax>, __int64 a2@<rdx>, __int64 a3@<rdi>)
{
  __int64 v3; // r14@1
  __int64 v4; // rax@1
  int v5; // er15@3
  __int64 v6; // rax@4
  __int64 v8; // [sp+0h] [bp-20h]@1

  v8 = a1;
  v3 = a2;
  v4 = *(_QWORD *)(a3 + 264);
  if ( !v4 || !*(_BYTE *)(v4 + 202) || (v5 = -536870174, *(_BYTE *)(v4 + 201)) )
  {
    (*(void (__cdecl **)(__int64))(*(_QWORD *)a3 + 32LL))(a3);
    v6 = *(_QWORD *)(v3 + 32);
    LOWORD(v8) = *(_WORD *)v6;
    WORD1(v8) = *(_WORD *)(v6 + 8);
    WORD2(v8) = *(_WORD *)(v6 + 16);
    WORD3(v8) = *(_WORD *)(v6 + 24);
    v5 = (*(int (__fastcall **)(__int64, __int64 *, _QWORD))(*(_QWORD *)a3 + 2624LL))(a3, &v8, *(_QWORD *)(v3 + 72));
    (*(void (__fastcall **)(__int64))(*(_QWORD *)a3 + 40LL))(a3);
  }
  return (unsigned int)v5;
}

//----- (000000000002F894) ----------------------------------------------------
signed __int64 __fastcall IOUSBDeviceUserClientV2::_ResetDevice(__int64 a1)
{
  __int64 v1; // rax@1
  int v2; // er14@4
  signed __int64 result; // rax@4

  v1 = *(_QWORD *)(a1 + 264);
  if ( v1 && *(_BYTE *)(v1 + 202) && !*(_BYTE *)(v1 + 201) )
  {
    result = 3758097122LL;
  }
  else
  {
    (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
    v2 = (*(int (__fastcall **)(__int64))(*(_QWORD *)a1 + 2520LL))(a1);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
    result = (unsigned int)v2;
  }
  return result;
}

//----- (000000000002F8EC) ----------------------------------------------------
signed __int64 __fastcall IOUSBDeviceUserClientV2::_SuspendDevice(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rax@1
  int v5; // er14@4
  signed __int64 result; // rax@4

  v3 = a3;
  v4 = *(_QWORD *)(a1 + 264);
  if ( v4 && *(_BYTE *)(v4 + 202) && !*(_BYTE *)(v4 + 201) )
  {
    result = 3758097122LL;
  }
  else
  {
    (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
    v5 = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)a1 + 2528LL))(a1, **(_QWORD **)(v3 + 32) != 0LL);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
    result = (unsigned int)v5;
  }
  return result;
}

//----- (000000000002F956) ----------------------------------------------------
signed __int64 __fastcall IOUSBDeviceUserClientV2::_AbortPipeZero(__int64 a1)
{
  __int64 v1; // rax@1
  int v2; // er14@4
  signed __int64 result; // rax@4

  v1 = *(_QWORD *)(a1 + 264);
  if ( v1 && *(_BYTE *)(v1 + 202) && !*(_BYTE *)(v1 + 201) )
  {
    result = 3758097122LL;
  }
  else
  {
    (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
    v2 = (*(int (__fastcall **)(__int64))(*(_QWORD *)a1 + 2416LL))(a1);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
    result = (unsigned int)v2;
  }
  return result;
}

//----- (000000000002F9AE) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::_ReEnumerateDevice(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1

  v3 = a3;
  (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
  LODWORD(v3) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)a1 + 2536LL))(a1, **(_DWORD **)(v3 + 32));
  (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
  return (unsigned int)v3;
}

//----- (000000000002F9E8) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::_GetMicroFrameNumber(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1

  v3 = a3;
  (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
  LODWORD(v3) = (*(int (__fastcall **)(__int64, _QWORD, signed __int64))(*(_QWORD *)a1 + 2552LL))(
                  a1,
                  *(_QWORD *)(v3 + 88),
                  v3 + 96);
  (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
  return (unsigned int)v3;
}

//----- (000000000002FA26) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::_GetFrameNumberWithTime(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1

  v3 = a3;
  (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
  LODWORD(v3) = (*(int (__fastcall **)(__int64, _QWORD, signed __int64))(*(_QWORD *)a1 + 2560LL))(
                  a1,
                  *(_QWORD *)(v3 + 88),
                  v3 + 96);
  (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
  return (unsigned int)v3;
}

//----- (000000000002FA64) ----------------------------------------------------
int __fastcall IOUSBDeviceUserClientV2::_SetAsyncPort(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // rax@1
  int result; // eax@4

  v3 = *(_QWORD *)(a1 + 264);
  if ( v3 && *(_BYTE *)(v3 + 202) && !*(_BYTE *)(v3 + 201) )
    result = -536870174;
  else
    result = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)a1 + 2512LL))(a1, *(_QWORD *)(a3 + 8));
  return result;
}

//----- (000000000002FA9E) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::_GetDeviceInformation(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1

  v3 = a3;
  (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
  LODWORD(v3) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)a1 + 2568LL))(a1, *(_QWORD *)(v3 + 72));
  (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
  return (unsigned int)v3;
}

//----- (000000000002FAD6) ----------------------------------------------------
signed __int64 __fastcall IOUSBDeviceUserClientV2::_RequestExtraPower(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rax@1
  int v5; // er14@4
  signed __int64 result; // rax@4

  v3 = a3;
  v4 = *(_QWORD *)(a1 + 264);
  if ( v4 && *(_BYTE *)(v4 + 202) && !*(_BYTE *)(v4 + 201) )
  {
    result = 3758097122LL;
  }
  else
  {
    (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
    v5 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 2576LL))(
           a1,
           **(_DWORD **)(v3 + 32),
           *(_DWORD *)(*(_QWORD *)(v3 + 32) + 8LL),
           *(_QWORD *)(v3 + 72));
    (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
    result = (unsigned int)v5;
  }
  return result;
}

//----- (000000000002FB3E) ----------------------------------------------------
signed __int64 __fastcall IOUSBDeviceUserClientV2::_ReturnExtraPower(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rax@1
  int v5; // er14@4
  signed __int64 result; // rax@4

  v3 = a3;
  v4 = *(_QWORD *)(a1 + 264);
  if ( v4 && *(_BYTE *)(v4 + 202) && !*(_BYTE *)(v4 + 201) )
  {
    result = 3758097122LL;
  }
  else
  {
    (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
    v5 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD))(*(_QWORD *)a1 + 2584LL))(
           a1,
           **(_DWORD **)(v3 + 32),
           *(_DWORD *)(*(_QWORD *)(v3 + 32) + 8LL));
    (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
    result = (unsigned int)v5;
  }
  return result;
}

//----- (000000000002FBA2) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::_GetExtraPowerAllocated(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1

  v3 = a3;
  (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
  LODWORD(v3) = (*(int (__fastcall **)(__int64, _QWORD, _QWORD))(*(_QWORD *)a1 + 2592LL))(
                  a1,
                  **(_DWORD **)(v3 + 32),
                  *(_QWORD *)(v3 + 72));
  (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
  return (unsigned int)v3;
}

//----- (000000000002FBE0) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::_GetBandwidthAvailableForDevice(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1

  v3 = a3;
  (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
  LODWORD(v3) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)a1 + 2640LL))(a1, *(_QWORD *)(v3 + 72));
  (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
  return (unsigned int)v3;
}

//----- (000000000002FC18) ----------------------------------------------------
signed __int64 __fastcall IOUSBDeviceUserClientV2::_SetConfigurationV2(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rax@1
  int v5; // er14@4
  signed __int64 result; // rax@4

  v3 = a3;
  v4 = *(_QWORD *)(a1 + 264);
  if ( v4 && *(_BYTE *)(v4 + 202) && !*(_BYTE *)(v4 + 201) )
  {
    result = 3758097122LL;
  }
  else
  {
    (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
    v5 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 2648LL))(
           a1,
           **(_BYTE **)(v3 + 32),
           *(_BYTE *)(*(_QWORD *)(v3 + 32) + 8LL) != 0,
           *(_BYTE *)(*(_QWORD *)(v3 + 32) + 16LL) != 0);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
    result = (unsigned int)v5;
  }
  return result;
}

//----- (000000000002FC90) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::_RegisterForNotification(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rbx@1
  __int64 v5; // rax@1
  int v6; // er15@3
  __int64 v7; // rdi@5

  v3 = a3;
  v4 = a1;
  v5 = *(_QWORD *)(a1 + 264);
  if ( !v5 || (!*(_BYTE *)(v5 + 202) || (v6 = -536870174, *(_BYTE *)(v5 + 201))) && (v6 = -536870206, a1) )
  {
    (*(void (__cdecl **)(__int64))(*(_QWORD *)a1 + 32LL))(a1);
    v7 = *(_QWORD *)(a1 + 240);
    v6 = -536870206;
    if ( v7 )
      v6 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v7 + 456LL))(
             v7,
             *(_QWORD *)(*(_QWORD *)v4 + 2656LL),
             **(_QWORD **)(v3 + 32),
             *(_QWORD *)(v3 + 16),
             *(_QWORD *)(v3 + 72),
             0LL);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v4 + 40LL))(v4);
  }
  return (unsigned int)v6;
}

//----- (000000000002FD2A) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::_UnregisterNotification(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rbx@1
  __int64 v5; // rax@1
  int v6; // er15@3
  __int64 v7; // rdi@5

  v3 = a3;
  v4 = a1;
  v5 = *(_QWORD *)(a1 + 264);
  if ( !v5 || (!*(_BYTE *)(v5 + 202) || (v6 = -536870174, *(_BYTE *)(v5 + 201))) && (v6 = -536870206, a1) )
  {
    (*(void (__cdecl **)(__int64))(*(_QWORD *)a1 + 32LL))(a1);
    v7 = *(_QWORD *)(a1 + 240);
    v6 = -536870206;
    if ( v7 )
      v6 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v7 + 456LL))(
             v7,
             *(_QWORD *)(*(_QWORD *)v4 + 2664LL),
             **(_QWORD **)(v3 + 32),
             0LL,
             0LL,
             0LL);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v4 + 40LL))(v4);
  }
  return (unsigned int)v6;
}

//----- (000000000002FDC0) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::_AcknowledgeNotification(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rbx@1
  __int64 v5; // rax@1
  int v6; // er15@3
  __int64 v7; // rdi@5

  v3 = a3;
  v4 = a1;
  v5 = *(_QWORD *)(a1 + 264);
  if ( !v5 || (!*(_BYTE *)(v5 + 202) || (v6 = -536870174, *(_BYTE *)(v5 + 201))) && (v6 = -536870206, a1) )
  {
    (*(void (__cdecl **)(__int64))(*(_QWORD *)a1 + 32LL))(a1);
    v7 = *(_QWORD *)(a1 + 240);
    v6 = -536870206;
    if ( v7 )
      v6 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v7 + 456LL))(
             v7,
             *(_QWORD *)(*(_QWORD *)v4 + 2672LL),
             **(_QWORD **)(v3 + 32),
             0LL,
             0LL,
             0LL);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v4 + 40LL))(v4);
  }
  return (unsigned int)v6;
}

//----- (000000000002FE56) ----------------------------------------------------
int IOUSBDeviceUserClientV2::externalMethod()
{
  return (*(int (**)(void))(off_3B0B8[0] + 2144))();
}
// 3B0B8: using guessed type __int64 off_3B0B8[11];

//----- (000000000002FE86) ----------------------------------------------------
signed __int64 __fastcall IOUSBDeviceUserClientV2::SetAsyncPort(__int64 a1, __int64 a2)
{
  __int64 v2; // rbx@1
  __int64 v3; // rdi@1
  signed __int64 result; // rax@3

  v2 = a1;
  v3 = *(_QWORD *)(a1 + 232);
  if ( v3 )
  {
    IOUserClient::releaseNotificationPort(v3);
    *(_QWORD *)(v2 + 232) = 0LL;
  }
  result = 3758097113LL;
  if ( *(_QWORD *)(v2 + 216) )
  {
    *(_QWORD *)(v2 + 232) = a2;
    result = 0LL;
  }
  return result;
}
// 7D518: using guessed type int __cdecl IOUserClient::releaseNotificationPort(_QWORD);

//----- (000000000002FECC) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::ReqComplete(IOUSBDeviceUserClientV2 *this, void *a2, void *a3, unsigned int a4)
{
  unsigned int v4; // er12@1
  int v5; // er15@1
  void *v6; // r14@1
  __int64 v7; // r13@1
  unsigned __int64 *v8; // rsi@1
  uintptr_t v9; // rbx@1
  unsigned int v10; // er8@1
  __int64 v11; // rdi@9
  int v13[2]; // [sp+8h] [bp-38h]@7
  __int64 v14; // [sp+10h] [bp-30h]@1

  v4 = a4;
  v5 = (signed int)a3;
  v6 = a2;
  v7 = off_3B0E0[0];
  v14 = *(_QWORD *)off_3B0E0[0];
  v8 = &IOUSBDeviceUserClientV2::gMetaClass;
  v9 = OSMetaClassBase::safeMetaCast(
         this,
         (const OSMetaClassBase *)&IOUSBDeviceUserClientV2::gMetaClass,
         (const OSMetaClass *)a3);
  if ( v9 )
  {
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      v8 = (unsigned __int64 *)v9;
      kernel_debug(0x52D0C14u, v9, v5, v4, *((_DWORD *)v6 + 17), 0LL);
    }
    if ( v5 != -536870168 && v5 )
      *(_QWORD *)v13 = 0LL;
    else
      *(_QWORD *)v13 = *((_DWORD *)v6 + 17) - v4;
    v11 = *((_QWORD *)v6 + 9);
    if ( v11 )
    {
      v8 = 0LL;
      (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v11 + 504LL))(v11, 0LL);
      (*(void (**)(void))(**((_QWORD **)v6 + 9) + 40LL))();
    }
    if ( !*(_BYTE *)(v9 + 260) )
    {
      v8 = (unsigned __int64 *)(unsigned int)v5;
      IOUserClient::sendAsyncResult64(
        (IOUserClient *)v6,
        (unsigned __int64 *)(unsigned int)v5,
        (unsigned __int64)v13,
        (unsigned __int64 *)((char *)&dword_0 + 1),
        v10);
    }
    IOUserClient::releaseAsyncReference64((IOUserClient *)v6, v8);
    IOFree(v6, 104LL);
    (*(void (__fastcall **)(uintptr_t, signed __int64))(*(_QWORD *)v9 + 2600LL))(v9, 104LL);
    (*(void (__fastcall **)(uintptr_t))(*(_QWORD *)v9 + 40LL))(v9);
  }
  return *(_QWORD *)v7;
}
// 0: using guessed type int dword_0;
// 3B0E0: using guessed type __int64 off_3B0E0[6];
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 499A0: using guessed type _QWORD IOUSBDeviceUserClientV2::gMetaClass;
// 7D218: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000002FFE8) ----------------------------------------------------
char __fastcall IOUSBDeviceUserClientV2::initWithTask(IOUSBDeviceUserClientV2 *this, task *a2, void *a3, unsigned int a4, OSDictionary *a5)
{
  OSDictionary *v5; // r12@1
  unsigned int v6; // er13@1
  IOUserClient *v7; // r15@1
  void *v8; // rax@2
  const char *v9; // rdx@6
  unsigned __int8 v10; // cl@6
  char result; // al@6

  v5 = a5;
  v6 = a4;
  v7 = (IOUserClient *)a3;
  if ( !*((_QWORD *)this + 33) )
  {
    LODWORD(v8) = IOMalloc(208LL);
    *((_QWORD *)this + 33) = v8;
    if ( !v8 )
      return 0;
    bzero(v8, 0xD0uLL);
  }
  if ( v5 )
    (*(void (__fastcall **)(OSDictionary *, _QWORD, _QWORD))(*(_QWORD *)v5 + 464LL))(
      v5,
      "IOUserClientCrossEndianCompatible",
      **(_QWORD **)off_3B0F8[0]);
  v10 = (*(int (__fastcall **)(IOUSBDeviceUserClientV2 *, task *, IOUserClient *, _QWORD, OSDictionary *))(off_3B0B8[0] + 2288))(
          this,
          a2,
          v7,
          v6,
          v5);
  result = 0;
  if ( a2 )
  {
    if ( !(v10 ^ 1) )
    {
      *(_BYTE *)(*((_QWORD *)this + 33) + 8LL) = (unsigned int)IOUserClient::clientHasPrivilege(v7, "root", v9) == 0;
      *((_QWORD *)this + 28) = a2;
      *((_BYTE *)this + 260) = 0;
      *((_QWORD *)this + 29) = 0LL;
      result = 1;
    }
  }
  return result;
}
// 3B0B8: using guessed type __int64 off_3B0B8[11];
// 3B0F8: using guessed type __int64 off_3B0F8[3];
// 7D250: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (00000000000300D0) ----------------------------------------------------
char __fastcall IOUSBDeviceUserClientV2::start(IOUSBDeviceUserClientV2 *this, IOService *a2)
{
  IOUSBDeviceUserClientV2 *v2; // r14@1
  const OSMetaClass *v3; // rdx@1
  __int64 v4; // rcx@1
  __int64 v5; // r8@1
  __int64 v6; // r9@1
  __int64 v7; // rax@2
  IOService *v8; // rdx@3
  __int64 v9; // r8@3
  __int64 v10; // r9@3
  const char *v11; // rdx@4
  __int64 v12; // rax@4
  __int64 v13; // rax@5
  __int64 v14; // rdx@6
  char v15; // bl@8
  signed __int64 v16; // rsi@9
  __int64 v17; // rax@9
  __int64 v18; // rbx@14
  __int64 v19; // rax@15
  __int64 v20; // rax@17
  __int64 v21; // rax@18
  OSMetaClassBase *v22; // rax@21
  __int64 v23; // rsi@21
  const OSMetaClass *v24; // rdx@21
  int (__cdecl *v25)(OSObject *, void *, void *, void *, void *); // rdx@21
  __int64 v26; // r12@21
  int v27; // eax@24
  const OSMetaClassBase *v28; // r15@25
  unsigned int v29; // ebx@25
  OSMetaClassBase *v30; // rax@26
  const OSMetaClass *v31; // rdx@26
  __int64 v32; // rax@26
  __int64 v33; // rax@27
  __int64 v34; // rcx@27
  __int64 v35; // rcx@30
  __int64 v36; // r8@30
  __int64 v37; // r9@30
  signed __int64 v38; // r15@30
  __int64 v39; // rax@31
  __int64 v40; // rcx@31
  __int64 v41; // r8@31
  __int64 v42; // r9@31
  __int64 v43; // rbx@31
  signed __int64 v44; // rsi@32
  __int64 v45; // rdx@33
  __int64 v46; // rax@39
  __int64 v47; // rdi@40
  char v49; // [sp+0h] [bp-20h]@0

  v2 = this;
  (*(void (**)(void))(*(_QWORD *)this + 32LL))();
  if ( !(unsigned __int8)(*(int (**)(void))(off_3B0B8[0] + 1488))() )
  {
    v14 = (__int64)"IOUSBDeviceUserClientV2::start - super::start returned false!";
LABEL_8:
    v15 = 0;
    KernelDebugLogInternal(1u, 0x55534246u, v14, v4, v5, v6, v49);
    (*(void (__fastcall **)(IOUSBDeviceUserClientV2 *, signed __int64))(*(_QWORD *)this + 40LL))(this, 1431519814LL);
    return v15;
  }
  v7 = OSMetaClassBase::safeMetaCast(a2, (const OSMetaClassBase *)IOUSBDevice::metaClass, v3);
  *((_QWORD *)this + 27) = v7;
  if ( !v7 )
  {
    v14 = (__int64)"IOUSBDeviceUserClientV2::start - provider is NULL!";
    goto LABEL_8;
  }
  (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v7 + 32LL))(v7, IOUSBDevice::metaClass);
  *(_BYTE *)(*((_QWORD *)this + 33) + 182LL) = 0;
  if ( (unsigned __int8)(*(int (__fastcall **)(_QWORD, IOUSBDeviceUserClientV2 *, _QWORD, _QWORD))(**((_QWORD **)this + 27)
                                                                                                 + 1488LL))(
                          *((_QWORD *)this + 27),
                          this,
                          0LL,
                          0LL) )
  {
    *(_BYTE *)(*((_QWORD *)this + 33) + 201LL) = (unsigned int)IOUserClient::clientHasAuthorization(
                                                                 *((IOUserClient **)this + 28),
                                                                 *((task **)this + 27),
                                                                 v8) == 0;
    v12 = IOUserClient::copyClientEntitlement(*((IOUserClient **)this + 28), "com.apple.vm.device-access", v11);
    if ( v12 )
    {
      *(_BYTE *)(*((_QWORD *)this + 33) + 202LL) = v12 == **(_QWORD **)off_3B0F8[0];
      (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v12 + 40LL))(v12, "com.apple.vm.device-access");
      v13 = *((_QWORD *)this + 33);
    }
    else
    {
      v13 = *((_QWORD *)this + 33);
      *(_BYTE *)(v13 + 202) = 0;
    }
    if ( *(_BYTE *)(v13 + 201) && *(_BYTE *)(v13 + 202) )
    {
      v18 = *(_QWORD *)off_3B0F8[0];
    }
    else
    {
      LODWORD(v19) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 27) + 696LL))(
                       *((_QWORD *)this + 27),
                       "NeedsAdministratorPrivilege");
      v18 = *(_QWORD *)off_3B0F8[0];
      if ( v19 == **(_QWORD **)off_3B0F8[0] && !*(_BYTE *)(*((_QWORD *)this + 33) + 8LL) )
        goto LABEL_39;
    }
    LODWORD(v20) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 27) + 696LL))(
                     *((_QWORD *)this + 27),
                     "NeedsDeviceAccessEntitlement");
    if ( v20 == *(_QWORD *)v18 )
    {
      v21 = *((_QWORD *)this + 33);
      if ( !*(_BYTE *)(v21 + 8) && (!*(_BYTE *)(v21 + 201) || !*(_BYTE *)(v21 + 202)) )
      {
LABEL_39:
        v46 = *((_QWORD *)this + 33);
        if ( *(_BYTE *)(v46 + 182) )
          return 0;
        *(_BYTE *)(v46 + 182) = 1;
        v47 = *((_QWORD *)this + 27);
        if ( !v47 )
        {
LABEL_43:
          (*(void (__fastcall **)(IOUSBDeviceUserClientV2 *))(*(_QWORD *)v2 + 40LL))(v2);
          return 0;
        }
        v16 = (signed __int64)v2;
        (*(void (__fastcall **)(__int64, IOUSBDeviceUserClientV2 *, _QWORD))(*(_QWORD *)v47 + 1496LL))(v47, v2, 0LL);
LABEL_42:
        (*(void (__fastcall **)(_QWORD, signed __int64))(**((_QWORD **)v2 + 27) + 40LL))(*((_QWORD *)v2 + 27), v16);
        goto LABEL_43;
      }
    }
    LODWORD(v22) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 27) + 696LL))(
                     *((_QWORD *)this + 27),
                     "ExtendedData");
    v23 = *(_QWORD *)off_3B070[0];
    v26 = OSMetaClassBase::safeMetaCast(v22, *(const OSMetaClassBase **)off_3B070[0], v24);
    if ( v26 )
    {
      if ( (unsigned int)(*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v26 + 304LL))(v26, v23) >= 0x15 )
      {
        *(_DWORD *)(*((_QWORD *)this + 33) + 176LL) = 20;
        goto LABEL_25;
      }
      v27 = (*(int (__fastcall **)(__int64))(*(_QWORD *)v26 + 304LL))(v26);
      *(_DWORD *)(*((_QWORD *)this + 33) + 176LL) = v27;
      if ( v27 )
      {
LABEL_25:
        v28 = *(const OSMetaClassBase **)off_3B078[0];
        v29 = 0;
        do
        {
          LODWORD(v30) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v26 + 488LL))(v26, v29);
          v32 = OSMetaClassBase::safeMetaCast(v30, v28, v31);
          if ( v32 )
          {
            LODWORD(v33) = (*(int (__fastcall **)(__int64, const OSMetaClassBase *))(*(_QWORD *)v32 + 336LL))(v32, v28);
            v25 = (int (__cdecl *)(OSObject *, void *, void *, void *, void *))v29;
            v34 = *((_QWORD *)this + 33);
            *(_QWORD *)(v34 + 8LL * v29 + 16) = v33;
          }
          else
          {
            v34 = *((_QWORD *)this + 33);
          }
          ++v29;
        }
        while ( v29 < *(_DWORD *)(v34 + 176) );
        goto LABEL_30;
      }
    }
LABEL_30:
    v38 = IOCommandGate::commandGate(this, 0LL, v25);
    if ( v38 )
    {
      LODWORD(v39) = (*(int (__fastcall **)(IOUSBDeviceUserClientV2 *, _QWORD))(*(_QWORD *)this + 1672LL))(this, 0LL);
      v43 = v39;
      if ( v39 )
      {
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v39 + 32LL))(v39);
        v44 = v38;
        if ( !(*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v43 + 320LL))(v43, v38) )
        {
          if ( !(unsigned __int8)IOService::isInactive(this) )
          {
            *((_QWORD *)this + 30) = v38;
            *((_QWORD *)this + 31) = v43;
            return 1;
          }
          goto LABEL_37;
        }
        v45 = (__int64)"IOUSBDeviceUserClientV2::start - unable to add gate to work loop";
      }
      else
      {
        v45 = (__int64)"IOUSBDeviceUserClientV2::start - unable to find my workloop";
      }
      v44 = 1431519814LL;
      KernelDebugLogInternal(1u, 0x55534246u, v45, v40, v41, v42, v49);
LABEL_37:
      (*(void (__fastcall **)(signed __int64, signed __int64))(*(_QWORD *)v38 + 40LL))(v38, v44);
      if ( v43 )
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v43 + 40LL))(v43);
      goto LABEL_39;
    }
    KernelDebugLogInternal(
      1u,
      0x55534246u,
      (__int64)"IOUSBDeviceUserClientV2::start - unable to create command gate",
      v35,
      v36,
      v37,
      v49);
    goto LABEL_39;
  }
  v15 = 0;
  v16 = 1431519814LL;
  KernelDebugLogInternal(
    1u,
    0x55534246u,
    (__int64)"IOUSBDeviceUserClientV2::start -  could not open() our provider(%p)!",
    *((_QWORD *)this + 27),
    v9,
    v10,
    v49);
  v17 = *((_QWORD *)this + 33);
  if ( !*(_BYTE *)(v17 + 182) )
  {
    *(_BYTE *)(v17 + 182) = 1;
    goto LABEL_42;
  }
  return v15;
}
// 3B070: using guessed type _QWORD off_3B070[20];
// 3B078: using guessed type _QWORD off_3B078[19];
// 3B0B8: using guessed type __int64 off_3B0B8[11];
// 3B0F8: using guessed type __int64 off_3B0F8[3];
// 3F498: using guessed type _QWORD IOUSBDevice::metaClass;
// 7D4D0: using guessed type _QWORD __cdecl IOUserClient::clientHasAuthorization(IOUserClient *__hidden this, task *, IOService *);
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (00000000000304BC) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::open(IOUSBDeviceUserClientV2 *this, unsigned __int8 a2)
{
  IOUSBDeviceUserClientV2 *v2; // rbx@1
  __int64 v3; // rdi@1
  signed int v4; // er14@1

  v2 = this;
  (*(void (__cdecl **)(IOUSBDeviceUserClientV2 *))(*(_QWORD *)this + 2608LL))(this);
  v3 = *((_QWORD *)this + 27);
  v4 = -536870183;
  if ( v3 )
  {
    v4 = -536870203;
    if ( (unsigned __int8)(*(int (__fastcall **)(__int64, IOUSBDeviceUserClientV2 *, _QWORD, _QWORD))(*(_QWORD *)v3 + 1488LL))(
                            v3,
                            v2,
                            a2 | 0x20000u,
                            0LL) )
    {
      *(_BYTE *)(*((_QWORD *)v2 + 33) + 180LL) = 1;
      v4 = 0;
    }
  }
  (*(void (__fastcall **)(IOUSBDeviceUserClientV2 *))(*(_QWORD *)v2 + 2600LL))(v2);
  return (unsigned int)v4;
}

//----- (0000000000030534) ----------------------------------------------------
int __fastcall IOUSBDeviceUserClientV2::closeGated(IOUSBDeviceUserClientV2 *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  __int64 v6; // rax@1
  int result; // eax@2

  v6 = OSMetaClassBase::safeMetaCast(
         this,
         (const OSMetaClassBase *)&IOUSBDeviceUserClientV2::gMetaClass,
         (const OSMetaClass *)a3);
  if ( v6 )
    result = (*(int (__fastcall **)(__int64, _QWORD *))(*(_QWORD *)v6 + 2408LL))(
               v6,
               &IOUSBDeviceUserClientV2::gMetaClass);
  else
    result = -536870206;
  return result;
}
// 499A0: using guessed type _QWORD IOUSBDeviceUserClientV2::gMetaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000003055E) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::close(IOUSBDeviceUserClientV2 *this)
{
  __int64 result; // rax@1
  __int64 v2; // rcx@4

  result = 3758097113LL;
  if ( *((_QWORD *)this + 27) )
  {
    if ( *((_DWORD *)this + 64) )
      (*(void (__cdecl **)(IOUSBDeviceUserClientV2 *))(*(_QWORD *)this + 2416LL))(this);
    v2 = *((_QWORD *)this + 33);
    result = 3758097101LL;
    if ( *(_BYTE *)(v2 + 180) )
    {
      *(_BYTE *)(v2 + 180) = 0;
      (*(void (__fastcall **)(_QWORD, IOUSBDeviceUserClientV2 *, signed __int64))(**((_QWORD **)this + 27) + 1496LL))(
        *((_QWORD *)this + 27),
        this,
        0x20000LL);
      result = 0LL;
    }
  }
  return result;
}

//----- (00000000000305C8) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::DeviceRequestIn(IOService *this, uintptr_t arg2, unsigned __int8 a3, unsigned __int16 a4, __int16 a5, unsigned __int64 a6, task *arg2a, unsigned int a8, unsigned int a9, task *a10)
{
  unsigned __int64 v10; // r14@1
  unsigned __int8 v11; // r13@1
  int v12; // er15@1
  __int64 v13; // r13@4
  __int64 v14; // r12@4
  unsigned __int8 v16; // [sp+8h] [bp-38h]@4
  __int16 v17; // [sp+10h] [bp-30h]@2
  unsigned __int16 v18; // [sp+14h] [bp-2Ch]@2

  v10 = a6;
  v11 = a3;
  v12 = -536870183;
  if ( !*((_QWORD *)this + 27) )
    return (unsigned int)v12;
  v17 = a5;
  v18 = a4;
  if ( (unsigned __int8)IOService::isInactive(this) )
    return (unsigned int)v12;
  if ( a10 )
  {
    v16 = v11;
    v13 = *((_QWORD *)a10 + 2);
    v14 = 0LL;
    if ( v10 )
    {
      v14 = IOMemoryDescriptor::withAddressRange(arg2a, v10, 1uLL, *((_QWORD *)this + 28), a10);
      if ( !v14 )
      {
        v12 = -536870211;
        if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          kernel_debug(0x52D0C04u, (uintptr_t)this, (uintptr_t)arg2a, v10, 0xFFFFFFFFE00002BDLL, 0LL);
        return (unsigned int)v12;
      }
      v12 = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v14 + 496LL))(v14, 0LL);
      if ( v12 )
      {
LABEL_10:
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v14 + 40LL))(v14);
        return (unsigned int)v12;
      }
    }
    *(_BYTE *)(v13 + 80) = arg2;
    *(_BYTE *)(v13 + 81) = v16;
    *(_WORD *)(v13 + 82) = v18;
    *(_WORD *)(v13 + 84) = v17;
    *(_WORD *)(v13 + 86) = v10;
    *(_QWORD *)(v13 + 88) = v14;
    *(_DWORD *)(v13 + 68) = v10;
    *(_QWORD *)(v13 + 72) = v14;
    v12 = (*(int (__fastcall **)(_QWORD, signed __int64, _QWORD, _QWORD))(**((_QWORD **)this + 27) + 2432LL))(
            *((_QWORD *)this + 27),
            v13 + 80,
            a8,
            a9);
    if ( v12 && v14 )
    {
      (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v14 + 504LL))(v14, 0LL);
      goto LABEL_10;
    }
  }
  else
  {
    v12 = -536870206;
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D0C04u, (unsigned __int8)arg2, v11, v18, 0xFFFFFFFFE00002C2LL, 0LL);
  }
  return (unsigned int)v12;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (0000000000030784) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::DeviceRequestIn(IOUSBDeviceUserClientV2 *this, char a2, char a3, __int16 a4, __int16 a5, unsigned int a6, unsigned int a7, void *a8, unsigned int *a9)
{
  __int16 v9; // r13@1
  char v10; // r14@1
  int v11; // er15@1
  unsigned int v12; // eax@3
  __int16 v14; // [sp+8h] [bp-48h]@1
  unsigned int v15; // [sp+Ch] [bp-44h]@1
  char v16; // [sp+10h] [bp-40h]@3
  char v17; // [sp+11h] [bp-3Fh]@3
  __int16 v18; // [sp+12h] [bp-3Eh]@3
  __int16 v19; // [sp+14h] [bp-3Ch]@3
  __int16 v20; // [sp+16h] [bp-3Ah]@3
  void *v21; // [sp+18h] [bp-38h]@3
  int v22; // [sp+20h] [bp-30h]@3

  v15 = a6;
  v14 = a5;
  v9 = a4;
  v10 = a3;
  (*(void (**)(void))(*(_QWORD *)this + 2608LL))();
  v11 = -536870183;
  if ( *((_QWORD *)this + 27) && !(unsigned __int8)IOService::isInactive(this) )
  {
    v16 = a2;
    v17 = v10;
    v18 = v9;
    v19 = v14;
    v20 = *(_WORD *)a9;
    v21 = a8;
    v22 = (*(_BYTE *)(*((_QWORD *)this + 33) + 200LL) == 0) << 30;
    v11 = (*(int (__fastcall **)(_QWORD, char *, _QWORD, _QWORD, _QWORD))(**((_QWORD **)this + 27) + 2424LL))(
            *((_QWORD *)this + 27),
            &v16,
            v15,
            a7,
            0LL);
    v12 = v22 & 0xBFFFFFFF;
    v22 &= 0xBFFFFFFF;
    if ( v11 != -536870168 && v11 )
      *a9 = 0;
    else
      *a9 = v12;
  }
  (*(void (__fastcall **)(IOUSBDeviceUserClientV2 *))(*(_QWORD *)this + 2600LL))(this);
  return (unsigned int)v11;
}

//----- (000000000003087E) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::DeviceRequestIn(IOUSBDeviceUserClientV2 *this, char a2, char a3, __int16 a4, __int16 a5, unsigned int a6, unsigned int a7, IOMemoryDescriptor *a8, unsigned int *a9)
{
  char v9; // r15@1
  int v10; // ebx@1
  unsigned int v11; // eax@5
  __int16 v13; // [sp+4h] [bp-4Ch]@2
  __int16 v14; // [sp+8h] [bp-48h]@2
  unsigned int v15; // [sp+Ch] [bp-44h]@2
  char v16; // [sp+10h] [bp-40h]@5
  char v17; // [sp+11h] [bp-3Fh]@5
  __int16 v18; // [sp+12h] [bp-3Eh]@5
  __int16 v19; // [sp+14h] [bp-3Ch]@5
  __int16 v20; // [sp+16h] [bp-3Ah]@5
  IOMemoryDescriptor *v21; // [sp+18h] [bp-38h]@5
  int v22; // [sp+20h] [bp-30h]@5

  v9 = a3;
  v10 = -536870206;
  if ( a8 )
  {
    v13 = a4;
    v14 = a5;
    v15 = a6;
    (*(void (**)(void))(*(_QWORD *)this + 2608LL))();
    v10 = -536870183;
    if ( *((_QWORD *)this + 27) )
    {
      if ( !(unsigned __int8)IOService::isInactive(this) )
      {
        v10 = (*(int (__fastcall **)(IOMemoryDescriptor *, _QWORD))(*(_QWORD *)a8 + 496LL))(a8, 0LL);
        if ( !v10 )
        {
          v16 = a2;
          v17 = v9;
          v18 = v13;
          v19 = v14;
          v20 = *(_WORD *)a9;
          v21 = a8;
          v22 = (*(_BYTE *)(*((_QWORD *)this + 33) + 200LL) == 0) << 30;
          v10 = (*(int (__fastcall **)(_QWORD, char *, _QWORD, _QWORD, _QWORD))(**((_QWORD **)this + 27) + 2432LL))(
                  *((_QWORD *)this + 27),
                  &v16,
                  v15,
                  a7,
                  0LL);
          v11 = v22 & 0xBFFFFFFF;
          v22 &= 0xBFFFFFFF;
          if ( v10 != -536870168 && v10 )
            v11 = 0;
          *a9 = v11;
          (*(void (__fastcall **)(IOMemoryDescriptor *, _QWORD))(*(_QWORD *)a8 + 504LL))(a8, 0LL);
        }
      }
    }
    (*(void (__fastcall **)(IOUSBDeviceUserClientV2 *))(*(_QWORD *)this + 2600LL))(this);
  }
  return (unsigned int)v10;
}

//----- (00000000000309AC) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::DeviceRequestOut(IOService *this, uintptr_t arg2, unsigned __int8 a3, unsigned __int16 a4, __int16 a5, unsigned __int64 a6, task *arg2a, unsigned int a8, unsigned int a9, task *a10)
{
  unsigned __int64 v10; // r14@1
  unsigned __int8 v11; // r13@1
  int v12; // er15@1
  __int64 v13; // r13@4
  __int64 v14; // r12@4
  unsigned __int8 v16; // [sp+8h] [bp-38h]@4
  __int16 v17; // [sp+10h] [bp-30h]@2
  unsigned __int16 v18; // [sp+14h] [bp-2Ch]@2

  v10 = a6;
  v11 = a3;
  v12 = -536870183;
  if ( !*((_QWORD *)this + 27) )
    return (unsigned int)v12;
  v17 = a5;
  v18 = a4;
  if ( (unsigned __int8)IOService::isInactive(this) )
    return (unsigned int)v12;
  if ( a10 )
  {
    v16 = v11;
    v13 = *((_QWORD *)a10 + 2);
    v14 = 0LL;
    if ( v10 )
    {
      v14 = IOMemoryDescriptor::withAddressRange(arg2a, v10, 2uLL, *((_QWORD *)this + 28), a10);
      if ( !v14 )
      {
        v12 = -536870211;
        if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          kernel_debug(0x52D0C08u, (uintptr_t)this, (uintptr_t)arg2a, v10, 0xFFFFFFFFE00002BDLL, 0LL);
        return (unsigned int)v12;
      }
      v12 = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v14 + 496LL))(v14, 0LL);
      if ( v12 )
      {
LABEL_10:
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v14 + 40LL))(v14);
        return (unsigned int)v12;
      }
    }
    *(_BYTE *)(v13 + 80) = arg2;
    *(_BYTE *)(v13 + 81) = v16;
    *(_WORD *)(v13 + 82) = v18;
    *(_WORD *)(v13 + 84) = v17;
    *(_WORD *)(v13 + 86) = v10;
    *(_QWORD *)(v13 + 88) = v14;
    *(_DWORD *)(v13 + 68) = v10;
    *(_QWORD *)(v13 + 72) = v14;
    v12 = (*(int (__fastcall **)(_QWORD, signed __int64, _QWORD, _QWORD))(**((_QWORD **)this + 27) + 2432LL))(
            *((_QWORD *)this + 27),
            v13 + 80,
            a8,
            a9);
    if ( v12 && v14 )
    {
      (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v14 + 504LL))(v14, 0LL);
      goto LABEL_10;
    }
  }
  else
  {
    v12 = -536870206;
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D0C08u, (unsigned __int8)arg2, v11, v18, 0xFFFFFFFFE00002C2LL, 0LL);
  }
  return (unsigned int)v12;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (0000000000030B68) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::DeviceRequestOut(IOUSBDeviceUserClientV2 *this, char a2, char a3, __int16 a4, __int16 a5, unsigned int a6, unsigned int a7, const void *a8, unsigned int a9)
{
  __int16 v9; // r12@1
  char v10; // r13@1
  int v11; // er15@1
  __int16 v13; // [sp+8h] [bp-48h]@1
  unsigned int v14; // [sp+Ch] [bp-44h]@1
  char v15; // [sp+10h] [bp-40h]@3
  char v16; // [sp+11h] [bp-3Fh]@3
  __int16 v17; // [sp+12h] [bp-3Eh]@3
  __int16 v18; // [sp+14h] [bp-3Ch]@3
  __int16 v19; // [sp+16h] [bp-3Ah]@3
  const void *v20; // [sp+18h] [bp-38h]@3
  int v21; // [sp+20h] [bp-30h]@3

  v14 = a6;
  v13 = a5;
  v9 = a4;
  v10 = a3;
  (*(void (**)(void))(*(_QWORD *)this + 2608LL))();
  v11 = -536870183;
  if ( *((_QWORD *)this + 27) && !(unsigned __int8)IOService::isInactive(this) )
  {
    v15 = a2;
    v16 = v10;
    v17 = v9;
    v18 = v13;
    v19 = a9;
    v20 = a8;
    v21 = (*(_BYTE *)(*((_QWORD *)this + 33) + 200LL) == 0) << 30;
    v11 = (*(int (__fastcall **)(_QWORD, char *, _QWORD, _QWORD, _QWORD))(**((_QWORD **)this + 27) + 2424LL))(
            *((_QWORD *)this + 27),
            &v15,
            v14,
            a7,
            0LL);
    BYTE3(v21) &= 0xBFu;
  }
  (*(void (__fastcall **)(IOUSBDeviceUserClientV2 *))(*(_QWORD *)this + 2600LL))(this);
  return (unsigned int)v11;
}

//----- (0000000000030C32) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::DeviceRequestOut(IOUSBDeviceUserClientV2 *this, char a2, char a3, __int16 a4, __int16 a5, unsigned int a6, unsigned int a7, IOMemoryDescriptor *a8)
{
  char v8; // r15@1
  int v9; // er12@1
  __int16 v11; // [sp+4h] [bp-4Ch]@2
  __int16 v12; // [sp+8h] [bp-48h]@2
  unsigned int v13; // [sp+Ch] [bp-44h]@2
  char v14; // [sp+10h] [bp-40h]@5
  char v15; // [sp+11h] [bp-3Fh]@5
  __int16 v16; // [sp+12h] [bp-3Eh]@5
  __int16 v17; // [sp+14h] [bp-3Ch]@5
  __int16 v18; // [sp+16h] [bp-3Ah]@5
  IOMemoryDescriptor *v19; // [sp+18h] [bp-38h]@5
  int v20; // [sp+20h] [bp-30h]@5

  v8 = a3;
  v9 = -536870206;
  if ( a8 )
  {
    v11 = a4;
    v12 = a5;
    v13 = a6;
    (*(void (**)(void))(*(_QWORD *)this + 2608LL))();
    v9 = -536870183;
    if ( *((_QWORD *)this + 27) )
    {
      if ( !(unsigned __int8)IOService::isInactive(this) )
      {
        v9 = (*(int (__fastcall **)(IOMemoryDescriptor *, _QWORD))(*(_QWORD *)a8 + 496LL))(a8, 0LL);
        if ( !v9 )
        {
          v14 = a2;
          v15 = v8;
          v16 = v11;
          v17 = v12;
          v18 = (*(int (__fastcall **)(IOMemoryDescriptor *))(*(_QWORD *)a8 + 456LL))(a8);
          v19 = a8;
          v20 = (*(_BYTE *)(*((_QWORD *)this + 33) + 200LL) == 0) << 30;
          v9 = (*(int (__fastcall **)(_QWORD, char *, _QWORD, _QWORD, _QWORD))(**((_QWORD **)this + 27) + 2432LL))(
                 *((_QWORD *)this + 27),
                 &v14,
                 v13,
                 a7,
                 0LL);
          BYTE3(v20) &= 0xBFu;
          (*(void (__fastcall **)(IOMemoryDescriptor *, _QWORD))(*(_QWORD *)a8 + 504LL))(a8, 0LL);
        }
      }
    }
    (*(void (__fastcall **)(IOUSBDeviceUserClientV2 *))(*(_QWORD *)this + 2600LL))(this);
  }
  return (unsigned int)v9;
}

//----- (0000000000030D4C) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::SetConfiguration(IOUSBDeviceUserClientV2 *this, unsigned __int8 a2)
{
  int v2; // er14@1

  (*(void (__cdecl **)(IOUSBDeviceUserClientV2 *))(*(_QWORD *)this + 2608LL))(this);
  v2 = -536870183;
  if ( *((_QWORD *)this + 27) && !(unsigned __int8)IOService::isInactive(this) )
    v2 = (*(int (__fastcall **)(_QWORD, IOUSBDeviceUserClientV2 *, _QWORD, signed __int64))(**((_QWORD **)this + 27)
                                                                                          + 2240LL))(
           *((_QWORD *)this + 27),
           this,
           a2,
           1LL);
  (*(void (__fastcall **)(IOUSBDeviceUserClientV2 *))(*(_QWORD *)this + 2600LL))(this);
  return (unsigned int)v2;
}

//----- (0000000000030DBA) ----------------------------------------------------
__int64 __usercall IOUSBDeviceUserClientV2::GetConfiguration@<rax>(IOUSBDeviceUserClientV2 *this@<rdi>, unsigned __int64 *a2@<rsi>, __int64 a3@<rax>)
{
  int v3; // er15@1
  unsigned __int64 v4; // rcx@1
  char v5; // al@2
  __int64 v6; // rdx@2
  __int64 v8; // [sp-6h] [bp-20h]@1

  v8 = a3;
  BYTE7(v8) = -1;
  (*(void (__cdecl **)(IOUSBDeviceUserClientV2 *))(*(_QWORD *)this + 2608LL))(this);
  v3 = -536870183;
  v4 = 255LL;
  if ( *((_QWORD *)this + 27) )
  {
    v5 = IOService::isInactive(this);
    v4 = 255LL;
    if ( !v5 )
    {
      v3 = (*(int (__fastcall **)(_QWORD, char *, __int64, signed __int64))(**((_QWORD **)this + 27) + 2376LL))(
             *((_QWORD *)this + 27),
             (char *)&v8 + 7,
             v6,
             255LL);
      v4 = BYTE7(v8);
    }
  }
  *a2 = v4;
  (*(void (__fastcall **)(IOUSBDeviceUserClientV2 *))(*(_QWORD *)this + 2600LL))(this);
  return (unsigned int)v3;
}

//----- (0000000000030E36) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::GetConfigDescriptor(IOService *this, unsigned __int8 a2, void *a3, unsigned int *a4)
{
  unsigned int *v4; // r15@1
  void *v5; // r14@1
  signed int v6; // er12@1
  __int64 v7; // rax@3
  unsigned int v8; // ecx@4
  unsigned int v9; // edx@4

  v4 = a4;
  v5 = a3;
  (*(void (__cdecl **)(IOService *))(*(_QWORD *)this + 2608LL))(this);
  v6 = -536870183;
  if ( *((_QWORD *)this + 27) )
  {
    if ( !(unsigned __int8)IOService::isInactive(this) )
    {
      LODWORD(v7) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 27) + 2216LL))(
                      *((_QWORD *)this + 27),
                      a2);
      v6 = -536870160;
      if ( v7 )
      {
        v8 = *(_WORD *)(v7 + 2);
        v9 = *v4;
        if ( v8 < *v4 )
        {
          *v4 = v8;
          v9 = v8;
        }
        bcopy((const void *)v7, v5, v9);
        v6 = 0;
      }
    }
  }
  (*(void (__fastcall **)(IOService *))(*(_QWORD *)this + 2600LL))(this);
  return (unsigned int)v6;
}

//----- (0000000000030ED2) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::GetConfigDescriptor(IOUSBDeviceUserClientV2 *this, unsigned __int8 a2, IOMemoryDescriptor *a3, unsigned int *a4)
{
  unsigned int *v4; // r15@1
  IOMemoryDescriptor *v5; // r14@1
  signed int v6; // er12@1
  __int64 v7; // rax@4
  __int64 v8; // r13@4
  unsigned int v9; // eax@5

  v4 = a4;
  v5 = a3;
  v6 = -536870206;
  if ( a3 )
  {
    (*(void (__cdecl **)(IOUSBDeviceUserClientV2 *))(*(_QWORD *)this + 2608LL))(this);
    v6 = -536870183;
    if ( *((_QWORD *)this + 27) )
    {
      if ( !(unsigned __int8)IOService::isInactive(this) )
      {
        LODWORD(v7) = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 27) + 2216LL))(
                        *((_QWORD *)this + 27),
                        a2);
        v8 = v7;
        v6 = -536870160;
        if ( v7 )
        {
          v9 = *(_WORD *)(v7 + 2);
          if ( v9 < *v4 )
            *v4 = v9;
          v6 = 0;
          (*(void (__fastcall **)(IOMemoryDescriptor *, _QWORD))(*(_QWORD *)v5 + 496LL))(v5, 0LL);
          (*(void (__fastcall **)(IOMemoryDescriptor *, _QWORD, __int64, _QWORD))(*(_QWORD *)v5 + 488LL))(
            v5,
            0LL,
            v8,
            *v4);
          (*(void (__fastcall **)(IOMemoryDescriptor *, _QWORD))(*(_QWORD *)v5 + 504LL))(v5, 0LL);
        }
      }
    }
    (*(void (__fastcall **)(IOUSBDeviceUserClientV2 *))(*(_QWORD *)this + 2600LL))(this);
  }
  return (unsigned int)v6;
}

//----- (0000000000030FA4) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::SetConfigurationV2(IOUSBDeviceUserClientV2 *this, IOUSBDeviceUserClientV2 *a2, unsigned __int8 a3, unsigned int a4)
{
  unsigned int v4; // er14@1
  unsigned __int8 v5; // r15@1
  unsigned __int8 v6; // r12@1
  int v7; // er13@1
  __int64 v8; // rax@3
  char v9; // cl@3
  int v10; // eax@9
  bool v11; // r14@10
  unsigned int v13; // [sp+4h] [bp-4Ch]@9
  char v14; // [sp+8h] [bp-48h]@17
  char v15; // [sp+9h] [bp-47h]@17
  __int16 v16; // [sp+Ah] [bp-46h]@17
  __int16 v17; // [sp+Ch] [bp-44h]@17
  __int16 v18; // [sp+Eh] [bp-42h]@17
  __int64 v19; // [sp+10h] [bp-40h]@17
  __int64 v20; // [sp+20h] [bp-30h]@9

  v4 = a4;
  v5 = a3;
  v6 = (unsigned __int8)a2;
  (*(void (**)(void))(*(_QWORD *)this + 2608LL))();
  v7 = -536870183;
  if ( !*((_QWORD *)this + 27) || (unsigned __int8)IOService::isInactive(this) )
    goto LABEL_15;
  v8 = *((_QWORD *)this + 33);
  v9 = *(_BYTE *)(v8 + 202);
  if ( v5 )
  {
LABEL_7:
    if ( !v9 )
      goto LABEL_11;
    goto LABEL_8;
  }
  if ( !v9 || !*(_BYTE *)(v8 + 201) )
  {
    v7 = -536870174;
    if ( !*(_BYTE *)(v8 + 8) )
      goto LABEL_15;
    goto LABEL_7;
  }
LABEL_8:
  if ( *(_BYTE *)(v8 + 201) )
  {
    v13 = v4;
    v20 = 0LL;
    a2 = (IOUSBDeviceUserClientV2 *)&v20;
    v10 = (*(int (__fastcall **)(IOUSBDeviceUserClientV2 *, __int64 *))(*(_QWORD *)this + 2432LL))(this, &v20);
    v7 = 0;
    if ( v10 )
    {
      v11 = 0;
      v7 = v10;
    }
    else
    {
      v11 = 0;
      if ( v20 == v6 )
      {
        v14 = 0;
        v15 = 9;
        v16 = v6;
        v17 = 0;
        v18 = 0;
        v19 = 0LL;
        a2 = (IOUSBDeviceUserClientV2 *)&v14;
        v7 = (*(int (__fastcall **)(_QWORD, char *, signed __int64, _QWORD, _QWORD))(**((_QWORD **)this + 27) + 2424LL))(
               *((_QWORD *)this + 27),
               &v14,
               5000LL,
               0LL,
               0LL);
        v11 = v7 == 0;
      }
    }
    goto LABEL_12;
  }
LABEL_11:
  v13 = v4;
  v11 = 0;
LABEL_12:
  if ( *((_QWORD *)this + 27) )
  {
    a2 = (IOUSBDeviceUserClientV2 *)v13;
    if ( !(v11 | (unsigned __int8)IOService::isInactive(this)) )
    {
      a2 = this;
      v7 = (*(int (__fastcall **)(_QWORD, IOUSBDeviceUserClientV2 *, _QWORD, _QWORD, _QWORD))(**((_QWORD **)this + 27)
                                                                                            + 2528LL))(
             *((_QWORD *)this + 27),
             this,
             v6,
             v5,
             (unsigned __int8)v13);
    }
  }
LABEL_15:
  (*(void (__fastcall **)(IOUSBDeviceUserClientV2 *, IOUSBDeviceUserClientV2 *))(*(_QWORD *)this + 2600LL))(this, a2);
  return (unsigned int)v7;
}

//----- (0000000000031110) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::ResetDevice(IOUSBDeviceUserClientV2 *this)
{
  int v1; // er14@1

  (*(void (**)(void))(*(_QWORD *)this + 2608LL))();
  v1 = -536870183;
  if ( *((_QWORD *)this + 27) && !(unsigned __int8)IOService::isInactive(this) )
    v1 = (*(int (**)(void))(**((_QWORD **)this + 27) + 2232LL))();
  (*(void (__fastcall **)(IOUSBDeviceUserClientV2 *))(*(_QWORD *)this + 2600LL))(this);
  return (unsigned int)v1;
}

//----- (0000000000031166) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::SuspendDevice(IOUSBDeviceUserClientV2 *this, unsigned __int8 a2)
{
  int v2; // er14@1

  (*(void (__cdecl **)(IOUSBDeviceUserClientV2 *))(*(_QWORD *)this + 2608LL))(this);
  v2 = -536870183;
  if ( *((_QWORD *)this + 27) && !(unsigned __int8)IOService::isInactive(this) )
    v2 = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 27) + 2440LL))(*((_QWORD *)this + 27), a2);
  (*(void (__fastcall **)(IOUSBDeviceUserClientV2 *))(*(_QWORD *)this + 2600LL))(this);
  return (unsigned int)v2;
}

//----- (00000000000311CC) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::ReEnumerateDevice(IOUSBDeviceUserClientV2 *this, unsigned int a2)
{
  IOUSBDeviceUserClientV2 *v2; // rbx@1
  int v3; // er15@1
  __int64 v4; // rax@4
  __int64 v5; // rdi@7

  v2 = this;
  (*(void (__cdecl **)(IOUSBDeviceUserClientV2 *))(*(_QWORD *)this + 32LL))(this);
  v3 = -536870183;
  if ( *((_QWORD *)this + 27) && !(unsigned __int8)IOService::isInactive(this) )
  {
    if ( !(a2 & 0x60000000) )
    {
LABEL_10:
      v3 = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)v2 + 27) + 2448LL))(*((_QWORD *)v2 + 27), a2);
      goto LABEL_11;
    }
    v4 = *((_QWORD *)this + 33);
    if ( *(_BYTE *)(v4 + 202) && *(_BYTE *)(v4 + 201) || (v3 = -536870174, *(_BYTE *)(v4 + 8)) )
    {
      v5 = *((_QWORD *)this + 27);
      if ( a2 & 0x40000000 )
        (*(void (__fastcall **)(__int64, _QWORD, _QWORD))(*(_QWORD *)v5 + 616LL))(
          v5,
          "NeedsDeviceAccessEntitlement",
          **(_QWORD **)off_3B0F8[0]);
      else
        (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v5 + 672LL))(v5, "NeedsDeviceAccessEntitlement");
      goto LABEL_10;
    }
  }
LABEL_11:
  (*(void (__fastcall **)(IOUSBDeviceUserClientV2 *))(*(_QWORD *)v2 + 40LL))(v2);
  return (unsigned int)v3;
}
// 3B0F8: using guessed type __int64 off_3B0F8[3];

//----- (00000000000312A0) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::AbortPipeZero(IOUSBDeviceUserClientV2 *this)
{
  int v1; // er14@1
  __int64 v2; // rax@3

  (*(void (**)(void))(*(_QWORD *)this + 2608LL))();
  v1 = -536870183;
  if ( *((_QWORD *)this + 27) )
  {
    if ( !(unsigned __int8)IOService::isInactive(this) )
    {
      LODWORD(v2) = (*(int (**)(void))(**((_QWORD **)this + 27) + 2344LL))();
      v1 = -536870206;
      if ( v2 )
        v1 = (*(int (__fastcall **)(__int64))(*(_QWORD *)v2 + 296LL))(v2);
    }
  }
  (*(void (__fastcall **)(IOUSBDeviceUserClientV2 *))(*(_QWORD *)this + 2600LL))(this);
  return (unsigned int)v1;
}

//----- (000000000003130E) ----------------------------------------------------
__int64 __usercall IOUSBDeviceUserClientV2::GetDeviceInformation@<rax>(IOUSBDeviceUserClientV2 *this@<rdi>, unsigned __int64 *a2@<rsi>, __int64 a3@<rax>)
{
  int v3; // er15@1
  unsigned __int64 v4; // rcx@1
  char v5; // al@2
  __int64 v6; // rdx@2
  __int64 v8; // [sp-4h] [bp-20h]@1

  v8 = a3;
  HIDWORD(v8) = 0;
  (*(void (__cdecl **)(IOUSBDeviceUserClientV2 *))(*(_QWORD *)this + 2608LL))(this);
  v3 = -536870183;
  v4 = 0LL;
  if ( *((_QWORD *)this + 27) )
  {
    v5 = IOService::isInactive(this);
    v4 = 0LL;
    if ( !v5 )
    {
      v3 = (*(int (__fastcall **)(_QWORD, char *, __int64, _QWORD))(**((_QWORD **)this + 27) + 2488LL))(
             *((_QWORD *)this + 27),
             (char *)&v8 + 4,
             v6,
             0LL);
      v4 = HIDWORD(v8);
    }
  }
  *a2 = v4;
  (*(void (__fastcall **)(IOUSBDeviceUserClientV2 *))(*(_QWORD *)this + 2600LL))(this);
  return (unsigned int)v3;
}

//----- (0000000000031386) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::RequestExtraPower(IOUSBDeviceUserClientV2 *this, signed int a2, unsigned int a3, unsigned __int64 *a4)
{
  unsigned __int64 *v4; // r15@1
  unsigned int v5; // er12@1
  signed int v6; // er14@1
  signed int v7; // er12@3
  int v8; // eax@5
  unsigned int v10; // [sp+0h] [bp-2Ch]@2

  v4 = a4;
  v5 = a3;
  (*(void (__cdecl **)(IOUSBDeviceUserClientV2 *))(*(_QWORD *)this + 2608LL))(this);
  *v4 = 0LL;
  v6 = -536870183;
  if ( *((_QWORD *)this + 27) )
  {
    v10 = v5;
    if ( !(unsigned __int8)IOService::isInactive(this) )
    {
      v7 = 6;
      if ( a2 != 1 )
        v7 = a2;
      v8 = (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD))(**((_QWORD **)this + 27) + 2496LL))(
             *((_QWORD *)this + 27),
             (unsigned int)v7,
             v10);
      *v4 = (unsigned int)v8;
      v6 = 0;
      if ( v7 == 6 )
      {
        *(_DWORD *)(*((_QWORD *)this + 33) + 4LL) += v8;
      }
      else if ( !v7 )
      {
        **((_DWORD **)this + 33) += v8;
      }
    }
  }
  (*(void (__fastcall **)(IOUSBDeviceUserClientV2 *))(*(_QWORD *)this + 2600LL))(this);
  return (unsigned int)v6;
}

//----- (000000000003143A) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::ReturnExtraPower(IOUSBDeviceUserClientV2 *this, signed int a2, unsigned int a3)
{
  unsigned int v3; // er14@1
  signed int v4; // er12@1
  int v5; // er15@3

  v3 = a3;
  (*(void (__cdecl **)(IOUSBDeviceUserClientV2 *))(*(_QWORD *)this + 2608LL))(this);
  v4 = 6;
  if ( a2 != 1 )
    v4 = a2;
  v5 = -536870183;
  if ( *((_QWORD *)this + 27) )
  {
    if ( !(unsigned __int8)IOService::isInactive(this) )
    {
      v5 = (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD))(**((_QWORD **)this + 27) + 2504LL))(
             *((_QWORD *)this + 27),
             (unsigned int)v4,
             v3);
      if ( !v5 )
      {
        v5 = 0;
        if ( v4 == 6 )
        {
          *(_DWORD *)(*((_QWORD *)this + 33) + 4LL) -= v3;
        }
        else if ( !v4 )
        {
          **((_DWORD **)this + 33) -= v3;
        }
      }
    }
  }
  (*(void (__fastcall **)(IOUSBDeviceUserClientV2 *))(*(_QWORD *)this + 2600LL))(this);
  return (unsigned int)v5;
}

//----- (00000000000314E6) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::GetExtraPowerAllocated(IOUSBDeviceUserClientV2 *this, signed int a2, unsigned __int64 *a3)
{
  unsigned __int64 *v3; // r14@1
  signed int v4; // er15@1
  signed int v5; // er12@3
  int v6; // eax@5
  unsigned __int64 v7; // rcx@5
  bool v8; // zf@5
  unsigned __int64 v9; // rax@5

  v3 = a3;
  (*(void (**)(void))(*(_QWORD *)this + 2608LL))();
  v4 = 6;
  if ( a2 != 1 )
    v4 = a2;
  *v3 = 0LL;
  v5 = -536870183;
  if ( *((_QWORD *)this + 27) && !(unsigned __int8)IOService::isInactive(this) )
  {
    v6 = (*(int (__fastcall **)(_QWORD, _QWORD))(**((_QWORD **)this + 27) + 2512LL))(
           *((_QWORD *)this + 27),
           (unsigned int)v4);
    v7 = (unsigned int)v6;
    v5 = 0;
    v8 = (v6 == 400 && v4 == 6) == 0;
    v9 = 0LL;
    if ( v8 )
      v9 = v7;
    *v3 = v9;
  }
  (*(void (__fastcall **)(IOUSBDeviceUserClientV2 *))(*(_QWORD *)this + 2600LL))(this);
  return (unsigned int)v5;
}

//----- (0000000000031582) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::GetBandwidthAvailableForDevice(IOUSBDeviceUserClientV2 *this, unsigned __int64 *a2)
{
  IOUSBDeviceUserClientV2 *v2; // rbx@1
  int v3; // er15@1
  __int64 v4; // rdi@3
  OSMetaClassBase *v5; // rax@5
  const OSMetaClass *v6; // rdx@5
  __int64 v7; // r12@5
  const OSMetaClass *v8; // rdx@5
  __int64 v9; // rax@5
  unsigned int v11; // [sp+Ch] [bp-24h]@7

  v2 = this;
  v3 = -536870183;
  if ( *((_QWORD *)this + 27) )
  {
    if ( !(unsigned __int8)IOService::isInactive(this) )
    {
      v4 = *((_QWORD *)this + 27);
      v3 = -536870201;
      if ( v4 )
      {
        if ( *(_QWORD *)(v4 + 232) )
        {
          LODWORD(v5) = (*(int (**)(void))(*(_QWORD *)v4 + 2264LL))();
          v7 = OSMetaClassBase::safeMetaCast(v5, (const OSMetaClassBase *)IOUSBControllerV3::metaClass, v6);
          v9 = OSMetaClassBase::safeMetaCast(
                 *(OSMetaClassBase **)(*(_QWORD *)(*((_QWORD *)v2 + 27) + 232LL) + 16LL),
                 (const OSMetaClassBase *)IOUSBHubDevice::metaClass,
                 v8);
          if ( v7 )
          {
            if ( v9 )
            {
              v3 = (*(int (__fastcall **)(__int64, _QWORD, int *))(*(_QWORD *)v7 + 3328LL))(
                     v7,
                     *((_QWORD *)v2 + 27),
                     &v11);
              if ( !v3 )
              {
                *a2 = v11;
                v3 = 0;
              }
            }
          }
        }
      }
    }
  }
  return (unsigned int)v3;
}
// 42D30: using guessed type _QWORD IOUSBHubDevice::metaClass;
// 44350: using guessed type _QWORD IOUSBControllerV3::metaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000003165A) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::GetFrameNumber(IOService *this, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  signed int v4; // er12@1
  __int64 v5; // rax@3
  __int64 v6; // rax@3

  v3 = a3;
  (*(void (**)(void))(*(_QWORD *)this + 2608LL))();
  v4 = -536870183;
  if ( *((_QWORD *)this + 27) && !(unsigned __int8)IOService::isInactive(this) )
  {
    *(_QWORD *)(a2 + 8) = mach_absolute_time();
    LODWORD(v5) = (*(int (**)(void))(**((_QWORD **)this + 27) + 2264LL))();
    LODWORD(v6) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v5 + 2456LL))(v5);
    *(_QWORD *)a2 = v6;
    *(_DWORD *)v3 = 16;
    v4 = 0;
  }
  (*(void (__fastcall **)(IOService *))(*(_QWORD *)this + 2600LL))(this);
  return (unsigned int)v4;
}

//----- (00000000000316DE) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::GetMicroFrameNumber(IOService *this, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  IOService *v4; // rbx@1
  __int64 v5; // rdi@1
  signed int v6; // er12@1
  OSMetaClassBase *v7; // rax@2
  const OSMetaClass *v8; // rdx@2
  __int64 v9; // r13@2
  __int64 v10; // rax@5

  v3 = a3;
  v4 = this;
  v5 = *((_QWORD *)this + 27);
  v6 = -536870183;
  if ( v5 )
  {
    LODWORD(v7) = (*(int (__cdecl **)(__int64))(*(_QWORD *)v5 + 2264LL))(v5);
    v9 = OSMetaClassBase::safeMetaCast(v7, (const OSMetaClassBase *)IOUSBControllerV2::metaClass, v8);
    if ( v9 )
    {
      (*(void (__fastcall **)(IOService *, _QWORD))(*(_QWORD *)v4 + 2608LL))(v4, IOUSBControllerV2::metaClass);
      v6 = -536870183;
      if ( *((_QWORD *)v4 + 27) && !(unsigned __int8)IOService::isInactive(v4) )
      {
        *(_QWORD *)(a2 + 8) = mach_absolute_time();
        LODWORD(v10) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v9 + 2728LL))(v9);
        if ( v10 )
        {
          *(_QWORD *)a2 = v10;
          *(_DWORD *)v3 = 16;
          v6 = 0;
        }
        else
        {
          *(_DWORD *)v3 = 0;
          v6 = -536870201;
        }
      }
      (*(void (__fastcall **)(IOService *))(*(_QWORD *)v4 + 2600LL))(v4);
    }
  }
  return (unsigned int)v6;
}
// 419C0: using guessed type _QWORD IOUSBControllerV2::metaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (00000000000317AC) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::GetFrameNumberWithTime(IOService *this, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  int v4; // er12@1
  OSMetaClassBase *v5; // rax@3
  const OSMetaClass *v6; // rdx@3
  __int64 v7; // rax@3

  v3 = a3;
  (*(void (**)(void))(*(_QWORD *)this + 2608LL))();
  v4 = -536870183;
  if ( *((_QWORD *)this + 27) )
  {
    if ( !(unsigned __int8)IOService::isInactive(this) )
    {
      LODWORD(v5) = (*(int (**)(void))(**((_QWORD **)this + 27) + 2264LL))();
      v7 = OSMetaClassBase::safeMetaCast(v5, (const OSMetaClassBase *)IOUSBControllerV2::metaClass, v6);
      v4 = -536870201;
      if ( v7 )
      {
        v4 = (*(int (__fastcall **)(__int64, __int64, signed __int64))(*(_QWORD *)v7 + 2864LL))(v7, a2, a2 + 8);
        *(_DWORD *)v3 = 16;
      }
    }
  }
  (*(void (__fastcall **)(IOService *))(*(_QWORD *)this + 2600LL))(this);
  return (unsigned int)v4;
}
// 419C0: using guessed type _QWORD IOUSBControllerV2::metaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000031848) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::RegisterForNotification(IOUSBDeviceUserClientV2 *this, uintptr_t arg2, uintptr_t arg3, unsigned __int64 *a4)
{
  unsigned __int64 *v4; // r12@1
  uintptr_t v5; // r13@1
  uintptr_t v6; // r14@1
  uintptr_t v7; // r15@1
  signed int v8; // ebx@4
  uintptr_t v9; // r8@9
  uintptr_t v10; // rax@11
  uintptr_t v11; // rax@15
  uintptr_t v12; // rbx@15
  __int64 v13; // rax@18
  signed __int64 v14; // rcx@18
  char v15; // al@18
  int v16; // ecx@18
  uintptr_t v17; // r14@18
  uintptr_t v18; // rbx@20
  int v19; // eax@20
  __int64 v20; // rax@22
  __int64 v21; // rdi@23
  uintptr_t v22; // rbx@24
  int v23; // er13@24
  int v24; // eax@24
  uintptr_t v25; // rbx@31
  int v26; // eax@31
  char v27; // al@33

  v4 = a4;
  v5 = arg3;
  v6 = arg2;
  v7 = (uintptr_t)this;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
  {
    arg2 = (uintptr_t)this;
    kernel_debug(0x52D0C19u, (uintptr_t)this, v6, arg3, 0LL, 0LL);
  }
  v8 = -536870206;
  if ( !v4 || !v5 )
    goto LABEL_49;
  if ( (unsigned __int8)IOService::isInactive(*((IOService **)this + 27)) )
  {
    v8 = -536870208;
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      v9 = 8LL;
LABEL_39:
      kernel_debug(0x52D0C18u, (uintptr_t)this, 0LL, 0LL, v9, 0LL);
      goto LABEL_49;
    }
    goto LABEL_49;
  }
  if ( !*(_QWORD *)(*((_QWORD *)this + 33) + 184LL) )
  {
    v10 = OSSet::withCapacity((OSSet *)((char *)&dword_0 + 1), arg2);
    *(_QWORD *)(*((_QWORD *)this + 33) + 184LL) = v10;
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      arg2 = (uintptr_t)this;
      kernel_debug(0x52D0C18u, (uintptr_t)this, v10, 0LL, 0LL, 0LL);
      v10 = *(_QWORD *)(*((_QWORD *)this + 33) + 184LL);
    }
    if ( !v10 )
    {
      v8 = -536870211;
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        v9 = 7LL;
        goto LABEL_39;
      }
      goto LABEL_49;
    }
  }
  LODWORD(v11) = (*(int (__fastcall **)(_QWORD *, uintptr_t))(IOUSBNotification::gMetaClass + 136LL))(
                   &IOUSBNotification::gMetaClass,
                   arg2);
  v12 = v11;
  if ( v11 )
  {
    if ( (unsigned __int8)(*(int (__fastcall **)(uintptr_t))(*(_QWORD *)v11 + 136LL))(v11) )
      *(_QWORD *)(v12 + 16) = this;
    v13 = *((_QWORD *)this + 33);
    v14 = *(_QWORD *)(v13 + 192) + 1LL;
    *(_QWORD *)(v13 + 192) = v14;
    *(_QWORD *)(v12 + 112) = v14;
    *(_QWORD *)(v12 + 40) = v6;
    bcopy((const void *)v5, (void *)(v12 + 48), 0x40uLL);
    *(_QWORD *)(v12 + 24) = *((_QWORD *)this + 27);
    *(_QWORD *)(v12 + 32) = 0LL;
    v15 = (*(int (__fastcall **)(_QWORD, uintptr_t))(**(_QWORD **)(*((_QWORD *)this + 33) + 184LL) + 448LL))(
            *(_QWORD *)(*((_QWORD *)this + 33) + 184LL),
            v12);
    v16 = gUSBStackDebugFlags & 2;
    v17 = v12;
    if ( !v15 )
    {
      v23 = -536870211;
      if ( v16 )
      {
        v25 = *(_QWORD *)(*((_QWORD *)this + 33) + 184LL);
        v26 = (*(int (__fastcall **)(_QWORD))(*(_QWORD *)v25 + 304LL))(*(_QWORD *)(*((_QWORD *)this + 33) + 184LL));
        if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          kernel_debug(0x52D0C18u, (uintptr_t)this, v25, (unsigned int)v26, 5uLL, 0LL);
      }
      goto LABEL_48;
    }
    if ( v16 )
    {
      v18 = *(_QWORD *)(*((_QWORD *)this + 33) + 184LL);
      v19 = (*(int (__fastcall **)(_QWORD))(*(_QWORD *)v18 + 304LL))(*(_QWORD *)(*((_QWORD *)this + 33) + 184LL));
      if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D0C18u, (uintptr_t)this, v18, (unsigned int)v19, 1uLL, 0LL);
    }
    v20 = *((_QWORD *)this + 27);
    if ( v20 && (v21 = *(_QWORD *)(*(_QWORD *)(v20 + 232) + 144LL)) != 0 )
    {
      v22 = v17;
      v23 = (*(int (__fastcall **)(__int64, signed __int64, uintptr_t, _QWORD))(*(_QWORD *)v21 + 2200LL))(
              v21,
              1LL,
              v17,
              0LL);
      v24 = gUSBStackDebugFlags & 2;
      if ( !v23 )
      {
        if ( v24 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          kernel_debug(0x52D0C18u, v7, v17, *(_QWORD *)(v17 + 112), 3uLL, 0LL);
        *v4 = *(_QWORD *)(v17 + 112);
        v23 = 0;
LABEL_45:
        v17 = v22;
        if ( (*(int (__cdecl **)(_QWORD))(**(_QWORD **)(*(_QWORD *)(v7 + 264) + 184LL) + 304LL))(*(_QWORD *)(*(_QWORD *)(v7 + 264) + 184LL)) )
          *(_BYTE *)(*(_QWORD *)(v7 + 264) + 200LL) = 1;
        v8 = 0;
        if ( !v23 )
          goto LABEL_49;
LABEL_48:
        (*(void (__cdecl **)(uintptr_t))(*(_QWORD *)v17 + 40LL))(v17);
        v8 = v23;
        goto LABEL_49;
      }
      if ( !v24 )
      {
LABEL_44:
        (*(void (__fastcall **)(_QWORD, uintptr_t))(**(_QWORD **)(*(_QWORD *)(v7 + 264) + 184LL) + 472LL))(
          *(_QWORD *)(*(_QWORD *)(v7 + 264) + 184LL),
          v22);
        goto LABEL_45;
      }
    }
    else
    {
      v27 = gUSBStackDebugFlags;
      if ( gUSBStackDebugFlags & 2 )
      {
        v22 = v17;
        if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        {
          kernel_debug(0x52D0C18u, v7, 0LL, 0LL, 2uLL, 0LL);
          v27 = gUSBStackDebugFlags;
        }
      }
      else
      {
        v22 = v17;
      }
      v23 = -536870208;
      if ( !(v27 & 2) )
        goto LABEL_44;
    }
    if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D0C18u, v7, v23, v22, 4uLL, 0LL);
    goto LABEL_44;
  }
  v8 = -536870211;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
  {
    v9 = 6LL;
    goto LABEL_39;
  }
LABEL_49:
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D0C1Au, v7, v8, 0LL, 0LL, 0LL);
  return (unsigned int)v8;
}
// 0: using guessed type int dword_0;
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 49978: using guessed type _QWORD IOUSBNotification::gMetaClass;

//----- (0000000000031CF6) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::UnregisterNotification(uintptr_t arg1, uintptr_t arg2)
{
  uintptr_t v2; // r13@1
  uintptr_t v3; // r14@1
  int *v4; // rbx@1
  __int64 v5; // rdi@4
  __int64 v6; // rax@5
  __int64 v7; // r15@5
  uintptr_t v8; // rax@6
  uintptr_t v9; // rbx@6
  uintptr_t v10; // r12@6
  uintptr_t v11; // rax@9
  int v12; // er15@11
  uintptr_t v13; // r8@13
  __int64 v14; // rax@22
  __int64 v15; // rdi@23
  uintptr_t v16; // rsi@25
  int v17; // eax@26

  v2 = arg2;
  v3 = arg1;
  v4 = &gUSBStackDebugFlags;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
  {
    arg2 = arg1;
    kernel_debug(0x52D0C1Du, arg1, v2, *(_QWORD *)(*(_QWORD *)(arg1 + 264) + 184LL), 0LL, 0LL);
  }
  v5 = *(_QWORD *)(*(_QWORD *)(arg1 + 264) + 184LL);
  if ( !v5 )
  {
    v12 = -536870206;
    if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
      goto LABEL_34;
    v13 = 4LL;
LABEL_33:
    kernel_debug(0x52D0C1Cu, v3, 0LL, 0LL, v13, 0LL);
    goto LABEL_34;
  }
  LODWORD(v6) = OSCollectionIterator::withCollection(v5, arg2);
  v7 = v6;
  if ( !v6 )
  {
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D0C1Cu, v3, 0LL, 0LL, 1uLL, 0LL);
LABEL_30:
    v12 = -536870206;
    v4 = &gUSBStackDebugFlags;
    if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
      goto LABEL_34;
    v13 = 3LL;
    goto LABEL_33;
  }
  LODWORD(v8) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v6 + 296LL))(v6);
  v9 = v8;
  v10 = 0LL;
  if ( v8 )
  {
    v10 = 0LL;
    while ( *(_QWORD *)(v9 + 112) != v2 )
    {
      LODWORD(v11) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v7 + 296LL))(v7);
      v9 = v11;
      if ( !v11 )
        goto LABEL_21;
    }
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D0C1Cu, v3, v9, *(_QWORD *)(*(_QWORD *)(v3 + 264) + 184LL), 0LL, 0LL);
    v10 = v9;
  }
LABEL_21:
  (*(void (__fastcall **)(__int64))(*(_QWORD *)v7 + 40LL))(v7);
  if ( !v10 )
    goto LABEL_30;
  v14 = *(_QWORD *)(v3 + 216);
  v12 = 0;
  if ( v14 )
  {
    v15 = *(_QWORD *)(*(_QWORD *)(v14 + 232) + 144LL);
    if ( v15 )
      v12 = (*(int (__fastcall **)(__int64, signed __int64, uintptr_t, _QWORD))(*(_QWORD *)v15 + 2200LL))(
              v15,
              2LL,
              v9,
              0LL);
  }
  v16 = v10;
  (*(void (__fastcall **)(_QWORD, uintptr_t))(**(_QWORD **)(*(_QWORD *)(v3 + 264) + 184LL) + 472LL))(
    *(_QWORD *)(*(_QWORD *)(v3 + 264) + 184LL),
    v10);
  IOUserClient::releaseAsyncReference64((IOUserClient *)(v10 + 48), (unsigned __int64 *)v10);
  v4 = &gUSBStackDebugFlags;
  if ( gUSBStackDebugFlags & 2 )
  {
    v17 = (*(int (__fastcall **)(uintptr_t))(*(_QWORD *)v10 + 24LL))(v10);
    if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      v16 = v3;
      kernel_debug(0x52D0C1Cu, v3, v10, v17, 2uLL, 0LL);
    }
  }
  (*(void (__fastcall **)(uintptr_t, uintptr_t))(*(_QWORD *)v10 + 40LL))(v10, v16);
  if ( !(*(int (__cdecl **)(_QWORD))(**(_QWORD **)(*(_QWORD *)(v3 + 264) + 184LL) + 304LL))(*(_QWORD *)(*(_QWORD *)(v3 + 264) + 184LL)) )
    *(_BYTE *)(*(_QWORD *)(v3 + 264) + 200LL) = 0;
LABEL_34:
  if ( *(_BYTE *)v4 & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D0C1Eu, v3, v12, 0LL, 0LL, 0LL);
  return (unsigned int)v12;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 7D880: using guessed type int __fastcall OSCollectionIterator::withCollection(_QWORD, _QWORD);

//----- (0000000000031FBA) ----------------------------------------------------
int __fastcall IOUSBDeviceUserClientV2::AcknowledgeNotification(IOUSBDeviceUserClientV2 *this, __int64 a2)
{
  __int64 v2; // rax@2
  __int64 v3; // rdi@3
  int result; // eax@4

  if ( !(unsigned __int8)IOService::isInactive(*((IOService **)this + 27))
    && (v2 = *(_QWORD *)(*((_QWORD *)this + 27) + 232LL)) != 0
    && (v3 = *(_QWORD *)(v2 + 144)) != 0 )
    result = (*(int (__fastcall **)(__int64, signed __int64, _QWORD, __int64))(*(_QWORD *)v3 + 2200LL))(
               v3,
               3LL,
               0LL,
               a2);
  else
    result = 0;
  return result;
}

//----- (0000000000032018) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::CreateInterfaceIterator(IOService *this, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  int v4; // er15@1
  __int64 v5; // rax@3
  __int64 v7; // [sp+8h] [bp-28h]@4

  v3 = a3;
  (*(void (**)(void))(*(_QWORD *)this + 2608LL))();
  v4 = -536870183;
  if ( *((_QWORD *)this + 27) )
  {
    if ( !(unsigned __int8)IOService::isInactive(this) )
    {
      LODWORD(v5) = (*(int (**)(void))(**((_QWORD **)this + 27) + 2208LL))();
      v4 = -536870211;
      if ( v5 )
      {
        v4 = (*(int (__fastcall **)(IOService *, _QWORD, __int64, __int64 *))(*(_QWORD *)this + 2344LL))(
               this,
               *((_QWORD *)this + 28),
               v5,
               &v7);
        *(_QWORD *)v3 = v7;
      }
    }
  }
  (*(void (__fastcall **)(IOService *))(*(_QWORD *)this + 2600LL))(this);
  return (unsigned int)v4;
}

//----- (00000000000320B4) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::clientClose(IOUSBDeviceUserClientV2 *this)
{
  int v1; // er14@1
  __int64 v2; // r12@2
  __int64 v3; // r15@3

  (*(void (**)(void))(*(_QWORD *)this + 32LL))();
  v1 = -536870208;
  if ( !(unsigned __int8)IOService::isInactive(this) )
  {
    v2 = *((_QWORD *)this + 30);
    if ( v2 )
    {
      v3 = *((_QWORD *)this + 31);
      if ( v3 )
      {
        (*(void (__fastcall **)(_QWORD))(*(_QWORD *)v3 + 32LL))(*((_QWORD *)this + 31));
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 32LL))(v2);
        v1 = (*(int (__fastcall **)(__int64, int (__fastcall *)(IOUSBDeviceUserClientV2 *, OSObject *, void *, void *, void *, void *), _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v2 + 456LL))(
               v2,
               IOUSBDeviceUserClientV2::ClientCloseEntry,
               0LL,
               0LL,
               0LL,
               0LL);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 40LL))(v2);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 40LL))(v3);
      }
    }
  }
  (*(void (__fastcall **)(IOUSBDeviceUserClientV2 *))(*(_QWORD *)this + 40LL))(this);
  return (unsigned int)v1;
}

//----- (000000000003214E) ----------------------------------------------------
int __fastcall IOUSBDeviceUserClientV2::ClientCloseEntry(IOUSBDeviceUserClientV2 *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  __int64 v6; // rax@1
  int result; // eax@2

  v6 = OSMetaClassBase::safeMetaCast(
         this,
         (const OSMetaClassBase *)&IOUSBDeviceUserClientV2::gMetaClass,
         (const OSMetaClass *)a3);
  if ( v6 )
    result = (*(int (__fastcall **)(__int64, _QWORD *))(*(_QWORD *)v6 + 2632LL))(
               v6,
               &IOUSBDeviceUserClientV2::gMetaClass);
  else
    result = -536870206;
  return result;
}
// 499A0: using guessed type _QWORD IOUSBDeviceUserClientV2::gMetaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000032178) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::ClientCloseGated(IOUSBDeviceUserClientV2 *this)
{
  IOUSBDeviceUserClientV2 *v1; // rbx@1
  __int64 v2; // rdi@1
  __int64 v3; // rax@4
  __int64 v4; // rax@5
  signed int v5; // er14@6
  __int64 v6; // rdi@7
  __int64 v7; // rax@8
  __int64 v8; // rax@12

  v1 = this;
  v2 = *(_QWORD *)(*((_QWORD *)this + 33) + 184LL);
  if ( v2 && (*(int (**)(void))(*(_QWORD *)v2 + 304LL))() )
  {
    while ( 1 )
    {
      LODWORD(v4) = (*(int (**)(void))(**(_QWORD **)(*((_QWORD *)v1 + 33) + 184LL) + 496LL))();
      if ( !v4 )
        break;
      LODWORD(v3) = (*(int (**)(void))(**(_QWORD **)(*((_QWORD *)v1 + 33) + 184LL) + 496LL))();
      (*(void (__fastcall **)(IOUSBDeviceUserClientV2 *, _QWORD))(*(_QWORD *)v1 + 2664LL))(v1, *(_QWORD *)(v3 + 112));
    }
  }
  v5 = -536870208;
  if ( !(unsigned __int8)IOService::isInactive(v1) )
  {
    (*(void (__fastcall **)(IOUSBDeviceUserClientV2 *))(*(_QWORD *)v1 + 32LL))(v1);
    v6 = *((_QWORD *)v1 + 27);
    if ( v6 )
    {
      v7 = *((_QWORD *)v1 + 33);
      if ( *(_BYTE *)(v7 + 180) )
      {
        *(_BYTE *)(v7 + 180) = 0;
        (*(void (__fastcall **)(__int64, IOUSBDeviceUserClientV2 *, signed __int64))(*(_QWORD *)v6 + 1496LL))(
          v6,
          v1,
          0x20000LL);
      }
    }
    if ( !(unsigned __int8)IOService::isInactive(v1) && !*((_DWORD *)v1 + 64) )
    {
      v8 = *((_QWORD *)v1 + 33);
      if ( !*(_BYTE *)(v8 + 182) )
      {
        *(_BYTE *)(v8 + 182) = 1;
        (*(void (**)(void))(**((_QWORD **)v1 + 27) + 40LL))();
        (*(void (__fastcall **)(IOUSBDeviceUserClientV2 *))(*(_QWORD *)v1 + 40LL))(v1);
      }
    }
    *((_QWORD *)v1 + 28) = 0LL;
    v5 = 0;
    (*(void (__fastcall **)(IOUSBDeviceUserClientV2 *, _QWORD))(*(_QWORD *)v1 + 1536LL))(v1, 0LL);
    (*(void (__fastcall **)(IOUSBDeviceUserClientV2 *))(*(_QWORD *)v1 + 40LL))(v1);
  }
  return (unsigned int)v5;
}

//----- (00000000000322AA) ----------------------------------------------------
int __fastcall IOUSBDeviceUserClientV2::clientDied(IOUSBDeviceUserClientV2 *this)
{
  *((_BYTE *)this + 260) = 1;
  return (*(int (**)(void))(off_3B0B8[0] + 2312))();
}
// 3B0B8: using guessed type __int64 off_3B0B8[11];

//----- (00000000000322C4) ----------------------------------------------------
int __fastcall IOUSBDeviceUserClientV2::stop(IOUSBDeviceUserClientV2 *this, IOService *a2)
{
  if ( *((_DWORD *)this + 64) )
    *(_BYTE *)(*((_QWORD *)this + 33) + 181LL) = 1;
  else
    IOUSBDeviceUserClientV2::ReleaseWorkLoopAndGate(this);
  return (*(int (__fastcall **)(IOUSBDeviceUserClientV2 *))(off_3B0B8[0] + 1496))(this);
}
// 3B0B8: using guessed type __int64 off_3B0B8[11];

//----- (000000000003230A) ----------------------------------------------------
int __fastcall IOUSBDeviceUserClientV2::ReleaseWorkLoopAndGate(IOUSBDeviceUserClientV2 *this)
{
  IOUSBDeviceUserClientV2 *v1; // rbx@1
  __int64 v2; // r14@1
  __int64 v3; // r15@2
  int result; // eax@3
  __int64 v5; // rdi@4

  v1 = this;
  v2 = *((_QWORD *)this + 31);
  if ( v2 )
  {
    v3 = *((_QWORD *)this + 30);
    if ( v3 )
    {
      *((_QWORD *)this + 30) = 0LL;
      *((_QWORD *)this + 31) = 0LL;
      (*(void (__fastcall **)(__int64, __int64))(*(_QWORD *)v2 + 328LL))(v2, v3);
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 40LL))(v3);
      result = (*(int (__fastcall **)(__int64))(*(_QWORD *)v2 + 40LL))(v2);
    }
  }
  v5 = *((_QWORD *)this + 29);
  if ( v5 )
  {
    result = IOUserClient::releaseNotificationPort(v5);
    *((_QWORD *)v1 + 29) = 0LL;
  }
  return result;
}
// 7D518: using guessed type int __cdecl IOUserClient::releaseNotificationPort(_QWORD);

//----- (000000000003238E) ----------------------------------------------------
int __fastcall IOUSBDeviceUserClientV2::free(IOUSBDeviceUserClientV2 *this)
{
  IOUSBDeviceUserClientV2 *v1; // rbx@1
  __int64 v2; // rdi@1
  __int64 v3; // rax@2

  v1 = this;
  v2 = *((_QWORD *)this + 33);
  if ( v2 )
  {
    v3 = *(_QWORD *)(v2 + 184);
    if ( v3 )
    {
      if ( (*(int (__fastcall **)(_QWORD))(*(_QWORD *)v3 + 304LL))(*(_QWORD *)(v2 + 184)) )
        (*(void (__cdecl **)(_QWORD))(**(_QWORD **)(*((_QWORD *)v1 + 33) + 184LL) + 344LL))(*(_QWORD *)(*((_QWORD *)v1 + 33) + 184LL));
      (*(void (__cdecl **)(_QWORD))(**(_QWORD **)(*((_QWORD *)v1 + 33) + 184LL) + 40LL))(*(_QWORD *)(*((_QWORD *)v1 + 33) + 184LL));
      v2 = *((_QWORD *)v1 + 33);
    }
    IOFree(v2, 208LL);
    *((_QWORD *)v1 + 33) = 0LL;
  }
  return (*(int (__fastcall **)(IOUSBDeviceUserClientV2 *))(off_3B0B8[0] + 160))(v1);
}
// 3B0B8: using guessed type __int64 off_3B0B8[11];
// 7D218: using guessed type int __fastcall IOFree(_QWORD, _QWORD);

//----- (000000000003241C) ----------------------------------------------------
int __fastcall IOUSBDeviceUserClientV2::finalize(IOUSBDeviceUserClientV2 *this)
{
  return (*(int (__fastcall **)(IOUSBDeviceUserClientV2 *))(off_3B0B8[0] + 1560))(this);
}
// 3B0B8: using guessed type __int64 off_3B0B8[11];

//----- (000000000003242E) ----------------------------------------------------
int __fastcall IOUSBDeviceUserClientV2::willTerminate(IOUSBDeviceUserClientV2 *this, IOService *a2, unsigned int a3)
{
  unsigned int v3; // er14@1

  v3 = a3;
  if ( *((_QWORD *)this + 31) && *((_QWORD *)this + 27) && *((_DWORD *)this + 64) )
    (*(void (__cdecl **)(IOUSBDeviceUserClientV2 *))(*(_QWORD *)this + 2416LL))(this);
  return (*(int (__fastcall **)(IOUSBDeviceUserClientV2 *, IOService *, _QWORD))(off_3B0B8[0] + 1040))(this, a2, v3);
}
// 3B0B8: using guessed type __int64 off_3B0B8[11];

//----- (000000000003248A) ----------------------------------------------------
int __fastcall IOUSBDeviceUserClientV2::didTerminate(IOUSBDeviceUserClientV2 *this, IOService *a2, unsigned int a3, bool *a4)
{
  bool *v4; // r14@1
  unsigned int v5; // er15@1
  IOUSBDeviceUserClientV2 *v6; // rbx@1
  __int64 v7; // rax@2
  __int64 v8; // rdi@3
  __int64 v9; // rdi@7
  char v10; // r13@7
  __int64 v11; // rdi@10

  v4 = a4;
  v5 = a3;
  v6 = this;
  if ( *((_QWORD *)this + 31) )
  {
    v7 = *((_QWORD *)this + 33);
    if ( *(_BYTE *)(v7 + 180) )
    {
      v8 = *((_QWORD *)this + 27);
      if ( v8 )
      {
        *(_BYTE *)(v7 + 180) = 0;
        (*(void (__fastcall **)(__int64, IOUSBDeviceUserClientV2 *, signed __int64))(*(_QWORD *)v8 + 1496LL))(
          v8,
          v6,
          0x20000LL);
      }
    }
    if ( *((_DWORD *)v6 + 64) )
    {
      *((_BYTE *)v6 + 261) = 1;
    }
    else
    {
      v9 = *((_QWORD *)v6 + 27);
      v10 = *(_BYTE *)(*((_QWORD *)v6 + 33) + 182LL);
      if ( v9
        && (unsigned __int8)(*(int (__fastcall **)(__int64, IOUSBDeviceUserClientV2 *))(*(_QWORD *)v9 + 1504LL))(v9, v6) )
      {
        *((_BYTE *)v6 + 261) = 0;
        (*(void (__fastcall **)(_QWORD, IOUSBDeviceUserClientV2 *, _QWORD))(**((_QWORD **)v6 + 27) + 1496LL))(
          *((_QWORD *)v6 + 27),
          v6,
          0LL);
      }
      v11 = *((_QWORD *)v6 + 27);
      if ( v11 && !v10 )
      {
        *(_BYTE *)(*((_QWORD *)v6 + 33) + 182LL) = 1;
        (*(void (__cdecl **)(__int64))(*(_QWORD *)v11 + 40LL))(v11);
        (*(void (__fastcall **)(IOUSBDeviceUserClientV2 *))(*(_QWORD *)v6 + 40LL))(v6);
      }
    }
  }
  return (*(int (__fastcall **)(IOUSBDeviceUserClientV2 *, IOService *, _QWORD, bool *))(off_3B0B8[0] + 1048))(
           v6,
           a2,
           v5,
           v4);
}
// 3B0B8: using guessed type __int64 off_3B0B8[11];

//----- (0000000000032594) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::message(IOUSBDeviceUserClientV2 *this, __int64 a2, IOService *a3, void *a4)
{
  return 0LL;
}

//----- (000000000003259C) ----------------------------------------------------
int __usercall IOUSBDeviceUserClientV2::DecrementOutstandingIO@<eax>(uintptr_t arg1@<rdi>, __int64 a2@<rax>)
{
  uintptr_t v2; // r14@1
  __int64 v3; // rbx@1
  __int64 v4; // r15@2
  uintptr_t v5; // rbx@5
  bool v6; // zf@6
  __int64 v7; // rdi@9

  v2 = arg1;
  v3 = *(_QWORD *)(arg1 + 240);
  if ( v3 )
  {
    v4 = *(_QWORD *)(arg1 + 248);
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52DA804u, arg1, *(_DWORD *)(arg1 + 256), 0LL, 0LL, 0LL);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v4 + 32LL))(v4);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 32LL))(v3);
    (*(void (__fastcall **)(__int64, __int64 (__fastcall *)(IOUSBDeviceUserClientV2 *__hidden, OSObject *, void *, void *, void *, void *), signed __int64, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v3 + 456LL))(
      v3,
      IOUSBDeviceUserClientV2::ChangeOutstandingIO,
      -1LL,
      0LL,
      0LL,
      0LL);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 40LL))(v3);
    LODWORD(a2) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v4 + 40LL))(v4);
    v5 = arg1 + 256;
  }
  else
  {
    v5 = arg1 + 256;
    v6 = (*(_DWORD *)(arg1 + 256))-- == 1;
    if ( v6 )
    {
      if ( *(_BYTE *)(arg1 + 261) )
      {
        a2 = *(_QWORD *)(arg1 + 264);
        if ( !*(_BYTE *)(a2 + 182) )
        {
          *(_BYTE *)(a2 + 182) = 1;
          v7 = *(_QWORD *)(arg1 + 216);
          if ( v7 )
          {
            (*(void (__fastcall **)(__int64, uintptr_t, _QWORD))(*(_QWORD *)v7 + 1496LL))(v7, v2, 0LL);
            (*(void (__cdecl **)(_QWORD))(**(_QWORD **)(v2 + 216) + 40LL))(*(_QWORD *)(v2 + 216));
            *(_BYTE *)(v2 + 261) = 0;
          }
          LODWORD(a2) = (*(int (__fastcall **)(uintptr_t))(*(_QWORD *)v2 + 40LL))(v2);
        }
      }
    }
  }
  if ( !*(_DWORD *)v5 )
  {
    a2 = *(_QWORD *)(v2 + 264);
    if ( *(_BYTE *)(a2 + 181) )
    {
      *(_BYTE *)(a2 + 181) = 0;
      LODWORD(a2) = IOUSBDeviceUserClientV2::ReleaseWorkLoopAndGate((IOUSBDeviceUserClientV2 *)v2);
    }
  }
  return a2;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (00000000000326E8) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::ChangeOutstandingIO(IOUSBDeviceUserClientV2 *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  int v6; // er14@1
  uintptr_t v7; // rsi@1
  uintptr_t v8; // rax@1
  uintptr_t v9; // rbx@1
  bool v10; // zf@3
  __int64 v11; // rax@5
  __int64 v12; // rdi@6
  uintptr_t v13; // r14@11
  uintptr_t v14; // rsi@11
  uintptr_t v15; // r8@11

  v6 = (signed int)a2;
  v7 = (uintptr_t)&IOUSBDeviceUserClientV2::gMetaClass;
  v8 = OSMetaClassBase::safeMetaCast(
         this,
         (const OSMetaClassBase *)&IOUSBDeviceUserClientV2::gMetaClass,
         (const OSMetaClass *)a3);
  v9 = v8;
  if ( !v8 )
  {
    if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
      return 0LL;
    v13 = v6 & 0xFFFFFFFF;
    v14 = 0LL;
    v15 = 1LL;
LABEL_17:
    kernel_debug(0x52D0C0Cu, v14, v13, 0LL, v15, 0LL);
    return 0LL;
  }
  if ( v6 == -1 )
  {
    v10 = (*(_DWORD *)(v8 + 256))-- == 1;
    if ( v10 )
    {
      if ( *(_BYTE *)(v8 + 261) )
      {
        v11 = *(_QWORD *)(v8 + 264);
        if ( !*(_BYTE *)(v11 + 182) )
        {
          *(_BYTE *)(v11 + 182) = 1;
          v12 = *(_QWORD *)(v9 + 216);
          if ( v12 )
          {
            v7 = v9;
            (*(void (__fastcall **)(__int64, uintptr_t, _QWORD))(*(_QWORD *)v12 + 1496LL))(v12, v9, 0LL);
            (*(void (__cdecl **)(_QWORD))(**(_QWORD **)(v9 + 216) + 40LL))(*(_QWORD *)(v9 + 216));
            *(_BYTE *)(v9 + 261) = 0;
          }
          (*(void (__fastcall **)(uintptr_t, uintptr_t))(*(_QWORD *)v9 + 40LL))(v9, v7);
        }
      }
    }
    return 0LL;
  }
  if ( v6 == 1 )
  {
    ++*(_DWORD *)(v8 + 256);
    return 0LL;
  }
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
  {
    v13 = v6 & 0xFFFFFFFF;
    v15 = 2LL;
    v14 = v8;
    goto LABEL_17;
  }
  return 0LL;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 499A0: using guessed type _QWORD IOUSBDeviceUserClientV2::gMetaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000003280C) ----------------------------------------------------
int __fastcall IOUSBDeviceUserClientV2::IncrementOutstandingIO(uintptr_t arg1)
{
  __int64 v1; // r15@1
  __int64 v2; // r14@1
  int result; // eax@1

  v1 = *(_QWORD *)(arg1 + 240);
  v2 = *(_QWORD *)(arg1 + 248);
  result = IOService::isInactive((IOService *)arg1);
  if ( *(_QWORD *)(arg1 + 240) )
  {
    if ( gUSBStackDebugFlags & 2 )
    {
      if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        kernel_debug(0x52DA808u, arg1, *(_DWORD *)(arg1 + 256), 0LL, 0LL, 0LL);
    }
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 32LL))(v2);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v1 + 32LL))(v1);
    (*(void (__fastcall **)(__int64, __int64 (__fastcall *)(IOUSBDeviceUserClientV2 *__hidden, OSObject *, void *, void *, void *, void *), signed __int64, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v1 + 456LL))(
      v1,
      IOUSBDeviceUserClientV2::ChangeOutstandingIO,
      1LL,
      0LL,
      0LL,
      0LL);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v1 + 40LL))(v1);
    result = (*(int (__fastcall **)(__int64))(*(_QWORD *)v2 + 40LL))(v2);
  }
  else
  {
    ++*(_DWORD *)(arg1 + 256);
  }
  return result;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (00000000000328D0) ----------------------------------------------------
__int64 __usercall IOUSBDeviceUserClientV2::GetOutstandingIO@<rax>(IOUSBDeviceUserClientV2 *this@<rdi>, __int64 a2@<rax>)
{
  __int64 v2; // r15@1
  __int64 v3; // r14@1
  char *v4; // rbx@2
  __int64 v6; // [sp-4h] [bp-20h]@1

  v6 = a2;
  v2 = *((_QWORD *)this + 30);
  v3 = *((_QWORD *)this + 31);
  HIDWORD(v6) = 0;
  if ( v2 )
  {
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 32LL))(v3);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 32LL))(v2);
    v4 = (char *)&v6 + 4;
    (*(void (__fastcall **)(__int64, __int64 (__fastcall *)(IOUSBDeviceUserClientV2 *__hidden, OSObject *, void *, void *, void *, void *), char *, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v2 + 456LL))(
      v2,
      IOUSBDeviceUserClientV2::GetGatedOutstandingIO,
      (char *)&v6 + 4,
      0LL,
      0LL,
      0LL);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v2 + 40LL))(v2);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 40LL))(v3);
  }
  else
  {
    v4 = (char *)this + 256;
  }
  return *(_DWORD *)v4;
}

//----- (0000000000032954) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::GetGatedOutstandingIO(IOUSBDeviceUserClientV2 *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  __int64 v6; // rax@1

  v6 = OSMetaClassBase::safeMetaCast(
         this,
         (const OSMetaClassBase *)&IOUSBDeviceUserClientV2::gMetaClass,
         (const OSMetaClass *)a3);
  if ( v6 )
  {
    *(_DWORD *)a2 = *(_DWORD *)(v6 + 256);
  }
  else if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
  {
    kernel_debug(0x52D0C10u, 0LL, 0LL, 0LL, 0LL, 0LL);
  }
  return 0LL;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 499A0: using guessed type _QWORD IOUSBDeviceUserClientV2::gMetaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (00000000000329B2) ----------------------------------------------------
void IOUSBDeviceUserClientV2::PrintExternalMethodArgs()
{
  ;
}

//----- (00000000000329B8) ----------------------------------------------------
signed __int64 IOUSBDeviceUserClientV2::CreateInterfaceIterator()
{
  return 3758097095LL;
}

//----- (00000000000329C4) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::_RESERVEDIOUSBDeviceUserClientV27(IOUSBDeviceUserClientV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBDeviceUserClientV2::gMetaClass, 7);
}
// 499A0: using guessed type _QWORD IOUSBDeviceUserClientV2::gMetaClass;

//----- (00000000000329DA) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::_RESERVEDIOUSBDeviceUserClientV28(IOUSBDeviceUserClientV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBDeviceUserClientV2::gMetaClass, 8);
}
// 499A0: using guessed type _QWORD IOUSBDeviceUserClientV2::gMetaClass;

//----- (00000000000329F0) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::_RESERVEDIOUSBDeviceUserClientV29(IOUSBDeviceUserClientV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBDeviceUserClientV2::gMetaClass, 9);
}
// 499A0: using guessed type _QWORD IOUSBDeviceUserClientV2::gMetaClass;

//----- (0000000000032A06) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::_RESERVEDIOUSBDeviceUserClientV210(IOUSBDeviceUserClientV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBDeviceUserClientV2::gMetaClass, 10);
}
// 499A0: using guessed type _QWORD IOUSBDeviceUserClientV2::gMetaClass;

//----- (0000000000032A1C) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::_RESERVEDIOUSBDeviceUserClientV211(IOUSBDeviceUserClientV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBDeviceUserClientV2::gMetaClass, 11);
}
// 499A0: using guessed type _QWORD IOUSBDeviceUserClientV2::gMetaClass;

//----- (0000000000032A32) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::_RESERVEDIOUSBDeviceUserClientV212(IOUSBDeviceUserClientV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBDeviceUserClientV2::gMetaClass, 12);
}
// 499A0: using guessed type _QWORD IOUSBDeviceUserClientV2::gMetaClass;

//----- (0000000000032A48) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::_RESERVEDIOUSBDeviceUserClientV213(IOUSBDeviceUserClientV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBDeviceUserClientV2::gMetaClass, 13);
}
// 499A0: using guessed type _QWORD IOUSBDeviceUserClientV2::gMetaClass;

//----- (0000000000032A5E) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::_RESERVEDIOUSBDeviceUserClientV214(IOUSBDeviceUserClientV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBDeviceUserClientV2::gMetaClass, 14);
}
// 499A0: using guessed type _QWORD IOUSBDeviceUserClientV2::gMetaClass;

//----- (0000000000032A74) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::_RESERVEDIOUSBDeviceUserClientV215(IOUSBDeviceUserClientV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBDeviceUserClientV2::gMetaClass, 15);
}
// 499A0: using guessed type _QWORD IOUSBDeviceUserClientV2::gMetaClass;

//----- (0000000000032A8A) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::_RESERVEDIOUSBDeviceUserClientV216(IOUSBDeviceUserClientV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBDeviceUserClientV2::gMetaClass, 16);
}
// 499A0: using guessed type _QWORD IOUSBDeviceUserClientV2::gMetaClass;

//----- (0000000000032AA0) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::_RESERVEDIOUSBDeviceUserClientV217(IOUSBDeviceUserClientV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBDeviceUserClientV2::gMetaClass, 17);
}
// 499A0: using guessed type _QWORD IOUSBDeviceUserClientV2::gMetaClass;

//----- (0000000000032AB6) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::_RESERVEDIOUSBDeviceUserClientV218(IOUSBDeviceUserClientV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBDeviceUserClientV2::gMetaClass, 18);
}
// 499A0: using guessed type _QWORD IOUSBDeviceUserClientV2::gMetaClass;

//----- (0000000000032ACC) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::_RESERVEDIOUSBDeviceUserClientV219(IOUSBDeviceUserClientV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBDeviceUserClientV2::gMetaClass, 19);
}
// 499A0: using guessed type _QWORD IOUSBDeviceUserClientV2::gMetaClass;

//----- (0000000000032AE2) ----------------------------------------------------
__int64 __fastcall IOUSBNotification::MetaClass::~MetaClass(IOUSBNotification::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000032AEC) ----------------------------------------------------
__int64 __fastcall IOUSBDeviceUserClientV2::MetaClass::~MetaClass(IOUSBDeviceUserClientV2::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000032B00) ----------------------------------------------------
__int64 `global constructor keyed to'_a_16()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(&IOUSBNotification::gMetaClass, "IOUSBNotification", off_3B080[0], 120LL);
  IOUSBNotification::gMetaClass = off_46560;
  OSMetaClass::OSMetaClass(&IOUSBDeviceUserClientV2::gMetaClass, "IOUSBDeviceUserClientV2", off_3B030[0], 272LL);
  result = (__int64)off_47160;
  IOUSBDeviceUserClientV2::gMetaClass = off_47160;
  return result;
}
// 3B030: using guessed type _QWORD *off_3B030[5];
// 3B080: using guessed type _QWORD off_3B080[18];
// 46560: using guessed type __int64 (__fastcall *off_46560[2])(IOUSBNotification::MetaClass *__hidden this);
// 47160: using guessed type __int64 (__fastcall *off_47160[2])(IOUSBDeviceUserClientV2::MetaClass *__hidden this);
// 49978: using guessed type _QWORD IOUSBNotification::gMetaClass;
// 499A0: using guessed type _QWORD IOUSBDeviceUserClientV2::gMetaClass;
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000032B60) ----------------------------------------------------
__int64 `global destructor keyed to'_a_16()
{
  OSMetaClass::~OSMetaClass((OSMetaClass *)&IOUSBDeviceUserClientV2::gMetaClass);
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&IOUSBNotification::gMetaClass);
}
// 49978: using guessed type _QWORD IOUSBNotification::gMetaClass;
// 499A0: using guessed type _QWORD IOUSBDeviceUserClientV2::gMetaClass;

//----- (0000000000032B80) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::MetaClass::MetaClass(IOUSBPipeV2::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBPipeV2", &IOUSBPipe::gMetaClass, 104LL);
  result = (__int64)off_47870;
  *(_QWORD *)this = off_47870;
  return result;
}
// 47870: using guessed type __int64 (__fastcall *off_47870[2])(IOUSBPipeV2::MetaClass *__hidden this);
// 49660: using guessed type _QWORD IOUSBPipe::gMetaClass;
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000032BB2) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::MetaClass::~MetaClass(IOUSBPipeV2::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000032BBC) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::IOUSBPipeV2(__int64 a1)
{
  __int64 result; // rax@1

  IOUSBPipe::IOUSBPipe(a1);
  result = (__int64)off_474C0;
  *(_QWORD *)a1 = off_474C0;
  return result;
}
// 474C0: using guessed type __int64 (__fastcall *off_474C0[2])(IOUSBPipeV2 *__hidden this);

//----- (0000000000032BDC) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::IOUSBPipeV2(__int64 a1)
{
  __int64 result; // rax@1

  IOUSBPipe::IOUSBPipe(a1);
  result = (__int64)off_474C0;
  *(_QWORD *)a1 = off_474C0;
  return result;
}
// 474C0: using guessed type __int64 (__fastcall *off_474C0[2])(IOUSBPipeV2 *__hidden this);

//----- (0000000000032BFC) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::~IOUSBPipeV2(IOUSBPipeV2 *this)
{
  return IOUSBPipe::~IOUSBPipe(this);
}

//----- (0000000000032C06) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::~IOUSBPipeV2(IOUSBPipeV2 *this)
{
  return IOUSBPipe::~IOUSBPipe(this);
}

//----- (0000000000032C10) ----------------------------------------------------
void __fastcall IOUSBPipeV2::~IOUSBPipeV2(IOUSBPipeV2 *this)
{
  IOUSBPipe::~IOUSBPipe(this);
  OSObject::operator delete((void *)this);
}

//----- (0000000000032C32) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::getMetaClass(IOUSBPipeV2 *this)
{
  return (__int64)&IOUSBPipeV2::gMetaClass;
}
// 499C8: using guessed type _QWORD IOUSBPipeV2::gMetaClass;

//----- (0000000000032C40) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::MetaClass::MetaClass(IOUSBPipeV2::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBPipeV2", &IOUSBPipe::gMetaClass, 104LL);
  result = (__int64)off_47870;
  *(_QWORD *)this = off_47870;
  return result;
}
// 47870: using guessed type __int64 (__fastcall *off_47870[2])(IOUSBPipeV2::MetaClass *__hidden this);
// 49660: using guessed type _QWORD IOUSBPipe::gMetaClass;
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000032C72) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::MetaClass::alloc(IOUSBPipeV2::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&stru_68, a2);
  IOUSBPipe::IOUSBPipe(v2);
  *(_QWORD *)v2 = off_474C0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBPipeV2::gMetaClass);
  return v2;
}
// 68: using guessed type section_64 stru_68;
// 474C0: using guessed type __int64 (__fastcall *off_474C0[2])(IOUSBPipeV2 *__hidden this);
// 499C8: using guessed type _QWORD IOUSBPipeV2::gMetaClass;

//----- (0000000000032CB2) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::IOUSBPipeV2(__int64 a1)
{
  IOUSBPipe::IOUSBPipe(a1);
  *(_QWORD *)a1 = off_474C0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBPipeV2::gMetaClass);
}
// 474C0: using guessed type __int64 (__fastcall *off_474C0[2])(IOUSBPipeV2 *__hidden this);
// 499C8: using guessed type _QWORD IOUSBPipeV2::gMetaClass;

//----- (0000000000032CE2) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::IOUSBPipeV2(__int64 a1)
{
  IOUSBPipe::IOUSBPipe(a1);
  *(_QWORD *)a1 = off_474C0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBPipeV2::gMetaClass);
}
// 474C0: using guessed type __int64 (__fastcall *off_474C0[2])(IOUSBPipeV2 *__hidden this);
// 499C8: using guessed type _QWORD IOUSBPipeV2::gMetaClass;

//----- (0000000000032D12) ----------------------------------------------------
char __fastcall IOUSBPipeV2::InitToEndpoint(uintptr_t arg1, uintptr_t arg2, uintptr_t a3, unsigned __int8 a4, unsigned __int16 a5, OSMetaClassBase *a6, __int64 a7, __int64 a8)
{
  OSMetaClassBase *v8; // r14@1
  __int16 v9; // r12@1
  char v10; // bl@1
  uintptr_t v11; // r13@1
  uintptr_t v12; // rsi@1
  uintptr_t v13; // r15@4
  unsigned __int8 v14; // al@4
  const OSMetaClass *v15; // rdx@4
  uintptr_t v16; // rcx@4
  char v17; // r13@4
  uintptr_t v18; // r12@4
  void *v19; // rax@7
  __int64 v20; // rax@9
  __int64 v21; // rdx@9
  __int64 v22; // rcx@9
  __int64 v23; // r8@9
  uintptr_t v24; // r9@9
  __int64 v25; // rax@11
  __int64 v26; // r9@11
  __int64 v27; // rdi@12
  uintptr_t v28; // r11@12
  unsigned __int8 v29; // al@12
  signed __int64 v30; // r14@12
  unsigned __int8 v31; // dl@12
  char v32; // bl@12
  unsigned __int8 v33; // r13@15
  unsigned int v34; // esi@15
  signed __int16 v35; // r8@15
  int v36; // esi@17
  signed int v37; // ecx@17
  __int64 v38; // rax@21
  __int64 v39; // rcx@23
  __int64 v40; // rax@24
  bool v41; // zf@27
  int v42; // ecx@27
  uintptr_t v43; // rbx@28
  uintptr_t v44; // r12@28
  signed __int64 v45; // r15@28
  signed __int16 v46; // r14@28
  unsigned int v47; // eax@30
  unsigned __int16 v48; // r15@33
  int v49; // ecx@47
  int v50; // eax@50
  int v51; // eax@55
  uintptr_t v52; // r12@56
  __int64 v53; // rax@63
  uintptr_t v54; // rbx@64
  char v55; // al@64
  char v56; // al@65
  char v57; // al@66
  unsigned __int16 v58; // bx@67
  uintptr_t v59; // r15@67
  uintptr_t v60; // rsi@68
  __int64 v61; // rax@71
  __int64 v62; // rdi@74
  uintptr_t v63; // rbx@75
  OSMetaClassBase *v64; // rax@75
  __int64 v65; // rsi@75
  const OSMetaClass *v66; // rdx@75
  __int64 v67; // rax@75
  int v68; // eax@76
  uintptr_t v69; // rbx@79
  __int64 v70; // rax@80
  int v71; // ecx@80
  int v72; // ecx@82
  unsigned __int16 v73; // bx@84
  uintptr_t v74; // r15@84
  unsigned int v75; // er14@84
  __int64 v76; // rdi@84
  __int64 v77; // rax@85
  __int64 v78; // r8@85
  unsigned int v79; // eax@92
  uintptr_t v80; // r15@94
  int v81; // eax@94
  __int64 v82; // r8@95
  __int64 v83; // rax@98
  __int64 v84; // rdi@98
  __int64 v85; // rax@99
  __int64 v86; // rcx@99
  __int64 v88; // rax@106
  char v89; // [sp+0h] [bp-50h]@0
  uintptr_t v90; // [sp+8h] [bp-48h]@33
  __int64 v91; // [sp+10h] [bp-40h]@12
  unsigned __int8 v92; // [sp+18h] [bp-38h]@9
  __int16 v93; // [sp+1Ch] [bp-34h]@4
  uintptr_t v94; // [sp+20h] [bp-30h]@1
  signed __int64 v95; // [sp+20h] [bp-30h]@84

  v8 = a6;
  v9 = a5;
  v10 = a4;
  v94 = a3;
  v11 = arg2;
  v12 = arg1;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D2005u, arg1, v11, (unsigned __int8)a4, (unsigned __int16)a5, 0LL);
  v93 = v9;
  v13 = arg1;
  v14 = ((int (__fastcall *)(uintptr_t))`vtable for'IOUSBPipe[19])(arg1);
  v16 = v11;
  v17 = 0;
  v18 = v16;
  if ( !v16 || (unsigned __int8)v14 ^ 1 )
    return v17;
  if ( !*(_QWORD *)(arg1 + 56) )
  {
    LODWORD(v19) = IOMalloc(48LL);
    *(_QWORD *)(arg1 + 56) = v19;
    if ( !v19 )
      return 0;
    bzero(v19, 0x30uLL);
  }
  v92 = v10;
  *(_QWORD *)(arg1 + 40) = v8;
  v20 = OSMetaClassBase::safeMetaCast(v8, (const OSMetaClassBase *)IOUSBControllerV3::metaClass, v15);
  v24 = v94;
  if ( !v20 && v94 )
  {
    v17 = 0;
    LODWORD(v25) = (*(int (__fastcall **)(__int64, _QWORD, __int64, __int64, __int64, uintptr_t))(*(_QWORD *)a7 + 904LL))(
                     a7,
                     0LL,
                     v21,
                     v22,
                     v23,
                     v94);
    KernelDebugLogInternal(
      1u,
      0x55534246u,
      (__int64)"IOUSBPipeV2::InitToEndpoint (%s, EP: 0x%x) -- Requested a pipe with stream ID, but this IOUSBController does not support it",
      v25,
      *(_BYTE *)(v18 + 2),
      v26,
      v89);
    return v17;
  }
  v91 = v20;
  v27 = a8;
  v28 = v12;
  *(_QWORD *)(v12 + 16) = v18;
  *(_QWORD *)(v12 + 64) = v94;
  v29 = *(_BYTE *)(v18 + 2);
  v30 = v12 + 24;
  *(_BYTE *)(v12 + 32) = *(_BYTE *)(v18 + 2) & 0xF;
  v31 = *(_BYTE *)(v18 + 3);
  v32 = *(_BYTE *)(v18 + 3) & 3;
  *(_BYTE *)(v12 + 34) = v32;
  if ( v32 )
    *(_BYTE *)(v13 + 33) = v29 >> 7;
  else
    *(_BYTE *)(v13 + 33) = 3;
  v33 = v92;
  v34 = *(_WORD *)(v18 + 4);
  v35 = *(_WORD *)(v18 + 4) & 0x7FF;
  *(_WORD *)(v13 + 36) = v35;
  if ( !v94 && (unsigned __int8)(v32 | 2) == 3 )
  {
    v36 = (v34 >> 11) & 3;
    v37 = 2;
    if ( v36 != 3 )
      v37 = v36;
    *(_DWORD *)(v13 + 84) = v37;
  }
  *(_BYTE *)(v13 + 38) = *(_BYTE *)(v18 + 6);
  if ( v32 == 1 )
  {
    v38 = *(_QWORD *)(v13 + 56);
    *(_BYTE *)(v38 + 41) = (v31 >> 4) & 3;
    *(_BYTE *)(v38 + 42) = (v31 >> 2) & 3;
  }
  else if ( v32 == 3 )
  {
    v39 = *(_QWORD *)(v13 + 56);
    *(_BYTE *)(v39 + 41) = (v31 >> 4) & 3;
    *(_BYTE *)(v39 + 42) = 0;
  }
  else
  {
    v40 = *(_QWORD *)(v13 + 56);
    *(_BYTE *)(v40 + 41) = 0;
    *(_BYTE *)(v40 + 42) = 0;
  }
  *(_DWORD *)(v13 + 76) = 0;
  if ( v94 )
  {
    *(_DWORD *)(v13 + 76) = *(_BYTE *)(v94 + 2);
    *(_DWORD *)(v13 + 88) = *(_WORD *)(v94 + 4);
    if ( v32 == 2 )
    {
      v41 = (*(_BYTE *)(v94 + 3) & 0x1F) == 0;
      v42 = *(_BYTE *)(v94 + 3) & 0x1F;
      *(_DWORD *)(v13 + 72) = v42;
      *(_DWORD *)(v13 + 80) = 0;
      if ( v41 )
      {
        v48 = 0;
      }
      else
      {
        v43 = v18;
        v44 = v13;
        v45 = v30;
        v46 = -3;
        if ( (((1 << v42) - 1) & 0xFFFEu) <= 0xFFFD )
          v46 = (1 << v42) - 1;
        v47 = (*(int (**)(void))(*(_QWORD *)v91 + 3256LL))();
        if ( v46 && !v47 )
        {
          *(_DWORD *)(v44 + 72) = 0;
          return 0;
        }
        if ( (unsigned __int16)v46 <= v47 )
          LOWORD(v47) = v46;
        v28 = v44;
        v35 = *(_WORD *)(v44 + 36);
        v30 = v45;
        v24 = v94;
        v18 = v43;
        v48 = v47;
        v27 = a8;
        v33 = v92;
      }
      if ( v35 != 1024 )
        *(_WORD *)(v28 + 36) = 1024;
      v32 = *(_BYTE *)(v28 + 34);
      v35 = 1024;
    }
    else
    {
      v48 = 0;
    }
    if ( !v32 )
    {
      if ( v35 != 512 )
        *(_WORD *)(v28 + 36) = 512;
      *(_DWORD *)(v28 + 76) = 0;
      v35 = 512;
    }
    if ( v32 == 1 )
    {
      v49 = 2;
      if ( (*(_BYTE *)(v24 + 3) & 3) != 3 )
        v49 = *(_BYTE *)(v24 + 3) & 3;
      *(_DWORD *)(v28 + 84) = v49;
      if ( !(*(_DWORD *)(v28 + 76) | v49) )
      {
        v90 = v18;
        goto LABEL_61;
      }
      v90 = v18;
      v50 = (unsigned __int16)v35;
      v35 = 1024;
      if ( v50 != 1024 )
        *(_WORD *)(v28 + 36) = 1024;
    }
    else
    {
      v90 = v18;
    }
    if ( v32 == 3 )
    {
      if ( *(_DWORD *)(v28 + 76) )
      {
        v51 = (unsigned __int16)v35;
        v35 = 1024;
        if ( v51 != 1024 )
        {
          v52 = v24;
          *(_WORD *)(v28 + 36) = 1024;
LABEL_62:
          *(_WORD *)(v28 + 36) = v35 * (*(_WORD *)(v28 + 84) + 1) * (*(_WORD *)(v28 + 76) + 1);
          goto LABEL_63;
        }
      }
      else if ( !v35 )
      {
        v52 = v24;
        *(_WORD *)(v28 + 36) = 1;
        v35 = 1;
        goto LABEL_62;
      }
LABEL_61:
      v52 = v24;
      goto LABEL_62;
    }
  }
  else
  {
    v90 = v18;
    v48 = 0;
  }
  v52 = v24;
  if ( (unsigned __int8)(v32 | 2) == 3 )
    goto LABEL_62;
LABEL_63:
  *(_WORD *)(v28 + 48) = v93;
  v53 = *(_QWORD *)(v28 + 56);
  *(_BYTE *)(v53 + 16) = v33;
  *(_QWORD *)(v53 + 8) = a7;
  *(_QWORD *)(v53 + 24) = v27;
  if ( v27 )
  {
    v54 = v28;
    v55 = (*(int (**)(void))(*(_QWORD *)v27 + 2248LL))();
    v28 = v54;
    if ( v55 == 8 )
    {
      v56 = (*(int (**)(void))(**(_QWORD **)(*(_QWORD *)(v54 + 56) + 24LL) + 2256LL))();
      v28 = v54;
      if ( v56 == 6 )
      {
        v57 = (*(int (**)(void))(**(_QWORD **)(*(_QWORD *)(v54 + 56) + 24LL) + 2264LL))();
        v28 = v54;
        if ( v57 == 98 )
        {
          v58 = v48;
          v59 = v28;
          v60 = *(_QWORD *)(v28 + 64) ? v52 : v90;
          LODWORD(v61) = (*(int (__fastcall **)(_QWORD, uintptr_t, _QWORD))(**(_QWORD **)(*(_QWORD *)(v28 + 56) + 24LL)
                                                                          + 2184LL))(
                           *(_QWORD *)(*(_QWORD *)(v28 + 56) + 24LL),
                           v60,
                           0LL);
          v28 = v59;
          v48 = v58;
          if ( v61 )
          {
            if ( *(_BYTE *)(v61 + 1) == 36 )
              *(_BYTE *)(*(_QWORD *)(v28 + 56) + 40LL) = *(_BYTE *)(v61 + 2);
          }
        }
      }
    }
  }
  v62 = *(_QWORD *)(*(_QWORD *)(v28 + 56) + 8LL);
  if ( v62 )
  {
    v63 = v28;
    LODWORD(v64) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v62 + 696LL))(v62, "locationID");
    v65 = *(_QWORD *)off_3B078[0];
    v67 = OSMetaClassBase::safeMetaCast(v64, *(const OSMetaClassBase **)off_3B078[0], v66);
    v28 = v63;
    if ( v67 )
    {
      v68 = (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v67 + 328LL))(v67, v65);
      v28 = v63;
      *(_DWORD *)(*(_QWORD *)(v63 + 56) + 36LL) = v68;
    }
  }
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
  {
    v69 = v28;
    kernel_debug(0x52D2004u, v28, *(_QWORD *)(v28 + 40), *(_BYTE *)(v28 + 34), *(_WORD *)(v28 + 36), 0LL);
    v28 = v69;
  }
  v70 = *(_QWORD *)(v28 + 56);
  v71 = *(_BYTE *)(v70 + 16);
  if ( v71 != 2 )
    goto LABEL_88;
  if ( *(_BYTE *)(v28 + 34) == 2 )
  {
    v72 = *(_WORD *)(v28 + 36);
    if ( v72 != 512 && !*(_BYTE *)(v28 + 50) )
    {
      v73 = v48;
      v74 = v28;
      v95 = v30;
      v75 = *(_BYTE *)(v90 + 2);
      v76 = *(_QWORD *)(v70 + 8);
      if ( v76 )
      {
        LODWORD(v77) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v76 + 904LL))(v76, 0LL);
        v78 = v77;
        v70 = *(_QWORD *)(v74 + 56);
        LOWORD(v72) = *(_WORD *)(v74 + 36);
      }
      else
      {
        v78 = (__int64)"Unnamed";
      }
      KernelDebugLogInternal(
        1u,
        0x55534246u,
        (__int64)"Endpoint 0x%x of the USB device \"%s\" at location 0x%x:  converting Bulk MPS from %d to 512 (USB 2.0 Spec section 5.8.3)",
        (unsigned int)v75,
        v78,
        *(_DWORD *)(v70 + 36),
        v72);
      *(_WORD *)(v74 + 36) = 512;
      LOBYTE(v71) = *(_BYTE *)(*(_QWORD *)(v74 + 56) + 16LL);
      v30 = v95;
      v28 = v74;
      v48 = v73;
LABEL_88:
      if ( (unsigned __int8)v71 == 1 && *(_BYTE *)(v28 + 34) == 1 && (unsigned int)*(_WORD *)(v28 + 36) >= 0x400 )
        *(_WORD *)(v28 + 36) = 1023;
      goto LABEL_92;
    }
  }
LABEL_92:
  v79 = *(_DWORD *)(v28 + 76);
  if ( v48 || v79 )
  {
    v82 = (unsigned __int16)v48;
    v80 = v28;
    v81 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, signed __int64, __int64, _QWORD))(*(_QWORD *)v91 + 3248LL))(
            v91,
            *(_WORD *)(v28 + 48),
            (unsigned __int8)v33,
            v30,
            v82,
            (unsigned int)v79 | (*(_DWORD *)(v28 + 84) << 8));
  }
  else
  {
    v80 = v28;
    v81 = (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD, signed __int64))(**(_QWORD **)(v28 + 40) + 2352LL))(
            *(_QWORD *)(v28 + 40),
            *(_WORD *)(v28 + 48),
            (unsigned __int8)v33,
            v30);
  }
  if ( v81 == -536870164 )
  {
    if ( *(_BYTE *)(v80 + 34) != 1 )
      return 0;
    v83 = *(_QWORD *)(v80 + 56);
    v84 = *(_QWORD *)(v83 + 8);
    if ( v84 )
    {
      LODWORD(v85) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v84 + 904LL))(v84, 0LL);
      v86 = v85;
      v83 = *(_QWORD *)(v80 + 56);
    }
    else
    {
      v86 = (__int64)"Unnamed";
    }
    KernelDebugLogInternal(
      1u,
      0x55534246u,
      (__int64)"There is not enough USB isochronous bandwidth to allow the device \"%s\" at location 0x%x to function in its current configuration (requested %d bytes for endpoint 0x%x )",
      v86,
      *(_DWORD *)(v83 + 36),
      *(_WORD *)(v80 + 36),
      *(_BYTE *)(v90 + 2));
    *(_WORD *)(v80 + 36) = 0;
    v81 = (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD, signed __int64))(**(_QWORD **)(v80 + 40) + 2352LL))(
            *(_QWORD *)(v80 + 40),
            *(_WORD *)(v80 + 48),
            (unsigned __int8)v33,
            v30);
  }
  if ( v81 )
    return 0;
  if ( a7 )
  {
    LODWORD(v88) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)a7 + 696LL))(a7, "ZeroNoDataTimeout");
    if ( v88 == **(_QWORD **)off_3B0F8[0] )
      *(_BYTE *)(*(_QWORD *)(v80 + 56) + 43LL) = 1;
  }
  v17 = 1;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D2006u, v80, 0LL, 0LL, 0LL, 0LL);
  return v17;
}
// 32D12: too many cbuild loops
// 3B078: using guessed type _QWORD off_3B078[19];
// 3B0F8: using guessed type __int64 off_3B0F8[3];
// 3B100: using guessed type __int64 off_3B100[2];
// 3DBD0: using guessed type __int64 `vtable for'IOUSBPipe[2];
// 44350: using guessed type _QWORD IOUSBControllerV3::metaClass;
// 49460: using guessed type int gUSBStackDebugFlags;
// 7D250: using guessed type int __fastcall IOMalloc(_QWORD);
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000033460) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::ToEndpoint(__int64 a1, unsigned __int64 a2, __int64 a3, __int64 a4, __int64 a5)
{
  __int64 v5; // r13@1
  __int64 v6; // r14@1
  __int64 v7; // rbx@1
  _QWORD *v8; // rsi@1
  __int64 v9; // rax@3
  int (__fastcall *v10)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD); // r12@5
  unsigned __int8 v11; // r15@5
  unsigned __int16 v12; // ax@5
  __int64 v13; // rax@7
  __int64 v14; // rdi@8
  __int64 v15; // rax@9
  unsigned __int64 v17; // [sp+18h] [bp-38h]@1
  __int64 v18; // [sp+20h] [bp-30h]@1

  v5 = a5;
  v18 = a4;
  v6 = a3;
  v17 = a2;
  v7 = OSObject::operator new((OSObject *)&stru_68, a2);
  v8 = &IOUSBPipeV2::gMetaClass;
  IOUSBPipe::IOUSBPipe(v7);
  *(_QWORD *)v7 = off_474C0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBPipeV2::gMetaClass);
  if ( v7 )
  {
    if ( v5 )
    {
      v8 = (_QWORD *)"Out of spec MPS OK";
      LODWORD(v9) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v5 + 696LL))(v5, "Out of spec MPS OK");
      if ( v9 == **(_QWORD **)off_3B0F8[0] )
        *(_BYTE *)(v7 + 50) = -1;
    }
  }
  v10 = *(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v7 + 592LL);
  v11 = (*(int (__fastcall **)(__int64, _QWORD *))(*(_QWORD *)v6 + 2256LL))(v6, v8);
  v12 = (*(int (__fastcall **)(__int64))(*(_QWORD *)v6 + 2248LL))(v6);
  if ( (unsigned __int8)v10(v7, a1, v17, v11, v12, v18) )
  {
    if ( v7 )
    {
      v13 = *(_QWORD *)(v7 + 56);
      if ( v13 )
      {
        v14 = *(_QWORD *)(v13 + 24);
        if ( v14 )
        {
          LODWORD(v15) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v14 + 696LL))(
                           v14,
                           "IOUserClientCrossEndianCompatible");
          *(_BYTE *)(*(_QWORD *)(v7 + 56) + 32LL) = v15 == **(_QWORD **)off_3B0F8[0];
        }
      }
    }
  }
  else
  {
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v7 + 40LL))(v7);
    v7 = 0LL;
  }
  return v7;
}
// 68: using guessed type section_64 stru_68;
// 3B0F8: using guessed type __int64 off_3B0F8[3];
// 474C0: using guessed type __int64 (__fastcall *off_474C0[2])(IOUSBPipeV2 *__hidden this);
// 499C8: using guessed type _QWORD IOUSBPipeV2::gMetaClass;

//----- (000000000003358C) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::Abort(uintptr_t arg1, uintptr_t arg4)
{
  const OSMetaClass *v2; // rdx@1
  unsigned int v3; // er14@1
  unsigned int v4; // ebx@4
  __int64 v5; // rax@6
  signed int v6; // er15@7
  int v7; // eax@13

  v3 = (*(int (__cdecl **)(uintptr_t))(*(_QWORD *)arg1 + 616LL))(arg1);
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D2035u, arg1, *(_WORD *)(arg1 + 48), *(_BYTE *)(arg1 + 32), (unsigned int)arg4, 0LL);
  v4 = 2147483648;
  if ( (_DWORD)arg4 != -1 )
    v4 = arg4;
  **(_DWORD **)(arg1 + 56) = 0;
  v5 = OSMetaClassBase::safeMetaCast(
         *(OSMetaClassBase **)(arg1 + 40),
         (const OSMetaClassBase *)IOUSBControllerV3::metaClass,
         v2);
  if ( v5 || (v6 = -536870201, !(_WORD)v4) )
  {
    if ( (v4 & 0x80000000) != 0
      || (v6 = -536870206, (_WORD)v4) && *(_BYTE *)(arg1 + 34) == 2 && (unsigned __int16)v4 <= v3 )
    {
      if ( v5 )
        v7 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, uintptr_t))(*(_QWORD *)v5 + 3232LL))(
               v5,
               v4,
               *(_WORD *)(arg1 + 48),
               arg1 + 24);
      else
        v7 = (*(int (__fastcall **)(_QWORD, _QWORD, uintptr_t))(**(_QWORD **)(arg1 + 40) + 2368LL))(
               *(_QWORD *)(arg1 + 40),
               *(_WORD *)(arg1 + 48),
               arg1 + 24);
      v6 = v7;
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D2036u, arg1, *(_WORD *)(arg1 + 48), *(_BYTE *)(arg1 + 32), v7, 0LL);
    }
  }
  return (unsigned int)v6;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 44350: using guessed type _QWORD IOUSBControllerV3::metaClass;
// 49460: using guessed type int gUSBStackDebugFlags;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (00000000000336D8) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::Read(uintptr_t arg1, unsigned int a2, __int64 a3, unsigned int a4, int a5, uintptr_t a6, __int64 a7, __int64 a8)
{
  __int64 v8; // rbx@1
  int v9; // er13@1
  uintptr_t v10; // rsi@1
  const OSMetaClass *v11; // rdx@1
  __int64 v12; // r12@1
  signed int v13; // er15@2
  unsigned int v14; // er15@9
  uintptr_t v15; // rax@13
  unsigned int v16; // ecx@14
  uintptr_t v17; // r8@15
  int v18; // eax@18
  int v19; // eax@22
  __int64 v21; // [sp+20h] [bp-60h]@1
  unsigned int v22; // [sp+2Ch] [bp-54h]@1
  uintptr_t arg4; // [sp+30h] [bp-50h]@1
  int v24; // [sp+3Ch] [bp-44h]@1
  __int64 v25; // [sp+40h] [bp-40h]@21
  void (__usercall *v26)(void *@<rdi>, void *@<rsi>, char@<al>, unsigned int@<edx>, unsigned int@<ecx>, __int64@<r8>, __int64@<r9>); // [sp+48h] [bp-38h]@21
  __int64 v27; // [sp+50h] [bp-30h]@21

  arg4 = a6;
  v24 = a5;
  v22 = a4;
  v21 = a3;
  v8 = a2;
  v9 = (*(int (**)(void))(*(_QWORD *)arg1 + 616LL))();
  v10 = IOUSBControllerV3::metaClass;
  v12 = OSMetaClassBase::safeMetaCast(
          *(OSMetaClassBase **)(arg1 + 40),
          (const OSMetaClassBase *)IOUSBControllerV3::metaClass,
          v11);
  if ( v12 || (v13 = -536870201, !(_WORD)v8) )
  {
    if ( !(_WORD)v8
      || (v13 = -536870206, *(_BYTE *)(arg1 + 34) == 2) && (unsigned __int16)v8 <= (unsigned __int64)(unsigned int)v9 )
    {
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        v10 = *(_WORD *)(arg1 + 48);
        kernel_debug(0x52D2009u, v10, *(_BYTE *)(arg1 + 32), *(_BYTE *)(arg1 + 34), arg4, 0LL);
      }
      v14 = 0;
      if ( !*(_BYTE *)(*(_QWORD *)(arg1 + 56) + 43LL) )
        v14 = v22;
      if ( (v24 | v14) == 0 || *(_BYTE *)(arg1 + 34) == 2 )
      {
        if ( v21 )
        {
          LODWORD(v15) = (*(int (__fastcall **)(__int64, uintptr_t))(*(_QWORD *)v21 + 456LL))(v21, v10);
          if ( v15 >= arg4 )
          {
            v16 = v14;
            v13 = -536854449;
            if ( **(_DWORD **)(arg1 + 56) == -536854449 )
              return (unsigned int)v13;
            v17 = arg1 + 24;
            if ( !a7 )
            {
              if ( a8 )
                *(_QWORD *)a8 = arg4;
              v25 = 0LL;
              v26 = IOUSBSyncCompletion;
              v27 = a8;
              if ( v12 )
                v19 = (*(int (__fastcall **)(__int64, __int64, __int64, _QWORD, uintptr_t, __int64 *))(*(_QWORD *)v12 + 3216LL))(
                        v12,
                        v8,
                        v21,
                        *(_WORD *)(arg1 + 48),
                        v17,
                        &v25);
              else
                v19 = (*(int (__fastcall **)(_QWORD, __int64, _QWORD, uintptr_t, __int64 *, _QWORD))(**(_QWORD **)(arg1 + 40) + 2576LL))(
                        *(_QWORD *)(arg1 + 40),
                        v21,
                        *(_WORD *)(arg1 + 48),
                        arg1 + 24,
                        &v25,
                        v16);
              v13 = v19;
              if ( v19 == -536854447 || !v19 )
                goto LABEL_36;
              **(_DWORD **)(arg1 + 56) = -536854449;
LABEL_34:
              if ( v13 == -536854449 )
              {
                **(_DWORD **)(arg1 + 56) = -536854449;
                v13 = -536854449;
              }
LABEL_36:
              if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
                kernel_debug(0x52D200Au, arg1, *(_WORD *)(arg1 + 48), *(_BYTE *)(arg1 + 32), v13, 0LL);
              return (unsigned int)v13;
            }
            if ( *(_QWORD *)(a7 + 8) )
            {
              if ( v12 )
                v18 = (*(int (__fastcall **)(__int64, __int64, __int64, _QWORD, uintptr_t))(*(_QWORD *)v12 + 3216LL))(
                        v12,
                        v8,
                        v21,
                        *(_WORD *)(arg1 + 48),
                        v17);
              else
                v18 = (*(int (__fastcall **)(_QWORD, __int64, _QWORD, uintptr_t, __int64, _QWORD))(**(_QWORD **)(arg1 + 40)
                                                                                                 + 2576LL))(
                        *(_QWORD *)(arg1 + 40),
                        v21,
                        *(_WORD *)(arg1 + 48),
                        arg1 + 24,
                        a7,
                        v16);
              v13 = v18;
              goto LABEL_34;
            }
            if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
              kernel_debug(0x52D2008u, arg1, 0xFFFFFFFFE00002C2LL, 0LL, 1uLL, 0LL);
          }
        }
      }
      v13 = -536870206;
      return (unsigned int)v13;
    }
  }
  return (unsigned int)v13;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 44350: using guessed type _QWORD IOUSBControllerV3::metaClass;
// 49460: using guessed type int gUSBStackDebugFlags;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (00000000000339F2) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::Write(uintptr_t arg1, __int64 a2, __int64 a3, unsigned int a4, int a5, uintptr_t a6, __int64 a7)
{
  int v7; // er14@1
  const OSMetaClass *v8; // rdx@1
  __int64 v9; // r12@1
  signed int v10; // er15@2
  unsigned int v11; // ebx@9
  uintptr_t v12; // rax@13
  uintptr_t v13; // r8@15
  int v14; // eax@18
  int v15; // eax@20
  int *v17; // rcx@27
  __int64 v18; // [sp+18h] [bp-58h]@1
  uintptr_t arg4; // [sp+20h] [bp-50h]@1
  unsigned int v20; // [sp+28h] [bp-48h]@1
  int v21; // [sp+2Ch] [bp-44h]@1
  __int64 v22; // [sp+30h] [bp-40h]@19
  void (__usercall *v23)(void *@<rdi>, void *@<rsi>, char@<al>, unsigned int@<edx>, unsigned int@<ecx>, __int64@<r8>, __int64@<r9>); // [sp+38h] [bp-38h]@19
  __int64 v24; // [sp+40h] [bp-30h]@19

  arg4 = a6;
  v21 = a5;
  v20 = a4;
  v18 = a3;
  v7 = (*(int (**)(void))(*(_QWORD *)arg1 + 616LL))();
  a2 = (unsigned int)a2;
  v9 = OSMetaClassBase::safeMetaCast(
         *(OSMetaClassBase **)(arg1 + 40),
         (const OSMetaClassBase *)IOUSBControllerV3::metaClass,
         v8);
  if ( v9 || (v10 = -536870201, !(_WORD)a2) )
  {
    if ( !(_WORD)a2
      || (v10 = -536870206, *(_BYTE *)(arg1 + 34) == 2) && (unsigned __int16)a2 <= (unsigned __int64)(unsigned int)v7 )
    {
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        kernel_debug(0x52D200Du, *(_WORD *)(arg1 + 48), *(_BYTE *)(arg1 + 32), *(_BYTE *)(arg1 + 34), arg4, 0LL);
        a2 = (unsigned int)a2;
      }
      v11 = 0;
      if ( !*(_BYTE *)(*(_QWORD *)(arg1 + 56) + 43LL) )
        v11 = v20;
      if ( (v21 | v11) == 0 || *(_BYTE *)(arg1 + 34) == 2 )
      {
        if ( v18 )
        {
          LODWORD(v12) = (*(int (**)(void))(*(_QWORD *)v18 + 456LL))();
          if ( v12 >= arg4 )
          {
            v10 = -536854449;
            if ( **(_DWORD **)(arg1 + 56) == -536854449 )
              return (unsigned int)v10;
            v13 = arg1 + 24;
            if ( !a7 )
            {
              v22 = 0LL;
              v23 = IOUSBSyncCompletion;
              v24 = 0LL;
              if ( v9 )
                v15 = (*(int (__fastcall **)(__int64, __int64, __int64, _QWORD, uintptr_t, __int64 *))(*(_QWORD *)v9 + 3224LL))(
                        v9,
                        a2,
                        v18,
                        *(_WORD *)(arg1 + 48),
                        v13,
                        &v22);
              else
                v15 = (*(int (__fastcall **)(_QWORD, __int64, _QWORD, uintptr_t, __int64 *, _QWORD))(**(_QWORD **)(arg1 + 40) + 2584LL))(
                        *(_QWORD *)(arg1 + 40),
                        v18,
                        *(_WORD *)(arg1 + 48),
                        arg1 + 24,
                        &v22,
                        v11);
              v10 = v15;
              v17 = &gUSBStackDebugFlags;
              if ( v15 == -536854447 || !v15 )
              {
LABEL_34:
                if ( *(_BYTE *)v17 & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
                  kernel_debug(0x52D200Eu, arg1, *(_WORD *)(arg1 + 48), *(_BYTE *)(arg1 + 32), v10, 0LL);
                return (unsigned int)v10;
              }
              **(_DWORD **)(arg1 + 56) = -536854449;
LABEL_32:
              if ( v10 == -536854449 )
              {
                **(_DWORD **)(arg1 + 56) = -536854449;
                v10 = -536854449;
              }
              goto LABEL_34;
            }
            if ( *(_QWORD *)(a7 + 8) )
            {
              if ( v9 )
                v14 = (*(int (__fastcall **)(__int64, __int64, __int64, _QWORD, uintptr_t))(*(_QWORD *)v9 + 3224LL))(
                        v9,
                        a2,
                        v18,
                        *(_WORD *)(arg1 + 48),
                        v13);
              else
                v14 = (*(int (__fastcall **)(_QWORD, __int64, _QWORD, uintptr_t, __int64, _QWORD))(**(_QWORD **)(arg1 + 40)
                                                                                                 + 2584LL))(
                        *(_QWORD *)(arg1 + 40),
                        v18,
                        *(_WORD *)(arg1 + 48),
                        arg1 + 24,
                        a7,
                        v11);
              v10 = v14;
              v17 = &gUSBStackDebugFlags;
              goto LABEL_32;
            }
            if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
              kernel_debug(0x52D200Cu, arg1, 0xFFFFFFFFE00002C2LL, 0LL, 0LL, 0LL);
          }
        }
      }
      v10 = -536870206;
      return (unsigned int)v10;
    }
  }
  return (unsigned int)v10;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 44350: using guessed type _QWORD IOUSBControllerV3::metaClass;
// 49460: using guessed type int gUSBStackDebugFlags;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000033D00) ----------------------------------------------------
int __fastcall IOUSBPipeV2::CreateStreams(IOUSBPipeV2 *this, unsigned int a2, const OSMetaClass *a3)
{
  IOUSBPipeV2 *v3; // rbx@1
  __int64 v4; // rdi@1
  int result; // eax@1

  v3 = this;
  v4 = OSMetaClassBase::safeMetaCast(
         *((OSMetaClassBase **)this + 5),
         (const OSMetaClassBase *)IOUSBControllerV3::metaClass,
         a3);
  result = -536870201;
  if ( v4 )
  {
    result = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v4 + 3312LL))(
               v4,
               *((_BYTE *)v3 + 48),
               *((_BYTE *)v3 + 32),
               *((_BYTE *)v3 + 33),
               a2);
    if ( !result )
    {
      *((_DWORD *)v3 + 20) = a2;
      result = 0;
    }
  }
  return result;
}
// 44350: using guessed type _QWORD IOUSBControllerV3::metaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000033D54) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::SupportsStreams(IOUSBPipeV2 *this)
{
  return (unsigned int)((1 << *((_BYTE *)this + 72)) - 1);
}

//----- (0000000000033D66) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::GetConfiguredStreams(IOUSBPipeV2 *this)
{
  return *((_DWORD *)this + 20);
}

//----- (0000000000033D70) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::GetMaxBurst(IOUSBPipeV2 *this)
{
  return *((_BYTE *)this + 76);
}

//----- (0000000000033D7A) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::GetMult(IOUSBPipeV2 *this)
{
  return *((_BYTE *)this + 84);
}

//----- (0000000000033D84) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::GetBytesPerInterval(IOUSBPipeV2 *this)
{
  return *((_WORD *)this + 44);
}

//----- (0000000000033D8E) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::GetSuperSpeedEndpointCompanionDescriptor(IOUSBPipeV2 *this)
{
  return *((_QWORD *)this + 8);
}

//----- (0000000000033D98) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::SetPipePolicy(IOUSBPipeV2 *this, unsigned __int16 a2, const OSMetaClass *a3)
{
  IOUSBPipeV2 *v3; // rbx@1
  __int16 v4; // r13@1
  __int64 v5; // r14@1
  __int64 v6; // rax@1
  __int64 v7; // rdx@3
  __int64 v8; // rdi@4
  unsigned __int16 v9; // cx@5
  __int64 result; // rax@5
  unsigned int v11; // ecx@7
  signed __int64 v12; // rcx@8
  unsigned int v13; // eax@9
  int v14; // eax@10
  int v15; // ecx@13

  v3 = this;
  v4 = *((_WORD *)this + 18);
  v5 = OSMetaClassBase::safeMetaCast(
         *((OSMetaClassBase **)this + 5),
         (const OSMetaClassBase *)IOUSBControllerV3::metaClass,
         a3);
  v6 = *((_QWORD *)this + 7);
  if ( *(_BYTE *)(v6 + 16) != 3
    || !a2
    || (v7 = *((_QWORD *)this + 8)) == 0
    || (v8 = *(_QWORD *)(v6 + 24)) == 0
    || (v9 = IOUSBInterface::CalculateFullMaxPacketSize(v8, *((_QWORD *)v3 + 2), v7), result = 3758097090LL, v9 == a2) )
  {
    if ( *((_BYTE *)v3 + 34) != 1 )
      JUMPOUT(__CS__, `vtable for'IOUSBPipe[64]);
    v11 = (unsigned __int16)IOUSBInterface::CalculateFullMaxPacketSize(
                              *(_QWORD *)(*((_QWORD *)v3 + 7) + 24LL),
                              *((_QWORD *)v3 + 2),
                              *((_QWORD *)v3 + 8));
    result = 3758097090LL;
    if ( v11 >= a2 )
    {
      v12 = (signed __int64)((char *)v3 + 24);
      *((_WORD *)v3 + 18) = a2;
      if ( v5 && (v13 = *((_DWORD *)v3 + 19)) != 0 )
        v14 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, signed __int64, _QWORD, _QWORD))(*(_QWORD *)v5 + 3248LL))(
                v5,
                *((_WORD *)v3 + 24),
                *(_BYTE *)(*((_QWORD *)v3 + 7) + 16LL),
                v12,
                0LL,
                v13 | (*((_DWORD *)v3 + 21) << 8));
      else
        v14 = (*(int (__fastcall **)(_QWORD, _QWORD, _QWORD, signed __int64))(**((_QWORD **)v3 + 5) + 2352LL))(
                *((_QWORD *)v3 + 5),
                *((_WORD *)v3 + 24),
                *(_BYTE *)(*((_QWORD *)v3 + 7) + 16LL),
                v12);
      v15 = v14;
      result = 0LL;
      if ( v15 )
      {
        *((_WORD *)v3 + 18) = v4;
        result = (unsigned int)v15;
      }
    }
  }
  return result;
}
// 3DBD0: using guessed type __int64 `vtable for'IOUSBPipe[2];
// 44350: using guessed type _QWORD IOUSBControllerV3::metaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000033EDE) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV20(IOUSBPipeV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBPipeV2::gMetaClass, 0);
}
// 499C8: using guessed type _QWORD IOUSBPipeV2::gMetaClass;

//----- (0000000000033EF2) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV21(IOUSBPipeV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBPipeV2::gMetaClass, 1);
}
// 499C8: using guessed type _QWORD IOUSBPipeV2::gMetaClass;

//----- (0000000000033F08) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV22(IOUSBPipeV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBPipeV2::gMetaClass, 2);
}
// 499C8: using guessed type _QWORD IOUSBPipeV2::gMetaClass;

//----- (0000000000033F1E) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV23(IOUSBPipeV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBPipeV2::gMetaClass, 3);
}
// 499C8: using guessed type _QWORD IOUSBPipeV2::gMetaClass;

//----- (0000000000033F34) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV24(IOUSBPipeV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBPipeV2::gMetaClass, 4);
}
// 499C8: using guessed type _QWORD IOUSBPipeV2::gMetaClass;

//----- (0000000000033F4A) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV25(IOUSBPipeV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBPipeV2::gMetaClass, 5);
}
// 499C8: using guessed type _QWORD IOUSBPipeV2::gMetaClass;

//----- (0000000000033F60) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV26(IOUSBPipeV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBPipeV2::gMetaClass, 6);
}
// 499C8: using guessed type _QWORD IOUSBPipeV2::gMetaClass;

//----- (0000000000033F76) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV27(IOUSBPipeV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBPipeV2::gMetaClass, 7);
}
// 499C8: using guessed type _QWORD IOUSBPipeV2::gMetaClass;

//----- (0000000000033F8C) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV28(IOUSBPipeV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBPipeV2::gMetaClass, 8);
}
// 499C8: using guessed type _QWORD IOUSBPipeV2::gMetaClass;

//----- (0000000000033FA2) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV29(IOUSBPipeV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBPipeV2::gMetaClass, 9);
}
// 499C8: using guessed type _QWORD IOUSBPipeV2::gMetaClass;

//----- (0000000000033FB8) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV210(IOUSBPipeV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBPipeV2::gMetaClass, 10);
}
// 499C8: using guessed type _QWORD IOUSBPipeV2::gMetaClass;

//----- (0000000000033FCE) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV211(IOUSBPipeV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBPipeV2::gMetaClass, 11);
}
// 499C8: using guessed type _QWORD IOUSBPipeV2::gMetaClass;

//----- (0000000000033FE4) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV212(IOUSBPipeV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBPipeV2::gMetaClass, 12);
}
// 499C8: using guessed type _QWORD IOUSBPipeV2::gMetaClass;

//----- (0000000000033FFA) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV213(IOUSBPipeV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBPipeV2::gMetaClass, 13);
}
// 499C8: using guessed type _QWORD IOUSBPipeV2::gMetaClass;

//----- (0000000000034010) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV214(IOUSBPipeV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBPipeV2::gMetaClass, 14);
}
// 499C8: using guessed type _QWORD IOUSBPipeV2::gMetaClass;

//----- (0000000000034026) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV215(IOUSBPipeV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBPipeV2::gMetaClass, 15);
}
// 499C8: using guessed type _QWORD IOUSBPipeV2::gMetaClass;

//----- (000000000003403C) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV216(IOUSBPipeV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBPipeV2::gMetaClass, 16);
}
// 499C8: using guessed type _QWORD IOUSBPipeV2::gMetaClass;

//----- (0000000000034052) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV217(IOUSBPipeV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBPipeV2::gMetaClass, 17);
}
// 499C8: using guessed type _QWORD IOUSBPipeV2::gMetaClass;

//----- (0000000000034068) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV218(IOUSBPipeV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBPipeV2::gMetaClass, 18);
}
// 499C8: using guessed type _QWORD IOUSBPipeV2::gMetaClass;

//----- (000000000003407E) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV219(IOUSBPipeV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBPipeV2::gMetaClass, 19);
}
// 499C8: using guessed type _QWORD IOUSBPipeV2::gMetaClass;

//----- (0000000000034094) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV220(IOUSBPipeV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBPipeV2::gMetaClass, 20);
}
// 499C8: using guessed type _QWORD IOUSBPipeV2::gMetaClass;

//----- (00000000000340AA) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV221(IOUSBPipeV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBPipeV2::gMetaClass, 21);
}
// 499C8: using guessed type _QWORD IOUSBPipeV2::gMetaClass;

//----- (00000000000340C0) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV222(IOUSBPipeV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBPipeV2::gMetaClass, 22);
}
// 499C8: using guessed type _QWORD IOUSBPipeV2::gMetaClass;

//----- (00000000000340D6) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV223(IOUSBPipeV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBPipeV2::gMetaClass, 23);
}
// 499C8: using guessed type _QWORD IOUSBPipeV2::gMetaClass;

//----- (00000000000340EC) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV224(IOUSBPipeV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBPipeV2::gMetaClass, 24);
}
// 499C8: using guessed type _QWORD IOUSBPipeV2::gMetaClass;

//----- (0000000000034102) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV225(IOUSBPipeV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBPipeV2::gMetaClass, 25);
}
// 499C8: using guessed type _QWORD IOUSBPipeV2::gMetaClass;

//----- (0000000000034118) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV226(IOUSBPipeV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBPipeV2::gMetaClass, 26);
}
// 499C8: using guessed type _QWORD IOUSBPipeV2::gMetaClass;

//----- (000000000003412E) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV227(IOUSBPipeV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBPipeV2::gMetaClass, 27);
}
// 499C8: using guessed type _QWORD IOUSBPipeV2::gMetaClass;

//----- (0000000000034144) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV228(IOUSBPipeV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBPipeV2::gMetaClass, 28);
}
// 499C8: using guessed type _QWORD IOUSBPipeV2::gMetaClass;

//----- (000000000003415A) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::_RESERVEDIOUSBPipeV229(IOUSBPipeV2 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBPipeV2::gMetaClass, 29);
}
// 499C8: using guessed type _QWORD IOUSBPipeV2::gMetaClass;

//----- (0000000000034170) ----------------------------------------------------
__int64 __fastcall IOUSBPipeV2::MetaClass::~MetaClass(IOUSBPipeV2::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000034180) ----------------------------------------------------
__int64 `global constructor keyed to'_a_17()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(&IOUSBPipeV2::gMetaClass, "IOUSBPipeV2", &IOUSBPipe::gMetaClass, 104LL);
  result = (__int64)off_47870;
  IOUSBPipeV2::gMetaClass = off_47870;
  return result;
}
// 47870: using guessed type __int64 (__fastcall *off_47870[2])(IOUSBPipeV2::MetaClass *__hidden this);
// 49660: using guessed type _QWORD IOUSBPipe::gMetaClass;
// 499C8: using guessed type _QWORD IOUSBPipeV2::gMetaClass;
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000341C0) ----------------------------------------------------
__int64 `global destructor keyed to'_a_17()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&IOUSBPipeV2::gMetaClass);
}
// 499C8: using guessed type _QWORD IOUSBPipeV2::gMetaClass;

//----- (00000000000341E0) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::MetaClass::MetaClass(IOUSBInterfaceUserClientV3::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBInterfaceUserClientV3", &IOUSBInterfaceUserClientV2::gMetaClass, 304LL);
  result = (__int64)off_48600;
  *(_QWORD *)this = off_48600;
  return result;
}
// 48600: using guessed type __int64 (__fastcall *off_48600[2])(IOUSBInterfaceUserClientV3::MetaClass *__hidden this);
// 49928: using guessed type _QWORD IOUSBInterfaceUserClientV2::gMetaClass;
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000034212) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::MetaClass::~MetaClass(IOUSBInterfaceUserClientV3::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000003421C) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::IOUSBInterfaceUserClientV3(__int64 a1)
{
  __int64 result; // rax@1

  IOUSBInterfaceUserClientV2::IOUSBInterfaceUserClientV2(a1);
  result = (__int64)off_47970;
  *(_QWORD *)a1 = off_47970;
  return result;
}
// 47970: using guessed type __int64 (__fastcall *off_47970[2])(IOUSBInterfaceUserClientV3 *__hidden this);

//----- (000000000003423C) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::IOUSBInterfaceUserClientV3(__int64 a1)
{
  __int64 result; // rax@1

  IOUSBInterfaceUserClientV2::IOUSBInterfaceUserClientV2(a1);
  result = (__int64)off_47970;
  *(_QWORD *)a1 = off_47970;
  return result;
}
// 47970: using guessed type __int64 (__fastcall *off_47970[2])(IOUSBInterfaceUserClientV3 *__hidden this);

//----- (000000000003425C) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::~IOUSBInterfaceUserClientV3(IOUSBInterfaceUserClientV3 *this)
{
  return IOUSBInterfaceUserClientV2::~IOUSBInterfaceUserClientV2(this);
}

//----- (0000000000034266) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::~IOUSBInterfaceUserClientV3(IOUSBInterfaceUserClientV3 *this)
{
  return IOUSBInterfaceUserClientV2::~IOUSBInterfaceUserClientV2(this);
}

//----- (0000000000034270) ----------------------------------------------------
void __fastcall IOUSBInterfaceUserClientV3::~IOUSBInterfaceUserClientV3(IOUSBInterfaceUserClientV3 *this)
{
  IOUSBInterfaceUserClientV2::~IOUSBInterfaceUserClientV2(this);
  OSObject::operator delete((void *)this);
}

//----- (0000000000034292) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::getMetaClass(IOUSBInterfaceUserClientV3 *this)
{
  return (__int64)&IOUSBInterfaceUserClientV3::gMetaClass;
}
// 499F0: using guessed type _QWORD IOUSBInterfaceUserClientV3::gMetaClass;

//----- (00000000000342A0) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::MetaClass::MetaClass(IOUSBInterfaceUserClientV3::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBInterfaceUserClientV3", &IOUSBInterfaceUserClientV2::gMetaClass, 304LL);
  result = (__int64)off_48600;
  *(_QWORD *)this = off_48600;
  return result;
}
// 48600: using guessed type __int64 (__fastcall *off_48600[2])(IOUSBInterfaceUserClientV3::MetaClass *__hidden this);
// 49928: using guessed type _QWORD IOUSBInterfaceUserClientV2::gMetaClass;
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000342D2) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::MetaClass::alloc(IOUSBInterfaceUserClientV3::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)&stru_108.size, a2);
  IOUSBInterfaceUserClientV2::IOUSBInterfaceUserClientV2(v2);
  *(_QWORD *)v2 = off_47970;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBInterfaceUserClientV3::gMetaClass);
  return v2;
}
// 108: using guessed type section_64 stru_108;
// 47970: using guessed type __int64 (__fastcall *off_47970[2])(IOUSBInterfaceUserClientV3 *__hidden this);
// 499F0: using guessed type _QWORD IOUSBInterfaceUserClientV3::gMetaClass;

//----- (0000000000034312) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::IOUSBInterfaceUserClientV3(__int64 a1)
{
  IOUSBInterfaceUserClientV2::IOUSBInterfaceUserClientV2(a1);
  *(_QWORD *)a1 = off_47970;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBInterfaceUserClientV3::gMetaClass);
}
// 47970: using guessed type __int64 (__fastcall *off_47970[2])(IOUSBInterfaceUserClientV3 *__hidden this);
// 499F0: using guessed type _QWORD IOUSBInterfaceUserClientV3::gMetaClass;

//----- (0000000000034342) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::IOUSBInterfaceUserClientV3(__int64 a1)
{
  IOUSBInterfaceUserClientV2::IOUSBInterfaceUserClientV2(a1);
  *(_QWORD *)a1 = off_47970;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBInterfaceUserClientV3::gMetaClass);
}
// 47970: using guessed type __int64 (__fastcall *off_47970[2])(IOUSBInterfaceUserClientV3 *__hidden this);
// 499F0: using guessed type _QWORD IOUSBInterfaceUserClientV3::gMetaClass;

//----- (0000000000034372) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::_supportsStreams(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1

  v3 = a3;
  (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
  LODWORD(v3) = (*(int (__fastcall **)(__int64, _QWORD, _QWORD))(*(_QWORD *)a1 + 2912LL))(
                  a1,
                  **(_BYTE **)(v3 + 32),
                  *(_QWORD *)(v3 + 72));
  (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
  return (unsigned int)v3;
}

//----- (00000000000343B0) ----------------------------------------------------
signed __int64 __fastcall IOUSBInterfaceUserClientV3::_createStreams(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rax@1
  int v5; // er14@4
  signed __int64 result; // rax@4

  v3 = a3;
  v4 = *(_QWORD *)(a1 + 288);
  if ( v4 && *(_BYTE *)(v4 + 183) && !*(_BYTE *)(v4 + 182) )
  {
    result = 3758097122LL;
  }
  else
  {
    (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
    v5 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD))(*(_QWORD *)a1 + 2920LL))(
           a1,
           **(_BYTE **)(v3 + 32),
           *(_DWORD *)(*(_QWORD *)(v3 + 32) + 8LL));
    (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
    result = (unsigned int)v5;
  }
  return result;
}

//----- (0000000000034416) ----------------------------------------------------
signed __int64 __fastcall IOUSBInterfaceUserClientV3::_getConfiguredStreams(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rax@1
  int v5; // er14@4
  signed __int64 result; // rax@4

  v3 = a3;
  v4 = *(_QWORD *)(a1 + 288);
  if ( v4 && *(_BYTE *)(v4 + 183) && !*(_BYTE *)(v4 + 182) )
  {
    result = 3758097122LL;
  }
  else
  {
    (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
    v5 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD))(*(_QWORD *)a1 + 2928LL))(
           a1,
           **(_BYTE **)(v3 + 32),
           *(_QWORD *)(v3 + 72));
    (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
    result = (unsigned int)v5;
  }
  return result;
}

//----- (000000000003447C) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::_ReadStreamsPipe(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r12@1
  __int64 v4; // rax@1
  signed int v5; // ebx@3
  __int64 v6; // rax@5
  __int64 v7; // r15@5
  __int64 v8; // rsi@6
  __int64 v9; // ST00_8@6
  int v10; // er12@6
  int v11; // eax@9
  __int64 v13; // [sp+18h] [bp-38h]@6
  __int64 (__fastcall *v14)(IOUSBInterfaceUserClientV2 *, void *, void *, unsigned int); // [sp+20h] [bp-30h]@6
  __int64 v15; // [sp+28h] [bp-28h]@6

  v3 = a3;
  v4 = *(_QWORD *)(a1 + 288);
  if ( !v4 || !*(_BYTE *)(v4 + 183) || (v5 = -536870174, *(_BYTE *)(v4 + 182)) )
  {
    if ( *(_QWORD *)(a3 + 8) )
    {
      LODWORD(v6) = IOMalloc(104LL);
      v7 = v6;
      v5 = -536870211;
      if ( v6 )
      {
        (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 32LL))(a1);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 2728LL))(a1);
        bcopy(*(const void **)(v3 + 16), (void *)v7, 0x40uLL);
        *(_DWORD *)(v7 + 64) = *(_DWORD *)(v3 + 24);
        v13 = a1;
        v14 = IOUSBInterfaceUserClientV2::ReqComplete;
        v15 = v7;
        v8 = *(_QWORD *)(v3 + 32);
        v9 = *(_QWORD *)(v8 + 40);
        v10 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 2936LL))(
                a1,
                *(_BYTE *)v8,
                *(_DWORD *)(v8 + 8),
                *(_DWORD *)(v8 + 16),
                *(_DWORD *)(v8 + 24),
                *(_QWORD *)(v8 + 32));
        v5 = 0;
        if ( v10 )
        {
          IOFree(v7, 104LL);
          (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)a1 + 2720LL))(a1, 104LL);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
          v5 = v10;
        }
      }
    }
    else
    {
      (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
      if ( *(_QWORD *)(v3 + 104) )
        v11 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 2952LL))(
                a1,
                **(_BYTE **)(v3 + 32),
                *(_DWORD *)(*(_QWORD *)(v3 + 32) + 8LL),
                *(_DWORD *)(*(_QWORD *)(v3 + 32) + 16LL),
                *(_DWORD *)(*(_QWORD *)(v3 + 32) + 24LL));
      else
        v11 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 2944LL))(
                a1,
                **(_BYTE **)(v3 + 32),
                *(_DWORD *)(*(_QWORD *)(v3 + 32) + 8LL),
                *(_DWORD *)(*(_QWORD *)(v3 + 32) + 16LL),
                *(_DWORD *)(*(_QWORD *)(v3 + 32) + 24LL),
                *(_QWORD *)(v3 + 88));
      v5 = v11;
      (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
    }
  }
  return (unsigned int)v5;
}
// 7D218: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// 7D250: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (000000000003460A) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::_WriteStreamsPipe(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rax@1
  signed int v5; // ebx@3
  __int64 v6; // rax@5
  __int64 v7; // r15@5
  __int64 v8; // rsi@6
  __int64 v9; // ST00_8@6
  int v10; // er14@6
  int v11; // eax@9
  int v12; // ST00_4@10
  __int64 v14; // [sp+18h] [bp-38h]@6
  __int64 (__fastcall *v15)(IOUSBInterfaceUserClientV2 *, void *, void *, unsigned int); // [sp+20h] [bp-30h]@6
  __int64 v16; // [sp+28h] [bp-28h]@6

  v3 = a3;
  v4 = *(_QWORD *)(a1 + 288);
  if ( !v4 || !*(_BYTE *)(v4 + 183) || (v5 = -536870174, *(_BYTE *)(v4 + 182)) )
  {
    if ( *(_QWORD *)(a3 + 8) )
    {
      LODWORD(v6) = IOMalloc(104LL);
      v7 = v6;
      v5 = -536870211;
      if ( v6 )
      {
        (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 32LL))(a1);
        (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 2728LL))(a1);
        bcopy(*(const void **)(v3 + 16), (void *)v7, 0x40uLL);
        *(_DWORD *)(v7 + 64) = *(_DWORD *)(v3 + 24);
        v14 = a1;
        v15 = IOUSBInterfaceUserClientV2::ReqComplete;
        v16 = v7;
        v8 = *(_QWORD *)(v3 + 32);
        v9 = *(_QWORD *)(v8 + 40);
        v10 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 2960LL))(
                a1,
                *(_BYTE *)v8,
                *(_DWORD *)(v8 + 8),
                *(_DWORD *)(v8 + 16),
                *(_DWORD *)(v8 + 24),
                *(_QWORD *)(v8 + 32));
        v5 = 0;
        if ( v10 )
        {
          IOFree(v7, 104LL);
          (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)a1 + 2720LL))(a1, 104LL);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
          v5 = v10;
        }
      }
    }
    else
    {
      (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
      if ( *(_QWORD *)(v3 + 64) )
      {
        v11 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 2976LL))(
                a1,
                **(_BYTE **)(v3 + 32),
                *(_DWORD *)(*(_QWORD *)(v3 + 32) + 8LL),
                *(_DWORD *)(*(_QWORD *)(v3 + 32) + 16LL),
                *(_DWORD *)(*(_QWORD *)(v3 + 32) + 24LL));
      }
      else
      {
        v12 = *(_DWORD *)(v3 + 56);
        v11 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 2968LL))(
                a1,
                **(_BYTE **)(v3 + 32),
                *(_DWORD *)(*(_QWORD *)(v3 + 32) + 8LL),
                *(_DWORD *)(*(_QWORD *)(v3 + 32) + 16LL),
                *(_DWORD *)(*(_QWORD *)(v3 + 32) + 24LL),
                *(_QWORD *)(v3 + 48));
      }
      v5 = v11;
      (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
    }
  }
  return (unsigned int)v5;
}
// 7D218: using guessed type int __fastcall IOFree(_QWORD, _QWORD);
// 7D250: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (0000000000034792) ----------------------------------------------------
signed __int64 __fastcall IOUSBInterfaceUserClientV3::_AbortStreamsPipe(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rax@1
  int v5; // er14@4
  signed __int64 result; // rax@4

  v3 = a3;
  v4 = *(_QWORD *)(a1 + 288);
  if ( v4 && *(_BYTE *)(v4 + 183) && !*(_BYTE *)(v4 + 182) )
  {
    result = 3758097122LL;
  }
  else
  {
    (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
    v5 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD))(*(_QWORD *)a1 + 2984LL))(
           a1,
           **(_BYTE **)(v3 + 32),
           *(_DWORD *)(*(_QWORD *)(v3 + 32) + 8LL));
    (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
    result = (unsigned int)v5;
  }
  return result;
}

//----- (00000000000347F8) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::_RegisterForNotification(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rbx@1
  __int64 v5; // rax@1
  int v6; // er15@3
  __int64 v7; // rdi@5

  v3 = a3;
  v4 = a1;
  v5 = *(_QWORD *)(a1 + 288);
  if ( !v5 || (!*(_BYTE *)(v5 + 183) || (v6 = -536870174, *(_BYTE *)(v5 + 182))) && (v6 = -536870206, a1) )
  {
    (*(void (__cdecl **)(__int64))(*(_QWORD *)a1 + 32LL))(a1);
    v7 = *(_QWORD *)(a1 + 240);
    v6 = -536870206;
    if ( v7 )
      v6 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v7 + 456LL))(
             v7,
             *(_QWORD *)(*(_QWORD *)v4 + 2992LL),
             **(_QWORD **)(v3 + 32),
             *(_QWORD *)(v3 + 16),
             *(_QWORD *)(v3 + 72),
             0LL);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v4 + 40LL))(v4);
  }
  return (unsigned int)v6;
}

//----- (0000000000034892) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::_UnregisterNotification(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rbx@1
  __int64 v5; // rax@1
  int v6; // er15@3
  __int64 v7; // rdi@5

  v3 = a3;
  v4 = a1;
  v5 = *(_QWORD *)(a1 + 288);
  if ( !v5 || (!*(_BYTE *)(v5 + 183) || (v6 = -536870174, *(_BYTE *)(v5 + 182))) && (v6 = -536870206, a1) )
  {
    (*(void (__cdecl **)(__int64))(*(_QWORD *)a1 + 32LL))(a1);
    v7 = *(_QWORD *)(a1 + 240);
    v6 = -536870206;
    if ( v7 )
      v6 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v7 + 456LL))(
             v7,
             *(_QWORD *)(*(_QWORD *)v4 + 3000LL),
             **(_QWORD **)(v3 + 32),
             0LL,
             0LL,
             0LL);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v4 + 40LL))(v4);
  }
  return (unsigned int)v6;
}

//----- (0000000000034928) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::_AcknowledgeNotification(__int64 a1, __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rbx@1
  __int64 v5; // rax@1
  int v6; // er15@3
  __int64 v7; // rdi@5

  v3 = a3;
  v4 = a1;
  v5 = *(_QWORD *)(a1 + 288);
  if ( !v5 || (!*(_BYTE *)(v5 + 183) || (v6 = -536870174, *(_BYTE *)(v5 + 182))) && (v6 = 0, a1) )
  {
    (*(void (__cdecl **)(__int64))(*(_QWORD *)a1 + 32LL))(a1);
    v7 = *(_QWORD *)(a1 + 240);
    v6 = 0;
    if ( v7 )
      v6 = (*(int (__fastcall **)(__int64, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v7 + 456LL))(
             v7,
             *(_QWORD *)(*(_QWORD *)v4 + 3008LL),
             **(_QWORD **)(v3 + 32),
             0LL,
             0LL,
             0LL);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v4 + 40LL))(v4);
  }
  return (unsigned int)v6;
}

//----- (00000000000349B8) ----------------------------------------------------
signed __int64 __fastcall IOUSBInterfaceUserClientV3::_RegisterDriver(__int64 a1)
{
  __int64 v1; // rcx@1
  signed __int64 result; // rax@3
  int v3; // er14@5

  v1 = *(_QWORD *)(a1 + 288);
  if ( !v1 || (!*(_BYTE *)(v1 + 183) || (result = 3758097122LL, *(_BYTE *)(v1 + 182))) && (result = 0LL, a1) )
  {
    (*(void (**)(void))(*(_QWORD *)a1 + 32LL))();
    v3 = (*(int (__fastcall **)(__int64))(*(_QWORD *)a1 + 3016LL))(a1);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)a1 + 40LL))(a1);
    result = (unsigned int)v3;
  }
  return result;
}

//----- (0000000000034A16) ----------------------------------------------------
void __fastcall IOUSBInterfaceUserClientV3::free(IOUSBInterfaceUserClientV3 *this)
{
  IOUSBInterfaceUserClientV3 *v1; // rbx@1
  __int64 v2; // rdi@1

  v1 = this;
  v2 = *((_QWORD *)this + 37);
  if ( v2 )
  {
    if ( *(_QWORD *)v2 )
    {
      if ( (*(int (__fastcall **)(_QWORD))(**(_QWORD **)v2 + 304LL))(*(_QWORD *)v2) )
        (*(void (__cdecl **)(_QWORD))(***((_QWORD ***)v1 + 37) + 344LL))(**((_QWORD **)v1 + 37));
      (*(void (__cdecl **)(_QWORD))(***((_QWORD ***)v1 + 37) + 40LL))(**((_QWORD **)v1 + 37));
      v2 = *((_QWORD *)v1 + 37);
    }
    IOFree(v2, 16LL);
    *((_QWORD *)v1 + 37) = 0LL;
  }
  JUMPOUT(__CS__, `vtable for'IOUSBInterfaceUserClientV2[20]);
}
// 451D0: using guessed type __int64 `vtable for'IOUSBInterfaceUserClientV2[2];
// 7D218: using guessed type int __fastcall IOFree(_QWORD, _QWORD);

//----- (0000000000034A98) ----------------------------------------------------
char __fastcall IOUSBInterfaceUserClientV3::initWithTask(IOUSBInterfaceUserClientV3 *this, task *a2, void *a3, __int64 a4, OSDictionary *a5)
{
  char v5; // r14@2
  void *v6; // rax@3

  if ( !(unsigned __int8)((int (__fastcall *)(IOUSBInterfaceUserClientV3 *, task *, void *, __int64, OSDictionary *))`vtable for'IOUSBInterfaceUserClientV2[286])(
                           this,
                           a2,
                           a3,
                           a4,
                           a5) )
    goto LABEL_5;
  v5 = 1;
  if ( !*((_QWORD *)this + 37) )
  {
    LODWORD(v6) = IOMalloc(16LL);
    *((_QWORD *)this + 37) = v6;
    if ( v6 )
    {
      bzero(v6, 0x10uLL);
      return v5;
    }
LABEL_5:
    v5 = 0;
  }
  return v5;
}
// 451D0: using guessed type __int64 `vtable for'IOUSBInterfaceUserClientV2[2];
// 7D250: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (0000000000034AF0) ----------------------------------------------------
int IOUSBInterfaceUserClientV3::externalMethod()
{
  return (*(int (**)(void))(off_3B0B8[0] + 2144))();
}
// 3B0B8: using guessed type __int64 off_3B0B8[11];

//----- (0000000000034B20) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::SupportsStreams(IOUSBInterfaceUserClientV3 *this, unsigned __int8 a2, unsigned __int64 *a3)
{
  unsigned __int64 *v3; // r14@1
  signed int v4; // er15@1
  OSMetaClassBase *v5; // rax@3
  const OSMetaClass *v6; // rdx@3
  OSMetaClassBase *v7; // r12@3

  v3 = a3;
  (*(void (**)(void))(*(_QWORD *)this + 2728LL))();
  v4 = -536870183;
  if ( *((_QWORD *)this + 27) )
  {
    if ( !(unsigned __int8)IOService::isInactive(this) )
    {
      LODWORD(v5) = (*(int (__fastcall **)(IOUSBInterfaceUserClientV3 *, _QWORD))(*(_QWORD *)this + 2680LL))(this, a2);
      v7 = v5;
      v4 = -536854431;
      if ( v5 )
      {
        if ( OSMetaClassBase::safeMetaCast(v5, (const OSMetaClassBase *)IOUSBPipeV2::metaClass, v6) )
        {
          *v3 = (unsigned int)(*(int (__fastcall **)(OSMetaClassBase *, _QWORD))(*(_QWORD *)v7 + 616LL))(
                                v7,
                                IOUSBPipeV2::metaClass);
          (*(void (__fastcall **)(OSMetaClassBase *))(*(_QWORD *)v7 + 40LL))(v7);
          v4 = 0;
        }
      }
    }
  }
  (*(void (__fastcall **)(IOUSBInterfaceUserClientV3 *))(*(_QWORD *)this + 2720LL))(this);
  return (unsigned int)v4;
}
// 474A0: using guessed type _QWORD IOUSBPipeV2::metaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000034BC6) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::CreateStreams(IOUSBInterfaceUserClientV3 *this, unsigned __int8 a2, unsigned int a3)
{
  unsigned int v3; // er14@1
  int v4; // er15@1
  OSMetaClassBase *v5; // rax@3
  const OSMetaClass *v6; // rdx@3
  OSMetaClassBase *v7; // r12@3

  v3 = a3;
  (*(void (**)(void))(*(_QWORD *)this + 2728LL))();
  v4 = -536870183;
  if ( *((_QWORD *)this + 27) )
  {
    if ( !(unsigned __int8)IOService::isInactive(this) )
    {
      LODWORD(v5) = (*(int (__fastcall **)(IOUSBInterfaceUserClientV3 *, _QWORD))(*(_QWORD *)this + 2680LL))(this, a2);
      v7 = v5;
      v4 = -536854431;
      if ( v5 )
      {
        if ( OSMetaClassBase::safeMetaCast(v5, (const OSMetaClassBase *)IOUSBPipeV2::metaClass, v6) )
        {
          v4 = (*(int (__fastcall **)(OSMetaClassBase *, _QWORD))(*(_QWORD *)v7 + 624LL))(v7, v3);
          (*(void (__fastcall **)(OSMetaClassBase *))(*(_QWORD *)v7 + 40LL))(v7);
        }
      }
    }
  }
  (*(void (__fastcall **)(IOUSBInterfaceUserClientV3 *))(*(_QWORD *)this + 2720LL))(this);
  return (unsigned int)v4;
}
// 474A0: using guessed type _QWORD IOUSBPipeV2::metaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000034C6A) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::GetConfiguredStreams(IOUSBInterfaceUserClientV3 *this, unsigned __int8 a2, unsigned __int64 *a3)
{
  unsigned __int64 *v3; // r14@1
  signed int v4; // er15@1
  OSMetaClassBase *v5; // rax@3
  const OSMetaClass *v6; // rdx@3
  OSMetaClassBase *v7; // r12@3

  v3 = a3;
  (*(void (**)(void))(*(_QWORD *)this + 2728LL))();
  v4 = -536870183;
  if ( *((_QWORD *)this + 27) )
  {
    if ( !(unsigned __int8)IOService::isInactive(this) )
    {
      LODWORD(v5) = (*(int (__fastcall **)(IOUSBInterfaceUserClientV3 *, _QWORD))(*(_QWORD *)this + 2680LL))(this, a2);
      v7 = v5;
      v4 = -536854431;
      if ( v5 )
      {
        if ( OSMetaClassBase::safeMetaCast(v5, (const OSMetaClassBase *)IOUSBPipeV2::metaClass, v6) )
        {
          *v3 = (unsigned int)(*(int (__fastcall **)(OSMetaClassBase *, _QWORD))(*(_QWORD *)v7 + 616LL))(
                                v7,
                                IOUSBPipeV2::metaClass);
          (*(void (__fastcall **)(OSMetaClassBase *))(*(_QWORD *)v7 + 40LL))(v7);
          v4 = 0;
        }
      }
    }
  }
  (*(void (__fastcall **)(IOUSBInterfaceUserClientV3 *))(*(_QWORD *)this + 2720LL))(this);
  return (unsigned int)v4;
}
// 474A0: using guessed type _QWORD IOUSBPipeV2::metaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000034D10) ----------------------------------------------------
int __fastcall IOUSBInterfaceUserClientV3::ReadPipe(__int64 a1, __int64 a2, unsigned int a3, unsigned int a4, __int64 a5)
{
  return (*(int (__fastcall **)(__int64, __int64, _QWORD, _QWORD, _QWORD, __int64))(*(_QWORD *)a1 + 2936LL))(
           a1,
           a2,
           0LL,
           a3,
           a4,
           a5);
}

//----- (0000000000034D42) ----------------------------------------------------
int __fastcall IOUSBInterfaceUserClientV3::ReadPipe(IOUSBInterfaceUserClientV3 *this, __int64 a2, unsigned int a3, unsigned int a4, void *a5, unsigned int *a6)
{
  return (*(int (__fastcall **)(IOUSBInterfaceUserClientV3 *, __int64, _QWORD, _QWORD, _QWORD, void *))(*(_QWORD *)this + 2944LL))(
           this,
           a2,
           0LL,
           a3,
           a4,
           a5);
}

//----- (0000000000034D6A) ----------------------------------------------------
int __fastcall IOUSBInterfaceUserClientV3::ReadPipe(IOUSBInterfaceUserClientV3 *this, __int64 a2, unsigned int a3, unsigned int a4, IOMemoryDescriptor *a5, unsigned __int64 *a6)
{
  return (*(int (__fastcall **)(IOUSBInterfaceUserClientV3 *, __int64, _QWORD, _QWORD, _QWORD, IOMemoryDescriptor *))(*(_QWORD *)this + 2952LL))(
           this,
           a2,
           0LL,
           a3,
           a4,
           a5);
}

//----- (0000000000034D92) ----------------------------------------------------
int __fastcall IOUSBInterfaceUserClientV3::WritePipe(__int64 a1, __int64 a2, unsigned int a3, unsigned int a4, __int64 a5)
{
  return (*(int (__fastcall **)(__int64, __int64, _QWORD, _QWORD, _QWORD, __int64))(*(_QWORD *)a1 + 2960LL))(
           a1,
           a2,
           0LL,
           a3,
           a4,
           a5);
}

//----- (0000000000034DC4) ----------------------------------------------------
int __fastcall IOUSBInterfaceUserClientV3::WritePipe(IOUSBInterfaceUserClientV3 *this, __int64 a2, unsigned int a3, unsigned int a4, const void *a5)
{
  return (*(int (__fastcall **)(IOUSBInterfaceUserClientV3 *, __int64, _QWORD, _QWORD, _QWORD, const void *))(*(_QWORD *)this + 2968LL))(
           this,
           a2,
           0LL,
           a3,
           a4,
           a5);
}

//----- (0000000000034DEC) ----------------------------------------------------
int __fastcall IOUSBInterfaceUserClientV3::WritePipe(IOUSBInterfaceUserClientV3 *this, __int64 a2, unsigned int a3, unsigned int a4, IOMemoryDescriptor *a5)
{
  return (*(int (__fastcall **)(IOUSBInterfaceUserClientV3 *, __int64, _QWORD, _QWORD, _QWORD, IOMemoryDescriptor *))(*(_QWORD *)this + 2976LL))(
           this,
           a2,
           0LL,
           a3,
           a4,
           a5);
}

//----- (0000000000034E08) ----------------------------------------------------
void __fastcall IOUSBInterfaceUserClientV3::ClientCloseGated(IOUSBInterfaceUserClientV3 *this)
{
  __int64 v1; // rax@1
  __int64 v2; // rax@5
  __int64 v3; // rax@6

  v1 = *((_QWORD *)this + 37);
  if ( v1 && *(_QWORD *)v1 && (*(int (__cdecl **)(_QWORD))(**(_QWORD **)v1 + 304LL))(*(_QWORD *)v1) )
  {
    while ( 1 )
    {
      LODWORD(v3) = (*(int (__cdecl **)(_QWORD))(***((_QWORD ***)this + 37) + 496LL))(**((_QWORD **)this + 37));
      if ( !v3 )
        break;
      LODWORD(v2) = (*(int (__cdecl **)(_QWORD))(***((_QWORD ***)this + 37) + 496LL))(**((_QWORD **)this + 37));
      (*(void (__fastcall **)(IOUSBInterfaceUserClientV3 *, _QWORD))(*(_QWORD *)this + 3000LL))(
        this,
        *(_QWORD *)(v2 + 112));
    }
  }
  JUMPOUT(__CS__, `vtable for'IOUSBInterfaceUserClientV2[358]);
}
// 451D0: using guessed type __int64 `vtable for'IOUSBInterfaceUserClientV2[2];

//----- (0000000000034E86) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::ReadStreamsPipe(IOService *this, unsigned __int8 a2, unsigned int a3, unsigned int a4, unsigned int a5, IOMemoryDescriptor *a6, unsigned __int64 a7, __int64 a8)
{
  IOMemoryDescriptor *v8; // r15@1
  unsigned int v9; // ebx@1
  int v10; // er12@1
  OSMetaClassBase *v11; // rax@4
  task *v12; // r8@4
  unsigned __int64 v13; // rsi@5
  __int64 v14; // r13@5
  unsigned __int64 v15; // rbx@5
  const OSMetaClass *v16; // rdx@6
  __int64 v17; // rax@8
  int v18; // eax@11
  int v19; // er14@13
  unsigned int v21; // [sp+14h] [bp-3Ch]@5
  OSMetaClassBase *v22; // [sp+18h] [bp-38h]@5
  unsigned int v23; // [sp+20h] [bp-30h]@2
  unsigned int v24; // [sp+24h] [bp-2Ch]@2

  v8 = a6;
  v9 = a3;
  v10 = -536870183;
  if ( *((_QWORD *)this + 27) )
  {
    v23 = a4;
    v24 = a5;
    if ( !(unsigned __int8)IOService::isInactive(this) )
    {
      v10 = -536870206;
      if ( a8 )
      {
        LODWORD(v11) = (*(int (__fastcall **)(IOService *, _QWORD))(*(_QWORD *)this + 2680LL))(this, a2);
        v10 = -536854431;
        if ( v11 )
        {
          v21 = v9;
          v22 = v11;
          v13 = a7;
          v14 = *(_QWORD *)(a8 + 16);
          v15 = IOMemoryDescriptor::withAddressRange(v8, a7, 1uLL, *((_QWORD *)this + 28), v12);
          v10 = -536870211;
          if ( v15 )
          {
            v13 = 0LL;
            v10 = (*(int (__fastcall **)(unsigned __int64, _QWORD))(*(_QWORD *)v15 + 496LL))(v15, 0LL);
            if ( v10 )
            {
              (*(void (__fastcall **)(unsigned __int64))(*(_QWORD *)v15 + 40LL))(v15);
            }
            else
            {
              *(_DWORD *)(v14 + 68) = a7;
              *(_QWORD *)(v14 + 72) = v15;
              v17 = OSMetaClassBase::safeMetaCast(v22, (const OSMetaClassBase *)IOUSBPipeV2::metaClass, v16);
              if ( v17 )
              {
                v13 = v21 | 0x40000000;
                if ( *(_BYTE *)(*((_QWORD *)this + 36) + 180LL) )
                  v13 = v21;
                v18 = (*(int (__fastcall **)(__int64, unsigned __int64, unsigned __int64, _QWORD, _QWORD, unsigned __int64))(*(_QWORD *)v17 + 600LL))(
                        v17,
                        v13,
                        v15,
                        v23,
                        v24,
                        a7);
              }
              else
              {
                v13 = v15;
                v18 = (*(int (__fastcall **)(OSMetaClassBase *, unsigned __int64, _QWORD, _QWORD, __int64, _QWORD))(*(_QWORD *)v22 + 432LL))(
                        v22,
                        v15,
                        v23,
                        v24,
                        a8,
                        0LL);
              }
              v19 = v18;
              v10 = 0;
              if ( v18 )
              {
                v13 = 0LL;
                (*(void (__fastcall **)(unsigned __int64, _QWORD))(*(_QWORD *)v15 + 504LL))(v15, 0LL);
                (*(void (__fastcall **)(unsigned __int64))(*(_QWORD *)v15 + 40LL))(v15);
                v10 = v19;
              }
            }
          }
          (*(void (__cdecl **)(OSMetaClassBase *, unsigned __int64))(*(_QWORD *)v22 + 40LL))(v22, v13);
        }
      }
    }
  }
  return (unsigned int)v10;
}
// 474A0: using guessed type _QWORD IOUSBPipeV2::metaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000003502E) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::ReadStreamsPipe(IOUSBInterfaceUserClientV3 *this, unsigned __int8 a2, unsigned int a3, unsigned int a4, unsigned int a5, void *a6, unsigned int *a7)
{
  IOMemoryDescriptor *v7; // r13@1
  unsigned int v8; // er15@1
  int v9; // er14@1
  OSMetaClassBase *v10; // rax@3
  unsigned int v11; // ecx@3
  void *v12; // rsi@4
  __int64 v13; // r13@4
  const OSMetaClass *v14; // rdx@5
  __int64 v15; // rax@6
  __int64 v16; // rsi@7
  int v17; // eax@9
  void *v19; // [sp+18h] [bp-48h]@4
  OSMetaClassBase *v20; // [sp+20h] [bp-40h]@4
  unsigned int v21; // [sp+28h] [bp-38h]@1
  unsigned int v22; // [sp+2Ch] [bp-34h]@1
  __int64 v23; // [sp+30h] [bp-30h]@4

  v7 = (IOMemoryDescriptor *)a6;
  v22 = a5;
  v21 = a4;
  v8 = a3;
  (*(void (**)(void))(*(_QWORD *)this + 2728LL))();
  v9 = -536870183;
  if ( *((_QWORD *)this + 27) )
  {
    if ( !(unsigned __int8)IOService::isInactive(this) )
    {
      LODWORD(v10) = (*(int (__fastcall **)(IOUSBInterfaceUserClientV3 *, _QWORD))(*(_QWORD *)this + 2680LL))(this, a2);
      v9 = -536854431;
      if ( v10 )
      {
        v20 = v10;
        v12 = (void *)*a7;
        v19 = v12;
        v23 = *a7;
        v13 = IOMemoryDescriptor::withAddress(v7, v12, 1uLL, v11);
        v9 = -536870211;
        if ( v13 )
        {
          *a7 = 0;
          v12 = 0LL;
          v9 = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v13 + 496LL))(v13, 0LL);
          if ( !v9 )
          {
            v15 = OSMetaClassBase::safeMetaCast(v20, (const OSMetaClassBase *)IOUSBPipeV2::metaClass, v14);
            if ( v15 )
            {
              v16 = v8 | 0x40000000;
              if ( *(_BYTE *)(*((_QWORD *)this + 36) + 180LL) )
                v16 = v8;
              v17 = (*(int (__fastcall **)(__int64, __int64, __int64, _QWORD, _QWORD, void *))(*(_QWORD *)v15 + 600LL))(
                      v15,
                      v16,
                      v13,
                      v21,
                      v22,
                      v19);
            }
            else
            {
              v17 = (*(int (__fastcall **)(OSMetaClassBase *, __int64, _QWORD, _QWORD, _QWORD, __int64 *))(*(_QWORD *)v20 + 432LL))(
                      v20,
                      v13,
                      v21,
                      v22,
                      0LL,
                      &v23);
            }
            v9 = v17;
            *a7 = v23;
            v12 = 0LL;
            (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v13 + 504LL))(v13, 0LL);
          }
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v13 + 40LL))(v13);
        }
        (*(void (__cdecl **)(OSMetaClassBase *, void *))(*(_QWORD *)v20 + 40LL))(v20, v12);
      }
    }
  }
  (*(void (__fastcall **)(IOUSBInterfaceUserClientV3 *))(*(_QWORD *)this + 2720LL))(this);
  return (unsigned int)v9;
}
// 474A0: using guessed type _QWORD IOUSBPipeV2::metaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (00000000000351C2) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::ReadStreamsPipe(IOUSBInterfaceUserClientV3 *this, unsigned __int8 a2, int a3, unsigned int a4, unsigned int a5, IOMemoryDescriptor *a6, unsigned __int64 *a7)
{
  IOMemoryDescriptor *v7; // r14@1
  int v8; // er15@1
  int v9; // er12@1
  OSMetaClassBase *v10; // rax@3
  OSMetaClassBase *v11; // r13@3
  const OSMetaClass *v12; // rdx@5
  __int64 v13; // rax@6
  int v14; // er12@7
  int (__fastcall *v15)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD); // ST18_8@9
  __int64 v16; // r15@9
  __int64 v17; // rax@9
  int v18; // eax@9
  unsigned int v20; // [sp+20h] [bp-30h]@1
  unsigned int v21; // [sp+24h] [bp-2Ch]@1

  v7 = a6;
  v21 = a5;
  v20 = a4;
  v8 = a3;
  (*(void (**)(void))(*(_QWORD *)this + 2728LL))();
  v9 = -536870183;
  if ( *((_QWORD *)this + 27) )
  {
    if ( !(unsigned __int8)IOService::isInactive(this) )
    {
      LODWORD(v10) = (*(int (__fastcall **)(IOUSBInterfaceUserClientV3 *, _QWORD))(*(_QWORD *)this + 2680LL))(this, a2);
      v11 = v10;
      v9 = -536854431;
      if ( v10 )
      {
        v9 = -536870211;
        if ( v7 )
        {
          v9 = (*(int (__fastcall **)(IOMemoryDescriptor *, _QWORD))(*(_QWORD *)v7 + 496LL))(v7, 0LL);
          if ( !v9 )
          {
            v13 = OSMetaClassBase::safeMetaCast(v11, (const OSMetaClassBase *)IOUSBPipeV2::metaClass, v12);
            if ( v13 )
            {
              v14 = v8 | 0x40000000;
              if ( *(_BYTE *)(*((_QWORD *)this + 36) + 180LL) )
                v14 = v8;
              v15 = *(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v13 + 600LL);
              v16 = v13;
              LODWORD(v17) = (*(int (__fastcall **)(IOMemoryDescriptor *, _QWORD))(*(_QWORD *)v7 + 456LL))(
                               v7,
                               IOUSBPipeV2::metaClass);
              v18 = v15(v16, (unsigned int)v14, v7, v20, v21, v17);
            }
            else
            {
              v18 = (*(int (__fastcall **)(OSMetaClassBase *, IOMemoryDescriptor *, _QWORD, _QWORD, _QWORD, unsigned __int64 *))(*(_QWORD *)v11 + 432LL))(
                      v11,
                      v7,
                      v20,
                      v21,
                      0LL,
                      a7);
            }
            v9 = v18;
            (*(void (__fastcall **)(IOMemoryDescriptor *, _QWORD))(*(_QWORD *)v7 + 504LL))(v7, 0LL);
          }
        }
        (*(void (__fastcall **)(OSMetaClassBase *))(*(_QWORD *)v11 + 40LL))(v11);
      }
    }
  }
  (*(void (__fastcall **)(IOUSBInterfaceUserClientV3 *))(*(_QWORD *)this + 2720LL))(this);
  return (unsigned int)v9;
}
// 474A0: using guessed type _QWORD IOUSBPipeV2::metaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000035330) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::WriteStreamsPipe(IOService *this, unsigned __int8 a2, unsigned int a3, unsigned int a4, unsigned int a5, IOMemoryDescriptor *a6, unsigned __int64 a7, __int64 a8)
{
  IOMemoryDescriptor *v8; // r15@1
  unsigned int v9; // ebx@1
  int v10; // er12@1
  OSMetaClassBase *v11; // rax@4
  task *v12; // r8@4
  __int64 v13; // r13@5
  __int64 v14; // rbx@5
  const OSMetaClass *v15; // rdx@6
  __int64 v16; // rax@8
  __int64 v17; // rsi@9
  int v18; // eax@11
  int v19; // er14@13
  unsigned int v21; // [sp+14h] [bp-3Ch]@5
  OSMetaClassBase *v22; // [sp+18h] [bp-38h]@5
  unsigned int v23; // [sp+20h] [bp-30h]@2
  unsigned int v24; // [sp+24h] [bp-2Ch]@2

  v8 = a6;
  v9 = a3;
  v10 = -536870183;
  if ( *((_QWORD *)this + 27) )
  {
    v23 = a4;
    v24 = a5;
    if ( !(unsigned __int8)IOService::isInactive(this) )
    {
      v10 = -536870206;
      if ( a8 )
      {
        LODWORD(v11) = (*(int (__fastcall **)(IOService *, _QWORD))(*(_QWORD *)this + 2680LL))(this, a2);
        v10 = -536854431;
        if ( v11 )
        {
          v21 = v9;
          v22 = v11;
          v13 = *(_QWORD *)(a8 + 16);
          v14 = IOMemoryDescriptor::withAddressRange(v8, a7, 2uLL, *((_QWORD *)this + 28), v12);
          v10 = -536870211;
          if ( v14 )
          {
            v10 = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v14 + 496LL))(v14, 0LL);
            if ( v10 )
            {
              (*(void (__fastcall **)(__int64))(*(_QWORD *)v14 + 40LL))(v14);
            }
            else
            {
              *(_DWORD *)(v13 + 68) = a7;
              *(_QWORD *)(v13 + 72) = v14;
              v16 = OSMetaClassBase::safeMetaCast(v22, (const OSMetaClassBase *)IOUSBPipeV2::metaClass, v15);
              if ( v16 )
              {
                v17 = v21 | 0x40000000;
                if ( *(_BYTE *)(*((_QWORD *)this + 36) + 180LL) )
                  v17 = v21;
                v18 = (*(int (__fastcall **)(__int64, __int64, __int64, _QWORD, _QWORD, unsigned __int64))(*(_QWORD *)v16 + 608LL))(
                        v16,
                        v17,
                        v14,
                        v23,
                        v24,
                        a7);
              }
              else
              {
                v18 = (*(int (__fastcall **)(OSMetaClassBase *, __int64, _QWORD, _QWORD, __int64))(*(_QWORD *)v22 + 440LL))(
                        v22,
                        v14,
                        v23,
                        v24,
                        a8);
              }
              v19 = v18;
              v10 = 0;
              if ( v18 )
              {
                (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v14 + 504LL))(v14, 0LL);
                (*(void (__fastcall **)(__int64))(*(_QWORD *)v14 + 40LL))(v14);
                v10 = v19;
              }
            }
          }
          (*(void (__cdecl **)(OSMetaClassBase *))(*(_QWORD *)v22 + 40LL))(v22);
        }
      }
    }
  }
  return (unsigned int)v10;
}
// 474A0: using guessed type _QWORD IOUSBPipeV2::metaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (00000000000354CC) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::WriteStreamsPipe(IOUSBInterfaceUserClientV3 *this, void *a2, unsigned int a3, unsigned int a4, unsigned int a5, const void *a6, unsigned int a7)
{
  IOMemoryDescriptor *v7; // r15@1
  unsigned int v8; // er13@1
  int v9; // er12@1
  OSMetaClassBase *v10; // rax@3
  unsigned int v11; // ecx@3
  OSMetaClassBase *v12; // r14@3
  __int64 v13; // rsi@4
  __int64 v14; // r15@4
  const OSMetaClass *v15; // rdx@5
  __int64 v16; // rax@6
  __int64 v17; // rsi@7
  int v18; // eax@9
  unsigned int v20; // [sp+10h] [bp-30h]@1
  unsigned int v21; // [sp+14h] [bp-2Ch]@1

  v7 = (IOMemoryDescriptor *)a6;
  v21 = a5;
  v20 = a4;
  v8 = a3;
  (*(void (**)(void))(*(_QWORD *)this + 2728LL))();
  v9 = -536870183;
  if ( *((_QWORD *)this + 27) )
  {
    if ( !(unsigned __int8)IOService::isInactive(this) )
    {
      LODWORD(v10) = (*(int (__fastcall **)(IOUSBInterfaceUserClientV3 *, _QWORD))(*(_QWORD *)this + 2680LL))(
                       this,
                       (unsigned __int8)a2);
      v12 = v10;
      v9 = -536854431;
      if ( v10 )
      {
        v13 = a7;
        v14 = IOMemoryDescriptor::withAddress(v7, (void *)a7, 2uLL, v11);
        v9 = -536870211;
        if ( v14 )
        {
          v13 = 0LL;
          v9 = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v14 + 496LL))(v14, 0LL);
          if ( !v9 )
          {
            v16 = OSMetaClassBase::safeMetaCast(v12, (const OSMetaClassBase *)IOUSBPipeV2::metaClass, v15);
            if ( v16 )
            {
              v17 = v8 | 0x40000000;
              if ( *(_BYTE *)(*((_QWORD *)this + 36) + 180LL) )
                v17 = v8;
              v18 = (*(int (__fastcall **)(__int64, __int64, __int64, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v16 + 608LL))(
                      v16,
                      v17,
                      v14,
                      v20,
                      v21,
                      a7);
            }
            else
            {
              v18 = (*(int (__fastcall **)(OSMetaClassBase *, __int64, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v12 + 440LL))(
                      v12,
                      v14,
                      v20,
                      v21,
                      0LL);
            }
            v9 = v18;
            v13 = 0LL;
            (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v14 + 504LL))(v14, 0LL);
          }
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v14 + 40LL))(v14);
        }
        (*(void (__fastcall **)(OSMetaClassBase *, __int64))(*(_QWORD *)v12 + 40LL))(v12, v13);
      }
    }
  }
  (*(void (__fastcall **)(IOUSBInterfaceUserClientV3 *))(*(_QWORD *)this + 2720LL))(this);
  return (unsigned int)v9;
}
// 474A0: using guessed type _QWORD IOUSBPipeV2::metaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (000000000003562C) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::WriteStreamsPipe(IOUSBInterfaceUserClientV3 *this, unsigned __int8 a2, int a3, unsigned int a4, unsigned int a5, IOMemoryDescriptor *a6)
{
  IOMemoryDescriptor *v6; // r14@1
  int v7; // er13@1
  int v8; // er15@1
  OSMetaClassBase *v9; // rax@4
  OSMetaClassBase *v10; // r12@4
  const OSMetaClass *v11; // rdx@5
  __int64 v12; // r15@6
  int v13; // er12@7
  int (__fastcall *v14)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD); // r13@9
  __int64 v15; // rax@9
  __int64 v16; // rsi@9
  int v17; // eax@9
  OSMetaClassBase *v19; // [sp+8h] [bp-38h]@7
  unsigned int v20; // [sp+10h] [bp-30h]@2
  unsigned int v21; // [sp+14h] [bp-2Ch]@2

  v6 = a6;
  v7 = a3;
  v8 = -536870206;
  if ( a6 )
  {
    v20 = a4;
    v21 = a5;
    (*(void (**)(void))(*(_QWORD *)this + 2728LL))();
    v8 = -536870183;
    if ( *((_QWORD *)this + 27) )
    {
      if ( !(unsigned __int8)IOService::isInactive(this) )
      {
        LODWORD(v9) = (*(int (__fastcall **)(IOUSBInterfaceUserClientV3 *, _QWORD))(*(_QWORD *)this + 2680LL))(this, a2);
        v10 = v9;
        v8 = -536854431;
        if ( v9 )
        {
          v8 = (*(int (__fastcall **)(IOMemoryDescriptor *, _QWORD))(*(_QWORD *)v6 + 496LL))(v6, 0LL);
          if ( !v8 )
          {
            v12 = OSMetaClassBase::safeMetaCast(v10, (const OSMetaClassBase *)IOUSBPipeV2::metaClass, v11);
            if ( v12 )
            {
              v19 = v10;
              v13 = v7 | 0x40000000;
              if ( *(_BYTE *)(*((_QWORD *)this + 36) + 180LL) )
                v13 = v7;
              v14 = *(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v12 + 608LL);
              LODWORD(v15) = (*(int (__fastcall **)(IOMemoryDescriptor *, _QWORD))(*(_QWORD *)v6 + 456LL))(
                               v6,
                               IOUSBPipeV2::metaClass);
              v16 = (unsigned int)v13;
              v10 = v19;
              v17 = v14(v12, v16, v6, v20, v21, v15);
            }
            else
            {
              v17 = (*(int (__fastcall **)(OSMetaClassBase *, IOMemoryDescriptor *, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v10 + 440LL))(
                      v10,
                      v6,
                      v20,
                      v21,
                      0LL);
            }
            v8 = v17;
            (*(void (__fastcall **)(IOMemoryDescriptor *, _QWORD))(*(_QWORD *)v6 + 504LL))(v6, 0LL);
          }
          (*(void (__fastcall **)(OSMetaClassBase *))(*(_QWORD *)v10 + 40LL))(v10);
        }
      }
    }
    (*(void (__fastcall **)(IOUSBInterfaceUserClientV3 *))(*(_QWORD *)this + 2720LL))(this);
  }
  return (unsigned int)v8;
}
// 474A0: using guessed type _QWORD IOUSBPipeV2::metaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000035792) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::AbortStreamsPipe(IOUSBInterfaceUserClientV3 *this, unsigned __int8 a2, unsigned int a3)
{
  unsigned int v3; // er14@1
  signed int v4; // er12@1
  OSMetaClassBase *v5; // rax@3
  const OSMetaClass *v6; // rdx@3
  OSMetaClassBase *v7; // r15@3
  __int64 v8; // rax@4
  int v9; // eax@5

  v3 = a3;
  (*(void (**)(void))(*(_QWORD *)this + 2728LL))();
  v4 = -536870183;
  if ( *((_QWORD *)this + 27) )
  {
    if ( !(unsigned __int8)IOService::isInactive(this) )
    {
      LODWORD(v5) = (*(int (__fastcall **)(IOUSBInterfaceUserClientV3 *, _QWORD))(*(_QWORD *)this + 2680LL))(this, a2);
      v7 = v5;
      v4 = -536854431;
      if ( v5 )
      {
        v8 = OSMetaClassBase::safeMetaCast(v5, (const OSMetaClassBase *)IOUSBPipeV2::metaClass, v6);
        if ( v8 )
          v9 = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v8 + 632LL))(v8, v3);
        else
          v9 = (*(int (__fastcall **)(OSMetaClassBase *, _QWORD))(*(_QWORD *)v7 + 296LL))(v7, IOUSBPipeV2::metaClass);
        v4 = v9;
        (*(void (__fastcall **)(OSMetaClassBase *))(*(_QWORD *)v7 + 40LL))(v7);
      }
    }
  }
  (*(void (__fastcall **)(IOUSBInterfaceUserClientV3 *))(*(_QWORD *)this + 2720LL))(this);
  return (unsigned int)v4;
}
// 474A0: using guessed type _QWORD IOUSBPipeV2::metaClass;
// 7D828: using guessed type _QWORD __cdecl OSMetaClassBase::safeMetaCast(OSMetaClassBase *__hidden this, const OSMetaClassBase *, const OSMetaClass *);

//----- (0000000000035842) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::RegisterForNotification(IOUSBInterfaceUserClientV3 *this, uintptr_t arg2, unsigned __int64 (*a3)[8], unsigned __int64 *a4)
{
  unsigned __int64 *v4; // r13@1
  unsigned __int64 (*v5)[8]; // r12@1
  uintptr_t v6; // r14@1
  uintptr_t v7; // r15@1
  signed int v8; // ebx@4
  uintptr_t v9; // r8@9
  __int64 v10; // rax@10
  uintptr_t v11; // rax@11
  __int64 v12; // rbx@15
  __int64 v13; // rax@16
  signed __int64 v14; // rcx@16
  char v15; // al@16
  int v16; // ecx@16
  uintptr_t v17; // r14@16
  uintptr_t v18; // r14@18
  int v19; // eax@18
  __int64 v20; // rdi@21
  int v21; // er12@22
  int v22; // eax@22
  uintptr_t v23; // rbx@29
  int v24; // eax@29
  char v25; // al@31
  __int64 v27; // [sp+0h] [bp-30h]@10

  v4 = a4;
  v5 = a3;
  v6 = arg2;
  v7 = (uintptr_t)this;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
  {
    arg2 = (uintptr_t)this;
    kernel_debug(0x52D2441u, (uintptr_t)this, v6, 0LL, 0LL, 0LL);
  }
  v8 = -536870206;
  if ( !v4 || !v5 )
    goto LABEL_47;
  if ( (unsigned __int8)IOService::isInactive(*((IOService **)this + 27)) )
  {
    v8 = -536870208;
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      v9 = 8LL;
LABEL_37:
      kernel_debug(0x52D2440u, (uintptr_t)this, 0LL, 0LL, v9, 0LL);
      goto LABEL_47;
    }
    goto LABEL_47;
  }
  LODWORD(v10) = (*(int (__fastcall **)(_QWORD, uintptr_t))(**((_QWORD **)this + 27) + 2216LL))(
                   *((_QWORD *)this + 27),
                   arg2);
  v27 = v10;
  if ( !**((_QWORD **)this + 37) )
  {
    v11 = OSSet::withCapacity((OSSet *)((char *)&dword_0 + 1), arg2);
    **((_QWORD **)this + 37) = v11;
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      arg2 = (uintptr_t)this;
      kernel_debug(0x52D2440u, (uintptr_t)this, v11, 0LL, 0LL, 0LL);
      v11 = **((_QWORD **)this + 37);
    }
    if ( !v11 )
    {
      v8 = -536870211;
      if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      {
        v9 = 7LL;
        goto LABEL_37;
      }
      goto LABEL_47;
    }
  }
  v12 = IOUSBNotification::withUserClient(this, (IOUserClient *)arg2);
  if ( v12 )
  {
    v13 = *((_QWORD *)this + 37);
    v14 = *(_QWORD *)(v13 + 8) + 1LL;
    *(_QWORD *)(v13 + 8) = v14;
    *(_QWORD *)(v12 + 112) = v14;
    *(_QWORD *)(v12 + 40) = v6;
    bcopy(v5, (void *)(v12 + 48), 0x40uLL);
    *(_QWORD *)(v12 + 24) = v27;
    *(_QWORD *)(v12 + 32) = *((_QWORD *)this + 27);
    v15 = (*(int (__fastcall **)(_QWORD, __int64))(***((_QWORD ***)this + 37) + 448LL))(**((_QWORD **)this + 37), v12);
    v16 = gUSBStackDebugFlags & 2;
    v17 = v12;
    if ( !v15 )
    {
      v21 = -536870211;
      if ( v16 )
      {
        v23 = **((_QWORD **)this + 37);
        v24 = (*(int (__fastcall **)(_QWORD))(*(_QWORD *)v23 + 304LL))(**((_QWORD **)this + 37));
        if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          kernel_debug(0x52D2440u, (uintptr_t)this, v23, (unsigned int)v24, 5uLL, 0LL);
      }
      goto LABEL_46;
    }
    if ( v16 )
    {
      v18 = **((_QWORD **)this + 37);
      v19 = (*(int (__fastcall **)(_QWORD))(*(_QWORD *)v18 + 304LL))(**((_QWORD **)this + 37));
      if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        kernel_debug(0x52D2440u, (uintptr_t)this, v18, (unsigned int)v19, 1uLL, 0LL);
    }
    if ( v27 && (v20 = *(_QWORD *)(*(_QWORD *)(v27 + 232) + 144LL)) != 0 )
    {
      v17 = v12;
      v21 = (*(int (__fastcall **)(__int64, signed __int64, __int64, _QWORD))(*(_QWORD *)v20 + 2200LL))(
              v20,
              1LL,
              v12,
              0LL);
      v22 = gUSBStackDebugFlags & 2;
      if ( !v21 )
      {
        if ( v22 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
          kernel_debug(0x52D2440u, v7, v12, *(_QWORD *)(v12 + 112), 3uLL, 0LL);
        *v4 = *(_QWORD *)(v12 + 112);
        v21 = 0;
LABEL_43:
        if ( (*(int (**)(void))(***(_QWORD ***)(v7 + 296) + 304LL))() )
          *(_BYTE *)(*(_QWORD *)(v7 + 288) + 180LL) = 1;
        v8 = 0;
        if ( !v21 )
          goto LABEL_47;
LABEL_46:
        (*(void (__fastcall **)(uintptr_t))(*(_QWORD *)v17 + 40LL))(v17);
        v8 = v21;
        goto LABEL_47;
      }
      if ( !v22 )
      {
LABEL_42:
        (*(void (__fastcall **)(_QWORD, uintptr_t))(***(_QWORD ***)(v7 + 296) + 472LL))(**(_QWORD **)(v7 + 296), v17);
        goto LABEL_43;
      }
    }
    else
    {
      v25 = gUSBStackDebugFlags;
      if ( gUSBStackDebugFlags & 2 )
      {
        v17 = v12;
        if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
        {
          kernel_debug(0x52D2440u, v7, 0LL, 0LL, 2uLL, 0LL);
          v25 = gUSBStackDebugFlags;
        }
      }
      else
      {
        v17 = v12;
      }
      v21 = -536870208;
      if ( !(v25 & 2) )
        goto LABEL_42;
    }
    if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D2440u, v7, v21, v17, 4uLL, 0LL);
    goto LABEL_42;
  }
  v8 = -536870211;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
  {
    v9 = 6LL;
    goto LABEL_37;
  }
LABEL_47:
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D2442u, v7, v8, 0LL, 0LL, 0LL);
  return (unsigned int)v8;
}
// 0: using guessed type int dword_0;
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (0000000000035CB8) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::UnregisterNotification(uintptr_t arg1, uintptr_t arg2)
{
  uintptr_t v2; // r14@1
  uintptr_t v3; // r12@1
  __int64 v4; // rax@1
  __int64 v5; // r15@1
  int *v6; // rbx@1
  __int64 v7; // rdi@4
  __int64 v8; // rax@5
  __int64 v9; // r15@5
  uintptr_t v10; // rax@6
  uintptr_t v11; // rbx@6
  uintptr_t v12; // r13@6
  uintptr_t v13; // rax@9
  int v14; // er14@11
  uintptr_t v15; // r8@13
  __int64 v16; // rdi@23
  uintptr_t v17; // rsi@25
  int v18; // eax@26
  __int64 v20; // [sp+0h] [bp-30h]@5

  v2 = arg2;
  v3 = arg1;
  LODWORD(v4) = (*(int (__cdecl **)(_QWORD))(**(_QWORD **)(arg1 + 216) + 2216LL))(*(_QWORD *)(arg1 + 216));
  v5 = v4;
  v6 = &gUSBStackDebugFlags;
  if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
  {
    arg2 = arg1;
    kernel_debug(0x52D2445u, arg1, v2, **(_QWORD **)(arg1 + 296), 0LL, 0LL);
  }
  v7 = **(_QWORD **)(arg1 + 296);
  if ( !v7 )
  {
    v14 = -536870206;
    if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
      goto LABEL_34;
    v15 = 4LL;
LABEL_33:
    kernel_debug(0x52D2444u, v3, 0LL, 0LL, v15, 0LL);
    goto LABEL_34;
  }
  v20 = v5;
  LODWORD(v8) = OSCollectionIterator::withCollection(v7, arg2);
  v9 = v8;
  if ( !v8 )
  {
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D2444u, v3, 0LL, 0LL, 1uLL, 0LL);
LABEL_30:
    v14 = -536870206;
    v6 = &gUSBStackDebugFlags;
    if ( !(gUSBStackDebugFlags & 2) || !(*(_DWORD *)off_3B100[0] & 0xFFFFFFF7) )
      goto LABEL_34;
    v15 = 3LL;
    goto LABEL_33;
  }
  LODWORD(v10) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v8 + 296LL))(v8);
  v11 = v10;
  v12 = 0LL;
  if ( v10 )
  {
    v12 = 0LL;
    while ( *(_QWORD *)(v11 + 112) != v2 )
    {
      LODWORD(v13) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v9 + 296LL))(v9);
      v11 = v13;
      if ( !v13 )
        goto LABEL_21;
    }
    if ( gUSBStackDebugFlags & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
      kernel_debug(0x52D2444u, v3, v11, **(_QWORD **)(v3 + 296), 0LL, 0LL);
    v12 = v11;
  }
LABEL_21:
  (*(void (__fastcall **)(__int64))(*(_QWORD *)v9 + 40LL))(v9);
  if ( !v12 )
    goto LABEL_30;
  v14 = 0;
  if ( v20 )
  {
    v16 = *(_QWORD *)(*(_QWORD *)(v20 + 232) + 144LL);
    if ( v16 )
      v14 = (*(int (__fastcall **)(__int64, signed __int64, uintptr_t, _QWORD))(*(_QWORD *)v16 + 2200LL))(
              v16,
              2LL,
              v11,
              0LL);
  }
  v17 = v12;
  (*(void (__fastcall **)(_QWORD, uintptr_t))(***(_QWORD ***)(v3 + 296) + 472LL))(**(_QWORD **)(v3 + 296), v12);
  IOUserClient::releaseAsyncReference64((IOUserClient *)(v12 + 48), (unsigned __int64 *)v12);
  v6 = &gUSBStackDebugFlags;
  if ( gUSBStackDebugFlags & 2 )
  {
    v18 = (*(int (__fastcall **)(uintptr_t))(*(_QWORD *)v12 + 24LL))(v12);
    if ( *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    {
      v17 = v3;
      kernel_debug(0x52D2444u, v3, v12, v18, 2uLL, 0LL);
    }
  }
  (*(void (__fastcall **)(uintptr_t, uintptr_t))(*(_QWORD *)v12 + 40LL))(v12, v17);
  if ( !(*(int (**)(void))(***(_QWORD ***)(v3 + 296) + 304LL))() )
    *(_BYTE *)(*(_QWORD *)(v3 + 288) + 180LL) = 0;
LABEL_34:
  if ( *(_BYTE *)v6 & 2 && *(_DWORD *)off_3B100[0] & 0xFFFFFFF7 )
    kernel_debug(0x52D2446u, v3, v14, 0LL, 0LL, 0LL);
  return (unsigned int)v14;
}
// 3B100: using guessed type __int64 off_3B100[2];
// 49460: using guessed type int gUSBStackDebugFlags;
// 7D880: using guessed type int __fastcall OSCollectionIterator::withCollection(_QWORD, _QWORD);

//----- (0000000000035F82) ----------------------------------------------------
int __fastcall IOUSBInterfaceUserClientV3::AcknowledgeNotification(IOUSBInterfaceUserClientV3 *this, __int64 a2)
{
  __int64 v2; // rax@1
  __int64 v3; // rdi@2
  int result; // eax@3

  LODWORD(v2) = (*(int (__cdecl **)(_QWORD))(**((_QWORD **)this + 27) + 2216LL))(*((_QWORD *)this + 27));
  if ( v2 && (v3 = *(_QWORD *)(*(_QWORD *)(v2 + 232) + 144LL)) != 0 )
    result = (*(int (__fastcall **)(__int64, signed __int64, _QWORD, __int64))(*(_QWORD *)v3 + 2200LL))(
               v3,
               3LL,
               0LL,
               a2);
  else
    result = 0;
  return result;
}

//----- (0000000000035FD8) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::RegisterDriver(IOUSBInterfaceUserClientV3 *this)
{
  IOUSBInterfaceUserClientV3 *v1; // rcx@1
  __int64 v2; // rdi@1
  __int64 result; // rax@1
  __int64 v4; // rcx@2

  v1 = this;
  v2 = *((_QWORD *)this + 27);
  result = 3758097122LL;
  if ( v2 )
  {
    v4 = *((_QWORD *)v1 + 36);
    if ( *(_BYTE *)(v4 + 183) || *(_BYTE *)v4 )
    {
      (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v2 + 1456LL))(v2, 2LL);
      result = 0LL;
    }
  }
  return result;
}

//----- (0000000000036018) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::_RESERVEDIOUSBInterfaceUserClientV34(IOUSBInterfaceUserClientV3 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBInterfaceUserClientV3::gMetaClass, 4);
}
// 499F0: using guessed type _QWORD IOUSBInterfaceUserClientV3::gMetaClass;

//----- (000000000003602E) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::_RESERVEDIOUSBInterfaceUserClientV35(IOUSBInterfaceUserClientV3 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBInterfaceUserClientV3::gMetaClass, 5);
}
// 499F0: using guessed type _QWORD IOUSBInterfaceUserClientV3::gMetaClass;

//----- (0000000000036044) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::_RESERVEDIOUSBInterfaceUserClientV36(IOUSBInterfaceUserClientV3 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBInterfaceUserClientV3::gMetaClass, 6);
}
// 499F0: using guessed type _QWORD IOUSBInterfaceUserClientV3::gMetaClass;

//----- (000000000003605A) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::_RESERVEDIOUSBInterfaceUserClientV37(IOUSBInterfaceUserClientV3 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBInterfaceUserClientV3::gMetaClass, 7);
}
// 499F0: using guessed type _QWORD IOUSBInterfaceUserClientV3::gMetaClass;

//----- (0000000000036070) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::_RESERVEDIOUSBInterfaceUserClientV38(IOUSBInterfaceUserClientV3 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBInterfaceUserClientV3::gMetaClass, 8);
}
// 499F0: using guessed type _QWORD IOUSBInterfaceUserClientV3::gMetaClass;

//----- (0000000000036086) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::_RESERVEDIOUSBInterfaceUserClientV39(IOUSBInterfaceUserClientV3 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBInterfaceUserClientV3::gMetaClass, 9);
}
// 499F0: using guessed type _QWORD IOUSBInterfaceUserClientV3::gMetaClass;

//----- (000000000003609C) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::_RESERVEDIOUSBInterfaceUserClientV310(IOUSBInterfaceUserClientV3 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBInterfaceUserClientV3::gMetaClass, 10);
}
// 499F0: using guessed type _QWORD IOUSBInterfaceUserClientV3::gMetaClass;

//----- (00000000000360B2) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::_RESERVEDIOUSBInterfaceUserClientV311(IOUSBInterfaceUserClientV3 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBInterfaceUserClientV3::gMetaClass, 11);
}
// 499F0: using guessed type _QWORD IOUSBInterfaceUserClientV3::gMetaClass;

//----- (00000000000360C8) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::_RESERVEDIOUSBInterfaceUserClientV312(IOUSBInterfaceUserClientV3 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBInterfaceUserClientV3::gMetaClass, 12);
}
// 499F0: using guessed type _QWORD IOUSBInterfaceUserClientV3::gMetaClass;

//----- (00000000000360DE) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::_RESERVEDIOUSBInterfaceUserClientV313(IOUSBInterfaceUserClientV3 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBInterfaceUserClientV3::gMetaClass, 13);
}
// 499F0: using guessed type _QWORD IOUSBInterfaceUserClientV3::gMetaClass;

//----- (00000000000360F4) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::_RESERVEDIOUSBInterfaceUserClientV314(IOUSBInterfaceUserClientV3 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBInterfaceUserClientV3::gMetaClass, 14);
}
// 499F0: using guessed type _QWORD IOUSBInterfaceUserClientV3::gMetaClass;

//----- (000000000003610A) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::_RESERVEDIOUSBInterfaceUserClientV315(IOUSBInterfaceUserClientV3 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBInterfaceUserClientV3::gMetaClass, 15);
}
// 499F0: using guessed type _QWORD IOUSBInterfaceUserClientV3::gMetaClass;

//----- (0000000000036120) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::_RESERVEDIOUSBInterfaceUserClientV316(IOUSBInterfaceUserClientV3 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBInterfaceUserClientV3::gMetaClass, 16);
}
// 499F0: using guessed type _QWORD IOUSBInterfaceUserClientV3::gMetaClass;

//----- (0000000000036136) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::_RESERVEDIOUSBInterfaceUserClientV317(IOUSBInterfaceUserClientV3 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBInterfaceUserClientV3::gMetaClass, 17);
}
// 499F0: using guessed type _QWORD IOUSBInterfaceUserClientV3::gMetaClass;

//----- (000000000003614C) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::_RESERVEDIOUSBInterfaceUserClientV318(IOUSBInterfaceUserClientV3 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBInterfaceUserClientV3::gMetaClass, 18);
}
// 499F0: using guessed type _QWORD IOUSBInterfaceUserClientV3::gMetaClass;

//----- (0000000000036162) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::_RESERVEDIOUSBInterfaceUserClientV319(IOUSBInterfaceUserClientV3 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBInterfaceUserClientV3::gMetaClass, 19);
}
// 499F0: using guessed type _QWORD IOUSBInterfaceUserClientV3::gMetaClass;

//----- (0000000000036178) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::_RESERVEDIOUSBInterfaceUserClientV320(IOUSBInterfaceUserClientV3 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBInterfaceUserClientV3::gMetaClass, 20);
}
// 499F0: using guessed type _QWORD IOUSBInterfaceUserClientV3::gMetaClass;

//----- (000000000003618E) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::_RESERVEDIOUSBInterfaceUserClientV321(IOUSBInterfaceUserClientV3 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBInterfaceUserClientV3::gMetaClass, 21);
}
// 499F0: using guessed type _QWORD IOUSBInterfaceUserClientV3::gMetaClass;

//----- (00000000000361A4) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::_RESERVEDIOUSBInterfaceUserClientV322(IOUSBInterfaceUserClientV3 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBInterfaceUserClientV3::gMetaClass, 22);
}
// 499F0: using guessed type _QWORD IOUSBInterfaceUserClientV3::gMetaClass;

//----- (00000000000361BA) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::_RESERVEDIOUSBInterfaceUserClientV323(IOUSBInterfaceUserClientV3 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBInterfaceUserClientV3::gMetaClass, 23);
}
// 499F0: using guessed type _QWORD IOUSBInterfaceUserClientV3::gMetaClass;

//----- (00000000000361D0) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::_RESERVEDIOUSBInterfaceUserClientV324(IOUSBInterfaceUserClientV3 *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBInterfaceUserClientV3::gMetaClass, 24);
}
// 499F0: using guessed type _QWORD IOUSBInterfaceUserClientV3::gMetaClass;

//----- (00000000000361E6) ----------------------------------------------------
__int64 __fastcall IOUSBInterfaceUserClientV3::MetaClass::~MetaClass(IOUSBInterfaceUserClientV3::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (00000000000361F0) ----------------------------------------------------
__int64 `global constructor keyed to'_a_18()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(
    &IOUSBInterfaceUserClientV3::gMetaClass,
    "IOUSBInterfaceUserClientV3",
    &IOUSBInterfaceUserClientV2::gMetaClass,
    304LL);
  result = (__int64)off_48600;
  IOUSBInterfaceUserClientV3::gMetaClass = off_48600;
  return result;
}
// 48600: using guessed type __int64 (__fastcall *off_48600[2])(IOUSBInterfaceUserClientV3::MetaClass *__hidden this);
// 49928: using guessed type _QWORD IOUSBInterfaceUserClientV2::gMetaClass;
// 499F0: using guessed type _QWORD IOUSBInterfaceUserClientV3::gMetaClass;
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000036230) ----------------------------------------------------
__int64 `global destructor keyed to'_a_18()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&IOUSBInterfaceUserClientV3::gMetaClass);
}
// 499F0: using guessed type _QWORD IOUSBInterfaceUserClientV3::gMetaClass;

//----- (0000000000036250) ----------------------------------------------------
__int64 __fastcall AppleUSBDiagnostics::MetaClass::MetaClass(AppleUSBDiagnostics::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "AppleUSBDiagnostics", off_3B080[0], 40LL);
  result = (__int64)off_48C30;
  *(_QWORD *)this = off_48C30;
  return result;
}
// 3B080: using guessed type _QWORD off_3B080[18];
// 48C30: using guessed type __int64 (__fastcall *off_48C30[2])(AppleUSBDiagnostics::MetaClass *__hidden this);
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000036282) ----------------------------------------------------
__int64 __fastcall AppleUSBDiagnostics::MetaClass::~MetaClass(AppleUSBDiagnostics::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000003628C) ----------------------------------------------------
__int64 __fastcall AppleUSBDiagnostics::AppleUSBDiagnostics(__int64 a1)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1);
  result = (__int64)off_48AE0;
  *(_QWORD *)a1 = off_48AE0;
  return result;
}
// 48AE0: using guessed type __int64 (__fastcall *off_48AE0[2])(AppleUSBDiagnostics *__hidden this);
// 7D998: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (00000000000362AC) ----------------------------------------------------
__int64 __fastcall AppleUSBDiagnostics::AppleUSBDiagnostics(__int64 a1)
{
  __int64 result; // rax@1

  OSObject::OSObject(a1);
  result = (__int64)off_48AE0;
  *(_QWORD *)a1 = off_48AE0;
  return result;
}
// 48AE0: using guessed type __int64 (__fastcall *off_48AE0[2])(AppleUSBDiagnostics *__hidden this);
// 7D998: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (00000000000362CC) ----------------------------------------------------
__int64 __fastcall AppleUSBDiagnostics::~AppleUSBDiagnostics(AppleUSBDiagnostics *this)
{
  return OSObject::~OSObject(this);
}

//----- (00000000000362D6) ----------------------------------------------------
__int64 __fastcall AppleUSBDiagnostics::~AppleUSBDiagnostics(AppleUSBDiagnostics *this)
{
  return OSObject::~OSObject(this);
}

//----- (00000000000362E0) ----------------------------------------------------
void __fastcall AppleUSBDiagnostics::~AppleUSBDiagnostics(AppleUSBDiagnostics *this)
{
  OSObject::~OSObject(this);
  OSObject::operator delete((void *)this);
}

//----- (0000000000036302) ----------------------------------------------------
__int64 __fastcall AppleUSBDiagnostics::getMetaClass(AppleUSBDiagnostics *this)
{
  return (__int64)&AppleUSBDiagnostics::gMetaClass;
}
// 49A18: using guessed type _QWORD AppleUSBDiagnostics::gMetaClass;

//----- (0000000000036310) ----------------------------------------------------
__int64 __fastcall AppleUSBDiagnostics::MetaClass::MetaClass(AppleUSBDiagnostics::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "AppleUSBDiagnostics", off_3B080[0], 40LL);
  result = (__int64)off_48C30;
  *(_QWORD *)this = off_48C30;
  return result;
}
// 3B080: using guessed type _QWORD off_3B080[18];
// 48C30: using guessed type __int64 (__fastcall *off_48C30[2])(AppleUSBDiagnostics::MetaClass *__hidden this);
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000036342) ----------------------------------------------------
__int64 __fastcall AppleUSBDiagnostics::MetaClass::alloc(AppleUSBDiagnostics::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)stru_20.segname, a2);
  OSObject::OSObject(v2);
  *(_QWORD *)v2 = off_48AE0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUSBDiagnostics::gMetaClass);
  return v2;
}
// 20: using guessed type segment_command_64 stru_20;
// 48AE0: using guessed type __int64 (__fastcall *off_48AE0[2])(AppleUSBDiagnostics *__hidden this);
// 49A18: using guessed type _QWORD AppleUSBDiagnostics::gMetaClass;
// 7D998: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000036382) ----------------------------------------------------
__int64 __fastcall AppleUSBDiagnostics::AppleUSBDiagnostics(__int64 a1)
{
  OSObject::OSObject(a1);
  *(_QWORD *)a1 = off_48AE0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUSBDiagnostics::gMetaClass);
}
// 48AE0: using guessed type __int64 (__fastcall *off_48AE0[2])(AppleUSBDiagnostics *__hidden this);
// 49A18: using guessed type _QWORD AppleUSBDiagnostics::gMetaClass;
// 7D998: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (00000000000363B2) ----------------------------------------------------
__int64 __fastcall AppleUSBDiagnostics::AppleUSBDiagnostics(__int64 a1)
{
  OSObject::OSObject(a1);
  *(_QWORD *)a1 = off_48AE0;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUSBDiagnostics::gMetaClass);
}
// 48AE0: using guessed type __int64 (__fastcall *off_48AE0[2])(AppleUSBDiagnostics *__hidden this);
// 49A18: using guessed type _QWORD AppleUSBDiagnostics::gMetaClass;
// 7D998: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (00000000000363E2) ----------------------------------------------------
int __fastcall AppleUSBDiagnostics::createDiagnostics(__int64 a1, unsigned __int64 a2, __int64 a3)
{
  __int64 v3; // r14@1
  __int64 v4; // rbx@1

  v3 = a3;
  v4 = OSObject::operator new((OSObject *)stru_20.segname, a2);
  OSObject::OSObject(v4);
  *(_QWORD *)v4 = off_48AE0;
  OSMetaClass::instanceConstructed((OSMetaClass *)&AppleUSBDiagnostics::gMetaClass);
  return (*(int (__fastcall **)(__int64, __int64, __int64, unsigned __int64, __int64))(*(_QWORD *)v4 + 280LL))(
           v4,
           v4,
           a1,
           a2,
           v3);
}
// 20: using guessed type segment_command_64 stru_20;
// 48AE0: using guessed type __int64 (__fastcall *off_48AE0[2])(AppleUSBDiagnostics *__hidden this);
// 49A18: using guessed type _QWORD AppleUSBDiagnostics::gMetaClass;
// 7D998: using guessed type int __cdecl OSObject::OSObject(_QWORD);

//----- (0000000000036454) ----------------------------------------------------
__int64 __fastcall AppleUSBDiagnostics::initDiagnostics(__int64 a1, __int64 a2, void *a3, __int64 a4, __int64 a5)
{
  __int64 v5; // r15@1
  __int64 v6; // r12@1
  void *v7; // r14@1
  __int64 result; // rax@1

  v5 = a5;
  v6 = a4;
  v7 = a3;
  result = 0LL;
  if ( a2 )
  {
    if ( (unsigned __int8)(*(int (__fastcall **)(__int64))(*(_QWORD *)a2 + 136LL))(a2) )
    {
      *(_QWORD *)(a2 + 16) = v7;
      *(_QWORD *)(a2 + 24) = v6;
      *(_QWORD *)(a2 + 32) = v5;
      bzero(v7, 0x9160uLL);
      result = a2;
    }
    else
    {
      (*(void (__fastcall **)(__int64))(*(_QWORD *)a2 + 40LL))(a2);
      result = 0LL;
    }
  }
  return result;
}

//----- (00000000000364B4) ----------------------------------------------------
int __fastcall AppleUSBDiagnostics::serializePort(__int64 a1, __int64 a2, __int64 a3, __int64 a4)
{
  __int64 v4; // r12@1
  __int64 v5; // r14@1
  unsigned int v6; // edx@3
  __int64 v7; // r15@3
  __int64 v8; // rbx@4
  __int64 v9; // r13@5
  __int64 v10; // rax@7
  unsigned int v11; // edx@7
  __int64 v12; // r15@7
  __int64 v13; // rbx@8
  __int64 v14; // r13@9

  v4 = a4;
  v5 = a2;
  (*(void (__fastcall **)(__int64, __int64, _QWORD, _QWORD))(*(_QWORD *)a1 + 296LL))(
    a1,
    a2,
    *(_DWORD *)a4,
    "Port errors");
  if ( gUSBStackDebugFlags & 4 )
  {
    (*(void (__fastcall **)(__int64, __int64, _QWORD, _QWORD))(*(_QWORD *)a1 + 296LL))(
      a1,
      a2,
      *(_DWORD *)(v4 + 1040),
      "Bytes");
    (*(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 296LL))(
      a1,
      a2,
      (unsigned int)(*(_DWORD *)(v4 + 1040) - *(_DWORD *)(v4 + 1032)),
      "Bytes (New)");
    *(_QWORD *)(v4 + 1032) = *(_QWORD *)(v4 + 1040);
    (*(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 296LL))(
      a1,
      a2,
      *(_DWORD *)(v4 + 1048),
      "Timeouts");
    (*(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 296LL))(
      a1,
      a2,
      (unsigned int)(*(_DWORD *)(v4 + 1048) - *(_DWORD *)(v4 + 1052)),
      "Timeouts (New)");
    *(_DWORD *)(v4 + 1052) = *(_DWORD *)(v4 + 1048);
  }
  (*(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 296LL))(
    a1,
    a2,
    *(_DWORD *)(v4 + 1060),
    "Resets");
  (*(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 296LL))(
    a1,
    a2,
    (unsigned int)(*(_DWORD *)(v4 + 1060) - *(_DWORD *)(v4 + 1056)),
    "Resets (New)");
  *(_DWORD *)(v4 + 1056) = *(_DWORD *)(v4 + 1060);
  (*(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 296LL))(
    a1,
    a2,
    *(_DWORD *)(v4 + 1064),
    "enable");
  (*(void (__fastcall **)(__int64, __int64, _QWORD, char[8]))(*(_QWORD *)a1 + 296LL))(
    a1,
    a2,
    *(_DWORD *)(v4 + 1068),
    "suspend");
  (*(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 296LL))(
    a1,
    a2,
    *(_DWORD *)(v4 + 1072),
    "resume");
  (*(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 296LL))(
    a1,
    a2,
    *(_DWORD *)(v4 + 1076),
    "warmReset");
  (*(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 296LL))(
    a1,
    a2,
    *(_DWORD *)(v4 + 1144),
    "power");
  (*(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 296LL))(
    a1,
    a2,
    *(_DWORD *)(v4 + 1148),
    "u1Timeout");
  (*(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 296LL))(
    a1,
    a2,
    *(_DWORD *)(v4 + 1152),
    "u2Timeout");
  (*(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 296LL))(
    a1,
    a2,
    *(_DWORD *)(v4 + 1156),
    "remoteWakeMask");
  v7 = OSArray::withCapacity((OSArray *)&stru_B8.reserved2, a2);
  if ( v7 )
  {
    v8 = 0LL;
    do
    {
      v9 = OSNumber::withNumber((OSNumber *)*(_DWORD *)(v4 + 4 * v8 + 4), 0x20uLL, v6);
      (*(void (__fastcall **)(__int64, _QWORD, __int64))(*(_QWORD *)v7 + 448LL))(v7, (unsigned int)v8, v9);
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v9 + 40LL))(v9);
      ++v8;
    }
    while ( v8 != 256 );
    a2 = (__int64)"XHCI Completion Codes";
    (*(void (__fastcall **)(__int64, _QWORD, __int64))(*(_QWORD *)v5 + 464LL))(v5, "XHCI Completion Codes", v7);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v7 + 40LL))(v7);
  }
  v10 = OSArray::withCapacity((OSArray *)&dword_10, a2);
  v12 = v10;
  if ( v10 )
  {
    v13 = 0LL;
    do
    {
      v14 = OSNumber::withNumber((OSNumber *)*(_DWORD *)(v4 + 4 * v13 + 1080), 0x20uLL, v11);
      (*(void (__fastcall **)(__int64, _QWORD, __int64))(*(_QWORD *)v12 + 448LL))(v12, (unsigned int)v13, v14);
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v14 + 40LL))(v14);
      ++v13;
    }
    while ( v13 != 16 );
    (*(void (__fastcall **)(__int64, _QWORD, __int64))(*(_QWORD *)v5 + 464LL))(v5, "LinkStates", v12);
    LODWORD(v10) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v12 + 40LL))(v12);
  }
  return v10;
}
// 10: using guessed type int dword_10;
// B8: using guessed type section_64 stru_B8;
// 49460: using guessed type int gUSBStackDebugFlags;

//----- (00000000000367D0) ----------------------------------------------------
char __fastcall AppleUSBDiagnostics::serialize(__int64 a1, __int64 a2)
{
  __int64 v2; // r14@1
  __int64 v3; // r12@1
  __int64 v4; // rax@2
  __int64 v5; // rdx@2
  __int64 v6; // rax@3
  __int64 v7; // rax@3
  __int64 v8; // rax@3
  __int64 v9; // rdx@3
  char *v10; // rsi@4
  signed __int64 v11; // r15@5
  unsigned int v12; // er14@5
  __int64 v13; // r12@6
  unsigned __int64 v14; // r12@7
  __int64 v15; // rcx@7
  unsigned __int64 v16; // rcx@7
  unsigned int v17; // er12@7
  __int64 v18; // rax@7
  __int64 v19; // rax@7
  __int64 v20; // rax@7
  unsigned int *v21; // rcx@7
  char v22; // bl@9
  __int64 v23; // rax@12
  __int64 v25; // [sp+0h] [bp-90h]@2
  __int64 v26; // [sp+8h] [bp-88h]@2
  __int64 v27; // [sp+10h] [bp-80h]@7
  __int64 v28; // [sp+18h] [bp-78h]@7
  char v29; // [sp+20h] [bp-70h]@6
  __int64 v30; // [sp+60h] [bp-30h]@1

  v2 = off_3B0E0[0];
  v30 = *(_QWORD *)off_3B0E0[0];
  v3 = OSDictionary::withCapacity((OSDictionary *)((char *)&dword_C + 2), a2);
  if ( v3 )
  {
    v25 = a2;
    v4 = *(_QWORD *)(a1 + 16);
    v5 = (unsigned int)(*(_DWORD *)(v4 + 24) + 1);
    *(_DWORD *)(v4 + 24) = v5;
    (*(void (__fastcall **)(__int64, __int64, __int64, _QWORD))(*(_QWORD *)a1 + 296LL))(a1, v3, v5, "Access Count");
    (*(void (__fastcall **)(__int64, __int64, _QWORD, _QWORD))(*(_QWORD *)a1 + 296LL))(
      a1,
      v3,
      *(_DWORD *)(*(_QWORD *)(a1 + 16) + 28LL),
      "Errors (Total)");
    (*(void (__fastcall **)(__int64, __int64, _QWORD, _QWORD))(*(_QWORD *)a1 + 296LL))(
      a1,
      v3,
      (unsigned int)(*(_DWORD *)(*(_QWORD *)(a1 + 16) + 28LL) - *(_DWORD *)(*(_QWORD *)(a1 + 16) + 32LL)),
      "Errors (New)");
    *(_DWORD *)(*(_QWORD *)(a1 + 16) + 32LL) = *(_DWORD *)(*(_QWORD *)(a1 + 16) + 28LL);
    (*(void (__fastcall **)(__int64, __int64, _QWORD, _QWORD))(*(_QWORD *)a1 + 296LL))(
      a1,
      v3,
      (unsigned int)gUSBStackDebugFlags,
      "Debug Flags");
    v26 = v3;
    if ( gUSBStackDebugFlags & 4 )
    {
      (*(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 296LL))(
        a1,
        v3,
        *(_DWORD *)(*(_QWORD *)(a1 + 16) + 52LL),
        "Recovered Errors");
      (*(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 296LL))(
        a1,
        v3,
        (unsigned int)(*(_DWORD *)(*(_QWORD *)(a1 + 16) + 52LL) - *(_DWORD *)(*(_QWORD *)(a1 + 16) + 56LL)),
        "Recovered Errors (New)");
      v6 = *(_QWORD *)(a1 + 16);
      *(_DWORD *)(v6 + 56) = *(_DWORD *)(v6 + 52);
      (*(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 296LL))(
        a1,
        v3,
        *(_DWORD *)(v6 + 60),
        "Recovered 2 strike errors");
      (*(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 296LL))(
        a1,
        v3,
        (unsigned int)(*(_DWORD *)(*(_QWORD *)(a1 + 16) + 60LL) - *(_DWORD *)(*(_QWORD *)(a1 + 16) + 64LL)),
        "Recovered 2 strike errors (New)");
      v7 = *(_QWORD *)(a1 + 16);
      *(_DWORD *)(v7 + 64) = *(_DWORD *)(v7 + 60);
      (*(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 296LL))(
        a1,
        v3,
        *(_DWORD *)(v7 + 68),
        "Fatal 3 strike errors");
      (*(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 296LL))(
        a1,
        v3,
        (unsigned int)(*(_DWORD *)(*(_QWORD *)(a1 + 16) + 68LL) - *(_DWORD *)(*(_QWORD *)(a1 + 16) + 72LL)),
        "Fatal 3 strike errors (New)");
      v8 = *(_QWORD *)(a1 + 16);
      *(_DWORD *)(v8 + 72) = *(_DWORD *)(v8 + 68);
      v9 = *(_DWORD *)(v8 + 80);
      if ( (_DWORD)v9 )
      {
        LODWORD(v10) = v3;
        (*(void (__fastcall **)(__int64, __int64, __int64, _QWORD))(*(_QWORD *)a1 + 296LL))(
          a1,
          v3,
          v9,
          "Number of ports");
        if ( *(_DWORD *)(*(_QWORD *)(a1 + 16) + 80LL) > 0 )
        {
          v11 = 88LL;
          v12 = 0;
          do
          {
            v13 = OSDictionary::withCapacity((OSDictionary *)((char *)&dword_0 + 1), (unsigned int)v10);
            (*(void (__fastcall **)(__int64, __int64, _QWORD, signed __int64, _QWORD))(*(_QWORD *)a1 + 288LL))(
              a1,
              v13,
              v12++,
              v11 + *(_QWORD *)(a1 + 16),
              *(_QWORD *)(a1 + 32));
            snprintf(&v29, 0x3FuLL, "Port %2d", v12, v25);
            v10 = &v29;
            (*(void (__fastcall **)(__int64, char *, __int64))(*(_QWORD *)v26 + 464LL))(v26, &v29, v13);
            (*(void (__fastcall **)(__int64))(*(_QWORD *)v13 + 40LL))(v13);
            v11 += 1160LL;
          }
          while ( (signed int)v12 < *(_DWORD *)(*(_QWORD *)(a1 + 16) + 80LL) );
        }
      }
    }
    clock_get_uptime(&v27);
    absolutetime_to_nanoseconds(v27, &v28);
    v14 = ((unsigned __int64)((unsigned __int128)(4835703278458516699LL * (v28 - **(_QWORD **)(a1 + 16))) >> 64) >> 18)
        + 1;
    (*(void (__fastcall **)(__int64, __int64, unsigned __int64, _QWORD))(*(_QWORD *)a1 + 296LL))(
      a1,
      v26,
      (unsigned __int64)((unsigned __int128)(4835703278458516699LL * v28) >> 64) >> 18,
      "ms (Current)");
    (*(void (__fastcall **)(__int64, __int64, _QWORD, _QWORD))(*(_QWORD *)a1 + 296LL))(
      a1,
      v26,
      (unsigned int)v14,
      "ms (since last read)");
    v15 = *(_QWORD *)(a1 + 16);
    *(_QWORD *)v15 = v28;
    (*(void (__fastcall **)(__int64, __int64, _QWORD, _QWORD))(*(_QWORD *)a1 + 296LL))(
      a1,
      v26,
      *(_DWORD *)(v15 + 8),
      "Bytes");
    (*(void (__fastcall **)(__int64, __int64, _QWORD, _QWORD))(*(_QWORD *)a1 + 296LL))(
      a1,
      v26,
      (unsigned int)(*(_DWORD *)(*(_QWORD *)(a1 + 16) + 8LL) - *(_DWORD *)(*(_QWORD *)(a1 + 16) + 16LL)),
      "Bytes (New)");
    v16 = (unsigned int)v14;
    v17 = 0;
    (*(void (__fastcall **)(_QWORD, __int64, _QWORD, _QWORD))(*(_QWORD *)a1 + 296LL))(
      a1,
      v26,
      (unsigned int)((*(_QWORD *)(*(_QWORD *)(a1 + 16) + 8LL) - *(_QWORD *)(*(_QWORD *)(a1 + 16) + 16LL)) / v16),
      "Bytes (New)/ms");
    v18 = *(_QWORD *)(a1 + 16);
    *(_QWORD *)(v18 + 16) = *(_QWORD *)(v18 + 8);
    (*(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 296LL))(
      a1,
      v26,
      *(_DWORD *)(v18 + 36),
      "Timeouts");
    (*(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 296LL))(
      a1,
      v26,
      (unsigned int)(*(_DWORD *)(*(_QWORD *)(a1 + 16) + 36LL) - *(_DWORD *)(*(_QWORD *)(a1 + 16) + 40LL)),
      "Timeouts (New)");
    v19 = *(_QWORD *)(a1 + 16);
    *(_DWORD *)(v19 + 40) = *(_DWORD *)(v19 + 36);
    (*(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 296LL))(
      a1,
      v26,
      *(_DWORD *)(v19 + 44),
      "Resets");
    (*(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 296LL))(
      a1,
      v26,
      (unsigned int)(*(_DWORD *)(*(_QWORD *)(a1 + 16) + 44LL) - *(_DWORD *)(*(_QWORD *)(a1 + 16) + 48LL)),
      "Resets (New)");
    v20 = *(_QWORD *)(a1 + 16);
    *(_DWORD *)(v20 + 48) = *(_DWORD *)(v20 + 44);
    v21 = *(unsigned int **)(a1 + 24);
    v2 = off_3B0E0[0];
    if ( v21 )
    {
      v17 = *v21;
      *(_DWORD *)(v20 + 76) = *v21;
    }
    else
    {
      *(_DWORD *)(v20 + 76) = 0;
    }
    (*(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)a1 + 296LL))(a1, v26, v17, "ControlBulkTxOut");
    v22 = (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v26 + 48LL))(v26, v25);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v26 + 40LL))(v26);
  }
  else
  {
    v22 = 0;
  }
  v23 = *(_QWORD *)v2;
  if ( *(_QWORD *)v2 == v30 )
    LOBYTE(v23) = v22;
  return v23;
}
// 0: using guessed type int dword_0;
// C: using guessed type int;
// 3B0E0: using guessed type __int64 off_3B0E0[6];
// 49460: using guessed type int gUSBStackDebugFlags;
// 7E158: using guessed type int __fastcall absolutetime_to_nanoseconds(_QWORD, _QWORD);
// 7E170: using guessed type int __fastcall clock_get_uptime(_QWORD);

//----- (0000000000036C3C) ----------------------------------------------------
int __fastcall AppleUSBDiagnostics::UpdateNumberEntry(AppleUSBDiagnostics *this, OSDictionary *a2, unsigned int a3, const char *a4)
{
  const char *v4; // r14@1
  __int64 v5; // rax@1
  __int64 v6; // rbx@1

  v4 = a4;
  v5 = OSNumber::withNumber((OSNumber *)a3, 0x20uLL, a3);
  v6 = v5;
  if ( v5 )
  {
    (*(void (__fastcall **)(OSDictionary *, const char *, __int64))(*(_QWORD *)a2 + 464LL))(a2, v4, v5);
    LODWORD(v5) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v6 + 40LL))(v6);
  }
  return v5;
}

//----- (0000000000036C90) ----------------------------------------------------
__int64 __fastcall AppleUSBDiagnostics::MetaClass::~MetaClass(AppleUSBDiagnostics::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000036CA0) ----------------------------------------------------
__int64 `global constructor keyed to'_a_19()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(&AppleUSBDiagnostics::gMetaClass, "AppleUSBDiagnostics", off_3B080[0], 40LL);
  result = (__int64)off_48C30;
  AppleUSBDiagnostics::gMetaClass = off_48C30;
  return result;
}
// 3B080: using guessed type _QWORD off_3B080[18];
// 48C30: using guessed type __int64 (__fastcall *off_48C30[2])(AppleUSBDiagnostics::MetaClass *__hidden this);
// 49A18: using guessed type _QWORD AppleUSBDiagnostics::gMetaClass;
// 7D408: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000036CE0) ----------------------------------------------------
__int64 `global destructor keyed to'_a_19()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&AppleUSBDiagnostics::gMetaClass);
}
// 49A18: using guessed type _QWORD AppleUSBDiagnostics::gMetaClass;

//----- (0000000000036CF1) ----------------------------------------------------
int _start()
{
  int result; // eax@2

  if ( _realmain )
    result = _realmain();
  else
    result = 0;
  return result;
}
// 49A40: using guessed type int (*_realmain)(void);

//----- (0000000000036D0B) ----------------------------------------------------
__int64 *OSKextGetCurrentIdentifier()
{
  return &kmod_info + 2;
}
// 49360: using guessed type __int64 kmod_info;

//----- (0000000000036D1C) ----------------------------------------------------
__int64 *OSKextGetCurrentVersionString()
{
  return &kmod_info + 10;
}
// 49360: using guessed type __int64 kmod_info;

//----- (0000000000036D2D) ----------------------------------------------------
__int64 OSKextGetCurrentLoadTag()
{
  return *((_DWORD *)&kmod_info + 3);
}
// 49360: using guessed type __int64 kmod_info;

//----- (0000000000036D3D) ----------------------------------------------------
int _stop()
{
  int result; // eax@2

  if ( _antimain )
    result = _antimain();
  else
    result = 0;
  return result;
}
// 49A48: using guessed type int (*_antimain)(void);

// ALL OK, 1424 function(s) have been successfully decompiled
