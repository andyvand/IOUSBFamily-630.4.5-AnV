/* This file has been generated by the Hex-Rays decompiler.
   Copyright (c) 2007-2014 Hex-Rays <info@hex-rays.com>

   Detected compiler: GNU C++
*/

#include <defs.h>


//-------------------------------------------------------------------------
// Function declarations

__int64 __fastcall IOUSBHIDDriver::MetaClass::MetaClass(IOUSBHIDDriver::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBHIDDriver::MetaClass::~MetaClass(IOUSBHIDDriver::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBHIDDriver::IOUSBHIDDriver(__int64 a1);
__int64 __fastcall IOUSBHIDDriver::IOUSBHIDDriver(__int64 a1);
__int64 __fastcall IOUSBHIDDriver::~IOUSBHIDDriver(IOUSBHIDDriver *__hidden this); // idb
__int64 __fastcall IOUSBHIDDriver::~IOUSBHIDDriver(IOUSBHIDDriver *__hidden this); // idb
void __fastcall IOUSBHIDDriver::~IOUSBHIDDriver(IOUSBHIDDriver *this);
__int64 __fastcall IOUSBHIDDriver::getMetaClass(IOUSBHIDDriver *__hidden this); // idb
__int64 __fastcall IOUSBHIDDriver::MetaClass::MetaClass(IOUSBHIDDriver::MetaClass *__hidden this); // idb
__int64 __fastcall IOUSBHIDDriver::MetaClass::alloc(IOUSBHIDDriver::MetaClass *this, unsigned __int64 a2);
__int64 __fastcall IOUSBHIDDriver::IOUSBHIDDriver(__int64 a1);
__int64 __fastcall IOUSBHIDDriver::IOUSBHIDDriver(__int64 a1);
char __fastcall IOUSBHIDDriver::init(__int64 a1);
int __fastcall IOUSBHIDDriver::stop(IOUSBHIDDriver *this, IOService *a2);
int __fastcall IOUSBHIDDriver::free(IOUSBHIDDriver *this);
char __fastcall IOUSBHIDDriver::start(IOUSBHIDDriver *this, IOService *a2);
int __fastcall IOUSBHIDDriver::SetProtocol(IOUSBHIDDriver *this, __int16 a2);
int __fastcall IOUSBHIDDriver::CheckForDeadDeviceEntry(IOUSBHIDDriver *this, OSObject *a2);
int __fastcall IOUSBHIDDriver::ClearFeatureEndpointHaltEntry(IOUSBHIDDriver *this, OSObject *a2);
// int __usercall IOUSBHIDDriver::HandleReportEntry@<eax>(IOUSBHIDDriver *this@<rdi>, OSObject *a2@<rsi>, void *a3@<rdx>, unsigned __int64 a4@<rax>);
__int64 __fastcall IOUSBHIDDriver::message(IOUSBHIDDriver *this, __int64 a2, IOService *a3, void *a4);
int __fastcall IOUSBHIDDriver::willTerminate(IOUSBHIDDriver *this, IOService *a2, unsigned int a3);
int __fastcall IOUSBHIDDriver::didTerminate(IOUSBHIDDriver *this, IOService *a2, unsigned int a3, bool *a4);
__int64 __fastcall IOUSBHIDDriver::maxCapabilityForDomainState(IOUSBHIDDriver *this);
__int64 __fastcall IOUSBHIDDriver::powerStateWillChangeTo(IOUSBHIDDriver *this, uintptr_t arg2, uintptr_t arg2, uintptr_t arg4); // idb
__int64 __fastcall IOUSBHIDDriver::setPowerState(IOUSBHIDDriver *this, uintptr_t arg2, uintptr_t arg3); // idb
__int64 __fastcall IOUSBHIDDriver::powerStateDidChangeTo(IOUSBHIDDriver *this, uintptr_t arg2, uintptr_t arg3, uintptr_t arg4); // idb
void __fastcall IOUSBHIDDriver::powerChangeDone(IOUSBHIDDriver *this, uintptr_t arg2);
// char __usercall IOUSBHIDDriver::handleStart@<al>(uintptr_t arg1@<rdi>, uintptr_t arg2@<rsi>, __int64 a3@<rax>);
int __fastcall IOUSBHIDDriver::handleStop(IOUSBHIDDriver *this, IOService *a2);
__int64 __fastcall IOUSBHIDDriver::getReport(uintptr_t arg1, uintptr_t a2, unsigned int a3, unsigned int a4);
__int64 __fastcall IOUSBHIDDriver::setReport(uintptr_t arg1, uintptr_t a2, unsigned int a3, unsigned int a4);
__int64 __fastcall IOUSBHIDDriver::newLocationIDNumber(IOUSBHIDDriver *__hidden this); // idb
__int64 __fastcall IOUSBHIDDriver::newManufacturerString(IOUSBHIDDriver *this); // idb
int __fastcall IOUSBHIDDriver::GetIndexedString(IOUSBHIDDriver *this, unsigned __int8 a2, unsigned __int8 *a3, unsigned int *a4, signed __int16 a5);
__int64 __fastcall IOUSBHIDDriver::newProductIDNumber(IOUSBHIDDriver *this, __int64 a2, unsigned int a3);
__int64 __fastcall IOUSBHIDDriver::newProductString(IOUSBHIDDriver *this); // idb
// __int64 __usercall IOUSBHIDDriver::newReportDescriptor@<rax>(IOUSBHIDDriver *this@<rdi>, IOMemoryDescriptor **a2@<rsi>, __int64 a3@<rax>);
int __fastcall IOUSBHIDDriver::GetHIDDescriptor(IOUSBHIDDriver *this, unsigned __int8 a2, int a3, unsigned __int8 *a4, unsigned int *a5);
__int64 __fastcall IOUSBHIDDriver::newSerialNumberString(IOUSBHIDDriver *this); // idb
__int64 __fastcall IOUSBHIDDriver::newTransportString(IOUSBHIDDriver *this, const char *a2);
__int64 __fastcall IOUSBHIDDriver::newVendorIDNumber(IOUSBHIDDriver *this, __int64 a2, unsigned int a3);
__int64 __fastcall IOUSBHIDDriver::newVersionNumber(IOUSBHIDDriver *this, __int64 a2, unsigned int a3);
__int64 __fastcall IOUSBHIDDriver::newCountryCodeNumber(IOUSBHIDDriver *__hidden this); // idb
__int64 __fastcall IOUSBHIDDriver::newReportIntervalNumber(IOUSBHIDDriver *this, __int64 a2, unsigned int a3);
int __fastcall IOUSBHIDDriver::InterruptReadHandlerEntry(IOUSBHIDDriver *this, OSObject *a2, void *a3, unsigned int a4);
void __fastcall IOUSBHIDDriver::InterruptReadHandler(IOUSBHIDDriver *this, uintptr_t a2, unsigned int a3, __int64 a4);
int __fastcall IOUSBHIDDriver::InterruptReadHandlerWithTimeStampEntry(IOUSBHIDDriver *this, OSObject *a2, void *a3, unsigned int a4, __int64 a5);
// void __usercall IOUSBHIDDriver::CheckForDeadDevice(uintptr_t arg1@<rdi>, __int64 a2@<rax>);
void __fastcall IOUSBHIDDriver::ClearFeatureEndpointHalt(uintptr_t arg1);
int __fastcall IOUSBHIDDriver::HandleReport(IOUSBHIDDriver *this);
int __fastcall IOUSBHIDDriver::SuspendPortTimer(__int64 a1, __int64 a2);
int __fastcall IOUSBHIDDriver::AbortAndSuspend(uintptr_t arg1, char a2);
__int64 __fastcall IOUSBHIDDriver::getMaxReportSize(IOUSBHIDDriver *__hidden this); // idb
__int64 __fastcall IOUSBHIDDriver::newIndexedString(IOUSBHIDDriver *this, const char *a2);
__int64 __fastcall IOUSBHIDDriver::StartFinalProcessing(IOUSBHIDDriver *__hidden this); // idb
int __fastcall IOUSBHIDDriver::SetIdleMillisecs(IOUSBHIDDriver *this, __int16 a2);
__int64 __fastcall IOUSBHIDDriver::SuspendPort(IOUSBHIDDriver *this, char a2, unsigned int a3);
char __fastcall IOUSBHIDDriver::IsPortSuspended(IOUSBHIDDriver *this);
__int64 __fastcall IOUSBHIDDriver::ClaimPendingRead(IOUSBHIDDriver *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6);
__int64 __fastcall IOUSBHIDDriver::ChangeOutstandingIO(IOUSBHIDDriver *__hidden this, OSObject *, void *, void *, void *, void *); // idb
int __fastcall IOUSBHIDDriver::DecrementOutstandingIO(IOUSBHIDDriver *this);
int __fastcall IOUSBHIDDriver::IncrementOutstandingIO(IOUSBHIDDriver *this);
__int64 __fastcall IOUSBHIDDriver::LogMemReport(IOUSBHIDDriver *this, __int64 a2, IOMemoryDescriptor *a3, unsigned __int64 a4);
__int64 __fastcall IOUSBHIDDriver::GetHexChar(IOUSBHIDDriver *__hidden this, char); // idb
void __fastcall IOUSBHIDDriver::processPacket(IOUSBHIDDriver *this, void *a2);
__int64 __fastcall IOUSBHIDDriver::GetReport(IOUSBHIDDriver *this, __int64 a2, __int64 a3, unsigned __int8 *a4, unsigned int *a5);
__int64 __fastcall IOUSBHIDDriver::SetReport(IOUSBHIDDriver *this, __int64 a2, __int64 a3, unsigned __int8 *a4);
__int64 __fastcall IOUSBHIDDriver::RearmInterruptRead(IOUSBHIDDriver *this); // idb
__int64 __fastcall IOUSBHIDDriver::InitializeUSBHIDPowerManagement(IOUSBHIDDriver *this, IOService *); // idb
__int64 __fastcall IOUSBHIDDriver::_RESERVEDIOUSBHIDDriver5(IOUSBHIDDriver *__hidden this); // idb
__int64 __fastcall IOUSBHIDDriver::_RESERVEDIOUSBHIDDriver6(IOUSBHIDDriver *__hidden this); // idb
__int64 __fastcall IOUSBHIDDriver::_RESERVEDIOUSBHIDDriver7(IOUSBHIDDriver *__hidden this); // idb
__int64 __fastcall IOUSBHIDDriver::_RESERVEDIOUSBHIDDriver8(IOUSBHIDDriver *__hidden this); // idb
__int64 __fastcall IOUSBHIDDriver::_RESERVEDIOUSBHIDDriver9(IOUSBHIDDriver *__hidden this); // idb
__int64 __fastcall IOUSBHIDDriver::_RESERVEDIOUSBHIDDriver10(IOUSBHIDDriver *__hidden this); // idb
__int64 __fastcall IOUSBHIDDriver::_RESERVEDIOUSBHIDDriver11(IOUSBHIDDriver *__hidden this); // idb
__int64 __fastcall IOUSBHIDDriver::_RESERVEDIOUSBHIDDriver12(IOUSBHIDDriver *__hidden this); // idb
__int64 __fastcall IOUSBHIDDriver::_RESERVEDIOUSBHIDDriver13(IOUSBHIDDriver *__hidden this); // idb
__int64 __fastcall IOUSBHIDDriver::_RESERVEDIOUSBHIDDriver14(IOUSBHIDDriver *__hidden this); // idb
__int64 __fastcall IOUSBHIDDriver::_RESERVEDIOUSBHIDDriver15(IOUSBHIDDriver *__hidden this); // idb
__int64 __fastcall IOUSBHIDDriver::_RESERVEDIOUSBHIDDriver16(IOUSBHIDDriver *__hidden this); // idb
__int64 __fastcall IOUSBHIDDriver::_RESERVEDIOUSBHIDDriver17(IOUSBHIDDriver *__hidden this); // idb
__int64 __fastcall IOUSBHIDDriver::_RESERVEDIOUSBHIDDriver18(IOUSBHIDDriver *__hidden this); // idb
__int64 __fastcall IOUSBHIDDriver::_RESERVEDIOUSBHIDDriver19(IOUSBHIDDriver *__hidden this); // idb
__int64 __fastcall IOUSBHIDDriver::MetaClass::~MetaClass(IOUSBHIDDriver::MetaClass *__hidden this); // idb
__int64 `global constructor keyed to'_a();
__int64 `global destructor keyed to'_a();
int _start();
__int64 *OSKextGetCurrentIdentifier();
__int64 *OSKextGetCurrentVersionString();
__int64 OSKextGetCurrentLoadTag();
int _stop();
// int __fastcall IOFree(_QWORD, _QWORD); weak
// int __fastcall IOMalloc(_QWORD); weak
// int __fastcall IOSleep(_QWORD); weak
// int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD); weak
// int __fastcall OSCompareAndSwap(_QWORD, _QWORD, _QWORD); weak
// int __cdecl IOHIDDevice::IOHIDDevice(_QWORD); weak
// _QWORD __cdecl IOHIDDevice::~IOHIDDevice(IOHIDDevice *__hidden this); idb
// int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD); weak
// _QWORD __cdecl OSMetaClass::~OSMetaClass(OSMetaClass *__hidden this); idb
// _QWORD __cdecl IOCommandGate::commandGate(IOCommandGate *__hidden this, OSObject *, int (__cdecl *)(OSObject *, void *, void *, void *, void *)); idb
// _QWORD IORegistryEntry::getRegistryEntryID(IORegistryEntry *__hidden this); idb
// int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD); weak
// _QWORD __cdecl IOMemoryDescriptor::withAddress(IOMemoryDescriptor *__hidden this, void *, unsigned __int64, unsigned int); idb
// int __fastcall IOTimerEventSource::timerEventSource(_QWORD, _QWORD); weak
// _QWORD __cdecl IOBufferMemoryDescriptor::withCapacity(IOBufferMemoryDescriptor *__hidden this, unsigned __int64, unsigned int, bool); idb
// _QWORD __cdecl OSNumber::withNumber(OSNumber *__hidden this, unsigned __int64, unsigned int); idb
// void __cdecl OSObject::operator delete(void *); idb
// _QWORD __cdecl OSObject::operator new(OSObject *__hidden this, unsigned __int64); idb
// _QWORD __cdecl OSString::withCString(OSString *__hidden this, const char *); idb
// _QWORD IOService::makeUsable(IOService *__hidden this); idb
// _QWORD __cdecl OSMetaClass::reservedCalled(OSMetaClass *__hidden this, int); idb
// _QWORD OSMetaClass::instanceConstructed(OSMetaClass *__hidden this); idb
// _QWORD IOService::isInactive(IOService *__hidden this); idb
// int __fastcall absolutetime_to_nanoseconds(_QWORD, _QWORD); weak
// void __cdecl bzero(void *, size_t);
// void __cdecl kernel_debug(uint32_t debugid, uintptr_t arg1, uintptr_t arg2, uintptr_t arg3, uintptr_t arg4, uintptr_t arg5);
// uint64_t mach_absolute_time(void);
// void *__cdecl memcpy(void *, const void *, size_t);
// size_t __cdecl strlcpy(char *, const char *, size_t);
// size_t __cdecl strlen(const char *);
// int __fastcall thread_call_allocate(_QWORD, _QWORD); weak
// int thread_call_cancel(void); weak
// int __fastcall thread_call_enter(_QWORD); weak
// int __fastcall thread_call_enter1(_QWORD, _QWORD); weak
// int __fastcall thread_call_free(_QWORD); weak

//-------------------------------------------------------------------------
// Data declarations

int dword_0 = 4277009103; // weak
int dword_18 = 133; // weak
segment_command_64 stru_158 = { 25u, 552u, "__DATA", 24576uLL, 4096uLL, 24576uLL, 4096uLL, 7, 3, 6u, 0u }; // weak
__int64 qword_5FF0[2] = { 3978425819141910832LL, 5063528411713059128LL }; // weak
_QWORD *off_6000[10] =
{
  &IOHIDDevice::gMetaClass,
  &IOUSBInterface::metaClass,
  &IOUSBController::_log,
  &IOBufferMemoryDescriptor::metaClass,
  &OSNumber::metaClass,
  &`vtable for'IOHIDDevice,
  &__stack_chk_guard,
  &gUSBStackDebugFlags,
  &kOSBooleanTrue,
  &kdebug_enable
}; // weak
_QWORD *off_6008[9] =
{
  &IOUSBInterface::metaClass,
  &IOUSBController::_log,
  &IOBufferMemoryDescriptor::metaClass,
  &OSNumber::metaClass,
  &`vtable for'IOHIDDevice,
  &__stack_chk_guard,
  &gUSBStackDebugFlags,
  &kOSBooleanTrue,
  &kdebug_enable
}; // weak
_QWORD *off_6010[8] =
{
  &IOUSBController::_log,
  &IOBufferMemoryDescriptor::metaClass,
  &OSNumber::metaClass,
  &`vtable for'IOHIDDevice,
  &__stack_chk_guard,
  &gUSBStackDebugFlags,
  &kOSBooleanTrue,
  &kdebug_enable
}; // weak
_QWORD *off_6018[7] =
{
  &IOBufferMemoryDescriptor::metaClass,
  &OSNumber::metaClass,
  &`vtable for'IOHIDDevice,
  &__stack_chk_guard,
  &gUSBStackDebugFlags,
  &kOSBooleanTrue,
  &kdebug_enable
}; // weak
_QWORD *off_6020[6] =
{
  &OSNumber::metaClass,
  &`vtable for'IOHIDDevice,
  &__stack_chk_guard,
  &gUSBStackDebugFlags,
  &kOSBooleanTrue,
  &kdebug_enable
}; // weak
__int64 *off_6028[5] =
{
  &`vtable for'IOHIDDevice,
  &__stack_chk_guard,
  &gUSBStackDebugFlags,
  &kOSBooleanTrue,
  &kdebug_enable
}; // weak
__int64 *off_6030[4] = { &__stack_chk_guard, &gUSBStackDebugFlags, &kOSBooleanTrue, &kdebug_enable }; // weak
__int64 *off_6038[3] = { &gUSBStackDebugFlags, &kOSBooleanTrue, &kdebug_enable }; // weak
__int64 *off_6040[2] = { &kOSBooleanTrue, &kdebug_enable }; // weak
__int64 *off_6048 = &kdebug_enable; // weak
size_t off_6050 = 69112uLL; // idb
__int64 (__fastcall *off_6090[2])(IOUSBHIDDriver *__hidden this) = { &IOUSBHIDDriver::~IOUSBHIDDriver, &IOUSBHIDDriver::~IOUSBHIDDriver }; // weak
__int64 (__fastcall *off_6BC0[2])(IOUSBHIDDriver::MetaClass *__hidden this) =
{
  &IOUSBHIDDriver::MetaClass::~MetaClass,
  &IOUSBHIDDriver::MetaClass::~MetaClass
}; // weak
_QWORD ourPowerStates = 1LL; // weak
__int64 kmod_info = 0LL; // weak
_QWORD IOUSBHIDDriver::gMetaClass; // weak
int (*_realmain)(void); // weak
int (*_antimain)(void); // weak


//----- (00000000000013D0) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::MetaClass::MetaClass(IOUSBHIDDriver::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBHIDDriver", off_6000[0], 352LL);
  result = (__int64)off_6BC0;
  *(_QWORD *)this = off_6BC0;
  return result;
}
// 6000: using guessed type _QWORD *off_6000[10];
// 6BC0: using guessed type __int64 (__fastcall *off_6BC0[2])(IOUSBHIDDriver::MetaClass *__hidden this);
// 104D0: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000001402) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::MetaClass::~MetaClass(IOUSBHIDDriver::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (000000000000140C) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::IOUSBHIDDriver(__int64 a1)
{
  __int64 result; // rax@1

  IOHIDDevice::IOHIDDevice(a1);
  result = (__int64)off_6090;
  *(_QWORD *)a1 = off_6090;
  return result;
}
// 6090: using guessed type __int64 (__fastcall *off_6090[2])(IOUSBHIDDriver *__hidden this);
// 10480: using guessed type int __cdecl IOHIDDevice::IOHIDDevice(_QWORD);

//----- (000000000000142C) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::IOUSBHIDDriver(__int64 a1)
{
  __int64 result; // rax@1

  IOHIDDevice::IOHIDDevice(a1);
  result = (__int64)off_6090;
  *(_QWORD *)a1 = off_6090;
  return result;
}
// 6090: using guessed type __int64 (__fastcall *off_6090[2])(IOUSBHIDDriver *__hidden this);
// 10480: using guessed type int __cdecl IOHIDDevice::IOHIDDevice(_QWORD);

//----- (000000000000144C) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::~IOUSBHIDDriver(IOUSBHIDDriver *this)
{
  return IOHIDDevice::~IOHIDDevice(this);
}

//----- (0000000000001456) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::~IOUSBHIDDriver(IOUSBHIDDriver *this)
{
  return IOHIDDevice::~IOHIDDevice(this);
}

//----- (0000000000001460) ----------------------------------------------------
void __fastcall IOUSBHIDDriver::~IOUSBHIDDriver(IOUSBHIDDriver *this)
{
  IOHIDDevice::~IOHIDDevice(this);
  OSObject::operator delete((void *)this);
}

//----- (0000000000001482) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::getMetaClass(IOUSBHIDDriver *this)
{
  return (__int64)&IOUSBHIDDriver::gMetaClass;
}
// 6F48: using guessed type _QWORD IOUSBHIDDriver::gMetaClass;

//----- (0000000000001490) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::MetaClass::MetaClass(IOUSBHIDDriver::MetaClass *this)
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(this, "IOUSBHIDDriver", off_6000[0], 352LL);
  result = (__int64)off_6BC0;
  *(_QWORD *)this = off_6BC0;
  return result;
}
// 6000: using guessed type _QWORD *off_6000[10];
// 6BC0: using guessed type __int64 (__fastcall *off_6BC0[2])(IOUSBHIDDriver::MetaClass *__hidden this);
// 104D0: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (00000000000014C2) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::MetaClass::alloc(IOUSBHIDDriver::MetaClass *this, unsigned __int64 a2)
{
  __int64 v2; // rbx@1

  v2 = OSObject::operator new((OSObject *)stru_158.segname, a2);
  IOHIDDevice::IOHIDDevice(v2);
  *(_QWORD *)v2 = off_6090;
  OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBHIDDriver::gMetaClass);
  return v2;
}
// 158: using guessed type segment_command_64;
// 6090: using guessed type __int64 (__fastcall *off_6090[2])(IOUSBHIDDriver *__hidden this);
// 6F48: using guessed type _QWORD IOUSBHIDDriver::gMetaClass;
// 10480: using guessed type int __cdecl IOHIDDevice::IOHIDDevice(_QWORD);

//----- (0000000000001502) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::IOUSBHIDDriver(__int64 a1)
{
  IOHIDDevice::IOHIDDevice(a1);
  *(_QWORD *)a1 = off_6090;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBHIDDriver::gMetaClass);
}
// 6090: using guessed type __int64 (__fastcall *off_6090[2])(IOUSBHIDDriver *__hidden this);
// 6F48: using guessed type _QWORD IOUSBHIDDriver::gMetaClass;
// 10480: using guessed type int __cdecl IOHIDDevice::IOHIDDevice(_QWORD);

//----- (0000000000001532) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::IOUSBHIDDriver(__int64 a1)
{
  IOHIDDevice::IOHIDDevice(a1);
  *(_QWORD *)a1 = off_6090;
  return OSMetaClass::instanceConstructed((OSMetaClass *)&IOUSBHIDDriver::gMetaClass);
}
// 6090: using guessed type __int64 (__fastcall *off_6090[2])(IOUSBHIDDriver *__hidden this);
// 6F48: using guessed type _QWORD IOUSBHIDDriver::gMetaClass;
// 10480: using guessed type int __cdecl IOHIDDevice::IOHIDDevice(_QWORD);

//----- (0000000000001562) ----------------------------------------------------
char __fastcall IOUSBHIDDriver::init(__int64 a1)
{
  __int64 v1; // rax@2
  void *v2; // rax@3

  if ( (unsigned __int8)(*((int (__cdecl **)(_QWORD))off_6028[0] + 75))(a1) )
  {
    v1 = *(_QWORD *)(a1 + 344);
    if ( v1 )
    {
LABEL_5:
      *(_DWORD *)(v1 + 132) = 3;
      *(_DWORD *)(a1 + 272) = 3;
      *(_DWORD *)(a1 + 232) = 256;
      *(_BYTE *)(v1 + 82) = 7;
      *(_DWORD *)(v1 + 128) = 5000;
      return 1;
    }
    LODWORD(v2) = IOMalloc(144LL);
    *(_QWORD *)(a1 + 344) = v2;
    if ( v2 )
    {
      bzero(v2, 0x90uLL);
      v1 = *(_QWORD *)(a1 + 344);
      *(_DWORD *)(v1 + 136) = 1601203322;
      *(_DWORD *)(v1 + 140) = 0;
      goto LABEL_5;
    }
  }
  return 0;
}
// 6028: using guessed type __int64 *off_6028[5];
// 102E8: using guessed type int __fastcall IOMalloc(_QWORD);

//----- (0000000000001600) ----------------------------------------------------
int __fastcall IOUSBHIDDriver::stop(IOUSBHIDDriver *this, IOService *a2)
{
  IOUSBHIDDriver *v2; // rbx@1
  __int64 v3; // rax@1
  __int64 v4; // rdi@1

  v2 = this;
  v3 = *((_QWORD *)this + 43);
  v4 = *(_QWORD *)v3;
  if ( *(_QWORD *)v3 )
  {
    if ( !*((_QWORD *)v2 + 38)
      || ((*(void (**)(void))(*(_QWORD *)v4 + 328LL))(), v3 = *((_QWORD *)v2 + 43), (v4 = *(_QWORD *)v3) != 0) )
    {
      if ( *(_QWORD *)(v3 + 64) )
        (*(void (**)(void))(*(_QWORD *)v4 + 328LL))();
    }
  }
  return (*(int (__fastcall **)(IOUSBHIDDriver *, IOService *))((int (__fastcall **)(_QWORD, _QWORD))off_6028[0] + 187))(
           v2,
           a2);
}
// 6028: using guessed type __int64 *off_6028[5];

//----- (000000000000166A) ----------------------------------------------------
int __fastcall IOUSBHIDDriver::free(IOUSBHIDDriver *this)
{
  IOUSBHIDDriver *v1; // rbx@1
  __int64 v2; // rdi@1
  __int64 v3; // rdi@3
  __int64 v4; // rdi@5
  __int64 v5; // rdi@7
  __int64 v6; // rdi@9
  __int64 v7; // rdi@11
  __int64 v8; // rdi@13
  __int64 v9; // rax@14

  v1 = this;
  v2 = *((_QWORD *)this + 28);
  if ( v2 )
  {
    (*(void (__cdecl **)(__int64))(*(_QWORD *)v2 + 40LL))(v2);
    *((_QWORD *)v1 + 28) = 0LL;
  }
  v3 = *((_QWORD *)v1 + 39);
  if ( v3 )
  {
    (*(void (__cdecl **)(__int64))(*(_QWORD *)v3 + 40LL))(v3);
    *((_QWORD *)v1 + 39) = 0LL;
  }
  v4 = *((_QWORD *)v1 + 26);
  if ( v4 )
  {
    (*(void (__cdecl **)(__int64))(*(_QWORD *)v4 + 40LL))(v4);
    *((_QWORD *)v1 + 26) = 0LL;
  }
  v5 = *((_QWORD *)v1 + 27);
  if ( v5 )
  {
    (*(void (__cdecl **)(__int64))(*(_QWORD *)v5 + 40LL))(v5);
    *((_QWORD *)v1 + 27) = 0LL;
  }
  v6 = *((_QWORD *)v1 + 38);
  if ( v6 )
  {
    (*(void (__cdecl **)(__int64))(*(_QWORD *)v6 + 40LL))(v6);
    *((_QWORD *)v1 + 38) = 0LL;
  }
  v7 = *((_QWORD *)v1 + 30);
  if ( v7 )
  {
    (*(void (__cdecl **)(__int64))(*(_QWORD *)v7 + 40LL))(v7);
    *((_QWORD *)v1 + 30) = 0LL;
  }
  v8 = *((_QWORD *)v1 + 43);
  if ( v8 )
  {
    v9 = *(_QWORD *)(v8 + 64);
    if ( v9 )
    {
      (*(void (__fastcall **)(_QWORD))(*(_QWORD *)v9 + 40LL))(*(_QWORD *)(v8 + 64));
      v8 = *((_QWORD *)v1 + 43);
      *(_QWORD *)(v8 + 64) = 0LL;
      *(_DWORD *)(v8 + 76) = 0;
    }
    if ( *(_QWORD *)v8 )
    {
      (*(void (__fastcall **)(_QWORD))(**(_QWORD **)v8 + 40LL))(*(_QWORD *)v8);
      v8 = *((_QWORD *)v1 + 43);
      *(_QWORD *)v8 = 0LL;
    }
    IOFree(v8, 144LL);
    *((_QWORD *)v1 + 43) = 0LL;
  }
  return (*(int (__fastcall **)(IOUSBHIDDriver *))((int (__fastcall **)(_QWORD))off_6028[0] + 20))(v1);
}
// 6028: using guessed type __int64 *off_6028[5];
// 102E0: using guessed type int __fastcall IOFree(_QWORD, _QWORD);

//----- (00000000000017A0) ----------------------------------------------------
char __fastcall IOUSBHIDDriver::start(IOUSBHIDDriver *this, IOService *a2)
{
  IOService *v2; // r12@1
  uintptr_t v3; // r13@1
  __int64 v4; // rax@5
  __int64 v5; // rbx@5
  __int64 v6; // rsi@5
  __int64 v7; // rax@5
  IOUSBHIDDriver *v8; // rsi@9
  int (__cdecl *v9)(OSObject *, void *, void *, void *, void *); // rdx@9
  IOUSBHIDDriver *v10; // r14@10
  __int64 v11; // rax@11
  __int64 v12; // r15@11
  __int64 *v13; // rbx@13
  char v14; // r12@15
  uintptr_t v15; // r8@15
  uintptr_t v16; // r8@18
  __int64 v17; // rdi@34
  __int64 v18; // rdi@36
  __int64 v19; // rdi@38
  __int64 v20; // rdi@40
  __int64 v21; // rdi@42
  __int64 v22; // rdi@44
  __int64 v23; // rdi@46
  char result; // al@48
  __int64 v25; // rax@53
  __int64 v26; // rbx@53
  __int64 v27; // rax@53
  int v28; // ecx@53
  __int64 v29; // rax@56
  __int64 v30; // rdi@56
  int v31; // ebx@56
  unsigned __int16 v32; // ax@58
  __int64 v33; // rax@60
  __int64 v34; // rdi@65
  __int64 v35; // rax@67
  __int64 v36; // rbx@67
  __int64 v37; // rax@68
  __int64 v38; // rax@72
  __int64 v39; // rbx@72
  __int64 v40; // rax@73
  signed __int64 v41; // rsi@83
  __int64 v42; // rax@86
  __int64 v43; // rax@91
  __int64 v44; // rax@91
  __int64 v45; // rax@91
  __int64 v46; // rax@94
  __int64 v47; // rbx@94
  __int64 v48; // rax@94
  char v49; // al@95
  __int64 v50; // rcx@95
  __int64 v51; // rax@99
  __int64 v52; // rax@102
  void (__fastcall *v53)(_QWORD, _QWORD, _QWORD, _QWORD); // rbx@104
  unsigned __int16 v54; // ax@104
  int v55; // eax@105
  int v56; // ecx@105
  unsigned __int8 v57; // bl@111
  unsigned __int16 v58; // ax@111
  int v59; // eax@113
  __int64 *v60; // rbx@113
  int v61; // eax@117
  __int64 v62; // [sp+0h] [bp-90h]@69
  __int64 v63; // [sp+0h] [bp-90h]@74
  signed __int64 v64; // [sp+0h] [bp-90h]@89
  IOUSBHIDDriver *v65; // [sp+8h] [bp-88h]@53
  char v66; // [sp+10h] [bp-80h]@87
  char v67; // [sp+11h] [bp-7Fh]@87
  __int16 v68; // [sp+12h] [bp-7Eh]@87
  __int16 v69; // [sp+14h] [bp-7Ch]@87
  __int16 v70; // [sp+16h] [bp-7Ah]@87
  char *v71; // [sp+18h] [bp-78h]@87
  int v72; // [sp+20h] [bp-70h]@87
  char v73; // [sp+28h] [bp-68h]@89
  char v74; // [sp+29h] [bp-67h]@89
  __int16 v75; // [sp+2Ah] [bp-66h]@89
  __int16 v76; // [sp+2Ch] [bp-64h]@89
  __int16 v77; // [sp+2Eh] [bp-62h]@89
  __int64 v78; // [sp+30h] [bp-60h]@89
  char v79; // [sp+40h] [bp-50h]@87
  __int64 v80; // [sp+60h] [bp-30h]@1

  v2 = a2;
  v3 = (uintptr_t)this;
  v80 = *off_6030[0];
  if ( *(_BYTE *)off_6038[0] & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
  {
    a2 = this;
    kernel_debug(0x52D1C05u, (uintptr_t)this, 0LL, 0LL, 0LL, 0LL);
  }
  (*(void (__fastcall **)(IOUSBHIDDriver *, IOService *))(*(_QWORD *)this + 2656LL))(this, a2);
  if ( v2 )
  {
    LODWORD(v4) = (*(int (__fastcall **)(IOService *, _QWORD))(*(_QWORD *)v2 + 744LL))(v2, "locationID");
    v5 = v4;
    v6 = *off_6020[0];
    LODWORD(v7) = OSMetaClassBase::safeMetaCast(v4, *off_6020[0]);
    if ( v7 )
      *((_DWORD *)this + 80) = (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v7 + 328LL))(v7, v6);
    if ( v5 )
      (*(void (__fastcall **)(__int64, __int64))(*(_QWORD *)v5 + 40LL))(v5, v6);
  }
  v8 = v2;
  if ( !(unsigned __int8)(*(int (__fastcall **)(IOUSBHIDDriver *, IOService *))((int (__fastcall **)(_QWORD, _QWORD))off_6028[0]
                                                                              + 186))(
                           this,
                           v2) )
  {
    v10 = 0LL;
    v13 = off_6038[0];
    if ( *(_BYTE *)off_6038[0] & 2 )
    {
      v10 = 0LL;
      if ( *(_DWORD *)off_6048 & 0xFFFFFFF7 )
      {
        v12 = 0LL;
        v16 = 1LL;
LABEL_22:
        v8 = this;
        kernel_debug(0x52D1C04u, (uintptr_t)this, 0LL, 0LL, v16, 0LL);
        v10 = 0LL;
        goto LABEL_24;
      }
    }
LABEL_23:
    v12 = 0LL;
    goto LABEL_24;
  }
  v8 = 0LL;
  v10 = (IOUSBHIDDriver *)IOCommandGate::commandGate(this, 0LL, v9);
  if ( !v10 )
  {
    v10 = 0LL;
    v13 = off_6038[0];
    if ( *(_BYTE *)off_6038[0] & 2 )
    {
      v10 = 0LL;
      if ( *(_DWORD *)off_6048 & 0xFFFFFFF7 )
      {
        v12 = 0LL;
        v16 = 2LL;
        goto LABEL_22;
      }
    }
    goto LABEL_23;
  }
  LODWORD(v11) = (*(int (__fastcall **)(IOUSBHIDDriver *, _QWORD))(*(_QWORD *)this + 1672LL))(this, 0LL);
  v12 = v11;
  if ( !v11 )
    goto LABEL_50;
  (*(void (__fastcall **)(__int64))(*(_QWORD *)v11 + 32LL))(v11);
  v8 = v10;
  if ( (*(int (__fastcall **)(__int64, IOUSBHIDDriver *))(*(_QWORD *)v12 + 320LL))(v12, v10) )
  {
    v13 = off_6038[0];
    if ( !(*(_BYTE *)off_6038[0] & 2) || !(*(_DWORD *)off_6048 & 0xFFFFFFF7) )
      goto LABEL_24;
    v14 = 0;
    v15 = 4LL;
LABEL_109:
    v8 = (IOUSBHIDDriver *)v3;
    kernel_debug(0x52D1C04u, v3, 0LL, 0LL, v15, 0LL);
    goto LABEL_25;
  }
  LODWORD(v25) = (*(int (__fastcall **)(IOUSBHIDDriver *, _QWORD))(*(_QWORD *)this + 744LL))(this, "MaxInputReportSize");
  v26 = v25;
  v8 = (IOUSBHIDDriver *)*off_6020[0];
  v65 = (IOUSBHIDDriver *)*off_6020[0];
  LODWORD(v27) = OSMetaClassBase::safeMetaCast(v25, *off_6020[0]);
  v28 = 0;
  if ( v27 )
    v28 = (*(int (__fastcall **)(__int64))(*(_QWORD *)v27 + 328LL))(v27);
  if ( v26 )
  {
    v29 = *(_QWORD *)v26;
    v30 = v26;
    v31 = v28;
    (*(void (__fastcall **)(__int64))(v29 + 40))(v30);
    v28 = v31;
  }
  if ( !v28 )
  {
    v32 = (*(int (**)(void))(**(_QWORD **)(v3 + 224) + 416LL))();
    if ( !v32 )
    {
      *(_QWORD *)(v3 + 240) = 0LL;
      goto LABEL_65;
    }
    v28 = v32;
  }
  v8 = (IOUSBHIDDriver *)(&dword_0 + 1);
  v33 = IOBufferMemoryDescriptor::withCapacity((IOBufferMemoryDescriptor *)(unsigned int)v28, 1uLL, 0, v28);
  *(_QWORD *)(v3 + 240) = v33;
  if ( !v33 )
  {
    v14 = 1;
    v13 = off_6038[0];
    if ( !(*(_BYTE *)off_6038[0] & 2) || !(*(_DWORD *)off_6048 & 0xFFFFFFF7) )
      goto LABEL_25;
    v15 = 6LL;
    goto LABEL_109;
  }
LABEL_65:
  v34 = *(_QWORD *)(v3 + 312);
  if ( v34 && *(_QWORD *)(v3 + 344) )
  {
    *(_DWORD *)(*(_QWORD *)(v3 + 344) + 140LL) = (unsigned __int16)(*(int (__fastcall **)(__int64, IOUSBHIDDriver *))(*(_QWORD *)v34 + 416LL))(
                                                                     v34,
                                                                     v8);
    LODWORD(v35) = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)v3 + 744LL))(v3, "MaxOutputReportSize");
    v36 = v35;
    if ( v35 )
    {
      LODWORD(v37) = OSMetaClassBase::safeMetaCast(v35, v65);
      if ( v37 )
      {
        v62 = v37;
        if ( (unsigned int)(*(int (__fastcall **)(__int64, IOUSBHIDDriver *))(*(_QWORD *)v37 + 328LL))(v37, v65) > *(_DWORD *)(*(_QWORD *)(v3 + 344) + 140LL) )
          *(_DWORD *)(*(_QWORD *)(v3 + 344) + 140LL) = (*(int (**)(void))(*(_QWORD *)v62 + 328LL))();
      }
      (*(void (__fastcall **)(__int64, IOUSBHIDDriver *))(*(_QWORD *)v36 + 40LL))(v36, v65);
    }
    v8 = (IOUSBHIDDriver *)"MaxFeatureReportSize";
    LODWORD(v38) = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)v3 + 744LL))(v3, "MaxFeatureReportSize");
    v39 = v38;
    if ( v38 )
    {
      v8 = v65;
      LODWORD(v40) = OSMetaClassBase::safeMetaCast(v38, v65);
      if ( v40 )
      {
        v63 = v40;
        if ( (unsigned int)(*(int (__fastcall **)(__int64, IOUSBHIDDriver *))(*(_QWORD *)v40 + 328LL))(v40, v65) > *(_DWORD *)(*(_QWORD *)(v3 + 344) + 140LL) )
          *(_DWORD *)(*(_QWORD *)(v3 + 344) + 140LL) = (*(int (**)(void))(*(_QWORD *)v63 + 328LL))();
      }
      (*(void (__fastcall **)(__int64, IOUSBHIDDriver *))(*(_QWORD *)v39 + 40LL))(v39, v65);
    }
  }
  if ( (unsigned __int16)(*(int (__fastcall **)(_QWORD, IOUSBHIDDriver *))(**(_QWORD **)(v3 + 216) + 2288LL))(
                           *(_QWORD *)(v3 + 216),
                           v8) == 1699 )
    (*(void (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)v3 + 2672LL))(v3, 0LL);
  if ( (unsigned __int8)(*(int (**)(void))(**(_QWORD **)(v3 + 208) + 2248LL))() == 3
    && (unsigned __int8)(*(int (**)(void))(**(_QWORD **)(v3 + 208) + 2256LL))() == 1
    && (unsigned __int8)(*(int (**)(void))(**(_QWORD **)(v3 + 208) + 2264LL))() == 1 )
  {
    if ( (unsigned __int16)(*(int (**)(void))(**(_QWORD **)(v3 + 216) + 2288LL))() == 1452 )
      v41 = 0LL;
    else
      v41 = 24LL;
    (*(void (__fastcall **)(uintptr_t, signed __int64))(*(_QWORD *)v3 + 2672LL))(v3, v41);
  }
  LODWORD(v42) = (*(int (__fastcall **)(IOService *, _QWORD))(*(_QWORD *)v2 + 696LL))(v2, "SIXAXIS compatibility");
  if ( v42 == *(_QWORD *)*off_6040[0] )
  {
    v66 = -95;
    v67 = 1;
    v68 = 1010;
    v69 = (unsigned __int8)(*(int (**)(void))(**(_QWORD **)(v3 + 208) + 2224LL))();
    v70 = 18;
    v71 = &v79;
    v72 = 0;
    (*(void (__fastcall **)(_QWORD, char *, _QWORD, _QWORD, _QWORD))(**(_QWORD **)(v3 + 216) + 2424LL))(
      *(_QWORD *)(v3 + 216),
      &v66,
      *(_DWORD *)(*(_QWORD *)(v3 + 344) + 128LL),
      0LL,
      0LL);
  }
  if ( (unsigned __int8)(*(int (**)(void))(**(_QWORD **)(v3 + 208) + 2256LL))() == 1 )
  {
    v73 = 33;
    v74 = 11;
    v75 = 1;
    v76 = (unsigned __int8)(*(int (**)(void))(**(_QWORD **)(v3 + 208) + 2224LL))();
    v77 = 0;
    v78 = 0LL;
    v64 = v3 + 344;
    (*(void (__fastcall **)(_QWORD, char *, _QWORD, _QWORD, _QWORD))(**(_QWORD **)(v3 + 216) + 2424LL))(
      *(_QWORD *)(v3 + 216),
      &v73,
      *(_DWORD *)(*(_QWORD *)(v3 + 344) + 128LL),
      0LL,
      0LL);
  }
  else
  {
    v64 = v3 + 344;
  }
  LODWORD(v43) = thread_call_allocate(IOUSBHIDDriver::CheckForDeadDeviceEntry, v3);
  *(_QWORD *)(v3 + 280) = v43;
  LODWORD(v44) = thread_call_allocate(IOUSBHIDDriver::ClearFeatureEndpointHaltEntry, v3);
  *(_QWORD *)(v3 + 288) = v44;
  v8 = (IOUSBHIDDriver *)v3;
  LODWORD(v45) = thread_call_allocate(IOUSBHIDDriver::HandleReportEntry, v3);
  *(_QWORD *)(*(_QWORD *)(v3 + 344) + 8LL) = v45;
  if ( !*(_QWORD *)(v3 + 280) || !*(_QWORD *)(v3 + 288) || !v45 )
  {
    v14 = 1;
    v13 = off_6038[0];
    if ( !(*(_BYTE *)off_6038[0] & 2) || !(*(_DWORD *)off_6048 & 0xFFFFFFF7) )
      goto LABEL_25;
    v15 = 7LL;
    goto LABEL_109;
  }
  *(_BYTE *)(*(_QWORD *)(v3 + 344) + 80LL) = (*(int (**)(void))(**(_QWORD **)(v3 + 208) + 2224LL))();
  LODWORD(v46) = (*(int (__fastcall **)(IOService *, _QWORD))(*(_QWORD *)v2 + 744LL))(
                   v2,
                   "USB HID Report Logging Level");
  v47 = v46;
  LODWORD(v48) = OSMetaClassBase::safeMetaCast(v46, v65);
  if ( v48 )
  {
    v49 = (*(int (__fastcall **)(__int64, IOUSBHIDDriver *))(*(_QWORD *)v48 + 328LL))(v48, v65);
    v50 = *(_QWORD *)v64;
    *(_BYTE *)(v50 + 82) = v49;
    *(_BYTE *)(v50 + 81) = 1;
  }
  else
  {
    v51 = *(_QWORD *)v64;
    *(_BYTE *)(v51 + 82) = 7;
    *(_BYTE *)(v51 + 81) = 0;
  }
  if ( v47 )
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v47 + 40LL))(v47);
  v8 = (IOUSBHIDDriver *)"idProduct";
  LODWORD(v52) = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)v3 + 744LL))(v3, "idProduct");
  if ( v52 )
  {
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v52 + 40LL))(v52);
  }
  else
  {
    v53 = *(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v3 + 640LL);
    v54 = (*(int (**)(void))(**(_QWORD **)(v3 + 216) + 2296LL))();
    v8 = (IOUSBHIDDriver *)"idProduct";
    v53(v3, "idProduct", v54, 32LL);
  }
  v55 = (*(int (__fastcall **)(uintptr_t))(*(_QWORD *)v3 + 2664LL))(v3);
  v56 = *(_DWORD *)off_6038[0] & 2;
  if ( !v55 )
  {
    if ( v56 )
    {
      v57 = (*(int (**)(void))(**(_QWORD **)(v3 + 208) + 2224LL))();
      v58 = (*(int (**)(void))(**(_QWORD **)(v3 + 216) + 2248LL))();
      if ( *(_DWORD *)off_6048 & 0xFFFFFFF7 )
        kernel_debug(0x52D1C04u, v57, v58, *(_DWORD *)(v3 + 320), 0LL, 0LL);
    }
    *(_QWORD *)(v3 + 304) = v10;
    **(_QWORD **)(v3 + 344) = v12;
    v8 = v2;
    v59 = (*(int (__fastcall **)(uintptr_t, IOService *))(*(_QWORD *)v3 + 2712LL))(v3, v2);
    v60 = off_6038[0];
    if ( v59 && *(_BYTE *)off_6038[0] & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
    {
      v8 = (IOUSBHIDDriver *)v3;
      kernel_debug(0x52D1C04u, v3, v59, 0LL, 0xAuLL, 0LL);
    }
    v61 = *(_DWORD *)v60;
    if ( *(_DWORD *)v60 & 2 )
    {
      v8 = (IOUSBHIDDriver *)"this";
      (*(void (__fastcall **)(uintptr_t, _QWORD, uintptr_t, signed __int64))(*(_QWORD *)v3 + 640LL))(
        v3,
        "this",
        v3,
        64LL);
      v61 = *(_DWORD *)v60;
    }
    if ( v61 & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
    {
      v8 = (IOUSBHIDDriver *)v3;
      kernel_debug(0x52D1C06u, v3, 0LL, 0LL, 0LL, 0LL);
    }
    (*(void (__fastcall **)(uintptr_t, IOUSBHIDDriver *))(*(_QWORD *)v3 + 2648LL))(v3, v8);
    result = 1;
    goto LABEL_49;
  }
  v14 = 1;
  if ( v56 )
  {
    v13 = off_6038[0];
    if ( !(*(_DWORD *)off_6048 & 0xFFFFFFF7) )
      goto LABEL_25;
    v15 = 8LL;
    goto LABEL_109;
  }
  v13 = off_6038[0];
  while ( 1 )
  {
LABEL_25:
    if ( *(_BYTE *)v13 & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
    {
      v8 = (IOUSBHIDDriver *)v3;
      kernel_debug(0x52D1C04u, v3, *(_DWORD *)(v3 + 320), 0LL, 9uLL, 0LL);
    }
    if ( v10 )
    {
      if ( v14 )
      {
        v8 = v10;
        (*(void (__fastcall **)(__int64, IOUSBHIDDriver *))(*(_QWORD *)v12 + 328LL))(v12, v10);
      }
      (*(void (__fastcall **)(IOUSBHIDDriver *, IOUSBHIDDriver *))(*(_QWORD *)v10 + 40LL))(v10, v8);
    }
    if ( v12 )
      (*(void (__fastcall **)(__int64, IOUSBHIDDriver *))(*(_QWORD *)v12 + 40LL))(v12, v8);
    v17 = *(_QWORD *)(v3 + 280);
    if ( v17 )
      thread_call_free(v17);
    v18 = *(_QWORD *)(v3 + 288);
    if ( v18 )
      thread_call_free(v18);
    v19 = *(_QWORD *)(*(_QWORD *)(v3 + 344) + 8LL);
    if ( v19 )
      thread_call_free(v19);
    v20 = *(_QWORD *)(v3 + 224);
    if ( v20 )
    {
      (*(void (__fastcall **)(__int64, IOUSBHIDDriver *))(*(_QWORD *)v20 + 40LL))(v20, v8);
      *(_QWORD *)(v3 + 224) = 0LL;
    }
    v21 = *(_QWORD *)(v3 + 312);
    if ( v21 )
    {
      (*(void (__fastcall **)(__int64, IOUSBHIDDriver *))(*(_QWORD *)v21 + 40LL))(v21, v8);
      *(_QWORD *)(v3 + 312) = 0LL;
    }
    v22 = *(_QWORD *)(v3 + 208);
    if ( v22 )
    {
      v8 = (IOUSBHIDDriver *)v3;
      (*(void (__fastcall **)(__int64, uintptr_t, _QWORD))(*(_QWORD *)v22 + 1496LL))(v22, v3, 0LL);
      (*(void (**)(void))(**(_QWORD **)(v3 + 208) + 40LL))();
      *(_QWORD *)(v3 + 208) = 0LL;
    }
    v23 = *(_QWORD *)(v3 + 216);
    if ( v23 )
    {
      (*(void (__fastcall **)(__int64, IOUSBHIDDriver *))(*(_QWORD *)v23 + 40LL))(v23, v8);
      *(_QWORD *)(v3 + 216) = 0LL;
    }
    (*(void (__fastcall **)(uintptr_t, IOUSBHIDDriver *))(*(_QWORD *)v3 + 2648LL))(v3, v8);
    result = 0;
LABEL_49:
    if ( *off_6030[0] == v80 )
      break;
LABEL_50:
    v12 = 0LL;
    v14 = 0;
    v13 = off_6038[0];
    if ( *(_BYTE *)off_6038[0] & 2 )
    {
      v12 = 0LL;
      v14 = 0;
      if ( *(_DWORD *)off_6048 & 0xFFFFFFF7 )
      {
        v12 = 0LL;
        v8 = (IOUSBHIDDriver *)v3;
        kernel_debug(0x52D1C04u, v3, 0LL, 0LL, 3uLL, 0LL);
LABEL_24:
        v14 = 0;
      }
    }
  }
  return result;
}
// 0: using guessed type int;
// 6020: using guessed type _QWORD *off_6020[6];
// 6028: using guessed type __int64 *off_6028[5];
// 6030: using guessed type __int64 *off_6030[4];
// 6038: using guessed type __int64 *off_6038[3];
// 6040: using guessed type __int64 *off_6040[2];
// 6048: using guessed type __int64 *off_6048;
// 106C0: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);
// 10E00: using guessed type int __fastcall thread_call_allocate(_QWORD, _QWORD);
// 10E20: using guessed type int __fastcall thread_call_free(_QWORD);

//----- (00000000000021BC) ----------------------------------------------------
int __fastcall IOUSBHIDDriver::SetProtocol(IOUSBHIDDriver *this, __int16 a2)
{
  char v3; // [sp+0h] [bp-20h]@1
  char v4; // [sp+1h] [bp-1Fh]@1
  __int16 v5; // [sp+2h] [bp-1Eh]@1
  __int16 v6; // [sp+4h] [bp-1Ch]@1
  __int16 v7; // [sp+6h] [bp-1Ah]@1
  __int64 v8; // [sp+8h] [bp-18h]@1

  v3 = 33;
  v4 = 11;
  v5 = a2;
  v6 = (unsigned __int8)(*(int (__cdecl **)(_QWORD))(**((_QWORD **)this + 26) + 2224LL))(*((_QWORD *)this + 26));
  v7 = 0;
  v8 = 0LL;
  return (*(int (__fastcall **)(_QWORD, char *, _QWORD, _QWORD, _QWORD))(**((_QWORD **)this + 27) + 2424LL))(
           *((_QWORD *)this + 27),
           &v3,
           *(_DWORD *)(*((_QWORD *)this + 43) + 128LL),
           0LL,
           0LL);
}

//----- (0000000000002226) ----------------------------------------------------
int __fastcall IOUSBHIDDriver::CheckForDeadDeviceEntry(IOUSBHIDDriver *this, OSObject *a2)
{
  uintptr_t v2; // rax@1
  uintptr_t v3; // rbx@1

  LODWORD(v2) = OSMetaClassBase::safeMetaCast(this, &IOUSBHIDDriver::gMetaClass);
  v3 = v2;
  if ( v2 )
  {
    IOUSBHIDDriver::CheckForDeadDevice(v2, v2);
    LODWORD(v2) = (*(int (__fastcall **)(uintptr_t, _QWORD *))(*(_QWORD *)v3 + 2648LL))(v3, &IOUSBHIDDriver::gMetaClass);
  }
  return v2;
}
// 6F48: using guessed type _QWORD IOUSBHIDDriver::gMetaClass;
// 106C0: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000002262) ----------------------------------------------------
int __fastcall IOUSBHIDDriver::ClearFeatureEndpointHaltEntry(IOUSBHIDDriver *this, OSObject *a2)
{
  uintptr_t v2; // rax@1
  uintptr_t v3; // rbx@1

  LODWORD(v2) = OSMetaClassBase::safeMetaCast(this, &IOUSBHIDDriver::gMetaClass);
  v3 = v2;
  if ( v2 )
  {
    IOUSBHIDDriver::ClearFeatureEndpointHalt(v2);
    LODWORD(v2) = (*(int (__fastcall **)(uintptr_t, _QWORD *))(*(_QWORD *)v3 + 2648LL))(v3, &IOUSBHIDDriver::gMetaClass);
  }
  return v2;
}
// 6F48: using guessed type _QWORD IOUSBHIDDriver::gMetaClass;
// 106C0: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (000000000000229E) ----------------------------------------------------
int __usercall IOUSBHIDDriver::HandleReportEntry@<eax>(IOUSBHIDDriver *this@<rdi>, OSObject *a2@<rsi>, void *a3@<rdx>, unsigned __int64 a4@<rax>)
{
  uintptr_t v4; // rax@1
  uintptr_t v5; // rbx@1
  uint64_t v6; // rax@1
  __int64 *v7; // rsi@2
  unsigned __int64 v9; // [sp+0h] [bp-10h]@1

  v9 = a4;
  LODWORD(v4) = OSMetaClassBase::safeMetaCast(this, &IOUSBHIDDriver::gMetaClass);
  v5 = v4;
  v6 = mach_absolute_time();
  if ( v5 )
  {
    v7 = (__int64 *)&v9;
    absolutetime_to_nanoseconds(v6 - *(_QWORD *)(*(_QWORD *)(v5 + 344) + 120LL), &v9);
    if ( *(_BYTE *)off_6038[0] & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
    {
      v7 = (__int64 *)v5;
      kernel_debug(0x52D1C3Cu, v5, 2361183241434822607LL * (v9 >> 3) >> 64 >> 4, 0LL, 0xEuLL, 0LL);
    }
    IOUSBHIDDriver::HandleReport((IOUSBHIDDriver *)v5);
    LODWORD(v6) = (*(int (__fastcall **)(uintptr_t, __int64 *))(*(_QWORD *)v5 + 2648LL))(v5, v7);
  }
  return v6;
}
// 6038: using guessed type __int64 *off_6038[3];
// 6048: using guessed type __int64 *off_6048;
// 6F48: using guessed type _QWORD IOUSBHIDDriver::gMetaClass;
// 106C0: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);
// 10DB0: using guessed type int __fastcall absolutetime_to_nanoseconds(_QWORD, _QWORD);

//----- (000000000000233C) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::message(IOUSBHIDDriver *this, __int64 a2, IOService *a3, void *a4)
{
  IOUSBHIDDriver *v4; // r14@1
  int v5; // er15@1
  __int64 v6; // rax@2
  __int64 v7; // rdi@2
  __int64 v8; // rdi@5
  __int64 v9; // rdi@7
  __int64 v10; // rdi@9
  signed __int64 v11; // rsi@15
  char v13; // [sp+0h] [bp-30h]@20
  char v14; // [sp+1h] [bp-2Fh]@20
  __int16 v15; // [sp+2h] [bp-2Eh]@20
  __int16 v16; // [sp+4h] [bp-2Ch]@20
  __int16 v17; // [sp+6h] [bp-2Ah]@20
  __int64 v18; // [sp+8h] [bp-28h]@20

  v4 = this;
  v5 = (*(int (__fastcall **)(IOUSBHIDDriver *, __int64, IOService *, void *))((int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))off_6028[0]
                                                                             + 232))(
         this,
         a2,
         a3,
         a4);
  switch ( (_DWORD)a2 + 536854518 )
  {
    case 1:
    case 5:
      v6 = *((_QWORD *)this + 43);
      *(_BYTE *)(v6 + 72) = 0;
      v7 = *(_QWORD *)(v6 + 64);
      if ( v7 )
        (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v7 + 464LL))(v7, *(_DWORD *)(v6 + 76));
      break;
    case 0:
      if ( *((_DWORD *)this + 68) )
      {
        *((_BYTE *)this + 297) = 1;
        v8 = *((_QWORD *)this + 28);
        if ( v8 )
          (*(void (**)(void))(*(_QWORD *)v8 + 296LL))();
        v9 = *((_QWORD *)v4 + 39);
        if ( v9 )
          (*(void (**)(void))(*(_QWORD *)v9 + 296LL))();
      }
      *((_DWORD *)v4 + 68) = *(_DWORD *)(*((_QWORD *)v4 + 43) + 132LL);
      *(_WORD *)((char *)v4 + 297) = 0;
      v10 = *((_QWORD *)v4 + 26);
      if ( v10 && *((_QWORD *)v4 + 27) )
      {
        if ( (unsigned __int8)(*(int (**)(void))(*(_QWORD *)v10 + 2248LL))() == 3
          && (unsigned __int8)(*(int (**)(void))(**((_QWORD **)v4 + 26) + 2256LL))() == 1
          && (unsigned __int8)(*(int (**)(void))(**((_QWORD **)v4 + 26) + 2264LL))() == 1 )
        {
          if ( (unsigned __int16)(*(int (**)(void))(**((_QWORD **)v4 + 27) + 2288LL))() == 1452 )
            v11 = 0LL;
          else
            v11 = 24LL;
          (*(void (__fastcall **)(IOUSBHIDDriver *, signed __int64))(*(_QWORD *)v4 + 2672LL))(v4, v11);
        }
        if ( (unsigned __int8)(*(int (**)(void))(**((_QWORD **)v4 + 26) + 2256LL))() == 1 )
        {
          v13 = 33;
          v14 = 11;
          v15 = 1;
          v16 = (unsigned __int8)(*(int (__cdecl **)(_QWORD))(**((_QWORD **)v4 + 26) + 2224LL))(*((_QWORD *)v4 + 26));
          v17 = 0;
          v18 = 0LL;
          (*(void (__fastcall **)(_QWORD, char *, _QWORD, _QWORD, _QWORD))(**((_QWORD **)v4 + 27) + 2424LL))(
            *((_QWORD *)v4 + 27),
            &v13,
            *(_DWORD *)(*((_QWORD *)v4 + 43) + 128LL),
            0LL,
            0LL);
        }
        if ( (unsigned __int16)(*(int (__cdecl **)(_QWORD))(**((_QWORD **)v4 + 27) + 2288LL))(*((_QWORD *)v4 + 27)) == 1699 )
          (*(void (__fastcall **)(IOUSBHIDDriver *, _QWORD))(*(_QWORD *)v4 + 2672LL))(v4, 0LL);
      }
      v5 = (*(int (__fastcall **)(IOUSBHIDDriver *))(*(_QWORD *)v4 + 2680LL))(v4);
      break;
    case 3:
      *(_BYTE *)(*((_QWORD *)this + 43) + 72LL) = 1;
      break;
    default:
      return (unsigned int)v5;
  }
  return (unsigned int)v5;
}
// 6028: using guessed type __int64 *off_6028[5];

//----- (0000000000002570) ----------------------------------------------------
int __fastcall IOUSBHIDDriver::willTerminate(IOUSBHIDDriver *this, IOService *a2, unsigned int a3)
{
  unsigned int v3; // er14@1
  IOUSBHIDDriver *v4; // rbx@1
  __int64 v5; // rdi@2
  __int64 v6; // rdi@4
  __int64 v7; // rdi@6

  v3 = a3;
  v4 = this;
  if ( *((_DWORD *)this + 75) )
  {
    v5 = *((_QWORD *)this + 28);
    if ( v5 )
      (*(void (__cdecl **)(__int64))(*(_QWORD *)v5 + 296LL))(v5);
    v6 = *((_QWORD *)v4 + 39);
    if ( v6 )
      (*(void (__cdecl **)(__int64))(*(_QWORD *)v6 + 296LL))(v6);
    v7 = *(_QWORD *)(*((_QWORD *)v4 + 43) + 64LL);
    if ( v7 )
      (*(void (__cdecl **)(__int64))(*(_QWORD *)v7 + 536LL))(v7);
  }
  return (*(int (__fastcall **)(IOUSBHIDDriver *, IOService *, _QWORD))((int (__fastcall **)(_QWORD, _QWORD, _QWORD))off_6028[0]
                                                                      + 130))(
           v4,
           a2,
           v3);
}
// 6028: using guessed type __int64 *off_6028[5];

//----- (00000000000025F0) ----------------------------------------------------
int __fastcall IOUSBHIDDriver::didTerminate(IOUSBHIDDriver *this, IOService *a2, unsigned int a3, bool *a4)
{
  bool *v4; // r14@1
  unsigned int v5; // er15@1
  IOUSBHIDDriver *v6; // rbx@1
  __int64 v7; // rdi@2

  v4 = a4;
  v5 = a3;
  v6 = this;
  (*(void (**)(void))(*(_QWORD *)this + 1944LL))();
  if ( !*((_DWORD *)this + 75)
    && (v7 = *((_QWORD *)this + 26)) != 0
    && (unsigned __int8)(*(int (__fastcall **)(__int64, IOUSBHIDDriver *))(*(_QWORD *)v7 + 1504LL))(v7, v6) )
    (*(void (__fastcall **)(_QWORD, IOUSBHIDDriver *, _QWORD))(**((_QWORD **)v6 + 26) + 1496LL))(
      *((_QWORD *)v6 + 26),
      v6,
      0LL);
  else
    *((_BYTE *)v6 + 299) = 1;
  return (*(int (__fastcall **)(IOUSBHIDDriver *, IOService *, _QWORD, bool *))((int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))off_6028[0]
                                                                              + 131))(
           v6,
           a2,
           v5,
           v4);
}
// 6028: using guessed type __int64 *off_6028[5];

//----- (0000000000002674) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::maxCapabilityForDomainState(IOUSBHIDDriver *this)
{
  __int64 v1; // rax@1
  __int64 v2; // r14@1

  LODWORD(v1) = (*((int (**)(void))off_6028[0] + 256))();
  v2 = v1;
  IOService::isInactive(this);
  return v2;
}
// 6028: using guessed type __int64 *off_6028[5];

//----- (000000000000269E) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::powerStateWillChangeTo(IOUSBHIDDriver *this, uintptr_t arg2, uintptr_t a3, uintptr_t arg4)
{
  uintptr_t v4; // rbx@1
  uintptr_t v5; // r14@1
  IOUSBHIDDriver *v6; // r15@1
  __int64 *v7; // r12@1
  uint32_t v8; // edi@7
  uintptr_t v9; // rdx@7
  uintptr_t v10; // r8@7
  uintptr_t v11; // rsi@7
  __int64 v12; // rax@9

  v4 = arg4;
  v5 = a3;
  v6 = this;
  v7 = off_6038[0];
  if ( *(_BYTE *)off_6038[0] & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
    kernel_debug(0x52D1C09u, (uintptr_t)this, arg2, a3, arg4, 0LL);
  if ( (unsigned __int8)IOService::isInactive(this) )
  {
    if ( *(_BYTE *)v7 & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
    {
      v8 = 86842376;
      v9 = 0LL;
      v10 = 1LL;
      v11 = (uintptr_t)v6;
LABEL_14:
      kernel_debug(v8, v11, v9, 0LL, v10, 0LL);
      return 0LL;
    }
  }
  else if ( this == (IOUSBHIDDriver *)v4 )
  {
    v12 = *((_QWORD *)this + 43);
    if ( *(_QWORD *)(v12 + 104) != v5 )
      *(_BYTE *)(v12 + 96) = 1;
    if ( *(_BYTE *)v7 & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
    {
      v8 = 86842378;
      v10 = 0LL;
      v11 = (uintptr_t)v6;
      v9 = v5;
      goto LABEL_14;
    }
  }
  return 0LL;
}
// 6038: using guessed type __int64 *off_6038[3];
// 6048: using guessed type __int64 *off_6048;

//----- (0000000000002774) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::setPowerState(IOUSBHIDDriver *this, uintptr_t arg2, uintptr_t arg3)
{
  uintptr_t v3; // rbx@1
  unsigned __int64 v4; // r15@1
  uintptr_t v5; // r12@1
  __int64 *v6; // r13@1
  signed int v7; // er14@4
  uint32_t v8; // edi@8
  uintptr_t v9; // rdx@8
  uintptr_t v10; // r8@8
  uintptr_t v11; // rsi@9
  __int64 v12; // rdi@17
  __int64 v13; // rdi@19
  __int64 v14; // rdi@21

  v3 = arg3;
  v4 = arg2;
  v5 = (uintptr_t)this;
  v6 = off_6038[0];
  if ( *(_BYTE *)off_6038[0] & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
  {
    arg2 = (uintptr_t)this;
    kernel_debug(0x52D1C0Du, (uintptr_t)this, v4, arg3, 0LL, 0LL);
  }
  v7 = 0;
  if ( !(unsigned __int8)IOService::isInactive(this) )
  {
    if ( this == (IOUSBHIDDriver *)v3 )
    {
      if ( v4 < 5 )
      {
        if ( *(_QWORD *)(*((_QWORD *)this + 43) + 104LL) != v4 )
        {
          if ( v4 <= 3 )
          {
            v12 = *((_QWORD *)this + 28);
            if ( v12 )
            {
              *(_BYTE *)(v5 + 297) = 1;
              (*(void (__fastcall **)(__int64, uintptr_t))(*(_QWORD *)v12 + 296LL))(v12, arg2);
            }
            v13 = *(_QWORD *)(v5 + 312);
            if ( v13 )
              (*(void (__fastcall **)(__int64, uintptr_t))(*(_QWORD *)v13 + 296LL))(v13, arg2);
            v14 = *(_QWORD *)(*(_QWORD *)(v5 + 344) + 64LL);
            if ( v14 )
              (*(void (__fastcall **)(__int64, uintptr_t))(*(_QWORD *)v14 + 536LL))(v14, arg2);
          }
          if ( v4 >= 5 && *(_BYTE *)v6 & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
            kernel_debug(0x52D1C0Cu, v5, v4, 0LL, 3uLL, 0LL);
          if ( *(_BYTE *)v6 & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
          {
            v7 = 0;
            v8 = 86842382;
            v9 = 0LL;
            v10 = 0LL;
            goto LABEL_9;
          }
        }
      }
      else
      {
        v7 = 5;
        if ( *(_BYTE *)v6 & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
        {
          v8 = 86842380;
          v10 = 2LL;
          v11 = v5;
          v9 = v4;
          goto LABEL_14;
        }
      }
    }
    else if ( *(_BYTE *)v6 & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
    {
      v7 = 0;
      v8 = 86842380;
      v9 = 0LL;
      v10 = 1LL;
LABEL_9:
      v11 = v5;
LABEL_14:
      kernel_debug(v8, v11, v9, 0LL, v10, 0LL);
      return (unsigned int)v7;
    }
  }
  return (unsigned int)v7;
}
// 6038: using guessed type __int64 *off_6038[3];
// 6048: using guessed type __int64 *off_6048;

//----- (0000000000002936) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::powerStateDidChangeTo(IOUSBHIDDriver *this, uintptr_t arg2, uintptr_t arg3, uintptr_t arg4)
{
  uintptr_t v4; // rbx@1
  uintptr_t v5; // r15@1
  uintptr_t v6; // rax@1
  uintptr_t v7; // r14@1
  __int64 *v8; // r12@1
  unsigned __int8 v9; // al@4
  __int64 v10; // rax@6
  int v11; // eax@8
  __int64 v12; // rax@12
  __int64 v13; // rdi@12

  v4 = arg4;
  v5 = arg3;
  v6 = arg2;
  v7 = (uintptr_t)this;
  v8 = off_6038[0];
  if ( *(_BYTE *)off_6038[0] & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
  {
    arg2 = (uintptr_t)this;
    kernel_debug(0x52D1C11u, (uintptr_t)this, v6, arg3, arg4, 0LL);
  }
  v9 = IOService::isInactive(this);
  if ( this == (IOUSBHIDDriver *)v4 && v9 ^ 1 )
  {
    v10 = *((_QWORD *)this + 43);
    *(_QWORD *)(v10 + 104) = v5;
    if ( v5 == 4 && !*(_DWORD *)(v10 + 84) )
    {
      *((_DWORD *)this + 68) = *(_DWORD *)(v10 + 132);
      *((_BYTE *)this + 297) = 0;
      v11 = (*(int (__fastcall **)(IOUSBHIDDriver *, uintptr_t))(*(_QWORD *)this + 2680LL))(this, arg2);
      if ( v11 && *(_BYTE *)v8 & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
        kernel_debug(0x52D1C10u, (uintptr_t)this, v11, 0LL, 0LL, 0LL);
      v12 = *((_QWORD *)this + 43);
      v13 = *(_QWORD *)(v12 + 64);
      if ( v13 )
        (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v13 + 464LL))(v13, *(_DWORD *)(v12 + 76));
    }
    if ( *(_BYTE *)v8 & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
      kernel_debug(0x52D1C12u, v7, 0LL, 0LL, 0LL, 0LL);
  }
  return 0LL;
}
// 6038: using guessed type __int64 *off_6038[3];
// 6048: using guessed type __int64 *off_6048;

//----- (0000000000002A5A) ----------------------------------------------------
void __fastcall IOUSBHIDDriver::powerChangeDone(IOUSBHIDDriver *this, uintptr_t arg2)
{
  __int64 *v2; // r15@1
  char v3; // al@4
  int v4; // ecx@4

  v2 = off_6038[0];
  if ( *(_BYTE *)off_6038[0] & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
    kernel_debug(0x52D1C15u, (uintptr_t)this, arg2, 0LL, 0LL, 0LL);
  v3 = IOService::isInactive(this);
  v4 = *(_DWORD *)v2 & 2;
  if ( v3 )
  {
    if ( v4 )
    {
      if ( *(_DWORD *)off_6048 & 0xFFFFFFF7 )
        kernel_debug(0x52D1C14u, (uintptr_t)this, arg2, 0LL, 0LL, 0LL);
    }
  }
  else
  {
    if ( v4 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
      kernel_debug(0x52D1C16u, (uintptr_t)this, 0LL, 0LL, 0LL, 0LL);
    *(_BYTE *)(*((_QWORD *)this + 43) + 96LL) = 0;
    (*(void (__fastcall **)(IOUSBHIDDriver *, uintptr_t))((void (__fastcall **)(_QWORD, _QWORD))off_6028[0] + 267))(
      this,
      arg2);
  }
}
// 6028: using guessed type __int64 *off_6028[5];
// 6038: using guessed type __int64 *off_6038[3];
// 6048: using guessed type __int64 *off_6048;

//----- (0000000000002B46) ----------------------------------------------------
char __usercall IOUSBHIDDriver::handleStart@<al>(uintptr_t arg1@<rdi>, uintptr_t arg2@<rsi>, __int64 a3@<rax>)
{
  uintptr_t v3; // r14@1
  __int64 *v4; // r15@1
  __int64 v5; // rax@6
  __int64 v6; // rax@7
  __int64 v7; // rax@8
  __int64 v8; // rbx@8
  __int64 v9; // rax@8
  __int64 v10; // rax@12
  __int64 v11; // rax@14
  __int64 v12; // rax@16
  unsigned int v13; // eax@18
  char v14; // bl@19
  uintptr_t v15; // rdx@21
  uintptr_t v16; // rcx@21
  uintptr_t v17; // r8@21
  uint32_t v18; // edi@21
  __int64 v20; // [sp+0h] [bp-20h]@1

  v20 = a3;
  v3 = arg1;
  v4 = off_6038[0];
  if ( *(_BYTE *)off_6038[0] & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
    kernel_debug(0x52D1C19u, arg1, arg2, 0LL, 0LL, 0LL);
  if ( !(unsigned __int8)(*((int (__fastcall **)(_QWORD, _QWORD))off_6028[0] + 268))(arg1, arg2) )
    return 0;
  if ( !(unsigned __int8)(*(int (__fastcall **)(uintptr_t, uintptr_t, _QWORD, _QWORD))(*(_QWORD *)arg2 + 1488LL))(
                           arg2,
                           arg1,
                           0LL,
                           0LL) )
  {
    if ( *(_BYTE *)v4 & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
    {
      v14 = 0;
      v18 = 86842392;
      v15 = 0LL;
      v16 = 0LL;
      v17 = 1LL;
      goto LABEL_34;
    }
    return 0;
  }
  LODWORD(v5) = OSMetaClassBase::safeMetaCast(arg2, *off_6008[0]);
  *(_QWORD *)(arg1 + 208) = v5;
  if ( !v5 )
  {
    if ( *(_BYTE *)v4 & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
    {
      v14 = 0;
      v18 = 86842392;
      v15 = 0LL;
      v16 = 0LL;
      v17 = 2LL;
      goto LABEL_34;
    }
    return 0;
  }
  LODWORD(v6) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v5 + 2216LL))(v5);
  *(_QWORD *)(arg1 + 216) = v6;
  if ( !v6 )
  {
    if ( *(_BYTE *)v4 & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
    {
      v14 = 0;
      v18 = 86842392;
      v15 = 0LL;
      v16 = 0LL;
      v17 = 3LL;
      goto LABEL_34;
    }
    return 0;
  }
  (*(void (__cdecl **)(_QWORD))(**(_QWORD **)(arg1 + 208) + 32LL))(*(_QWORD *)(arg1 + 208));
  (*(void (__cdecl **)(_QWORD))(**(_QWORD **)(arg1 + 216) + 32LL))(*(_QWORD *)(arg1 + 216));
  LODWORD(v7) = (*(int (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(arg1 + 216) + 744LL))(
                  *(_QWORD *)(arg1 + 216),
                  "kControlNoDataTimeout");
  v8 = v7;
  LODWORD(v9) = OSMetaClassBase::safeMetaCast(v7, *off_6020[0]);
  if ( v9 )
    *(_DWORD *)(*(_QWORD *)(arg1 + 344) + 128LL) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v9 + 328LL))(v9);
  if ( v8 )
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v8 + 40LL))(v8);
  LOWORD(v20) = 3;
  LODWORD(v10) = (*(int (__fastcall **)(_QWORD, _QWORD, __int64 *))(**(_QWORD **)(arg1 + 208) + 2176LL))(
                   *(_QWORD *)(arg1 + 208),
                   0LL,
                   &v20);
  *(_QWORD *)(arg1 + 312) = v10;
  if ( v10 )
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v10 + 32LL))(v10);
  LOWORD(v20) = 259;
  LODWORD(v11) = (*(int (__fastcall **)(_QWORD, _QWORD, __int64 *))(**(_QWORD **)(arg1 + 208) + 2176LL))(
                   *(_QWORD *)(arg1 + 208),
                   0LL,
                   &v20);
  *(_QWORD *)(arg1 + 224) = v11;
  if ( !v11 )
  {
    if ( *(_BYTE *)v4 & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
    {
      v14 = 0;
      v18 = 86842372;
      v15 = 0LL;
      v16 = 0LL;
      v17 = 5LL;
      goto LABEL_34;
    }
    return 0;
  }
  (*(void (__fastcall **)(__int64))(*(_QWORD *)v11 + 32LL))(v11);
  if ( (unsigned __int16)(*(int (__cdecl **)(_QWORD))(**(_QWORD **)(arg1 + 216) + 2288LL))(*(_QWORD *)(arg1 + 216)) == 1452 )
  {
    LODWORD(v12) = (*(int (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(arg1 + 208) + 696LL))(
                     *(_QWORD *)(arg1 + 208),
                     "UseStandardRetryCount");
    if ( v12 != *(_QWORD *)*off_6040[0]
      && (unsigned __int8)(*(int (__cdecl **)(_QWORD))(**(_QWORD **)(arg1 + 224) + 424LL))(*(_QWORD *)(arg1 + 224)) <= 7u )
    {
      v13 = 0x18u
          / (unsigned __int8)(*(int (__cdecl **)(_QWORD))(**(_QWORD **)(arg1 + 224) + 424LL))(*(_QWORD *)(arg1 + 224));
      *(_DWORD *)(*(_QWORD *)(arg1 + 344) + 132LL) = v13;
      *(_DWORD *)(arg1 + 272) = v13;
    }
  }
  v14 = 1;
  if ( *(_BYTE *)v4 & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
  {
    v15 = *(_QWORD *)(arg1 + 208);
    v16 = *(_QWORD *)(arg1 + 216);
    v17 = *(_DWORD *)(arg1 + 272);
    v18 = 86842394;
LABEL_34:
    kernel_debug(v18, v3, v15, v16, v17, 0LL);
  }
  return v14;
}
// 6008: using guessed type _QWORD *off_6008[9];
// 6020: using guessed type _QWORD *off_6020[6];
// 6028: using guessed type __int64 *off_6028[5];
// 6038: using guessed type __int64 *off_6038[3];
// 6040: using guessed type __int64 *off_6040[2];
// 6048: using guessed type __int64 *off_6048;
// 106C0: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000002E62) ----------------------------------------------------
int __fastcall IOUSBHIDDriver::handleStop(IOUSBHIDDriver *this, IOService *a2)
{
  if ( *((_QWORD *)this + 35) )
  {
    thread_call_cancel();
    thread_call_free(*((_QWORD *)this + 35));
  }
  if ( *((_QWORD *)this + 36) )
  {
    thread_call_cancel();
    thread_call_free(*((_QWORD *)this + 36));
  }
  if ( *(_QWORD *)(*((_QWORD *)this + 43) + 8LL) )
  {
    thread_call_cancel();
    thread_call_free(*(_QWORD *)(*((_QWORD *)this + 43) + 8LL));
  }
  return (*((int (__fastcall **)(_QWORD))off_6028[0] + 269))(this);
}
// 6028: using guessed type __int64 *off_6028[5];
// 10E08: using guessed type int thread_call_cancel(void);
// 10E20: using guessed type int __fastcall thread_call_free(_QWORD);

//----- (0000000000002EE6) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::getReport(uintptr_t arg1, uintptr_t a2, unsigned int a3, unsigned int a4)
{
  unsigned __int8 v4; // r13@1
  __int16 v5; // bx@1
  __int64 v6; // r14@1
  __int16 v7; // ax@5
  int v8; // er15@5
  unsigned __int16 v9; // cx@6
  unsigned __int64 v10; // rax@6
  signed __int64 v11; // rcx@7
  unsigned __int16 v12; // cx@8
  uintptr_t v13; // rsi@11
  __int64 v14; // rax@12
  __int64 v15; // rax@15
  __int64 v16; // rbx@15
  __int64 v17; // rax@20
  void (__fastcall *v18)(_QWORD, _QWORD, _QWORD, _QWORD); // r13@21
  unsigned int v19; // ebx@21
  __int64 v20; // rax@21
  char v22; // [sp+0h] [bp-40h]@11
  char v23; // [sp+1h] [bp-3Fh]@11
  __int16 v24; // [sp+2h] [bp-3Eh]@11
  __int16 v25; // [sp+4h] [bp-3Ch]@11
  __int16 v26; // [sp+6h] [bp-3Ah]@11
  __int64 v27; // [sp+8h] [bp-38h]@11
  uintptr_t arg2; // [sp+10h] [bp-30h]@11

  v4 = a4;
  v5 = a3;
  v6 = a2;
  if ( *(_BYTE *)off_6038[0] & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
  {
    a2 = arg1;
    kernel_debug(
      0x52D1C4Du,
      arg1,
      *(_BYTE *)(*(_QWORD *)(arg1 + 344) + 80LL) | ((unsigned __int64)*(_DWORD *)(arg1 + 320) << 32),
      a3,
      a4,
      0LL);
  }
  if ( (unsigned __int16)(*(int (__fastcall **)(_QWORD, uintptr_t))(**(_QWORD **)(arg1 + 216) + 2288LL))(
                           *(_QWORD *)(arg1 + 216),
                           a2) == 1133 )
  {
    v7 = (*(int (**)(void))(**(_QWORD **)(arg1 + 216) + 2296LL))();
    v8 = -536870201;
    if ( v7 > -15742 )
    {
      v12 = v7 + 15741;
      v10 = (unsigned __int16)(v7 + 15741);
      if ( v12 <= 0x12u )
      {
        v11 = 458757LL;
LABEL_10:
        if ( _bittest((const unsigned __int64 *)&v11, v10) )
          goto LABEL_22;
        goto LABEL_11;
      }
    }
    else
    {
      v9 = v7 + 15870;
      v10 = (unsigned __int16)(v7 + 15870);
      if ( v9 <= 0x10u )
      {
        v11 = 66017LL;
        goto LABEL_10;
      }
    }
  }
LABEL_11:
  (*(void (__fastcall **)(uintptr_t))(*(_QWORD *)arg1 + 2656LL))(arg1);
  v22 = -95;
  v23 = 1;
  v24 = ((v5 << 8) + 256) | v4;
  v25 = (unsigned __int8)(*(int (__cdecl **)(_QWORD))(**(_QWORD **)(arg1 + 208) + 2224LL))(*(_QWORD *)(arg1 + 208));
  v26 = (*(int (__fastcall **)(__int64))(*(_QWORD *)v6 + 456LL))(v6);
  v27 = v6;
  LODWORD(arg2) = 0;
  v13 = (uintptr_t)&v22;
  v8 = (*(int (__fastcall **)(_QWORD, char *, _QWORD, _QWORD, _QWORD))(**(_QWORD **)(arg1 + 216) + 2432LL))(
         *(_QWORD *)(arg1 + 216),
         &v22,
         *(_DWORD *)(*(_QWORD *)(arg1 + 344) + 128LL),
         0LL,
         0LL);
  if ( *(_BYTE *)off_6038[0] & 2 )
  {
    LODWORD(v14) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v6 + 456LL))(v6);
    if ( *(_DWORD *)off_6048 & 0xFFFFFFF7 )
    {
      v13 = arg1;
      kernel_debug(0x52D1C4Cu, arg1, v8, (unsigned int)arg2 | (unsigned __int64)(v14 << 16), 0LL, 0LL);
    }
  }
  if ( !v8 )
  {
    v13 = *off_6018[0];
    LODWORD(v15) = OSMetaClassBase::safeMetaCast(v6, *off_6018[0]);
    v16 = v15;
    if ( v15 )
    {
      if ( *(_BYTE *)off_6038[0] & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
        kernel_debug(0x52D1C4Cu, arg1, (unsigned int)arg2, 0LL, 1uLL, 0LL);
      v13 = (unsigned int)arg2;
      (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v16 + 712LL))(v16, (unsigned int)arg2);
    }
  }
  (*(void (__fastcall **)(uintptr_t, uintptr_t))(*(_QWORD *)arg1 + 2648LL))(arg1, v13);
  v17 = *(_QWORD *)(arg1 + 344);
  if ( *(_BYTE *)(v17 + 81) )
  {
    v18 = *(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)arg1 + 2704LL);
    v19 = *(_BYTE *)(v17 + 82);
    LODWORD(v20) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v6 + 456LL))(v6);
    v18(arg1, v19, v6, v20);
  }
LABEL_22:
  if ( *(_BYTE *)off_6038[0] & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
    kernel_debug(0x52D1C4Eu, arg1, 0LL, v8, 0LL, 0LL);
  return (unsigned int)v8;
}
// 6018: using guessed type _QWORD *off_6018[7];
// 6038: using guessed type __int64 *off_6038[3];
// 6048: using guessed type __int64 *off_6048;
// 106C0: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (000000000000317C) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::setReport(uintptr_t arg1, uintptr_t a2, unsigned int a3, unsigned int a4)
{
  unsigned __int8 v4; // r15@1
  char v5; // bl@1
  __int64 v6; // r14@1
  uintptr_t v7; // r13@1
  __int64 v8; // rax@4
  int v9; // er12@6
  int v10; // ebx@7
  __int64 v11; // rdi@8
  __int64 v12; // rax@9
  void (__fastcall *v13)(_QWORD, _QWORD, _QWORD, _QWORD); // r15@10
  unsigned int v14; // er12@10
  __int64 v15; // rax@10
  unsigned __int16 v16; // r15@11
  __int64 v17; // rax@11
  __int64 v18; // rcx@11
  __int64 v19; // r12@13
  char *v20; // r12@14
  __int64 v21; // rdi@16
  char *v22; // rsi@19
  int v23; // er15@19
  uintptr_t v24; // rax@20
  __int64 v25; // rax@33
  void (__fastcall *v26)(_QWORD, _QWORD, _QWORD, _QWORD); // r15@34
  unsigned int v27; // er12@34
  __int64 v28; // rax@34
  __int64 v29; // rax@36
  unsigned __int8 v31; // [sp+Ch] [bp-44h]@7
  char v32; // [sp+10h] [bp-40h]@35
  char v33; // [sp+11h] [bp-3Fh]@35
  __int16 v34; // [sp+12h] [bp-3Eh]@35
  __int16 v35; // [sp+14h] [bp-3Ch]@35
  __int16 v36; // [sp+16h] [bp-3Ah]@35
  __int64 v37; // [sp+18h] [bp-38h]@35
  unsigned int v38; // [sp+20h] [bp-30h]@35

  v4 = a4;
  v5 = a3;
  v6 = a2;
  v7 = arg1;
  if ( *(_BYTE *)off_6038[0] & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
  {
    a2 = arg1;
    kernel_debug(
      0x52D1C51u,
      arg1,
      *(_BYTE *)(*(_QWORD *)(arg1 + 344) + 80LL) | ((unsigned __int64)*(_DWORD *)(arg1 + 320) << 32),
      a3,
      a4,
      0LL);
  }
  v8 = *(_QWORD *)(arg1 + 344);
  if ( !v8
    || !*(_QWORD *)v8
    || (v9 = -536854454,
        !(unsigned __int8)(*(int (__fastcall **)(_QWORD, uintptr_t))(**(_QWORD **)v8 + 304LL))(*(_QWORD *)v8, a2)) )
  {
    v31 = v4;
    (*(void (__fastcall **)(uintptr_t, uintptr_t))(*(_QWORD *)arg1 + 2656LL))(arg1, a2);
    v10 = (unsigned __int8)(v5 + 1);
    if ( v10 == 2 )
    {
      v11 = *(_QWORD *)(arg1 + 312);
      if ( v11 )
      {
        v12 = *(_QWORD *)(v7 + 344);
        if ( *(_BYTE *)(v12 + 81) )
        {
          v13 = *(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v7 + 2704LL);
          v14 = *(_BYTE *)(v12 + 82);
          LODWORD(v15) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v6 + 456LL))(v6);
          v13(v7, v14, v6, v15);
          v11 = *(_QWORD *)(v7 + 312);
        }
        v16 = (*(int (**)(void))(*(_QWORD *)v11 + 416LL))();
        LODWORD(v17) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v6 + 456LL))(v6);
        v18 = v17;
        if ( *(_BYTE *)off_6038[0] & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
        {
          v19 = v17;
          kernel_debug(0x52D1C50u, v7, v16, (unsigned int)v17, 3uLL, 0LL);
          v18 = v19;
        }
        v20 = 0LL;
        if ( v16 )
        {
          v20 = 0LL;
          if ( !((unsigned int)v18 % v16) )
          {
            v21 = *(_QWORD *)(v7 + 344);
            v20 = 0LL;
            if ( v21 )
            {
              v20 = 0LL;
              if ( (unsigned int)v18 < *(_DWORD *)(v21 + 140) )
                v20 = (char *)IOMemoryDescriptor::withAddress((IOMemoryDescriptor *)(v21 + 136), 0LL, 2uLL, v18);
            }
          }
        }
        v22 = (char *)v6;
        v23 = (*(int (__fastcall **)(_QWORD, __int64, _QWORD, __int64))(**(_QWORD **)(v7 + 312) + 328LL))(
                *(_QWORD *)(v7 + 312),
                v6,
                0LL,
                v18);
        if ( *(_BYTE *)off_6038[0] & 2 )
        {
          LODWORD(v24) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v6 + 456LL))(v6);
          if ( *(_DWORD *)off_6048 & 0xFFFFFFF7 )
          {
            v22 = (char *)v7;
            kernel_debug(0x52D1C50u, v7, v23, v24, 1uLL, 0LL);
          }
        }
        if ( !v23 && v20 )
        {
          if ( *(_BYTE *)off_6038[0] & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
            kernel_debug(0x52D1C50u, v7, *(_DWORD *)(*(_QWORD *)(v7 + 344) + 140LL), 0LL, 4uLL, 0LL);
          v22 = v20;
          v23 = (*(int (__fastcall **)(_QWORD, char *, _QWORD))(**(_QWORD **)(v7 + 312) + 328LL))(
                  *(_QWORD *)(v7 + 312),
                  v20,
                  0LL);
          (*(void (__fastcall **)(char *))(*(_QWORD *)v20 + 40LL))(v20);
        }
        v9 = 0;
        if ( !v23 )
          goto LABEL_38;
        a2 = 1LL;
        LOWORD(v10) = 2;
        if ( (*(int (__fastcall **)(_QWORD, signed __int64))(**(_QWORD **)(v7 + 312) + 488LL))(
               *(_QWORD *)(v7 + 312),
               1LL)
          && *(_BYTE *)off_6038[0] & 2
          && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
        {
          a2 = v7;
          kernel_debug(0x52D1C50u, v7, v23, 0LL, 2uLL, 0LL);
        }
      }
    }
    v25 = *(_QWORD *)(v7 + 344);
    if ( *(_BYTE *)(v25 + 81) )
    {
      v26 = *(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v7 + 2704LL);
      v27 = *(_BYTE *)(v25 + 82);
      LODWORD(v28) = (*(int (__fastcall **)(__int64, uintptr_t))(*(_QWORD *)v6 + 456LL))(v6, a2);
      a2 = v27;
      v26(v7, v27, v6, v28);
    }
    v32 = 33;
    v33 = 9;
    v34 = ((_WORD)v10 << 8) | v31;
    v35 = (unsigned __int8)(*(int (__fastcall **)(_QWORD, uintptr_t))(**(_QWORD **)(v7 + 208) + 2224LL))(
                             *(_QWORD *)(v7 + 208),
                             a2);
    v36 = (*(int (__fastcall **)(__int64))(*(_QWORD *)v6 + 456LL))(v6);
    v37 = v6;
    v38 = 0;
    v22 = &v32;
    v9 = (*(int (__fastcall **)(_QWORD, char *, _QWORD, _QWORD, _QWORD))(**(_QWORD **)(v7 + 216) + 2432LL))(
           *(_QWORD *)(v7 + 216),
           &v32,
           *(_DWORD *)(*(_QWORD *)(v7 + 344) + 128LL),
           0LL,
           0LL);
    if ( *(_BYTE *)off_6038[0] & 2 )
    {
      LODWORD(v29) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v6 + 456LL))(v6);
      if ( *(_DWORD *)off_6048 & 0xFFFFFFF7 )
      {
        v22 = (char *)v7;
        kernel_debug(0x52D1C50u, v7, v9, v38 | (unsigned __int64)(v29 << 16), 0LL, 0LL);
      }
    }
LABEL_38:
    (*(void (__fastcall **)(uintptr_t, char *))(*(_QWORD *)v7 + 2648LL))(v7, v22);
  }
  if ( *(_BYTE *)off_6038[0] & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
    kernel_debug(0x52D1C52u, v7, 0LL, v9, 0LL, 0LL);
  return (unsigned int)v9;
}
// 6038: using guessed type __int64 *off_6038[3];
// 6048: using guessed type __int64 *off_6048;

//----- (000000000000358C) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::newLocationIDNumber(IOUSBHIDDriver *this)
{
  __int64 v1; // rdi@1
  __int64 v2; // rbx@1
  __int64 v3; // rax@2
  __int64 v4; // r14@2
  signed __int64 v5; // rsi@2
  __int64 v6; // rax@2
  int v7; // eax@3
  unsigned int v8; // edx@3

  v1 = *((_QWORD *)this + 26);
  v2 = 0LL;
  if ( v1 )
  {
    LODWORD(v3) = (*(int (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v1 + 744LL))(v1, "locationID");
    v4 = v3;
    v5 = *off_6020[0];
    LODWORD(v6) = OSMetaClassBase::safeMetaCast(v3, *off_6020[0]);
    v2 = 0LL;
    if ( v6 )
    {
      v7 = (*(int (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v6 + 328LL))(v6, v5);
      v5 = 32LL;
      v2 = OSNumber::withNumber((OSNumber *)(unsigned int)v7, 0x20uLL, v8);
    }
    if ( v4 )
      (*(void (__fastcall **)(__int64, signed __int64))(*(_QWORD *)v4 + 40LL))(v4, v5);
  }
  return v2;
}
// 6020: using guessed type _QWORD *off_6020[6];
// 106C0: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (00000000000035FE) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::newManufacturerString(IOUSBHIDDriver *this)
{
  __int64 *v1; // r14@1
  unsigned __int8 v2; // al@1
  const char *v3; // rsi@1
  int v4; // ecx@1
  __int64 result; // rax@1
  __int64 v6; // rcx@3
  unsigned int v7; // [sp+Ch] [bp-124h]@1
  unsigned __int8 v8; // [sp+10h] [bp-120h]@1
  __int64 v9; // [sp+118h] [bp-18h]@1

  v1 = off_6030[0];
  v9 = *off_6030[0];
  v8 = 0;
  v2 = (*(int (**)(void))(**((_QWORD **)this + 27) + 2320LL))();
  v7 = 256;
  v3 = (const char *)v2;
  v4 = IOUSBHIDDriver::GetIndexedString(this, v2, &v8, &v7, 1033);
  result = 0LL;
  if ( !v4 )
    result = OSString::withCString((OSString *)&v8, v3);
  v6 = *v1;
  return result;
}
// 6030: using guessed type __int64 *off_6030[4];

//----- (000000000000368C) ----------------------------------------------------
int __fastcall IOUSBHIDDriver::GetIndexedString(IOUSBHIDDriver *this, unsigned __int8 a2, unsigned __int8 *a3, unsigned int *a4, signed __int16 a5)
{
  unsigned int *v5; // r14@1
  __int64 *v6; // r15@1
  int result; // eax@1
  unsigned int v8; // er12@2
  signed __int16 v9; // ax@2
  unsigned int v10; // er13@5
  __int64 v11; // rcx@11
  char *v12; // [sp+8h] [bp-138h]@1
  char v13; // [sp+10h] [bp-130h]@4
  __int64 v14; // [sp+110h] [bp-30h]@1

  v5 = a4;
  v12 = (char *)a3;
  v6 = off_6030[0];
  v14 = *off_6030[0];
  result = -536870206;
  if ( a2 )
  {
    v8 = *a4;
    v9 = 1033;
    if ( a5 )
      v9 = a5;
    result = (*(int (__fastcall **)(_QWORD, _QWORD, char *, signed __int64, _QWORD))(**((_QWORD **)this + 27) + 2392LL))(
               *((_QWORD *)this + 27),
               a2,
               &v13,
               255LL,
               (unsigned __int16)v9);
    if ( !result )
    {
      v10 = 0;
      if ( v13 )
        v10 = (unsigned __int16)(strlen(&v13) + 1);
      if ( !v8 )
        goto LABEL_10;
      result = -536870175;
      if ( v8 >= v10 )
      {
        strlcpy(v12, &v13, off_6050);
LABEL_10:
        *v5 = v10;
        result = 0;
        goto LABEL_11;
      }
    }
  }
LABEL_11:
  v11 = *v6;
  return result;
}
// 6030: using guessed type __int64 *off_6030[4];

//----- (000000000000376A) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::newProductIDNumber(IOUSBHIDDriver *this, __int64 a2, unsigned int a3)
{
  __int64 v3; // rax@1
  OSNumber *v4; // rdi@1

  v3 = *((_QWORD *)this + 27);
  v4 = 0LL;
  if ( v3 )
    v4 = (OSNumber *)(unsigned __int16)(*(int (__fastcall **)(__int64))(*(_QWORD *)v3 + 2296LL))(v3);
  return OSNumber::withNumber(v4, 0x10uLL, a3);
}

//----- (0000000000003796) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::newProductString(IOUSBHIDDriver *this)
{
  __int64 *v1; // r14@1
  unsigned __int8 v2; // al@1
  const char *v3; // rsi@1
  int v4; // ecx@1
  __int64 result; // rax@1
  __int64 v6; // rcx@3
  unsigned int v7; // [sp+Ch] [bp-124h]@1
  unsigned __int8 v8; // [sp+10h] [bp-120h]@1
  __int64 v9; // [sp+118h] [bp-18h]@1

  v1 = off_6030[0];
  v9 = *off_6030[0];
  v8 = 0;
  v2 = (*(int (**)(void))(**((_QWORD **)this + 27) + 2328LL))();
  v7 = 256;
  v3 = (const char *)v2;
  v4 = IOUSBHIDDriver::GetIndexedString(this, v2, &v8, &v7, 1033);
  result = 0LL;
  if ( !v4 )
    result = OSString::withCString((OSString *)&v8, v3);
  v6 = *v1;
  return result;
}
// 6030: using guessed type __int64 *off_6030[4];

//----- (0000000000003824) ----------------------------------------------------
__int64 __usercall IOUSBHIDDriver::newReportDescriptor@<rax>(IOUSBHIDDriver *this@<rdi>, IOMemoryDescriptor **a2@<rsi>, __int64 a3@<rax>)
{
  IOMemoryDescriptor *v3; // r13@1
  bool v4; // cl@1
  int v5; // ebx@1
  IOMemoryDescriptor *v6; // r12@3
  unsigned __int8 *v7; // rax@4
  int v8; // er15@4
  __int64 v10; // [sp-4h] [bp-30h]@1

  v10 = a3;
  HIDWORD(v10) = 0;
  v3 = 0LL;
  v5 = IOUSBHIDDriver::GetHIDDescriptor(this, 0x22u, 0, 0LL, (unsigned int *)&v10 + 1);
  if ( !v5 )
  {
    if ( HIDWORD(v10) )
    {
      v5 = 0;
      v6 = (IOMemoryDescriptor *)IOBufferMemoryDescriptor::withCapacity(
                                   (IOBufferMemoryDescriptor *)HIDWORD(v10),
                                   3uLL,
                                   0,
                                   v4);
      v3 = 0LL;
      if ( v6 )
      {
        LODWORD(v7) = (*(int (__fastcall **)(IOMemoryDescriptor *, signed __int64))(*(_QWORD *)v6 + 736LL))(v6, 3LL);
        v5 = 0;
        v8 = IOUSBHIDDriver::GetHIDDescriptor(this, 0x22u, 0, v7, (unsigned int *)&v10 + 1);
        if ( v8 )
        {
          (*(void (__fastcall **)(IOMemoryDescriptor *, signed __int64))(*(_QWORD *)v6 + 40LL))(v6, 34LL);
          v3 = 0LL;
          v5 = v8;
        }
        else
        {
          v3 = v6;
        }
      }
    }
  }
  *a2 = v3;
  return (unsigned int)v5;
}

//----- (00000000000038D4) ----------------------------------------------------
int __fastcall IOUSBHIDDriver::GetHIDDescriptor(IOUSBHIDDriver *this, unsigned __int8 a2, int a3, unsigned __int8 *a4, unsigned int *a5)
{
  unsigned int *v5; // r15@1
  unsigned __int8 *v6; // rbx@1
  int v7; // er13@1
  unsigned __int8 v8; // r14@1
  IOUSBHIDDriver *v9; // rax@1
  int v10; // er12@1
  __int64 v11; // rdi@2
  __int64 v12; // rax@3
  __int64 v13; // rdx@3
  __int64 v14; // r8@3
  unsigned int v15; // ecx@4
  unsigned __int16 v16; // r10@4
  unsigned __int8 v17; // r11@7
  __int64 v18; // r9@8
  signed __int64 v19; // rax@8
  __int64 v20; // rsi@8
  char v21; // di@8
  unsigned __int8 v22; // cl@8
  char v23; // cl@16
  size_t v24; // rdx@23
  int v25; // er14@27
  unsigned int v26; // er13@27
  unsigned int v28; // [sp+Ch] [bp-54h]@8
  int v29; // [sp+Ch] [bp-54h]@31
  IOUSBHIDDriver *v30; // [sp+18h] [bp-48h]@3
  char v31; // [sp+20h] [bp-40h]@31
  char v32; // [sp+21h] [bp-3Fh]@31
  __int16 v33; // [sp+22h] [bp-3Eh]@31
  __int16 v34; // [sp+24h] [bp-3Ch]@31
  __int16 v35; // [sp+26h] [bp-3Ah]@31
  unsigned __int8 *v36; // [sp+28h] [bp-38h]@31
  int v37; // [sp+30h] [bp-30h]@31

  v5 = a5;
  v6 = a4;
  v7 = a3;
  v8 = a2;
  v9 = this;
  v10 = -536870206;
  if ( a5 )
  {
    v11 = *((_QWORD *)this + 26);
    v10 = -536870160;
    if ( v11 )
    {
      v30 = v9;
      LODWORD(v12) = (*(int (__fastcall **)(__int64, _QWORD, signed __int64))(*(_QWORD *)v11 + 2184LL))(v11, 0LL, 33LL);
      if ( v12 )
      {
        v15 = *v5;
        v16 = a2;
        if ( a2 != 33 && (a2 || (_BYTE)v7) )
        {
          v17 = *(_BYTE *)(v12 + 5);
          if ( v17 )
          {
            v28 = *v5;
            v18 = (unsigned int)(unsigned __int8)v7 - 1;
            v19 = v12 + 8;
            v20 = 0LL;
            v21 = 0;
            v22 = 0;
            while ( 1 )
            {
              if ( v8 )
              {
                v13 = *(_BYTE *)(v19 - 2);
                if ( (_DWORD)v13 == v8 )
                {
                  v13 = v22;
                  LOBYTE(v14) = 1;
                  if ( v22 != v7 )
                    LOBYTE(v14) = v21;
                  LOBYTE(v13) = v22 + (v22 != v7);
                  v21 = v14;
                }
                else
                {
                  LOBYTE(v13) = v22;
                }
              }
              else
              {
                LOBYTE(v13) = v20;
                if ( (_DWORD)v18 != (_DWORD)v20 )
                  LOBYTE(v13) = v22;
                v23 = 1;
                if ( (_DWORD)v18 != (_DWORD)v20 )
                  v23 = v21;
                v21 = v23;
              }
              if ( v21 & 1 )
                break;
              v20 = (unsigned int)(v20 + 1);
              v19 += 3LL;
              v22 = v13;
              if ( (unsigned __int8)v20 >= (unsigned int)v17 )
                return v10;
            }
            v25 = (*(_BYTE *)v19 << 8) | *(_BYTE *)(v19 - 1);
            v26 = (unsigned __int16)((*(_BYTE *)v19 << 8) | *(_BYTE *)(v19 - 1));
            *v5 = v26;
            v10 = 0;
            if ( v28 )
            {
              v10 = -536870181;
              if ( v26 <= v28 )
              {
                v10 = -536870206;
                if ( v6 )
                {
                  v10 = -536870160;
                  if ( *((_QWORD *)v30 + 27) )
                  {
                    v31 = -127;
                    v32 = 6;
                    v29 = (v16 << 8) | (unsigned __int8)v13;
                    v33 = (v16 << 8) | (unsigned __int8)v13;
                    v34 = (unsigned __int8)(*(int (__fastcall **)(_QWORD, __int64, __int64, _QWORD, __int64, __int64))(**((_QWORD **)v30 + 26) + 2224LL))(
                                             *((_QWORD *)v30 + 26),
                                             v20,
                                             v13,
                                             (unsigned int)v29,
                                             v14,
                                             v18);
                    v35 = v25;
                    v36 = v6;
                    v37 = 0;
                    v10 = (*(int (__fastcall **)(_QWORD, char *, _QWORD, _QWORD, _QWORD))(**((_QWORD **)v30 + 27)
                                                                                        + 2424LL))(
                            *((_QWORD *)v30 + 27),
                            &v31,
                            *(_DWORD *)(*((_QWORD *)v30 + 43) + 128LL),
                            0LL,
                            0LL);
                    if ( v10 == -536854449 )
                    {
                      IOSleep(100LL);
                      v10 = (*(int (__fastcall **)(_QWORD, char *, _QWORD, _QWORD, _QWORD))(**((_QWORD **)v30 + 27)
                                                                                          + 2424LL))(
                              *((_QWORD *)v30 + 27),
                              &v31,
                              *(_DWORD *)(*((_QWORD *)v30 + 43) + 128LL),
                              0LL,
                              0LL);
                    }
                    if ( !v10 && v37 != v26 )
                    {
                      IOSleep(100LL);
                      v31 = -127;
                      v32 = 6;
                      v33 = v29;
                      v34 = (unsigned __int8)(*(int (**)(void))(**((_QWORD **)v30 + 26) + 2224LL))();
                      v35 = v25;
                      v36 = v6;
                      v37 = 0;
                      return (*(int (__fastcall **)(_QWORD, char *, _QWORD, _QWORD, _QWORD))(**((_QWORD **)v30 + 27)
                                                                                           + 2424LL))(
                               *((_QWORD *)v30 + 27),
                               &v31,
                               *(_DWORD *)(*((_QWORD *)v30 + 43) + 128LL),
                               0LL,
                               0LL);
                    }
                  }
                }
              }
            }
          }
        }
        else
        {
          v24 = *(_BYTE *)v12;
          *v5 = v24;
          v10 = 0;
          if ( v15 )
          {
            v10 = -536870181;
            if ( (unsigned int)v24 <= v15 )
            {
              v10 = -536870206;
              if ( v6 )
              {
                memcpy(v6, (const void *)v12, v24);
                v10 = 0;
              }
            }
          }
        }
      }
    }
  }
  return v10;
}
// 102F0: using guessed type int __fastcall IOSleep(_QWORD);

//----- (0000000000003BAA) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::newSerialNumberString(IOUSBHIDDriver *this)
{
  __int64 *v1; // r14@1
  unsigned __int8 v2; // al@1
  const char *v3; // rsi@1
  int v4; // ecx@1
  __int64 result; // rax@1
  __int64 v6; // rcx@3
  unsigned int v7; // [sp+Ch] [bp-124h]@1
  unsigned __int8 v8; // [sp+10h] [bp-120h]@1
  __int64 v9; // [sp+118h] [bp-18h]@1

  v1 = off_6030[0];
  v9 = *off_6030[0];
  v8 = 0;
  v2 = (*(int (**)(void))(**((_QWORD **)this + 27) + 2336LL))();
  v7 = 256;
  v3 = (const char *)v2;
  v4 = IOUSBHIDDriver::GetIndexedString(this, v2, &v8, &v7, 1033);
  result = 0LL;
  if ( !v4 )
    result = OSString::withCString((OSString *)&v8, v3);
  v6 = *v1;
  return result;
}
// 6030: using guessed type __int64 *off_6030[4];

//----- (0000000000003C38) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::newTransportString(IOUSBHIDDriver *this, const char *a2)
{
  return OSString::withCString("USB", a2);
}

//----- (0000000000003C4A) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::newVendorIDNumber(IOUSBHIDDriver *this, __int64 a2, unsigned int a3)
{
  __int64 v3; // rax@1
  OSNumber *v4; // rdi@1

  v3 = *((_QWORD *)this + 27);
  v4 = 0LL;
  if ( v3 )
    v4 = (OSNumber *)(unsigned __int16)(*(int (__fastcall **)(__int64))(*(_QWORD *)v3 + 2288LL))(v3);
  return OSNumber::withNumber(v4, 0x10uLL, a3);
}

//----- (0000000000003C76) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::newVersionNumber(IOUSBHIDDriver *this, __int64 a2, unsigned int a3)
{
  __int64 v3; // rax@1
  OSNumber *v4; // rdi@1

  v3 = *((_QWORD *)this + 27);
  v4 = 0LL;
  if ( v3 )
    v4 = (OSNumber *)(unsigned __int16)(*(int (__fastcall **)(__int64))(*(_QWORD *)v3 + 2304LL))(v3);
  return OSNumber::withNumber(v4, 0x10uLL, a3);
}

//----- (0000000000003CA2) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::newCountryCodeNumber(IOUSBHIDDriver *this)
{
  __int64 v1; // rdi@1
  __int64 v2; // rax@2
  unsigned int v3; // edx@2
  __int64 result; // rax@3

  v1 = *((_QWORD *)this + 26);
  if ( v1
    && (LODWORD(v2) = (*(int (__fastcall **)(__int64, _QWORD, signed __int64))(*(_QWORD *)v1 + 2184LL))(v1, 0LL, 33LL),
        v2) )
    result = OSNumber::withNumber((OSNumber *)*(_BYTE *)(v2 + 4), 8uLL, v3);
  else
    result = 0LL;
  return result;
}

//----- (0000000000003CDA) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::newReportIntervalNumber(IOUSBHIDDriver *this, __int64 a2, unsigned int a3)
{
  __int64 v3; // rax@1
  signed __int64 v4; // rdi@1
  unsigned int v5; // eax@2

  v3 = *((_QWORD *)this + 28);
  v4 = 8000LL;
  if ( v3 )
  {
    LOBYTE(v5) = (*(int (__fastcall **)(__int64))(*(_QWORD *)v3 + 424LL))(v3);
    v4 = 32000LL;
    if ( (unsigned __int8)v5 <= 0x1Fu )
    {
      v5 = (unsigned __int8)v5;
      v4 = 16000LL;
      if ( (unsigned __int8)v5 <= 0xFu )
      {
        v4 = 8000LL;
        if ( v5 <= 7 )
        {
          v4 = 4000LL;
          if ( v5 <= 3 )
          {
            v4 = 1000LL;
            if ( v5 > 1 )
              v4 = 2000LL;
          }
        }
      }
    }
  }
  return OSNumber::withNumber((OSNumber *)v4, 0x20uLL, a3);
}

//----- (0000000000003D46) ----------------------------------------------------
int __fastcall IOUSBHIDDriver::InterruptReadHandlerEntry(IOUSBHIDDriver *this, OSObject *a2, void *a3, unsigned int a4)
{
  unsigned int v4; // er14@1
  int v5; // er15@1
  IOUSBHIDDriver *v6; // rax@1
  IOUSBHIDDriver *v7; // rbx@1
  __int64 v8; // rax@2

  v4 = a4;
  v5 = (signed int)a3;
  LODWORD(v6) = OSMetaClassBase::safeMetaCast(this, &IOUSBHIDDriver::gMetaClass);
  v7 = v6;
  if ( v6 )
  {
    v8 = mach_absolute_time();
    IOUSBHIDDriver::InterruptReadHandler(v7, (unsigned int)v5, v4, v8);
    LODWORD(v6) = (*(int (__fastcall **)(IOUSBHIDDriver *, _QWORD))(*(_QWORD *)v7 + 2648LL))(v7, (unsigned int)v5);
  }
  return (signed int)v6;
}
// 6F48: using guessed type _QWORD IOUSBHIDDriver::gMetaClass;
// 106C0: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000003DA2) ----------------------------------------------------
void __fastcall IOUSBHIDDriver::InterruptReadHandler(IOUSBHIDDriver *this, uintptr_t a2, unsigned int a3, __int64 a4)
{
  unsigned int v4; // er15@1
  signed int v5; // er14@1
  uintptr_t v6; // r12@1
  __int64 v7; // rax@1
  uintptr_t v8; // rcx@4
  uintptr_t v9; // rdx@4
  uintptr_t v10; // r8@4
  __int64 v11; // rdi@5
  uintptr_t v12; // rax@5
  char v13; // al@15
  char v14; // cl@15
  __int64 v15; // rdi@23
  __int64 v16; // rbx@26
  void (__fastcall *v17)(_QWORD, _QWORD); // r13@26
  __int64 v18; // rax@26
  uintptr_t v19; // rax@27
  uintptr_t v20; // r8@32
  __int64 v21; // rax@33
  __int64 *v22; // rbx@41
  __int64 v23; // rdi@49
  __int64 *v24; // rbx@50
  uint64_t v25; // rax@58
  __int64 v26; // rsi@58
  __int64 v27; // rdi@58
  signed __int64 v28; // rsi@58
  char v29; // bl@66
  uintptr_t v30; // r8@66

  v4 = a3;
  v5 = a2;
  v6 = (uintptr_t)this;
  v7 = *((_QWORD *)this + 43);
  *(_BYTE *)(v7 + 112) = 0;
  *(_QWORD *)(v7 + 88) = a4;
  if ( (_DWORD)a2 )
  {
    if ( *(_BYTE *)off_6038[0] & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
    {
      v8 = *((_BYTE *)this + 298);
      v9 = (signed int)a2;
      v10 = 1LL;
      a2 = (uintptr_t)this;
LABEL_10:
      kernel_debug(0x52D1C3Cu, a2, v9, v8, v10, 0LL);
      goto LABEL_11;
    }
  }
  else
  {
    v11 = *((_QWORD *)this + 30);
    v12 = 0LL;
    if ( v11 )
      LODWORD(v12) = (*(int (__cdecl **)(__int64))(*(_QWORD *)v11 + 728LL))(v11);
    if ( *(_BYTE *)off_6038[0] & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
    {
      v9 = v12 - v4;
      v10 = 0LL;
      a2 = v6;
      v8 = v12;
      goto LABEL_10;
    }
  }
LABEL_11:
  *(_BYTE *)(*(_QWORD *)(v6 + 344) + 83LL) = 0;
  if ( v5 >= 0 )
  {
    if ( v5 )
      goto LABEL_48;
  }
  else
  {
    if ( v5 > -536854454 )
    {
      if ( v5 == -536854453 )
      {
LABEL_38:
        if ( *(_BYTE *)(v6 + 298) || (unsigned __int8)IOService::isInactive((IOService *)v6) || !*(_QWORD *)(v6 + 224) )
          return;
        v22 = off_6038[0];
        if ( *(_BYTE *)off_6038[0] & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
        {
          a2 = v6;
          kernel_debug(0x52D1C3Cu, v6, 0LL, 0LL, 7uLL, 0LL);
        }
        (*(void (__fastcall **)(uintptr_t, uintptr_t))(*(_QWORD *)v6 + 2656LL))(v6, a2);
        if ( thread_call_enter(*(_QWORD *)(v6 + 280)) != 1 )
          return;
        (*(void (__fastcall **)(uintptr_t))(*(_QWORD *)v6 + 2648LL))(v6);
        if ( !(*(_BYTE *)v22 & 2) || !(*(_DWORD *)off_6048 & 0xFFFFFFF7) )
          return;
        v20 = 8LL;
        goto LABEL_57;
      }
LABEL_48:
      if ( (unsigned __int8)IOService::isInactive((IOService *)v6) )
        return;
      v23 = *(_QWORD *)(v6 + 224);
      if ( !v23 )
        return;
      v24 = off_6038[0];
      if ( *(_BYTE *)off_6038[0] & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
      {
        kernel_debug(0x52D1C3Cu, v6, 0LL, 0LL, 0xBuLL, 0LL);
        v23 = *(_QWORD *)(v6 + 224);
      }
      (*(void (__cdecl **)(__int64))(*(_QWORD *)v23 + 312LL))(v23);
      (*(void (__fastcall **)(uintptr_t))(*(_QWORD *)v6 + 2656LL))(v6);
      if ( thread_call_enter(*(_QWORD *)(v6 + 288)) != 1 )
        return;
      (*(void (__fastcall **)(uintptr_t))(*(_QWORD *)v6 + 2648LL))(v6);
      if ( !(*(_BYTE *)v24 & 2) || !(*(_DWORD *)off_6048 & 0xFFFFFFF7) )
        return;
      v20 = 12LL;
LABEL_57:
      kernel_debug(0x52D1C3Cu, v6, 0LL, 0LL, v20, 0LL);
      return;
    }
    if ( v5 != -536870168 )
    {
      if ( v5 == -536870165 )
      {
        v13 = IOService::isInactive((IOService *)v6);
        v14 = *(_BYTE *)(v6 + 297);
        if ( v13 )
        {
          if ( !v14 )
            goto LABEL_72;
        }
        else if ( !v14 )
        {
          if ( !*(_QWORD *)(v6 + 224) )
          {
LABEL_72:
            v29 = 0;
            goto LABEL_73;
          }
          v29 = 1;
          if ( !(*(_BYTE *)off_6038[0] & 2) || !(*(_DWORD *)off_6048 & 0xFFFFFFF7) )
          {
LABEL_73:
            if ( *(_BYTE *)off_6038[0] & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
            {
              a2 = v6;
              kernel_debug(0x52D1C40u, v6, *(_BYTE *)(v6 + 297), (unsigned __int8)v29, 0xFFFFFFFFE00002EBLL, 0LL);
            }
            if ( v29 )
            {
LABEL_77:
              if ( *(_BYTE *)off_6038[0] & 2 )
              {
                if ( *(_DWORD *)off_6048 & 0xFFFFFFF7 )
                {
                  a2 = v6;
                  kernel_debug(0x52D1C3Cu, v6, v5, 0LL, 0x10uLL, 0LL);
                }
              }
              (*(void (__fastcall **)(uintptr_t, uintptr_t))(*(_QWORD *)v6 + 2680LL))(v6, a2);
              return;
            }
            return;
          }
          v30 = 9LL;
LABEL_67:
          a2 = v6;
          kernel_debug(0x52D1C3Cu, v6, 0LL, 0LL, v30, 0LL);
          goto LABEL_73;
        }
        if ( !(*(_BYTE *)off_6038[0] & 2) || !(*(_DWORD *)off_6048 & 0xFFFFFFF7) )
          goto LABEL_72;
        v29 = 0;
        v30 = 10LL;
        goto LABEL_67;
      }
      if ( v5 == -536870163 )
        goto LABEL_38;
      goto LABEL_48;
    }
    if ( !(unsigned __int8)IOService::isInactive((IOService *)v6) )
    {
      v15 = *(_QWORD *)(v6 + 224);
      if ( v15 )
      {
        (*(void (__cdecl **)(__int64))(*(_QWORD *)v15 + 312LL))(v15);
        *(_BYTE *)(*(_QWORD *)(v6 + 344) + 83LL) = 1;
      }
    }
  }
  *(_DWORD *)(v6 + 272) = *(_DWORD *)(*(_QWORD *)(v6 + 344) + 132LL);
  *(_BYTE *)(v6 + 298) = 0;
  if ( v4 )
  {
    v16 = *(_QWORD *)(v6 + 240);
    v17 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v16 + 712LL);
    LODWORD(v18) = (*(int (__fastcall **)(_QWORD))(*(_QWORD *)v16 + 728LL))(*(_QWORD *)(v6 + 240));
    a2 = v18 - v4;
    v17(v16, a2);
    if ( *(_BYTE *)off_6038[0] & 2 )
    {
      LODWORD(v19) = (*(int (__cdecl **)(_QWORD))(**(_QWORD **)(v6 + 240) + 456LL))(*(_QWORD *)(v6 + 240));
      if ( *(_DWORD *)off_6048 & 0xFFFFFFF7 )
      {
        a2 = v6;
        kernel_debug(0x52D1C3Cu, v6, v19, 0LL, 0xFuLL, 0LL);
      }
    }
  }
  if ( *(_DWORD *)(*(_QWORD *)(v6 + 344) + 84LL) > 0 )
  {
    if ( !(*(_BYTE *)off_6038[0] & 2) || !(*(_DWORD *)off_6048 & 0xFFFFFFF7) )
      return;
    v20 = 5LL;
    goto LABEL_57;
  }
  LODWORD(v21) = (*(int (__fastcall **)(_QWORD, uintptr_t))(**(_QWORD **)(v6 + 240) + 728LL))(*(_QWORD *)(v6 + 240), a2);
  if ( v4 == v21 )
  {
    if ( *(_BYTE *)off_6038[0] & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
    {
      a2 = v6;
      kernel_debug(0x52D1C3Cu, v6, 0LL, 0LL, 4uLL, 0LL);
    }
    goto LABEL_77;
  }
  (*(void (__fastcall **)(uintptr_t))(*(_QWORD *)v6 + 2656LL))(v6);
  ++*(_DWORD *)(*(_QWORD *)(v6 + 344) + 84LL);
  v25 = mach_absolute_time();
  v26 = *(_QWORD *)(v6 + 344);
  *(_QWORD *)(v26 + 120) = v25;
  v27 = *(_QWORD *)(v26 + 8);
  v28 = v26 + 88;
  if ( thread_call_enter1(v27, v28) == 1 )
  {
    if ( *(_BYTE *)off_6038[0] & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
    {
      v28 = v6;
      kernel_debug(0x52D1C3Cu, v6, 0LL, 0LL, 3uLL, 0LL);
    }
    (*(void (__fastcall **)(uintptr_t, signed __int64))(*(_QWORD *)v6 + 2648LL))(v6, v28);
    --*(_DWORD *)(*(_QWORD *)(v6 + 344) + 84LL);
  }
}
// 6038: using guessed type __int64 *off_6038[3];
// 6048: using guessed type __int64 *off_6048;
// 10E10: using guessed type int __fastcall thread_call_enter(_QWORD);
// 10E18: using guessed type int __fastcall thread_call_enter1(_QWORD, _QWORD);

//----- (000000000000438A) ----------------------------------------------------
int __fastcall IOUSBHIDDriver::InterruptReadHandlerWithTimeStampEntry(IOUSBHIDDriver *this, OSObject *a2, void *a3, unsigned int a4, __int64 a5)
{
  __int64 v5; // r14@1
  unsigned int v6; // er15@1
  int v7; // er12@1
  IOUSBHIDDriver *v8; // rax@1
  IOUSBHIDDriver *v9; // rbx@1

  v5 = a5;
  v6 = a4;
  v7 = (signed int)a3;
  LODWORD(v8) = OSMetaClassBase::safeMetaCast(this, &IOUSBHIDDriver::gMetaClass);
  v9 = v8;
  if ( v8 )
  {
    IOUSBHIDDriver::InterruptReadHandler(v8, (unsigned int)v7, v6, v5);
    LODWORD(v8) = (*(int (__fastcall **)(IOUSBHIDDriver *, _QWORD))(*(_QWORD *)v9 + 2648LL))(v9, (unsigned int)v7);
  }
  return (signed int)v8;
}
// 6F48: using guessed type _QWORD IOUSBHIDDriver::gMetaClass;
// 106C0: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (00000000000043E0) ----------------------------------------------------
void __usercall IOUSBHIDDriver::CheckForDeadDevice(uintptr_t arg1@<rdi>, __int64 a2@<rax>)
{
  uintptr_t v2; // rbx@1
  uintptr_t v3; // rdx@4
  uintptr_t v4; // rcx@4
  uintptr_t v5; // r8@4
  uintptr_t v6; // rsi@5
  char v7; // al@5
  __int64 *v8; // r15@5
  int v9; // ecx@5
  __int64 v10; // rdi@10
  char *v11; // rsi@11
  int v12; // er14@11
  int v13; // eax@11
  int v14; // eax@15
  int v15; // eax@16
  uintptr_t v16; // rdx@19
  uintptr_t v17; // r8@19
  int v18; // eax@37
  int v19; // eax@38
  __int64 v20; // rdi@42
  int v21; // er14@43
  __int64 v22; // rdi@48
  __int64 v23; // rdi@50
  __int64 v24; // [sp-4h] [bp-20h]@1

  v24 = a2;
  v2 = arg1;
  if ( (unsigned __int8)IOService::isInactive((IOService *)arg1) )
  {
    if ( *(_BYTE *)off_6038[0] & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
    {
      v3 = 0LL;
      v4 = 0LL;
      v5 = 12LL;
LABEL_23:
      kernel_debug(0x52D1C44u, arg1, v3, v4, v5, 0LL);
      return;
    }
    return;
  }
  v6 = 1LL;
  v7 = OSCompareAndSwap(0LL, 1LL, *(_QWORD *)(arg1 + 344) + 116LL);
  v8 = off_6038[0];
  v9 = *(_DWORD *)off_6038[0] & 2;
  if ( v7 )
  {
    if ( v9 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
    {
      v6 = arg1;
      kernel_debug(0x52D1C44u, arg1, *(_DWORD *)(arg1 + 272), *(_BYTE *)(arg1 + 298), 2uLL, 0LL);
    }
    if ( *(_QWORD *)(arg1 + 208) && (v10 = *(_QWORD *)(arg1 + 216)) != 0 )
    {
      HIDWORD(v24) = 0;
      (*(void (__fastcall **)(__int64, uintptr_t))(*(_QWORD *)v10 + 32LL))(v10, v6);
      v11 = (char *)&v24 + 4;
      v12 = (*(int (__fastcall **)(_QWORD, char *))(**(_QWORD **)(v2 + 216) + 2488LL))(
              *(_QWORD *)(v2 + 216),
              (char *)&v24 + 4);
      (*(void (__cdecl **)(_QWORD))(**(_QWORD **)(v2 + 216) + 40LL))(*(_QWORD *)(v2 + 216));
      v13 = *(_DWORD *)v8 & 2;
      if ( v12 )
      {
        if ( v13 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
          kernel_debug(0x52D1C44u, v2, v12, *(_DWORD *)(v2 + 272), 3uLL, 0LL);
        v14 = *(_DWORD *)(v2 + 272);
        if ( v14 && (v15 = v14 - 1, (*(_DWORD *)(v2 + 272) = v15) != 0) )
        {
          if ( !(*(_BYTE *)v8 & 2) || !(*(_DWORD *)off_6048 & 0xFFFFFFF7) )
            goto LABEL_60;
          v16 = (unsigned int)v15;
          v17 = 13LL;
        }
        else
        {
          *(_BYTE *)(v2 + 298) = 1;
          if ( !(*(_BYTE *)v8 & 2) || !(*(_DWORD *)off_6048 & 0xFFFFFFF7) )
            goto LABEL_60;
          v16 = 0LL;
          v17 = 4LL;
        }
      }
      else
      {
        if ( v13 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
        {
          v11 = (char *)v2;
          kernel_debug(0x52D1C44u, v2, HIDWORD(v24), *(_DWORD *)(v2 + 272), 5uLL, 0LL);
        }
        if ( BYTE4(v24) & 8 )
        {
          if ( *(_BYTE *)v8 & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
          {
            v11 = (char *)v2;
            kernel_debug(0x52D1C44u, v2, *(_DWORD *)(v2 + 272), 0LL, 6uLL, 0LL);
          }
          v18 = *(_DWORD *)(v2 + 272);
          if ( v18 && (v19 = v18 - 1, (*(_DWORD *)(v2 + 272) = v19) != 0) )
          {
            if ( *(_BYTE *)v8 & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
            {
              v11 = (char *)v2;
              kernel_debug(0x52D1C44u, v2, (unsigned int)v19, *(_QWORD *)(v2 + 224), 0xBuLL, 0LL);
            }
            v20 = *(_QWORD *)(v2 + 224);
            if ( v20 )
            {
              v21 = (*(int (__fastcall **)(__int64, char *))(*(_QWORD *)v20 + 312LL))(v20, v11);
              if ( *(_BYTE *)v8 & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
                kernel_debug(0x52D1C44u, v2, v21, 0LL, 0xEuLL, 0LL);
              if ( !v21 )
                IOUSBHIDDriver::ClearFeatureEndpointHalt(v2);
            }
          }
          else
          {
            *(_BYTE *)(v2 + 297) = 1;
            v22 = *(_QWORD *)(v2 + 224);
            if ( v22 )
              (*(void (__fastcall **)(__int64, char *))(*(_QWORD *)v22 + 296LL))(v22, v11);
            v23 = *(_QWORD *)(v2 + 312);
            if ( v23 )
              (*(void (__fastcall **)(__int64, char *))(*(_QWORD *)v23 + 296LL))(v23, v11);
            if ( *(_BYTE *)v8 & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
            {
              v11 = (char *)v2;
              kernel_debug(0x52D1C44u, v2, 0LL, 0LL, 7uLL, 0LL);
            }
            (*(void (__fastcall **)(_QWORD, char *))(**(_QWORD **)(v2 + 216) + 2232LL))(*(_QWORD *)(v2 + 216), v11);
          }
          goto LABEL_60;
        }
        *(_BYTE *)(v2 + 298) = 1;
        if ( !(*(_BYTE *)v8 & 2) || !(*(_DWORD *)off_6048 & 0xFFFFFFF7) )
        {
LABEL_60:
          *(_DWORD *)(*(_QWORD *)(v2 + 344) + 116LL) = 0;
          return;
        }
        v16 = *(_QWORD *)(v2 + 216);
        v17 = 8LL;
      }
    }
    else
    {
      if ( !(*(_BYTE *)v8 & 2) || !(*(_DWORD *)off_6048 & 0xFFFFFFF7) )
        goto LABEL_60;
      v16 = 0LL;
      v17 = 9LL;
    }
    kernel_debug(0x52D1C44u, v2, v16, 0LL, v17, 0LL);
    goto LABEL_60;
  }
  if ( v9 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
  {
    v4 = *(_BYTE *)(arg1 + 298);
    v3 = *(_DWORD *)(arg1 + 272);
    v5 = 1LL;
    goto LABEL_23;
  }
}
// 6038: using guessed type __int64 *off_6038[3];
// 6048: using guessed type __int64 *off_6048;
// 10300: using guessed type int __fastcall OSCompareAndSwap(_QWORD, _QWORD, _QWORD);

//----- (0000000000004800) ----------------------------------------------------
void __fastcall IOUSBHIDDriver::ClearFeatureEndpointHalt(uintptr_t arg1)
{
  uintptr_t v1; // r15@1
  __int64 *v2; // r12@1
  char *v3; // rsi@5
  uintptr_t v4; // rbx@5
  __int64 *v5; // r13@5
  __int64 v6; // rdi@6
  int v7; // eax@7
  int v8; // eax@12
  uintptr_t v9; // rdx@14
  uint32_t v10; // edi@14
  char v11; // [sp+0h] [bp-40h]@5
  char v12; // [sp+1h] [bp-3Fh]@7
  __int16 v13; // [sp+2h] [bp-3Eh]@7
  __int16 v14; // [sp+4h] [bp-3Ch]@7
  __int16 v15; // [sp+6h] [bp-3Ah]@7
  __int64 v16; // [sp+8h] [bp-38h]@7

  v1 = arg1;
  v2 = off_6038[0];
  if ( *(_BYTE *)off_6038[0] & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
    kernel_debug(0x52D1C1Du, arg1, 0LL, 0LL, 0LL, 0LL);
  if ( *(_QWORD *)(arg1 + 224) )
  {
    v3 = (char *)&dword_18;
    bzero(&v11, 0x18uLL);
    v4 = 7LL;
    v5 = off_6048;
    do
    {
      v6 = *(_QWORD *)(v1 + 224);
      if ( !v6 )
        break;
      v11 = 2;
      v12 = 1;
      v13 = 0;
      v14 = (unsigned __int8)(*(int (__fastcall **)(__int64, char *))(*(_QWORD *)v6 + 400LL))(v6, v3) | 0x80;
      v15 = 0;
      v16 = 0LL;
      v3 = &v11;
      v7 = (*(int (__fastcall **)(_QWORD, char *, signed __int64, _QWORD, _QWORD))(**(_QWORD **)(v1 + 216) + 2424LL))(
             *(_QWORD *)(v1 + 216),
             &v11,
             5000LL,
             0LL,
             0LL);
      if ( !v7 )
        break;
      if ( *(_BYTE *)v2 & 2 && *(_DWORD *)v5 & 0xFFFFFFF7 )
      {
        v3 = (char *)v1;
        kernel_debug(0x52D1C1Cu, v1, v7, v4, 1uLL, 0LL);
      }
      IOSleep(25LL);
      --v4;
    }
    while ( (_DWORD)v4 != -1 );
    v8 = (*(int (__fastcall **)(uintptr_t, char *))(*(_QWORD *)v1 + 2680LL))(v1, v3);
    if ( *(_BYTE *)v2 & 2 && *(_DWORD *)v5 & 0xFFFFFFF7 )
    {
      v9 = v8;
      v10 = 86842398;
LABEL_18:
      kernel_debug(v10, v1, v9, 0LL, 0LL, 0LL);
      return;
    }
  }
  else if ( *(_BYTE *)v2 & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
  {
    v10 = 86842396;
    v9 = 0LL;
    goto LABEL_18;
  }
}
// 18: using guessed type int;
// 6038: using guessed type __int64 *off_6038[3];
// 6048: using guessed type __int64 *off_6048;
// 102F0: using guessed type int __fastcall IOSleep(_QWORD);

//----- (000000000000497C) ----------------------------------------------------
int __fastcall IOUSBHIDDriver::HandleReport(IOUSBHIDDriver *this)
{
  IOUSBHIDDriver *v1; // rbx@1
  __int64 v2; // rax@1
  __int64 v3; // rax@2
  __int64 v4; // r14@3
  void (__fastcall *v5)(_QWORD, _QWORD, _QWORD, _QWORD); // r12@3
  unsigned int v6; // er15@3
  __int64 v7; // rax@3
  __int64 *v8; // r15@4
  uintptr_t v9; // rax@5
  uintptr_t v10; // r14@5
  uintptr_t v11; // rax@5
  IOUSBHIDDriver *v12; // rsi@7
  int v13; // er14@7
  uintptr_t v14; // rax@8
  unsigned __int64 v15; // rax@11
  __int64 v16; // rdx@11
  signed __int64 v17; // rcx@11
  __int64 v18; // rax@16
  __int64 v19; // rdi@16
  int result; // eax@18

  v1 = this;
  LODWORD(v2) = (*(int (**)(void))(**((_QWORD **)this + 30) + 456LL))();
  if ( v2 )
  {
    v3 = *((_QWORD *)this + 43);
    if ( *(_BYTE *)(v3 + 81) )
    {
      v4 = *((_QWORD *)this + 30);
      v5 = *(void (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)this + 2704LL);
      v6 = *(_BYTE *)(v3 + 82);
      LODWORD(v7) = (*(int (__fastcall **)(_QWORD))(*(_QWORD *)v4 + 456LL))(*((_QWORD *)this + 30));
      v5(this, v6, v4, v7);
    }
    v8 = off_6038[0];
    if ( *(_BYTE *)off_6038[0] & 2 )
    {
      LODWORD(v9) = (*(int (**)(void))(**((_QWORD **)this + 30) + 456LL))();
      v10 = v9;
      LODWORD(v11) = (*(int (**)(void))(**((_QWORD **)this + 30) + 728LL))();
      if ( *(_DWORD *)off_6048 & 0xFFFFFFF7 )
        kernel_debug(0x52D1C3Cu, (uintptr_t)this, v10, v11, 0x11uLL, 0LL);
    }
    v12 = (IOUSBHIDDriver *)*((_QWORD *)this + 30);
    v13 = (*(int (__fastcall **)(IOUSBHIDDriver *, IOUSBHIDDriver *, _QWORD, _QWORD))(*(_QWORD *)this + 2232LL))(
            this,
            v12,
            0LL,
            0LL);
    if ( *(_BYTE *)v8 & 2 )
    {
      LODWORD(v14) = (*(int (**)(void))(**((_QWORD **)this + 30) + 456LL))();
      if ( *(_DWORD *)off_6048 & 0xFFFFFFF7 )
      {
        v12 = this;
        kernel_debug(0x52D1C3Cu, (uintptr_t)this, v14, v13, 0x12uLL, 0LL);
      }
    }
    if ( v13 )
    {
      LODWORD(v15) = (*(int (__fastcall **)(_QWORD, IOUSBHIDDriver *))(**((_QWORD **)this + 30) + 456LL))(
                       *((_QWORD *)this + 30),
                       v12);
      v17 = 16LL;
      if ( v15 <= 0x10 )
        v17 = (unsigned int)(*(int (__fastcall **)(_QWORD, IOUSBHIDDriver *, __int64, signed __int64))(**((_QWORD **)this + 30) + 456LL))(
                              *((_QWORD *)this + 30),
                              v12,
                              v16,
                              16LL);
      (*(void (__fastcall **)(IOUSBHIDDriver *, signed __int64, _QWORD, signed __int64))(*(_QWORD *)this + 2704LL))(
        this,
        1LL,
        *((_QWORD *)this + 30),
        v17);
      if ( *(_BYTE *)v8 & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
        kernel_debug(0x52D1C20u, (uintptr_t)this, v13, 0LL, 0LL, 0LL);
    }
  }
  v18 = *((_QWORD *)this + 43);
  --*(_DWORD *)(v18 + 84);
  v19 = *(_QWORD *)(v18 + 64);
  if ( v19 )
  {
    (*(void (**)(void))(*(_QWORD *)v19 + 536LL))();
    (*(void (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(*((_QWORD *)v1 + 43) + 64LL) + 464LL))(
      *(_QWORD *)(*((_QWORD *)v1 + 43) + 64LL),
      *(_DWORD *)(*((_QWORD *)v1 + 43) + 76LL));
  }
  result = IOService::isInactive(v1);
  if ( !(_BYTE)result )
  {
    if ( *(_BYTE *)(*((_QWORD *)v1 + 43) + 83LL) )
    {
      (*(void (__fastcall **)(IOUSBHIDDriver *))(*(_QWORD *)v1 + 2656LL))(v1);
      result = thread_call_enter(*((_QWORD *)v1 + 36));
      if ( result == 1 )
        result = (*(int (__fastcall **)(IOUSBHIDDriver *))(*(_QWORD *)v1 + 2648LL))(v1);
    }
    else
    {
      result = (*(int (__fastcall **)(IOUSBHIDDriver *))(*(_QWORD *)v1 + 2680LL))(v1);
    }
  }
  return result;
}
// 6038: using guessed type __int64 *off_6038[3];
// 6048: using guessed type __int64 *off_6048;
// 10E10: using guessed type int __fastcall thread_call_enter(_QWORD);

//----- (0000000000004BA8) ----------------------------------------------------
int __fastcall IOUSBHIDDriver::SuspendPortTimer(__int64 a1, __int64 a2)
{
  IOService *v2; // rax@1
  uintptr_t v3; // rbx@1

  LODWORD(v2) = OSMetaClassBase::safeMetaCast(a1, &IOUSBHIDDriver::gMetaClass);
  v3 = (uintptr_t)v2;
  if ( v2 )
  {
    if ( a2 )
    {
      LODWORD(v2) = IOService::isInactive(v2);
      if ( !(_BYTE)v2 )
        LODWORD(v2) = IOUSBHIDDriver::AbortAndSuspend(v3, 1);
    }
  }
  return (signed int)v2;
}
// 6F48: using guessed type _QWORD IOUSBHIDDriver::gMetaClass;
// 106C0: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000004BEE) ----------------------------------------------------
int __fastcall IOUSBHIDDriver::AbortAndSuspend(uintptr_t arg1, char a2)
{
  uintptr_t v2; // rbx@1
  __int64 v3; // rdi@3
  __int64 v4; // rdi@5
  int v5; // er14@7
  uintptr_t v6; // rsi@11
  int v7; // eax@11
  int result; // eax@15

  v2 = arg1;
  if ( a2 )
  {
    if ( *(_DWORD *)(arg1 + 300) )
    {
      *(_BYTE *)(arg1 + 297) = 1;
      v3 = *(_QWORD *)(arg1 + 224);
      if ( v3 )
        (*(void (**)(void))(*(_QWORD *)v3 + 296LL))();
      v4 = *(_QWORD *)(v2 + 312);
      if ( v4 )
        (*(void (**)(void))(*(_QWORD *)v4 + 296LL))();
    }
    v5 = (*(int (__fastcall **)(_QWORD, signed __int64))(**(_QWORD **)(v2 + 216) + 2440LL))(*(_QWORD *)(v2 + 216), 1LL);
    if ( v5 )
    {
      if ( *(_BYTE *)off_6038[0] & 2 )
      {
        if ( *(_DWORD *)off_6048 & 0xFFFFFFF7 )
          kernel_debug(0x52D1C28u, v2, v5, 0LL, 1uLL, 0LL);
      }
    }
    else
    {
      *(_BYTE *)(*(_QWORD *)(v2 + 344) + 72LL) = 1;
      v5 = 0;
    }
    result = v5;
  }
  else
  {
    *(_BYTE *)(arg1 + 297) = 0;
    v6 = 0LL;
    v7 = (*(int (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(arg1 + 216) + 2440LL))(*(_QWORD *)(arg1 + 216), 0LL);
    if ( v7 && *(_BYTE *)off_6038[0] & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
    {
      v6 = arg1;
      kernel_debug(0x52D1C28u, arg1, v7, 0LL, 2uLL, 0LL);
    }
    result = (*(int (__fastcall **)(uintptr_t, uintptr_t))(*(_QWORD *)arg1 + 2680LL))(arg1, v6);
  }
  return result;
}
// 6038: using guessed type __int64 *off_6038[3];
// 6048: using guessed type __int64 *off_6048;

//----- (0000000000004D16) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::getMaxReportSize(IOUSBHIDDriver *this)
{
  __int64 v1; // rax@1
  __int64 v2; // rbx@1
  __int64 v3; // r15@1
  __int64 v4; // rsi@1
  __int64 v5; // rax@1
  int v6; // er14@1
  __int64 v7; // rax@5
  __int64 v8; // r12@5
  __int64 v9; // rax@5
  int v10; // ebx@5

  LODWORD(v1) = (*(int (__fastcall **)(IOUSBHIDDriver *, _QWORD))(*(_QWORD *)this + 744LL))(this, "MaxInputReportSize");
  v2 = v1;
  v3 = *off_6020[0];
  v4 = *off_6020[0];
  LODWORD(v5) = OSMetaClassBase::safeMetaCast(v1, *off_6020[0]);
  v6 = 0;
  if ( v5 )
    v6 = (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v5 + 328LL))(v5, v4);
  if ( v2 )
    (*(void (__fastcall **)(__int64, __int64))(*(_QWORD *)v2 + 40LL))(v2, v4);
  LODWORD(v7) = (*(int (__fastcall **)(IOUSBHIDDriver *, _QWORD))(*(_QWORD *)this + 744LL))(
                  this,
                  "MaxFeatureReportSize");
  v8 = v7;
  LODWORD(v9) = OSMetaClassBase::safeMetaCast(v7, v3);
  v10 = 0;
  if ( v9 )
    v10 = (*(int (__fastcall **)(__int64, __int64))(*(_QWORD *)v9 + 328LL))(v9, v3);
  if ( v8 )
    (*(void (__fastcall **)(__int64, __int64))(*(_QWORD *)v8 + 40LL))(v8, v3);
  if ( v6 > (unsigned int)v10 )
    v10 = v6;
  return (unsigned int)v10;
}
// 6020: using guessed type _QWORD *off_6020[6];
// 106C0: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (0000000000004DCA) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::newIndexedString(IOUSBHIDDriver *this, const char *a2)
{
  __int64 *v2; // rbx@1
  int v3; // ecx@1
  __int64 result; // rax@1
  __int64 v5; // rcx@3
  unsigned int v6; // [sp+Ch] [bp-114h]@1
  unsigned __int8 v7; // [sp+10h] [bp-110h]@1
  __int64 v8; // [sp+110h] [bp-10h]@1

  v2 = off_6030[0];
  v8 = *off_6030[0];
  v7 = 0;
  v6 = 256;
  v3 = IOUSBHIDDriver::GetIndexedString(this, (unsigned __int8)a2, &v7, &v6, 1033);
  result = 0LL;
  if ( !v3 )
    result = OSString::withCString((OSString *)&v7, a2);
  v5 = *v2;
  return result;
}
// 6030: using guessed type __int64 *off_6030[4];

//----- (0000000000004E3A) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::StartFinalProcessing(IOUSBHIDDriver *this)
{
  __int64 v1; // rax@1

  v1 = *((_QWORD *)this + 43);
  *(_QWORD *)(v1 + 32) = this;
  *(_QWORD *)(v1 + 40) = IOUSBHIDDriver::InterruptReadHandlerWithTimeStampEntry;
  *(_QWORD *)(v1 + 48) = 0LL;
  *((_QWORD *)this + 31) = this;
  *((_QWORD *)this + 32) = IOUSBHIDDriver::InterruptReadHandlerEntry;
  *((_QWORD *)this + 33) = 0LL;
  return 0LL;
}

//----- (0000000000004E80) ----------------------------------------------------
int __fastcall IOUSBHIDDriver::SetIdleMillisecs(IOUSBHIDDriver *this, __int16 a2)
{
  char v3; // [sp+0h] [bp-20h]@1
  char v4; // [sp+1h] [bp-1Fh]@1
  __int16 v5; // [sp+2h] [bp-1Eh]@1
  __int16 v6; // [sp+4h] [bp-1Ch]@1
  __int16 v7; // [sp+6h] [bp-1Ah]@1
  __int64 v8; // [sp+8h] [bp-18h]@1

  v3 = 33;
  v4 = 10;
  v5 = (a2 << 6) & 0xFF00;
  v6 = (unsigned __int8)(*(int (__cdecl **)(_QWORD))(**((_QWORD **)this + 26) + 2224LL))(*((_QWORD *)this + 26));
  v7 = 0;
  v8 = 0LL;
  return (*(int (__fastcall **)(_QWORD, char *, _QWORD, _QWORD, _QWORD))(**((_QWORD **)this + 27) + 2424LL))(
           *((_QWORD *)this + 27),
           &v3,
           *(_DWORD *)(*((_QWORD *)this + 43) + 128LL),
           0LL,
           0LL);
}

//----- (0000000000004EF4) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::SuspendPort(IOUSBHIDDriver *this, char a2, unsigned int a3)
{
  unsigned int v3; // er15@1
  uintptr_t v4; // r12@1
  int v5; // er14@2
  __int64 v6; // rax@5
  __int64 v7; // rdi@5
  __int64 v8; // rdi@8
  __int64 v9; // rax@9
  __int64 v10; // rax@11
  char v11; // si@12
  __int64 v13; // rax@18
  __int64 v14; // rcx@18
  uintptr_t v15; // rdx@22
  uintptr_t v16; // r8@22
  __int64 v17; // rax@30

  v3 = a3;
  v4 = (uintptr_t)this;
  (*(void (**)(void))(*(_QWORD *)this + 2656LL))();
  if ( !(unsigned __int8)IOService::isInactive(this) )
  {
    if ( a2 )
    {
      if ( v3 )
      {
        v6 = *((_QWORD *)this + 43);
        v7 = *(_QWORD *)(v6 + 64);
        if ( v7 )
        {
          v5 = 0;
          if ( *(_DWORD *)(v6 + 76) != v3 )
          {
            *(_DWORD *)(v6 + 76) = v3;
            (*(void (**)(void))(*(_QWORD *)v7 + 536LL))();
            (*(void (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(*(_QWORD *)(v4 + 344) + 64LL) + 464LL))(
              *(_QWORD *)(*(_QWORD *)(v4 + 344) + 64LL),
              *(_DWORD *)(*(_QWORD *)(v4 + 344) + 76LL));
          }
          goto LABEL_15;
        }
        if ( *(_QWORD *)v6 )
        {
          LODWORD(v13) = IOTimerEventSource::timerEventSource(v4, IOUSBHIDDriver::SuspendPortTimer);
          v14 = *(_QWORD *)(v4 + 344);
          *(_QWORD *)(v14 + 64) = v13;
          if ( v13 )
          {
            v5 = (*(int (__fastcall **)(_QWORD, __int64))(**(_QWORD **)v14 + 320LL))(*(_QWORD *)v14, v13);
            if ( !v5 )
            {
              v17 = *(_QWORD *)(v4 + 344);
              *(_DWORD *)(v17 + 76) = v3;
              (*(void (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)(v17 + 64) + 464LL))(*(_QWORD *)(v17 + 64), v3);
              v5 = 0;
              goto LABEL_15;
            }
            if ( !(*(_BYTE *)off_6038[0] & 2) || !(*(_DWORD *)off_6048 & 0xFFFFFFF7) )
              goto LABEL_15;
            v15 = v5;
            v16 = 2LL;
          }
          else
          {
            v5 = -536870210;
            if ( !(*(_BYTE *)off_6038[0] & 2) || !(*(_DWORD *)off_6048 & 0xFFFFFFF7) )
              goto LABEL_15;
            v15 = -536870210LL;
            v16 = 1LL;
          }
        }
        else
        {
          v5 = -536870210;
          if ( !(*(_BYTE *)off_6038[0] & 2) || !(*(_DWORD *)off_6048 & 0xFFFFFFF7) )
            goto LABEL_15;
          v15 = -536870210LL;
          v16 = 3LL;
        }
        kernel_debug(0x52D1C24u, v4, v15, 0LL, v16, 0LL);
LABEL_15:
        (*(void (__fastcall **)(uintptr_t))(*(_QWORD *)v4 + 2648LL))(v4);
        return (unsigned int)v5;
      }
      v11 = 1;
    }
    else
    {
      v8 = *(_QWORD *)(*((_QWORD *)this + 43) + 64LL);
      if ( v8 )
      {
        (*(void (**)(void))(*(_QWORD *)v8 + 536LL))();
        v9 = *(_QWORD *)(v4 + 344);
        if ( *(_QWORD *)v9 )
        {
          (*(void (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)v9 + 328LL))(*(_QWORD *)v9, *(_QWORD *)(v9 + 64));
          v9 = *(_QWORD *)(v4 + 344);
        }
        (*(void (**)(void))(**(_QWORD **)(v9 + 64) + 40LL))();
        v10 = *(_QWORD *)(v4 + 344);
        *(_QWORD *)(v10 + 64) = 0LL;
        *(_DWORD *)(v10 + 76) = 0;
      }
      v11 = 0;
    }
    v5 = IOUSBHIDDriver::AbortAndSuspend(v4, v11);
    goto LABEL_15;
  }
  (*(void (__fastcall **)(IOUSBHIDDriver *))(*(_QWORD *)this + 2648LL))(this);
  v5 = -536870174;
  return (unsigned int)v5;
}
// 6038: using guessed type __int64 *off_6038[3];
// 6048: using guessed type __int64 *off_6048;
// 106F8: using guessed type int __fastcall IOTimerEventSource::timerEventSource(_QWORD, _QWORD);

//----- (000000000000513A) ----------------------------------------------------
char __fastcall IOUSBHIDDriver::IsPortSuspended(IOUSBHIDDriver *this)
{
  return *(_BYTE *)(*((_QWORD *)this + 43) + 72LL);
}

//----- (000000000000514A) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::ClaimPendingRead(IOUSBHIDDriver *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  uintptr_t v6; // r14@1
  uintptr_t v7; // r15@1
  uintptr_t v8; // r12@1
  __int64 v9; // rax@1
  __int64 v10; // rax@2
  char v11; // al@3
  uintptr_t v12; // r8@6

  v6 = (uintptr_t)a5;
  v7 = (uintptr_t)a4;
  v8 = (uintptr_t)a3;
  LODWORD(v9) = OSMetaClassBase::safeMetaCast(this, &IOUSBHIDDriver::gMetaClass);
  if ( v9 )
  {
    v10 = *(_QWORD *)(v9 + 344);
    if ( *(_BYTE *)(v10 + 112) )
    {
      v11 = 0;
    }
    else
    {
      *(_BYTE *)(v10 + 112) = 1;
      v11 = 1;
    }
    if ( a2 )
    {
      *(_BYTE *)a2 = v11;
      return 0LL;
    }
    if ( *(_BYTE *)off_6038[0] & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
    {
      v12 = 2LL;
      goto LABEL_13;
    }
  }
  else if ( *(_BYTE *)off_6038[0] & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
  {
    v12 = 1LL;
LABEL_13:
    kernel_debug(0x52D1C2Cu, v8, v7, v6, v12, 0LL);
    return 0LL;
  }
  return 0LL;
}
// 6038: using guessed type __int64 *off_6038[3];
// 6048: using guessed type __int64 *off_6048;
// 6F48: using guessed type _QWORD IOUSBHIDDriver::gMetaClass;
// 106C0: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (00000000000051FC) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::ChangeOutstandingIO(IOUSBHIDDriver *this, OSObject *a2, void *a3, void *a4, void *a5, void *a6)
{
  int v6; // ebx@1
  uintptr_t v7; // rax@1
  bool v8; // zf@3
  uintptr_t v9; // rsi@8
  uintptr_t v10; // rdx@8
  uintptr_t v11; // r8@8
  uintptr_t v12; // rcx@8

  v6 = (signed int)a2;
  LODWORD(v7) = OSMetaClassBase::safeMetaCast(this, &IOUSBHIDDriver::gMetaClass);
  if ( !v7 )
  {
    if ( !(*(_BYTE *)off_6038[0] & 2) || !(*(_DWORD *)off_6048 & 0xFFFFFFF7) )
      return 0LL;
    v9 = 0LL;
    v10 = 0LL;
    v11 = 1LL;
    v12 = v6 & 0xFFFFFFFF;
LABEL_14:
    kernel_debug(0x52D1C30u, v9, v10, v12, v11, 0LL);
    return 0LL;
  }
  if ( (_DWORD)a2 == -1 )
  {
    v8 = (*(_DWORD *)(v7 + 300))-- == 1;
    if ( v8 && *(_BYTE *)(v7 + 299) )
      (*(void (__fastcall **)(_QWORD, uintptr_t, _QWORD))(**(_QWORD **)(v7 + 208) + 1496LL))(
        *(_QWORD *)(v7 + 208),
        v7,
        0LL);
    return 0LL;
  }
  if ( (_DWORD)a2 == 1 )
  {
    ++*(_DWORD *)(v7 + 300);
    return 0LL;
  }
  if ( *(_BYTE *)off_6038[0] & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
  {
    v10 = *(_DWORD *)(v7 + 300);
    v12 = 0LL;
    v9 = v7;
    v11 = v6 & 0xFFFFFFFF;
    goto LABEL_14;
  }
  return 0LL;
}
// 6038: using guessed type __int64 *off_6038[3];
// 6048: using guessed type __int64 *off_6048;
// 6F48: using guessed type _QWORD IOUSBHIDDriver::gMetaClass;
// 106C0: using guessed type int __fastcall OSMetaClassBase::safeMetaCast(_QWORD, _QWORD);

//----- (00000000000052D4) ----------------------------------------------------
int __fastcall IOUSBHIDDriver::DecrementOutstandingIO(IOUSBHIDDriver *this)
{
  IOUSBHIDDriver *v1; // rax@1
  __int64 v2; // rdi@1
  bool v3; // zf@3

  v1 = this;
  v2 = *((_QWORD *)this + 38);
  if ( v2 )
  {
    LODWORD(v1) = (*(int (__fastcall **)(__int64, __int64 (__fastcall *)(IOUSBHIDDriver *__hidden, OSObject *, void *, void *, void *, void *), signed __int64, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v2 + 456LL))(
                    v2,
                    IOUSBHIDDriver::ChangeOutstandingIO,
                    -1LL,
                    0LL,
                    0LL,
                    0LL);
  }
  else
  {
    v3 = (*((_DWORD *)v1 + 75))-- == 1;
    if ( v3 && *((_BYTE *)v1 + 299) )
      LODWORD(v1) = (*(int (__fastcall **)(_QWORD, IOUSBHIDDriver *, _QWORD))(**((_QWORD **)v1 + 26) + 1496LL))(
                      *((_QWORD *)v1 + 26),
                      v1,
                      0LL);
  }
  return (signed int)v1;
}

//----- (0000000000005336) ----------------------------------------------------
int __fastcall IOUSBHIDDriver::IncrementOutstandingIO(IOUSBHIDDriver *this)
{
  IOUSBHIDDriver *v1; // rax@1
  __int64 v2; // rdi@1

  v1 = this;
  v2 = *((_QWORD *)this + 38);
  if ( v2 )
    LODWORD(v1) = (*(int (__fastcall **)(__int64, __int64 (__fastcall *)(IOUSBHIDDriver *__hidden, OSObject *, void *, void *, void *, void *), signed __int64, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v2 + 456LL))(
                    v2,
                    IOUSBHIDDriver::ChangeOutstandingIO,
                    1LL,
                    0LL,
                    0LL,
                    0LL);
  else
    ++*((_DWORD *)v1 + 75);
  return (signed int)v1;
}

//----- (0000000000005372) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::LogMemReport(IOUSBHIDDriver *this, __int64 a2, IOMemoryDescriptor *a3, unsigned __int64 a4)
{
  unsigned __int64 v4; // r13@1
  __int64 v5; // r15@2
  signed __int64 v6; // r14@3
  signed int v7; // eax@5
  unsigned __int64 v8; // rdx@5
  char *v9; // rcx@5
  signed __int64 v10; // rsi@5
  unsigned __int64 v11; // rdx@6
  IOMemoryDescriptor *v13; // [sp+8h] [bp-4B8h]@1
  char v14[128]; // [sp+10h] [bp-4B0h]@5
  char v15; // [sp+90h] [bp-430h]@5
  __int64 v16; // [sp+490h] [bp-30h]@1

  v4 = a4;
  v13 = a3;
  v16 = *off_6030[0];
  if ( a4 )
  {
    v5 = 0LL;
    do
    {
      v6 = v4;
      if ( v4 > 0x80 )
        v6 = 128LL;
      (*(void (__fastcall **)(IOMemoryDescriptor *, __int64, _QWORD, signed __int64))(*(_QWORD *)v13 + 480LL))(
        v13,
        v5,
        v14,
        v6);
      v7 = 1;
      v8 = 0LL;
      v9 = &v15;
      v10 = (signed __int64)&v15;
      if ( v6 )
      {
        do
        {
          v11 = (unsigned __int8)v14[v8];
          *v9 = *((_BYTE *)qword_5FF0 + (v11 >> 4));
          v9[1] = *((_BYTE *)qword_5FF0 + (v11 & 0xF));
          v10 = (signed __int64)(v9 + 3);
          v9[2] = 32;
          v8 = (unsigned int)v7++;
          v9 += 3;
        }
        while ( v8 < v6 );
      }
      *(_BYTE *)v10 = 0;
      v5 += v6;
      v4 -= v6;
    }
    while ( v4 );
  }
  return *off_6030[0];
}
// 5FF0: using guessed type __int64 qword_5FF0[2];
// 6030: using guessed type __int64 *off_6030[4];
// 5372: using guessed type char var_4B0[128];

//----- (0000000000005464) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::GetHexChar(IOUSBHIDDriver *this, char a2)
{
  return *((_BYTE *)qword_5FF0 + (a2 & 0xF));
}
// 5FF0: using guessed type __int64 qword_5FF0[2];

//----- (000000000000547A) ----------------------------------------------------
void __fastcall IOUSBHIDDriver::processPacket(IOUSBHIDDriver *this, void *a2)
{
  ;
}

//----- (0000000000005480) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::GetReport(IOUSBHIDDriver *this, __int64 a2, __int64 a3, unsigned __int8 *a4, unsigned int *a5)
{
  return 0LL;
}

//----- (0000000000005488) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::SetReport(IOUSBHIDDriver *this, __int64 a2, __int64 a3, unsigned __int8 *a4)
{
  return 0LL;
}

//----- (0000000000005490) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::RearmInterruptRead(IOUSBHIDDriver *this)
{
  uintptr_t v1; // r14@1
  __int64 v2; // rdi@2
  signed int v3; // ebx@4
  uintptr_t v4; // rdx@6
  uintptr_t v5; // r8@6
  __int64 v6; // rdi@10
  __int64 v7; // rax@12
  uintptr_t v9; // r8@22
  __int64 v10; // rbx@33
  void (__fastcall *v11)(_QWORD, _QWORD); // r15@33
  signed __int64 v12; // rax@33
  signed __int64 v13; // rsi@33
  uintptr_t v14; // rax@34
  uintptr_t v15; // rbx@34
  uintptr_t v16; // rax@34
  int v17; // er13@36
  uintptr_t v18; // r12@36
  __int64 v19; // r15@48
  signed __int64 v20; // r12@48
  int (__fastcall *v21)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD); // r13@48
  __int64 v22; // rax@48
  uintptr_t v23; // r15@49
  uintptr_t v24; // rax@49
  __int64 v25; // r15@52
  signed __int64 v26; // r12@53
  int (__fastcall *v27)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD); // r13@54
  __int64 v28; // rax@54
  uintptr_t v29; // r15@55
  uintptr_t v30; // rax@55
  __int64 v31; // rcx@58
  uintptr_t v32; // rax@58
  __int64 v33; // rcx@62
  __int64 v34; // rdi@64
  signed int v35; // er15@68
  __int64 v36; // rax@78
  __int64 v37; // r12@78
  __int64 v38; // rax@78
  uintptr_t v39; // rcx@90
  uintptr_t v40; // r8@90
  uintptr_t arg3; // [sp+18h] [bp-38h]@48
  char v42; // [sp+27h] [bp-29h]@1

  v1 = (uintptr_t)this;
  v42 = 0;
  if ( (unsigned __int8)IOService::isInactive(this) )
    goto LABEL_15;
  v2 = *((_QWORD *)this + 38);
  if ( !v2
    || (*(int (__fastcall **)(__int64, __int64 (__fastcall *)(IOUSBHIDDriver *, OSObject *, void *, void *, void *, void *), char *, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v2 + 456LL))(
         v2,
         IOUSBHIDDriver::ClaimPendingRead,
         &v42,
         0LL,
         0LL,
         0LL) )
  {
    v3 = -536870201;
    if ( *(_BYTE *)off_6038[0] & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
    {
      v4 = 0LL;
      v5 = 3LL;
      goto LABEL_7;
    }
    return (unsigned int)v3;
  }
  if ( v42 )
  {
    if ( *(_QWORD *)(v1 + 240) && (v6 = *(_QWORD *)(v1 + 224)) != 0 )
    {
      if ( !(unsigned __int16)(*(int (**)(void))(*(_QWORD *)v6 + 416LL))() )
      {
        if ( *(_BYTE *)off_6038[0] & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
          kernel_debug(0x52D1C34u, v1, 0LL, 0LL, 0xBuLL, 0LL);
        *(_BYTE *)(*(_QWORD *)(v1 + 344) + 112LL) = 0;
        v3 = -536870164;
        return (unsigned int)v3;
      }
      v7 = *(_QWORD *)(v1 + 344);
      if ( *(_QWORD *)(v7 + 40) || *(_QWORD *)(v1 + 256) )
      {
        if ( (unsigned __int8)IOService::isInactive((IOService *)v1) )
        {
LABEL_15:
          if ( *(_BYTE *)off_6038[0] & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
            kernel_debug(0x52D1C34u, v1, 0LL, 0LL, 6uLL, 0LL);
          *(_BYTE *)(*(_QWORD *)(v1 + 344) + 112LL) = 0;
          v3 = -536870163;
          return (unsigned int)v3;
        }
        (*(void (__fastcall **)(uintptr_t))(*(_QWORD *)v1 + 2656LL))(v1);
        v10 = *(_QWORD *)(v1 + 240);
        v11 = *(void (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)v10 + 712LL);
        LODWORD(v12) = (*(int (__fastcall **)(_QWORD))(*(_QWORD *)v10 + 728LL))(*(_QWORD *)(v1 + 240));
        v13 = v12;
        v11(v10, v12);
        if ( *(_BYTE *)off_6038[0] & 2 )
        {
          LODWORD(v14) = (*(int (**)(void))(**(_QWORD **)(v1 + 240) + 456LL))();
          v15 = v14;
          LODWORD(v16) = (*(int (**)(void))(**(_QWORD **)(v1 + 240) + 728LL))();
          if ( *(_DWORD *)off_6048 & 0xFFFFFFF7 )
          {
            v13 = v1;
            kernel_debug(0x52D1C34u, v1, v15, v16, 9uLL, 0LL);
          }
        }
        v17 = -536870201;
        v3 = 0;
        v18 = 0LL;
        while ( 1 )
        {
          while ( 1 )
          {
            if ( v17 == -536870164 )
            {
              v35 = -536870164;
              goto LABEL_73;
            }
            if ( !v17 )
              goto LABEL_80;
            if ( (signed int)v18 > 29 || !*(_QWORD *)(v1 + 240) || !*(_QWORD *)(v1 + 224) )
            {
              v35 = v17;
              if ( !v17 )
                goto LABEL_80;
              goto LABEL_73;
            }
            if ( (unsigned __int8)IOService::isInactive((IOService *)v1) )
            {
              v35 = -536870163;
              if ( *(_BYTE *)off_6038[0] & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
              {
                v13 = v1;
                kernel_debug(0x52D1C34u, v1, 0LL, 0LL, 6uLL, 0LL);
              }
              goto LABEL_73;
            }
            ++v18;
            if ( !*(_QWORD *)(*(_QWORD *)(v1 + 344) + 40LL) )
              break;
            arg3 = v18;
            v19 = *(_QWORD *)(v1 + 224);
            v20 = *(_QWORD *)(v1 + 240);
            v21 = *(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v19 + 520LL);
            LODWORD(v22) = (*(int (__fastcall **)(_QWORD, signed __int64))(*(_QWORD *)v20 + 456LL))(
                             *(_QWORD *)(v1 + 240),
                             v13);
            v13 = v20;
            v17 = v21(v19, v20, 0LL, 0LL, v22, *(_QWORD *)(v1 + 344) + 32LL);
            if ( *(_BYTE *)off_6038[0] & 2 )
            {
              v23 = *(_QWORD *)(*(_QWORD *)(v1 + 344) + 104LL);
              v24 = IORegistryEntry::getRegistryEntryID((IORegistryEntry *)v1);
              if ( *(_DWORD *)off_6048 & 0xFFFFFFF7 )
              {
                v13 = v1;
                kernel_debug(0x52D1C48u, v1, v17, v23, v24, 0LL);
              }
            }
            v18 = arg3;
            if ( v17 == -536870201 )
              break;
            if ( v17 != -536870163 )
              goto LABEL_68;
            v33 = *(_QWORD *)(v1 + 344);
            v32 = *(_BYTE *)(v33 + 96);
            if ( *(_BYTE *)(v33 + 96) || (v17 = -536870163, *(_QWORD *)(v33 + 104) <= 3uLL) )
            {
              v35 = -536870163;
              if ( *(_BYTE *)off_6038[0] & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
              {
                v39 = *(_QWORD *)(v33 + 104);
                v40 = 7LL;
                goto LABEL_94;
              }
LABEL_73:
              if ( (unsigned __int8)IOService::isInactive((IOService *)v1) )
              {
                if ( *(_BYTE *)off_6038[0] & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
                {
                  v13 = v1;
                  kernel_debug(0x52D1C34u, v1, v35, 0LL, 6uLL, 0LL);
                }
              }
              else if ( v35 != -536870164 )
              {
                LODWORD(v36) = (*(int (__fastcall **)(uintptr_t, _QWORD))(*(_QWORD *)v1 + 904LL))(v1, 0LL);
                v37 = v36;
                LODWORD(v38) = (*(int (__fastcall **)(_QWORD, _QWORD))(*(_QWORD *)*off_6010[0] + 1920LL))(
                                 *off_6010[0],
                                 (unsigned int)v35);
                v13 = 1431519814LL;
                KernelDebugLogInternal(
                  1LL,
                  1431519814LL,
                  "IOUSBHIDDriver(%s)::RearmInterruptRead  returning error 0x%x (%s), not issuing any reads to device",
                  v37,
                  (unsigned int)v35,
                  v38);
              }
              *(_BYTE *)(*(_QWORD *)(v1 + 344) + 112LL) = 0;
              (*(void (__fastcall **)(uintptr_t, signed __int64))(*(_QWORD *)v1 + 2648LL))(v1, v13);
              v3 = v35;
LABEL_80:
              if ( *(_BYTE *)off_6038[0] & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
              {
                v4 = v3;
                v5 = 5LL;
LABEL_7:
                kernel_debug(0x52D1C34u, v1, v4, 0LL, v5, 0LL);
              }
              return (unsigned int)v3;
            }
LABEL_64:
            v34 = *(_QWORD *)(v1 + 224);
            v18 = arg3;
            if ( v34 )
            {
              if ( *(_BYTE *)off_6038[0] & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
              {
                kernel_debug(0x52D1C34u, v1, v17, arg3, 4uLL, 0LL);
                v34 = *(_QWORD *)(v1 + 224);
              }
              v13 = 0LL;
              (*(void (__fastcall **)(__int64, _QWORD))(*(_QWORD *)v34 + 488LL))(v34, 0LL);
              IOSleep(10LL);
            }
          }
          v25 = *(_QWORD *)(v1 + 224);
          v17 = -536870201;
          if ( v25 )
          {
            arg3 = v18;
            v26 = *(_QWORD *)(v1 + 240);
            v17 = -536870201;
            if ( !v26 )
              goto LABEL_64;
            v27 = *(int (__fastcall **)(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD))(*(_QWORD *)v25 + 464LL);
            LODWORD(v28) = (*(int (__fastcall **)(_QWORD, signed __int64))(*(_QWORD *)v26 + 456LL))(
                             *(_QWORD *)(v1 + 240),
                             v13);
            v13 = v26;
            v17 = v27(v25, v26, 0LL, 0LL, v28, v1 + 248);
            if ( *(_BYTE *)off_6038[0] & 2 )
            {
              v29 = *(_QWORD *)(*(_QWORD *)(v1 + 344) + 104LL);
              v30 = IORegistryEntry::getRegistryEntryID((IORegistryEntry *)v1);
              if ( *(_DWORD *)off_6048 & 0xFFFFFFF7 )
              {
                v13 = v1;
                kernel_debug(0x52D1C48u, v1, v17, v29, v30, 0LL);
              }
            }
            v18 = arg3;
            if ( v17 == -536870163 )
            {
              v31 = *(_QWORD *)(v1 + 344);
              v32 = *(_BYTE *)(v31 + 96);
              if ( *(_BYTE *)(v31 + 96) || (v17 = -536870163, *(_QWORD *)(v31 + 104) <= 3uLL) )
              {
                v35 = -536870163;
                if ( *(_BYTE *)off_6038[0] & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
                {
                  v39 = *(_QWORD *)(v31 + 104);
                  v40 = 8LL;
LABEL_94:
                  v13 = v1;
                  kernel_debug(0x52D1C34u, v1, v32, v39, v40, 0LL);
                  goto LABEL_73;
                }
                goto LABEL_73;
              }
              goto LABEL_64;
            }
LABEL_68:
            v35 = -536870208;
            if ( v17 != -536870164 && v17 )
            {
              arg3 = v18;
              if ( v17 == -536870208 )
                goto LABEL_73;
              goto LABEL_64;
            }
          }
        }
      }
      if ( !(*(_BYTE *)off_6038[0] & 2) || !(*(_DWORD *)off_6048 & 0xFFFFFFF7) )
      {
LABEL_25:
        *(_BYTE *)(v7 + 112) = 0;
        v3 = -536870201;
        return (unsigned int)v3;
      }
      v9 = 2LL;
    }
    else
    {
      if ( !(*(_BYTE *)off_6038[0] & 2) || !(*(_DWORD *)off_6048 & 0xFFFFFFF7) )
        goto LABEL_24;
      v9 = 1LL;
    }
    kernel_debug(0x52D1C34u, v1, 0LL, 0LL, v9, 0LL);
LABEL_24:
    v7 = *(_QWORD *)(v1 + 344);
    goto LABEL_25;
  }
  v3 = 0;
  if ( *(_BYTE *)off_6038[0] & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
  {
    v3 = 0;
    v4 = 0LL;
    v5 = 10LL;
    goto LABEL_7;
  }
  return (unsigned int)v3;
}
// 6010: using guessed type _QWORD *off_6010[8];
// 6038: using guessed type __int64 *off_6038[3];
// 6048: using guessed type __int64 *off_6048;
// 102F0: using guessed type int __fastcall IOSleep(_QWORD);
// 102F8: using guessed type int __fastcall KernelDebugLogInternal(_QWORD, _QWORD, _QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000005C0E) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::InitializeUSBHIDPowerManagement(IOUSBHIDDriver *this, IOService *a2)
{
  IOUSBHIDDriver *v2; // rsi@1
  int v3; // er14@1

  (*(void (**)(void))(*(_QWORD *)this + 1936LL))();
  (*(void (__fastcall **)(IOService *, IOUSBHIDDriver *))(*(_QWORD *)a2 + 1952LL))(a2, this);
  IOService::makeUsable(this);
  v2 = this;
  v3 = (*(int (__fastcall **)(IOUSBHIDDriver *, IOUSBHIDDriver *, _QWORD *, signed __int64))(*(_QWORD *)v2 + 1960LL))(
         v2,
         v2,
         &ourPowerStates,
         5LL);
  if ( v3 )
  {
    if ( *(_BYTE *)off_6038[0] & 2 && *(_DWORD *)off_6048 & 0xFFFFFFF7 )
    {
      v2 = this;
      kernel_debug(0x52D1C38u, (uintptr_t)this, v3, 0LL, 0LL, 0LL);
    }
    (*(void (__fastcall **)(IOUSBHIDDriver *, IOUSBHIDDriver *))(*(_QWORD *)this + 1944LL))(this, v2);
  }
  return (unsigned int)v3;
}
// 6038: using guessed type __int64 *off_6038[3];
// 6048: using guessed type __int64 *off_6048;
// 6CA0: using guessed type _QWORD ourPowerStates;

//----- (0000000000005CA6) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::_RESERVEDIOUSBHIDDriver5(IOUSBHIDDriver *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBHIDDriver::gMetaClass, 5);
}
// 6F48: using guessed type _QWORD IOUSBHIDDriver::gMetaClass;

//----- (0000000000005CBC) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::_RESERVEDIOUSBHIDDriver6(IOUSBHIDDriver *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBHIDDriver::gMetaClass, 6);
}
// 6F48: using guessed type _QWORD IOUSBHIDDriver::gMetaClass;

//----- (0000000000005CD2) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::_RESERVEDIOUSBHIDDriver7(IOUSBHIDDriver *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBHIDDriver::gMetaClass, 7);
}
// 6F48: using guessed type _QWORD IOUSBHIDDriver::gMetaClass;

//----- (0000000000005CE8) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::_RESERVEDIOUSBHIDDriver8(IOUSBHIDDriver *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBHIDDriver::gMetaClass, 8);
}
// 6F48: using guessed type _QWORD IOUSBHIDDriver::gMetaClass;

//----- (0000000000005CFE) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::_RESERVEDIOUSBHIDDriver9(IOUSBHIDDriver *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBHIDDriver::gMetaClass, 9);
}
// 6F48: using guessed type _QWORD IOUSBHIDDriver::gMetaClass;

//----- (0000000000005D14) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::_RESERVEDIOUSBHIDDriver10(IOUSBHIDDriver *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBHIDDriver::gMetaClass, 10);
}
// 6F48: using guessed type _QWORD IOUSBHIDDriver::gMetaClass;

//----- (0000000000005D2A) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::_RESERVEDIOUSBHIDDriver11(IOUSBHIDDriver *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBHIDDriver::gMetaClass, 11);
}
// 6F48: using guessed type _QWORD IOUSBHIDDriver::gMetaClass;

//----- (0000000000005D40) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::_RESERVEDIOUSBHIDDriver12(IOUSBHIDDriver *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBHIDDriver::gMetaClass, 12);
}
// 6F48: using guessed type _QWORD IOUSBHIDDriver::gMetaClass;

//----- (0000000000005D56) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::_RESERVEDIOUSBHIDDriver13(IOUSBHIDDriver *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBHIDDriver::gMetaClass, 13);
}
// 6F48: using guessed type _QWORD IOUSBHIDDriver::gMetaClass;

//----- (0000000000005D6C) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::_RESERVEDIOUSBHIDDriver14(IOUSBHIDDriver *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBHIDDriver::gMetaClass, 14);
}
// 6F48: using guessed type _QWORD IOUSBHIDDriver::gMetaClass;

//----- (0000000000005D82) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::_RESERVEDIOUSBHIDDriver15(IOUSBHIDDriver *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBHIDDriver::gMetaClass, 15);
}
// 6F48: using guessed type _QWORD IOUSBHIDDriver::gMetaClass;

//----- (0000000000005D98) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::_RESERVEDIOUSBHIDDriver16(IOUSBHIDDriver *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBHIDDriver::gMetaClass, 16);
}
// 6F48: using guessed type _QWORD IOUSBHIDDriver::gMetaClass;

//----- (0000000000005DAE) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::_RESERVEDIOUSBHIDDriver17(IOUSBHIDDriver *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBHIDDriver::gMetaClass, 17);
}
// 6F48: using guessed type _QWORD IOUSBHIDDriver::gMetaClass;

//----- (0000000000005DC4) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::_RESERVEDIOUSBHIDDriver18(IOUSBHIDDriver *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBHIDDriver::gMetaClass, 18);
}
// 6F48: using guessed type _QWORD IOUSBHIDDriver::gMetaClass;

//----- (0000000000005DDA) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::_RESERVEDIOUSBHIDDriver19(IOUSBHIDDriver *this)
{
  return OSMetaClass::reservedCalled((OSMetaClass *)&IOUSBHIDDriver::gMetaClass, 19);
}
// 6F48: using guessed type _QWORD IOUSBHIDDriver::gMetaClass;

//----- (0000000000005DF0) ----------------------------------------------------
__int64 __fastcall IOUSBHIDDriver::MetaClass::~MetaClass(IOUSBHIDDriver::MetaClass *this)
{
  return OSMetaClass::~OSMetaClass(this);
}

//----- (0000000000005E00) ----------------------------------------------------
__int64 `global constructor keyed to'_a()
{
  __int64 result; // rax@1

  OSMetaClass::OSMetaClass(&IOUSBHIDDriver::gMetaClass, "IOUSBHIDDriver", off_6000[0], 352LL);
  result = (__int64)off_6BC0;
  IOUSBHIDDriver::gMetaClass = off_6BC0;
  return result;
}
// 6000: using guessed type _QWORD *off_6000[10];
// 6BC0: using guessed type __int64 (__fastcall *off_6BC0[2])(IOUSBHIDDriver::MetaClass *__hidden this);
// 6F48: using guessed type _QWORD IOUSBHIDDriver::gMetaClass;
// 104D0: using guessed type int __fastcall OSMetaClass::OSMetaClass(_QWORD, _QWORD, _QWORD, _QWORD);

//----- (0000000000005E40) ----------------------------------------------------
__int64 `global destructor keyed to'_a()
{
  return OSMetaClass::~OSMetaClass((OSMetaClass *)&IOUSBHIDDriver::gMetaClass);
}
// 6F48: using guessed type _QWORD IOUSBHIDDriver::gMetaClass;

//----- (0000000000005E51) ----------------------------------------------------
int _start()
{
  int result; // eax@2

  if ( _realmain )
    result = _realmain();
  else
    result = 0;
  return result;
}
// 6F70: using guessed type int (*_realmain)(void);

//----- (0000000000005E6B) ----------------------------------------------------
__int64 *OSKextGetCurrentIdentifier()
{
  return &kmod_info + 2;
}
// 6E80: using guessed type __int64 kmod_info;

//----- (0000000000005E7C) ----------------------------------------------------
__int64 *OSKextGetCurrentVersionString()
{
  return &kmod_info + 10;
}
// 6E80: using guessed type __int64 kmod_info;

//----- (0000000000005E8D) ----------------------------------------------------
__int64 OSKextGetCurrentLoadTag()
{
  return *((_DWORD *)&kmod_info + 3);
}
// 6E80: using guessed type __int64 kmod_info;

//----- (0000000000005E9D) ----------------------------------------------------
int _stop()
{
  int result; // eax@2

  if ( _antimain )
    result = _antimain();
  else
    result = 0;
  return result;
}
// 6F78: using guessed type int (*_antimain)(void);

// ALL OK, 93 function(s) have been successfully decompiled
